import{a6 as cc,a4 as mY,a7 as qL,d as KR,a8 as bY,o as ri,f as jl,a9 as wY,_ as SY,aa as eP,ab as CY,ac as _Y,ad as OY,K as tP,r as rP,c as nP,B as ul,l as Yr,E as Ni,m as xf,D as oP,Q as iP,ae as RY,q as EY}from"./index-d5d55ce5.js";import{c as Hv}from"./_commonjs-dynamic-modules-302442b1.js";var Df=function(e){return e&&e.Math===Math&&e},vt=Df(typeof globalThis=="object"&&globalThis)||Df(typeof window=="object"&&window)||Df(typeof self=="object"&&self)||Df(typeof cc=="object"&&cc)||Df(typeof cc=="object"&&cc)||function(){return this}()||Function("return this")(),jn={},je=function(e){try{return!!e()}catch{return!0}},TY=je,Ut=!TY(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),kY=je,Vd=!kY(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),PY=Vd,Lv=Function.prototype.call,zt=PY?Lv.bind(Lv):function(){return Lv.apply(Lv,arguments)},Wd={},XL={}.propertyIsEnumerable,ZL=Object.getOwnPropertyDescriptor,$Y=ZL&&!XL.call({1:2},1);Wd.f=$Y?function(t){var r=ZL(this,t);return!!r&&r.enumerable}:XL;var Ud=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}},JL=Vd,QL=Function.prototype,KS=QL.call,AY=JL&&QL.bind.bind(KS,KS),Ue=JL?AY:function(e){return function(){return KS.apply(e,arguments)}},ej=Ue,IY=ej({}.toString),MY=ej("".slice),Fn=function(e){return MY(IY(e),8,-1)},xY=Ue,DY=je,NY=Fn,cb=Object,HY=xY("".split),zd=DY(function(){return!cb("z").propertyIsEnumerable(0)})?function(e){return NY(e)==="String"?HY(e,""):cb(e)}:cb,mn=function(e){return e==null},LY=mn,jY=TypeError,Tr=function(e){if(LY(e))throw new jY("Can't call method on "+e);return e},FY=zd,BY=Tr,Br=function(e){return FY(BY(e))},hb=typeof document=="object"&&document.all,Et=typeof hb>"u"&&hb!==void 0?function(e){return typeof e=="function"||e===hb}:function(e){return typeof e=="function"},VY=Et,Nt=function(e){return typeof e=="object"?e!==null:VY(e)},db=vt,WY=Et,UY=function(e){return WY(e)?e:void 0},jo=function(e,t){return arguments.length<2?UY(db[e]):db[e]&&db[e][t]},zY=Ue,Ai=zY({}.isPrototypeOf),Ka=typeof navigator<"u"&&String(navigator.userAgent)||"",tj=vt,vb=Ka,aP=tj.process,lP=tj.Deno,sP=aP&&aP.versions||lP&&lP.version,uP=sP&&sP.v8,sn,xg;uP&&(sn=uP.split("."),xg=sn[0]>0&&sn[0]<4?1:+(sn[0]+sn[1]));!xg&&vb&&(sn=vb.match(/Edge\/(\d+)/),(!sn||sn[1]>=74)&&(sn=vb.match(/Chrome\/(\d+)/),sn&&(xg=+sn[1])));var Yd=xg,fP=Yd,YY=je,GY=vt,KY=GY.String,bf=!!Object.getOwnPropertySymbols&&!YY(function(){var e=Symbol("symbol detection");return!KY(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&fP&&fP<41}),qY=bf,rj=qY&&!Symbol.sham&&typeof Symbol.iterator=="symbol",XY=jo,ZY=Et,JY=Ai,QY=rj,eG=Object,Gd=QY?function(e){return typeof e=="symbol"}:function(e){var t=XY("Symbol");return ZY(t)&&JY(t.prototype,eG(e))},tG=String,wf=function(e){try{return tG(e)}catch{return"Object"}},rG=Et,nG=wf,oG=TypeError,qa=function(e){if(rG(e))return e;throw new oG(nG(e)+" is not a function")},iG=qa,aG=mn,Xa=function(e,t){var r=e[t];return aG(r)?void 0:iG(r)},yb=zt,gb=Et,pb=Nt,lG=TypeError,nj=function(e,t){var r,n;if(t==="string"&&gb(r=e.toString)&&!pb(n=yb(r,e))||gb(r=e.valueOf)&&!pb(n=yb(r,e))||t!=="string"&&gb(r=e.toString)&&!pb(n=yb(r,e)))return n;throw new lG("Can't convert object to primitive value")},oj={exports:{}},sG=!1,cP=vt,uG=Object.defineProperty,qR=function(e,t){try{uG(cP,e,{value:t,configurable:!0,writable:!0})}catch{cP[e]=t}return t},fG=vt,cG=qR,hP="__core-js_shared__",hG=fG[hP]||cG(hP,{}),XR=hG,dP=XR;(oj.exports=function(e,t){return dP[e]||(dP[e]=t!==void 0?t:{})})("versions",[]).push({version:"3.35.1",mode:"global",copyright:"Â© 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.35.1/LICENSE",source:"https://github.com/zloirock/core-js"});var Sf=oj.exports,dG=Tr,vG=Object,kr=function(e){return vG(dG(e))},yG=Ue,gG=kr,pG=yG({}.hasOwnProperty),Mt=Object.hasOwn||function(t,r){return pG(gG(t),r)},mG=Ue,bG=0,wG=Math.random(),SG=mG(1 .toString),Zp=function(e){return"Symbol("+(e===void 0?"":e)+")_"+SG(++bG+wG,36)},CG=vt,_G=Sf,vP=Mt,OG=Zp,RG=bf,EG=rj,Ul=CG.Symbol,mb=_G("wks"),TG=EG?Ul.for||Ul:Ul&&Ul.withoutSetter||OG,wt=function(e){return vP(mb,e)||(mb[e]=RG&&vP(Ul,e)?Ul[e]:TG("Symbol."+e)),mb[e]},kG=zt,yP=Nt,gP=Gd,PG=Xa,$G=nj,AG=wt,IG=TypeError,MG=AG("toPrimitive"),ij=function(e,t){if(!yP(e)||gP(e))return e;var r=PG(e,MG),n;if(r){if(t===void 0&&(t="default"),n=kG(r,e,t),!yP(n)||gP(n))return n;throw new IG("Can't convert object to primitive value")}return t===void 0&&(t="number"),$G(e,t)},xG=ij,DG=Gd,Jp=function(e){var t=xG(e,"string");return DG(t)?t:t+""},NG=vt,pP=Nt,qS=NG.document,HG=pP(qS)&&pP(qS.createElement),Qp=function(e){return HG?qS.createElement(e):{}},LG=Ut,jG=je,FG=Qp,aj=!LG&&!jG(function(){return Object.defineProperty(FG("div"),"a",{get:function(){return 7}}).a!==7}),BG=Ut,VG=zt,WG=Wd,UG=Ud,zG=Br,YG=Jp,GG=Mt,KG=aj,mP=Object.getOwnPropertyDescriptor;jn.f=BG?mP:function(t,r){if(t=zG(t),r=YG(r),KG)try{return mP(t,r)}catch{}if(GG(t,r))return UG(!VG(WG.f,t,r),t[r])};var br={},qG=Ut,XG=je,lj=qG&&XG(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),ZG=Nt,JG=String,QG=TypeError,Ht=function(e){if(ZG(e))return e;throw new QG(JG(e)+" is not an object")},e3=Ut,t3=aj,r3=lj,jv=Ht,bP=Jp,n3=TypeError,bb=Object.defineProperty,o3=Object.getOwnPropertyDescriptor,wb="enumerable",Sb="configurable",Cb="writable";br.f=e3?r3?function(t,r,n){if(jv(t),r=bP(r),jv(n),typeof t=="function"&&r==="prototype"&&"value"in n&&Cb in n&&!n[Cb]){var o=o3(t,r);o&&o[Cb]&&(t[r]=n.value,n={configurable:Sb in n?n[Sb]:o[Sb],enumerable:wb in n?n[wb]:o[wb],writable:!1})}return bb(t,r,n)}:bb:function(t,r,n){if(jv(t),r=bP(r),jv(n),t3)try{return bb(t,r,n)}catch{}if("get"in n||"set"in n)throw new n3("Accessors not supported");return"value"in n&&(t[r]=n.value),t};var i3=Ut,a3=br,l3=Ud,Za=i3?function(e,t,r){return a3.f(e,t,l3(1,r))}:function(e,t,r){return e[t]=r,e},sj={exports:{}},XS=Ut,s3=Mt,uj=Function.prototype,u3=XS&&Object.getOwnPropertyDescriptor,ZR=s3(uj,"name"),f3=ZR&&(function(){}).name==="something",c3=ZR&&(!XS||XS&&u3(uj,"name").configurable),Kd={EXISTS:ZR,PROPER:f3,CONFIGURABLE:c3},h3=Ue,d3=Et,ZS=XR,v3=h3(Function.toString);d3(ZS.inspectSource)||(ZS.inspectSource=function(e){return v3(e)});var fj=ZS.inspectSource,y3=vt,g3=Et,wP=y3.WeakMap,cj=g3(wP)&&/native code/.test(String(wP)),p3=Sf,m3=Zp,SP=p3("keys"),em=function(e){return SP[e]||(SP[e]=m3(e))},qd={},b3=cj,hj=vt,w3=Nt,S3=Za,_b=Mt,Ob=XR,C3=em,_3=qd,CP="Object already initialized",JS=hj.TypeError,O3=hj.WeakMap,Dg,Nc,Ng,R3=function(e){return Ng(e)?Nc(e):Dg(e,{})},E3=function(e){return function(t){var r;if(!w3(t)||(r=Nc(t)).type!==e)throw new JS("Incompatible receiver, "+e+" required");return r}};if(b3||Ob.state){var Sn=Ob.state||(Ob.state=new O3);Sn.get=Sn.get,Sn.has=Sn.has,Sn.set=Sn.set,Dg=function(e,t){if(Sn.has(e))throw new JS(CP);return t.facade=e,Sn.set(e,t),t},Nc=function(e){return Sn.get(e)||{}},Ng=function(e){return Sn.has(e)}}else{var fl=C3("state");_3[fl]=!0,Dg=function(e,t){if(_b(e,fl))throw new JS(CP);return t.facade=e,S3(e,fl,t),t},Nc=function(e){return _b(e,fl)?e[fl]:{}},Ng=function(e){return _b(e,fl)}}var Fo={set:Dg,get:Nc,has:Ng,enforce:R3,getterFor:E3},JR=Ue,T3=je,k3=Et,Fv=Mt,QS=Ut,P3=Kd.CONFIGURABLE,$3=fj,dj=Fo,A3=dj.enforce,I3=dj.get,_P=String,Yy=Object.defineProperty,M3=JR("".slice),x3=JR("".replace),D3=JR([].join),N3=QS&&!T3(function(){return Yy(function(){},"length",{value:8}).length!==8}),H3=String(String).split("String"),L3=sj.exports=function(e,t,r){M3(_P(t),0,7)==="Symbol("&&(t="["+x3(_P(t),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!Fv(e,"name")||P3&&e.name!==t)&&(QS?Yy(e,"name",{value:t,configurable:!0}):e.name=t),N3&&r&&Fv(r,"arity")&&e.length!==r.arity&&Yy(e,"length",{value:r.arity});try{r&&Fv(r,"constructor")&&r.constructor?QS&&Yy(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch{}var n=A3(e);return Fv(n,"source")||(n.source=D3(H3,typeof t=="string"?t:"")),e};Function.prototype.toString=L3(function(){return k3(this)&&I3(this).source||$3(this)},"toString");var vj=sj.exports,j3=Et,F3=br,B3=vj,V3=qR,Zr=function(e,t,r,n){n||(n={});var o=n.enumerable,i=n.name!==void 0?n.name:t;if(j3(r)&&B3(r,i,n),n.global)o?e[t]=r:V3(t,r);else{try{n.unsafe?e[t]&&(o=!0):delete e[t]}catch{}o?e[t]=r:F3.f(e,t,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return e},Ja={},W3=Math.ceil,U3=Math.floor,z3=Math.trunc||function(t){var r=+t;return(r>0?U3:W3)(r)},Y3=z3,Ii=function(e){var t=+e;return t!==t||t===0?0:Y3(t)},G3=Ii,K3=Math.max,q3=Math.min,tm=function(e,t){var r=G3(e);return r<0?K3(r+t,0):q3(r,t)},X3=Ii,Z3=Math.min,Qa=function(e){var t=X3(e);return t>0?Z3(t,9007199254740991):0},J3=Qa,bn=function(e){return J3(e.length)},Q3=Br,eK=tm,tK=bn,OP=function(e){return function(t,r,n){var o=Q3(t),i=tK(o),a=eK(n,i),l;if(e&&r!==r){for(;i>a;)if(l=o[a++],l!==l)return!0}else for(;i>a;a++)if((e||a in o)&&o[a]===r)return e||a||0;return!e&&-1}},QR={includes:OP(!0),indexOf:OP(!1)},rK=Ue,Rb=Mt,nK=Br,oK=QR.indexOf,iK=qd,RP=rK([].push),yj=function(e,t){var r=nK(e),n=0,o=[],i;for(i in r)!Rb(iK,i)&&Rb(r,i)&&RP(o,i);for(;t.length>n;)Rb(r,i=t[n++])&&(~oK(o,i)||RP(o,i));return o},e0=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],aK=yj,lK=e0,sK=lK.concat("length","prototype");Ja.f=Object.getOwnPropertyNames||function(t){return aK(t,sK)};var Xd={};Xd.f=Object.getOwnPropertySymbols;var uK=jo,fK=Ue,cK=Ja,hK=Xd,dK=Ht,vK=fK([].concat),gj=uK("Reflect","ownKeys")||function(t){var r=cK.f(dK(t)),n=hK.f;return n?vK(r,n(t)):r},EP=Mt,yK=gj,gK=jn,pK=br,pj=function(e,t,r){for(var n=yK(t),o=pK.f,i=gK.f,a=0;a<n.length;a++){var l=n[a];!EP(e,l)&&!(r&&EP(r,l))&&o(e,l,i(t,l))}},mK=je,bK=Et,wK=/#|\.prototype\./,Zd=function(e,t){var r=CK[SK(e)];return r===OK?!0:r===_K?!1:bK(t)?mK(t):!!t},SK=Zd.normalize=function(e){return String(e).replace(wK,".").toLowerCase()},CK=Zd.data={},_K=Zd.NATIVE="N",OK=Zd.POLYFILL="P",rm=Zd,Bv=vt,RK=jn.f,EK=Za,TK=Zr,kK=qR,PK=pj,$K=rm,Ae=function(e,t){var r=e.target,n=e.global,o=e.stat,i,a,l,s,u,f;if(n?a=Bv:o?a=Bv[r]||kK(r,{}):a=Bv[r]&&Bv[r].prototype,a)for(l in t){if(u=t[l],e.dontCallGetSet?(f=RK(a,l),s=f&&f.value):s=a[l],i=$K(n?l:r+(o?".":"#")+l,e.forced),!i&&s!==void 0){if(typeof u==typeof s)continue;PK(u,s)}(e.sham||s&&s.sham)&&EK(u,"sham",!0),TK(a,l,u,e)}},nm={},AK=Ue,el=AK([].slice),IK=Fn,MK=Br,mj=Ja.f,xK=el,bj=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],DK=function(e){try{return mj(e)}catch{return xK(bj)}};nm.f=function(t){return bj&&IK(t)==="Window"?DK(t):mj(MK(t))};var NK=Ae,HK=je,LK=nm.f,jK=HK(function(){return!Object.getOwnPropertyNames(1)});NK({target:"Object",stat:!0,forced:jK},{getOwnPropertyNames:LK});var FK=wt,BK=FK("toStringTag"),wj={};wj[BK]="z";var t0=String(wj)==="[object z]",VK=t0,WK=Et,Gy=Fn,UK=wt,zK=UK("toStringTag"),YK=Object,GK=Gy(function(){return arguments}())==="Arguments",KK=function(e,t){try{return e[t]}catch{}},om=VK?Gy:function(e){var t,r,n;return e===void 0?"Undefined":e===null?"Null":typeof(r=KK(t=YK(e),zK))=="string"?r:GK?Gy(t):(n=Gy(t))==="Object"&&WK(t.callee)?"Arguments":n},qK=om,XK=String,Yt=function(e){if(qK(e)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return XK(e)},r0={},ZK=yj,JK=e0,Jd=Object.keys||function(t){return ZK(t,JK)},QK=Ut,e4=lj,t4=br,r4=Ht,n4=Br,o4=Jd;r0.f=QK&&!e4?Object.defineProperties:function(t,r){r4(t);for(var n=n4(r),o=o4(r),i=o.length,a=0,l;i>a;)t4.f(t,l=o[a++],n[l]);return t};var i4=jo,Sj=i4("document","documentElement"),a4=Ht,l4=r0,TP=e0,s4=qd,u4=Sj,f4=Qp,c4=em,kP=">",PP="<",eC="prototype",tC="script",Cj=c4("IE_PROTO"),Eb=function(){},_j=function(e){return PP+tC+kP+e+PP+"/"+tC+kP},$P=function(e){e.write(_j("")),e.close();var t=e.parentWindow.Object;return e=null,t},h4=function(){var e=f4("iframe"),t="java"+tC+":",r;return e.style.display="none",u4.appendChild(e),e.src=String(t),r=e.contentWindow.document,r.open(),r.write(_j("document.F=Object")),r.close(),r.F},Vv,Ky=function(){try{Vv=new ActiveXObject("htmlfile")}catch{}Ky=typeof document<"u"?document.domain&&Vv?$P(Vv):h4():$P(Vv);for(var e=TP.length;e--;)delete Ky[eC][TP[e]];return Ky()};s4[Cj]=!0;var tl=Object.create||function(t,r){var n;return t!==null?(Eb[eC]=a4(t),n=new Eb,Eb[eC]=null,n[Cj]=t):n=Ky(),r===void 0?n:l4.f(n,r)},AP=vj,d4=br,Qd=function(e,t,r){return r.get&&AP(r.get,t,{getter:!0}),r.set&&AP(r.set,t,{setter:!0}),d4.f(e,t,r)},n0={},v4=wt;n0.f=v4;var y4=vt,Oj=y4,IP=Oj,g4=Mt,p4=n0,m4=br.f,o0=function(e){var t=IP.Symbol||(IP.Symbol={});g4(t,e)||m4(t,e,{value:p4.f(e)})},b4=zt,w4=jo,S4=wt,C4=Zr,Rj=function(){var e=w4("Symbol"),t=e&&e.prototype,r=t&&t.valueOf,n=S4("toPrimitive");t&&!t[n]&&C4(t,n,function(o){return b4(r,this)},{arity:1})},_4=br.f,O4=Mt,R4=wt,MP=R4("toStringTag"),ev=function(e,t,r){e&&!r&&(e=e.prototype),e&&!O4(e,MP)&&_4(e,MP,{configurable:!0,value:t})},E4=Fn,T4=Ue,im=function(e){if(E4(e)==="Function")return T4(e)},xP=im,k4=qa,P4=Vd,$4=xP(xP.bind),tv=function(e,t){return k4(e),t===void 0?e:P4?$4(e,t):function(){return e.apply(t,arguments)}},A4=Fn,Cf=Array.isArray||function(t){return A4(t)==="Array"},I4=Ue,M4=je,Ej=Et,x4=om,D4=jo,N4=fj,Tj=function(){},kj=D4("Reflect","construct"),i0=/^\s*(?:class|function)\b/,H4=I4(i0.exec),L4=!i0.test(Tj),Nf=function(t){if(!Ej(t))return!1;try{return kj(Tj,[],t),!0}catch{return!1}},Pj=function(t){if(!Ej(t))return!1;switch(x4(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return L4||!!H4(i0,N4(t))}catch{return!0}};Pj.sham=!0;var am=!kj||M4(function(){var e;return Nf(Nf.call)||!Nf(Object)||!Nf(function(){e=!0})||e})?Pj:Nf,DP=Cf,j4=am,F4=Nt,B4=wt,V4=B4("species"),NP=Array,W4=function(e){var t;return DP(e)&&(t=e.constructor,j4(t)&&(t===NP||DP(t.prototype))?t=void 0:F4(t)&&(t=t[V4],t===null&&(t=void 0))),t===void 0?NP:t},U4=W4,a0=function(e,t){return new(U4(e))(t===0?0:t)},z4=tv,Y4=Ue,G4=zd,K4=kr,q4=bn,X4=a0,HP=Y4([].push),zo=function(e){var t=e===1,r=e===2,n=e===3,o=e===4,i=e===6,a=e===7,l=e===5||i;return function(s,u,f,c){for(var h=K4(s),d=G4(h),v=q4(d),g=z4(u,f),m=0,w=c||X4,S=t?w(s,v):r||a?w(s,0):void 0,C,k;v>m;m++)if((l||m in d)&&(C=d[m],k=g(C,m,h),e))if(t)S[m]=k;else if(k)switch(e){case 3:return!0;case 5:return C;case 6:return m;case 2:HP(S,C)}else switch(e){case 4:return!1;case 7:HP(S,C)}return i?-1:n||o?o:S}},rl={forEach:zo(0),map:zo(1),filter:zo(2),some:zo(3),every:zo(4),find:zo(5),findIndex:zo(6),filterReject:zo(7)},lm=Ae,rv=vt,l0=zt,Z4=Ue,fs=Ut,cs=bf,J4=je,er=Mt,Q4=Ai,rC=Ht,sm=Br,s0=Jp,e6=Yt,nC=Ud,hs=tl,$j=Jd,t6=Ja,Aj=nm,r6=Xd,Ij=jn,Mj=br,n6=r0,xj=Wd,Tb=Zr,o6=Qd,u0=Sf,i6=em,Dj=qd,LP=Zp,a6=wt,l6=n0,s6=o0,u6=Rj,f6=ev,Nj=Fo,um=rl.forEach,Er=i6("hidden"),fm="Symbol",Hc="prototype",c6=Nj.set,jP=Nj.getterFor(fm),qr=Object[Hc],$a=rv.Symbol,hc=$a&&$a[Hc],h6=rv.RangeError,d6=rv.TypeError,kb=rv.QObject,Hj=Ij.f,Aa=Mj.f,Lj=Aj.f,v6=xj.f,jj=Z4([].push),xo=u0("symbols"),nv=u0("op-symbols"),y6=u0("wks"),oC=!kb||!kb[Hc]||!kb[Hc].findChild,Fj=function(e,t,r){var n=Hj(qr,t);n&&delete qr[t],Aa(e,t,r),n&&e!==qr&&Aa(qr,t,n)},iC=fs&&J4(function(){return hs(Aa({},"a",{get:function(){return Aa(this,"a",{value:7}).a}})).a!==7})?Fj:Aa,Pb=function(e,t){var r=xo[e]=hs(hc);return c6(r,{type:fm,tag:e,description:t}),fs||(r.description=t),r},cm=function(t,r,n){t===qr&&cm(nv,r,n),rC(t);var o=s0(r);return rC(n),er(xo,o)?(n.enumerable?(er(t,Er)&&t[Er][o]&&(t[Er][o]=!1),n=hs(n,{enumerable:nC(0,!1)})):(er(t,Er)||Aa(t,Er,nC(1,hs(null))),t[Er][o]=!0),iC(t,o,n)):Aa(t,o,n)},f0=function(t,r){rC(t);var n=sm(r),o=$j(n).concat(Wj(n));return um(o,function(i){(!fs||l0(aC,n,i))&&cm(t,i,n[i])}),t},g6=function(t,r){return r===void 0?hs(t):f0(hs(t),r)},aC=function(t){var r=s0(t),n=l0(v6,this,r);return this===qr&&er(xo,r)&&!er(nv,r)?!1:n||!er(this,r)||!er(xo,r)||er(this,Er)&&this[Er][r]?n:!0},Bj=function(t,r){var n=sm(t),o=s0(r);if(!(n===qr&&er(xo,o)&&!er(nv,o))){var i=Hj(n,o);return i&&er(xo,o)&&!(er(n,Er)&&n[Er][o])&&(i.enumerable=!0),i}},Vj=function(t){var r=Lj(sm(t)),n=[];return um(r,function(o){!er(xo,o)&&!er(Dj,o)&&jj(n,o)}),n},Wj=function(e){var t=e===qr,r=Lj(t?nv:sm(e)),n=[];return um(r,function(o){er(xo,o)&&(!t||er(qr,o))&&jj(n,xo[o])}),n};cs||($a=function(){if(Q4(hc,this))throw new d6("Symbol is not a constructor");var t=!arguments.length||arguments[0]===void 0?void 0:e6(arguments[0]),r=LP(t),n=function(o){var i=this===void 0?rv:this;i===qr&&l0(n,nv,o),er(i,Er)&&er(i[Er],r)&&(i[Er][r]=!1);var a=nC(1,o);try{iC(i,r,a)}catch(l){if(!(l instanceof h6))throw l;Fj(i,r,a)}};return fs&&oC&&iC(qr,r,{configurable:!0,set:n}),Pb(r,t)},hc=$a[Hc],Tb(hc,"toString",function(){return jP(this).tag}),Tb($a,"withoutSetter",function(e){return Pb(LP(e),e)}),xj.f=aC,Mj.f=cm,n6.f=f0,Ij.f=Bj,t6.f=Aj.f=Vj,r6.f=Wj,l6.f=function(e){return Pb(a6(e),e)},fs&&(o6(hc,"description",{configurable:!0,get:function(){return jP(this).description}}),Tb(qr,"propertyIsEnumerable",aC,{unsafe:!0})));lm({global:!0,constructor:!0,wrap:!0,forced:!cs,sham:!cs},{Symbol:$a});um($j(y6),function(e){s6(e)});lm({target:fm,stat:!0,forced:!cs},{useSetter:function(){oC=!0},useSimple:function(){oC=!1}});lm({target:"Object",stat:!0,forced:!cs,sham:!fs},{create:g6,defineProperty:cm,defineProperties:f0,getOwnPropertyDescriptor:Bj});lm({target:"Object",stat:!0,forced:!cs},{getOwnPropertyNames:Vj});u6();f6($a,fm);Dj[Er]=!0;var p6=bf,Uj=p6&&!!Symbol.for&&!!Symbol.keyFor,m6=Ae,b6=jo,w6=Mt,S6=Yt,zj=Sf,C6=Uj,$b=zj("string-to-symbol-registry"),_6=zj("symbol-to-string-registry");m6({target:"Symbol",stat:!0,forced:!C6},{for:function(e){var t=S6(e);if(w6($b,t))return $b[t];var r=b6("Symbol")(t);return $b[t]=r,_6[r]=t,r}});var O6=Ae,R6=Mt,E6=Gd,T6=wf,k6=Sf,P6=Uj,FP=k6("symbol-to-string-registry");O6({target:"Symbol",stat:!0,forced:!P6},{keyFor:function(t){if(!E6(t))throw new TypeError(T6(t)+" is not a symbol");if(R6(FP,t))return FP[t]}});var $6=Vd,Yj=Function.prototype,BP=Yj.apply,VP=Yj.call,_f=typeof Reflect=="object"&&Reflect.apply||($6?VP.bind(BP):function(){return VP.apply(BP,arguments)}),A6=Ue,WP=Cf,I6=Et,UP=Fn,M6=Yt,zP=A6([].push),x6=function(e){if(I6(e))return e;if(WP(e)){for(var t=e.length,r=[],n=0;n<t;n++){var o=e[n];typeof o=="string"?zP(r,o):(typeof o=="number"||UP(o)==="Number"||UP(o)==="String")&&zP(r,M6(o))}var i=r.length,a=!0;return function(l,s){if(a)return a=!1,s;if(WP(this))return s;for(var u=0;u<i;u++)if(r[u]===l)return s}}},D6=Ae,Gj=jo,Kj=_f,N6=zt,ov=Ue,qj=je,YP=Et,GP=Gd,Xj=el,H6=x6,L6=bf,j6=String,fi=Gj("JSON","stringify"),Wv=ov(/./.exec),KP=ov("".charAt),F6=ov("".charCodeAt),B6=ov("".replace),V6=ov(1 .toString),W6=/[\uD800-\uDFFF]/g,qP=/^[\uD800-\uDBFF]$/,XP=/^[\uDC00-\uDFFF]$/,ZP=!L6||qj(function(){var e=Gj("Symbol")("stringify detection");return fi([e])!=="[null]"||fi({a:e})!=="{}"||fi(Object(e))!=="{}"}),JP=qj(function(){return fi("\uDF06\uD834")!=='"\\udf06\\ud834"'||fi("\uDEAD")!=='"\\udead"'}),U6=function(e,t){var r=Xj(arguments),n=H6(t);if(!(!YP(n)&&(e===void 0||GP(e))))return r[1]=function(o,i){if(YP(n)&&(i=N6(n,this,j6(o),i)),!GP(i))return i},Kj(fi,null,r)},z6=function(e,t,r){var n=KP(r,t-1),o=KP(r,t+1);return Wv(qP,e)&&!Wv(XP,o)||Wv(XP,e)&&!Wv(qP,n)?"\\u"+V6(F6(e,0),16):e};fi&&D6({target:"JSON",stat:!0,arity:3,forced:ZP||JP},{stringify:function(t,r,n){var o=Xj(arguments),i=Kj(ZP?U6:fi,null,o);return JP&&typeof i=="string"?B6(i,W6,z6):i}});var Y6=Ae,G6=bf,K6=je,Zj=Xd,q6=kr,X6=!G6||K6(function(){Zj.f(1)});Y6({target:"Object",stat:!0,forced:X6},{getOwnPropertySymbols:function(t){var r=Zj.f;return r?r(q6(t)):[]}});var Z6=Ae,J6=Ut,Q6=vt,Uv=Ue,e8=Mt,t8=Et,r8=Ai,n8=Yt,o8=Qd,i8=pj,eo=Q6.Symbol,Hi=eo&&eo.prototype;if(J6&&t8(eo)&&(!("description"in Hi)||eo().description!==void 0)){var QP={},zv=function(){var t=arguments.length<1||arguments[0]===void 0?void 0:n8(arguments[0]),r=r8(Hi,this)?new eo(t):t===void 0?eo():eo(t);return t===""&&(QP[r]=!0),r};i8(zv,eo),zv.prototype=Hi,Hi.constructor=zv;var a8=String(eo("description detection"))==="Symbol(description detection)",l8=Uv(Hi.valueOf),s8=Uv(Hi.toString),u8=/^Symbol\((.*)\)[^)]+$/,f8=Uv("".replace),c8=Uv("".slice);o8(Hi,"description",{configurable:!0,get:function(){var t=l8(this);if(e8(QP,t))return"";var r=s8(t),n=a8?c8(r,7,-1):f8(r,u8,"$1");return n===""?void 0:n}}),Z6({global:!0,constructor:!0,forced:!0},{Symbol:zv})}var h8=o0;h8("iterator");var d8=Ut,v8=Kd.EXISTS,Jj=Ue,y8=Qd,Qj=Function.prototype,g8=Jj(Qj.toString),eF=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,p8=Jj(eF.exec),m8="name";d8&&!v8&&y8(Qj,m8,{configurable:!0,get:function(){try{return p8(eF,g8(this))[1]}catch{return""}}});var b8=je,c0=!b8(function(){return Object.isExtensible(Object.preventExtensions({}))}),tF={exports:{}},w8=je,S8=w8(function(){if(typeof ArrayBuffer=="function"){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}),C8=je,_8=Nt,O8=Fn,e$=S8,qy=Object.isExtensible,R8=C8(function(){qy(1)}),E8=R8||e$?function(t){return!_8(t)||e$&&O8(t)==="ArrayBuffer"?!1:qy?qy(t):!0}:qy,T8=Ae,k8=Ue,P8=qd,$8=Nt,h0=Mt,A8=br.f,t$=Ja,I8=nm,d0=E8,M8=Zp,x8=c0,rF=!1,Do=M8("meta"),D8=0,v0=function(e){A8(e,Do,{value:{objectID:"O"+D8++,weakData:{}}})},N8=function(e,t){if(!$8(e))return typeof e=="symbol"?e:(typeof e=="string"?"S":"P")+e;if(!h0(e,Do)){if(!d0(e))return"F";if(!t)return"E";v0(e)}return e[Do].objectID},H8=function(e,t){if(!h0(e,Do)){if(!d0(e))return!0;if(!t)return!1;v0(e)}return e[Do].weakData},L8=function(e){return x8&&rF&&d0(e)&&!h0(e,Do)&&v0(e),e},j8=function(){F8.enable=function(){},rF=!0;var e=t$.f,t=k8([].splice),r={};r[Do]=1,e(r).length&&(t$.f=function(n){for(var o=e(n),i=0,a=o.length;i<a;i++)if(o[i]===Do){t(o,i,1);break}return o},T8({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:I8.f}))},F8=tF.exports={enable:j8,fastKey:N8,getWeakData:H8,onFreeze:L8};P8[Do]=!0;var iv=tF.exports,B8=Ae,V8=c0,W8=je,U8=Nt,z8=iv.onFreeze,lC=Object.freeze,Y8=W8(function(){lC(1)});B8({target:"Object",stat:!0,forced:Y8,sham:!V8},{freeze:function(t){return lC&&U8(t)?lC(z8(t)):t}});var G8=wt,K8=tl,q8=br.f,sC=G8("unscopables"),uC=Array.prototype;uC[sC]===void 0&&q8(uC,sC,{configurable:!0,value:K8(null)});var av=function(e){uC[sC][e]=!0},lv={},X8=je,nF=!X8(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),Z8=Mt,J8=Et,Q8=kr,e5=em,t5=nF,r$=e5("IE_PROTO"),fC=Object,r5=fC.prototype,sv=t5?fC.getPrototypeOf:function(e){var t=Q8(e);if(Z8(t,r$))return t[r$];var r=t.constructor;return J8(r)&&t instanceof r?r.prototype:t instanceof fC?r5:null},n5=je,o5=Et,i5=Nt,n$=sv,a5=Zr,l5=wt,cC=l5("iterator"),oF=!1,xa,Ab,Ib;[].keys&&(Ib=[].keys(),"next"in Ib?(Ab=n$(n$(Ib)),Ab!==Object.prototype&&(xa=Ab)):oF=!0);var s5=!i5(xa)||n5(function(){var e={};return xa[cC].call(e)!==e});s5&&(xa={});o5(xa[cC])||a5(xa,cC,function(){return this});var iF={IteratorPrototype:xa,BUGGY_SAFARI_ITERATORS:oF},u5=iF.IteratorPrototype,f5=tl,c5=Ud,h5=ev,d5=lv,v5=function(){return this},y5=function(e,t,r,n){var o=t+" Iterator";return e.prototype=f5(u5,{next:c5(+!n,r)}),h5(e,o,!1),d5[o]=v5,e},g5=Ue,p5=qa,m5=function(e,t,r){try{return g5(p5(Object.getOwnPropertyDescriptor(e,t)[r]))}catch{}},b5=Nt,w5=function(e){return b5(e)||e===null},S5=w5,C5=String,_5=TypeError,O5=function(e){if(S5(e))return e;throw new _5("Can't set "+C5(e)+" as a prototype")},R5=m5,E5=Ht,T5=O5,y0=Object.setPrototypeOf||("__proto__"in{}?function(){var e=!1,t={},r;try{r=R5(Object.prototype,"__proto__","set"),r(t,[]),e=t instanceof Array}catch{}return function(o,i){return E5(o),T5(i),e?r(o,i):o.__proto__=i,o}}():void 0),k5=Ae,P5=zt,aF=Kd,$5=Et,A5=y5,o$=sv,i$=y0,I5=ev,M5=Za,Mb=Zr,x5=wt,D5=lv,lF=iF,N5=aF.PROPER,H5=aF.CONFIGURABLE,a$=lF.IteratorPrototype,Yv=lF.BUGGY_SAFARI_ITERATORS,Hf=x5("iterator"),l$="keys",Lf="values",s$="entries",L5=function(){return this},g0=function(e,t,r,n,o,i,a){A5(r,t,n);var l=function(w){if(w===o&&h)return h;if(!Yv&&w&&w in f)return f[w];switch(w){case l$:return function(){return new r(this,w)};case Lf:return function(){return new r(this,w)};case s$:return function(){return new r(this,w)}}return function(){return new r(this)}},s=t+" Iterator",u=!1,f=e.prototype,c=f[Hf]||f["@@iterator"]||o&&f[o],h=!Yv&&c||l(o),d=t==="Array"&&f.entries||c,v,g,m;if(d&&(v=o$(d.call(new e)),v!==Object.prototype&&v.next&&(o$(v)!==a$&&(i$?i$(v,a$):$5(v[Hf])||Mb(v,Hf,L5)),I5(v,s,!0))),N5&&o===Lf&&c&&c.name!==Lf&&(H5?M5(f,"name",Lf):(u=!0,h=function(){return P5(c,this)})),o)if(g={values:l(Lf),keys:i?h:l(l$),entries:l(s$)},a)for(m in g)(Yv||u||!(m in f))&&Mb(f,m,g[m]);else k5({target:t,proto:!0,forced:Yv||u},g);return f[Hf]!==h&&Mb(f,Hf,h,{name:o}),D5[t]=h,g},p0=function(e,t){return{value:e,done:t}},j5=Br,m0=av,u$=lv,sF=Fo,F5=br.f,B5=g0,Gv=p0,V5=Ut,uF="Array Iterator",W5=sF.set,U5=sF.getterFor(uF),z5=B5(Array,"Array",function(e,t){W5(this,{type:uF,target:j5(e),index:0,kind:t})},function(){var e=U5(this),t=e.target,r=e.index++;if(!t||r>=t.length)return e.target=void 0,Gv(void 0,!0);switch(e.kind){case"keys":return Gv(r,!1);case"values":return Gv(t[r],!1)}return Gv([r,t[r]],!1)},"values"),f$=u$.Arguments=u$.Array;m0("keys");m0("values");m0("entries");if(V5&&f$.name!=="values")try{F5(f$,"name",{value:"values"})}catch{}var Y5=t0,G5=om,K5=Y5?{}.toString:function(){return"[object "+G5(this)+"]"},q5=t0,X5=Zr,Z5=K5;q5||X5(Object.prototype,"toString",Z5,{unsafe:!0});var J5=wt,Q5=lv,e7=J5("iterator"),t7=Array.prototype,fF=function(e){return e!==void 0&&(Q5.Array===e||t7[e7]===e)},r7=om,c$=Xa,n7=mn,o7=lv,i7=wt,a7=i7("iterator"),b0=function(e){if(!n7(e))return c$(e,a7)||c$(e,"@@iterator")||o7[r7(e)]},l7=zt,s7=qa,u7=Ht,f7=wf,c7=b0,h7=TypeError,cF=function(e,t){var r=arguments.length<2?c7(e):t;if(s7(r))return u7(l7(r,e));throw new h7(f7(e)+" is not iterable")},d7=zt,h$=Ht,v7=Xa,hF=function(e,t,r){var n,o;h$(e);try{if(n=v7(e,"return"),!n){if(t==="throw")throw r;return r}n=d7(n,e)}catch(i){o=!0,n=i}if(t==="throw")throw r;if(o)throw n;return h$(n),r},y7=tv,g7=zt,p7=Ht,m7=wf,b7=fF,w7=bn,d$=Ai,S7=cF,C7=b0,v$=hF,_7=TypeError,Xy=function(e,t){this.stopped=e,this.result=t},y$=Xy.prototype,w0=function(e,t,r){var n=r&&r.that,o=!!(r&&r.AS_ENTRIES),i=!!(r&&r.IS_RECORD),a=!!(r&&r.IS_ITERATOR),l=!!(r&&r.INTERRUPTED),s=y7(t,n),u,f,c,h,d,v,g,m=function(S){return u&&v$(u,"normal",S),new Xy(!0,S)},w=function(S){return o?(p7(S),l?s(S[0],S[1],m):s(S[0],S[1])):l?s(S,m):s(S)};if(i)u=e.iterator;else if(a)u=e;else{if(f=C7(e),!f)throw new _7(m7(e)+" is not iterable");if(b7(f)){for(c=0,h=w7(e);h>c;c++)if(d=w(e[c]),d&&d$(y$,d))return d;return new Xy(!1)}u=S7(e,f)}for(v=i?e.next:u.next;!(g=g7(v,u)).done;){try{d=w(g.value)}catch(S){v$(u,"throw",S)}if(typeof d=="object"&&d&&d$(y$,d))return d}return new Xy(!1)},O7=Ai,R7=TypeError,S0=function(e,t){if(O7(t,e))return e;throw new R7("Incorrect invocation")},E7=wt,dF=E7("iterator"),vF=!1;try{var T7=0,g$={next:function(){return{done:!!T7++}},return:function(){vF=!0}};g$[dF]=function(){return this},Array.from(g$,function(){throw 2})}catch{}var yF=function(e,t){try{if(!t&&!vF)return!1}catch{return!1}var r=!1;try{var n={};n[dF]=function(){return{next:function(){return{done:r=!0}}}},e(n)}catch{}return r},k7=Et,P7=Nt,p$=y0,C0=function(e,t,r){var n,o;return p$&&k7(n=t.constructor)&&n!==r&&P7(o=n.prototype)&&o!==r.prototype&&p$(e,o),e},$7=Ae,A7=vt,I7=Ue,m$=rm,M7=Zr,x7=iv,D7=w0,N7=S0,H7=Et,L7=mn,xb=Nt,Db=je,j7=yF,F7=ev,B7=C0,hm=function(e,t,r){var n=e.indexOf("Map")!==-1,o=e.indexOf("Weak")!==-1,i=n?"set":"add",a=A7[e],l=a&&a.prototype,s=a,u={},f=function(w){var S=I7(l[w]);M7(l,w,w==="add"?function(k){return S(this,k===0?0:k),this}:w==="delete"?function(C){return o&&!xb(C)?!1:S(this,C===0?0:C)}:w==="get"?function(k){return o&&!xb(k)?void 0:S(this,k===0?0:k)}:w==="has"?function(k){return o&&!xb(k)?!1:S(this,k===0?0:k)}:function(k,R){return S(this,k===0?0:k,R),this})},c=m$(e,!H7(a)||!(o||l.forEach&&!Db(function(){new a().entries().next()})));if(c)s=r.getConstructor(t,e,n,i),x7.enable();else if(m$(e,!0)){var h=new s,d=h[i](o?{}:-0,1)!==h,v=Db(function(){h.has(1)}),g=j7(function(w){new a(w)}),m=!o&&Db(function(){for(var w=new a,S=5;S--;)w[i](S,S);return!w.has(-0)});g||(s=t(function(w,S){N7(w,l);var C=B7(new a,w,s);return L7(S)||D7(S,C[i],{that:C,AS_ENTRIES:n}),C}),s.prototype=l,l.constructor=s),(v||m)&&(f("delete"),f("has"),n&&f("get")),(m||d)&&f(i),o&&l.clear&&delete l.clear}return u[e]=s,$7({global:!0,constructor:!0,forced:s!==a},u),F7(s,e),o||r.setStrong(s,e,n),s},V7=Zr,_0=function(e,t,r){for(var n in t)V7(e,n,t[n],r);return e},W7=jo,U7=Qd,z7=wt,Y7=Ut,b$=z7("species"),gF=function(e){var t=W7(e);Y7&&t&&!t[b$]&&U7(t,b$,{configurable:!0,get:function(){return this}})},w$=tl,G7=Qd,S$=_0,K7=tv,q7=S0,X7=mn,Z7=w0,J7=g0,Kv=p0,Q7=gF,jf=Ut,C$=iv.fastKey,pF=Fo,_$=pF.set,Nb=pF.getterFor,mF={getConstructor:function(e,t,r,n){var o=e(function(u,f){q7(u,i),_$(u,{type:t,index:w$(null),first:void 0,last:void 0,size:0}),jf||(u.size=0),X7(f)||Z7(f,u[n],{that:u,AS_ENTRIES:r})}),i=o.prototype,a=Nb(t),l=function(u,f,c){var h=a(u),d=s(u,f),v,g;return d?d.value=c:(h.last=d={index:g=C$(f,!0),key:f,value:c,previous:v=h.last,next:void 0,removed:!1},h.first||(h.first=d),v&&(v.next=d),jf?h.size++:u.size++,g!=="F"&&(h.index[g]=d)),u},s=function(u,f){var c=a(u),h=C$(f),d;if(h!=="F")return c.index[h];for(d=c.first;d;d=d.next)if(d.key===f)return d};return S$(i,{clear:function(){for(var f=this,c=a(f),h=c.first;h;)h.removed=!0,h.previous&&(h.previous=h.previous.next=void 0),h=h.next;c.first=c.last=void 0,c.index=w$(null),jf?c.size=0:f.size=0},delete:function(u){var f=this,c=a(f),h=s(f,u);if(h){var d=h.next,v=h.previous;delete c.index[h.index],h.removed=!0,v&&(v.next=d),d&&(d.previous=v),c.first===h&&(c.first=d),c.last===h&&(c.last=v),jf?c.size--:f.size--}return!!h},forEach:function(f){for(var c=a(this),h=K7(f,arguments.length>1?arguments[1]:void 0),d;d=d?d.next:c.first;)for(h(d.value,d.key,this);d&&d.removed;)d=d.previous},has:function(f){return!!s(this,f)}}),S$(i,r?{get:function(f){var c=s(this,f);return c&&c.value},set:function(f,c){return l(this,f===0?0:f,c)}}:{add:function(f){return l(this,f=f===0?0:f,f)}}),jf&&G7(i,"size",{configurable:!0,get:function(){return a(this).size}}),o},setStrong:function(e,t,r){var n=t+" Iterator",o=Nb(t),i=Nb(n);J7(e,t,function(a,l){_$(this,{type:n,target:a,state:o(a),kind:l,last:void 0})},function(){for(var a=i(this),l=a.kind,s=a.last;s&&s.removed;)s=s.previous;return!a.target||!(a.last=s=s?s.next:a.state.first)?(a.target=void 0,Kv(void 0,!0)):Kv(l==="keys"?s.key:l==="values"?s.value:[s.key,s.value],!1)},r?"entries":"values",!r,!0),Q7(t)}},e9=hm,t9=mF;e9("Set",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},t9);var O0=Ue,r9=Ii,n9=Yt,o9=Tr,i9=O0("".charAt),O$=O0("".charCodeAt),a9=O0("".slice),R$=function(e){return function(t,r){var n=n9(o9(t)),o=r9(r),i=n.length,a,l;return o<0||o>=i?e?"":void 0:(a=O$(n,o),a<55296||a>56319||o+1===i||(l=O$(n,o+1))<56320||l>57343?e?i9(n,o):a:e?a9(n,o,o+2):(a-55296<<10)+(l-56320)+65536)}},R0={codeAt:R$(!1),charAt:R$(!0)},l9=R0.charAt,s9=Yt,bF=Fo,u9=g0,E$=p0,wF="String Iterator",f9=bF.set,c9=bF.getterFor(wF);u9(String,"String",function(e){f9(this,{type:wF,string:s9(e),index:0})},function(){var t=c9(this),r=t.string,n=t.index,o;return n>=r.length?E$(void 0,!0):(o=l9(r,n),t.index+=o.length,E$(o,!1))});var SF={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},h9=Qp,Hb=h9("span").classList,T$=Hb&&Hb.constructor&&Hb.constructor.prototype,CF=T$===Object.prototype?void 0:T$,k$=vt,_F=SF,d9=CF,dc=z5,P$=Za,v9=ev,y9=wt,Lb=y9("iterator"),jb=dc.values,OF=function(e,t){if(e){if(e[Lb]!==jb)try{P$(e,Lb,jb)}catch{e[Lb]=jb}if(v9(e,t,!0),_F[t]){for(var r in dc)if(e[r]!==dc[r])try{P$(e,r,dc[r])}catch{e[r]=dc[r]}}}};for(var Fb in _F)OF(k$[Fb]&&k$[Fb].prototype,Fb);OF(d9,"DOMTokenList");var g9=Ae,p9=QR.includes,m9=je,b9=av,w9=m9(function(){return!Array(1).includes()});g9({target:"Array",proto:!0,forced:w9},{includes:function(t){return p9(this,t,arguments.length>1?arguments[1]:void 0)}});b9("includes");var $$=wf,S9=TypeError,RF=function(e,t){if(!delete e[t])throw new S9("Cannot delete property "+$$(t)+" of "+$$(e))},A$=el,C9=Math.floor,hC=function(e,t){var r=e.length;if(r<8)for(var n=1,o,i;n<r;){for(i=n,o=e[n];i&&t(e[i-1],o)>0;)e[i]=e[--i];i!==n++&&(e[i]=o)}else for(var a=C9(r/2),l=hC(A$(e,0,a),t),s=hC(A$(e,a),t),u=l.length,f=s.length,c=0,h=0;c<u||h<f;)e[c+h]=c<u&&h<f?t(l[c],s[h])<=0?l[c++]:s[h++]:c<u?l[c++]:s[h++];return e},_9=hC,O9=je,Of=function(e,t){var r=[][e];return!!r&&O9(function(){r.call(null,t||function(){return 1},1)})},R9=Ka,I$=R9.match(/firefox\/(\d+)/i),E9=!!I$&&+I$[1],T9=Ka,k9=/MSIE|Trident/.test(T9),P9=Ka,M$=P9.match(/AppleWebKit\/(\d+)\./),$9=!!M$&&+M$[1],A9=Ae,EF=Ue,I9=qa,M9=kr,x$=bn,x9=RF,D$=Yt,E0=je,D9=_9,N9=Of,N$=E9,H9=k9,H$=Yd,L$=$9,li=[],j$=EF(li.sort),L9=EF(li.push),j9=E0(function(){li.sort(void 0)}),F9=E0(function(){li.sort(null)}),B9=N9("sort"),TF=!E0(function(){if(H$)return H$<70;if(!(N$&&N$>3)){if(H9)return!0;if(L$)return L$<603;var e="",t,r,n,o;for(t=65;t<76;t++){switch(r=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(o=0;o<47;o++)li.push({k:r+o,v:n})}for(li.sort(function(i,a){return a.v-i.v}),o=0;o<li.length;o++)r=li[o].k.charAt(0),e.charAt(e.length-1)!==r&&(e+=r);return e!=="DGBEFHACIJK"}}),V9=j9||!F9||!B9||!TF,W9=function(e){return function(t,r){return r===void 0?-1:t===void 0?1:e!==void 0?+e(t,r)||0:D$(t)>D$(r)?1:-1}};A9({target:"Array",proto:!0,forced:V9},{sort:function(t){t!==void 0&&I9(t);var r=M9(this);if(TF)return t===void 0?j$(r):j$(r,t);var n=[],o=x$(r),i,a;for(a=0;a<o;a++)a in r&&L9(n,r[a]);for(D9(n,W9(t)),i=x$(n),a=0;a<i;)r[a]=n[a++];for(;a<o;)x9(r,a++);return r}});var U9=Ut,z9=Cf,Y9=TypeError,G9=Object.getOwnPropertyDescriptor,K9=U9&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}(),q9=K9?function(e,t){if(z9(e)&&!G9(e,"length").writable)throw new Y9("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t},X9=TypeError,Z9=9007199254740991,kF=function(e){if(e>Z9)throw X9("Maximum allowed index exceeded");return e},J9=Jp,Q9=br,eq=Ud,uv=function(e,t,r){var n=J9(t);n in e?Q9.f(e,n,eq(0,r)):e[n]=r},tq=je,rq=wt,nq=Yd,oq=rq("species"),fv=function(e){return nq>=51||!tq(function(){var t=[],r=t.constructor={};return r[oq]=function(){return{foo:1}},t[e](Boolean).foo!==1})},iq=Ae,aq=kr,lq=tm,sq=Ii,uq=bn,fq=q9,cq=kF,hq=a0,dq=uv,Bb=RF,vq=fv,yq=vq("splice"),gq=Math.max,pq=Math.min;iq({target:"Array",proto:!0,forced:!yq},{splice:function(t,r){var n=aq(this),o=uq(n),i=lq(t,o),a=arguments.length,l,s,u,f,c,h;for(a===0?l=s=0:a===1?(l=0,s=o-i):(l=a-2,s=pq(gq(sq(r),0),o-i)),cq(o+l-s),u=hq(n,s),f=0;f<s;f++)c=i+f,c in n&&dq(u,f,n[c]);if(u.length=s,l<s){for(f=i;f<o-s;f++)c=f+s,h=f+l,c in n?n[h]=n[c]:Bb(n,h);for(f=o;f>o-s+l;f--)Bb(n,f-1)}else if(l>s)for(f=o-s;f>i;f--)c=f+s-1,h=f+l-1,c in n?n[h]=n[c]:Bb(n,h);for(f=0;f<l;f++)n[f+i]=arguments[f+2];return fq(n,o-s+l),u}});var mq=Nt,bq=Math.floor,wq=Number.isInteger||function(t){return!mq(t)&&isFinite(t)&&bq(t)===t},Sq=Ae,Cq=wq;Sq({target:"Number",stat:!0},{isInteger:Cq});var _q=Ue,PF=_q(1 .valueOf),$F=`	
\v\f\r Â áââââââââââââ¯âã\u2028\u2029\uFEFF`,Oq=Ue,Rq=Tr,Eq=Yt,dC=$F,F$=Oq("".replace),Tq=RegExp("^["+dC+"]+"),kq=RegExp("(^|[^"+dC+"])["+dC+"]+$"),Vb=function(e){return function(t){var r=Eq(Rq(t));return e&1&&(r=F$(r,Tq,"")),e&2&&(r=F$(r,kq,"$1")),r}},AF={start:Vb(1),end:Vb(2),trim:Vb(3)},Pq=Ae,IF=sG,$q=Ut,MF=vt,xF=Oj,DF=Ue,Aq=rm,B$=Mt,Iq=C0,Mq=Ai,xq=Gd,NF=ij,Dq=je,Nq=Ja.f,Hq=jn.f,Lq=br.f,jq=PF,Fq=AF.trim,dm="Number",ql=MF[dm];xF[dm];var T0=ql.prototype,Bq=MF.TypeError,Vq=DF("".slice),qv=DF("".charCodeAt),Wq=function(e){var t=NF(e,"number");return typeof t=="bigint"?t:Uq(t)},Uq=function(e){var t=NF(e,"number"),r,n,o,i,a,l,s,u;if(xq(t))throw new Bq("Cannot convert a Symbol value to a number");if(typeof t=="string"&&t.length>2){if(t=Fq(t),r=qv(t,0),r===43||r===45){if(n=qv(t,2),n===88||n===120)return NaN}else if(r===48){switch(qv(t,1)){case 66:case 98:o=2,i=49;break;case 79:case 111:o=8,i=55;break;default:return+t}for(a=Vq(t,2),l=a.length,s=0;s<l;s++)if(u=qv(a,s),u<48||u>i)return NaN;return parseInt(a,o)}}return+t},k0=Aq(dm,!ql(" 0o1")||!ql("0b1")||ql("+0x1")),zq=function(e){return Mq(T0,e)&&Dq(function(){jq(e)})},vm=function(t){var r=arguments.length<1?0:ql(Wq(t));return zq(this)?Iq(Object(r),this,vm):r};vm.prototype=T0;k0&&!IF&&(T0.constructor=vm);Pq({global:!0,constructor:!0,wrap:!0,forced:k0},{Number:vm});var Yq=function(e,t){for(var r=$q?Nq(t):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),n=0,o;r.length>n;n++)B$(t,o=r[n])&&!B$(e,o)&&Lq(e,o,Hq(t,o))};(k0||IF)&&Yq(xF[dm],ql);var Gq=Ae,V$=Cf,Kq=am,qq=Nt,W$=tm,Xq=bn,Zq=Br,Jq=uv,Qq=wt,eX=fv,tX=el,rX=eX("slice"),nX=Qq("species"),Wb=Array,oX=Math.max;Gq({target:"Array",proto:!0,forced:!rX},{slice:function(t,r){var n=Zq(this),o=Xq(n),i=W$(t,o),a=W$(r===void 0?o:r,o),l,s,u;if(V$(n)&&(l=n.constructor,Kq(l)&&(l===Wb||V$(l.prototype))?l=void 0:qq(l)&&(l=l[nX],l===null&&(l=void 0)),l===Wb||l===void 0))return tX(n,i,a);for(s=new(l===void 0?Wb:l)(oX(a-i,0)),u=0;i<a;i++,u++)i in n&&Jq(s,u,n[i]);return s.length=u,s}});var iX=Ae,aX=je,lX=Cf,sX=Nt,uX=kr,fX=bn,U$=kF,z$=uv,cX=a0,hX=fv,dX=wt,vX=Yd,HF=dX("isConcatSpreadable"),yX=vX>=51||!aX(function(){var e=[];return e[HF]=!1,e.concat()[0]!==e}),gX=function(e){if(!sX(e))return!1;var t=e[HF];return t!==void 0?!!t:lX(e)},pX=!yX||!hX("concat");iX({target:"Array",proto:!0,arity:1,forced:pX},{concat:function(t){var r=uX(this),n=cX(r,0),o=0,i,a,l,s,u;for(i=-1,l=arguments.length;i<l;i++)if(u=i===-1?r:arguments[i],gX(u))for(s=fX(u),U$(o+s),a=0;a<s;a++,o++)a in u&&z$(n,o,u[a]);else U$(o+1),z$(n,o++,u);return n.length=o,n}});var mX=kr,Y$=tm,bX=bn,wX=function(t){for(var r=mX(this),n=bX(r),o=arguments.length,i=Y$(o>1?arguments[1]:void 0,n),a=o>2?arguments[2]:void 0,l=a===void 0?n:Y$(a,n);l>i;)r[i++]=t;return r},SX=Ae,CX=wX,_X=av;SX({target:"Array",proto:!0},{fill:CX});_X("fill");var OX=Ae,RX=rl.map,EX=fv,TX=EX("map");OX({target:"Array",proto:!0,forced:!TX},{map:function(t){return RX(this,t,arguments.length>1?arguments[1]:void 0)}});var kX=Ht,LF=function(){var e=kX(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},P0=je,PX=vt,$0=PX.RegExp,A0=P0(function(){var e=$0("a","y");return e.lastIndex=2,e.exec("abcd")!==null}),$X=A0||P0(function(){return!$0("a","y").sticky}),AX=A0||P0(function(){var e=$0("^r","gy");return e.lastIndex=2,e.exec("str")!==null}),I0={BROKEN_CARET:AX,MISSED_STICKY:$X,UNSUPPORTED_Y:A0},IX=je,MX=vt,xX=MX.RegExp,jF=IX(function(){var e=xX(".","s");return!(e.dotAll&&e.test(`
`)&&e.flags==="s")}),DX=je,NX=vt,HX=NX.RegExp,FF=DX(function(){var e=HX("(?<a>b)","g");return e.exec("b").groups.a!=="b"||"b".replace(e,"$<a>c")!=="bc"}),zl=zt,ym=Ue,LX=Yt,jX=LF,FX=I0,BX=Sf,VX=tl,WX=Fo.get,UX=jF,zX=FF,YX=BX("native-string-replace",String.prototype.replace),Hg=RegExp.prototype.exec,vC=Hg,GX=ym("".charAt),KX=ym("".indexOf),qX=ym("".replace),Ub=ym("".slice),yC=function(){var e=/a/,t=/b*/g;return zl(Hg,e,"a"),zl(Hg,t,"a"),e.lastIndex!==0||t.lastIndex!==0}(),BF=FX.BROKEN_CARET,gC=/()??/.exec("")[1]!==void 0,XX=yC||gC||BF||UX||zX;XX&&(vC=function(t){var r=this,n=WX(r),o=LX(t),i=n.raw,a,l,s,u,f,c,h;if(i)return i.lastIndex=r.lastIndex,a=zl(vC,i,o),r.lastIndex=i.lastIndex,a;var d=n.groups,v=BF&&r.sticky,g=zl(jX,r),m=r.source,w=0,S=o;if(v&&(g=qX(g,"y",""),KX(g,"g")===-1&&(g+="g"),S=Ub(o,r.lastIndex),r.lastIndex>0&&(!r.multiline||r.multiline&&GX(o,r.lastIndex-1)!==`
`)&&(m="(?: "+m+")",S=" "+S,w++),l=new RegExp("^(?:"+m+")",g)),gC&&(l=new RegExp("^"+m+"$(?!\\s)",g)),yC&&(s=r.lastIndex),u=zl(Hg,v?l:r,S),v?u?(u.input=Ub(u.input,w),u[0]=Ub(u[0],w),u.index=r.lastIndex,r.lastIndex+=u[0].length):r.lastIndex=0:yC&&u&&(r.lastIndex=r.global?u.index+u[0].length:s),gC&&u&&u.length>1&&zl(YX,u[0],l,function(){for(f=1;f<arguments.length-2;f++)arguments[f]===void 0&&(u[f]=void 0)}),u&&d)for(u.groups=c=VX(null),f=0;f<d.length;f++)h=d[f],c[h[0]]=u[h[1]];return u});var M0=vC,ZX=Ae,G$=M0;ZX({target:"RegExp",proto:!0,forced:/./.exec!==G$},{exec:G$});var K$=zt,q$=Zr,JX=M0,X$=je,VF=wt,QX=Za,eZ=VF("species"),zb=RegExp.prototype,gm=function(e,t,r,n){var o=VF(e),i=!X$(function(){var u={};return u[o]=function(){return 7},""[e](u)!==7}),a=i&&!X$(function(){var u=!1,f=/a/;return e==="split"&&(f={},f.constructor={},f.constructor[eZ]=function(){return f},f.flags="",f[o]=/./[o]),f.exec=function(){return u=!0,null},f[o](""),!u});if(!i||!a||r){var l=/./[o],s=t(o,""[e],function(u,f,c,h,d){var v=f.exec;return v===JX||v===zb.exec?i&&!d?{done:!0,value:K$(l,f,c,h)}:{done:!0,value:K$(u,c,f,h)}:{done:!1}});q$(String.prototype,e,s[0]),q$(zb,o,s[1])}n&&QX(zb[o],"sham",!0)},tZ=R0.charAt,x0=function(e,t,r){return t+(r?tZ(e,t).length:1)},D0=Ue,rZ=kr,nZ=Math.floor,Yb=D0("".charAt),oZ=D0("".replace),Gb=D0("".slice),iZ=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,aZ=/\$([$&'`]|\d{1,2})/g,lZ=function(e,t,r,n,o,i){var a=r+e.length,l=n.length,s=aZ;return o!==void 0&&(o=rZ(o),s=iZ),oZ(i,s,function(u,f){var c;switch(Yb(f,0)){case"$":return"$";case"&":return e;case"`":return Gb(t,0,r);case"'":return Gb(t,a);case"<":c=o[Gb(f,1,-1)];break;default:var h=+f;if(h===0)return u;if(h>l){var d=nZ(h/10);return d===0?u:d<=l?n[d-1]===void 0?Yb(f,1):n[d-1]+Yb(f,1):u}c=n[h-1]}return c===void 0?"":c})},Z$=zt,sZ=Ht,uZ=Et,fZ=Fn,cZ=M0,hZ=TypeError,pm=function(e,t){var r=e.exec;if(uZ(r)){var n=Z$(r,e,t);return n!==null&&sZ(n),n}if(fZ(e)==="RegExp")return Z$(cZ,e,t);throw new hZ("RegExp#exec called on incompatible receiver")},dZ=_f,J$=zt,mm=Ue,vZ=gm,yZ=je,gZ=Ht,pZ=Et,mZ=mn,bZ=Ii,wZ=Qa,cl=Yt,SZ=Tr,CZ=x0,_Z=Xa,OZ=lZ,RZ=pm,EZ=wt,pC=EZ("replace"),TZ=Math.max,kZ=Math.min,PZ=mm([].concat),Kb=mm([].push),Q$=mm("".indexOf),e1=mm("".slice),$Z=function(e){return e===void 0?e:String(e)},AZ=function(){return"a".replace(/./,"$0")==="$0"}(),t1=function(){return/./[pC]?/./[pC]("a","$0")==="":!1}(),IZ=!yZ(function(){var e=/./;return e.exec=function(){var t=[];return t.groups={a:"7"},t},"".replace(e,"$<a>")!=="7"});vZ("replace",function(e,t,r){var n=t1?"$":"$0";return[function(i,a){var l=SZ(this),s=mZ(i)?void 0:_Z(i,pC);return s?J$(s,i,l,a):J$(t,cl(l),i,a)},function(o,i){var a=gZ(this),l=cl(o);if(typeof i=="string"&&Q$(i,n)===-1&&Q$(i,"$<")===-1){var s=r(t,a,l,i);if(s.done)return s.value}var u=pZ(i);u||(i=cl(i));var f=a.global,c;f&&(c=a.unicode,a.lastIndex=0);for(var h=[],d;d=RZ(a,l),!(d===null||(Kb(h,d),!f));){var v=cl(d[0]);v===""&&(a.lastIndex=CZ(l,wZ(a.lastIndex),c))}for(var g="",m=0,w=0;w<h.length;w++){d=h[w];for(var S=cl(d[0]),C=TZ(kZ(bZ(d.index),l.length),0),k=[],R,V=1;V<d.length;V++)Kb(k,$Z(d[V]));var U=d.groups;if(u){var X=PZ([S],k,C,l);U!==void 0&&Kb(X,U),R=cl(dZ(i,void 0,X))}else R=OZ(S,l,C,k,U,i);C>=m&&(g+=e1(l,m,C)+R,m=C+S.length)}return g+e1(l,m)}]},!IZ||!AZ||t1);var MZ=Ht,xZ=hF,DZ=function(e,t,r,n){try{return n?t(MZ(r)[0],r[1]):t(r)}catch(o){xZ(e,"throw",o)}},NZ=tv,HZ=zt,LZ=kr,jZ=DZ,FZ=fF,BZ=am,VZ=bn,r1=uv,WZ=cF,UZ=b0,n1=Array,zZ=function(t){var r=LZ(t),n=BZ(this),o=arguments.length,i=o>1?arguments[1]:void 0,a=i!==void 0;a&&(i=NZ(i,o>2?arguments[2]:void 0));var l=UZ(r),s=0,u,f,c,h,d,v;if(l&&!(this===n1&&FZ(l)))for(h=WZ(r,l),d=h.next,f=n?new this:[];!(c=HZ(d,h)).done;s++)v=a?jZ(h,i,[c.value,s],!0):c.value,r1(f,s,v);else for(u=VZ(r),f=n?new this(u):n1(u);u>s;s++)v=a?i(r[s],s):r[s],r1(f,s,v);return f.length=s,f},YZ=Ae,GZ=zZ,KZ=yF,qZ=!KZ(function(e){Array.from(e)});YZ({target:"Array",stat:!0,forced:qZ},{from:GZ});var XZ=Ae,ZZ=im,JZ=QR.indexOf,QZ=Of,mC=ZZ([].indexOf),WF=!!mC&&1/mC([1],1,-0)<0,eJ=WF||!QZ("indexOf");XZ({target:"Array",proto:!0,forced:eJ},{indexOf:function(t){var r=arguments.length>1?arguments[1]:void 0;return WF?mC(this,t,r)||0:JZ(this,t,r)}});var tJ=Ae,rJ=Ue,nJ=Cf,oJ=rJ([].reverse),o1=[1,2];tJ({target:"Array",proto:!0,forced:String(o1)===String(o1.reverse())},{reverse:function(){return nJ(this)&&(this.length=this.length),oJ(this)}});var iJ=rl.forEach,aJ=Of,lJ=aJ("forEach"),sJ=lJ?[].forEach:function(t){return iJ(this,t,arguments.length>1?arguments[1]:void 0)},i1=vt,a1=SF,uJ=CF,qb=sJ,fJ=Za,UF=function(e){if(e&&e.forEach!==qb)try{fJ(e,"forEach",qb)}catch{e.forEach=qb}};for(var Xb in a1)a1[Xb]&&UF(i1[Xb]&&i1[Xb].prototype);UF(uJ);var cJ=typeof Bun=="function"&&Bun&&typeof Bun.version=="string",hJ=TypeError,zF=function(e,t){if(e<t)throw new hJ("Not enough arguments");return e},YF=vt,dJ=_f,vJ=Et,yJ=cJ,gJ=Ka,pJ=el,mJ=zF,bJ=YF.Function,wJ=/MSIE .\./.test(gJ)||yJ&&function(){var e=YF.Bun.version.split(".");return e.length<3||e[0]==="0"&&(e[1]<3||e[1]==="3"&&e[2]==="0")}(),N0=function(e,t){var r=t?2:1;return wJ?function(n,o){var i=mJ(arguments.length,1)>r,a=vJ(n)?n:bJ(n),l=i?pJ(arguments,r):[],s=i?function(){dJ(a,this,l)}:a;return t?e(s,o):e(s)}:e},SJ=Ae,GF=vt,CJ=N0,l1=CJ(GF.setInterval,!0);SJ({global:!0,bind:!0,forced:GF.setInterval!==l1},{setInterval:l1});var _J=Ae,KF=vt,OJ=N0,s1=OJ(KF.setTimeout,!0);_J({global:!0,bind:!0,forced:KF.setTimeout!==s1},{setTimeout:s1});var RJ=Ka,EJ=/(?:ipad|iphone|ipod).*applewebkit/i.test(RJ),TJ=vt,kJ=Fn,qF=kJ(TJ.process)==="process",Lr=vt,PJ=_f,$J=tv,u1=Et,AJ=Mt,XF=je,f1=Sj,IJ=el,c1=Qp,MJ=zF,xJ=EJ,DJ=qF,bC=Lr.setImmediate,wC=Lr.clearImmediate,NJ=Lr.process,Zb=Lr.Dispatch,HJ=Lr.Function,h1=Lr.MessageChannel,LJ=Lr.String,Jb=0,bc={},d1="onreadystatechange",Lc,Li,Qb,ew;XF(function(){Lc=Lr.location});var H0=function(e){if(AJ(bc,e)){var t=bc[e];delete bc[e],t()}},tw=function(e){return function(){H0(e)}},v1=function(e){H0(e.data)},y1=function(e){Lr.postMessage(LJ(e),Lc.protocol+"//"+Lc.host)};(!bC||!wC)&&(bC=function(t){MJ(arguments.length,1);var r=u1(t)?t:HJ(t),n=IJ(arguments,1);return bc[++Jb]=function(){PJ(r,void 0,n)},Li(Jb),Jb},wC=function(t){delete bc[t]},DJ?Li=function(e){NJ.nextTick(tw(e))}:Zb&&Zb.now?Li=function(e){Zb.now(tw(e))}:h1&&!xJ?(Qb=new h1,ew=Qb.port2,Qb.port1.onmessage=v1,Li=$J(ew.postMessage,ew)):Lr.addEventListener&&u1(Lr.postMessage)&&!Lr.importScripts&&Lc&&Lc.protocol!=="file:"&&!XF(y1)?(Li=y1,Lr.addEventListener("message",v1,!1)):d1 in c1("script")?Li=function(e){f1.appendChild(c1("script"))[d1]=function(){f1.removeChild(this),H0(e)}}:Li=function(e){setTimeout(tw(e),0)});var ZF={set:bC,clear:wC},jJ=Ae,FJ=vt,g1=ZF.clear;jJ({global:!0,bind:!0,enumerable:!0,forced:FJ.clearImmediate!==g1},{clearImmediate:g1});var BJ=Ae,JF=vt,p1=ZF.set,VJ=N0,m1=JF.setImmediate?VJ(p1,!1):p1;BJ({global:!0,bind:!0,enumerable:!0,forced:JF.setImmediate!==m1},{setImmediate:m1});var WJ=hm,UJ=mF;WJ("Map",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},UJ);var zJ=Ae,YJ=je,GJ=kr,QF=sv,KJ=nF,qJ=YJ(function(){QF(1)});zJ({target:"Object",stat:!0,forced:qJ,sham:!KJ},{getPrototypeOf:function(t){return QF(GJ(t))}});var XJ=Nt,ZJ=Fn,JJ=wt,QJ=JJ("match"),eB=function(e){var t;return XJ(e)&&((t=e[QJ])!==void 0?!!t:ZJ(e)==="RegExp")},eQ=eB,tQ=TypeError,L0=function(e){if(eQ(e))throw new tQ("The method doesn't accept regular expressions");return e},rQ=wt,nQ=rQ("match"),j0=function(e){var t=/./;try{"/./"[e](t)}catch{try{return t[nQ]=!1,"/./"[e](t)}catch{}}return!1},oQ=Ae,iQ=Ue,aQ=L0,lQ=Tr,b1=Yt,sQ=j0,uQ=iQ("".indexOf);oQ({target:"String",proto:!0,forced:!sQ("includes")},{includes:function(t){return!!~uQ(b1(lQ(this)),b1(aQ(t)),arguments.length>1?arguments[1]:void 0)}});var fQ=Ae,cQ=rl.filter,hQ=fv,dQ=hQ("filter");fQ({target:"Array",proto:!0,forced:!dQ},{filter:function(t){return cQ(this,t,arguments.length>1?arguments[1]:void 0)}});var vQ=zt,yQ=Mt,gQ=Ai,pQ=LF,w1=RegExp.prototype,tB=function(e){var t=e.flags;return t===void 0&&!("flags"in w1)&&!yQ(e,"flags")&&gQ(w1,e)?vQ(pQ,e):t},mQ=br.f,bQ=function(e,t,r){r in e||mQ(e,r,{configurable:!0,get:function(){return t[r]},set:function(n){t[r]=n}})},wQ=Ut,F0=vt,cv=Ue,SQ=rm,CQ=C0,_Q=Za,OQ=tl,RQ=Ja.f,S1=Ai,EQ=eB,C1=Yt,TQ=tB,rB=I0,kQ=bQ,PQ=Zr,$Q=je,AQ=Mt,IQ=Fo.enforce,MQ=gF,xQ=wt,nB=jF,oB=FF,DQ=xQ("match"),ci=F0.RegExp,Fl=ci.prototype,NQ=F0.SyntaxError,HQ=cv(Fl.exec),Lg=cv("".charAt),_1=cv("".replace),O1=cv("".indexOf),LQ=cv("".slice),jQ=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,Ia=/a/g,rw=/a/g,FQ=new ci(Ia)!==Ia,iB=rB.MISSED_STICKY,BQ=rB.UNSUPPORTED_Y,VQ=wQ&&(!FQ||iB||nB||oB||$Q(function(){return rw[DQ]=!1,ci(Ia)!==Ia||ci(rw)===rw||String(ci(Ia,"i"))!=="/a/i"})),WQ=function(e){for(var t=e.length,r=0,n="",o=!1,i;r<=t;r++){if(i=Lg(e,r),i==="\\"){n+=i+Lg(e,++r);continue}!o&&i==="."?n+="[\\s\\S]":(i==="["?o=!0:i==="]"&&(o=!1),n+=i)}return n},UQ=function(e){for(var t=e.length,r=0,n="",o=[],i=OQ(null),a=!1,l=!1,s=0,u="",f;r<=t;r++){if(f=Lg(e,r),f==="\\")f+=Lg(e,++r);else if(f==="]")a=!1;else if(!a)switch(!0){case f==="[":a=!0;break;case f==="(":HQ(jQ,LQ(e,r+1))&&(r+=2,l=!0),n+=f,s++;continue;case(f===">"&&l):if(u===""||AQ(i,u))throw new NQ("Invalid capture group name");i[u]=!0,o[o.length]=[u,s],l=!1,u="";continue}l?u+=f:n+=f}return[n,o]};if(SQ("RegExp",VQ)){for(var ji=function(t,r){var n=S1(Fl,this),o=EQ(t),i=r===void 0,a=[],l=t,s,u,f,c,h,d;if(!n&&o&&i&&t.constructor===ji)return t;if((o||S1(Fl,t))&&(t=t.source,i&&(r=TQ(l))),t=t===void 0?"":C1(t),r=r===void 0?"":C1(r),l=t,nB&&"dotAll"in Ia&&(u=!!r&&O1(r,"s")>-1,u&&(r=_1(r,/s/g,""))),s=r,iB&&"sticky"in Ia&&(f=!!r&&O1(r,"y")>-1,f&&BQ&&(r=_1(r,/y/g,""))),oB&&(c=UQ(t),t=c[0],a=c[1]),h=CQ(ci(t,r),n?this:Fl,ji),(u||f||a.length)&&(d=IQ(h),u&&(d.dotAll=!0,d.raw=ji(WQ(t),s)),f&&(d.sticky=!0),a.length&&(d.groups=a)),t!==l)try{_Q(h,"source",l===""?"(?:)":l)}catch{}return h},R1=RQ(ci),E1=0;R1.length>E1;)kQ(ji,ci,R1[E1++]);Fl.constructor=ji,ji.prototype=Fl,PQ(F0,"RegExp",ji,{constructor:!0})}MQ("RegExp");var zQ=Kd.PROPER,YQ=Zr,GQ=Ht,T1=Yt,KQ=je,qQ=tB,B0="toString",aB=RegExp.prototype,lB=aB[B0],XQ=KQ(function(){return lB.call({source:"a",flags:"b"})!=="/a/b"}),ZQ=zQ&&lB.name!==B0;(XQ||ZQ)&&YQ(aB,B0,function(){var t=GQ(this),r=T1(t.source),n=T1(qQ(t));return"/"+r+"/"+n},{unsafe:!0});var JQ=Ae,QQ=Ue,eee=zd,tee=Br,ree=Of,nee=QQ([].join),oee=eee!==Object,iee=oee||!ree("join",",");JQ({target:"Array",proto:!0,forced:iee},{join:function(t){return nee(tee(this),t===void 0?",":t)}});var aee=Kd.PROPER,lee=je,k1=$F,P1="âÂá ",see=function(e){return lee(function(){return!!k1[e]()||P1[e]()!==P1||aee&&k1[e].name!==e})},uee=Ae,fee=AF.trim,cee=see;uee({target:"String",proto:!0,forced:cee("trim")},{trim:function(){return fee(this)}});function SC(e){"@babel/helpers - typeof";return SC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},SC(e)}function bm(e){return window.requestAnimationFrame(e)}function sB(){return!!document.documentElement.classList}function uB(){return!!document.createTextNode("test").textContent}function fB(){return!!window.getComputedStyle}function jc(e){window.cancelAnimationFrame(e)}function V0(){return"ontouchstart"in window}var CC;function hee(){var e=document.createElement("TABLE");e.style.borderSpacing="0",e.style.borderWidth="0",e.style.padding="0";var t=document.createElement("TBODY");e.appendChild(t),t.appendChild(document.createElement("TR")),t.firstChild.appendChild(document.createElement("TD")),t.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var r=document.createElement("CAPTION");r.innerHTML="c<br>c<br>c<br>c",r.style.padding="0",r.style.margin="0",e.insertBefore(r,t),document.body.appendChild(e),CC=e.offsetHeight<2*e.lastChild.offsetHeight,document.body.removeChild(e)}function W0(){return CC===void 0&&hee(),CC}var hl;function cB(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return hl||((typeof Intl>"u"?"undefined":SC(Intl))==="object"?hl=new Intl.Collator(e,t).compare:typeof String.prototype.localeCompare=="function"?hl=function(n,o){return"".concat(n).localeCompare(o)}:hl=function(n,o){return n===o?0:n>o?-1:1},hl)}var Ff;function hB(){if(Ff!==void 0)return Ff;try{var e={get passive(){Ff=!0}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch{Ff=!1}return Ff}const dee=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:jc,getComparisonFunction:cB,hasCaptionProblem:W0,isClassListSupported:sB,isGetComputedStyleSupported:fB,isPassiveEventSupported:hB,isTextContentSupported:uB,isTouchSupported:V0,requestAnimationFrame:bm},Symbol.toStringTag,{value:"Module"}));var vee=o0,yee=Rj;vee("toPrimitive");yee();var gee=Ht,pee=nj,mee=TypeError,bee=function(e){if(gee(this),e==="string"||e==="default")e="string";else if(e!=="number")throw new mee("Incorrect hint");return pee(this,e)},wee=Mt,See=Zr,Cee=bee,_ee=wt,$1=_ee("toPrimitive"),A1=Date.prototype;wee(A1,$1)||See(A1,$1,Cee);var Oee=am,Ree=wf,Eee=TypeError,dB=function(e){if(Oee(e))return e;throw new Eee(Ree(e)+" is not a constructor")},I1=Ht,Tee=dB,kee=mn,Pee=wt,$ee=Pee("species"),Aee=function(e,t){var r=I1(e).constructor,n;return r===void 0||kee(n=I1(r)[$ee])?t:Tee(n)},nw=zt,vB=Ue,Iee=gm,Mee=Ht,xee=mn,Dee=Tr,Nee=Aee,Hee=x0,Lee=Qa,M1=Yt,jee=Xa,x1=pm,Fee=I0,Bee=je,dl=Fee.UNSUPPORTED_Y,Vee=4294967295,Wee=Math.min,ow=vB([].push),iw=vB("".slice),Uee=!Bee(function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return r.length!==2||r[0]!=="a"||r[1]!=="b"}),D1="abbc".split(/(b)*/)[1]==="c"||"test".split(/(?:)/,-1).length!==4||"ab".split(/(?:ab)*/).length!==2||".".split(/(.?)(.?)/).length!==4||".".split(/()()/).length>1||"".split(/.?/).length;Iee("split",function(e,t,r){var n="0".split(void 0,0).length?function(o,i){return o===void 0&&i===0?[]:nw(t,this,o,i)}:t;return[function(i,a){var l=Dee(this),s=xee(i)?void 0:jee(i,e);return s?nw(s,i,l,a):nw(n,M1(l),i,a)},function(o,i){var a=Mee(this),l=M1(o);if(!D1){var s=r(n,a,l,i,n!==t);if(s.done)return s.value}var u=Nee(a,RegExp),f=a.unicode,c=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(dl?"g":"y"),h=new u(dl?"^(?:"+a.source+")":a,c),d=i===void 0?Vee:i>>>0;if(d===0)return[];if(l.length===0)return x1(h,l)===null?[l]:[];for(var v=0,g=0,m=[];g<l.length;){h.lastIndex=dl?0:g;var w=x1(h,dl?iw(l,g):l),S;if(w===null||(S=Wee(Lee(h.lastIndex+(dl?g:0)),l.length))===v)g=Hee(l,g,f);else{if(ow(m,iw(l,v,g)),m.length===d)return m;for(var C=1;C<=w.length-1;C++)if(ow(m,w[C]),m.length===d)return m;g=v=S}}return ow(m,iw(l,v)),m}]},D1||!Uee,dl);function yB(e){for(var t=e.length,r=0;r<t;)e[r]=[e[r]],r+=1}function _C(e,t){for(var r=t.length,n=0;n<r;)e.push(t[n]),n+=1}function wc(e){var t=[];if(!e||e.length===0||!e[0]||e[0].length===0)return t;for(var r=e.length,n=e[0].length,o=0;o<r;o++)for(var i=0;i<n;i++)t[i]||(t[i]=[]),t[i][o]=e[o][i];return t}function Lt(e,t,r,n){var o=-1,i=e,a=r;Array.isArray(e)||(i=Array.from(e));var l=i.length;for(n&&l&&(o+=1,a=i[o]),o+=1;o<l;)a=t(a,i[o],o,i),o+=1;return a}function jr(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var o=n.length,i=[],a=-1;r<o;){var l=n[r];t(l,r,n)&&(a+=1,i[a]=l),r+=1}return i}function Be(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var o=n.length,i=[],a=-1;r<o;){var l=n[r];a+=1,i[a]=t(l,r,n),r+=1}return i}function $(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var o=n.length;r<o&&t(n[r],r,n)!==!1;)r+=1;return e}function gB(e){return Lt(e,function(t,r){return t+r},0)}function zee(e){return Lt(e,function(t,r){return t>r?t:r},Array.isArray(e)?e[0]:void 0)}function Yee(e){return Lt(e,function(t,r){return t<r?t:r},Array.isArray(e)?e[0]:void 0)}function Gee(e){return e.length?gB(e)/e.length:0}function pB(e){return Lt(e,function(t,r){return t.concat(Array.isArray(r)?pB(r):r)},[])}function U0(e){var t=[];return $(e,function(r){t.indexOf(r)===-1&&t.push(r)}),t}function OC(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),o=n[0],i=n.slice(1),a=o;return $(i,function(l){a=a.filter(function(s){return!l.includes(s)})}),a}function Kee(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),o=n[0],i=n.slice(1),a=o;return $(i,function(l){a=a.filter(function(s){return l.includes(s)})}),a}function qee(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),o=n[0],i=n.slice(1),a=new Set(o);return $(i,function(l){$(l,function(s){a.has(s)||a.add(s)})}),Array.from(a)}function RC(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return e.split(t)}const Xee=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:Gee,arrayEach:$,arrayFilter:jr,arrayFlatten:pB,arrayMap:Be,arrayMax:zee,arrayMin:Yee,arrayReduce:Lt,arraySum:gB,arrayUnique:U0,extendArray:_C,getDifferenceOfArrays:OC,getIntersectionOfArrays:Kee,getUnionOfArrays:qee,pivot:wc,stringToArray:RC,to2dArray:yB},Symbol.toStringTag,{value:"Module"}));function N1(e,t,r){return t=Zee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Zee(e){var t=Jee(e,"string");return No(t)==="symbol"?t:String(t)}function Jee(e,t){if(No(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(No(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function No(e){"@babel/helpers - typeof";return No=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},No(e)}function ds(e){var t;return Array.isArray(e)?t=e.length?new Array(e.length).fill(null):[]:(t={},We(e,function(r,n){n!=="__children"&&(r&&No(r)==="object"&&!Array.isArray(r)?t[n]=ds(r):Array.isArray(r)?r.length&&No(r[0])==="object"&&!Array.isArray(r[0])?t[n]=[ds(r[0])]:t[n]=[]:t[n]=null)})),t}function Bo(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e,e}function Wt(e,t,r){var n=Array.isArray(r);return We(t,function(o,i){(n===!1||r.includes(i))&&(e[i]=o)}),e}function hv(e,t){We(t,function(r,n){t[n]&&No(t[n])==="object"?(e[n]||(Array.isArray(t[n])?e[n]=[]:Object.prototype.toString.call(t[n])==="[object Date]"?e[n]=t[n]:e[n]={}),hv(e[n],t[n])):e[n]=t[n]})}function lr(e){return No(e)==="object"?JSON.parse(JSON.stringify(e)):e}function pr(e){var t={};return We(e,function(r,n){t[n]=r}),t}function pt(e){e.MIXINS||(e.MIXINS=[]);for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return $(r,function(o){e.MIXINS.push(o.MIXIN_NAME),We(o,function(i,a){if(e.prototype[a]!==void 0)throw new Error("Mixin conflict. Property '".concat(a,"' already exist and cannot be overwritten."));if(typeof i=="function")e.prototype[a]=i;else{var l=function(f,c){var h="_".concat(f),d=function(g){var m=g;return(Array.isArray(m)||Ve(m))&&(m=lr(m)),m};return function(){return this[h]===void 0&&(this[h]=d(c)),this[h]}},s=function(f){var c="_".concat(f);return function(h){this[c]=h}};Object.defineProperty(e.prototype,a,{get:l(a,i),set:s(a),configurable:!0})}})}),e}function wm(e,t){return JSON.stringify(e)===JSON.stringify(t)}function Ve(e){return Object.prototype.toString.call(e)==="[object Object]"}function Bn(e,t,r,n){n.value=r,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(e,t,n)}function We(e,t){for(var r in e)if((!e.hasOwnProperty||e.hasOwnProperty&&Object.prototype.hasOwnProperty.call(e,r))&&t(e[r],r,e)===!1)break;return e}function mB(e,t){var r=t.split("."),n=e;return We(r,function(o){if(n=n[o],n===void 0)return n=void 0,!1}),n}function Zy(e,t,r){var n=t.split("."),o=e;n.forEach(function(i,a){a!==n.length-1?(At(o,i)||(o[i]={}),o=o[i]):o[i]=r})}function Sm(e){if(!Ve(e))return 0;var t=function r(n){var o=0;return Ve(n)?We(n,function(i,a){a!=="__children"&&(o+=r(i))}):o+=1,o};return t(e)}function Da(e){var t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value",n="_".concat(r),o=(t={_touched:!1},N1(t,n,e),N1(t,"isTouched",function(){return this._touched}),t);return Object.defineProperty(o,r,{get:function(){return this[n]},set:function(a){this._touched=!0,this[n]=a},enumerable:!0,configurable:!0}),o}function At(e,t){return Object.prototype.hasOwnProperty.call(e,t)}const Qee=Object.freeze(Object.defineProperty({__proto__:null,clone:pr,createObjectPropListener:Da,deepClone:lr,deepExtend:hv,deepObjectSize:Sm,defineGetter:Bn,duckSchema:ds,extend:Wt,getProperty:mB,hasOwnProperty:At,inherit:Bo,isObject:Ve,isObjectEqual:wm,mixin:pt,objectEach:We,setProperty:Zy},Symbol.toStringTag,{value:"Module"}));var Rr=function(t){var r={value:!1};return r.test=function(n,o){r.value=t(n,o)},r},Fr={chrome:Rr(function(e,t){return/Chrome/.test(e)&&/Google/.test(t)}),chromeWebKit:Rr(function(e){return/CriOS/.test(e)}),edge:Rr(function(e){return/Edge/.test(e)}),edgeWebKit:Rr(function(e){return/EdgiOS/.test(e)}),firefox:Rr(function(e){return/Firefox/.test(e)}),firefoxWebKit:Rr(function(e){return/FxiOS/.test(e)}),ie:Rr(function(e){return/Trident/.test(e)}),ie9:Rr(function(){return!!document.documentMode}),mobile:Rr(function(e){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)}),safari:Rr(function(e,t){return/Safari/.test(e)&&/Apple Computer/.test(t)})},Rf={mac:Rr(function(e){return/^Mac/.test(e)}),win:Rr(function(e){return/^Win/.test(e)}),linux:Rr(function(e){return/^Linux/.test(e)}),ios:Rr(function(e){return/iPhone|iPad|iPod/i.test(e)})};function bB(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.userAgent,r=t===void 0?navigator.userAgent:t,n=e.vendor,o=n===void 0?navigator.vendor:n;We(Fr,function(i){var a=i.test;return void a(r,o)})}function wB(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.platform,r=t===void 0?navigator.platform:t;We(Rf,function(n){var o=n.test;return void o(r)})}bB();wB();function z0(){return Fr.chrome.value}function SB(){return Fr.chromeWebKit.value}function Jy(){return Fr.firefox.value}function CB(){return Fr.firefoxWebKit.value}function _B(){return Fr.safari.value}function OB(){return Fr.edge.value}function ete(){return Fr.edgeWebKit.value}function RB(){return Fr.ie.value}function EB(){return Fr.ie9.value}function tte(){return Fr.ie.value||Fr.edge.value}function cn(){return Fr.mobile.value}function Y0(){return Rf.ios.value}function G0(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator,t=e.maxTouchPoints;return t>2&&Rf.mac.value}function EC(){return Rf.win.value}function jg(){return Rf.mac.value}function rte(){return Rf.linux.value}const nte=Object.freeze(Object.defineProperty({__proto__:null,isChrome:z0,isChromeWebKit:SB,isEdge:OB,isEdgeWebKit:ete,isFirefox:Jy,isFirefoxWebKit:CB,isIE:RB,isIE9:EB,isIOS:Y0,isIpadOS:G0,isLinuxOS:rte,isMSBrowser:tte,isMacOS:jg,isMobileBrowser:cn,isSafari:_B,isWindowsOS:EC,setBrowserMeta:bB,setPlatformMeta:wB},Symbol.toStringTag,{value:"Module"}));/*! @license DOMPurify 2.4.7 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.7/LICENSE */function ii(e){"@babel/helpers - typeof";return ii=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ii(e)}function TC(e,t){return TC=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},TC(e,t)}function ote(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Qy(e,t,r){return ote()?Qy=Reflect.construct:Qy=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&TC(u,a.prototype),u},Qy.apply(null,arguments)}function on(e){return ite(e)||ate(e)||lte(e)||ste()}function ite(e){if(Array.isArray(e))return kC(e)}function ate(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function lte(e,t){if(e){if(typeof e=="string")return kC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return kC(e,t)}}function kC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ste(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ute=Object.hasOwnProperty,H1=Object.setPrototypeOf,fte=Object.isFrozen,cte=Object.getPrototypeOf,hte=Object.getOwnPropertyDescriptor,mr=Object.freeze,dn=Object.seal,dte=Object.create,TB=typeof Reflect<"u"&&Reflect,Fg=TB.apply,PC=TB.construct;Fg||(Fg=function(t,r,n){return t.apply(r,n)});mr||(mr=function(t){return t});dn||(dn=function(t){return t});PC||(PC=function(t,r){return Qy(t,on(r))});var vte=Xr(Array.prototype.forEach),L1=Xr(Array.prototype.pop),Bf=Xr(Array.prototype.push),eg=Xr(String.prototype.toLowerCase),aw=Xr(String.prototype.toString),yte=Xr(String.prototype.match),tn=Xr(String.prototype.replace),gte=Xr(String.prototype.indexOf),pte=Xr(String.prototype.trim),fr=Xr(RegExp.prototype.test),lw=mte(TypeError);function Xr(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return Fg(e,t,n)}}function mte(e){return function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return PC(e,r)}}function Ke(e,t,r){var n;r=(n=r)!==null&&n!==void 0?n:eg,H1&&H1(e,null);for(var o=t.length;o--;){var i=t[o];if(typeof i=="string"){var a=r(i);a!==i&&(fte(t)||(t[o]=a),i=a)}e[i]=!0}return e}function Fi(e){var t=dte(null),r;for(r in e)Fg(ute,e,[r])===!0&&(t[r]=e[r]);return t}function Xv(e,t){for(;e!==null;){var r=hte(e,t);if(r){if(r.get)return Xr(r.get);if(typeof r.value=="function")return Xr(r.value)}e=cte(e)}function n(o){return console.warn("fallback value for",o),null}return n}var j1=mr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),sw=mr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),uw=mr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),bte=mr(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),fw=mr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),wte=mr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),F1=mr(["#text"]),B1=mr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),cw=mr(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),V1=mr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Zv=mr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Ste=dn(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Cte=dn(/<%[\w\W]*|[\w\W]*%>/gm),_te=dn(/\${[\w\W]*}/gm),Ote=dn(/^data-[\-\w.\u00B7-\uFFFF]/),Rte=dn(/^aria-[\-\w]+$/),Ete=dn(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Tte=dn(/^(?:\w+script|data):/i),kte=dn(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Pte=dn(/^html$/i),$te=function(){return typeof window>"u"?null:window},Ate=function(t,r){if(ii(t)!=="object"||typeof t.createPolicy!="function")return null;var n=null,o="data-tt-policy-suffix";r.currentScript&&r.currentScript.hasAttribute(o)&&(n=r.currentScript.getAttribute(o));var i="dompurify"+(n?"#"+n:"");try{return t.createPolicy(i,{createHTML:function(l){return l},createScriptURL:function(l){return l}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}};function kB(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:$te(),t=function(N){return kB(N)};if(t.version="2.4.7",t.removed=[],!e||!e.document||e.document.nodeType!==9)return t.isSupported=!1,t;var r=e.document,n=e.document,o=e.DocumentFragment,i=e.HTMLTemplateElement,a=e.Node,l=e.Element,s=e.NodeFilter,u=e.NamedNodeMap,f=u===void 0?e.NamedNodeMap||e.MozNamedAttrMap:u,c=e.HTMLFormElement,h=e.DOMParser,d=e.trustedTypes,v=l.prototype,g=Xv(v,"cloneNode"),m=Xv(v,"nextSibling"),w=Xv(v,"childNodes"),S=Xv(v,"parentNode");if(typeof i=="function"){var C=n.createElement("template");C.content&&C.content.ownerDocument&&(n=C.content.ownerDocument)}var k=Ate(d,r),R=k?k.createHTML(""):"",V=n,U=V.implementation,X=V.createNodeIterator,Y=V.createDocumentFragment,q=V.getElementsByTagName,Z=r.importNode,ie={};try{ie=Fi(n).documentMode?n.documentMode:{}}catch{}var J={};t.isSupported=typeof S=="function"&&U&&U.createHTMLDocument!==void 0&&ie!==9;var le=Ste,Se=Cte,me=_te,Ce=Ote,P=Rte,y=Tte,p=kte,b=Ete,_=null,T=Ke({},[].concat(on(j1),on(sw),on(uw),on(fw),on(F1))),I=null,F=Ke({},[].concat(on(B1),on(cw),on(V1),on(Zv))),W=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),G=null,Q=null,ee=!0,se=!0,Re=!1,ce=!0,de=!1,K=!1,Me=!1,Ge=!1,Pe=!1,Ie=!1,$e=!1,O=!0,E=!1,A="user-content-",H=!0,M=!1,j={},x=null,D=Ke({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),B=null,L=Ke({},["audio","video","img","source","image","track"]),z=null,ae=Ke({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ge="http://www.w3.org/1998/Math/MathML",Oe="http://www.w3.org/2000/svg",De="http://www.w3.org/1999/xhtml",qe=De,ct=!1,Ne=null,He=Ke({},[ge,Oe,De],aw),rt,it=["application/xhtml+xml","text/html"],Qe="text/html",Xe,Je=null,jt=n.createElement("form"),yt=function(N){return N instanceof RegExp||N instanceof Function},st=function(N){Je&&Je===N||((!N||ii(N)!=="object")&&(N={}),N=Fi(N),rt=it.indexOf(N.PARSER_MEDIA_TYPE)===-1?rt=Qe:rt=N.PARSER_MEDIA_TYPE,Xe=rt==="application/xhtml+xml"?aw:eg,_="ALLOWED_TAGS"in N?Ke({},N.ALLOWED_TAGS,Xe):T,I="ALLOWED_ATTR"in N?Ke({},N.ALLOWED_ATTR,Xe):F,Ne="ALLOWED_NAMESPACES"in N?Ke({},N.ALLOWED_NAMESPACES,aw):He,z="ADD_URI_SAFE_ATTR"in N?Ke(Fi(ae),N.ADD_URI_SAFE_ATTR,Xe):ae,B="ADD_DATA_URI_TAGS"in N?Ke(Fi(L),N.ADD_DATA_URI_TAGS,Xe):L,x="FORBID_CONTENTS"in N?Ke({},N.FORBID_CONTENTS,Xe):D,G="FORBID_TAGS"in N?Ke({},N.FORBID_TAGS,Xe):{},Q="FORBID_ATTR"in N?Ke({},N.FORBID_ATTR,Xe):{},j="USE_PROFILES"in N?N.USE_PROFILES:!1,ee=N.ALLOW_ARIA_ATTR!==!1,se=N.ALLOW_DATA_ATTR!==!1,Re=N.ALLOW_UNKNOWN_PROTOCOLS||!1,ce=N.ALLOW_SELF_CLOSE_IN_ATTR!==!1,de=N.SAFE_FOR_TEMPLATES||!1,K=N.WHOLE_DOCUMENT||!1,Pe=N.RETURN_DOM||!1,Ie=N.RETURN_DOM_FRAGMENT||!1,$e=N.RETURN_TRUSTED_TYPE||!1,Ge=N.FORCE_BODY||!1,O=N.SANITIZE_DOM!==!1,E=N.SANITIZE_NAMED_PROPS||!1,H=N.KEEP_CONTENT!==!1,M=N.IN_PLACE||!1,b=N.ALLOWED_URI_REGEXP||b,qe=N.NAMESPACE||De,W=N.CUSTOM_ELEMENT_HANDLING||{},N.CUSTOM_ELEMENT_HANDLING&&yt(N.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(W.tagNameCheck=N.CUSTOM_ELEMENT_HANDLING.tagNameCheck),N.CUSTOM_ELEMENT_HANDLING&&yt(N.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(W.attributeNameCheck=N.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),N.CUSTOM_ELEMENT_HANDLING&&typeof N.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(W.allowCustomizedBuiltInElements=N.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),de&&(se=!1),Ie&&(Pe=!0),j&&(_=Ke({},on(F1)),I=[],j.html===!0&&(Ke(_,j1),Ke(I,B1)),j.svg===!0&&(Ke(_,sw),Ke(I,cw),Ke(I,Zv)),j.svgFilters===!0&&(Ke(_,uw),Ke(I,cw),Ke(I,Zv)),j.mathMl===!0&&(Ke(_,fw),Ke(I,V1),Ke(I,Zv))),N.ADD_TAGS&&(_===T&&(_=Fi(_)),Ke(_,N.ADD_TAGS,Xe)),N.ADD_ATTR&&(I===F&&(I=Fi(I)),Ke(I,N.ADD_ATTR,Xe)),N.ADD_URI_SAFE_ATTR&&Ke(z,N.ADD_URI_SAFE_ATTR,Xe),N.FORBID_CONTENTS&&(x===D&&(x=Fi(x)),Ke(x,N.FORBID_CONTENTS,Xe)),H&&(_["#text"]=!0),K&&Ke(_,["html","head","body"]),_.table&&(Ke(_,["tbody"]),delete G.tbody),mr&&mr(N),Je=N)},nt=Ke({},["mi","mo","mn","ms","mtext"]),Di=Ke({},["foreignobject","desc","title","annotation-xml"]),Uo=Ke({},["title","style","font","a","script"]),sl=Ke({},sw);Ke(sl,uw),Ke(sl,bte);var sb=Ke({},fw);Ke(sb,wte);var yY=function(N){var oe=S(N);(!oe||!oe.tagName)&&(oe={namespaceURI:qe,tagName:"template"});var he=eg(N.tagName),ut=eg(oe.tagName);return Ne[N.namespaceURI]?N.namespaceURI===Oe?oe.namespaceURI===De?he==="svg":oe.namespaceURI===ge?he==="svg"&&(ut==="annotation-xml"||nt[ut]):!!sl[he]:N.namespaceURI===ge?oe.namespaceURI===De?he==="math":oe.namespaceURI===Oe?he==="math"&&Di[ut]:!!sb[he]:N.namespaceURI===De?oe.namespaceURI===Oe&&!Di[ut]||oe.namespaceURI===ge&&!nt[ut]?!1:!sb[he]&&(Uo[he]||!sl[he]):!!(rt==="application/xhtml+xml"&&Ne[N.namespaceURI]):!1},Un=function(N){Bf(t.removed,{element:N});try{N.parentNode.removeChild(N)}catch{try{N.outerHTML=R}catch{N.remove()}}},ub=function(N,oe){try{Bf(t.removed,{attribute:oe.getAttributeNode(N),from:oe})}catch{Bf(t.removed,{attribute:null,from:oe})}if(oe.removeAttribute(N),N==="is"&&!I[N])if(Pe||Ie)try{Un(oe)}catch{}else try{oe.setAttribute(N,"")}catch{}},Gk=function(N){var oe,he;if(Ge)N="<remove></remove>"+N;else{var ut=yte(N,/^[\r\n\t ]+/);he=ut&&ut[0]}rt==="application/xhtml+xml"&&qe===De&&(N='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+N+"</body></html>");var Sr=k?k.createHTML(N):N;if(qe===De)try{oe=new h().parseFromString(Sr,rt)}catch{}if(!oe||!oe.documentElement){oe=U.createDocument(qe,"template",null);try{oe.documentElement.innerHTML=ct?R:Sr}catch{}}var rr=oe.body||oe.documentElement;return N&&he&&rr.insertBefore(n.createTextNode(he),rr.childNodes[0]||null),qe===De?q.call(oe,K?"html":"body")[0]:K?oe.documentElement:rr},Kk=function(N){return X.call(N.ownerDocument||N,N,s.SHOW_ELEMENT|s.SHOW_COMMENT|s.SHOW_TEXT,null,!1)},gY=function(N){return N instanceof c&&(typeof N.nodeName!="string"||typeof N.textContent!="string"||typeof N.removeChild!="function"||!(N.attributes instanceof f)||typeof N.removeAttribute!="function"||typeof N.setAttribute!="function"||typeof N.namespaceURI!="string"||typeof N.insertBefore!="function"||typeof N.hasChildNodes!="function")},Mf=function(N){return ii(a)==="object"?N instanceof a:N&&ii(N)==="object"&&typeof N.nodeType=="number"&&typeof N.nodeName=="string"},zn=function(N,oe,he){J[N]&&vte(J[N],function(ut){ut.call(t,oe,he,Je)})},qk=function(N){var oe;if(zn("beforeSanitizeElements",N,null),gY(N)||fr(/[\u0080-\uFFFF]/,N.nodeName))return Un(N),!0;var he=Xe(N.nodeName);if(zn("uponSanitizeElement",N,{tagName:he,allowedTags:_}),N.hasChildNodes()&&!Mf(N.firstElementChild)&&(!Mf(N.content)||!Mf(N.content.firstElementChild))&&fr(/<[/\w]/g,N.innerHTML)&&fr(/<[/\w]/g,N.textContent)||he==="select"&&fr(/<template/i,N.innerHTML))return Un(N),!0;if(!_[he]||G[he]){if(!G[he]&&Zk(he)&&(W.tagNameCheck instanceof RegExp&&fr(W.tagNameCheck,he)||W.tagNameCheck instanceof Function&&W.tagNameCheck(he)))return!1;if(H&&!x[he]){var ut=S(N)||N.parentNode,Sr=w(N)||N.childNodes;if(Sr&&ut)for(var rr=Sr.length,tr=rr-1;tr>=0;--tr)ut.insertBefore(g(Sr[tr],!0),m(N))}return Un(N),!0}return N instanceof l&&!yY(N)||(he==="noscript"||he==="noembed"||he==="noframes")&&fr(/<\/no(script|embed|frames)/i,N.innerHTML)?(Un(N),!0):(de&&N.nodeType===3&&(oe=N.textContent,oe=tn(oe,le," "),oe=tn(oe,Se," "),oe=tn(oe,me," "),N.textContent!==oe&&(Bf(t.removed,{element:N.cloneNode()}),N.textContent=oe)),zn("afterSanitizeElements",N,null),!1)},Xk=function(N,oe,he){if(O&&(oe==="id"||oe==="name")&&(he in n||he in jt))return!1;if(!(se&&!Q[oe]&&fr(Ce,oe))){if(!(ee&&fr(P,oe))){if(!I[oe]||Q[oe]){if(!(Zk(N)&&(W.tagNameCheck instanceof RegExp&&fr(W.tagNameCheck,N)||W.tagNameCheck instanceof Function&&W.tagNameCheck(N))&&(W.attributeNameCheck instanceof RegExp&&fr(W.attributeNameCheck,oe)||W.attributeNameCheck instanceof Function&&W.attributeNameCheck(oe))||oe==="is"&&W.allowCustomizedBuiltInElements&&(W.tagNameCheck instanceof RegExp&&fr(W.tagNameCheck,he)||W.tagNameCheck instanceof Function&&W.tagNameCheck(he))))return!1}else if(!z[oe]){if(!fr(b,tn(he,p,""))){if(!((oe==="src"||oe==="xlink:href"||oe==="href")&&N!=="script"&&gte(he,"data:")===0&&B[N])){if(!(Re&&!fr(y,tn(he,p,"")))){if(he)return!1}}}}}}return!0},Zk=function(N){return N.indexOf("-")>0},Jk=function(N){var oe,he,ut,Sr;zn("beforeSanitizeAttributes",N,null);var rr=N.attributes;if(rr){var tr={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:I};for(Sr=rr.length;Sr--;){oe=rr[Sr];var Nv=oe,Zt=Nv.name,fb=Nv.namespaceURI;if(he=Zt==="value"?oe.value:pte(oe.value),ut=Xe(Zt),tr.attrName=ut,tr.attrValue=he,tr.keepAttr=!0,tr.forceKeepAttr=void 0,zn("uponSanitizeAttribute",N,tr),he=tr.attrValue,!tr.forceKeepAttr&&(ub(Zt,N),!!tr.keepAttr)){if(!ce&&fr(/\/>/i,he)){ub(Zt,N);continue}de&&(he=tn(he,le," "),he=tn(he,Se," "),he=tn(he,me," "));var Qk=Xe(N.nodeName);if(Xk(Qk,ut,he)){if(E&&(ut==="id"||ut==="name")&&(ub(Zt,N),he=A+he),k&&ii(d)==="object"&&typeof d.getAttributeType=="function"&&!fb)switch(d.getAttributeType(Qk,ut)){case"TrustedHTML":{he=k.createHTML(he);break}case"TrustedScriptURL":{he=k.createScriptURL(he);break}}try{fb?N.setAttributeNS(fb,Zt,he):N.setAttribute(Zt,he),L1(t.removed)}catch{}}}}zn("afterSanitizeAttributes",N,null)}},pY=function Ee(N){var oe,he=Kk(N);for(zn("beforeSanitizeShadowDOM",N,null);oe=he.nextNode();)zn("uponSanitizeShadowNode",oe,null),!qk(oe)&&(oe.content instanceof o&&Ee(oe.content),Jk(oe));zn("afterSanitizeShadowDOM",N,null)};return t.sanitize=function(Ee){var N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},oe,he,ut,Sr,rr;if(ct=!Ee,ct&&(Ee="<!-->"),typeof Ee!="string"&&!Mf(Ee))if(typeof Ee.toString=="function"){if(Ee=Ee.toString(),typeof Ee!="string")throw lw("dirty is not a string, aborting")}else throw lw("toString is not a function");if(!t.isSupported){if(ii(e.toStaticHTML)==="object"||typeof e.toStaticHTML=="function"){if(typeof Ee=="string")return e.toStaticHTML(Ee);if(Mf(Ee))return e.toStaticHTML(Ee.outerHTML)}return Ee}if(Me||st(N),t.removed=[],typeof Ee=="string"&&(M=!1),M){if(Ee.nodeName){var tr=Xe(Ee.nodeName);if(!_[tr]||G[tr])throw lw("root node is forbidden and cannot be sanitized in-place")}}else if(Ee instanceof a)oe=Gk("<!---->"),he=oe.ownerDocument.importNode(Ee,!0),he.nodeType===1&&he.nodeName==="BODY"||he.nodeName==="HTML"?oe=he:oe.appendChild(he);else{if(!Pe&&!de&&!K&&Ee.indexOf("<")===-1)return k&&$e?k.createHTML(Ee):Ee;if(oe=Gk(Ee),!oe)return Pe?null:$e?R:""}oe&&Ge&&Un(oe.firstChild);for(var Nv=Kk(M?Ee:oe);ut=Nv.nextNode();)ut.nodeType===3&&ut===Sr||qk(ut)||(ut.content instanceof o&&pY(ut.content),Jk(ut),Sr=ut);if(Sr=null,M)return Ee;if(Pe){if(Ie)for(rr=Y.call(oe.ownerDocument);oe.firstChild;)rr.appendChild(oe.firstChild);else rr=oe;return(I.shadowroot||I.shadowrootmod)&&(rr=Z.call(r,rr,!0)),rr}var Zt=K?oe.outerHTML:oe.innerHTML;return K&&_["!doctype"]&&oe.ownerDocument&&oe.ownerDocument.doctype&&oe.ownerDocument.doctype.name&&fr(Pte,oe.ownerDocument.doctype.name)&&(Zt="<!DOCTYPE "+oe.ownerDocument.doctype.name+`>
`+Zt),de&&(Zt=tn(Zt,le," "),Zt=tn(Zt,Se," "),Zt=tn(Zt,me," ")),k&&$e?k.createHTML(Zt):Zt},t.setConfig=function(Ee){st(Ee),Me=!0},t.clearConfig=function(){Je=null,Me=!1},t.isValidAttribute=function(Ee,N,oe){Je||st({});var he=Xe(Ee),ut=Xe(N);return Xk(he,ut,oe)},t.addHook=function(Ee,N){typeof N=="function"&&(J[Ee]=J[Ee]||[],Bf(J[Ee],N))},t.removeHook=function(Ee){if(J[Ee])return L1(J[Ee])},t.removeHooks=function(Ee){J[Ee]&&(J[Ee]=[])},t.removeAllHooks=function(){J={}},t}var Ite=kB(),Mte=Ae,xte=R0.codeAt;Mte({target:"String",proto:!0},{codePointAt:function(t){return xte(this,t)}});var Dte=Ii,Nte=Yt,Hte=Tr,Lte=RangeError,K0=function(t){var r=Nte(Hte(this)),n="",o=Dte(t);if(o<0||o===1/0)throw new Lte("Wrong number of repetitions");for(;o>0;(o>>>=1)&&(r+=r))o&1&&(n+=r);return n},PB=Ue,jte=Qa,W1=Yt,Fte=K0,Bte=Tr,Vte=PB(Fte),Wte=PB("".slice),Ute=Math.ceil,U1=function(e){return function(t,r,n){var o=W1(Bte(t)),i=jte(r),a=o.length,l=n===void 0?" ":W1(n),s,u;return i<=a||l===""?o:(s=i-a,u=Vte(l,Ute(s/l.length)),u.length>s&&(u=Wte(u,0,s)),e?o+u:u+o)}},zte={start:U1(!1),end:U1(!0)},Yte=Ka,Gte=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(Yte),Kte=Ae,qte=zte.start,Xte=Gte;Kte({target:"String",proto:!0,forced:Xte},{padStart:function(t){return qte(this,t,arguments.length>1?arguments[1]:void 0)}});//! moment.js
//! version : 2.29.4
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var $B;function te(){return $B.apply(null,arguments)}function Zte(e){$B=e}function vn(e){return e instanceof Array||Object.prototype.toString.call(e)==="[object Array]"}function Ma(e){return e!=null&&Object.prototype.toString.call(e)==="[object Object]"}function at(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function q0(e){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(e).length===0;var t;for(t in e)if(at(e,t))return!1;return!0}function _r(e){return e===void 0}function Ho(e){return typeof e=="number"||Object.prototype.toString.call(e)==="[object Number]"}function dv(e){return e instanceof Date||Object.prototype.toString.call(e)==="[object Date]"}function AB(e,t){var r=[],n,o=e.length;for(n=0;n<o;++n)r.push(t(e[n],n));return r}function si(e,t){for(var r in t)at(t,r)&&(e[r]=t[r]);return at(t,"toString")&&(e.toString=t.toString),at(t,"valueOf")&&(e.valueOf=t.valueOf),e}function Vn(e,t,r,n){return tV(e,t,r,n,!0).utc()}function Jte(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function ze(e){return e._pf==null&&(e._pf=Jte()),e._pf}var $C;Array.prototype.some?$C=Array.prototype.some:$C=function(e){var t=Object(this),r=t.length>>>0,n;for(n=0;n<r;n++)if(n in t&&e.call(this,t[n],n,t))return!0;return!1};function X0(e){if(e._isValid==null){var t=ze(e),r=$C.call(t.parsedDateParts,function(o){return o!=null}),n=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidEra&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&r);if(e._strict&&(n=n&&t.charsLeftOver===0&&t.unusedTokens.length===0&&t.bigHour===void 0),Object.isFrozen==null||!Object.isFrozen(e))e._isValid=n;else return n}return e._isValid}function Cm(e){var t=Vn(NaN);return e!=null?si(ze(t),e):ze(t).userInvalidated=!0,t}var z1=te.momentProperties=[],hw=!1;function Z0(e,t){var r,n,o,i=z1.length;if(_r(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),_r(t._i)||(e._i=t._i),_r(t._f)||(e._f=t._f),_r(t._l)||(e._l=t._l),_r(t._strict)||(e._strict=t._strict),_r(t._tzm)||(e._tzm=t._tzm),_r(t._isUTC)||(e._isUTC=t._isUTC),_r(t._offset)||(e._offset=t._offset),_r(t._pf)||(e._pf=ze(t)),_r(t._locale)||(e._locale=t._locale),i>0)for(r=0;r<i;r++)n=z1[r],o=t[n],_r(o)||(e[n]=o);return e}function vv(e){Z0(this,e),this._d=new Date(e._d!=null?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),hw===!1&&(hw=!0,te.updateOffset(this),hw=!1)}function yn(e){return e instanceof vv||e!=null&&e._isAMomentObject!=null}function IB(e){te.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+e)}function Jr(e,t){var r=!0;return si(function(){if(te.deprecationHandler!=null&&te.deprecationHandler(null,e),r){var n=[],o,i,a,l=arguments.length;for(i=0;i<l;i++){if(o="",typeof arguments[i]=="object"){o+=`
[`+i+"] ";for(a in arguments[0])at(arguments[0],a)&&(o+=a+": "+arguments[0][a]+", ");o=o.slice(0,-2)}else o=arguments[i];n.push(o)}IB(e+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),r=!1}return t.apply(this,arguments)},t)}var Y1={};function MB(e,t){te.deprecationHandler!=null&&te.deprecationHandler(e,t),Y1[e]||(IB(t),Y1[e]=!0)}te.suppressDeprecationWarnings=!1;te.deprecationHandler=null;function Wn(e){return typeof Function<"u"&&e instanceof Function||Object.prototype.toString.call(e)==="[object Function]"}function Qte(e){var t,r;for(r in e)at(e,r)&&(t=e[r],Wn(t)?this[r]=t:this["_"+r]=t);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function AC(e,t){var r=si({},e),n;for(n in t)at(t,n)&&(Ma(e[n])&&Ma(t[n])?(r[n]={},si(r[n],e[n]),si(r[n],t[n])):t[n]!=null?r[n]=t[n]:delete r[n]);for(n in e)at(e,n)&&!at(t,n)&&Ma(e[n])&&(r[n]=si({},r[n]));return r}function J0(e){e!=null&&this.set(e)}var IC;Object.keys?IC=Object.keys:IC=function(e){var t,r=[];for(t in e)at(e,t)&&r.push(t);return r};var ere={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function tre(e,t,r){var n=this._calendar[e]||this._calendar.sameElse;return Wn(n)?n.call(t,r):n}function Ln(e,t,r){var n=""+Math.abs(e),o=t-n.length,i=e>=0;return(i?r?"+":"":"-")+Math.pow(10,Math.max(0,o)).toString().substr(1)+n}var Q0=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Jv=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,dw={},Xl={};function ke(e,t,r,n){var o=n;typeof n=="string"&&(o=function(){return this[n]()}),e&&(Xl[e]=o),t&&(Xl[t[0]]=function(){return Ln(o.apply(this,arguments),t[1],t[2])}),r&&(Xl[r]=function(){return this.localeData().ordinal(o.apply(this,arguments),e)})}function rre(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function nre(e){var t=e.match(Q0),r,n;for(r=0,n=t.length;r<n;r++)Xl[t[r]]?t[r]=Xl[t[r]]:t[r]=rre(t[r]);return function(o){var i="",a;for(a=0;a<n;a++)i+=Wn(t[a])?t[a].call(o,e):t[a];return i}}function tg(e,t){return e.isValid()?(t=xB(t,e.localeData()),dw[t]=dw[t]||nre(t),dw[t](e)):e.localeData().invalidDate()}function xB(e,t){var r=5;function n(o){return t.longDateFormat(o)||o}for(Jv.lastIndex=0;r>=0&&Jv.test(e);)e=e.replace(Jv,n),Jv.lastIndex=0,r-=1;return e}var ore={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function ire(e){var t=this._longDateFormat[e],r=this._longDateFormat[e.toUpperCase()];return t||!r?t:(this._longDateFormat[e]=r.match(Q0).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[e])}var are="Invalid date";function lre(){return this._invalidDate}var sre="%d",ure=/\d{1,2}/;function fre(e){return this._ordinal.replace("%d",e)}var cre={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function hre(e,t,r,n){var o=this._relativeTime[r];return Wn(o)?o(e,t,r,n):o.replace(/%d/i,e)}function dre(e,t){var r=this._relativeTime[e>0?"future":"past"];return Wn(r)?r(t):r.replace(/%s/i,t)}var Sc={};function sr(e,t){var r=e.toLowerCase();Sc[r]=Sc[r+"s"]=Sc[t]=e}function Qr(e){return typeof e=="string"?Sc[e]||Sc[e.toLowerCase()]:void 0}function eE(e){var t={},r,n;for(n in e)at(e,n)&&(r=Qr(n),r&&(t[r]=e[n]));return t}var DB={};function ur(e,t){DB[e]=t}function vre(e){var t=[],r;for(r in e)at(e,r)&&t.push({unit:r,priority:DB[r]});return t.sort(function(n,o){return n.priority-o.priority}),t}function _m(e){return e%4===0&&e%100!==0||e%400===0}function Kr(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function Ze(e){var t=+e,r=0;return t!==0&&isFinite(t)&&(r=Kr(t)),r}function Ef(e,t){return function(r){return r!=null?(NB(this,e,r),te.updateOffset(this,t),this):Bg(this,e)}}function Bg(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function NB(e,t,r){e.isValid()&&!isNaN(r)&&(t==="FullYear"&&_m(e.year())&&e.month()===1&&e.date()===29?(r=Ze(r),e._d["set"+(e._isUTC?"UTC":"")+t](r,e.month(),Pm(r,e.month()))):e._d["set"+(e._isUTC?"UTC":"")+t](r))}function yre(e){return e=Qr(e),Wn(this[e])?this[e]():this}function gre(e,t){if(typeof e=="object"){e=eE(e);var r=vre(e),n,o=r.length;for(n=0;n<o;n++)this[r[n].unit](e[r[n].unit])}else if(e=Qr(e),Wn(this[e]))return this[e](t);return this}var HB=/\d/,Vr=/\d\d/,LB=/\d{3}/,tE=/\d{4}/,Om=/[+-]?\d{6}/,_t=/\d\d?/,jB=/\d\d\d\d?/,FB=/\d\d\d\d\d\d?/,Rm=/\d{1,3}/,rE=/\d{1,4}/,Em=/[+-]?\d{1,6}/,Tf=/\d+/,Tm=/[+-]?\d+/,pre=/Z|[+-]\d\d:?\d\d/gi,km=/Z|[+-]\d\d(?::?\d\d)?/gi,mre=/[+-]?\d+(\.\d{1,3})?/,yv=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Vg;Vg={};function we(e,t,r){Vg[e]=Wn(t)?t:function(n,o){return n&&r?r:t}}function bre(e,t){return at(Vg,e)?Vg[e](t._strict,t._locale):new RegExp(wre(e))}function wre(e){return Hr(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(t,r,n,o,i){return r||n||o||i}))}function Hr(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var MC={};function mt(e,t){var r,n=t,o;for(typeof e=="string"&&(e=[e]),Ho(t)&&(n=function(i,a){a[t]=Ze(i)}),o=e.length,r=0;r<o;r++)MC[e[r]]=n}function gv(e,t){mt(e,function(r,n,o,i){o._w=o._w||{},t(r,o._w,o,i)})}function Sre(e,t,r){t!=null&&at(MC,e)&&MC[e](t,r._a,r,e)}var ir=0,io=1,Dn=2,qt=3,hn=4,ao=5,na=6,Cre=7,_re=8;function Ore(e,t){return(e%t+t)%t}var Bt;Array.prototype.indexOf?Bt=Array.prototype.indexOf:Bt=function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1};function Pm(e,t){if(isNaN(e)||isNaN(t))return NaN;var r=Ore(t,12);return e+=(t-r)/12,r===1?_m(e)?29:28:31-r%7%2}ke("M",["MM",2],"Mo",function(){return this.month()+1});ke("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)});ke("MMMM",0,0,function(e){return this.localeData().months(this,e)});sr("month","M");ur("month",8);we("M",_t);we("MM",_t,Vr);we("MMM",function(e,t){return t.monthsShortRegex(e)});we("MMMM",function(e,t){return t.monthsRegex(e)});mt(["M","MM"],function(e,t){t[io]=Ze(e)-1});mt(["MMM","MMMM"],function(e,t,r,n){var o=r._locale.monthsParse(e,n,r._strict);o!=null?t[io]=o:ze(r).invalidMonth=e});var Rre="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),BB="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),VB=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Ere=yv,Tre=yv;function kre(e,t){return e?vn(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||VB).test(t)?"format":"standalone"][e.month()]:vn(this._months)?this._months:this._months.standalone}function Pre(e,t){return e?vn(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[VB.test(t)?"format":"standalone"][e.month()]:vn(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function $re(e,t,r){var n,o,i,a=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)i=Vn([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(i,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(i,"").toLocaleLowerCase();return r?t==="MMM"?(o=Bt.call(this._shortMonthsParse,a),o!==-1?o:null):(o=Bt.call(this._longMonthsParse,a),o!==-1?o:null):t==="MMM"?(o=Bt.call(this._shortMonthsParse,a),o!==-1?o:(o=Bt.call(this._longMonthsParse,a),o!==-1?o:null)):(o=Bt.call(this._longMonthsParse,a),o!==-1?o:(o=Bt.call(this._shortMonthsParse,a),o!==-1?o:null))}function Are(e,t,r){var n,o,i;if(this._monthsParseExact)return $re.call(this,e,t,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(o=Vn([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(o,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(o,"").replace(".","")+"$","i")),!r&&!this._monthsParse[n]&&(i="^"+this.months(o,"")+"|^"+this.monthsShort(o,""),this._monthsParse[n]=new RegExp(i.replace(".",""),"i")),r&&t==="MMMM"&&this._longMonthsParse[n].test(e))return n;if(r&&t==="MMM"&&this._shortMonthsParse[n].test(e))return n;if(!r&&this._monthsParse[n].test(e))return n}}function WB(e,t){var r;if(!e.isValid())return e;if(typeof t=="string"){if(/^\d+$/.test(t))t=Ze(t);else if(t=e.localeData().monthsParse(t),!Ho(t))return e}return r=Math.min(e.date(),Pm(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,r),e}function UB(e){return e!=null?(WB(this,e),te.updateOffset(this,!0),this):Bg(this,"Month")}function Ire(){return Pm(this.year(),this.month())}function Mre(e){return this._monthsParseExact?(at(this,"_monthsRegex")||zB.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(at(this,"_monthsShortRegex")||(this._monthsShortRegex=Ere),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function xre(e){return this._monthsParseExact?(at(this,"_monthsRegex")||zB.call(this),e?this._monthsStrictRegex:this._monthsRegex):(at(this,"_monthsRegex")||(this._monthsRegex=Tre),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function zB(){function e(a,l){return l.length-a.length}var t=[],r=[],n=[],o,i;for(o=0;o<12;o++)i=Vn([2e3,o]),t.push(this.monthsShort(i,"")),r.push(this.months(i,"")),n.push(this.months(i,"")),n.push(this.monthsShort(i,""));for(t.sort(e),r.sort(e),n.sort(e),o=0;o<12;o++)t[o]=Hr(t[o]),r[o]=Hr(r[o]);for(o=0;o<24;o++)n[o]=Hr(n[o]);this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+t.join("|")+")","i")}ke("Y",0,0,function(){var e=this.year();return e<=9999?Ln(e,4):"+"+e});ke(0,["YY",2],0,function(){return this.year()%100});ke(0,["YYYY",4],0,"year");ke(0,["YYYYY",5],0,"year");ke(0,["YYYYYY",6,!0],0,"year");sr("year","y");ur("year",1);we("Y",Tm);we("YY",_t,Vr);we("YYYY",rE,tE);we("YYYYY",Em,Om);we("YYYYYY",Em,Om);mt(["YYYYY","YYYYYY"],ir);mt("YYYY",function(e,t){t[ir]=e.length===2?te.parseTwoDigitYear(e):Ze(e)});mt("YY",function(e,t){t[ir]=te.parseTwoDigitYear(e)});mt("Y",function(e,t){t[ir]=parseInt(e,10)});function Cc(e){return _m(e)?366:365}te.parseTwoDigitYear=function(e){return Ze(e)+(Ze(e)>68?1900:2e3)};var YB=Ef("FullYear",!0);function Dre(){return _m(this.year())}function Nre(e,t,r,n,o,i,a){var l;return e<100&&e>=0?(l=new Date(e+400,t,r,n,o,i,a),isFinite(l.getFullYear())&&l.setFullYear(e)):l=new Date(e,t,r,n,o,i,a),l}function Fc(e){var t,r;return e<100&&e>=0?(r=Array.prototype.slice.call(arguments),r[0]=e+400,t=new Date(Date.UTC.apply(null,r)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)):t=new Date(Date.UTC.apply(null,arguments)),t}function Wg(e,t,r){var n=7+t-r,o=(7+Fc(e,0,n).getUTCDay()-t)%7;return-o+n-1}function GB(e,t,r,n,o){var i=(7+r-n)%7,a=Wg(e,n,o),l=1+7*(t-1)+i+a,s,u;return l<=0?(s=e-1,u=Cc(s)+l):l>Cc(e)?(s=e+1,u=l-Cc(e)):(s=e,u=l),{year:s,dayOfYear:u}}function Bc(e,t,r){var n=Wg(e.year(),t,r),o=Math.floor((e.dayOfYear()-n-1)/7)+1,i,a;return o<1?(a=e.year()-1,i=o+Mo(a,t,r)):o>Mo(e.year(),t,r)?(i=o-Mo(e.year(),t,r),a=e.year()+1):(a=e.year(),i=o),{week:i,year:a}}function Mo(e,t,r){var n=Wg(e,t,r),o=Wg(e+1,t,r);return(Cc(e)-n+o)/7}ke("w",["ww",2],"wo","week");ke("W",["WW",2],"Wo","isoWeek");sr("week","w");sr("isoWeek","W");ur("week",5);ur("isoWeek",5);we("w",_t);we("ww",_t,Vr);we("W",_t);we("WW",_t,Vr);gv(["w","ww","W","WW"],function(e,t,r,n){t[n.substr(0,1)]=Ze(e)});function Hre(e){return Bc(e,this._week.dow,this._week.doy).week}var Lre={dow:0,doy:6};function jre(){return this._week.dow}function Fre(){return this._week.doy}function Bre(e){var t=this.localeData().week(this);return e==null?t:this.add((e-t)*7,"d")}function Vre(e){var t=Bc(this,1,4).week;return e==null?t:this.add((e-t)*7,"d")}ke("d",0,"do","day");ke("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)});ke("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)});ke("dddd",0,0,function(e){return this.localeData().weekdays(this,e)});ke("e",0,0,"weekday");ke("E",0,0,"isoWeekday");sr("day","d");sr("weekday","e");sr("isoWeekday","E");ur("day",11);ur("weekday",11);ur("isoWeekday",11);we("d",_t);we("e",_t);we("E",_t);we("dd",function(e,t){return t.weekdaysMinRegex(e)});we("ddd",function(e,t){return t.weekdaysShortRegex(e)});we("dddd",function(e,t){return t.weekdaysRegex(e)});gv(["dd","ddd","dddd"],function(e,t,r,n){var o=r._locale.weekdaysParse(e,n,r._strict);o!=null?t.d=o:ze(r).invalidWeekday=e});gv(["d","e","E"],function(e,t,r,n){t[n]=Ze(e)});function Wre(e,t){return typeof e!="string"?e:isNaN(e)?(e=t.weekdaysParse(e),typeof e=="number"?e:null):parseInt(e,10)}function Ure(e,t){return typeof e=="string"?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function nE(e,t){return e.slice(t,7).concat(e.slice(0,t))}var zre="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),KB="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Yre="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Gre=yv,Kre=yv,qre=yv;function Xre(e,t){var r=vn(this._weekdays)?this._weekdays:this._weekdays[e&&e!==!0&&this._weekdays.isFormat.test(t)?"format":"standalone"];return e===!0?nE(r,this._week.dow):e?r[e.day()]:r}function Zre(e){return e===!0?nE(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function Jre(e){return e===!0?nE(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function Qre(e,t,r){var n,o,i,a=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)i=Vn([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(i,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(i,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(i,"").toLocaleLowerCase();return r?t==="dddd"?(o=Bt.call(this._weekdaysParse,a),o!==-1?o:null):t==="ddd"?(o=Bt.call(this._shortWeekdaysParse,a),o!==-1?o:null):(o=Bt.call(this._minWeekdaysParse,a),o!==-1?o:null):t==="dddd"?(o=Bt.call(this._weekdaysParse,a),o!==-1||(o=Bt.call(this._shortWeekdaysParse,a),o!==-1)?o:(o=Bt.call(this._minWeekdaysParse,a),o!==-1?o:null)):t==="ddd"?(o=Bt.call(this._shortWeekdaysParse,a),o!==-1||(o=Bt.call(this._weekdaysParse,a),o!==-1)?o:(o=Bt.call(this._minWeekdaysParse,a),o!==-1?o:null)):(o=Bt.call(this._minWeekdaysParse,a),o!==-1||(o=Bt.call(this._weekdaysParse,a),o!==-1)?o:(o=Bt.call(this._shortWeekdaysParse,a),o!==-1?o:null))}function ene(e,t,r){var n,o,i;if(this._weekdaysParseExact)return Qre.call(this,e,t,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(o=Vn([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(o,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(o,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(o,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(i="^"+this.weekdays(o,"")+"|^"+this.weekdaysShort(o,"")+"|^"+this.weekdaysMin(o,""),this._weekdaysParse[n]=new RegExp(i.replace(".",""),"i")),r&&t==="dddd"&&this._fullWeekdaysParse[n].test(e))return n;if(r&&t==="ddd"&&this._shortWeekdaysParse[n].test(e))return n;if(r&&t==="dd"&&this._minWeekdaysParse[n].test(e))return n;if(!r&&this._weekdaysParse[n].test(e))return n}}function tne(e){if(!this.isValid())return e!=null?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return e!=null?(e=Wre(e,this.localeData()),this.add(e-t,"d")):t}function rne(e){if(!this.isValid())return e!=null?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return e==null?t:this.add(e-t,"d")}function nne(e){if(!this.isValid())return e!=null?this:NaN;if(e!=null){var t=Ure(e,this.localeData());return this.day(this.day()%7?t:t-7)}else return this.day()||7}function one(e){return this._weekdaysParseExact?(at(this,"_weekdaysRegex")||oE.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(at(this,"_weekdaysRegex")||(this._weekdaysRegex=Gre),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function ine(e){return this._weekdaysParseExact?(at(this,"_weekdaysRegex")||oE.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(at(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Kre),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function ane(e){return this._weekdaysParseExact?(at(this,"_weekdaysRegex")||oE.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(at(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=qre),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function oE(){function e(f,c){return c.length-f.length}var t=[],r=[],n=[],o=[],i,a,l,s,u;for(i=0;i<7;i++)a=Vn([2e3,1]).day(i),l=Hr(this.weekdaysMin(a,"")),s=Hr(this.weekdaysShort(a,"")),u=Hr(this.weekdays(a,"")),t.push(l),r.push(s),n.push(u),o.push(l),o.push(s),o.push(u);t.sort(e),r.sort(e),n.sort(e),o.sort(e),this._weekdaysRegex=new RegExp("^("+o.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+t.join("|")+")","i")}function iE(){return this.hours()%12||12}function lne(){return this.hours()||24}ke("H",["HH",2],0,"hour");ke("h",["hh",2],0,iE);ke("k",["kk",2],0,lne);ke("hmm",0,0,function(){return""+iE.apply(this)+Ln(this.minutes(),2)});ke("hmmss",0,0,function(){return""+iE.apply(this)+Ln(this.minutes(),2)+Ln(this.seconds(),2)});ke("Hmm",0,0,function(){return""+this.hours()+Ln(this.minutes(),2)});ke("Hmmss",0,0,function(){return""+this.hours()+Ln(this.minutes(),2)+Ln(this.seconds(),2)});function qB(e,t){ke(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}qB("a",!0);qB("A",!1);sr("hour","h");ur("hour",13);function XB(e,t){return t._meridiemParse}we("a",XB);we("A",XB);we("H",_t);we("h",_t);we("k",_t);we("HH",_t,Vr);we("hh",_t,Vr);we("kk",_t,Vr);we("hmm",jB);we("hmmss",FB);we("Hmm",jB);we("Hmmss",FB);mt(["H","HH"],qt);mt(["k","kk"],function(e,t,r){var n=Ze(e);t[qt]=n===24?0:n});mt(["a","A"],function(e,t,r){r._isPm=r._locale.isPM(e),r._meridiem=e});mt(["h","hh"],function(e,t,r){t[qt]=Ze(e),ze(r).bigHour=!0});mt("hmm",function(e,t,r){var n=e.length-2;t[qt]=Ze(e.substr(0,n)),t[hn]=Ze(e.substr(n)),ze(r).bigHour=!0});mt("hmmss",function(e,t,r){var n=e.length-4,o=e.length-2;t[qt]=Ze(e.substr(0,n)),t[hn]=Ze(e.substr(n,2)),t[ao]=Ze(e.substr(o)),ze(r).bigHour=!0});mt("Hmm",function(e,t,r){var n=e.length-2;t[qt]=Ze(e.substr(0,n)),t[hn]=Ze(e.substr(n))});mt("Hmmss",function(e,t,r){var n=e.length-4,o=e.length-2;t[qt]=Ze(e.substr(0,n)),t[hn]=Ze(e.substr(n,2)),t[ao]=Ze(e.substr(o))});function sne(e){return(e+"").toLowerCase().charAt(0)==="p"}var une=/[ap]\.?m?\.?/i,fne=Ef("Hours",!0);function cne(e,t,r){return e>11?r?"pm":"PM":r?"am":"AM"}var ZB={calendar:ere,longDateFormat:ore,invalidDate:are,ordinal:sre,dayOfMonthOrdinalParse:ure,relativeTime:cre,months:Rre,monthsShort:BB,week:Lre,weekdays:zre,weekdaysMin:Yre,weekdaysShort:KB,meridiemParse:une},Ot={},Vf={},Vc;function hne(e,t){var r,n=Math.min(e.length,t.length);for(r=0;r<n;r+=1)if(e[r]!==t[r])return r;return n}function G1(e){return e&&e.toLowerCase().replace("_","-")}function dne(e){for(var t=0,r,n,o,i;t<e.length;){for(i=G1(e[t]).split("-"),r=i.length,n=G1(e[t+1]),n=n?n.split("-"):null;r>0;){if(o=$m(i.slice(0,r).join("-")),o)return o;if(n&&n.length>=r&&hne(i,n)>=r-1)break;r--}t++}return Vc}function vne(e){return e.match("^[^/\\\\]*$")!=null}function $m(e){var t=null,r;if(Ot[e]===void 0&&typeof module<"u"&&module&&module.exports&&vne(e))try{t=Vc._abbr,r=require,r("./locale/"+e),hi(t)}catch{Ot[e]=null}return Ot[e]}function hi(e,t){var r;return e&&(_r(t)?r=Vo(e):r=aE(e,t),r?Vc=r:typeof console<"u"&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),Vc._abbr}function aE(e,t){if(t!==null){var r,n=ZB;if(t.abbr=e,Ot[e]!=null)MB("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=Ot[e]._config;else if(t.parentLocale!=null)if(Ot[t.parentLocale]!=null)n=Ot[t.parentLocale]._config;else if(r=$m(t.parentLocale),r!=null)n=r._config;else return Vf[t.parentLocale]||(Vf[t.parentLocale]=[]),Vf[t.parentLocale].push({name:e,config:t}),null;return Ot[e]=new J0(AC(n,t)),Vf[e]&&Vf[e].forEach(function(o){aE(o.name,o.config)}),hi(e),Ot[e]}else return delete Ot[e],null}function yne(e,t){if(t!=null){var r,n,o=ZB;Ot[e]!=null&&Ot[e].parentLocale!=null?Ot[e].set(AC(Ot[e]._config,t)):(n=$m(e),n!=null&&(o=n._config),t=AC(o,t),n==null&&(t.abbr=e),r=new J0(t),r.parentLocale=Ot[e],Ot[e]=r),hi(e)}else Ot[e]!=null&&(Ot[e].parentLocale!=null?(Ot[e]=Ot[e].parentLocale,e===hi()&&hi(e)):Ot[e]!=null&&delete Ot[e]);return Ot[e]}function Vo(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return Vc;if(!vn(e)){if(t=$m(e),t)return t;e=[e]}return dne(e)}function gne(){return IC(Ot)}function lE(e){var t,r=e._a;return r&&ze(e).overflow===-2&&(t=r[io]<0||r[io]>11?io:r[Dn]<1||r[Dn]>Pm(r[ir],r[io])?Dn:r[qt]<0||r[qt]>24||r[qt]===24&&(r[hn]!==0||r[ao]!==0||r[na]!==0)?qt:r[hn]<0||r[hn]>59?hn:r[ao]<0||r[ao]>59?ao:r[na]<0||r[na]>999?na:-1,ze(e)._overflowDayOfYear&&(t<ir||t>Dn)&&(t=Dn),ze(e)._overflowWeeks&&t===-1&&(t=Cre),ze(e)._overflowWeekday&&t===-1&&(t=_re),ze(e).overflow=t),e}var pne=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,mne=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,bne=/Z|[+-]\d\d(?::?\d\d)?/,Qv=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],vw=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],wne=/^\/?Date\((-?\d+)/i,Sne=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,Cne={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function JB(e){var t,r,n=e._i,o=pne.exec(n)||mne.exec(n),i,a,l,s,u=Qv.length,f=vw.length;if(o){for(ze(e).iso=!0,t=0,r=u;t<r;t++)if(Qv[t][1].exec(o[1])){a=Qv[t][0],i=Qv[t][2]!==!1;break}if(a==null){e._isValid=!1;return}if(o[3]){for(t=0,r=f;t<r;t++)if(vw[t][1].exec(o[3])){l=(o[2]||" ")+vw[t][0];break}if(l==null){e._isValid=!1;return}}if(!i&&l!=null){e._isValid=!1;return}if(o[4])if(bne.exec(o[4]))s="Z";else{e._isValid=!1;return}e._f=a+(l||"")+(s||""),uE(e)}else e._isValid=!1}function _ne(e,t,r,n,o,i){var a=[One(e),BB.indexOf(t),parseInt(r,10),parseInt(n,10),parseInt(o,10)];return i&&a.push(parseInt(i,10)),a}function One(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function Rne(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function Ene(e,t,r){if(e){var n=KB.indexOf(e),o=new Date(t[0],t[1],t[2]).getDay();if(n!==o)return ze(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function Tne(e,t,r){if(e)return Cne[e];if(t)return 0;var n=parseInt(r,10),o=n%100,i=(n-o)/100;return i*60+o}function QB(e){var t=Sne.exec(Rne(e._i)),r;if(t){if(r=_ne(t[4],t[3],t[2],t[5],t[6],t[7]),!Ene(t[1],r,e))return;e._a=r,e._tzm=Tne(t[8],t[9],t[10]),e._d=Fc.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),ze(e).rfc2822=!0}else e._isValid=!1}function kne(e){var t=wne.exec(e._i);if(t!==null){e._d=new Date(+t[1]);return}if(JB(e),e._isValid===!1)delete e._isValid;else return;if(QB(e),e._isValid===!1)delete e._isValid;else return;e._strict?e._isValid=!1:te.createFromInputFallback(e)}te.createFromInputFallback=Jr("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))});function Bl(e,t,r){return e??t??r}function Pne(e){var t=new Date(te.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function sE(e){var t,r,n=[],o,i,a;if(!e._d){for(o=Pne(e),e._w&&e._a[Dn]==null&&e._a[io]==null&&$ne(e),e._dayOfYear!=null&&(a=Bl(e._a[ir],o[ir]),(e._dayOfYear>Cc(a)||e._dayOfYear===0)&&(ze(e)._overflowDayOfYear=!0),r=Fc(a,0,e._dayOfYear),e._a[io]=r.getUTCMonth(),e._a[Dn]=r.getUTCDate()),t=0;t<3&&e._a[t]==null;++t)e._a[t]=n[t]=o[t];for(;t<7;t++)e._a[t]=n[t]=e._a[t]==null?t===2?1:0:e._a[t];e._a[qt]===24&&e._a[hn]===0&&e._a[ao]===0&&e._a[na]===0&&(e._nextDay=!0,e._a[qt]=0),e._d=(e._useUTC?Fc:Nre).apply(null,n),i=e._useUTC?e._d.getUTCDay():e._d.getDay(),e._tzm!=null&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[qt]=24),e._w&&typeof e._w.d<"u"&&e._w.d!==i&&(ze(e).weekdayMismatch=!0)}}function $ne(e){var t,r,n,o,i,a,l,s,u;t=e._w,t.GG!=null||t.W!=null||t.E!=null?(i=1,a=4,r=Bl(t.GG,e._a[ir],Bc(Ct(),1,4).year),n=Bl(t.W,1),o=Bl(t.E,1),(o<1||o>7)&&(s=!0)):(i=e._locale._week.dow,a=e._locale._week.doy,u=Bc(Ct(),i,a),r=Bl(t.gg,e._a[ir],u.year),n=Bl(t.w,u.week),t.d!=null?(o=t.d,(o<0||o>6)&&(s=!0)):t.e!=null?(o=t.e+i,(t.e<0||t.e>6)&&(s=!0)):o=i),n<1||n>Mo(r,i,a)?ze(e)._overflowWeeks=!0:s!=null?ze(e)._overflowWeekday=!0:(l=GB(r,n,o,i,a),e._a[ir]=l.year,e._dayOfYear=l.dayOfYear)}te.ISO_8601=function(){};te.RFC_2822=function(){};function uE(e){if(e._f===te.ISO_8601){JB(e);return}if(e._f===te.RFC_2822){QB(e);return}e._a=[],ze(e).empty=!0;var t=""+e._i,r,n,o,i,a,l=t.length,s=0,u,f;for(o=xB(e._f,e._locale).match(Q0)||[],f=o.length,r=0;r<f;r++)i=o[r],n=(t.match(bre(i,e))||[])[0],n&&(a=t.substr(0,t.indexOf(n)),a.length>0&&ze(e).unusedInput.push(a),t=t.slice(t.indexOf(n)+n.length),s+=n.length),Xl[i]?(n?ze(e).empty=!1:ze(e).unusedTokens.push(i),Sre(i,n,e)):e._strict&&!n&&ze(e).unusedTokens.push(i);ze(e).charsLeftOver=l-s,t.length>0&&ze(e).unusedInput.push(t),e._a[qt]<=12&&ze(e).bigHour===!0&&e._a[qt]>0&&(ze(e).bigHour=void 0),ze(e).parsedDateParts=e._a.slice(0),ze(e).meridiem=e._meridiem,e._a[qt]=Ane(e._locale,e._a[qt],e._meridiem),u=ze(e).era,u!==null&&(e._a[ir]=e._locale.erasConvertYear(u,e._a[ir])),sE(e),lE(e)}function Ane(e,t,r){var n;return r==null?t:e.meridiemHour!=null?e.meridiemHour(t,r):(e.isPM!=null&&(n=e.isPM(r),n&&t<12&&(t+=12),!n&&t===12&&(t=0)),t)}function Ine(e){var t,r,n,o,i,a,l=!1,s=e._f.length;if(s===0){ze(e).invalidFormat=!0,e._d=new Date(NaN);return}for(o=0;o<s;o++)i=0,a=!1,t=Z0({},e),e._useUTC!=null&&(t._useUTC=e._useUTC),t._f=e._f[o],uE(t),X0(t)&&(a=!0),i+=ze(t).charsLeftOver,i+=ze(t).unusedTokens.length*10,ze(t).score=i,l?i<n&&(n=i,r=t):(n==null||i<n||a)&&(n=i,r=t,a&&(l=!0));si(e,r||t)}function Mne(e){if(!e._d){var t=eE(e._i),r=t.day===void 0?t.date:t.day;e._a=AB([t.year,t.month,r,t.hour,t.minute,t.second,t.millisecond],function(n){return n&&parseInt(n,10)}),sE(e)}}function xne(e){var t=new vv(lE(eV(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function eV(e){var t=e._i,r=e._f;return e._locale=e._locale||Vo(e._l),t===null||r===void 0&&t===""?Cm({nullInput:!0}):(typeof t=="string"&&(e._i=t=e._locale.preparse(t)),yn(t)?new vv(lE(t)):(dv(t)?e._d=t:vn(r)?Ine(e):r?uE(e):Dne(e),X0(e)||(e._d=null),e))}function Dne(e){var t=e._i;_r(t)?e._d=new Date(te.now()):dv(t)?e._d=new Date(t.valueOf()):typeof t=="string"?kne(e):vn(t)?(e._a=AB(t.slice(0),function(r){return parseInt(r,10)}),sE(e)):Ma(t)?Mne(e):Ho(t)?e._d=new Date(t):te.createFromInputFallback(e)}function tV(e,t,r,n,o){var i={};return(t===!0||t===!1)&&(n=t,t=void 0),(r===!0||r===!1)&&(n=r,r=void 0),(Ma(e)&&q0(e)||vn(e)&&e.length===0)&&(e=void 0),i._isAMomentObject=!0,i._useUTC=i._isUTC=o,i._l=r,i._i=e,i._f=t,i._strict=n,xne(i)}function Ct(e,t,r,n){return tV(e,t,r,n,!1)}var Nne=Jr("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Ct.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:Cm()}),Hne=Jr("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Ct.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:Cm()});function rV(e,t){var r,n;if(t.length===1&&vn(t[0])&&(t=t[0]),!t.length)return Ct();for(r=t[0],n=1;n<t.length;++n)(!t[n].isValid()||t[n][e](r))&&(r=t[n]);return r}function Lne(){var e=[].slice.call(arguments,0);return rV("isBefore",e)}function jne(){var e=[].slice.call(arguments,0);return rV("isAfter",e)}var Fne=function(){return Date.now?Date.now():+new Date},Wf=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Bne(e){var t,r=!1,n,o=Wf.length;for(t in e)if(at(e,t)&&!(Bt.call(Wf,t)!==-1&&(e[t]==null||!isNaN(e[t]))))return!1;for(n=0;n<o;++n)if(e[Wf[n]]){if(r)return!1;parseFloat(e[Wf[n]])!==Ze(e[Wf[n]])&&(r=!0)}return!0}function Vne(){return this._isValid}function Wne(){return wn(NaN)}function Am(e){var t=eE(e),r=t.year||0,n=t.quarter||0,o=t.month||0,i=t.week||t.isoWeek||0,a=t.day||0,l=t.hour||0,s=t.minute||0,u=t.second||0,f=t.millisecond||0;this._isValid=Bne(t),this._milliseconds=+f+u*1e3+s*6e4+l*1e3*60*60,this._days=+a+i*7,this._months=+o+n*3+r*12,this._data={},this._locale=Vo(),this._bubble()}function rg(e){return e instanceof Am}function xC(e){return e<0?Math.round(-1*e)*-1:Math.round(e)}function Une(e,t,r){var n=Math.min(e.length,t.length),o=Math.abs(e.length-t.length),i=0,a;for(a=0;a<n;a++)(r&&e[a]!==t[a]||!r&&Ze(e[a])!==Ze(t[a]))&&i++;return i+o}function nV(e,t){ke(e,0,0,function(){var r=this.utcOffset(),n="+";return r<0&&(r=-r,n="-"),n+Ln(~~(r/60),2)+t+Ln(~~r%60,2)})}nV("Z",":");nV("ZZ","");we("Z",km);we("ZZ",km);mt(["Z","ZZ"],function(e,t,r){r._useUTC=!0,r._tzm=fE(km,e)});var zne=/([\+\-]|\d\d)/gi;function fE(e,t){var r=(t||"").match(e),n,o,i;return r===null?null:(n=r[r.length-1]||[],o=(n+"").match(zne)||["-",0,0],i=+(o[1]*60)+Ze(o[2]),i===0?0:o[0]==="+"?i:-i)}function cE(e,t){var r,n;return t._isUTC?(r=t.clone(),n=(yn(e)||dv(e)?e.valueOf():Ct(e).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+n),te.updateOffset(r,!1),r):Ct(e).local()}function DC(e){return-Math.round(e._d.getTimezoneOffset())}te.updateOffset=function(){};function Yne(e,t,r){var n=this._offset||0,o;if(!this.isValid())return e!=null?this:NaN;if(e!=null){if(typeof e=="string"){if(e=fE(km,e),e===null)return this}else Math.abs(e)<16&&!r&&(e=e*60);return!this._isUTC&&t&&(o=DC(this)),this._offset=e,this._isUTC=!0,o!=null&&this.add(o,"m"),n!==e&&(!t||this._changeInProgress?aV(this,wn(e-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,te.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:DC(this)}function Gne(e,t){return e!=null?(typeof e!="string"&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function Kne(e){return this.utcOffset(0,e)}function qne(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(DC(this),"m")),this}function Xne(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var e=fE(pre,this._i);e!=null?this.utcOffset(e):this.utcOffset(0,!0)}return this}function Zne(e){return this.isValid()?(e=e?Ct(e).utcOffset():0,(this.utcOffset()-e)%60===0):!1}function Jne(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Qne(){if(!_r(this._isDSTShifted))return this._isDSTShifted;var e={},t;return Z0(e,this),e=eV(e),e._a?(t=e._isUTC?Vn(e._a):Ct(e._a),this._isDSTShifted=this.isValid()&&Une(e._a,t.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function eoe(){return this.isValid()?!this._isUTC:!1}function toe(){return this.isValid()?this._isUTC:!1}function oV(){return this.isValid()?this._isUTC&&this._offset===0:!1}var roe=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,noe=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function wn(e,t){var r=e,n=null,o,i,a;return rg(e)?r={ms:e._milliseconds,d:e._days,M:e._months}:Ho(e)||!isNaN(+e)?(r={},t?r[t]=+e:r.milliseconds=+e):(n=roe.exec(e))?(o=n[1]==="-"?-1:1,r={y:0,d:Ze(n[Dn])*o,h:Ze(n[qt])*o,m:Ze(n[hn])*o,s:Ze(n[ao])*o,ms:Ze(xC(n[na]*1e3))*o}):(n=noe.exec(e))?(o=n[1]==="-"?-1:1,r={y:Bi(n[2],o),M:Bi(n[3],o),w:Bi(n[4],o),d:Bi(n[5],o),h:Bi(n[6],o),m:Bi(n[7],o),s:Bi(n[8],o)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(a=ooe(Ct(r.from),Ct(r.to)),r={},r.ms=a.milliseconds,r.M=a.months),i=new Am(r),rg(e)&&at(e,"_locale")&&(i._locale=e._locale),rg(e)&&at(e,"_isValid")&&(i._isValid=e._isValid),i}wn.fn=Am.prototype;wn.invalid=Wne;function Bi(e,t){var r=e&&parseFloat(e.replace(",","."));return(isNaN(r)?0:r)*t}function K1(e,t){var r={};return r.months=t.month()-e.month()+(t.year()-e.year())*12,e.clone().add(r.months,"M").isAfter(t)&&--r.months,r.milliseconds=+t-+e.clone().add(r.months,"M"),r}function ooe(e,t){var r;return e.isValid()&&t.isValid()?(t=cE(t,e),e.isBefore(t)?r=K1(e,t):(r=K1(t,e),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function iV(e,t){return function(r,n){var o,i;return n!==null&&!isNaN(+n)&&(MB(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),i=r,r=n,n=i),o=wn(r,n),aV(this,o,e),this}}function aV(e,t,r,n){var o=t._milliseconds,i=xC(t._days),a=xC(t._months);e.isValid()&&(n=n??!0,a&&WB(e,Bg(e,"Month")+a*r),i&&NB(e,"Date",Bg(e,"Date")+i*r),o&&e._d.setTime(e._d.valueOf()+o*r),n&&te.updateOffset(e,i||a))}var ioe=iV(1,"add"),aoe=iV(-1,"subtract");function lV(e){return typeof e=="string"||e instanceof String}function loe(e){return yn(e)||dv(e)||lV(e)||Ho(e)||uoe(e)||soe(e)||e===null||e===void 0}function soe(e){var t=Ma(e)&&!q0(e),r=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],o,i,a=n.length;for(o=0;o<a;o+=1)i=n[o],r=r||at(e,i);return t&&r}function uoe(e){var t=vn(e),r=!1;return t&&(r=e.filter(function(n){return!Ho(n)&&lV(e)}).length===0),t&&r}function foe(e){var t=Ma(e)&&!q0(e),r=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],o,i;for(o=0;o<n.length;o+=1)i=n[o],r=r||at(e,i);return t&&r}function coe(e,t){var r=e.diff(t,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function hoe(e,t){arguments.length===1&&(arguments[0]?loe(arguments[0])?(e=arguments[0],t=void 0):foe(arguments[0])&&(t=arguments[0],e=void 0):(e=void 0,t=void 0));var r=e||Ct(),n=cE(r,this).startOf("day"),o=te.calendarFormat(this,n)||"sameElse",i=t&&(Wn(t[o])?t[o].call(this,r):t[o]);return this.format(i||this.localeData().calendar(o,this,Ct(r)))}function doe(){return new vv(this)}function voe(e,t){var r=yn(e)?e:Ct(e);return this.isValid()&&r.isValid()?(t=Qr(t)||"millisecond",t==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(t).valueOf()):!1}function yoe(e,t){var r=yn(e)?e:Ct(e);return this.isValid()&&r.isValid()?(t=Qr(t)||"millisecond",t==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(t).valueOf()<r.valueOf()):!1}function goe(e,t,r,n){var o=yn(e)?e:Ct(e),i=yn(t)?t:Ct(t);return this.isValid()&&o.isValid()&&i.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(o,r):!this.isBefore(o,r))&&(n[1]===")"?this.isBefore(i,r):!this.isAfter(i,r))):!1}function poe(e,t){var r=yn(e)?e:Ct(e),n;return this.isValid()&&r.isValid()?(t=Qr(t)||"millisecond",t==="millisecond"?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf())):!1}function moe(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function boe(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function woe(e,t,r){var n,o,i;if(!this.isValid())return NaN;if(n=cE(e,this),!n.isValid())return NaN;switch(o=(n.utcOffset()-this.utcOffset())*6e4,t=Qr(t),t){case"year":i=ng(this,n)/12;break;case"month":i=ng(this,n);break;case"quarter":i=ng(this,n)/3;break;case"second":i=(this-n)/1e3;break;case"minute":i=(this-n)/6e4;break;case"hour":i=(this-n)/36e5;break;case"day":i=(this-n-o)/864e5;break;case"week":i=(this-n-o)/6048e5;break;default:i=this-n}return r?i:Kr(i)}function ng(e,t){if(e.date()<t.date())return-ng(t,e);var r=(t.year()-e.year())*12+(t.month()-e.month()),n=e.clone().add(r,"months"),o,i;return t-n<0?(o=e.clone().add(r-1,"months"),i=(t-n)/(n-o)):(o=e.clone().add(r+1,"months"),i=(t-n)/(o-n)),-(r+i)||0}te.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";te.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function Soe(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function Coe(e){if(!this.isValid())return null;var t=e!==!0,r=t?this.clone().utc():this;return r.year()<0||r.year()>9999?tg(r,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Wn(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",tg(r,"Z")):tg(r,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function _oe(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="",r,n,o,i;return this.isLocal()||(e=this.utcOffset()===0?"moment.utc":"moment.parseZone",t="Z"),r="["+e+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",o="-MM-DD[T]HH:mm:ss.SSS",i=t+'[")]',this.format(r+n+o+i)}function Ooe(e){e||(e=this.isUtc()?te.defaultFormatUtc:te.defaultFormat);var t=tg(this,e);return this.localeData().postformat(t)}function Roe(e,t){return this.isValid()&&(yn(e)&&e.isValid()||Ct(e).isValid())?wn({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function Eoe(e){return this.from(Ct(),e)}function Toe(e,t){return this.isValid()&&(yn(e)&&e.isValid()||Ct(e).isValid())?wn({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function koe(e){return this.to(Ct(),e)}function sV(e){var t;return e===void 0?this._locale._abbr:(t=Vo(e),t!=null&&(this._locale=t),this)}var uV=Jr("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return e===void 0?this.localeData():this.locale(e)});function fV(){return this._locale}var Ug=1e3,Zl=60*Ug,zg=60*Zl,cV=(365*400+97)*24*zg;function Jl(e,t){return(e%t+t)%t}function hV(e,t,r){return e<100&&e>=0?new Date(e+400,t,r)-cV:new Date(e,t,r).valueOf()}function dV(e,t,r){return e<100&&e>=0?Date.UTC(e+400,t,r)-cV:Date.UTC(e,t,r)}function Poe(e){var t,r;if(e=Qr(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?dV:hV,e){case"year":t=r(this.year(),0,1);break;case"quarter":t=r(this.year(),this.month()-this.month()%3,1);break;case"month":t=r(this.year(),this.month(),1);break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=r(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=Jl(t+(this._isUTC?0:this.utcOffset()*Zl),zg);break;case"minute":t=this._d.valueOf(),t-=Jl(t,Zl);break;case"second":t=this._d.valueOf(),t-=Jl(t,Ug);break}return this._d.setTime(t),te.updateOffset(this,!0),this}function $oe(e){var t,r;if(e=Qr(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?dV:hV,e){case"year":t=r(this.year()+1,0,1)-1;break;case"quarter":t=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=r(this.year(),this.month()+1,1)-1;break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=zg-Jl(t+(this._isUTC?0:this.utcOffset()*Zl),zg)-1;break;case"minute":t=this._d.valueOf(),t+=Zl-Jl(t,Zl)-1;break;case"second":t=this._d.valueOf(),t+=Ug-Jl(t,Ug)-1;break}return this._d.setTime(t),te.updateOffset(this,!0),this}function Aoe(){return this._d.valueOf()-(this._offset||0)*6e4}function Ioe(){return Math.floor(this.valueOf()/1e3)}function Moe(){return new Date(this.valueOf())}function xoe(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function Doe(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function Noe(){return this.isValid()?this.toISOString():null}function Hoe(){return X0(this)}function Loe(){return si({},ze(this))}function joe(){return ze(this).overflow}function Foe(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}ke("N",0,0,"eraAbbr");ke("NN",0,0,"eraAbbr");ke("NNN",0,0,"eraAbbr");ke("NNNN",0,0,"eraName");ke("NNNNN",0,0,"eraNarrow");ke("y",["y",1],"yo","eraYear");ke("y",["yy",2],0,"eraYear");ke("y",["yyy",3],0,"eraYear");ke("y",["yyyy",4],0,"eraYear");we("N",hE);we("NN",hE);we("NNN",hE);we("NNNN",Zoe);we("NNNNN",Joe);mt(["N","NN","NNN","NNNN","NNNNN"],function(e,t,r,n){var o=r._locale.erasParse(e,n,r._strict);o?ze(r).era=o:ze(r).invalidEra=e});we("y",Tf);we("yy",Tf);we("yyy",Tf);we("yyyy",Tf);we("yo",Qoe);mt(["y","yy","yyy","yyyy"],ir);mt(["yo"],function(e,t,r,n){var o;r._locale._eraYearOrdinalRegex&&(o=e.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?t[ir]=r._locale.eraYearOrdinalParse(e,o):t[ir]=parseInt(e,10)});function Boe(e,t){var r,n,o,i=this._eras||Vo("en")._eras;for(r=0,n=i.length;r<n;++r){switch(typeof i[r].since){case"string":o=te(i[r].since).startOf("day"),i[r].since=o.valueOf();break}switch(typeof i[r].until){case"undefined":i[r].until=1/0;break;case"string":o=te(i[r].until).startOf("day").valueOf(),i[r].until=o.valueOf();break}}return i}function Voe(e,t,r){var n,o,i=this.eras(),a,l,s;for(e=e.toUpperCase(),n=0,o=i.length;n<o;++n)if(a=i[n].name.toUpperCase(),l=i[n].abbr.toUpperCase(),s=i[n].narrow.toUpperCase(),r)switch(t){case"N":case"NN":case"NNN":if(l===e)return i[n];break;case"NNNN":if(a===e)return i[n];break;case"NNNNN":if(s===e)return i[n];break}else if([a,l,s].indexOf(e)>=0)return i[n]}function Woe(e,t){var r=e.since<=e.until?1:-1;return t===void 0?te(e.since).year():te(e.since).year()+(t-e.offset)*r}function Uoe(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].name;return""}function zoe(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].narrow;return""}function Yoe(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].abbr;return""}function Goe(){var e,t,r,n,o=this.localeData().eras();for(e=0,t=o.length;e<t;++e)if(r=o[e].since<=o[e].until?1:-1,n=this.clone().startOf("day").valueOf(),o[e].since<=n&&n<=o[e].until||o[e].until<=n&&n<=o[e].since)return(this.year()-te(o[e].since).year())*r+o[e].offset;return this.year()}function Koe(e){return at(this,"_erasNameRegex")||dE.call(this),e?this._erasNameRegex:this._erasRegex}function qoe(e){return at(this,"_erasAbbrRegex")||dE.call(this),e?this._erasAbbrRegex:this._erasRegex}function Xoe(e){return at(this,"_erasNarrowRegex")||dE.call(this),e?this._erasNarrowRegex:this._erasRegex}function hE(e,t){return t.erasAbbrRegex(e)}function Zoe(e,t){return t.erasNameRegex(e)}function Joe(e,t){return t.erasNarrowRegex(e)}function Qoe(e,t){return t._eraYearOrdinalRegex||Tf}function dE(){var e=[],t=[],r=[],n=[],o,i,a=this.eras();for(o=0,i=a.length;o<i;++o)t.push(Hr(a[o].name)),e.push(Hr(a[o].abbr)),r.push(Hr(a[o].narrow)),n.push(Hr(a[o].name)),n.push(Hr(a[o].abbr)),n.push(Hr(a[o].narrow));this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+t.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+e.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}ke(0,["gg",2],0,function(){return this.weekYear()%100});ke(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Im(e,t){ke(0,[e,e.length],0,t)}Im("gggg","weekYear");Im("ggggg","weekYear");Im("GGGG","isoWeekYear");Im("GGGGG","isoWeekYear");sr("weekYear","gg");sr("isoWeekYear","GG");ur("weekYear",1);ur("isoWeekYear",1);we("G",Tm);we("g",Tm);we("GG",_t,Vr);we("gg",_t,Vr);we("GGGG",rE,tE);we("gggg",rE,tE);we("GGGGG",Em,Om);we("ggggg",Em,Om);gv(["gggg","ggggg","GGGG","GGGGG"],function(e,t,r,n){t[n.substr(0,2)]=Ze(e)});gv(["gg","GG"],function(e,t,r,n){t[n]=te.parseTwoDigitYear(e)});function eie(e){return vV.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function tie(e){return vV.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function rie(){return Mo(this.year(),1,4)}function nie(){return Mo(this.isoWeekYear(),1,4)}function oie(){var e=this.localeData()._week;return Mo(this.year(),e.dow,e.doy)}function iie(){var e=this.localeData()._week;return Mo(this.weekYear(),e.dow,e.doy)}function vV(e,t,r,n,o){var i;return e==null?Bc(this,n,o).year:(i=Mo(e,n,o),t>i&&(t=i),aie.call(this,e,t,r,n,o))}function aie(e,t,r,n,o){var i=GB(e,t,r,n,o),a=Fc(i.year,0,i.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}ke("Q",0,"Qo","quarter");sr("quarter","Q");ur("quarter",7);we("Q",HB);mt("Q",function(e,t){t[io]=(Ze(e)-1)*3});function lie(e){return e==null?Math.ceil((this.month()+1)/3):this.month((e-1)*3+this.month()%3)}ke("D",["DD",2],"Do","date");sr("date","D");ur("date",9);we("D",_t);we("DD",_t,Vr);we("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient});mt(["D","DD"],Dn);mt("Do",function(e,t){t[Dn]=Ze(e.match(_t)[0])});var yV=Ef("Date",!0);ke("DDD",["DDDD",3],"DDDo","dayOfYear");sr("dayOfYear","DDD");ur("dayOfYear",4);we("DDD",Rm);we("DDDD",LB);mt(["DDD","DDDD"],function(e,t,r){r._dayOfYear=Ze(e)});function sie(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return e==null?t:this.add(e-t,"d")}ke("m",["mm",2],0,"minute");sr("minute","m");ur("minute",14);we("m",_t);we("mm",_t,Vr);mt(["m","mm"],hn);var uie=Ef("Minutes",!1);ke("s",["ss",2],0,"second");sr("second","s");ur("second",15);we("s",_t);we("ss",_t,Vr);mt(["s","ss"],ao);var fie=Ef("Seconds",!1);ke("S",0,0,function(){return~~(this.millisecond()/100)});ke(0,["SS",2],0,function(){return~~(this.millisecond()/10)});ke(0,["SSS",3],0,"millisecond");ke(0,["SSSS",4],0,function(){return this.millisecond()*10});ke(0,["SSSSS",5],0,function(){return this.millisecond()*100});ke(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});ke(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});ke(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});ke(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});sr("millisecond","ms");ur("millisecond",16);we("S",Rm,HB);we("SS",Rm,Vr);we("SSS",Rm,LB);var ui,gV;for(ui="SSSS";ui.length<=9;ui+="S")we(ui,Tf);function cie(e,t){t[na]=Ze(("0."+e)*1e3)}for(ui="S";ui.length<=9;ui+="S")mt(ui,cie);gV=Ef("Milliseconds",!1);ke("z",0,0,"zoneAbbr");ke("zz",0,0,"zoneName");function hie(){return this._isUTC?"UTC":""}function die(){return this._isUTC?"Coordinated Universal Time":""}var ne=vv.prototype;ne.add=ioe;ne.calendar=hoe;ne.clone=doe;ne.diff=woe;ne.endOf=$oe;ne.format=Ooe;ne.from=Roe;ne.fromNow=Eoe;ne.to=Toe;ne.toNow=koe;ne.get=yre;ne.invalidAt=joe;ne.isAfter=voe;ne.isBefore=yoe;ne.isBetween=goe;ne.isSame=poe;ne.isSameOrAfter=moe;ne.isSameOrBefore=boe;ne.isValid=Hoe;ne.lang=uV;ne.locale=sV;ne.localeData=fV;ne.max=Hne;ne.min=Nne;ne.parsingFlags=Loe;ne.set=gre;ne.startOf=Poe;ne.subtract=aoe;ne.toArray=xoe;ne.toObject=Doe;ne.toDate=Moe;ne.toISOString=Coe;ne.inspect=_oe;typeof Symbol<"u"&&Symbol.for!=null&&(ne[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});ne.toJSON=Noe;ne.toString=Soe;ne.unix=Ioe;ne.valueOf=Aoe;ne.creationData=Foe;ne.eraName=Uoe;ne.eraNarrow=zoe;ne.eraAbbr=Yoe;ne.eraYear=Goe;ne.year=YB;ne.isLeapYear=Dre;ne.weekYear=eie;ne.isoWeekYear=tie;ne.quarter=ne.quarters=lie;ne.month=UB;ne.daysInMonth=Ire;ne.week=ne.weeks=Bre;ne.isoWeek=ne.isoWeeks=Vre;ne.weeksInYear=oie;ne.weeksInWeekYear=iie;ne.isoWeeksInYear=rie;ne.isoWeeksInISOWeekYear=nie;ne.date=yV;ne.day=ne.days=tne;ne.weekday=rne;ne.isoWeekday=nne;ne.dayOfYear=sie;ne.hour=ne.hours=fne;ne.minute=ne.minutes=uie;ne.second=ne.seconds=fie;ne.millisecond=ne.milliseconds=gV;ne.utcOffset=Yne;ne.utc=Kne;ne.local=qne;ne.parseZone=Xne;ne.hasAlignedHourOffset=Zne;ne.isDST=Jne;ne.isLocal=eoe;ne.isUtcOffset=toe;ne.isUtc=oV;ne.isUTC=oV;ne.zoneAbbr=hie;ne.zoneName=die;ne.dates=Jr("dates accessor is deprecated. Use date instead.",yV);ne.months=Jr("months accessor is deprecated. Use month instead",UB);ne.years=Jr("years accessor is deprecated. Use year instead",YB);ne.zone=Jr("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",Gne);ne.isDSTShifted=Jr("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",Qne);function vie(e){return Ct(e*1e3)}function yie(){return Ct.apply(null,arguments).parseZone()}function pV(e){return e}var lt=J0.prototype;lt.calendar=tre;lt.longDateFormat=ire;lt.invalidDate=lre;lt.ordinal=fre;lt.preparse=pV;lt.postformat=pV;lt.relativeTime=hre;lt.pastFuture=dre;lt.set=Qte;lt.eras=Boe;lt.erasParse=Voe;lt.erasConvertYear=Woe;lt.erasAbbrRegex=qoe;lt.erasNameRegex=Koe;lt.erasNarrowRegex=Xoe;lt.months=kre;lt.monthsShort=Pre;lt.monthsParse=Are;lt.monthsRegex=xre;lt.monthsShortRegex=Mre;lt.week=Hre;lt.firstDayOfYear=Fre;lt.firstDayOfWeek=jre;lt.weekdays=Xre;lt.weekdaysMin=Jre;lt.weekdaysShort=Zre;lt.weekdaysParse=ene;lt.weekdaysRegex=one;lt.weekdaysShortRegex=ine;lt.weekdaysMinRegex=ane;lt.isPM=sne;lt.meridiem=cne;function Yg(e,t,r,n){var o=Vo(),i=Vn().set(n,t);return o[r](i,e)}function mV(e,t,r){if(Ho(e)&&(t=e,e=void 0),e=e||"",t!=null)return Yg(e,t,r,"month");var n,o=[];for(n=0;n<12;n++)o[n]=Yg(e,n,r,"month");return o}function vE(e,t,r,n){typeof e=="boolean"?(Ho(t)&&(r=t,t=void 0),t=t||""):(t=e,r=t,e=!1,Ho(t)&&(r=t,t=void 0),t=t||"");var o=Vo(),i=e?o._week.dow:0,a,l=[];if(r!=null)return Yg(t,(r+i)%7,n,"day");for(a=0;a<7;a++)l[a]=Yg(t,(a+i)%7,n,"day");return l}function gie(e,t){return mV(e,t,"months")}function pie(e,t){return mV(e,t,"monthsShort")}function mie(e,t,r){return vE(e,t,r,"weekdays")}function bie(e,t,r){return vE(e,t,r,"weekdaysShort")}function wie(e,t,r){return vE(e,t,r,"weekdaysMin")}hi("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,r=Ze(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return e+r}});te.lang=Jr("moment.lang is deprecated. Use moment.locale instead.",hi);te.langData=Jr("moment.langData is deprecated. Use moment.localeData instead.",Vo);var Yn=Math.abs;function Sie(){var e=this._data;return this._milliseconds=Yn(this._milliseconds),this._days=Yn(this._days),this._months=Yn(this._months),e.milliseconds=Yn(e.milliseconds),e.seconds=Yn(e.seconds),e.minutes=Yn(e.minutes),e.hours=Yn(e.hours),e.months=Yn(e.months),e.years=Yn(e.years),this}function bV(e,t,r,n){var o=wn(t,r);return e._milliseconds+=n*o._milliseconds,e._days+=n*o._days,e._months+=n*o._months,e._bubble()}function Cie(e,t){return bV(this,e,t,1)}function _ie(e,t){return bV(this,e,t,-1)}function q1(e){return e<0?Math.floor(e):Math.ceil(e)}function Oie(){var e=this._milliseconds,t=this._days,r=this._months,n=this._data,o,i,a,l,s;return e>=0&&t>=0&&r>=0||e<=0&&t<=0&&r<=0||(e+=q1(NC(r)+t)*864e5,t=0,r=0),n.milliseconds=e%1e3,o=Kr(e/1e3),n.seconds=o%60,i=Kr(o/60),n.minutes=i%60,a=Kr(i/60),n.hours=a%24,t+=Kr(a/24),s=Kr(wV(t)),r+=s,t-=q1(NC(s)),l=Kr(r/12),r%=12,n.days=t,n.months=r,n.years=l,this}function wV(e){return e*4800/146097}function NC(e){return e*146097/4800}function Rie(e){if(!this.isValid())return NaN;var t,r,n=this._milliseconds;if(e=Qr(e),e==="month"||e==="quarter"||e==="year")switch(t=this._days+n/864e5,r=this._months+wV(t),e){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(t=this._days+Math.round(NC(this._months)),e){case"week":return t/7+n/6048e5;case"day":return t+n/864e5;case"hour":return t*24+n/36e5;case"minute":return t*1440+n/6e4;case"second":return t*86400+n/1e3;case"millisecond":return Math.floor(t*864e5)+n;default:throw new Error("Unknown unit "+e)}}function Eie(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+Ze(this._months/12)*31536e6:NaN}function Wo(e){return function(){return this.as(e)}}var Tie=Wo("ms"),kie=Wo("s"),Pie=Wo("m"),$ie=Wo("h"),Aie=Wo("d"),Iie=Wo("w"),Mie=Wo("M"),xie=Wo("Q"),Die=Wo("y");function Nie(){return wn(this)}function Hie(e){return e=Qr(e),this.isValid()?this[e+"s"]():NaN}function nl(e){return function(){return this.isValid()?this._data[e]:NaN}}var Lie=nl("milliseconds"),jie=nl("seconds"),Fie=nl("minutes"),Bie=nl("hours"),Vie=nl("days"),Wie=nl("months"),Uie=nl("years");function zie(){return Kr(this.days()/7)}var to=Math.round,Yl={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function Yie(e,t,r,n,o){return o.relativeTime(t||1,!!r,e,n)}function Gie(e,t,r,n){var o=wn(e).abs(),i=to(o.as("s")),a=to(o.as("m")),l=to(o.as("h")),s=to(o.as("d")),u=to(o.as("M")),f=to(o.as("w")),c=to(o.as("y")),h=i<=r.ss&&["s",i]||i<r.s&&["ss",i]||a<=1&&["m"]||a<r.m&&["mm",a]||l<=1&&["h"]||l<r.h&&["hh",l]||s<=1&&["d"]||s<r.d&&["dd",s];return r.w!=null&&(h=h||f<=1&&["w"]||f<r.w&&["ww",f]),h=h||u<=1&&["M"]||u<r.M&&["MM",u]||c<=1&&["y"]||["yy",c],h[2]=t,h[3]=+e>0,h[4]=n,Yie.apply(null,h)}function Kie(e){return e===void 0?to:typeof e=="function"?(to=e,!0):!1}function qie(e,t){return Yl[e]===void 0?!1:t===void 0?Yl[e]:(Yl[e]=t,e==="s"&&(Yl.ss=t-1),!0)}function Xie(e,t){if(!this.isValid())return this.localeData().invalidDate();var r=!1,n=Yl,o,i;return typeof e=="object"&&(t=e,e=!1),typeof e=="boolean"&&(r=e),typeof t=="object"&&(n=Object.assign({},Yl,t),t.s!=null&&t.ss==null&&(n.ss=t.s-1)),o=this.localeData(),i=Gie(this,!r,n,o),r&&(i=o.pastFuture(+this,i)),o.postformat(i)}var yw=Math.abs;function vl(e){return(e>0)-(e<0)||+e}function Mm(){if(!this.isValid())return this.localeData().invalidDate();var e=yw(this._milliseconds)/1e3,t=yw(this._days),r=yw(this._months),n,o,i,a,l=this.asSeconds(),s,u,f,c;return l?(n=Kr(e/60),o=Kr(n/60),e%=60,n%=60,i=Kr(r/12),r%=12,a=e?e.toFixed(3).replace(/\.?0+$/,""):"",s=l<0?"-":"",u=vl(this._months)!==vl(l)?"-":"",f=vl(this._days)!==vl(l)?"-":"",c=vl(this._milliseconds)!==vl(l)?"-":"",s+"P"+(i?u+i+"Y":"")+(r?u+r+"M":"")+(t?f+t+"D":"")+(o||n||e?"T":"")+(o?c+o+"H":"")+(n?c+n+"M":"")+(e?c+a+"S":"")):"P0D"}var tt=Am.prototype;tt.isValid=Vne;tt.abs=Sie;tt.add=Cie;tt.subtract=_ie;tt.as=Rie;tt.asMilliseconds=Tie;tt.asSeconds=kie;tt.asMinutes=Pie;tt.asHours=$ie;tt.asDays=Aie;tt.asWeeks=Iie;tt.asMonths=Mie;tt.asQuarters=xie;tt.asYears=Die;tt.valueOf=Eie;tt._bubble=Oie;tt.clone=Nie;tt.get=Hie;tt.milliseconds=Lie;tt.seconds=jie;tt.minutes=Fie;tt.hours=Bie;tt.days=Vie;tt.weeks=zie;tt.months=Wie;tt.years=Uie;tt.humanize=Xie;tt.toISOString=Mm;tt.toString=Mm;tt.toJSON=Mm;tt.locale=sV;tt.localeData=fV;tt.toIsoString=Jr("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Mm);tt.lang=uV;ke("X",0,0,"unix");ke("x",0,0,"valueOf");we("x",Tm);we("X",mre);mt("X",function(e,t,r){r._d=new Date(parseFloat(e)*1e3)});mt("x",function(e,t,r){r._d=new Date(Ze(e))});//! moment.js
te.version="2.29.4";Zte(Ct);te.fn=ne;te.min=Lne;te.max=jne;te.now=Fne;te.utc=Vn;te.unix=vie;te.months=gie;te.isDate=dv;te.locale=hi;te.invalid=Cm;te.duration=wn;te.isMoment=yn;te.weekdays=mie;te.parseZone=yie;te.localeData=Vo;te.isDuration=rg;te.monthsShort=pie;te.weekdaysMin=wie;te.defineLocale=aE;te.updateLocale=yne;te.locales=gne;te.weekdaysShort=bie;te.normalizeUnits=Qr;te.relativeTimeRounding=Kie;te.relativeTimeThreshold=qie;te.calendarFormat=coe;te.prototype=ne;te.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const Zie=Object.freeze(Object.defineProperty({__proto__:null,default:te},Symbol.toStringTag,{value:"Module"}));function ft(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o=Lt(e,function(i,a,l){var s=a.replace(/\r?\n\s*/g,""),u=r[l]?r[l]:"";return i+s+u},"");return o.trim()}var X1,Z1,J1,Q1,eA,tA;function Ql(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function HC(e){"@babel/helpers - typeof";return HC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},HC(e)}function It(e){var t;switch(HC(e)){case"string":case"number":t="".concat(e);break;case"object":t=e===null?"":e.toString();break;case"undefined":t="";break;default:t=e.toString();break}return t}function ve(e){return typeof e<"u"}function gt(e){return typeof e>"u"}function Kt(e){return e===null||e===""||gt(e)}function SV(e){return Object.prototype.toString.call(e)==="[object RegExp]"}var vc="length",_c=function(t){return parseInt(t,16)},rA=function(t){return parseInt(t,10)},Gg=function(t,r,n){return t.substr(r,n)},Oc=function(t){return t.codePointAt(0)-65},LC=function(t){return"".concat(t).replace(/\-/g,"")},Jie=function(t){return _c(Gg(LC(t),_c("12"),Oc("F")))/(_c(Gg(LC(t),Oc("B"),~~![][vc]))||9)},Qie=function(){return typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)},nA=!1,oA={invalid:function(){return ft(X1||(X1=Ql([`
    The license key for Handsontable is invalid. 
    If you need any help, contact us at support@handsontable.com.`],[`
    The license key for Handsontable is invalid.\\x20
    If you need any help, contact us at support@handsontable.com.`])))},expired:function(t){var r=t.keyValidityDate,n=t.hotVersion;return ft(Z1||(Z1=Ql([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior 
    to `,". If you need any help, contact us at sales@handsontable.com."],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior\\x20
    to `,". If you need any help, contact us at sales@handsontable.com."])),r,n,r)},missing:function(){return ft(J1||(J1=Ql([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact 
    us at support@handsontable.com.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\\x20
    us at support@handsontable.com.`])))},non_commercial:function(){return""}},iA={invalid:function(){return ft(Q1||(Q1=Ql([`
    The license key for Handsontable is invalid. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to 
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is invalid.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},expired:function(t){var r=t.keyValidityDate,n=t.hotVersion;return ft(eA||(eA=Ql([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your 
    license key or downgrade to a version released prior to `,`. If you need any 
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\\x20
    license key or downgrade to a version released prior to `,`. If you need any\\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`])),r,n,r)},missing:function(){return ft(tA||(tA=Ql([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in 
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},non_commercial:function(){return""}};function CV(e,t){var r=!Kt(e),n=typeof e=="string"&&e.toLowerCase()==="non-commercial-and-evaluation",o="12.4.0",i,a="invalid",l="invalid";e=LC(e||"");var s=eae(e);if(r||n||s)if(s){var u=te("23/05/2023","DD/MM/YYYY"),f=Math.floor(u.toDate().getTime()/864e5),c=Jie(e);i=te((c+1)*864e5,"x").format("MMMM DD, YYYY"),f>c?(a="expired",l="expired"):(a="valid",l="valid")}else n?(a="non_commercial",l="valid"):(a="invalid",l="invalid");else a="missing",l="missing";if(Qie()&&(a="valid",l="valid"),!nA&&a!=="valid"){var h=oA[a]({keyValidityDate:i,hotVersion:o});h&&console[a==="non_commercial"?"info":"warn"](oA[a]({keyValidityDate:i,hotVersion:o})),nA=!0}if(l!=="valid"&&t.parentNode){var d=iA[l]({keyValidityDate:i,hotVersion:o});if(d){var v=document.createElement("div");v.className="hot-display-license-info",v.innerHTML=iA[l]({keyValidityDate:i,hotVersion:o}),t.parentNode.insertBefore(v,t.nextSibling)}}}function eae(e){var t=[][vc],r=t;if(e[vc]!==Oc("Z"))return!1;for(var n="",o="B<H4P+".split(""),i=Oc(o.shift());i;i=Oc(o.shift()||"A"))--i<""[vc]?r=r|(rA("".concat(rA(_c(n)+(_c(Gg(e,Math.abs(i),2))+[]).padStart(2,"0"))))%97||2)>>1:n=Gg(e,i,i?o[vc]===1?9:8:6);return r===t}const tae=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:CV,isDefined:ve,isEmpty:Kt,isRegExp:SV,isUndefined:gt,stringify:It},Symbol.toStringTag,{value:"Module"}));function ar(e){return e[0].toUpperCase()+e.substr(1)}function rae(){for(var e=[],t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];for(var o=r.length;o;){o-=1;var i=It(r[o]).toLowerCase();e.indexOf(i)===-1&&e.push(i)}return e.length===1}function yE(){function e(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return e()+e()+e()+e()}function gE(e){return/^([0-9][0-9]?%$)|(^100%$)/.test(e)}function pE(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return"".concat(e).replace(/(?:\\)?\[([^[\]]+)]/g,function(r,n){return r.charAt(0)==="\\"?r.substr(1,r.length-1):t[n]===void 0?"":t[n]})}function jC(e){return xm("".concat(e),{ALLOWED_TAGS:[]})}function xm(e,t){return Ite.sanitize(e,t)}const nae=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:rae,isPercentValue:gE,randomString:yE,sanitize:xm,stripTags:jC,substitute:pE,toUpperCaseFirst:ar},Symbol.toStringTag,{value:"Module"}));function aA(e){return lae(e)||aae(e)||iae(e)||oae()}function oae(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iae(e,t){if(e){if(typeof e=="string")return FC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return FC(e,t)}}function aae(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function lae(e){if(Array.isArray(e))return FC(e)}function FC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _V(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=null,o=e;o!==null;){if(r===t){n=o;break}o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:(r+=1,o=o.parentNode)}return n}function OV(e){return Object.getPrototypeOf(e.parent)&&e.frameElement}function Wc(e){return OV(e)&&e.parent}function sae(e){return!!Object.getPrototypeOf(e.parent)}function di(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,n=Node,o=n.ELEMENT_NODE,i=n.DOCUMENT_FRAGMENT_NODE,a=e;a!=null&&a!==r;){var l=a,s=l.nodeType,u=l.nodeName;if(s===o&&(t.includes(u)||t.includes(a)))return a;var f=a,c=f.host;c&&s===i?a=c:a=a.parentNode}return null}function yc(e,t,r){for(var n=[],o=e;o&&(o=di(o,t,r),!(!o||r&&!r.contains(o)));)n.push(o),o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:o=o.parentNode;var i=n.length;return i?n[i-1]:null}function vi(e,t){var r=e.parentNode,n=[];for(typeof t=="string"?e.defaultView?n=Array.prototype.slice.call(e.querySelectorAll(t),0):n=Array.prototype.slice.call(e.ownerDocument.querySelectorAll(t),0):n.push(t);r!==null;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function RV(e){var t=0,r=e;if(r.previousSibling)for(;r=r.previousSibling;)t+=1;return t}function ni(e,t,r){var n=r.parentElement.querySelector(".ht_clone_".concat(e));return n?n.contains(t):null}var BC,VC,WC;function ey(e){return!e||!e.length?[]:e.filter(function(t){return!!t})}if(sB()){var lA=function(t){var r=t.createElement("div");return r.classList.add("test","test2"),r.classList.contains("test2")};BC=function(t,r){return t.classList===void 0||typeof r!="string"||r===""?!1:t.classList.contains(r)},VC=function(t,r){var n=t.ownerDocument,o=r;if(typeof o=="string"&&(o=o.split(" ")),o=ey(o),o.length>0)if(lA(n)){var i;(i=t.classList).add.apply(i,aA(o))}else for(var a=0;o[a];)t.classList.add(o[a]),a+=1},WC=function(t,r){var n=t.ownerDocument,o=r;if(typeof o=="string"&&(o=o.split(" ")),o=ey(o),o.length>0)if(lA(n)){var i;(i=t.classList).remove.apply(i,aA(o))}else for(var a=0;o[a];)t.classList.remove(o[a]),a+=1}}else{var gw=function(t){return new RegExp("(\\s|^)".concat(t,"(\\s|$)"))};BC=function(t,r){return t.className!==void 0&&gw(r).test(t.className)},VC=function(t,r){var n=t.className,o=r;if(typeof o=="string"&&(o=o.split(" ")),o=ey(o),n==="")n=o.join(" ");else for(var i=0;i<o.length;i++)o[i]&&!gw(o[i]).test(n)&&(n+=" ".concat(o[i]));t.className=n},WC=function(t,r){var n=0,o=t.className,i=r;for(typeof i=="string"&&(i=i.split(" ")),i=ey(i);i[n];)o=o.replace(gw(i[n])," ").trim(),n+=1;t.className!==o&&(t.className=o)}}function xe(e,t){return BC(e,t)}function re(e,t){VC(e,t)}function Le(e,t){WC(e,t)}function mE(e){if(e.nodeType===3)e.parentNode.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1)for(var t=e.childNodes,r=t.length-1;r>=0;r--)mE(t[r])}function gn(e){for(var t;t=e.lastChild;)e.removeChild(t)}var EV=/(<(.*)>|&(.*);)/;function ol(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;EV.test(t)?e.innerHTML=r?xm(t):t:Ei(e,t)}function Ei(e,t){var r=e.firstChild;r&&r.nodeType===3&&r.nextSibling===null?uB?r.textContent=t:r.data=t:(gn(e),e.appendChild(e.ownerDocument.createTextNode(t)))}function vs(e){for(var t=e.ownerDocument.documentElement,r=e;r!==t;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return vs(r.host.impl);if(r.host)return vs(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(r.style&&r.style.display==="none")return!1;r=r.parentNode}return!0}function Vt(e){var t=e.ownerDocument,r=t.defaultView,n=t.documentElement,o=e,i,a,l,s;if(W0()&&o.firstChild&&o.firstChild.nodeName==="CAPTION")return s=o.getBoundingClientRect(),{top:s.top+(r.pageYOffset||n.scrollTop)-(n.clientTop||0),left:s.left+(r.pageXOffset||n.scrollLeft)-(n.clientLeft||0)};for(i=o.offsetLeft,a=o.offsetTop,l=o;(o=o.offsetParent)&&o!==t.body;)i+=o.offsetLeft,a+=o.offsetTop,l=o;return l&&l.style.position==="fixed"&&(i+=r.pageXOffset||n.scrollLeft,a+=r.pageYOffset||n.scrollTop),{left:i,top:a}}function ys(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.scrollY;return t===void 0&&(t=e.document.documentElement.scrollTop),t}function Na(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.scrollX;return t===void 0&&(t=e.document.documentElement.scrollLeft),t}function Uc(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e===t?ys(t):e.scrollTop}function Kg(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e===t?Na(t):e.scrollLeft}function zc(e){var t=e.ownerDocument,r=t?t.defaultView:void 0;t||(t=e.document?e.document:e,r=t.defaultView);for(var n=["auto","scroll"],o=fB(),i=e.parentNode;i&&i.style&&t.body!==i;){var a=i.style,l=a.overflow,s=a.overflowX,u=a.overflowY;if([l,s,u].includes("scroll"))return i;if(o){var f=r.getComputedStyle(i);if(l=f.overflow,s=f.overflowX,u=f.overflowY,n.includes(l)||n.includes(s)||n.includes(u))return i}if(i.clientHeight<=i.scrollHeight+1&&(n.includes(u)||n.includes(l))||i.clientWidth<=i.scrollWidth+1&&(n.includes(s)||n.includes(l)))return i;i=i.parentNode}return r}function Ha(e){for(var t=e.ownerDocument,r=t.defaultView,n=e.parentNode;n&&n.style&&t.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;var o=Ti(n,r),i=["scroll","hidden","auto"],a=o.getPropertyValue("overflow"),l=o.getPropertyValue("overflow-y"),s=o.getPropertyValue("overflow-x");if(i.includes(a)||i.includes(l)||i.includes(s))return n;n=n.parentNode}return r}function gs(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(e){if(e===r)return t==="width"?"".concat(r.innerWidth,"px"):t==="height"?"".concat(r.innerHeight,"px"):void 0}else return;var n=e.style[t];if(n!==""&&n!==void 0)return n;var o=Ti(e,r);if(o[t]!==""&&o[t]!==void 0)return o[t]}function uae(e,t){var r=t.selectorText,n=!1;return t.type===CSSRule.STYLE_RULE&&r&&(e.msMatchesSelector?n=e.msMatchesSelector(r):e.matches&&(n=e.matches(r))),n}function Ti(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e.currentStyle||t.getComputedStyle(e)}function dt(e){return e.offsetWidth}function Rt(e){return W0()&&e.firstChild&&e.firstChild.nodeName==="CAPTION"?e.offsetHeight+e.firstChild.offsetHeight:e.offsetHeight}function lo(e){return e.clientHeight||e.innerHeight}function Rc(e){return e.clientWidth||e.innerWidth}function fae(e,t,r){e.addEventListener(t,r,!1)}function cae(e,t,r){e.removeEventListener(t,r,!1)}function bE(e){var t=e.ownerDocument;if(e.selectionStart)return e.selectionStart;if(t.selection){e.focus();var r=t.selection.createRange();if(r===null)return 0;var n=e.createTextRange(),o=n.duplicate();return n.moveToBookmark(r.getBookmark()),o.setEndPoint("EndToStart",n),o.text.length}return 0}function TV(e){var t=e.ownerDocument;if(e.selectionEnd)return e.selectionEnd;if(t.selection){var r=t.selection.createRange();if(r===null)return 0;var n=e.createTextRange();return n.text.indexOf(r.text)+r.text.length}return 0}function kV(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.document,r="";return e.getSelection?r=e.getSelection().toString():t.selection&&t.selection.type!=="Control"&&(r=t.selection.createRange().text),r}function UC(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.document;e.getSelection?e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges():t.selection&&t.selection.empty()}function pv(e,t,r){if(r===void 0&&(r=t),e.setSelectionRange){e.focus();try{e.setSelectionRange(t,r)}catch{var n=e.parentNode,o=n.style.display;n.style.display="block",e.setSelectionRange(t,r),n.style.display=o}}}var pw;function hae(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,t=e.createElement("div");t.style.height="200px",t.style.width="100%";var r=e.createElement("div");r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(t),(e.body||e.documentElement).appendChild(r);var n=t.offsetWidth;r.style.overflow="scroll";var o=t.offsetWidth;return n===o&&(o=r.clientWidth),(e.body||e.documentElement).removeChild(r),n-o}function Xt(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return pw===void 0&&(pw=hae(e)),pw}function PV(e){return e.offsetWidth!==e.clientWidth}function $V(e){return e.offsetHeight!==e.clientHeight}function Dm(e,t,r){EB()?(e.style.top=r,e.style.left=t):_B()?e.style["-webkit-transform"]="translate3d(".concat(t,",").concat(r,",0)"):e.style.transform="translate3d(".concat(t,",").concat(r,",0)")}function dae(e){var t;return e.style.transform&&(t=e.style.transform)!==""?["transform",t]:e.style["-webkit-transform"]&&(t=e.style["-webkit-transform"])!==""?["-webkit-transform",t]:-1}function mv(e){e.style.transform&&e.style.transform!==""?e.style.transform="":e.style["-webkit-transform"]&&e.style["-webkit-transform"]!==""&&(e.style["-webkit-transform"]="")}function Yc(e){var t=["INPUT","SELECT","TEXTAREA"];return e&&(t.indexOf(e.nodeName)>-1||e.contentEditable==="true")}function Nm(e){return Yc(e)&&e.hasAttribute("data-hot-input")===!1}function AV(e){var t=e.ownerDocument.activeElement;Nm(t)||e.select()}function wE(e){return!e.parentNode}function IV(e,t){var r=new IntersectionObserver(function(n,o){n.forEach(function(i){i.isIntersecting&&e.offsetParent!==null&&(t(),o.unobserve(e))})},{root:e.ownerDocument.body});r.observe(e)}const vae=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:EV,addClass:re,addEvent:fae,clearTextSelection:UC,closest:di,closestDown:yc,empty:gn,fastInnerHTML:ol,fastInnerText:Ei,getCaretPosition:bE,getComputedStyle:Ti,getCssTransform:dae,getFrameElement:OV,getParent:_V,getParentWindow:Wc,getScrollLeft:Kg,getScrollTop:Uc,getScrollableElement:zc,getScrollbarWidth:Xt,getSelectionEndPosition:TV,getSelectionText:kV,getStyle:gs,getTrimmingContainer:Ha,getWindowScrollLeft:Na,getWindowScrollTop:ys,hasAccessToParentWindow:sae,hasClass:xe,hasHorizontalScrollbar:$V,hasVerticalScrollbar:PV,index:RV,innerHeight:lo,innerWidth:Rc,isChildOf:vi,isDetached:wE,isInput:Yc,isOutsideInput:Nm,isVisible:vs,matchesCSSRules:uae,observeVisibilityChangeOnce:IV,offset:Vt,outerHeight:Rt,outerWidth:dt,overlayContainsElement:ni,removeClass:Le,removeEvent:cae,removeTextNodes:mE,resetCssTransform:mv,selectElementIfAllowed:AV,setCaretPosition:pv,setOverlayPosition:Dm},Symbol.toStringTag,{value:"Module"}));function bt(e){return typeof e=="function"}function MV(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=0,n={lastCallThrottled:!0},o=null;function i(){for(var a=this,l=arguments.length,s=new Array(l),u=0;u<l;u++)s[u]=arguments[u];var f=Date.now(),c=!1;n.lastCallThrottled=!0,r||(r=f,c=!0);var h=t-(f-r);return c?(n.lastCallThrottled=!1,e.apply(this,s)):(o&&clearTimeout(o),o=setTimeout(function(){n.lastCallThrottled=!1,e.apply(a,s),r=0,o=void 0},h)),n}return i}function yae(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,n=MV(e,t),o=r;function i(){o=r}function a(){for(var l=arguments.length,s=new Array(l),u=0;u<l;u++)s[u]=arguments[u];return o?(o-=1,e.apply(this,s)):n.apply(this,s)}return a.clearHits=i,a}function SE(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=null,n;function o(){for(var i=this,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return r&&clearTimeout(r),r=setTimeout(function(){n=e.apply(i,l)},t),n}return o}function gae(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t[0],o=t.slice(1);return function(){for(var a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return Lt(o,function(u,f){return f(u)},n.apply(this,l))}}function CE(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return function(){for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];return e.apply(this,r.concat(a))}}function xV(e){var t=e.length;function r(n){return function(){for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];var s=n.concat(a),u;return s.length>=t?u=e.apply(this,s):u=r(s),u}}return r([])}function pae(e){var t=e.length;function r(n){return function(){for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];var s=n.concat(a.reverse()),u;return s.length>=t?u=e.apply(this,s):u=r(s),u}}return r([])}function qg(e,t,r,n,o,i,a,l){return ve(l)?e.call(t,r,n,o,i,a,l):ve(a)?e.call(t,r,n,o,i,a):ve(i)?e.call(t,r,n,o,i):ve(o)?e.call(t,r,n,o):ve(n)?e.call(t,r,n):ve(r)?e.call(t,r):e.call(t)}const mae=Object.freeze(Object.defineProperty({__proto__:null,curry:xV,curryRight:pae,debounce:SE,fastCall:qg,isFunction:bt,partial:CE,pipe:gae,throttle:MV,throttleAfterHits:yae},Symbol.toStringTag,{value:"Module"}));function ht(){if(ve(console)){var e;(e=console).warn.apply(e,arguments)}}function _E(){if(ve(console)){var e;(e=console).error.apply(e,arguments)}}var bae=Ue,sA=_0,ty=iv.getWeakData,wae=S0,Sae=Ht,Cae=mn,mw=Nt,_ae=w0,DV=rl,uA=Mt,NV=Fo,Oae=NV.set,Rae=NV.getterFor,Eae=DV.find,Tae=DV.findIndex,kae=bae([].splice),Pae=0,ry=function(e){return e.frozen||(e.frozen=new HV)},HV=function(){this.entries=[]},bw=function(e,t){return Eae(e.entries,function(r){return r[0]===t})};HV.prototype={get:function(e){var t=bw(this,e);if(t)return t[1]},has:function(e){return!!bw(this,e)},set:function(e,t){var r=bw(this,e);r?r[1]=t:this.entries.push([e,t])},delete:function(e){var t=Tae(this.entries,function(r){return r[0]===e});return~t&&kae(this.entries,t,1),!!~t}};var LV={getConstructor:function(e,t,r,n){var o=e(function(s,u){wae(s,i),Oae(s,{type:t,id:Pae++,frozen:void 0}),Cae(u)||_ae(u,s[n],{that:s,AS_ENTRIES:r})}),i=o.prototype,a=Rae(t),l=function(s,u,f){var c=a(s),h=ty(Sae(u),!0);return h===!0?ry(c).set(u,f):h[c.id]=f,s};return sA(i,{delete:function(s){var u=a(this);if(!mw(s))return!1;var f=ty(s);return f===!0?ry(u).delete(s):f&&uA(f,u.id)&&delete f[u.id]},has:function(u){var f=a(this);if(!mw(u))return!1;var c=ty(u);return c===!0?ry(f).has(u):c&&uA(c,f.id)}}),sA(i,r?{get:function(u){var f=a(this);if(mw(u)){var c=ty(u);return c===!0?ry(f).get(u):c?c[f.id]:void 0}},set:function(u,f){return l(this,u,f)}}:{add:function(u){return l(this,u,!0)}}),o}},$ae=c0,fA=vt,og=Ue,cA=_0,Aae=iv,Iae=hm,jV=LV,ny=Nt,oy=Fo.enforce,Mae=je,xae=cj,bv=Object,Dae=Array.isArray,iy=bv.isExtensible,FV=bv.isFrozen,Nae=bv.isSealed,BV=bv.freeze,Hae=bv.seal,Lae=!fA.ActiveXObject&&"ActiveXObject"in fA,Uf,VV=function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},WV=Iae("WeakMap",VV,jV),Vl=WV.prototype,ig=og(Vl.set),jae=function(){return $ae&&Mae(function(){var e=BV([]);return ig(new WV,e,1),!FV(e)})};if(xae)if(Lae){Uf=jV.getConstructor(VV,"WeakMap",!0),Aae.enable();var hA=og(Vl.delete),ay=og(Vl.has),dA=og(Vl.get);cA(Vl,{delete:function(e){if(ny(e)&&!iy(e)){var t=oy(this);return t.frozen||(t.frozen=new Uf),hA(this,e)||t.frozen.delete(e)}return hA(this,e)},has:function(t){if(ny(t)&&!iy(t)){var r=oy(this);return r.frozen||(r.frozen=new Uf),ay(this,t)||r.frozen.has(t)}return ay(this,t)},get:function(t){if(ny(t)&&!iy(t)){var r=oy(this);return r.frozen||(r.frozen=new Uf),ay(this,t)?dA(this,t):r.frozen.get(t)}return dA(this,t)},set:function(t,r){if(ny(t)&&!iy(t)){var n=oy(this);n.frozen||(n.frozen=new Uf),ay(this,t)?ig(this,t,r):n.frozen.set(t,r)}else ig(this,t,r);return this}})}else jae()&&cA(Vl,{set:function(t,r){var n;return Dae(t)&&(FV(t)?n=BV:Nae(t)&&(n=Hae)),ig(this,t,r),n&&n(t),this}});var be={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Jy()?182:174,AUDIO_MUTE:Jy()?181:173,AUDIO_UP:Jy()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},Fae=[be.ALT,be.ARROW_DOWN,be.ARROW_LEFT,be.ARROW_RIGHT,be.ARROW_UP,be.AUDIO_DOWN,be.AUDIO_MUTE,be.AUDIO_UP,be.BACKSPACE,be.CAPS_LOCK,be.DELETE,be.END,be.ENTER,be.ESCAPE,be.F1,be.F2,be.F3,be.F4,be.F5,be.F6,be.F7,be.F8,be.F9,be.F10,be.F11,be.F12,be.F13,be.F14,be.F15,be.F16,be.F17,be.F18,be.F19,be.HOME,be.INSERT,be.MEDIA_NEXT,be.MEDIA_PLAY_PAUSE,be.MEDIA_PREV,be.MEDIA_STOP,be.NULL,be.NUM_LOCK,be.PAGE_DOWN,be.PAGE_UP,be.PAUSE,be.SCROLL_LOCK,be.SHIFT,be.TAB];function UV(e){return e===32||e>=48&&e<=57||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222||e>=226||e>=65&&e<=90}function OE(e){return Fae.includes(e)}function Bae(e){var t=[];return jg()?t.push(be.COMMAND_LEFT,be.COMMAND_RIGHT,be.COMMAND_FIREFOX):t.push(be.CONTROL),t.includes(e)}function zV(e){return[be.CONTROL,be.COMMAND_LEFT,be.COMMAND_RIGHT,be.COMMAND_FIREFOX].includes(e)}function ps(e,t){var r=t.split("|"),n=!1;return $(r,function(o){if(e===be[o])return n=!0,!1}),n}const Vae=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:be,isCtrlKey:Bae,isCtrlMetaKey:zV,isFunctionKey:OE,isKey:ps,isPrintableChar:UV},Symbol.toStringTag,{value:"Module"}));function pn(e){e.isImmediatePropagationEnabled=!1,e.cancelBubble=!0}function ta(e){return e.isImmediatePropagationEnabled===!1}function ki(e){return e.button===2}function Hm(e){return e.button===0}const Wae=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:ta,isLeftClick:Hm,isRightClick:ki,stopImmediatePropagation:pn},Symbol.toStringTag,{value:"Module"}));function Gc(e){"@babel/helpers - typeof";return Gc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gc(e)}var vA;function Uae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Yae(n.key),n)}}function zae(e,t,r){return t&&yA(e.prototype,t),r&&yA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Yae(e){var t=Gae(e,"string");return Gc(t)==="symbol"?t:String(t)}function Gae(e,t){if(Gc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Kae(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var yl=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","beforeAutofillInsidePopulate","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],qae=ft(vA||(vA=Kae([`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion]. 
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to 
  learn about the migration path.`],[`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\\x20
  learn about the migration path.`]))),ww=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),Sw=new Map([["beforeAutofillInsidePopulate",'The plugin hook "beforeAutofillInsidePopulate" is deprecated and will be removed in the next major release.']]),YV=function(){function e(){Uae(this,e),this.globalBucket=this.createEmptyBucket()}return zae(e,[{key:"createEmptyBucket",value:function(){var r=Object.create(null);return $(yl,function(n){return r[n]=[]}),r}},{key:"getBucket",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return r?(r.pluginHookBucket||(r.pluginHookBucket=this.createEmptyBucket()),r.pluginHookBucket):this.globalBucket}},{key:"add",value:function(r,n){var o=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(n))$(n,function(s){return o.add(r,s,i)});else{ww.has(r)&&ht(pE(qae,{hookName:r,removedInVersion:ww.get(r)})),Sw.has(r)&&ht(Sw.get(r));var a=this.getBucket(i);if(typeof a[r]>"u"&&(this.register(r),a[r]=[]),n.skip=!1,a[r].indexOf(n)===-1){var l=!1;n.initialHook&&$(a[r],function(s,u){if(s.initialHook)return a[r][u]=n,l=!0,!1}),l||a[r].push(n)}}return this}},{key:"once",value:function(r,n){var o=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(n)?$(n,function(a){return o.once(r,a,i)}):(n.runOnce=!0,this.add(r,n,i))}},{key:"remove",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=this.getBucket(o);return typeof i[r]<"u"&&i[r].indexOf(n)>=0?(n.skip=!0,!0):!1}},{key:"has",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,o=this.getBucket(n);return!!(o[r]!==void 0&&o[r].length)}},{key:"run",value:function(r,n,o,i,a,l,s,u){{var f=this.globalBucket[n],c=f?f.length:0,h=0;if(c)for(;h<c;){if(!f[h]||f[h].skip){h+=1;continue}var d=qg(f[h],r,o,i,a,l,s,u);d!==void 0&&(o=d),f[h]&&f[h].runOnce&&this.remove(n,f[h]),h+=1}}{var v=this.getBucket(r)[n],g=v?v.length:0,m=0;if(g)for(;m<g;){if(!v[m]||v[m].skip){m+=1;continue}var w=qg(v[m],r,o,i,a,l,s,u);w!==void 0&&(o=w),v[m]&&v[m].runOnce&&this.remove(n,v[m],r),m+=1}}return o}},{key:"destroy",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;We(this.getBucket(r),function(n,o,i){return i[o].length=0})}},{key:"register",value:function(r){this.isRegistered(r)||yl.push(r)}},{key:"deregister",value:function(r){this.isRegistered(r)&&yl.splice(yl.indexOf(r),1)}},{key:"isDeprecated",value:function(r){return Sw.has(r)||ww.has(r)}},{key:"isRegistered",value:function(r){return yl.indexOf(r)>=0}},{key:"getRegistered",value:function(){return yl}}],[{key:"getSingleton",value:function(){return Zae()}}]),e}(),Xae=new YV;function Zae(){return Xae}const pe=YV;function gA(e){return tle(e)||ele(e)||Qae(e)||Jae()}function Jae(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Qae(e,t){if(e){if(typeof e=="string")return zC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return zC(e,t)}}function ele(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function tle(e){if(Array.isArray(e))return zC(e)}function zC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Cw=new Map;function en(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";Cw.has(e)||Cw.set(e,new Map);var t=Cw.get(e);function r(l,s){t.set(l,s)}function n(l){return t.get(l)}function o(l){return t.has(l)}function i(){return gA(t.keys())}function a(){return gA(t.values())}return{register:r,getItem:n,hasItem:o,getNames:i,getValues:a}}var YC=new WeakMap,wv=en("editors"),rle=wv.register,GV=wv.getItem,KV=wv.hasItem,nle=wv.getNames;wv.getValues;function ole(e){var t={},r=e;this.getConstructor=function(){return e},this.getInstance=function(n){return n.guid in t||(t[n.guid]=new r(n)),t[n.guid]},pe.getSingleton().add("afterDestroy",function(){t[this.guid]=null})}function qV(e,t){var r;if(typeof e=="function")YC.get(e)||Or(null,e),r=YC.get(e);else if(typeof e=="string")r=GV(e);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error('No editor registered under name "'.concat(e,'"'));return r.getInstance(t)}function Xg(e){if(typeof e=="function")return e;if(!KV(e))throw Error('No registered editor found under "'.concat(e,'" name'));return GV(e).getConstructor()}function Or(e,t){e&&typeof e!="string"&&(t=e,e=t.EDITOR_TYPE);var r=new ole(t);typeof e=="string"&&rle(e,r),YC.set(t,r)}function Kc(e){"@babel/helpers - typeof";return Kc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kc(e)}function ile(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lle(n.key),n)}}function ale(e,t,r){return t&&pA(e.prototype,t),r&&pA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lle(e){var t=sle(e,"string");return Kc(t)==="symbol"?t:String(t)}function sle(e,t){if(Kc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Kc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ag=0,ule=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;ile(this,e),this.context=t||this,this.context.eventListeners||(this.context.eventListeners=[])}return ale(e,[{key:"addEventListener",value:function(r,n,o){var i=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function l(s){o.call(this,fle(s))}return typeof a!="boolean"&&!hB()&&(a=!1),this.context.eventListeners.push({element:r,event:n,callback:o,callbackProxy:l,options:a,eventManager:this}),r.addEventListener(n,l,a),ag+=1,function(){i.removeEventListener(r,n,o)}}},{key:"removeEventListener",value:function(r,n,o){for(var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a=this.context.eventListeners.length,l;a;)if(a-=1,l=this.context.eventListeners[a],l.event===n&&l.element===r){if(o&&o!==l.callback||i&&l.eventManager!==this)continue;this.context.eventListeners.splice(a,1),l.element.removeEventListener(l.event,l.callbackProxy,l.options),ag-=1}}},{key:"clearEvents",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.context)for(var n=this.context.eventListeners.length;n;){n-=1;var o=this.context.eventListeners[n];r&&o.eventManager!==this||(this.context.eventListeners.splice(n,1),o.element.removeEventListener(o.event,o.callbackProxy,o.options),ag-=1)}}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents(),this.context=null}},{key:"destroyWithOwnEventsOnly",value:function(){this.clearEvents(!0),this.context=null}},{key:"fireEvent",value:function(r,n){var o=r.document,i=r;o||(o=r.ownerDocument?r.ownerDocument:r,i=o.defaultView);var a={bubbles:!0,cancelable:n!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0},l;o.createEvent?(l=o.createEvent("MouseEvents"),l.initMouseEvent(n,a.bubbles,a.cancelable,a.view,a.detail,a.screenX,a.screenY,a.clientX,a.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,a.button,o.body.parentNode)):l=o.createEventObject(),r.dispatchEvent?r.dispatchEvent(l):r.fireEvent("on".concat(n),l)}}]),e}();function fle(e){var t=e.stopImmediatePropagation;return e.stopImmediatePropagation=function(){t.apply(this),pn(this)},e}const Tt=ule;function cle(){return ag}function qc(e){"@babel/helpers - typeof";return qc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qc(e)}function hle(e,t){return gle(e)||yle(e,t)||vle(e,t)||dle()}function dle(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vle(e,t){if(e){if(typeof e=="string")return mA(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mA(e,t)}}function mA(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function yle(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function gle(e){if(Array.isArray(e))return e}function ple(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ble(n.key),n)}}function mle(e,t,r){return t&&bA(e.prototype,t),r&&bA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ble(e){var t=wle(e,"string");return qc(t)==="symbol"?t:String(t)}function wle(e,t){if(qc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Lm="editorManager.navigation",Ec="editorManager.handlingEditor",GC=function(){function e(t,r,n){var o=this;ple(this,e),this.instance=t,this.tableMeta=r,this.selection=n,this.eventManager=new Tt(t),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0;var i=this.instance.getShortcutManager();i.addContext("editor"),this.registerShortcuts(),this.instance.addHook("afterDocumentKeyDown",function(a){return o.onAfterDocumentKeyDown(a)}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",function(a){!o.destroyed&&o.instance.isListening()&&o.openEditor("",a)}),this.instance.view._wt.update("onCellDblClick",function(a,l,s){return o.onCellDblClick(a,l,s)})}return mle(e,[{key:"registerShortcuts",value:function(){var r=this,n=this.instance.getShortcutManager(),o=n.getContext("grid"),i=n.getContext("editor"),a={group:Ec};i.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:function(s,u){r.closeEditorAndSaveChanges(n.isCtrlPressed()),r.moveSelectionAfterEnter(u.includes("shift"))}},{keys:[["Escape"],["Escape","Control/Meta"]],callback:function(){r.closeEditorAndRestoreOriginalValue(n.isCtrlPressed()),r.activeEditor.focus()}}],a),o.addShortcuts([{keys:[["F2"]],callback:function(s){r.openEditor(null,s,!0)}},{keys:[["Backspace"],["Delete"]],callback:function(){r.instance.emptySelectedCells(),r.prepareEditor()}},{keys:[["Enter"],["Enter","Shift"]],callback:function(s,u){r.instance.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter():r.openEditor(null,s,!0):r.moveSelectionAfterEnter(u.includes("shift")),pn(s)}}],a)}},{key:"lockEditor",value:function(){this.lock=!0}},{key:"unlockEditor",value:function(){this.lock=!1}},{key:"destroyEditor",value:function(r){this.lock||this.closeEditor(r)}},{key:"getActiveEditor",value:function(){return this.activeEditor}},{key:"prepareEditor",value:function(){var r=this;if(!this.lock){if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,function(g){g&&r.prepareEditor()});return}var n=this.instance.getSelectedRangeLast().highlight,o=n.row,i=n.col,a=this.instance.runHooks("modifyGetCellCoords",o,i),l=o,s=i;if(Array.isArray(a)){var u=hle(a,2);l=u[0],s=u[1]}this.cellProperties=this.instance.getCellMeta(l,s);var f=this.instance.rootDocument.activeElement;if(f&&Nm(f)&&f.blur(),!this.isCellEditable()){this.clearActiveEditor();return}var c=this.instance.getCell(o,i,!0);if(c){var h=this.instance.getCellEditor(this.cellProperties),d=this.instance.colToProp(s),v=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(l),s);this.activeEditor=qV(h,this.instance),this.activeEditor.prepare(o,i,d,c,v,this.cellProperties)}}}},{key:"isEditorOpened",value:function(){return this.activeEditor&&this.activeEditor.isOpened()}},{key:"openEditor",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}if(!this.activeEditor){var i=this.instance.getSelectedRangeLast().highlight,a=i.row,l=i.col,s=this.instance.rowIndexMapper.getRenderableFromVisualIndex(a),u=this.instance.columnIndexMapper.getRenderableFromVisualIndex(l);this.instance.view.scrollViewport(this.instance._createCellCoords(s,u)),this.instance.view.render(),this.prepareEditor()}this.activeEditor&&(o&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(r,n))}},{key:"closeEditor",value:function(r,n,o){this.activeEditor?this.activeEditor.finishEditing(r,n,o):o&&o(!1)}},{key:"closeEditorAndSaveChanges",value:function(r){this.closeEditor(!1,r)}},{key:"closeEditorAndRestoreOriginalValue",value:function(r){this.closeEditor(!0,r)}},{key:"clearActiveEditor",value:function(){this.activeEditor=void 0}},{key:"isCellEditable",value:function(){var r=this.instance.getCellEditor(this.cellProperties),n=this.instance.getSelectedRangeLast().highlight,o=n.row,i=n.col,a=this.instance,l=a.rowIndexMapper,s=a.columnIndexMapper,u=l.isHidden(this.instance.toPhysicalRow(o))||s.isHidden(this.instance.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!r||u)}},{key:"moveSelectionAfterEnter",value:function(r){var n=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;r?this.selection.transformStart(-n.row,-n.col):this.selection.transformStart(n.row,n.col,!0)}},{key:"onAfterDocumentKeyDown",value:function(r){var n=this;if(this.instance.isListening()){var o=r.keyCode;if(this.selection.isSelected()){var i=(r.ctrlKey||r.metaKey)&&!r.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!OE(o)&&!zV(o)&&!i&&!this.isEditorOpened()){var a=this.instance.getShortcutManager(),l=a.getContext("editor"),s={runOnlyIf:function(){return ve(n.instance.getSelected())},group:Lm};l.addShortcuts([{keys:[["ArrowUp"]],callback:function(){n.instance.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){n.instance.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){n.instance.selection.transformStart(0,-1*n.instance.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){n.instance.selection.transformStart(0,n.instance.getDirectionFactor())}}],s),this.openEditor("",r)}}}}},{key:"onCellDblClick",value:function(r,n,o){o.nodeName==="TD"&&this.openEditor(null,r,!0)}},{key:"destroy",value:function(){this.destroyed=!0,this.eventManager.destroy()}}]),e}(),wA=new WeakMap;GC.getInstance=function(e,t,r){var n=wA.get(e);return n||(n=new GC(e,t,r),wA.set(e,n)),n};const Sle=GC;var Cle=Ae,_le=kr,XV=Jd,Ole=je,Rle=Ole(function(){XV(1)});Cle({target:"Object",stat:!0,forced:Rle},{keys:function(t){return XV(_le(t))}});var Ele=Ae,Tle=K0;Ele({target:"String",proto:!0},{repeat:Tle});var kle=zt,Ple=gm,$le=Ht,Ale=mn,Ile=Qa,_w=Yt,Mle=Tr,xle=Xa,Dle=x0,SA=pm;Ple("match",function(e,t,r){return[function(o){var i=Mle(this),a=Ale(o)?void 0:xle(o,e);return a?kle(a,o,i):new RegExp(o)[e](_w(i))},function(n){var o=$le(this),i=_w(n),a=r(t,o,i);if(a.done)return a.value;if(!o.global)return SA(o,i);var l=o.unicode;o.lastIndex=0;for(var s=[],u=0,f;(f=SA(o,i))!==null;){var c=_w(f[0]);s[u]=c,c===""&&(o.lastIndex=Dle(i,Ile(o.lastIndex),l)),u++}return u===0?null:s}]});var Nle=_f,Hle=Br,Lle=Ii,jle=bn,Fle=Of,Ble=Math.min,KC=[].lastIndexOf,ZV=!!KC&&1/[1].lastIndexOf(1,-0)<0,Vle=Fle("lastIndexOf"),Wle=ZV||!Vle,Ule=Wle?function(t){if(ZV)return Nle(KC,this,arguments)||0;var r=Hle(this),n=jle(r),o=n-1;for(arguments.length>1&&(o=Ble(o,Lle(arguments[1]))),o<0&&(o=n+o);o>=0;o--)if(o in r&&r[o]===t)return o||0;return-1}:KC,zle=Ae,CA=Ule;zle({target:"Array",proto:!0,forced:CA!==[].lastIndexOf},{lastIndexOf:CA});var Yle=qa,Gle=kr,Kle=zd,qle=bn,Xle=TypeError,_A=function(e){return function(t,r,n,o){var i=Gle(t),a=Kle(i),l=qle(i);Yle(r);var s=e?l-1:0,u=e?-1:1;if(n<2)for(;;){if(s in a){o=a[s],s+=u;break}if(s+=u,e?s<0:l<=s)throw new Xle("Reduce of empty array with no initial value")}for(;e?s>=0:l>s;s+=u)s in a&&(o=r(o,a[s],s,i));return o}},Zle={left:_A(!1),right:_A(!0)},Jle=Ae,Qle=Zle.left,ese=Of,OA=Yd,tse=qF,rse=!tse&&OA>79&&OA<83,nse=rse||!ese("reduce");Jle({target:"Array",proto:!0,forced:nse},{reduce:function(t){var r=arguments.length;return Qle(this,t,r,r>1?arguments[1]:void 0)}});var ose=Ae,ise=rl.findIndex,ase=av,qC="findIndex",JV=!0;qC in[]&&Array(1)[qC](function(){JV=!1});ose({target:"Array",proto:!0,forced:JV},{findIndex:function(t){return ise(this,t,arguments.length>1?arguments[1]:void 0)}});ase(qC);function Ow(e){return fse(e)||use(e)||sse(e)||lse()}function lse(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sse(e,t){if(e){if(typeof e=="string")return XC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return XC(e,t)}}function use(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function fse(e){if(Array.isArray(e))return XC(e)}function XC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var QV={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},cse=new RegExp(Object.keys(QV).map(function(e){return"(".concat(e,")")}).join("|"),"gi");function hse(e){return(e&&e.nodeName||"")==="TABLE"}function ZC(e){for(var t=e.hasColHeaders(),r=e.hasRowHeaders(),n=[t?-1:0,r?-1:0,e.countRows()-1,e.countCols()-1],o=e.getData.apply(e,n),i=o.length,a=i>0?o[0].length:0,l=["<table>","</table>"],s=t?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],f=r?1:0,c=t?1:0,h=0;h<i;h+=1){for(var d=t&&h===0,v=[],g=0;g<a;g+=1){var m=!d&&r&&g===0,w="";if(d)w="<th>".concat(e.getColHeader(g-f),"</th>");else if(m)w="<th>".concat(e.getRowHeader(h-c),"</th>");else{var S=o[h][g],C=e.getCellMeta(h-c,g-f),k=C.hidden,R=C.rowspan,V=C.colspan;if(!k){var U=[];if(R&&U.push('rowspan="'.concat(R,'"')),V&&U.push('colspan="'.concat(V,'"')),Kt(S))w="<td ".concat(U.join(" "),"></td>");else{var X=S.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");w="<td ".concat(U.join(" "),">").concat(X,"</td>")}}}v.push(w)}var Y=["<tr>"].concat(v,["</tr>"]).join("");d?s.splice(1,0,Y):u.splice(-1,0,Y)}return l.splice(1,0,s.join(""),u.join("")),l.join("")}function JC(e){for(var t=e.length,r=["<table>"],n=0;n<t;n+=1){var o=e[n],i=o.length,a=[];n===0&&r.push("<tbody>");for(var l=0;l<i;l+=1){var s=o[l],u=Kt(s)?"":s.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,function(f){return'<span style="mso-spacerun: yes">'.concat("&nbsp;".repeat(f.length-1)," </span>")}).replace(/\t/gi,"&#9;");a.push("<td>".concat(u,"</td>"))}r.push.apply(r,["<tr>"].concat(a,["</tr>"])),n+1===t&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function e2(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document,r={},n=t.createDocumentFragment(),o=t.createElement("div");n.appendChild(o);var i=e;if(typeof i=="string"){var a=i.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,function(_){var T=_.match(/<td\b[^>]*?>/g)[0],I=_.substring(T.length,_.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,""),F="</td>";return"".concat(T).concat(I).concat(F)});o.insertAdjacentHTML("afterbegin","".concat(a)),i=o.querySelector("table")}if(!(!i||!hse(i))){var l=o.querySelector('meta[name$="enerator"]'),s=i.querySelector("tbody th")!==null,u=i.querySelector("tr"),f=u?Array.from(u.cells).reduce(function(_,T){return _+T.colSpan},0)-(s?1:0):0,c=i.tFoot&&Array.from(i.tFoot.rows)||[],h=[],d=!1,v=0,g=0;if(i.tHead){var m=Array.from(i.tHead.rows).filter(function(_){var T=_.querySelector("td")!==null;return T&&h.push(_),!T});v=m.length,d=v>0,v>1?r.nestedHeaders=Array.from(m).reduce(function(_,T){var I=Array.from(T.cells).reduce(function(F,W,G){if(s&&G===0)return F;var Q=W.colSpan,ee=W.innerHTML,se=Q>1?{label:ee,colspan:Q}:ee;return F.push(se),F},[]);return _.push(I),_},[]):d&&(r.colHeaders=Array.from(m[0].children).reduce(function(_,T,I){return s&&I===0||_.push(T.innerHTML),_},[]))}h.length&&(r.fixedRowsTop=h.length),c.length&&(r.fixedRowsBottom=c.length);var w=[].concat(h,Ow(Array.from(i.tBodies).reduce(function(_,T){return _.push.apply(_,Ow(Array.from(T.rows))),_},[])),Ow(c));g=w.length;for(var S=new Array(g),C=0;C<g;C++)S[C]=new Array(f);for(var k=[],R=[],V=0;V<g;V++)for(var U=w[V],X=Array.from(U.cells),Y=X.length,q=0;q<Y;q++){var Z=X[q],ie=Z.nodeName,J=Z.innerHTML,le=Z.rowSpan,Se=Z.colSpan,me=S[V].findIndex(function(_){return _===void 0});if(ie==="TD"){if(le>1||Se>1){for(var Ce=V;Ce<V+le;Ce++)if(Ce<g)for(var P=me;P<me+Se;P++)S[Ce][P]=null;var y=Z.getAttribute("style"),p=y&&y.includes("mso-ignore:colspan");p||k.push({col:me,row:V,rowspan:le,colspan:Se})}var b="";l&&/excel/gi.test(l.content)?b=J.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):b=J.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),S[V][me]=b.replace(cse,function(_){return QV[_]})}else R.push(J)}return k.length&&(r.mergeCells=k),R.length&&(r.rowHeaders=R),S.length&&(r.data=S),r}}const dse=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:JC,htmlToGridSettings:e2,instanceToHTML:ZC},Symbol.toStringTag,{value:"Module"}));function vse(e){return mse(e)||pse(e)||gse(e)||yse()}function yse(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gse(e,t){if(e){if(typeof e=="string")return QC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return QC(e,t)}}function pse(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function mse(e){if(Array.isArray(e))return QC(e)}function QC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function e_(e){"@babel/helpers - typeof";return e_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e_(e)}function gr(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=e_(e);if(r==="number")return!isNaN(e)&&isFinite(e);if(r==="string"){if(e.length===0)return!1;if(e.length===1)return/\d/.test(e);var n=Array.from(new Set(["."].concat(vse(t)))).map(function(o){return"\\".concat(o)}).join("|");return new RegExp("^[+-]?\\s*(((".concat(n,")?\\d+((").concat(n,")\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$"),"i").test(e.trim())}else if(r==="object")return!!e&&typeof e.valueOf()=="number"&&!(e instanceof Date);return!1}function t2(e){return gr(e,[","])}function _e(e,t,r){var n=-1;for(typeof t=="function"?(r=t,t=e):n=e-1;++n<=t&&r(n)!==!1;);}function Zg(e,t,r){var n=e+1;for(typeof t=="function"&&(r=t,t=0);--n>=t&&r(n)!==!1;);}function RE(e,t){return t=parseInt(t.toString().replace("%",""),10),t=isNaN(t)?0:t,parseInt(e*t/100,10)}const bse=Object.freeze(Object.defineProperty({__proto__:null,isNumeric:gr,isNumericLike:t2,rangeEach:_e,rangeEachReverse:Zg,valueAccordingPercent:RE},Symbol.toStringTag,{value:"Module"}));function wse(e){return _se(e)||Cse(e)||r2(e)||Sse()}function Sse(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Cse(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _se(e){if(Array.isArray(e))return t_(e)}function Ose(e,t){return Tse(e)||Ese(e,t)||r2(e,t)||Rse()}function Rse(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function r2(e,t){if(e){if(typeof e=="string")return t_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return t_(e,t)}}function t_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ese(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Tse(e){if(Array.isArray(e))return e}var r_="asc",kse="desc",RA=new Map([[r_,[-1,1]],[kse,[1,-1]]]),Pse=function(t){return"The priority '".concat(t,"' is already declared in a map.")},$se=function(t){return"The priority '".concat(t,"' is not a number.")};function Ase(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorPriorityExists,r=e.errorPriorityNaN,n=new Map;t=bt(t)?t:Pse,r=bt(r)?r:$se;function o(a,l){if(!gr(a))throw new Error(r(a));if(n.has(a))throw new Error(t(a));n.set(a,l)}function i(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:r_,l=RA.get(a)||RA.get(r_),s=Ose(l,2),u=s[0],f=s[1];return wse(n).sort(function(c,h){return c[0]<h[0]?u:f}).map(function(c){return c[1]})}return{addItem:o,getItems:i}}var Ise=Ae,Mse=rl.find,xse=av,n_="find",n2=!0;n_ in[]&&Array(1)[n_](function(){n2=!1});Ise({target:"Array",proto:!0,forced:n2},{find:function(t){return Mse(this,t,arguments.length>1?arguments[1]:void 0)}});xse(n_);function Dse(e){return Lse(e)||Hse(e)||o2(e)||Nse()}function Nse(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Hse(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Lse(e){if(Array.isArray(e))return o_(e)}function EA(e,t){return Bse(e)||Fse(e,t)||o2(e,t)||jse()}function jse(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function o2(e,t){if(e){if(typeof e=="string")return o_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o_(e,t)}}function o_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Fse(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Bse(e){if(Array.isArray(e))return e}var Vse=function(t){return"The id '".concat(t,"' is already declared in a map.")};function jm(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorIdExists,r=new Map;t=bt(t)?t:Vse;function n(f,c){if(u(f))throw new Error(t(f));r.set(f,c)}function o(f){return r.delete(f)}function i(){r.clear()}function a(f){var c=s().find(function(v){var g=EA(v,2),m=g[0],w=g[1];return f===w?m:!1})||[null],h=EA(c,1),d=h[0];return d}function l(f){return r.get(f)}function s(){return Dse(r)}function u(f){return r.has(f)}return{addItem:n,clear:i,getId:a,getItem:l,getItems:s,hasItem:u,removeItem:o}}function Wse(e){return Gse(e)||Yse(e)||zse(e)||Use()}function Use(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zse(e,t){if(e){if(typeof e=="string")return i_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return i_(e,t)}}function Yse(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Gse(e){if(Array.isArray(e))return i_(e)}function i_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Kse=function(t){return"'".concat(t,"' value is already declared in a unique set.")};function qse(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorItemExists,r=new Set;t=bt(t)?t:Kse;function n(a){if(r.has(a))throw new Error(t(a));r.add(a)}function o(){return Wse(r)}function i(){r.clear()}return{addItem:n,clear:i,getItems:o}}function Xse(e,t){return Qse(e)||Jse(e,t)||i2(e,t)||Zse()}function Zse(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Jse(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Qse(e){if(Array.isArray(e))return e}function TA(e){return rue(e)||tue(e)||i2(e)||eue()}function eue(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function i2(e,t){if(e){if(typeof e=="string")return a_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a_(e,t)}}function tue(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function rue(e){if(Array.isArray(e))return a_(e)}function a_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var EE=function(t){return'There is already registered "'.concat(t,'" plugin.')},nue=function(t){return'There is already registered plugin on priority "'.concat(t,'".')},oue=function(t){return'The priority "'.concat(t,'" is not a number.')},a2=Ase({errorPriorityExists:nue,errorPriorityNaN:oue}),l2=qse({errorItemExists:EE}),l_=jm({errorIdExists:EE});function TE(){return[].concat(TA(a2.getItems()),TA(l2.getItems()))}function Sv(e){var t=ar(e);return l_.getItem(t)}function iue(e){return!!Sv(e)}function et(e,t,r){var n=lue(e,t,r),o=Xse(n,3);e=o[0],t=o[1],r=o[2],Sv(e)===void 0&&aue(e,t,r)}function aue(e,t,r){var n=ar(e);if(l_.hasItem(n))throw new Error(EE(n));r===void 0?l2.addItem(n):a2.addItem(r,n),l_.addItem(n,t)}function lue(e,t,r){return typeof e=="function"&&(t=e,e=t.PLUGIN_KEY,r=t.PLUGIN_PRIORITY),[e,t,r]}var Cv=en("renderers"),sue=Cv.register,uue=Cv.getItem,s2=Cv.hasItem,fue=Cv.getNames;Cv.getValues;function Jg(e){if(typeof e=="function")return e;if(!s2(e))throw Error('No registered renderer found under "'.concat(e,'" name'));return uue(e)}function In(e,t){typeof e!="string"&&(t=e,e=t.RENDERER_TYPE),sue(e,t)}var _v=en("validators"),cue=_v.register,hue=_v.getItem,u2=_v.hasItem,due=_v.getNames;_v.getValues;function kE(e){if(typeof e=="function")return e;if(!u2(e))throw Error('No registered validator found under "'.concat(e,'" name'));return hue(e)}function Gl(e,t){typeof e!="string"&&(t=e,e=t.VALIDATOR_TYPE),cue(e,t)}var ra=1,or=2;function Xc(e){"@babel/helpers - typeof";return Xc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xc(e)}function vue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gue(n.key),n)}}function yue(e,t,r){return t&&kA(e.prototype,t),r&&kA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gue(e){var t=pue(e,"string");return Xc(t)==="symbol"?t:String(t)}function pue(e,t){if(Xc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var gl=new WeakMap,mue=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.viewportSize,n=t.scrollOffset,o=t.totalItems,i=t.itemSizeFn,a=t.overrideFn,l=t.calculationType,s=t.stretchMode,u=t.stretchingItemWidthFn,f=u===void 0?function(h){return h}:u,c=t.inlineStartOffset;vue(this,e),gl.set(this,{viewportWidth:r,scrollOffset:n,totalColumns:o,columnWidthFn:i,overrideFn:a,calculationType:l,stretchingColumnWidthFn:f,inlineStartOffset:c}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=s,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}return yue(e,[{key:"calculate",value:function(){for(var r=0,n=!0,o=[],i,a=0,l=0,s=gl.get(this),u=s.calculationType,f=s.overrideFn,c=s.scrollOffset,h=Math.max(s.scrollOffset,0),d=s.totalColumns,v=s.viewportWidth,g=h>0?v+1:v,m=0;m<d;m++)if(i=this._getColumnWidth(m),r<=h&&u!==or&&(this.startColumn=m,a=i),r>=h&&r+(u===or?i:0)<=h+g&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=m,a=i),this.endColumn=m),o.push(r),r+=i,l=i,u!==or&&(this.endColumn=m),r>=h+v){n=!1;break}var w=c+v-g,S=u===or?0:l,C=u===or?a:0;if(w<-1*s.inlineStartOffset||c>o.at(-1)+S||-1*s.scrollOffset-s.viewportWidth>-1*C?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===d-1&&n)for(this.startColumn=this.endColumn;this.startColumn>0;){var k=o[this.endColumn]+i-o[this.startColumn-1];if((k<=v||u!==or)&&(this.startColumn-=1),k>v)break}u===ra&&this.startColumn!==null&&f&&f(this),this.startPosition=o[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),d<this.endColumn&&(this.endColumn=d-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(r){if(this.stretch!=="none"){var n=r;this.totalTargetWidth=n;for(var o=gl.get(this),i=o.totalColumns,a=0,l=0;l<i;l++){var s=this._getColumnWidth(l),u=o.stretchingColumnWidthFn(void 0,l);typeof u=="number"?n-=u:a+=s}var f=n-a;if(this.stretch==="all"&&f>0)this.stretchAllRatio=n/a,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(this.stretch==="last"&&n!==1/0){var c=this._getColumnWidth(i-1),h=f+c;this.stretchLastWidth=h>=0?h:c}}}},{key:"getStretchedColumnWidth",value:function(r,n){var o=null;return this.stretch==="all"&&this.stretchAllRatio!==0?o=this._getStretchedAllColumnWidth(r,n):this.stretch==="last"&&this.stretchLastWidth!==0&&(o=this._getStretchedLastColumnWidth(r)),o}},{key:"_getStretchedAllColumnWidth",value:function(r,n){var o=0,i=gl.get(this),a=i.totalColumns;if(!this.stretchAllColumnsWidth[r]){var l=Math.round(n*this.stretchAllRatio),s=i.stretchingColumnWidthFn(l,r);s===void 0?this.stretchAllColumnsWidth[r]=l:this.stretchAllColumnsWidth[r]=isNaN(s)?this._getColumnWidth(r):s}if(this.stretchAllColumnsWidth.length===a&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var u=0;u<this.stretchAllColumnsWidth.length;u++)o+=this.stretchAllColumnsWidth[u];o!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-o)}return this.stretchAllColumnsWidth[r]}},{key:"_getStretchedLastColumnWidth",value:function(r){var n=gl.get(this),o=n.totalColumns;return r===o-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(r){var n=gl.get(this).columnWidthFn(r);return isNaN(n)&&(n=e.DEFAULT_WIDTH),n}}],[{key:"DEFAULT_WIDTH",get:function(){return 50}}]),e}();const PE=mue;function Zc(e){"@babel/helpers - typeof";return Zc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zc(e)}function bue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Sue(n.key),n)}}function wue(e,t,r){return t&&PA(e.prototype,t),r&&PA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Sue(e){var t=Cue(e,"string");return Zc(t)==="symbol"?t:String(t)}function Cue(e,t){if(Zc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $A=new WeakMap,_ue=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.viewportSize,n=t.scrollOffset,o=t.totalItems,i=t.itemSizeFn,a=t.overrideFn,l=t.calculationType,s=t.scrollbarHeight;bue(this,e),$A.set(this,{viewportHeight:r,scrollOffset:n,totalRows:o,rowHeightFn:i,overrideFn:a,calculationType:l,horizontalScrollbarHeight:s}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.calculate()}return wue(e,[{key:"calculate",value:function(){for(var r=$A.get(this),n=r.calculationType,o=r.overrideFn,i=r.rowHeightFn,a=r.scrollOffset,l=Math.max(r.scrollOffset,0),s=r.totalRows,u=r.viewportHeight,f=r.horizontalScrollbarHeight||0,c=0,h=!0,d=[],v,g=0,m=0,w=0;w<s;w++)if(v=i(w),isNaN(v)&&(v=e.DEFAULT_HEIGHT),c<=l&&n!==or&&(this.startRow=w,g=v),c>=l&&c+(n===or?v:0)<=l+u-f&&(this.startRow===null&&(this.startRow=w,g=v),this.endRow=w),d.push(c),c+=v,m=v,n!==or&&(this.endRow=w),c>=l+u-f){h=!1;break}var S=a+u-f,C=n===or?g:0,k=n===or?0:m;if(S<C||a>d.at(-1)+k?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===s-1&&h)for(this.startRow=this.endRow;this.startRow>0;){var R=d[this.endRow]+v-d[this.startRow-1];if((R<=u-f||n!==or)&&(this.startRow-=1),R>=u-f)break}n===ra&&this.startRow!==null&&o&&o(this),this.startPosition=d[this.startRow],this.startPosition===void 0&&(this.startPosition=null),s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}],[{key:"DEFAULT_HEIGHT",get:function(){return 23}}]),e}();const f2=_ue;function Jc(e){"@babel/helpers - typeof";return Jc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jc(e)}function Oue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,c2(n.key),n)}}function Rue(e,t,r){return t&&AA(e.prototype,t),r&&AA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Eue(e,t,r){Tue(e,t),t.set(e,r)}function Tue(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function IA(e,t,r){return t=c2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function c2(e){var t=kue(e,"string");return Jc(t)==="symbol"?t:String(t)}function kue(e,t){if(Jc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Jc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zf(e,t){var r=h2(e,t,"get");return Pue(e,r)}function Pue(e,t){return t.get?t.get.call(e):t.value}function $ue(e,t,r){var n=h2(e,t,"set");return Aue(e,n,r),r}function h2(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Aue(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Vi=new WeakMap,Iue=function(){function e(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;Oue(this,e),IA(this,"row",null),IA(this,"col",null),Eue(this,Vi,{writable:!0,value:!1}),$ue(this,Vi,n),typeof t<"u"&&typeof r<"u"&&(this.row=t,this.col=r)}return Rue(e,[{key:"isValid",value:function(r){return!(this.row<0||this.col<0||this.row>=r.getSetting("totalRows")||this.col>=r.getSetting("totalColumns"))}},{key:"isEqual",value:function(r){return r===this?!0:this.row===r.row&&this.col===r.col}},{key:"isSouthEastOf",value:function(r){return this.row>=r.row&&(zf(this,Vi)?this.col<=r.col:this.col>=r.col)}},{key:"isNorthWestOf",value:function(r){return this.row<=r.row&&(zf(this,Vi)?this.col>=r.col:this.col<=r.col)}},{key:"isSouthWestOf",value:function(r){return this.row>=r.row&&(zf(this,Vi)?this.col>=r.col:this.col<=r.col)}},{key:"isNorthEastOf",value:function(r){return this.row<=r.row&&(zf(this,Vi)?this.col<=r.col:this.col>=r.col)}},{key:"normalize",value:function(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}},{key:"clone",value:function(){return new e(this.row,this.col,zf(this,Vi))}},{key:"toObject",value:function(){return{row:this.row,col:this.col}}}]),e}();const Qg=Iue;function Qc(e){"@babel/helpers - typeof";return Qc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qc(e)}function Mue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,d2(n.key),n)}}function xue(e,t,r){return t&&MA(e.prototype,t),r&&MA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Due(e,t,r){Nue(e,t),t.set(e,r)}function Nue(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rw(e,t,r){return t=d2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function d2(e){var t=Hue(e,"string");return Qc(t)==="symbol"?t:String(t)}function Hue(e,t){if(Qc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Cn(e,t){var r=v2(e,t,"get");return Lue(e,r)}function Lue(e,t){return t.get?t.get.call(e):t.value}function jue(e,t,r){var n=v2(e,t,"set");return Fue(e,n,r),r}function v2(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Fue(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Wr=new WeakMap,Bue=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;Mue(this,e),Rw(this,"highlight",null),Rw(this,"from",null),Rw(this,"to",null),Due(this,Wr,{writable:!0,value:!1}),this.highlight=t.clone().normalize(),this.from=r.clone(),this.to=n.clone(),jue(this,Wr,o)}return xue(e,[{key:"setHighlight",value:function(r){return this.highlight=r.clone().normalize(),this}},{key:"setFrom",value:function(r){return this.from=r.clone(),this}},{key:"setTo",value:function(r){return this.to=r.clone(),this}},{key:"isValid",value:function(r){return this.from.isValid(r)&&this.to.isValid(r)}},{key:"isSingle",value:function(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}},{key:"getOuterHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getOuterWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"getHeight",value:function(){if(this.from.row<0&&this.to.row<0)return 0;var r=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(r,n)-Math.min(r,n)+1}},{key:"getWidth",value:function(){if(this.from.col<0&&this.to.col<0)return 0;var r=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(r,n)-Math.min(r,n)+1}},{key:"getCellsCount",value:function(){return this.getWidth()*this.getHeight()}},{key:"includes",value:function(r){var n=r.row,o=r.col,i=this.getOuterTopStartCorner(),a=this.getOuterBottomEndCorner();return i.row<=n&&a.row>=n&&i.col<=o&&a.col>=o}},{key:"includesRange",value:function(r){return this.includes(r.getOuterTopStartCorner())&&this.includes(r.getOuterBottomEndCorner())}},{key:"isEqual",value:function(r){return Math.min(this.from.row,this.to.row)===Math.min(r.from.row,r.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(r.from.row,r.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(r.from.col,r.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(r.from.col,r.to.col)}},{key:"overlaps",value:function(r){return r.isSouthEastOf(this.getOuterTopLeftCorner())&&r.isNorthWestOf(this.getOuterBottomRightCorner())}},{key:"isSouthEastOf",value:function(r){return this.getOuterTopLeftCorner().isSouthEastOf(r)||this.getOuterBottomRightCorner().isSouthEastOf(r)}},{key:"isNorthWestOf",value:function(r){return this.getOuterTopLeftCorner().isNorthWestOf(r)||this.getOuterBottomRightCorner().isNorthWestOf(r)}},{key:"isOverlappingHorizontally",value:function(r){return this.getOuterTopRightCorner().col>=r.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=r.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=r.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=r.getOuterTopLeftCorner().col}},{key:"isOverlappingVertically",value:function(r){return this.getOuterBottomRightCorner().row>=r.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=r.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=r.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=r.getOuterTopRightCorner().row}},{key:"expand",value:function(r){var n=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return r.row<n.row||r.col<n.col||r.row>o.row||r.col>o.col?(this.from=this._createCellCoords(Math.min(n.row,r.row),Math.min(n.col,r.col)),this.to=this._createCellCoords(Math.max(o.row,r.row),Math.max(o.col,r.col)),!0):!1}},{key:"expandByRange",value:function(r){if(this.includesRange(r)||!this.overlaps(r))return!1;var n=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner(),i=this.getDirection(),a=r.getOuterTopStartCorner(),l=r.getOuterBottomEndCorner(),s=Math.min(n.row,a.row),u=Math.min(n.col,a.col),f=Math.max(o.row,l.row),c=Math.max(o.col,l.col),h=this._createCellCoords(s,u),d=this._createCellCoords(f,c);return this.from=h,this.to=d,this.setDirection(i),this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}},{key:"getDirection",value:function(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}},{key:"setDirection",value:function(r){switch(r){case"NW-SE":var n=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];this.from=n[0],this.to=n[1];break;case"NE-SW":var o=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];this.from=o[0],this.to=o[1];break;case"SE-NW":var i=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];this.from=i[0],this.to=i[1];break;case"SW-NE":var a=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];this.from=a[0],this.to=a[1];break}}},{key:"getVerticalDirection",value:function(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}},{key:"getHorizontalDirection",value:function(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}},{key:"flipDirectionVertically",value:function(){var r=this.getDirection();switch(r){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}},{key:"flipDirectionHorizontally",value:function(){var r=this.getDirection();switch(r){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}},{key:"getTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getTopLeftCorner",value:function(){return Cn(this,Wr)?this.getTopEndCorner():this.getTopStartCorner()}},{key:"getBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getBottomRightCorner",value:function(){return Cn(this,Wr)?this.getBottomStartCorner():this.getBottomEndCorner()}},{key:"getTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getTopRightCorner",value:function(){return Cn(this,Wr)?this.getTopStartCorner():this.getTopEndCorner()}},{key:"getBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getBottomLeftCorner",value:function(){return Cn(this,Wr)?this.getBottomEndCorner():this.getBottomStartCorner()}},{key:"getOuterTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterTopLeftCorner",value:function(){return Cn(this,Wr)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}},{key:"getOuterBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterBottomRightCorner",value:function(){return Cn(this,Wr)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}},{key:"getOuterTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterTopRightCorner",value:function(){return Cn(this,Wr)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}},{key:"getOuterBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterBottomLeftCorner",value:function(){return Cn(this,Wr)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}},{key:"isCorner",value:function(r,n){return n&&n.includes(r)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(n.from.row,n.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(n.from.row,n.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(n.to.row,n.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(n.to.row,n.to.col)))?!0:r.isEqual(this.getOuterTopLeftCorner())||r.isEqual(this.getOuterTopRightCorner())||r.isEqual(this.getOuterBottomLeftCorner())||r.isEqual(this.getOuterBottomRightCorner())}},{key:"getOppositeCorner",value:function(r,n){if(!(r instanceof Qg))return!1;if(n){var o=n.from,i=n.to;if(n.includes(r)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(o.row,o.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(o.row,i.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(i.row,o.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(i.row,i.col)))return this.getOuterTopStartCorner()}}if(r.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(r.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(r.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(r.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}},{key:"getBordersSharedWith",value:function(r){if(!this.includesRange(r))return[];var n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},o={top:Math.min(r.from.row,r.to.row),bottom:Math.max(r.from.row,r.to.row),left:Math.min(r.from.col,r.to.col),right:Math.max(r.from.col,r.to.col)},i=[];return n.top===o.top&&i.push("top"),n.right===o.right&&i.push("right"),n.bottom===o.bottom&&i.push("bottom"),n.left===o.left&&i.push("left"),i}},{key:"getInner",value:function(){for(var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),o=[],i=r.row;i<=n.row;i++)for(var a=r.col;a<=n.col;a++)!(this.from.row===i&&this.from.col===a)&&!(this.to.row===i&&this.to.col===a)&&o.push(this._createCellCoords(i,a));return o}},{key:"getAll",value:function(){for(var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),o=[],i=r.row;i<=n.row;i++)for(var a=r.col;a<=n.col;a++)r.row===i&&r.col===a?o.push(r):n.row===i&&n.col===a?o.push(n):o.push(this._createCellCoords(i,a));return o}},{key:"forAll",value:function(r){for(var n=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner(),i=n.row;i<=o.row;i++)for(var a=n.col;a<=o.col;a++){var l=r(i,a);if(l===!1)return}}},{key:"clone",value:function(){return new e(this.highlight,this.from,this.to,Cn(this,Wr))}},{key:"toObject",value:function(){return{from:this.from.toObject(),to:this.to.toObject()}}},{key:"_createCellCoords",value:function(r,n){return new Qg(r,n,Cn(this,Wr))}}]),e}();const $E=Bue;var Vue=Ae,Wue=y0;Vue({target:"Object",stat:!0},{setPrototypeOf:Wue});var y2=Ue,Uue=qa,zue=Nt,Yue=Mt,xA=el,Gue=Vd,g2=Function,Kue=y2([].concat),que=y2([].join),Ew={},Xue=function(e,t,r){if(!Yue(Ew,t)){for(var n=[],o=0;o<t;o++)n[o]="a["+o+"]";Ew[t]=g2("C,a","return new C("+que(n,",")+")")}return Ew[t](e,r)},Zue=Gue?g2.bind:function(t){var r=Uue(this),n=r.prototype,o=xA(arguments,1),i=function(){var l=Kue(o,xA(arguments));return this instanceof i?Xue(r,l.length,l):r.apply(t,l)};return zue(n)&&(i.prototype=n),i},Jue=Ae,Que=jo,Tw=_f,efe=Zue,DA=dB,tfe=Ht,NA=Nt,rfe=tl,p2=je,AE=Que("Reflect","construct"),nfe=Object.prototype,ofe=[].push,m2=p2(function(){function e(){}return!(AE(function(){},[],e)instanceof e)}),b2=!p2(function(){AE(function(){})}),HA=m2||b2;Jue({target:"Reflect",stat:!0,forced:HA,sham:HA},{construct:function(t,r){DA(t),tfe(r);var n=arguments.length<3?t:DA(arguments[2]);if(b2&&!m2)return AE(t,r,n);if(t===n){switch(r.length){case 0:return new t;case 1:return new t(r[0]);case 2:return new t(r[0],r[1]);case 3:return new t(r[0],r[1],r[2]);case 4:return new t(r[0],r[1],r[2],r[3])}var o=[null];return Tw(ofe,o,r),new(Tw(efe,t,o))}var i=n.prototype,a=rfe(NA(i)?i:nfe),l=Tw(t,a,r);return NA(l)?l:a}});function eh(e){"@babel/helpers - typeof";return eh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eh(e)}function ife(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lfe(n.key),n)}}function afe(e,t,r){return t&&LA(e.prototype,t),r&&LA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lfe(e){var t=sfe(e,"string");return eh(t)==="symbol"?t:String(t)}function sfe(e,t){if(eh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(eh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pl=new WeakMap,ufe=function(){function e(t,r,n,o,i,a){var l=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;ife(this,e),this.wtSettings=n,this.domBindings=r,this.wtTable=i,this.selections=a,this.parent=l,this.eventManager=o,this.facadeGetter=t,pl.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}return afe(e,[{key:"registerEvents",value:function(){var r=this;this.eventManager.addEventListener(this.wtTable.holder,"contextmenu",function(i){return r.onContextMenu(i)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseover",function(i){return r.onMouseOver(i)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseout",function(i){return r.onMouseOut(i)});var n=function(){r.eventManager.addEventListener(r.wtTable.holder,"touchstart",function(a){return r.onTouchStart(a)}),r.eventManager.addEventListener(r.wtTable.holder,"touchend",function(a){return r.onTouchEnd(a)}),r.momentumScrolling||(r.momentumScrolling={}),r.eventManager.addEventListener(r.wtTable.holder,"scroll",function(){clearTimeout(r.momentumScrolling._timeout),r.momentumScrolling.ongoing||r.wtSettings.getSetting("onBeforeTouchScroll"),r.momentumScrolling.ongoing=!0,r.momentumScrolling._timeout=setTimeout(function(){r.touchApplied||(r.momentumScrolling.ongoing=!1,r.wtSettings.getSetting("onAfterMomentumScroll"))},200)})},o=function(){r.eventManager.addEventListener(r.wtTable.holder,"mouseup",function(a){return r.onMouseUp(a)}),r.eventManager.addEventListener(r.wtTable.holder,"mousedown",function(a){return r.onMouseDown(a)})};cn()?n():(V0()&&n(),o())}},{key:"selectedCellWasTouched",value:function(r){var n=pl.get(this),o=this.parentCell(r),i=o.coords;if(n.selectedCellBeforeTouchEnd&&i){var a=[i.row,n.selectedCellBeforeTouchEnd.from.row],l=a[0],s=a[1],u=[i.col,n.selectedCellBeforeTouchEnd.from.col],f=u[0],c=u[1];return l===s&&f===c}return!1}},{key:"parentCell",value:function(r){var n={},o=this.wtTable.TABLE,i=yc(r,["TD","TH"],o);return i?(n.coords=this.wtTable.getCoords(i),n.TD=i):xe(r,"wtBorder")&&xe(r,"current")?(n.coords=this.selections.getCell().cellRange.highlight,n.TD=this.wtTable.getCell(n.coords)):xe(r,"wtBorder")&&xe(r,"area")&&this.selections.createOrGetArea().cellRange&&(n.coords=this.selections.createOrGetArea().cellRange.to,n.TD=this.wtTable.getCell(n.coords)),n}},{key:"onMouseDown",value:function(r){var n=pl.get(this),o=this.domBindings.rootDocument.activeElement,i=CE(_V,r.target),a=r.target;if(!(a===o||i(0)===o||i(1)===o)){var l=this.parentCell(a);xe(a,"corner")?this.wtSettings.getSetting("onCellCornerMouseDown",r,a):l.TD&&this.wtSettings.has("onCellMouseDown")&&this.callListener("onCellMouseDown",r,l.coords,l.TD),(r.button===0||this.touchApplied)&&l.TD&&(n.dblClickOrigin[0]=l.TD,clearTimeout(n.dblClickTimeout[0]),n.dblClickTimeout[0]=setTimeout(function(){n.dblClickOrigin[0]=null},1e3))}}},{key:"onContextMenu",value:function(r){if(this.wtSettings.has("onCellContextMenu")){var n=this.parentCell(r.target);n.TD&&this.callListener("onCellContextMenu",r,n.coords,n.TD)}}},{key:"onMouseOver",value:function(r){if(this.wtSettings.has("onCellMouseOver")){var n=this.wtTable.TABLE,o=yc(r.target,["TD","TH"],n),i=this.parent||this;o&&o!==i.lastMouseOver&&vi(o,n)&&(i.lastMouseOver=o,this.callListener("onCellMouseOver",r,this.wtTable.getCoords(o),o))}}},{key:"onMouseOut",value:function(r){if(this.wtSettings.has("onCellMouseOut")){var n=this.wtTable.TABLE,o=yc(r.target,["TD","TH"],n),i=yc(r.relatedTarget,["TD","TH"],n),a=this.parent||this;o&&o!==i&&vi(o,n)&&(this.callListener("onCellMouseOut",r,this.wtTable.getCoords(o),o),i===null&&(a.lastMouseOver=null))}}},{key:"onMouseUp",value:function(r){var n=pl.get(this),o=this.parentCell(r.target);o.TD&&this.wtSettings.has("onCellMouseUp")&&this.callListener("onCellMouseUp",r,o.coords,o.TD),!(r.button!==0&&!this.touchApplied)&&(o.TD===n.dblClickOrigin[0]&&o.TD===n.dblClickOrigin[1]?(xe(r.target,"corner")?this.callListener("onCellCornerDblClick",r,o.coords,o.TD):this.callListener("onCellDblClick",r,o.coords,o.TD),n.dblClickOrigin[0]=null,n.dblClickOrigin[1]=null):o.TD===n.dblClickOrigin[0]&&(n.dblClickOrigin[1]=o.TD,clearTimeout(n.dblClickTimeout[1]),n.dblClickTimeout[1]=setTimeout(function(){n.dblClickOrigin[1]=null},500)))}},{key:"onTouchStart",value:function(r){var n=pl.get(this);n.selectedCellBeforeTouchEnd=this.selections.getCell().cellRange,this.touchApplied=!0,this.onMouseDown(r)}},{key:"onTouchEnd",value:function(r){var n,o=r.target,i=(n=this.parentCell(o))===null||n===void 0?void 0:n.coords,a=ve(i)&&i.row>=0&&i.col>=0,l=r.cancelable&&a&&this.wtSettings.getSetting("isDataViewInstance");if(l){var s=["A","BUTTON","INPUT"];Y0()&&(SB()||CB())&&this.selectedCellWasTouched(o)&&!s.includes(o.tagName)?r.preventDefault():this.selectedCellWasTouched(o)||r.preventDefault()}this.onMouseUp(r),this.touchApplied=!1}},{key:"callListener",value:function(r,n,o,i){var a=this.wtSettings.getSettingPure(r);a&&a(n,o,i,this.facadeGetter())}},{key:"destroy",value:function(){var r=pl.get(this);clearTimeout(r.dblClickTimeout[0]),clearTimeout(r.dblClickTimeout[1]),this.eventManager.destroy()}}]),e}();const w2=ufe;function th(e){"@babel/helpers - typeof";return th=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},th(e)}function ffe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hfe(n.key),n)}}function cfe(e,t,r){return t&&jA(e.prototype,t),r&&jA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hfe(e){var t=dfe(e,"string");return th(t)==="symbol"?t:String(t)}function dfe(e,t){if(th(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(th(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var vfe=function(){function e(t,r,n){ffe(this,e),this.offset=t,this.total=r,this.countTH=n}return cfe(e,[{key:"offsetted",value:function(r){return r+this.offset}},{key:"unOffsetted",value:function(r){return r-this.offset}},{key:"renderedToSource",value:function(r){return this.offsetted(r)}},{key:"sourceToRendered",value:function(r){return this.unOffsetted(r)}},{key:"offsettedTH",value:function(r){return r-this.countTH}},{key:"unOffsettedTH",value:function(r){return r+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(r){return this.renderedToSource(this.offsettedTH(r))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(r){return this.unOffsettedTH(this.sourceToRendered(r))}}]),e}();const yfe=vfe;function rh(e){"@babel/helpers - typeof";return rh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rh(e)}function gfe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mfe(n.key),n)}}function pfe(e,t,r){return t&&FA(e.prototype,t),r&&FA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mfe(e){var t=bfe(e,"string");return rh(t)==="symbol"?t:String(t)}function bfe(e,t){if(rh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wfe=function(){function e(t,r,n){gfe(this,e),this.offset=t,this.total=r,this.countTH=n}return pfe(e,[{key:"offsetted",value:function(r){return r+this.offset}},{key:"unOffsetted",value:function(r){return r-this.offset}},{key:"renderedToSource",value:function(r){return this.offsetted(r)}},{key:"sourceToRendered",value:function(r){return this.unOffsetted(r)}},{key:"offsettedTH",value:function(r){return r-this.countTH}},{key:"unOffsettedTH",value:function(r){return r+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(r){return this.renderedToSource(this.offsettedTH(r))}},{key:"sourceRowToVisibleColHeadedRow",value:function(r){return this.unOffsettedTH(this.sourceToRendered(r))}}]),e}();const Sfe=wfe;var Cfe=0,ep=1,tp=2;function nh(e){"@babel/helpers - typeof";return nh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nh(e)}function _fe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Rfe(n.key),n)}}function Ofe(e,t,r){return t&&BA(e.prototype,t),r&&BA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Rfe(e){var t=Efe(e,"string");return nh(t)==="symbol"?t:String(t)}function Efe(e,t){if(nh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var VA=function(){function e(){_fe(this,e),this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}return Ofe(e,[{key:"setSize",value:function(r){this.currentSize=this.nextSize,this.nextSize=r}},{key:"setOffset",value:function(r){this.currentOffset=this.nextOffset,this.nextOffset=r}}]),e}();function oh(e){"@babel/helpers - typeof";return oh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oh(e)}function Tfe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Pfe(n.key),n)}}function kfe(e,t,r){return t&&WA(e.prototype,t),r&&WA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Pfe(e){var t=$fe(e,"string");return oh(t)==="symbol"?t:String(t)}function $fe(e,t){if(oh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(oh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Afe=function(){function e(){Tfe(this,e),this.size=new VA,this.workingSpace=Cfe,this.sharedSize=null}return kfe(e,[{key:"setSize",value:function(r){this.size.setSize(r)}},{key:"setOffset",value:function(r){this.size.setOffset(r)}},{key:"getViewSize",value:function(){return this.size}},{key:"isShared",value:function(){return this.sharedSize instanceof VA}},{key:"isPlaceOn",value:function(r){return this.workingSpace===r}},{key:"append",value:function(r){this.workingSpace=ep,r.workingSpace=tp,this.sharedSize=r.getViewSize()}},{key:"prepend",value:function(r){this.workingSpace=tp,r.workingSpace=ep,this.sharedSize=r.getViewSize()}}]),e}();function ih(e){"@babel/helpers - typeof";return ih=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ih(e)}function Ife(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xfe(n.key),n)}}function Mfe(e,t,r){return t&&UA(e.prototype,t),r&&UA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xfe(e){var t=Dfe(e,"string");return ih(t)==="symbol"?t:String(t)}function Dfe(e,t){if(ih(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ih(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var S2=function(){function e(t,r,n){Ife(this,e),this.rootNode=t,this.nodesPool=r,this.sizeSet=new Afe,this.childNodeType=n.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}return Mfe(e,[{key:"setSize",value:function(r){return this.sizeSet.setSize(r),this}},{key:"setOffset",value:function(r){return this.sizeSet.setOffset(r),this}},{key:"isSharedViewSet",value:function(){return this.sizeSet.isShared()}},{key:"getNode",value:function(r){return r<this.collectedNodes.length?this.collectedNodes[r]:null}},{key:"getCurrentNode",value:function(){var r=this.collectedNodes.length;return r>0?this.collectedNodes[r-1]:null}},{key:"getRenderedChildCount",value:function(){var r=this.rootNode,n=this.sizeSet,o=0;if(this.isSharedViewSet())for(var i=r.firstElementChild;i;){if(i.tagName===this.childNodeType)o+=1;else if(n.isPlaceOn(ep))break;i=i.nextElementSibling}else o=r.childElementCount;return o}},{key:"start",value:function(){this.collectedNodes.length=0,this.visualIndex=0;for(var r=this.rootNode,n=this.sizeSet,o=this.isSharedViewSet(),i=n.getViewSize(),a=i.nextSize,l=this.getRenderedChildCount();l<a;){var s=this.nodesPool();!o||o&&n.isPlaceOn(tp)?r.appendChild(s):r.insertBefore(s,r.firstChild),l+=1}for(var u=o&&n.isPlaceOn(ep);l>a;)r.removeChild(u?r.firstChild:r.lastChild),l-=1}},{key:"render",value:function(){var r=this.rootNode,n=this.sizeSet,o=this.visualIndex;this.isSharedViewSet()&&n.isPlaceOn(tp)&&(o+=n.sharedSize.nextSize);var i=r.childNodes[o];if(i.tagName!==this.childNodeType){var a=this.nodesPool();r.replaceChild(a,i),i=a}this.collectedNodes.push(i),this.visualIndex+=1}},{key:"end",value:function(){}}]),e}();function ms(e){"@babel/helpers - typeof";return ms=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ms(e)}function Nfe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Lfe(n.key),n)}}function Hfe(e,t,r){return t&&zA(e.prototype,t),r&&zA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Lfe(e){var t=jfe(e,"string");return ms(t)==="symbol"?t:String(t)}function jfe(e,t){if(ms(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ms(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ffe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s_(e,t)}function s_(e,t){return s_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},s_(e,t)}function Bfe(e){var t=Ufe();return function(){var n=rp(e),o;if(t){var i=rp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Vfe(this,o)}}function Vfe(e,t){if(t&&(ms(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Wfe(e)}function Wfe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ufe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function rp(e){return rp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},rp(e)}var C2=function(e){Ffe(r,e);var t=Bfe(r);function r(){return Nfe(this,r),t.apply(this,arguments)}return Hfe(r,[{key:"prependView",value:function(o){return this.sizeSet.prepend(o.sizeSet),o.sizeSet.append(this.sizeSet),this}},{key:"appendView",value:function(o){return this.sizeSet.append(o.sizeSet),o.sizeSet.prepend(this.sizeSet),this}}]),r}(S2);function ah(e){"@babel/helpers - typeof";return ah=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ah(e)}function zfe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Gfe(n.key),n)}}function Yfe(e,t,r){return t&&YA(e.prototype,t),r&&YA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Gfe(e){var t=Kfe(e,"string");return ah(t)==="symbol"?t:String(t)}function Kfe(e,t){if(ah(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ah(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qfe=function(){function e(t){zfe(this,e),this.nodeType=t.toUpperCase()}return Yfe(e,[{key:"setRootDocument",value:function(r){this.rootDocument=r}},{key:"obtain",value:function(){return this.rootDocument.createElement(this.nodeType)}}]),e}();function lh(e){"@babel/helpers - typeof";return lh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lh(e)}function Xfe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Jfe(n.key),n)}}function Zfe(e,t,r){return t&&GA(e.prototype,t),r&&GA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jfe(e){var t=Qfe(e,"string");return lh(t)==="symbol"?t:String(t)}function Qfe(e,t){if(lh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ov=function(){function e(t,r){Xfe(this,e),this.nodesPool=typeof t=="string"?new qfe(t):null,this.nodeType=t,this.rootNode=r,this.table=null,this.renderedNodes=0}return Zfe(e,[{key:"setTable",value:function(r){this.nodesPool&&this.nodesPool.setRootDocument(r.rootDocument),this.table=r}},{key:"adjust",value:function(){}},{key:"render",value:function(){}}]),e}();function bs(e){"@babel/helpers - typeof";return bs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bs(e)}function ece(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rce(n.key),n)}}function tce(e,t,r){return t&&KA(e.prototype,t),r&&KA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rce(e){var t=nce(e,"string");return bs(t)==="symbol"?t:String(t)}function nce(e,t){if(bs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function oce(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u_(e,t)}function u_(e,t){return u_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},u_(e,t)}function ice(e){var t=sce();return function(){var n=np(e),o;if(t){var i=np(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return ace(this,o)}}function ace(e,t){if(t&&(bs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lce(e)}function lce(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sce(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function np(e){return np=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},np(e)}var uce=function(e){oce(r,e);var t=ice(r);function r(){var n;return ece(this,r),n=t.call(this,"TH"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return tce(r,[{key:"obtainOrderView",value:function(o){var i=this,a;return this.orderViews.has(o)?a=this.orderViews.get(o):(a=new C2(o,function(l){return i.nodesPool.obtain(i.sourceRowIndex,l)},this.nodeType),this.orderViews.set(o,a)),a}},{key:"render",value:function(){for(var o=this.table,i=o.rowsToRender,a=o.rowHeaderFunctions,l=o.rowHeadersCount,s=o.rows,u=o.cells,f=0;f<i;f++){var c=this.table.renderedRowToSource(f),h=s.getRenderedNode(f);this.sourceRowIndex=c;var d=this.obtainOrderView(h),v=u.obtainOrderView(h);d.appendView(v).setSize(l).setOffset(this.table.renderedColumnToSource(0)).start();for(var g=0;g<l;g++){d.render();var m=d.getCurrentNode();m.className="",m.removeAttribute("style"),a[g](c,m,g)}d.end()}}}]),r}(Ov);function ws(e){"@babel/helpers - typeof";return ws=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ws(e)}function fce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hce(n.key),n)}}function cce(e,t,r){return t&&qA(e.prototype,t),r&&qA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hce(e){var t=dce(e,"string");return ws(t)==="symbol"?t:String(t)}function dce(e,t){if(ws(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ws(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vce(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f_(e,t)}function f_(e,t){return f_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},f_(e,t)}function yce(e){var t=mce();return function(){var n=op(e),o;if(t){var i=op(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return gce(this,o)}}function gce(e,t){if(t&&(ws(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pce(e)}function pce(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mce(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function op(e){return op=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},op(e)}var bce=function(e){vce(r,e);var t=yce(r);function r(n){return fce(this,r),t.call(this,null,n)}return cce(r,[{key:"adjust",value:function(){var o=this.table,i=o.columnHeadersCount,a=o.rowHeadersCount,l=this.rootNode.firstChild;if(i){for(var s=this.table.columnsToRender,u=s+a,f=0,c=i;f<c;f++){for(l=this.rootNode.childNodes[f],l||(l=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(l)),this.renderedNodes=l.childNodes.length;this.renderedNodes<u;)l.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>u;)l.removeChild(l.lastChild),this.renderedNodes-=1}var h=this.rootNode.childNodes.length;if(h>i)for(var d=i;d<h;d++)this.rootNode.removeChild(this.rootNode.lastChild)}else l&&gn(l)}},{key:"render",value:function(){for(var o=this.table.columnHeadersCount,i=0;i<o;i+=1)for(var a=this.table,l=a.columnHeaderFunctions,s=a.columnsToRender,u=a.rowHeadersCount,f=this.rootNode.childNodes[i],c=-1*u;c<s;c+=1){var h=this.table.renderedColumnToSource(c),d=f.childNodes[c+u];d.className="",d.removeAttribute("style"),l[i](h,d,i)}}}]),r}(Ov);function Ss(e){"@babel/helpers - typeof";return Ss=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ss(e)}function wce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Cce(n.key),n)}}function Sce(e,t,r){return t&&XA(e.prototype,t),r&&XA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Cce(e){var t=_ce(e,"string");return Ss(t)==="symbol"?t:String(t)}function _ce(e,t){if(Ss(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ss(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Oce(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c_(e,t)}function c_(e,t){return c_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},c_(e,t)}function Rce(e){var t=kce();return function(){var n=ip(e),o;if(t){var i=ip(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Ece(this,o)}}function Ece(e,t){if(t&&(Ss(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Tce(e)}function Tce(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kce(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ip(e){return ip=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ip(e)}var Pce=function(e){Oce(r,e);var t=Rce(r);function r(n){return wce(this,r),t.call(this,null,n)}return Sce(r,[{key:"adjust",value:function(){for(var o=this.table,i=o.columnsToRender,a=o.rowHeadersCount,l=i+a;this.renderedNodes<l;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>l;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}},{key:"render",value:function(){this.adjust();for(var o=this.table,i=o.columnsToRender,a=o.rowHeadersCount,l=0;l<a;l++){var s=this.table.renderedColumnToSource(l),u=this.table.columnUtils.getHeaderWidth(s);this.rootNode.childNodes[l].style.width="".concat(u,"px")}for(var f=0;f<i;f++){var c=this.table.renderedColumnToSource(f),h=this.table.columnUtils.getStretchedColumnWidth(c);this.rootNode.childNodes[f+a].style.width="".concat(h,"px")}var d=this.rootNode.firstChild;d&&re(d,"rowHeader")}}]),r}(Ov);function Cs(e){"@babel/helpers - typeof";return Cs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cs(e)}var ZA;function $ce(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Ace(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Mce(n.key),n)}}function Ice(e,t,r){return t&&JA(e.prototype,t),r&&JA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Mce(e){var t=xce(e,"string");return Cs(t)==="symbol"?t:String(t)}function xce(e,t){if(Cs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Dce(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h_(e,t)}function h_(e,t){return h_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},h_(e,t)}function Nce(e){var t=jce();return function(){var n=ap(e),o;if(t){var i=ap(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Hce(this,o)}}function Hce(e,t){if(t&&(Cs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Lce(e)}function Lce(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jce(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ap(e){return ap=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ap(e)}var QA=!1,Fce=function(e){Dce(r,e);var t=Nce(r);function r(n){var o;return Ace(this,r),o=t.call(this,"TR",n),o.orderView=new S2(n,function(i){return o.nodesPool.obtain(i)},o.nodeType),o}return Ice(r,[{key:"getRenderedNode",value:function(o){return this.orderView.getNode(o)}},{key:"render",value:function(){var o=this.table.rowsToRender;!QA&&o>1e3&&(QA=!0,ht(ft(ZA||(ZA=$ce([`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting 
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`],[`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`]))))),this.orderView.setSize(o).setOffset(this.table.renderedRowToSource(0)).start();for(var i=0;i<o;i++)this.orderView.render();this.orderView.end()}}]),r}(Ov);function _s(e){"@babel/helpers - typeof";return _s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_s(e)}function Bce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Wce(n.key),n)}}function Vce(e,t,r){return t&&eI(e.prototype,t),r&&eI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Wce(e){var t=Uce(e,"string");return _s(t)==="symbol"?t:String(t)}function Uce(e,t){if(_s(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_s(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zce(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d_(e,t)}function d_(e,t){return d_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},d_(e,t)}function Yce(e){var t=qce();return function(){var n=lp(e),o;if(t){var i=lp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Gce(this,o)}}function Gce(e,t){if(t&&(_s(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Kce(e)}function Kce(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qce(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function lp(e){return lp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},lp(e)}var Xce=function(e){zce(r,e);var t=Yce(r);function r(){var n;return Bce(this,r),n=t.call(this,"TD"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return Vce(r,[{key:"obtainOrderView",value:function(o){var i=this,a;return this.orderViews.has(o)?a=this.orderViews.get(o):(a=new C2(o,function(l){return i.nodesPool.obtain(i.sourceRowIndex,l)},this.nodeType),this.orderViews.set(o,a)),a}},{key:"render",value:function(){for(var o=this.table,i=o.rowsToRender,a=o.columnsToRender,l=o.rows,s=o.rowHeaders,u=0;u<i;u++){var f=this.table.renderedRowToSource(u),c=l.getRenderedNode(u);this.sourceRowIndex=f;var h=this.obtainOrderView(c),d=s.obtainOrderView(c);h.prependView(d).setSize(a).setOffset(this.table.renderedColumnToSource(0)).start();for(var v=0;v<a;v++){h.render();var g=h.getCurrentNode(),m=this.table.renderedColumnToSource(v);xe(g,"hide")||(g.className=""),g.removeAttribute("style"),g.removeAttribute("dir"),this.table.cellRenderer(f,m,g)}h.end()}}}]),r}(Ov);function sh(e){"@babel/helpers - typeof";return sh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sh(e)}function Zce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Qce(n.key),n)}}function Jce(e,t,r){return t&&tI(e.prototype,t),r&&tI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Qce(e){var t=ehe(e,"string");return sh(t)==="symbol"?t:String(t)}function ehe(e,t){if(sh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var the=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.cellRenderer;Zce(this,e),this.rootNode=t,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=n}return Jce(e,[{key:"setAxisUtils",value:function(r,n){this.rowUtils=r,this.columnUtils=n}},{key:"setViewportSize",value:function(r,n){this.rowsToRender=r,this.columnsToRender=n}},{key:"setFilters",value:function(r,n){this.rowFilter=r,this.columnFilter=n}},{key:"setHeaderContentRenderers",value:function(r,n){this.rowHeaderFunctions=r,this.rowHeadersCount=r.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}},{key:"setRenderers",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=r.rowHeaders,o=r.columnHeaders,i=r.colGroup,a=r.rows,l=r.cells;n.setTable(this),o.setTable(this),i.setTable(this),a.setTable(this),l.setTable(this),this.rowHeaders=n,this.columnHeaders=o,this.colGroup=i,this.rows=a,this.cells=l}},{key:"renderedRowToSource",value:function(r){return this.rowFilter.renderedToSource(r)}},{key:"renderedColumnToSource",value:function(r){return this.columnFilter.renderedToSource(r)}},{key:"render",value:function(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();for(var r=this.rowsToRender,n=this.rows,o=0;o<r;o++){var i=n.getRenderedNode(o);if(i.firstChild){var a=this.renderedRowToSource(o),l=this.rowUtils.getHeight(a);l?i.firstChild.style.height="".concat(l-1,"px"):i.firstChild.style.height=""}}}}]),e}();function uh(e){"@babel/helpers - typeof";return uh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uh(e)}function rhe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ohe(n.key),n)}}function nhe(e,t,r){return t&&rI(e.prototype,t),r&&rI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ohe(e){var t=ihe(e,"string");return uh(t)==="symbol"?t:String(t)}function ihe(e,t){if(uh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(uh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ahe=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.TABLE,n=t.THEAD,o=t.COLGROUP,i=t.TBODY,a=t.rowUtils,l=t.columnUtils,s=t.cellRenderer;rhe(this,e),this.renderer=new the(r,{cellRenderer:s}),this.renderer.setRenderers({rowHeaders:new uce,columnHeaders:new bce(n),colGroup:new Pce(o),rows:new Fce(i),cells:new Xce}),this.renderer.setAxisUtils(a,l)}return nhe(e,[{key:"setFilters",value:function(r,n){return this.renderer.setFilters(r,n),this}},{key:"setViewportSize",value:function(r,n){return this.renderer.setViewportSize(r,n),this}},{key:"setHeaderContentRenderers",value:function(r,n){return this.renderer.setHeaderContentRenderers(r,n),this}},{key:"adjust",value:function(){this.renderer.adjust()}},{key:"render",value:function(){this.renderer.render()}}]),e}();function fh(e){"@babel/helpers - typeof";return fh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fh(e)}function lhe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uhe(n.key),n)}}function she(e,t,r){return t&&nI(e.prototype,t),r&&nI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uhe(e){var t=fhe(e,"string");return fh(t)==="symbol"?t:String(t)}function fhe(e,t){if(fh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var che=function(){function e(t,r){lhe(this,e),this.dataAccessObject=t,this.wtSettings=r,this.headerWidths=new Map}return she(e,[{key:"getWidth",value:function(r){return this.wtSettings.getSetting("columnWidth",r)||this.wtSettings.getSetting("defaultColumnWidth")}},{key:"getStretchedColumnWidth",value:function(r){var n=this.dataAccessObject.wtViewport.columnsRenderCalculator,o=this.getWidth(r);if(n){var i=n.getStretchedColumnWidth(r,o);i&&(o=i)}return o}},{key:"getHeaderHeight",value:function(r){var n=this.wtSettings.getSetting("defaultRowHeight"),o=this.dataAccessObject.wtViewport.oversizedColumnHeaders[r];return o!==void 0&&(n=n?Math.max(n,o):o),n}},{key:"getHeaderWidth",value:function(r){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(r))}},{key:"calculateWidths",value:function(){var r=this.wtSettings,n=this.dataAccessObject,o=n.wtTable,i=n.wtViewport,a=n.cloneSource,l=a?a.wtTable.holder:o.holder,s=l.offsetHeight<l.scrollHeight?Xt():0,u=r.getSetting("rowHeaderWidth");if(i.columnsRenderCalculator.refreshStretching(i.getViewportWidth()-s),u=r.getSetting("onModifyRowHeaderWidth",u),u!=null)for(var f=r.getSetting("rowHeaders").length,c=r.getSetting("defaultColumnWidth"),h=0;h<f;h++){var d=Array.isArray(u)?u[h]:u;d=d??c,this.headerWidths.set(h,d)}}}]),e}();function ch(e){"@babel/helpers - typeof";return ch=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ch(e)}function hhe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vhe(n.key),n)}}function dhe(e,t,r){return t&&oI(e.prototype,t),r&&oI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vhe(e){var t=yhe(e,"string");return ch(t)==="symbol"?t:String(t)}function yhe(e,t){if(ch(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ch(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ghe=function(){function e(t,r){hhe(this,e),this.dataAccessObject=t,this.wtSettings=r}return dhe(e,[{key:"getHeight",value:function(r){var n=this.wtSettings.getSetting("rowHeight",r),o=this.dataAccessObject.wtViewport.oversizedRows[r];return o!==void 0&&(n=n===void 0?o:Math.max(n,o)),n}}]),e}();function hh(e){"@babel/helpers - typeof";return hh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hh(e)}function phe(e){return whe(e)||bhe(e)||_2(e)||mhe()}function mhe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bhe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function whe(e){if(Array.isArray(e))return v_(e)}function She(e,t){return Ohe(e)||_he(e,t)||_2(e,t)||Che()}function Che(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _2(e,t){if(e){if(typeof e=="string")return v_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return v_(e,t)}}function v_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _he(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Ohe(e){if(Array.isArray(e))return e}function Rhe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,O2(n.key),n)}}function Ehe(e,t,r){return t&&iI(e.prototype,t),r&&iI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _n(e,t,r){return t=O2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function O2(e){var t=The(e,"string");return hh(t)==="symbol"?t:String(t)}function The(e,t){if(hh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var khe=function(){function e(t,r,n,o,i){var a=this;Rhe(this,e),_n(this,"wtSettings",null),_n(this,"domBindings",void 0),_n(this,"TBODY",null),_n(this,"THEAD",null),_n(this,"COLGROUP",null),_n(this,"hasTableHeight",!0),_n(this,"hasTableWidth",!0),_n(this,"isTableVisible",!1),_n(this,"tableOffset",0),_n(this,"holderOffset",0),this.domBindings=n,this.isMaster=i==="master",this.name=i,this.dataAccessObject=t,this.facadeGetter=r,this.wtSettings=o,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,mE(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;var l=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",function(){return a._modifyRowHeaderWidth(l)}),this.rowUtils=new ghe(this.dataAccessObject,this.wtSettings),this.columnUtils=new che(this.dataAccessObject,this.wtSettings),this.tableRenderer=new ahe({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}return Ehe(e,[{key:"is",value:function(r){return this.name===r}},{key:"fixTableDomTree",value:function(){var r=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=r.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=r.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=r.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}},{key:"createSpreader",value:function(r){var n=r.parentNode,o;return(!n||n.nodeType!==Node.ELEMENT_NODE||!xe(n,"wtHolder"))&&(o=this.domBindings.rootDocument.createElement("div"),o.className="wtSpreader",n&&n.insertBefore(o,r),o.appendChild(r)),o.style.position="relative",o}},{key:"createHider",value:function(r){var n=r.parentNode,o;return(!n||n.nodeType!==Node.ELEMENT_NODE||!xe(n,"wtHolder"))&&(o=this.domBindings.rootDocument.createElement("div"),o.className="wtHider",n&&n.insertBefore(o,r),o.appendChild(r)),o}},{key:"createHolder",value:function(r){var n=r.parentNode,o;return(!n||n.nodeType!==Node.ELEMENT_NODE||!xe(n,"wtHolder"))&&(o=this.domBindings.rootDocument.createElement("div"),o.style.position="relative",o.className="wtHolder",n&&n.insertBefore(o,r),this.isMaster&&(o.parentNode.className+="ht_master handsontable",o.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr")),o.appendChild(r)),o}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wtSettings,o=this.dataAccessObject,i=o.wtOverlays,a=o.wtViewport,l=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),u=n.getSetting("rowHeaders"),f=u.length,c=n.getSetting("columnHeaders"),h=c.length,d=!1,v=r;if(this.isMaster&&(this.holderOffset=Vt(this.holder),v=a.createRenderCalculators(v),f&&!n.getSetting("fixedColumnsStart"))){var g=i.inlineStartOverlay.getScrollPosition(),m=this.correctHeaderWidth;this.correctHeaderWidth=g!==0,m!==this.correctHeaderWidth&&(v=!1)}if(this.isMaster&&(d=i.updateStateOfRendering()),v)this.isMaster&&a.createVisibleCalculators(),i&&i.refresh(!0);else{this.isMaster?this.tableOffset=Vt(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;var w=l>0?this.getFirstRenderedRow():0,S=s>0?this.getFirstRenderedColumn():0;this.rowFilter=new Sfe(w,l,h),this.columnFilter=new yfe(S,s,f);var C=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();var k={};this.wtSettings.getSetting("beforeDraw",!0,k),C=k.skipRender!==!0}if(C){this.tableRenderer.setHeaderContentRenderers(u,c),(this.is(Nn)||this.is(yi))&&this.tableRenderer.setHeaderContentRenderers(u,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();var R;if(this.isMaster&&(R=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Nn))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();var V=dt(this.hider),U=dt(this.TABLE);V!==0&&U!==V&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),R!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(Nn)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}var X=!1;return this.isMaster&&(X=i.topOverlay.resetFixedPosition(),i.bottomOverlay.clone&&(X=i.bottomOverlay.resetFixedPosition()||X),X=i.inlineStartOverlay.resetFixedPosition()||X,i.topInlineStartCornerOverlay&&i.topInlineStartCornerOverlay.resetFixedPosition(),i.bottomInlineStartCornerOverlay&&i.bottomInlineStartCornerOverlay.clone&&i.bottomInlineStartCornerOverlay.resetFixedPosition()),X?(i.refreshAll(),i.adjustElementsSize()):this.refreshSelections(v),d&&i.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}},{key:"markIfOversizedColumnHeader",value:function(r){for(var n=this.columnFilter.renderedToSource(r),o=this.wtSettings.getSetting("columnHeaders").length,i=this.wtSettings.getSetting("defaultRowHeight"),a,l,s,u=this.wtSettings.getSetting("columnHeaderHeight")||[];o;)o-=1,a=this.getColumnHeaderHeight(o),l=this.getColumnHeader(n,o),l&&(s=lo(l),(!a&&i<s||a<s)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=s),Array.isArray(u)?u[o]!==null&&u[o]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=u[o]):isNaN(u)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=u),this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]<(u[o]||u)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=u[o]||u))}},{key:"adjustColumnHeaderHeights",value:function(){for(var r=this.wtSettings,n=this.THEAD.childNodes,o=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=r.getSetting("columnHeaders"),a=0,l=i.length;a<l;a++)if(o[a]){if(!n[a]||n[a].childNodes.length===0)return;n[a].childNodes[0].style.height="".concat(o[a],"px")}}},{key:"resetOversizedRows",value:function(){var r=this.wtSettings,n=this.dataAccessObject.wtViewport;if(!(!this.isMaster&&!this.is(Nn))&&!r.getSetting("externalRowCalculator"))for(var o=this.getRenderedRowsCount(),i=0;i<o;i++){var a=this.rowFilter.renderedToSource(i);n.oversizedRows&&n.oversizedRows[a]&&(n.oversizedRows[a]=void 0)}}},{key:"removeClassFromCells",value:function(r){for(var n=this.TABLE.querySelectorAll(".".concat(r)),o=0,i=n.length;o<i;o++)Le(n[o],r)}},{key:"refreshSelections",value:function(r){var n=this.wtSettings,o=this.dataAccessObject.selections;if(o){var i=Array.from(o),a=i.length;if(r){for(var l=[],s=0;s<a;s++){for(var u=i[s].settings,f=u.highlightHeaderClassName,c=u.highlightRowClassName,h=u.highlightColumnClassName,d=i[s].classNames,v=d.length,g=0;g<v;g++)l.includes(d[g])||l.push(d[g]);f&&!l.includes(f)&&l.push(f),c&&!l.includes(c)&&l.push(c),h&&!l.includes(h)&&l.push(h)}var m=n.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(m))for(var w=0;w<m.length;w++)l.push(m[w]);for(var S=l.length,C=0;C<S;C++)this.removeClassFromCells(l[C])}for(var k=0;k<a;k++)i[k].draw(this.facadeGetter(),r)}}},{key:"getCell",value:function(r){var n=r.row,o=r.col,i=this.wtSettings.getSetting("onModifyGetCellCoords",n,o);if(i&&Array.isArray(i)){var a=She(i,2);n=a[0],o=a[1]}if(this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(o))return-3;if(this.isColumnAfterRenderedColumns(o))return-4;var l=this.getRow(n);if(!l&&n>=0)throw new Error("TR was expected to be rendered but is not");var s=l.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(o)];if(!s&&o>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}},{key:"getRow",value:function(r){var n=null,o=null;if(r<0){var i;n=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(r),o=this.THEAD}else{var a;n=(a=this.rowFilter)===null||a===void 0?void 0:a.sourceToRendered(r),o=this.TBODY}return n!==void 0&&o!==void 0?o.childNodes.length<n+1?!1:o.childNodes[n]:!1}},{key:"getColumnHeader",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=this.THEAD.childNodes[n];return o==null?void 0:o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)]}},{key:"getColumnHeaders",value:function(r){var n=[],o=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r);return this.THEAD.childNodes.forEach(function(i){var a=i.childNodes[o];a&&n.push(a)}),n}},{key:"getRowHeader",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)!==0){var o=this.wtSettings.getSetting("rowHeaders").length;if(!(n>=o)){var i=this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)];return i==null?void 0:i.childNodes[n]}}}},{key:"getRowHeaders",value:function(r){if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)===0)return[];for(var n=[],o=this.wtSettings.getSetting("rowHeaders").length,i=0;i<o;i++){var a=this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)],l=a==null?void 0:a.childNodes[i];l&&n.push(l)}return n}},{key:"getCoords",value:function(r){var n=r;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=di(n,["TD","TH"])),n===null)return null;var o=n.parentNode,i=o.parentNode,a=RV(o),l=n.cellIndex;if(ni(Fa,n,this.wtRootElement)||ni(La,n,this.wtRootElement))i.nodeName==="THEAD"&&(a-=i.childNodes.length);else if(ni(yi,n,this.wtRootElement)||ni(Nn,n,this.wtRootElement)){var s=this.wtSettings.getSetting("totalRows");a=s-i.childNodes.length+a}else i===this.THEAD?a=this.rowFilter.visibleColHeadedRowToSourceRow(a):a=this.rowFilter.renderedToSource(a);return ni(Fa,n,this.wtRootElement)||ni(ja,n,this.wtRootElement)||ni(yi,n,this.wtRootElement)?l=this.columnFilter.offsettedTH(l):l=this.columnFilter.visibleRowHeadedColumnToSourceColumn(l),this.wot.createCellCoords(a,l)}},{key:"markOversizedRows",value:function(){if(!this.wtSettings.getSetting("externalRowCalculator")){var r=this.TBODY.childNodes.length,n=r*this.wtSettings.getSetting("defaultRowHeight"),o=lo(this.TBODY)-1,i,a,l,s,u;if(!(n===o&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;r;)r-=1,l=this.rowFilter.renderedToSource(r),i=this.getRowHeight(l),s=this.getTrForRow(l),u=s.querySelector("th"),u?a=lo(u):a=lo(s)-1,(!i&&this.wtSettings.getSetting("defaultRowHeight")<a||i<a)&&(a+=1,this.dataAccessObject.wtViewport.oversizedRows[l]=a)}}},{key:"getTrForRow",value:function(r){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)]}},{key:"isColumnHeaderRendered",value:function(r){if(r>=0)return!1;var n=this.wtSettings.getSetting("rowHeaders"),o=n.length;return Math.abs(r)<=o}},{key:"isRowHeaderRendered",value:function(r){if(r>=0)return!1;var n=this.wtSettings.getSetting("columnHeaders"),o=n.length;return Math.abs(r)<=o}},{key:"isRowBeforeRenderedRows",value:function(r){var n=this.getFirstRenderedRow();return r<0&&n<=0?!this.isRowHeaderRendered(r):r<n}},{key:"isRowAfterRenderedRows",value:function(r){return r>this.getLastRenderedRow()}},{key:"isColumnBeforeRenderedColumns",value:function(r){var n=this.getFirstRenderedColumn();return r<0&&n<=0?!this.isColumnHeaderRendered(r):r<n}},{key:"isColumnAfterRenderedColumns",value:function(r){return this.columnFilter&&r>this.getLastRenderedColumn()}},{key:"isColumnAfterViewport",value:function(r){return this.columnFilter&&r>this.getLastVisibleColumn()}},{key:"isRowAfterViewport",value:function(r){return this.rowFilter&&r>this.getLastVisibleRow()}},{key:"isColumnBeforeViewport",value:function(r){return this.columnFilter&&this.columnFilter.sourceToRendered(r)<0&&r>=0}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"allRowsInViewport",value:function(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}},{key:"allColumnsInViewport",value:function(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}},{key:"getRowHeight",value:function(r){return this.rowUtils.getHeight(r)}},{key:"getColumnHeaderHeight",value:function(r){return this.columnUtils.getHeaderHeight(r)}},{key:"getColumnWidth",value:function(r){return this.columnUtils.getWidth(r)}},{key:"getStretchedColumnWidth",value:function(r){return this.columnUtils.getStretchedColumnWidth(r)}},{key:"hasDefinedSize",value:function(){return this.hasTableHeight&&this.hasTableWidth}},{key:"getWidth",value:function(){return dt(this.TABLE)}},{key:"getHeight",value:function(){return Rt(this.TABLE)}},{key:"getTotalWidth",value:function(){var r=dt(this.hider);return r!==0?r:this.getWidth()}},{key:"getTotalHeight",value:function(){var r=Rt(this.hider);return r!==0?r:this.getHeight()}},{key:"isVisible",value:function(){return vs(this.TABLE)}},{key:"_modifyRowHeaderWidth",value:function(r){var n=bt(r)?r():null;return Array.isArray(n)?(n=phe(n),n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}},{key:"_correctRowHeaderWidth",value:function(r){var n=r;return typeof r!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}]),e}();const kf=khe;var Phe="stickyRowsBottom",R2={getFirstRenderedRow:function(){var t=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsBottom"),n=t-r;return t===0||r===0?-1:n<0?0:n},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Bn(R2,"MIXIN_NAME",Phe,{writable:!1,enumerable:!1});const E2=R2;var $he="stickyColumnsStart",T2={getFirstRenderedColumn:function(){var t=this.wtSettings.getSetting("totalColumns");return t===0?-1:0},getFirstVisibleColumn:function(){return this.getFirstRenderedColumn()},getLastRenderedColumn:function(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn:function(){return this.getLastRenderedColumn()},getRenderedColumnsCount:function(){var t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount:function(){return this.getRenderedColumnsCount()}};Bn(T2,"MIXIN_NAME",$he,{writable:!1,enumerable:!1});const IE=T2;function Os(e){"@babel/helpers - typeof";return Os=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Os(e)}function aI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ihe(n.key),n)}}function Ahe(e,t,r){return t&&aI(e.prototype,t),r&&aI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ihe(e){var t=Mhe(e,"string");return Os(t)==="symbol"?t:String(t)}function Mhe(e,t){if(Os(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Os(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xhe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Dhe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y_(e,t)}function y_(e,t){return y_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},y_(e,t)}function Nhe(e){var t=jhe();return function(){var n=sp(e),o;if(t){var i=sp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Hhe(this,o)}}function Hhe(e,t){if(t&&(Os(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Lhe(e)}function Lhe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jhe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function sp(e){return sp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},sp(e)}var ME=function(e){Dhe(r,e);var t=Nhe(r);function r(n,o,i,a){return xhe(this,r),t.call(this,n,o,i,a,yi)}return Ahe(r)}(kf);pt(ME,E2);pt(ME,IE);const Fhe=ME;var La="top",Nn="bottom",ja="inline_start",Fa="top_inline_start_corner",yi="bottom_inline_start_corner",Bhe=[La,Nn,ja,Fa,yi],Vhe=new Map([[La,"ht_clone_".concat(La)],[Nn,"ht_clone_".concat(Nn)],[ja,"ht_clone_".concat(ja," ht_clone_left")],[Fa,"ht_clone_".concat(Fa," ht_clone_top_left_corner")],[yi,"ht_clone_".concat(yi," ht_clone_bottom_left_corner")]]);function dh(e){"@babel/helpers - typeof";return dh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dh(e)}function Whe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,k2(n.key),n)}}function Uhe(e,t,r){return t&&lI(e.prototype,t),r&&lI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kw(e,t,r){return t=k2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function k2(e){var t=zhe(e,"string");return dh(t)==="symbol"?t:String(t)}function zhe(e,t){if(dh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(dh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Yhe=function(){function e(t){Whe(this,e),kw(this,"dataAccessObject",void 0),kw(this,"lastScrolledColumnPos",-1),kw(this,"lastScrolledRowPos",-1),this.dataAccessObject=t}return Uhe(e,[{key:"scrollViewport",value:function(r,n,o,i,a){var l=this.scrollViewportHorizontally(r.col,o,a),s=this.scrollViewportVertically(r.row,n,i);return l||s}},{key:"scrollViewportHorizontally",value:function(r,n,o){var i=this.dataAccessObject,a=i.drawn,l=i.totalColumns;if(!a||!Number.isInteger(r)||r<0||r>l)return!1;var s=this.getFirstVisibleColumn(),u=this.getLastVisibleColumn(),f=n===void 0&&o===void 0,c=this.dataAccessObject,h=c.fixedColumnsStart,d=c.inlineStartOverlay;if(f&&r<h)return!1;var v=!1;return s===-1?v=d.scrollTo(r,f?r>this.lastScrolledColumnPos:n):(f&&(r<s||r>u)||!f)&&(v=d.scrollTo(r,f?r>u:n)),v&&(this.lastScrolledColumnPos=r),v}},{key:"scrollViewportVertically",value:function(r,n,o){var i=this.dataAccessObject,a=i.drawn,l=i.totalRows;if(!a||!Number.isInteger(r)||r<0||r>l)return!1;var s=this.getFirstVisibleRow(),u=this.getLastVisibleRow(),f=n===void 0&&o===void 0,c=this.dataAccessObject,h=c.fixedRowsBottom,d=c.fixedRowsTop,v=c.topOverlay;if(f&&(r<d||r>l-h-1))return!1;var g=!1;return s===-1?g=v.scrollTo(r,f?r>this.lastScrolledRowPos:o):(f&&(r<s||r>u)||!f)&&(g=v.scrollTo(r,f?r>u:o)),g&&(this.lastScrolledRowPos=r),g}},{key:"getFirstVisibleRow",value:function(){var r=this.dataAccessObject,n=r.topOverlay,o=r.wtTable,i=r.wtViewport,a=r.totalRows,l=r.fixedRowsTop,s=r.rootWindow,u=o.getFirstVisibleRow();if(n.mainTableScrollableElement===s){var f=Vt(o.wtRootElement),c=lo(o.hider),h=lo(s),d=Uc(s,s);if(f.top+c-h<=d){var v=i.getColumnHeaderHeight();v+=n.sumCellSizes(0,l);for(var g=a;g>0;g--)if(v+=n.sumCellSizes(g-1,g),f.top+c-v<=d){u=g;break}}}return u}},{key:"getLastVisibleRow",value:function(){var r=this.dataAccessObject,n=r.topOverlay,o=r.wtTable,i=r.wtViewport,a=r.totalRows,l=r.rootWindow,s=o.getLastVisibleRow();if(n.mainTableScrollableElement===l){var u=Vt(o.wtRootElement),f=Uc(l,l);if(u.top>f){for(var c=lo(l),h=i.getColumnHeaderHeight(),d=1;d<=a;d++)if(h+=n.sumCellSizes(d-1,d),u.top+h-f>=c){s=d-2;break}}}return s}},{key:"getFirstVisibleColumn",value:function(){var r=this.dataAccessObject,n=r.inlineStartOverlay,o=r.wtTable,i=r.wtViewport,a=r.totalColumns,l=r.rootWindow,s=o.getFirstVisibleColumn();if(n.mainTableScrollableElement===l){var u=Vt(o.wtRootElement),f=Rc(o.hider),c=Rc(l),h=Math.abs(Kg(l,l));if(u.left+f-c<=h){for(var d=i.getRowHeaderWidth(),v=a;v>0;v--)if(d+=n.sumCellSizes(v-1,v),u.left+f-d<=h){s=v;break}}}return s}},{key:"getLastVisibleColumn",value:function(){var r=this.dataAccessObject,n=r.wtSettings,o=r.inlineStartOverlay,i=r.wtTable,a=r.wtViewport,l=r.totalColumns,s=r.rootWindow,u=i.getLastVisibleColumn();if(o.mainTableScrollableElement===s){var f=n.getSetting("rtlMode"),c=null;if(f){var h=i.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document,v=d.documentElement.offsetWidth;c=Math.abs(h.right-v)}else{var g=Vt(i.wtRootElement);c=g.left}var m=Math.abs(Kg(s,s));if(c>m){for(var w=Rc(s),S=a.getRowHeaderWidth(),C=1;C<=l;C++)if(S+=o.sumCellSizes(C-1,C),c+S-m>=w){u=C-2;break}}}return u}}]),e}();const Ghe=Yhe;function vh(e){"@babel/helpers - typeof";return vh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vh(e)}function Khe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,P2(n.key),n)}}function qhe(e,t,r){return t&&sI(e.prototype,t),r&&sI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rn(e,t,r){return t=P2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function P2(e){var t=Xhe(e,"string");return vh(t)==="symbol"?t:String(t)}function Xhe(e,t){if(vh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xE=function(){function e(t,r){Khe(this,e),rn(this,"wtTable",void 0),rn(this,"wtScroll",void 0),rn(this,"wtViewport",void 0),rn(this,"wtOverlays",void 0),rn(this,"selections",void 0),rn(this,"wtEvent",void 0),rn(this,"guid","wt_".concat(yE())),rn(this,"drawInterrupted",!1),rn(this,"drawn",!1),rn(this,"domBindings",void 0),rn(this,"wtSettings",void 0),this.domBindings={rootTable:t,rootDocument:t.ownerDocument,rootWindow:t.ownerDocument.defaultView},this.wtSettings=r,this.wtScroll=new Ghe(this.createScrollDao())}return qhe(e,[{key:"eventManager",get:function(){return new Tt(this)}},{key:"findOriginalHeaders",value:function(){var r=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var n=0,o=this.wtTable.THEAD.childNodes[0].childNodes.length;n<o;n++)r.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(i,a){Ei(a,r[i])}])}}},{key:"createCellCoords",value:function(r,n){return new Qg(r,n,this.wtSettings.getSetting("rtlMode"))}},{key:"createCellRange",value:function(r,n,o){return new $E(r,n,o,this.wtSettings.getSetting("rtlMode"))}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!r&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(r),this}},{key:"getCell",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!n)return this.wtTable.getCell(r);var o=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),a=this.wtSettings.getSetting("fixedRowsBottom"),l=this.wtSettings.getSetting("fixedColumnsStart");if(r.row<i&&r.col<l)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(r);if(r.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(r);if(r.col<l&&r.row>=o-a){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(r)}else{if(r.col<l)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(r);if(r.row<o&&r.row>=o-a&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(r)}return this.wtTable.getCell(r)}},{key:"scrollViewport",value:function(r,n,o,i,a){return r.col<0||r.row<0?!1:this.wtScroll.scrollViewport(r,n,o,i,a)}},{key:"scrollViewportHorizontally",value:function(r,n,o){return r<0?!1:this.wtScroll.scrollViewportHorizontally(r,n,o)}},{key:"scrollViewportVertically",value:function(r,n,o){return r<0?!1:this.wtScroll.scrollViewportVertically(r,n,o)}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"destroy",value:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}},{key:"createScrollDao",value:function(){var r=this;return{get drawn(){return r.drawn},get topOverlay(){return r.wtOverlays.topOverlay},get inlineStartOverlay(){return r.wtOverlays.inlineStartOverlay},get wtTable(){return r.wtTable},get wtViewport(){return r.wtViewport},get wtSettings(){return r.wtSettings},get rootWindow(){return r.domBindings.rootWindow},get totalRows(){return r.wtSettings.getSetting("totalRows")},get totalColumns(){return r.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return r.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return r.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return r.wtSettings.getSetting("fixedColumnsStart")}}}},{key:"getTableDao",value:function(){var r=this;return{get wot(){return r},get parentTableOffset(){return r.cloneSource.wtTable.tableOffset},get cloneSource(){return r.cloneSource},get workspaceWidth(){return r.wtViewport.getWorkspaceWidth()},get wtViewport(){return r.wtViewport},get wtOverlays(){return r.wtOverlays},get selections(){return r.selections},get drawn(){return r.drawn},set drawn(n){r.drawn=n},get wtTable(){return r.wtTable},get startColumnRendered(){return r.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return r.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return r.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return r.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return r.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return r.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return r.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return r.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return r.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return r.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return r.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return r.wtViewport.rowsVisibleCalculator.count}}}}]),e}();function Rs(e){"@babel/helpers - typeof";return Rs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rs(e)}function uI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$2(n.key),n)}}function Zhe(e,t,r){return t&&uI(e.prototype,t),r&&uI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jhe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Qhe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g_(e,t)}function g_(e,t){return g_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},g_(e,t)}function ede(e){var t=rde();return function(){var n=up(e),o;if(t){var i=up(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return tde(this,o)}}function tde(e,t){if(t&&(Rs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lg(e)}function lg(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rde(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function up(e){return up=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},up(e)}function fI(e,t,r){return t=$2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $2(e){var t=nde(e,"string");return Rs(t)==="symbol"?t:String(t)}function nde(e,t){if(Rs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ode=function(e){Qhe(r,e);var t=ede(r);function r(n,o,i){var a;Jhe(this,r),a=t.call(this,n,o),fI(lg(a),"cloneSource",void 0),fI(lg(a),"cloneOverlay",void 0);var l=a.wtSettings.getSetting("facade",lg(a));return a.cloneSource=i.source,a.cloneOverlay=i.overlay,a.wtTable=a.cloneOverlay.createTable(a.getTableDao(),l,a.domBindings,a.wtSettings),a.wtViewport=i.viewport,a.selections=i.selections,a.wtEvent=new w2(l,a.domBindings,a.wtSettings,a.eventManager,a.wtTable,a.selections,i.event),a.findOriginalHeaders(),a}return Zhe(r)}(xE);function yh(e){"@babel/helpers - typeof";return yh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yh(e)}function ide(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,A2(n.key),n)}}function ade(e,t,r){return t&&cI(e.prototype,t),r&&cI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lde(e,t,r){return t=A2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function A2(e){var t=sde(e,"string");return yh(t)==="symbol"?t:String(t)}function sde(e,t){if(yh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Rv=function(){function e(t,r,n,o,i){ide(this,e),lde(this,"wtSettings",null),Bn(this,"wot",t,{writable:!1}),this.domBindings=i,this.facadeGetter=r,this.wtSettings=o;var a=this.wot.wtTable,l=a.TABLE,s=a.hider,u=a.spreader,f=a.holder,c=a.wtRootElement;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=l,this.hider=s,this.spreader=u,this.holder=f,this.wtRootElement=c,this.trimmingContainer=Ha(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}return ade(e,[{key:"updateStateOfRendering",value:function(){var r=this.needFullRender;this.needFullRender=this.shouldBeRendered();var n=r!==this.needFullRender;return n&&!this.needFullRender&&this.reset(),n}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateTrimmingContainer",value:function(){this.trimmingContainer=Ha(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function(){var r=this.wot.wtTable,n=this.domBindings.rootWindow;n.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=zc(r.TABLE)}},{key:"getRelativeCellPosition",value:function(r,n,o){if(this.clone.wtTable.holder.contains(r)===!1){ht("The provided element is not a child of the ".concat(this.type," overlay"));return}var i=this.mainTableScrollableElement===this.domBindings.rootWindow,a=o<this.wtSettings.getSetting("fixedColumnsStart"),l=n<this.wtSettings.getSetting("fixedRowsTop"),s=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),u=this.clone.wtTable.spreader,f={start:this.getRelativeStartPosition(u),top:u.offsetTop},c={start:this.getRelativeStartPosition(r),top:r.offsetTop},h=null;return i?h=this.getRelativeCellPositionWithinWindow(l,a,c,f):h=this.getRelativeCellPositionWithinHolder(l,s,a,c,f),h}},{key:"getRelativeStartPosition",value:function(r){return this.isRtl()?r.offsetParent.offsetWidth-r.offsetLeft-r.offsetWidth:r.offsetLeft}},{key:"getRelativeCellPositionWithinWindow",value:function(r,n,o,i){var a=this.wot.wtTable.wtRootElement.getBoundingClientRect(),l=0,s=0;if(!n)l=i.start;else{var u=a.left;this.isRtl()&&(u=this.domBindings.rootWindow.innerWidth-(a.left+a.width+Xt())),l=u<=0?-1*u:0}if(r){var f=this.clone.wtTable.TABLE.getBoundingClientRect();s=f.top-a.top}else s=i.top;return{start:o.start+l,top:o.top+s}}},{key:"getRelativeCellPositionWithinHolder",value:function(r,n,o,i,a){var l={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()},s=0,u=0;if(o||(s=l.horizontal-a.start),n){var f=this.wot.wtTable.wtRootElement.getBoundingClientRect(),c=this.clone.wtTable.TABLE.getBoundingClientRect();u=c.top*-1+f.top}else r||(u=l.vertical-a.top);return{start:i.start-s,top:i.top-u}}},{key:"makeClone",value:function(){if(Bhe.indexOf(this.type)===-1)throw new Error('Clone type "'.concat(this.type,'" is not supported.'));var r=this.wot.wtTable,n=this.domBindings,o=n.rootDocument,i=n.rootWindow,a=o.createElement("DIV"),l=o.createElement("TABLE"),s=r.wtRootElement.parentNode;a.className="".concat(Vhe.get(this.type)," handsontable"),a.setAttribute("dir",this.isRtl()?"rtl":"ltr"),a.style.position="absolute",a.style.top=0,a.style.overflow="visible",this.isRtl()?a.style.right=0:a.style.left=0,l.className=r.TABLE.className,a.appendChild(l),s.appendChild(a);var u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===La||u==="vertical"&&this.type===ja?this.mainTableScrollableElement=i:i.getComputedStyle(s).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=r.holder:this.mainTableScrollableElement=zc(r.TABLE),new ode(l,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selections:this.wot.selections})}},{key:"refresh",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.shouldBeRendered();this.clone&&(this.needFullRender||n)&&this.clone.draw(r),this.needFullRender=n}},{key:"reset",value:function(){if(this.clone){var r=this.clone.wtTable.holder,n=this.clone.wtTable.hider,o=r.style,i=n.style,a=r.parentNode.style;$([o,i,a],function(l){l.width="",l.height=""})}}},{key:"isRtl",value:function(){return this.wtSettings.getSetting("rtlMode")}},{key:"destroy",value:function(){this.clone.eventManager.destroy()}}]),e}();function Es(e){"@babel/helpers - typeof";return Es=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Es(e)}function sg(e,t,r){return I2()?sg=Reflect.construct.bind():sg=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&fp(u,a.prototype),u},sg.apply(null,arguments)}function ude(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cde(n.key),n)}}function fde(e,t,r){return t&&hI(e.prototype,t),r&&hI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cde(e){var t=hde(e,"string");return Es(t)==="symbol"?t:String(t)}function hde(e,t){if(Es(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Es(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dde(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fp(e,t)}function fp(e,t){return fp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},fp(e,t)}function vde(e){var t=I2();return function(){var n=cp(e),o;if(t){var i=cp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return yde(this,o)}}function yde(e,t){if(t&&(Es(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gde(e)}function gde(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function I2(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function cp(e){return cp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},cp(e)}var pde=function(e){dde(r,e);var t=vde(r);function r(n,o,i,a,l,s){var u;return ude(this,r),u=t.call(this,n,o,yi,i,a),u.bottomOverlay=l,u.inlineStartOverlay=s,u}return fde(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return sg(Fhe,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var o=this.wot;if(this.updateTrimmingContainer(),!o.wtTable.holder.parentNode)return!1;var i=this.clone.wtTable.holder.parentNode;if(i.style.top="",this.trimmingContainer===this.domBindings.rootWindow){var a=this.inlineStartOverlay.getOverlayOffset(),l=this.bottomOverlay.getOverlayOffset();i.style[this.isRtl()?"right":"left"]="".concat(a,"px"),i.style.bottom="".concat(l,"px")}else mv(i),this.repositionOverlay();var s=Rt(this.clone.wtTable.TABLE),u=dt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(s=0),i.style.height="".concat(s,"px"),i.style.width="".concat(u,"px"),!1}},{key:"repositionOverlay",value:function(){var o=this.wot,i=o.wtTable,a=o.wtViewport,l=this.domBindings.rootDocument,s=this.clone.wtTable.holder.parentNode,u=0;a.hasVerticalScroll()||(u+=a.getWorkspaceHeight()-i.getTotalHeight()),a.hasVerticalScroll()&&a.hasHorizontalScroll()&&(u+=Xt(l)),s.style.bottom="".concat(u,"px")}}]),r}(Rv),mde="calculatedColumns",M2={getFirstRenderedColumn:function(){var t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn:function(){var t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getLastRenderedColumn:function(){var t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn:function(){var t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getRenderedColumnsCount:function(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount:function(){return this.dataAccessObject.countColumnsVisible}};Bn(M2,"MIXIN_NAME",mde,{writable:!1,enumerable:!1});const DE=M2;function Ts(e){"@babel/helpers - typeof";return Ts=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ts(e)}function dI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wde(n.key),n)}}function bde(e,t,r){return t&&dI(e.prototype,t),r&&dI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wde(e){var t=Sde(e,"string");return Ts(t)==="symbol"?t:String(t)}function Sde(e,t){if(Ts(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ts(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Cde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _de(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p_(e,t)}function p_(e,t){return p_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},p_(e,t)}function Ode(e){var t=Tde();return function(){var n=hp(e),o;if(t){var i=hp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Rde(this,o)}}function Rde(e,t){if(t&&(Ts(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ede(e)}function Ede(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Tde(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function hp(e){return hp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},hp(e)}var NE=function(e){_de(r,e);var t=Ode(r);function r(n,o,i,a){return Cde(this,r),t.call(this,n,o,i,a,Nn)}return bde(r)}(kf);pt(NE,E2);pt(NE,DE);const kde=NE;function ks(e){"@babel/helpers - typeof";return ks=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ks(e)}function ug(e,t,r){return D2()?ug=Reflect.construct.bind():ug=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&dp(u,a.prototype),u},ug.apply(null,arguments)}function Pde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,N2(n.key),n)}}function $de(e,t,r){return t&&vI(e.prototype,t),r&&vI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ade(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dp(e,t)}function dp(e,t){return dp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},dp(e,t)}function Ide(e){var t=D2();return function(){var n=vp(e),o;if(t){var i=vp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Mde(this,o)}}function Mde(e,t){if(t&&(ks(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return x2(e)}function x2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function D2(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vp(e){return vp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vp(e)}function xde(e,t,r){return t=N2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function N2(e){var t=Dde(e,"string");return ks(t)==="symbol"?t:String(t)}function Dde(e,t){if(ks(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ks(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Nde=function(e){Ade(r,e);var t=Ide(r);function r(n,o,i,a){var l;return Pde(this,r),l=t.call(this,n,o,Nn,i,a),xde(x2(l),"cachedFixedRowsBottom",-1),l.cachedFixedRowsBottom=l.wtSettings.getSetting("fixedRowsBottom"),l}return $de(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return ug(kde,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var o=this.domBindings.rootWindow,i=this.clone.wtTable.holder.parentNode;i.style.top="";var a=0,l=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===o&&(!l||l!=="vertical")?(a=this.getOverlayOffset(),i.style.bottom="".concat(a,"px")):(a=this.getScrollPosition(),this.repositionOverlay());var s=this.adjustHeaderBordersPosition(a);return this.adjustElementsSize(),s}},{key:"repositionOverlay",value:function(){var o=this.wot,i=o.wtTable,a=o.wtViewport,l=this.domBindings.rootDocument,s=this.clone.wtTable.holder.parentNode,u=0;a.hasVerticalScroll()||(u+=a.getWorkspaceHeight()-i.getTotalHeight()),a.hasVerticalScroll()&&a.hasHorizontalScroll()&&(u+=Xt(l)),s.style.bottom="".concat(u,"px")}},{key:"setScrollPosition",value:function(o){var i=this.domBindings.rootWindow,a=!1;return this.mainTableScrollableElement===i?(i.scrollTo(Na(i),o),a=!0):this.mainTableScrollableElement.scrollTop!==o&&(this.mainTableScrollableElement.scrollTop=o,a=!0),a}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(o,i){for(var a=this.wot,l=a.wtTable,s=a.wtSettings,u=s.getSetting("defaultRowHeight"),f=o,c=0;f<i;){var h=l.getRowHeight(f);c+=h===void 0?u:h,f+=1}return c}},{key:"adjustElementsSize",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||o)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var o=this.wot,i=o.wtTable,a=o.wtViewport,l=this.domBindings,s=l.rootDocument,u=l.rootWindow,f=Xt(s),c=this.clone.wtTable.holder.parentNode,h=c.style,d=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==u||d==="horizontal"){var v=a.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(v-=f),v=Math.min(v,i.wtRootElement.scrollWidth),h.width="".concat(v,"px")}else h.width="";this.clone.wtTable.holder.style.width=h.width;var g=Rt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(g=0),h.height="".concat(g,"px")}},{key:"adjustRootChildrenSize",value:function(){var o=this.clone.wtTable.holder;this.clone.wtTable.hider.style.width=this.hider.style.width,o.style.width=o.parentNode.style.width,o.style.height=o.parentNode.style.height}},{key:"applyToDOM",value:function(){var o=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(o===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var o=this.isRtl()?"right":"left",i=this.clone.wtTable.spreader;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?i.style[o]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):i.style[o]=""}},{key:"scrollTo",value:function(o,i){var a=this.getTableParentOffset(),l=this.wot.cloneSource?this.wot.cloneSource:this.wot,s=l.wtTable.holder,u=0;i&&s.offsetHeight!==s.clientHeight&&(u=Xt(this.domBindings.rootDocument)),i?(a+=this.sumCellSizes(0,o+1),a-=this.wot.wtViewport.getViewportHeight(),a+=1):a+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),o),a+=u,this.setScrollPosition(a)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return Uc(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var o=this.domBindings.rootWindow,i=this.wtSettings.getSetting("preventOverflow"),a=0;if(this.trimmingContainer===o&&(!i||i!=="vertical")){var l=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),u=l-s,f=this.domBindings.rootDocument.documentElement.clientHeight;a=Math.max(this.getTableParentOffset()-this.getScrollPosition()-f+l,0),a>u&&(a=0)}return a}},{key:"adjustHeaderBordersPosition",value:function(o){var i=this.wtSettings.getSetting("fixedRowsBottom"),a=this.cachedFixedRowsBottom!==i,l=this.wtSettings.getSetting("columnHeaders"),s=!1;if((a||i===0)&&l.length>0){var u=this.wot.wtTable.holder.parentNode,f=xe(u,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),o||this.wtSettings.getSetting("totalRows")===0?(re(u,"innerBorderBottom"),s=!f):(Le(u,"innerBorderBottom"),s=f)}return s}}]),r}(Rv),Hde="calculatedRows",H2={getFirstRenderedRow:function(){var t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow:function(){var t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getLastRenderedRow:function(){var t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow:function(){var t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getRenderedRowsCount:function(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount:function(){return this.dataAccessObject.countRowsVisible}};Bn(H2,"MIXIN_NAME",Hde,{writable:!1,enumerable:!1});const L2=H2;function Ps(e){"@babel/helpers - typeof";return Ps=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ps(e)}function yI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jde(n.key),n)}}function Lde(e,t,r){return t&&yI(e.prototype,t),r&&yI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jde(e){var t=Fde(e,"string");return Ps(t)==="symbol"?t:String(t)}function Fde(e,t){if(Ps(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ps(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Bde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Vde(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m_(e,t)}function m_(e,t){return m_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},m_(e,t)}function Wde(e){var t=Yde();return function(){var n=yp(e),o;if(t){var i=yp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Ude(this,o)}}function Ude(e,t){if(t&&(Ps(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zde(e)}function zde(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Yde(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yp(e){return yp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yp(e)}var HE=function(e){Vde(r,e);var t=Wde(r);function r(n,o,i,a){return Bde(this,r),t.call(this,n,o,i,a,ja)}return Lde(r)}(kf);pt(HE,L2);pt(HE,IE);const Gde=HE;function $s(e){"@babel/helpers - typeof";return $s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$s(e)}function fg(e,t,r){return j2()?fg=Reflect.construct.bind():fg=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&gp(u,a.prototype),u},fg.apply(null,arguments)}function Kde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Xde(n.key),n)}}function qde(e,t,r){return t&&gI(e.prototype,t),r&&gI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Xde(e){var t=Zde(e,"string");return $s(t)==="symbol"?t:String(t)}function Zde(e,t){if($s(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($s(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Jde(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gp(e,t)}function gp(e,t){return gp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},gp(e,t)}function Qde(e){var t=j2();return function(){var n=pp(e),o;if(t){var i=pp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return eve(this,o)}}function eve(e,t){if(t&&($s(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tve(e)}function tve(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function j2(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function pp(e){return pp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},pp(e)}var rve=function(e){Jde(r,e);var t=Qde(r);function r(n,o,i,a){return Kde(this,r),t.call(this,n,o,ja,i,a)}return qde(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return fg(Gde,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var o=this.wot.wtTable;if(!this.needFullRender||!o.holder.parentNode)return!1;var i=this.domBindings.rootWindow,a=this.clone.wtTable.holder.parentNode,l=this.wtSettings.getSetting("preventOverflow"),s=0;this.trimmingContainer===i&&(!l||l!=="horizontal")?(s=this.getOverlayOffset()*(this.isRtl()?-1:1),Dm(a,"".concat(s,"px"),"0px")):(s=this.getScrollPosition(),mv(a));var u=this.adjustHeaderBordersPosition(s);return this.adjustElementsSize(),u}},{key:"setScrollPosition",value:function(o){var i=this.domBindings.rootWindow,a=!1;return this.isRtl()&&(o=-o),this.mainTableScrollableElement===i&&i.scrollX!==o?(i.scrollTo(o,ys(i)),a=!0):this.mainTableScrollableElement.scrollLeft!==o&&(this.mainTableScrollableElement.scrollLeft=o,a=!0),a}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(o,i){for(var a=this.wtSettings.getSetting("defaultColumnWidth"),l=o,s=0;l<i;)s+=this.wot.wtTable.getStretchedColumnWidth(l)||a,l+=1;return s}},{key:"adjustElementsSize",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||o)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var o=this.wot.wtTable,i=this.domBindings,a=i.rootDocument,l=i.rootWindow,s=Xt(a),u=this.clone.wtTable.holder.parentNode,f=u.style,c=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==l||c==="vertical"){var h=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(h-=s),h=Math.min(h,o.wtRootElement.scrollHeight),f.height="".concat(h,"px")}else f.height="";this.clone.wtTable.holder.style.height=f.height;var d=dt(this.clone.wtTable.TABLE);f.width="".concat(d,"px")}},{key:"adjustRootChildrenSize",value:function(){var o,i=this.clone.wtTable.holder,a=this.wot.selections,l=this.facadeGetter(),s=Math.abs((o=a==null?void 0:a.getCell().getBorder(l).cornerCenterPointOffset)!==null&&o!==void 0?o:0);this.clone.wtTable.hider.style.height=this.hider.style.height,i.style.height=i.parentNode.style.height,i.style.width="".concat(parseInt(i.parentNode.style.width,10)+s,"px")}},{key:"applyToDOM",value:function(){var o=this.wtSettings.getSetting("totalColumns"),i=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[i]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px");else if(o===0)this.spreader.style[i]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.top=""}},{key:"scrollTo",value:function(o,i){var a=this.getTableParentOffset(),l=this.wot.cloneSource?this.wot.cloneSource:this.wot,s=l.wtTable.holder,u=0;if(i){var f=this.wot.wtTable.getColumnWidth(o),c=this.wot.wtViewport.getViewportWidth();f>c&&(i=!1)}return i&&s.offsetWidth!==s.clientWidth&&(u=Xt(this.domBindings.rootDocument)),i?(a+=this.sumCellSizes(0,o+1),a-=this.wot.wtViewport.getViewportWidth()):a+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),o),a+=u,this.setScrollPosition(a)}},{key:"getTableParentOffset",value:function(){var o=this.wtSettings.getSetting("preventOverflow"),i=0;return!o&&this.trimmingContainer===this.domBindings.rootWindow&&(i=this.wot.wtTable.holderOffset.left),i}},{key:"getScrollPosition",value:function(){return Math.abs(Kg(this.mainTableScrollableElement,this.domBindings.rootWindow))}},{key:"getOverlayOffset",value:function(){var o=this.domBindings.rootWindow,i=this.wtSettings.getSetting("preventOverflow"),a=0;if(this.trimmingContainer===o&&(!i||i!=="horizontal")){this.isRtl()?a=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):a=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);var l=this.wot.wtTable.getTotalWidth(),s=this.clone.wtTable.getTotalWidth(),u=l-s;a>u&&(a=0)}return a}},{key:"adjustHeaderBordersPosition",value:function(o){var i=this.wot.wtTable.holder.parentNode,a=this.wtSettings.getSetting("rowHeaders"),l=this.wtSettings.getSetting("fixedColumnsStart"),s=this.wtSettings.getSetting("totalRows");s?Le(i,"emptyRows"):re(i,"emptyRows");var u=!1;if(l&&!a.length)re(i,"innerBorderLeft innerBorderInlineStart");else if(!l&&a.length){var f=xe(i,"innerBorderInlineStart");o?(re(i,"innerBorderLeft innerBorderInlineStart"),u=!f):(Le(i,"innerBorderLeft innerBorderInlineStart"),u=f)}return u}}]),r}(Rv),nve="stickyRowsTop",F2={getFirstRenderedRow:function(){var t=this.wtSettings.getSetting("totalRows");return t===0?-1:0},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.getRenderedRowsCount()-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Bn(F2,"MIXIN_NAME",nve,{writable:!1,enumerable:!1});const B2=F2;function As(e){"@babel/helpers - typeof";return As=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},As(e)}function pI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ive(n.key),n)}}function ove(e,t,r){return t&&pI(e.prototype,t),r&&pI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ive(e){var t=ave(e,"string");return As(t)==="symbol"?t:String(t)}function ave(e,t){if(As(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(As(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sve(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b_(e,t)}function b_(e,t){return b_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},b_(e,t)}function uve(e){var t=hve();return function(){var n=mp(e),o;if(t){var i=mp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return fve(this,o)}}function fve(e,t){if(t&&(As(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cve(e)}function cve(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hve(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mp(e){return mp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},mp(e)}var LE=function(e){sve(r,e);var t=uve(r);function r(n,o,i,a){return lve(this,r),t.call(this,n,o,i,a,Fa)}return ove(r)}(kf);pt(LE,B2);pt(LE,IE);const dve=LE;function Is(e){"@babel/helpers - typeof";return Is=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Is(e)}function cg(e,t,r){return V2()?cg=Reflect.construct.bind():cg=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&bp(u,a.prototype),u},cg.apply(null,arguments)}function vve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,W2(n.key),n)}}function yve(e,t,r){return t&&mI(e.prototype,t),r&&mI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gve(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bp(e,t)}function bp(e,t){return bp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},bp(e,t)}function pve(e){var t=V2();return function(){var n=wp(e),o;if(t){var i=wp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return mve(this,o)}}function mve(e,t){if(t&&(Is(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return w_(e)}function w_(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function V2(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wp(e){return wp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wp(e)}function bI(e,t,r){return t=W2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function W2(e){var t=bve(e,"string");return Is(t)==="symbol"?t:String(t)}function bve(e,t){if(Is(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Is(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wve=function(e){gve(r,e);var t=pve(r);function r(n,o,i,a,l,s){var u;return vve(this,r),u=t.call(this,n,o,Fa,i,a),bI(w_(u),"topOverlay",void 0),bI(w_(u),"inlineStartOverlay",void 0),u.topOverlay=l,u.inlineStartOverlay=s,u}return yve(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return cg(dve,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;var o=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){var i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),a=this.topOverlay.getOverlayOffset();Dm(o,"".concat(i,"px"),"".concat(a,"px"))}else mv(o);var l=Rt(this.clone.wtTable.TABLE),s=dt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(l=0),o.style.height="".concat(l,"px"),o.style.width="".concat(s,"px"),!1}}]),r}(Rv);function Ms(e){"@babel/helpers - typeof";return Ms=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ms(e)}function wI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Cve(n.key),n)}}function Sve(e,t,r){return t&&wI(e.prototype,t),r&&wI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Cve(e){var t=_ve(e,"string");return Ms(t)==="symbol"?t:String(t)}function _ve(e,t){if(Ms(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ms(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ove(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Rve(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&S_(e,t)}function S_(e,t){return S_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},S_(e,t)}function Eve(e){var t=Pve();return function(){var n=Sp(e),o;if(t){var i=Sp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Tve(this,o)}}function Tve(e,t){if(t&&(Ms(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kve(e)}function kve(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Pve(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Sp(e){return Sp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Sp(e)}var jE=function(e){Rve(r,e);var t=Eve(r);function r(n,o,i,a){return Ove(this,r),t.call(this,n,o,i,a,La)}return Sve(r)}(kf);pt(jE,B2);pt(jE,DE);const $ve=jE;function xs(e){"@babel/helpers - typeof";return xs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xs(e)}function hg(e,t,r){return z2()?hg=Reflect.construct.bind():hg=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&Cp(u,a.prototype),u},hg.apply(null,arguments)}function Ave(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Y2(n.key),n)}}function Ive(e,t,r){return t&&SI(e.prototype,t),r&&SI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Mve(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Cp(e,t)}function Cp(e,t){return Cp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Cp(e,t)}function xve(e){var t=z2();return function(){var n=_p(e),o;if(t){var i=_p(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Dve(this,o)}}function Dve(e,t){if(t&&(xs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return U2(e)}function U2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function z2(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _p(e){return _p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_p(e)}function Nve(e,t,r){return t=Y2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Y2(e){var t=Hve(e,"string");return xs(t)==="symbol"?t:String(t)}function Hve(e,t){if(xs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Lve=function(e){Mve(r,e);var t=xve(r);function r(n,o,i,a){var l;return Ave(this,r),l=t.call(this,n,o,La,i,a),Nve(U2(l),"cachedFixedRowsTop",-1),l.cachedFixedRowsTop=l.wtSettings.getSetting("fixedRowsTop"),l}return Ive(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return hg($ve,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var o=this.clone.wtTable.holder.parentNode,i=this.domBindings.rootWindow,a=this.wtSettings.getSetting("preventOverflow"),l=0,s=!1;if(this.trimmingContainer===i&&(!a||a!=="vertical")){var u=this.wot.wtTable,f=u.hider.getBoundingClientRect(),c=Math.ceil(f.bottom),h=o.offsetHeight;s=c===h,l=this.getOverlayOffset(),Dm(o,"0px","".concat(l,"px"))}else l=this.getScrollPosition(),mv(o);var d=this.adjustHeaderBordersPosition(l,s);return this.adjustElementsSize(),d}},{key:"setScrollPosition",value:function(o){var i=this.domBindings.rootWindow,a=!1;return this.mainTableScrollableElement===i&&i.scrollY!==o?(i.scrollTo(Na(i),o),a=!0):this.mainTableScrollableElement.scrollTop!==o&&(this.mainTableScrollableElement.scrollTop=o,a=!0),a}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(o,i){for(var a=this.wtSettings.getSetting("defaultRowHeight"),l=o,s=0;l<i;){var u=this.wot.wtTable.getRowHeight(l);s+=u===void 0?a:u,l+=1}return s}},{key:"adjustElementsSize",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||o)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var o=this.wot.wtTable,i=this.domBindings,a=i.rootDocument,l=i.rootWindow,s=Xt(a),u=this.clone.wtTable.holder.parentNode,f=u.style,c=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==l||c==="horizontal"){var h=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(h-=s),h=Math.min(h,o.wtRootElement.scrollWidth),f.width="".concat(h,"px")}else f.width="";this.clone.wtTable.holder.style.width=f.width;var d=Rt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(d=0),f.height="".concat(d,"px")}},{key:"adjustRootChildrenSize",value:function(){var o,i=this.clone.wtTable.holder,a=this.wot.selections,l=this.facadeGetter(),s=Math.abs((o=a==null?void 0:a.getCell().getBorder(l).cornerCenterPointOffset)!==null&&o!==void 0?o:0);this.clone.wtTable.hider.style.width=this.hider.style.width,i.style.width=i.parentNode.style.width,i.style.height="".concat(parseInt(i.parentNode.style.height,10)+s,"px")}},{key:"applyToDOM",value:function(){var o=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(o===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var o=this.isRtl()?"right":"left",i=this.clone.wtTable.spreader;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?i.style[o]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):i.style[o]=""}},{key:"scrollTo",value:function(o,i){var a=this.wot,l=this.wtSettings,s=a.cloneSource?a.cloneSource:a,u=s.wtTable.holder,f=this.getTableParentOffset(),c=0;if(i){var h=this.wot.wtTable.getRowHeight(o),d=this.wot.wtViewport.getViewportHeight();h>d&&(i=!1)}if(i&&u.offsetHeight!==u.clientHeight&&(c=Xt(this.domBindings.rootDocument)),i){var v=l.getSetting("fixedRowsBottom"),g=l.getSetting("totalRows");f+=this.sumCellSizes(0,o+1),f-=a.wtViewport.getViewportHeight()-this.sumCellSizes(g-v,g),f+=1}else f+=this.sumCellSizes(l.getSetting("fixedRowsTop"),o);return f+=c,this.setScrollPosition(f)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return Uc(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var o=this.domBindings.rootWindow,i=this.wtSettings.getSetting("preventOverflow"),a=0;if(this.trimmingContainer===o&&(!i||i!=="vertical")){var l=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),u=l-s;a=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),a>u&&(a=0)}return a}},{key:"adjustHeaderBordersPosition",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=this.wot.wtTable.holder.parentNode,l=this.wtSettings.getSetting("totalColumns");l?Le(a,"emptyColumns"):re(a,"emptyColumns");var s=!1;if(!i){var u=this.wtSettings.getSetting("fixedRowsTop"),f=this.cachedFixedRowsTop!==u,c=this.wtSettings.getSetting("columnHeaders");if((f||u===0)&&c.length>0){var h=xe(a,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),o||this.wtSettings.getSetting("totalRows")===0?(re(a,"innerBorderTop"),s=!h):(Le(a,"innerBorderTop"),s=h)}}return s}}]),r}(Rv);function gh(e){"@babel/helpers - typeof";return gh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gh(e)}function ai(e,t,r){return jve()?ai=Reflect.construct.bind():ai=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&C_(u,a.prototype),u},ai.apply(null,arguments)}function jve(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function C_(e,t){return C_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},C_(e,t)}function Fve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,G2(n.key),n)}}function Bve(e,t,r){return t&&CI(e.prototype,t),r&&CI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Gn(e,t,r){return t=G2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function G2(e){var t=Vve(e,"string");return gh(t)==="symbol"?t:String(t)}function Vve(e,t){if(gh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Wve=function(){function e(t,r,n,o,i,a){var l=this;Fve(this,e),Gn(this,"wot",null),Gn(this,"topOverlay",null),Gn(this,"bottomOverlay",null),Gn(this,"inlineStartOverlay",null),Gn(this,"topInlineStartCornerOverlay",null),Gn(this,"bottomInlineStartCornerOverlay",null),Gn(this,"browserLineHeight",void 0),Gn(this,"wtSettings",null),Gn(this,"resizeObserver",new ResizeObserver(function(h){bm(function(){!Array.isArray(h)||!h.length||l.wtSettings.getSetting("onContainerElementResize")})})),this.wot=t,this.wtSettings=o,this.domBindings=n,this.facadeGetter=r,this.wtTable=a;var s=this.domBindings,u=s.rootDocument,f=s.rootWindow;this.instance=this.wot,this.eventManager=i,this.scrollbarSize=Xt(u);var c=f.getComputedStyle(a.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=c?a.holder:zc(a.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=f.scrollX,this.lastScrollY=f.scrollY}return Bve(e,[{key:"getOverlays",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return r&&n.push(this.wtTable),n}},{key:"initBrowserLineHeight",value:function(){var r=this.domBindings,n=r.rootWindow,o=r.rootDocument,i=n.getComputedStyle(o.body),a=parseInt(i.lineHeight,10),l=parseInt(i.fontSize,10)*1.2;this.browserLineHeight=a||l}},{key:"initOverlays",value:function(){var r=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=ai(Lve,r),this.bottomOverlay=ai(Nde,r),this.inlineStartOverlay=ai(rve,r),this.topInlineStartCornerOverlay=ai(wve,r.concat([this.topOverlay,this.inlineStartOverlay])),this.bottomInlineStartCornerOverlay=ai(pde,r.concat([this.bottomOverlay,this.inlineStartOverlay]))}},{key:"updateStateOfRendering",value:function(){var r=this.topOverlay.updateStateOfRendering();return r=this.bottomOverlay.updateStateOfRendering()||r,r=this.inlineStartOverlay.updateStateOfRendering()||r,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(r=this.topInlineStartCornerOverlay.updateStateOfRendering()||r),this.bottomOverlay.needFullRender&&(r=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||r)),r}},{key:"refreshAll",value:function(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}},{key:"registerListeners",value:function(){var r=this,n=this.domBindings,o=n.rootDocument,i=n.rootWindow,a=this.topOverlay.mainTableScrollableElement,l=this.inlineStartOverlay.mainTableScrollableElement;this.eventManager.addEventListener(o.documentElement,"keydown",function(v){return r.onKeyDown(v)}),this.eventManager.addEventListener(o.documentElement,"keyup",function(){return r.onKeyUp()}),this.eventManager.addEventListener(o,"visibilitychange",function(){return r.onKeyUp()}),this.eventManager.addEventListener(a,"scroll",function(v){return r.onTableScroll(v)},{passive:!0}),a!==l&&this.eventManager.addEventListener(l,"scroll",function(v){return r.onTableScroll(v)},{passive:!0});var s=i.devicePixelRatio&&i.devicePixelRatio>1,u=this.scrollableElement===i,f=this.wtSettings.getSetting("preventWheel"),c={passive:u};(f||s||!z0())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",function(v){return r.onCloneWheel(v,f)},c);var h=[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];h.forEach(function(v){if(v&&v.needFullRender){var g=v.clone.wtTable.holder;r.eventManager.addEventListener(g,"wheel",function(m){return r.onCloneWheel(m,f)},c)}});var d;this.eventManager.addEventListener(i,"resize",function(){clearTimeout(d),d=setTimeout(function(){r.wtSettings.getSetting("onWindowResize")},200)}),u||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}},{key:"deregisterListeners",value:function(){this.eventManager.clearEvents(!0)}},{key:"onTableScroll",value:function(r){var n=this.domBindings.rootWindow,o=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,a=r.target;this.keyPressed&&(i!==n&&a!==n&&!r.target.contains(i)||o!==n&&a!==n&&!r.target.contains(o))||this.syncScrollPositions(r)}},{key:"onCloneWheel",value:function(r,n){var o=this.domBindings.rootWindow,i=this.inlineStartOverlay.mainTableScrollableElement,a=this.topOverlay.mainTableScrollableElement,l=r.target,s=a!==o&&l!==o&&!l.contains(a),u=i!==o&&l!==o&&!l.contains(i);if(!(this.keyPressed&&(s||u))){var f=this.translateMouseWheelToScroll(r);(n||this.scrollableElement!==o&&f)&&r.preventDefault()}}},{key:"onKeyDown",value:function(r){this.keyPressed=ps(r.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(r){var n=isNaN(r.deltaY)?-1*r.wheelDeltaY:r.deltaY,o=isNaN(r.deltaX)?-1*r.wheelDeltaX:r.deltaX;r.deltaMode===1&&(o+=o*this.browserLineHeight,n+=n*this.browserLineHeight);var i=this.scrollVertically(n),a=this.scrollHorizontally(o);return i||a}},{key:"scrollVertically",value:function(r){var n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=r,n!==this.scrollableElement.scrollTop}},{key:"scrollHorizontally",value:function(r){var n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=r,n!==this.scrollableElement.scrollLeft}},{key:"syncScrollPositions",value:function(){if(!this.destroyed){var r=this.domBindings.rootWindow,n=this.topOverlay.clone.wtTable.holder,o=this.inlineStartOverlay.clone.wtTable.holder,i=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop],a=i[0],l=i[1];if(this.horizontalScrolling=n.scrollLeft!==a||this.lastScrollX!==r.scrollX,this.verticalScrolling=o.scrollTop!==l||this.lastScrollY!==r.scrollY,this.lastScrollX=r.scrollX,this.lastScrollY=r.scrollY,this.horizontalScrolling){n.scrollLeft=a;var s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;s&&(s.scrollLeft=a)}this.verticalScrolling&&(o.scrollTop=l),this.refreshAll()}}},{key:"syncScrollWithMaster",value:function(){var r=this.topOverlay.mainTableScrollableElement,n=r.scrollLeft,o=r.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=o)}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();var r=this.wtTable,n=this.domBindings.rootWindow;n.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=r.holder:this.scrollableElement=zc(r.TABLE),this.registerListeners()}},{key:"destroy",value:function(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}},{key:"refresh",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.updateLastSpreaderSize();n&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(r),this.inlineStartOverlay.refresh(r),this.topOverlay.refresh(r),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(r),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(r)}},{key:"updateLastSpreaderSize",value:function(){var r=this.wtTable.spreader,n=r.clientWidth,o=r.clientHeight,i=n!==this.spreaderLastSize.width||o!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=o),i}},{key:"adjustElementsSize",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wot.wtViewport,o=this.wtTable,i=this.wtSettings.getSetting("totalColumns"),a=this.wtSettings.getSetting("totalRows"),l=n.getRowHeaderWidth(),s=n.getColumnHeaderHeight(),u=o.hider.style;if(u.width="".concat(l+this.inlineStartOverlay.sumCellSizes(0,i),"px"),u.height="".concat(s+this.topOverlay.sumCellSizes(0,a)+1,"px"),this.scrollbarSize>0){var f=o.wtRootElement,c=f.scrollHeight,h=f.scrollWidth,d=o.holder,v=d.scrollHeight,g=d.scrollWidth;this.hasScrollbarRight=c<v,this.hasScrollbarBottom=h<g,this.hasScrollbarRight&&o.hider.scrollWidth+this.scrollbarSize>h?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&o.hider.scrollHeight+this.scrollbarSize>c&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(r),this.inlineStartOverlay.adjustElementsSize(r),this.bottomOverlay.adjustElementsSize(r)}},{key:"applyToDOM",value:function(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}},{key:"getParentOverlay",value:function(r){if(!r)return null;var n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],o=null;return $(n,function(i){i&&i.clone&&i.clone.wtTable.TABLE.contains(r)&&(o=i.clone)}),o}},{key:"syncOverlayTableClassNames",value:function(){var r=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];$(n,function(o){o&&(o.clone.wtTable.TABLE.className=r.className)})}}]),e}();const Uve=Wve;function ph(e){"@babel/helpers - typeof";return ph=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ph(e)}function zve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _I(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,K2(n.key),n)}}function Yve(e,t,r){return t&&_I(e.prototype,t),r&&_I(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function OI(e,t,r){return t=K2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function K2(e){var t=Gve(e,"string");return ph(t)==="symbol"?t:String(t)}function Gve(e,t){if(ph(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ph(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Kve=function(){function e(t){var r=this;zve(this,e),OI(this,"settings",{}),OI(this,"defaults",Object.freeze(this.getDefaults())),We(this.defaults,function(n,o){if(t[o]!==void 0)r.settings[o]=t[o];else{if(n===void 0)throw new Error('A required setting "'.concat(o,'" was not provided'));r.settings[o]=n}})}return Yve(e,[{key:"getDefaults",value:function(){var r=this;return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:function(){return r.getSetting("fixedColumnsStart")>0||r.getSetting("rowHeaders").length>0},shouldRenderTopOverlay:function(){return r.getSetting("fixedRowsTop")>0||r.getSetting("columnHeaders").length>0},shouldRenderBottomOverlay:function(){return r.getSetting("fixedRowsBottom")>0},minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(o,i,a){var l=r.getSetting("data",o,i);Ei(a,l??"")},columnWidth:function(){},rowHeight:function(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(o){return o},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:function(o){return o},onBeforeHighlightingColumnHeader:function(o){return o},onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1}}},{key:"update",value:function(r,n){var o=this;return n===void 0?We(r,function(i,a){o.settings[a]=i}):this.settings[r]=n,this}},{key:"getSetting",value:function(r,n,o,i,a){return typeof this.settings[r]=="function"?this.settings[r](n,o,i,a):n!==void 0&&Array.isArray(this.settings[r])?this.settings[r][n]:this.settings[r]}},{key:"getSettingPure",value:function(r){return this.settings[r]}},{key:"has",value:function(r){return!!this.settings[r]}}]),e}();function Ds(e){"@babel/helpers - typeof";return Ds=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ds(e)}function qve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Zve(n.key),n)}}function Xve(e,t,r){return t&&RI(e.prototype,t),r&&RI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Zve(e){var t=Jve(e,"string");return Ds(t)==="symbol"?t:String(t)}function Jve(e,t){if(Ds(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ds(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Qve(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&__(e,t)}function __(e,t){return __=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},__(e,t)}function eye(e){var t=nye();return function(){var n=Op(e),o;if(t){var i=Op(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return tye(this,o)}}function tye(e,t){if(t&&(Ds(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rye(e)}function rye(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nye(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Op(e){return Op=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Op(e)}var FE=function(e){Qve(r,e);var t=eye(r);function r(n,o,i,a){return qve(this,r),t.call(this,n,o,i,a,"master")}return Xve(r,[{key:"alignOverlaysWithTrimmingContainer",value:function(){var o=Ha(this.wtRootElement),i=this.domBindings.rootWindow;if(o===i){var a=this.wtSettings.getSetting("preventOverflow");a||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{var l=o.parentElement,s=gs(o,"height",i),u=gs(o,"overflow",i),f=this.holder.style,c=o.scrollWidth,h=o.scrollHeight,d=o.getBoundingClientRect(),v=d.width,g=d.height,m=["auto","hidden","scroll"];if(l&&m.includes(u)){var w=o.cloneNode(!1);w.style.overflow="auto",w.style.position="absolute",o.nextElementSibling?l.insertBefore(w,o.nextElementSibling):l.appendChild(w);var S=parseInt(Ti(w,i).height,10);l.removeChild(w),S===0&&(g=0)}g=Math.min(g,h),f.height=s==="auto"?"auto":"".concat(g,"px"),v=Math.min(v,c),f.width="".concat(v,"px"),f.overflow="",this.hasTableHeight=f.height==="auto"?!0:g>0,this.hasTableWidth=v>0}this.isTableVisible=vs(this.TABLE)}},{key:"markOversizedColumnHeaders",value:function(){var o=this.wtSettings,i=this.dataAccessObject.wtViewport,a="master",l=o.getSetting("columnHeaders"),s=l.length;if(s&&!i.hasOversizedColumnHeadersMarked[a]){for(var u=o.getSetting("rowHeaders"),f=u.length,c=this.getRenderedColumnsCount(),h=0;h<s;h++)for(var d=-1*f;d<c;d++)this.markIfOversizedColumnHeader(d);i.hasOversizedColumnHeadersMarked[a]=!0}}}]),r}(kf);pt(FE,L2);pt(FE,DE);const oye=FE;function mh(e){"@babel/helpers - typeof";return mh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mh(e)}function iye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lye(n.key),n)}}function aye(e,t,r){return t&&EI(e.prototype,t),r&&EI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lye(e){var t=sye(e,"string");return mh(t)==="symbol"?t:String(t)}function sye(e,t){if(mh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(mh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var uye=function(){function e(t,r,n,o,i){var a=this;iye(this,e),this.dataAccessObject=t,this.wot=t.wot,this.instance=this.wot,this.domBindings=r,this.wtSettings=n,this.wtTable=i,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=o,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",function(){a.clientHeight=a.getWorkspaceHeight()})}return aye(e,[{key:"getWorkspaceHeight",value:function(){var r=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer,o=0;if(n===this.domBindings.rootWindow)o=r.documentElement.clientHeight;else{var i=Rt(n);o=i>0&&n.clientHeight>0?n.clientHeight:1/0}return o}},{key:"getWorkspaceWidth",value:function(){var r=this.wtSettings,n=this.domBindings,o=n.rootDocument,i=n.rootWindow,a=this.dataAccessObject.inlineStartOverlayTrimmingContainer,l=o.documentElement.offsetWidth,s=r.getSetting("totalColumns"),u=r.getSetting("preventOverflow"),f=r.getSetting("rtlMode"),c=this.wtTable.TABLE.getBoundingClientRect(),h=f?c.right-l:c.left,d=l-h,v,g;if(u)return dt(this.wtTable.wtRootElement);if(r.getSetting("freezeOverlays")?v=Math.min(d,l):v=Math.min(this.getContainerFillWidth(),d,l),a===i&&s>0&&this.sumColumnWidths(0,s-1)>v)return o.documentElement.clientWidth;if(a!==i&&(g=gs(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",i),g==="scroll"||g==="hidden"||g==="auto"))return Math.max(v,a.clientWidth);var m=r.getSetting("stretchH");return m==="none"||!m?Math.max(v,dt(this.wtTable.TABLE)):v}},{key:"hasVerticalScroll",value:function(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(r,n){for(var o=0,i=r;i<n;)o+=this.wtTable.getColumnWidth(i),i+=1;return o}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var r=this.wtTable.holder,n=this.domBindings.rootDocument.createElement("div");n.style.width="100%",n.style.height="1px",r.appendChild(n);var o=n.offsetWidth;return this.containerWidth=o,r.removeChild(n),o}},{key:"getWorkspaceOffset",value:function(){return Vt(this.wtTable.TABLE)}},{key:"getColumnHeaderHeight",value:function(){var r=this.wtSettings.getSetting("columnHeaders");return r.length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Rt(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var r=this.getWorkspaceHeight();if(r===1/0)return r;var n=this.getColumnHeaderHeight();return n>0&&(r-=n),r}},{key:"getRowHeaderWidth",value:function(){var r=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(r){this.rowHeaderWidth=0;for(var o=0,i=n.length;o<i;o++)this.rowHeaderWidth+=r[o]||r}if(isNaN(this.rowHeaderWidth))if(n.length){var a=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var l=0,s=n.length;l<s;l++)a?(this.rowHeaderWidth+=dt(a),a=a.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var r=this.getWorkspaceWidth();if(r===1/0)return r;var n=this.getRowHeaderWidth();return n>0?r-n:r}},{key:"createRowsCalculator",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ra,n=this.wtSettings,o=this.wtTable,i,a,l;this.rowHeaderWidth=NaN,n.getSetting("renderAllRows")&&r===ra?i=1/0:i=this.getViewportHeight();var s=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset,u=n.getSetting("fixedRowsTop"),f=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return u&&s>=0&&(l=this.dataAccessObject.topOverlay.sumCellSizes(0,u),s+=l,i-=l),f&&this.dataAccessObject.bottomOverlay.clone&&(l=this.dataAccessObject.bottomOverlay.sumCellSizes(c-f,c),i-=l),o.holder.clientHeight===o.holder.offsetHeight?a=0:a=Xt(this.domBindings.rootDocument),new f2({viewportSize:i,scrollOffset:s,totalItems:n.getSetting("totalRows"),itemSizeFn:function(d){return o.getRowHeight(d)},overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),calculationType:r,scrollbarHeight:a})}},{key:"createColumnsCalculator",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ra,n=this.wtSettings,o=this.wtTable,i=this.getViewportWidth(),a=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;var l=n.getSetting("fixedColumnsStart");if(l&&a>=0){var s=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,l);a+=s,i-=s}return o.holder.clientWidth!==o.holder.offsetWidth&&(i-=Xt(this.domBindings.rootDocument)),new PE({viewportSize:i,scrollOffset:a,totalItems:n.getSetting("totalColumns"),itemSizeFn:function(f){return o.getColumnWidth(f)},overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),calculationType:r,stretchMode:n.getSetting("stretchH"),stretchingItemWidthFn:function(f,c){return n.getSetting("onBeforeStretchingColumnWidth",f,c)},inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}},{key:"createRenderCalculators",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=r;if(n){var o=this.createRowsCalculator(or),i=this.createColumnsCalculator(or);this.areAllProposedVisibleRowsAlreadyRendered(o)&&this.areAllProposedVisibleColumnsAlreadyRendered(i)||(n=!1)}return n||(this.rowsRenderCalculator=this.createRowsCalculator(ra),this.columnsRenderCalculator=this.createColumnsCalculator(ra)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,n}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(or),this.columnsVisibleCalculator=this.createColumnsCalculator(or)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(r){if(!this.rowsVisibleCalculator)return!1;var n=r.startRow,o=r.endRow,i=r.isVisibleInTrimmingContainer;if(n===null&&o===null)return!i;var a=this.rowsRenderCalculator,l=a.startRow,s=a.endRow;return n<l||n===l&&n>0?!1:!(o>s||o===s&&o<this.wtSettings.getSetting("totalRows")-1)}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(r){if(!this.columnsVisibleCalculator)return!1;var n=r.startColumn,o=r.endColumn,i=r.isVisibleInTrimmingContainer;if(n===null&&o===null)return!i;var a=this.columnsRenderCalculator,l=a.startColumn,s=a.endColumn;return n<l||n===l&&n>0?!1:!(o>s||o===s&&o<this.wtSettings.getSetting("totalColumns")-1)}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){We(this.hasOversizedColumnHeadersMarked,function(r,n,o){o[n]=void 0})}}]),e}();const fye=uye;function Ns(e){"@babel/helpers - typeof";return Ns=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ns(e)}function cye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dye(n.key),n)}}function hye(e,t,r){return t&&TI(e.prototype,t),r&&TI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dye(e){var t=vye(e,"string");return Ns(t)==="symbol"?t:String(t)}function vye(e,t){if(Ns(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ns(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yye(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&O_(e,t)}function O_(e,t){return O_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},O_(e,t)}function gye(e){var t=mye();return function(){var n=Rp(e),o;if(t){var i=Rp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return pye(this,o)}}function pye(e,t){if(t&&(Ns(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return R_(e)}function R_(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mye(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Rp(e){return Rp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Rp(e)}var bye=function(e){yye(r,e);var t=gye(r);function r(n,o){var i;cye(this,r),i=t.call(this,n,new Kve(o));var a=i.wtSettings.getSetting("facade",R_(i));return i.wtTable=new oye(i.getTableDao(),a,i.domBindings,i.wtSettings),i.wtViewport=new fye(i.getViewportDao(),i.domBindings,i.wtSettings,i.eventManager,i.wtTable),i.selections=i.wtSettings.getSetting("selections"),i.wtEvent=new w2(a,i.domBindings,i.wtSettings,i.eventManager,i.wtTable,i.selections),i.wtOverlays=new Uve(R_(i),a,i.domBindings,i.wtSettings,i.eventManager,i.wtTable),i.exportSettingsAsClassNames(),i.findOriginalHeaders(),i}return hye(r,[{key:"exportSettingsAsClassNames",value:function(){var o=this,i={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},a=[],l=[];We(i,function(s,u){o.wtSettings.getSetting(u).length&&l.push(s),a.push(s)}),Le(this.wtTable.wtRootElement.parentNode,a),re(this.wtTable.wtRootElement.parentNode,l)}},{key:"getViewportDao",value:function(){var o=this;return{get wot(){return o},get topOverlayTrimmingContainer(){return o.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return o.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return o.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return o.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return o.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return o.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return o.wtOverlays.topOverlay},get inlineStartOverlay(){return o.wtOverlays.inlineStartOverlay},get bottomOverlay(){return o.wtOverlays.bottomOverlay}}}}]),r}(xE);function bh(e){"@babel/helpers - typeof";return bh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bh(e)}function wye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Cye(n.key),n)}}function Sye(e,t,r){return t&&kI(e.prototype,t),r&&kI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Cye(e){var t=_ye(e,"string");return bh(t)==="symbol"?t:String(t)}function _ye(e,t){if(bh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Oye=function(){function e(t){wye(this,e),t instanceof xE?this._wot=t:this._initFromSettings(t)}return Sye(e,[{key:"_initFromSettings",value:function(r){r.facade=function(n){var o=new e(n);return function(){return o}},this._wot=new bye(r.table,r)}},{key:"guid",get:function(){return this._wot.guid}},{key:"rootDocument",get:function(){return this._wot.domBindings.rootDocument}},{key:"rootWindow",get:function(){return this._wot.domBindings.rootWindow}},{key:"wtSettings",get:function(){return this._wot.wtSettings}},{key:"cloneSource",get:function(){return this._wot.cloneSource}},{key:"cloneOverlay",get:function(){return this._wot.cloneOverlay}},{key:"selections",get:function(){return this._wot.selections}},{key:"wtViewport",get:function(){return this._wot.wtViewport}},{key:"wtOverlays",get:function(){return this._wot.wtOverlays}},{key:"wtTable",get:function(){return this._wot.wtTable}},{key:"wtEvent",get:function(){return this._wot.wtEvent}},{key:"wtScroll",get:function(){return this._wot.wtScroll}},{key:"drawn",get:function(){return this._wot.drawn},set:function(r){this._wot.drawn=r}},{key:"drawInterrupted",get:function(){return this._wot.drawInterrupted},set:function(r){this._wot.drawInterrupted=r}},{key:"lastMouseOver",get:function(){return this._wot.lastMouseOver},set:function(r){this._wot.lastMouseOver=r}},{key:"momentumScrolling",get:function(){return this._wot.momentumScrolling},set:function(r){this._wot.momentumScrolling=r}},{key:"touchApplied",get:function(){return this._wot.touchApplied},set:function(r){this._wot.touchApplied=r}},{key:"domBindings",get:function(){return this._wot.domBindings}},{key:"eventListeners",get:function(){return this._wot.eventListeners},set:function(r){this._wot.eventListeners=r}},{key:"eventManager",get:function(){return this._wot.eventManager}},{key:"createCellCoords",value:function(r,n){return this._wot.createCellCoords(r,n)}},{key:"createCellRange",value:function(r,n,o){return this._wot.createCellRange(r,n,o)}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(r),this}},{key:"getCell",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(r,n)}},{key:"scrollViewport",value:function(r,n,o,i,a){return this._wot.scrollViewport(r,n,o,i,a)}},{key:"scrollViewportHorizontally",value:function(r,n,o){return this._wot.scrollViewportHorizontally(r,n,o)}},{key:"scrollViewportVertically",value:function(r,n,o){return this._wot.scrollViewportVertically(r,n,o)}},{key:"getViewport",value:function(){return this._wot.getViewport()}},{key:"getOverlayName",value:function(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}},{key:"exportSettingsAsClassNames",value:function(){return this._wot.exportSettingsAsClassNames()}},{key:"update",value:function(r,n){return this._wot.wtSettings.update(r,n),this}},{key:"getSetting",value:function(r,n,o,i,a){return this._wot.wtSettings.getSetting(r,n,o,i,a)}},{key:"hasSetting",value:function(r){return this._wot.wtSettings.hasSetting(r)}},{key:"destroy",value:function(){this._wot.destroy()}}]),e}(),q2=Ut,Rye=je,X2=Ue,Eye=sv,Tye=Jd,kye=Br,Pye=Wd.f,Z2=X2(Pye),$ye=X2([].push),Aye=q2&&Rye(function(){var e=Object.create(null);return e[2]=2,!Z2(e,2)}),PI=function(e){return function(t){for(var r=kye(t),n=Tye(r),o=Aye&&Eye(r)===null,i=n.length,a=0,l=[],s;i>a;)s=n[a++],(!q2||(o?s in r:Z2(r,s)))&&$ye(l,e?[s,r[s]]:r[s]);return l}},Iye={entries:PI(!0),values:PI(!1)},Mye=Ae,xye=Iye.values;Mye({target:"Object",stat:!0},{values:function(t){return xye(t)}});function wh(e){"@babel/helpers - typeof";return wh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wh(e)}function Pw(e,t){return Lye(e)||Hye(e,t)||Nye(e,t)||Dye()}function Dye(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Nye(e,t){if(e){if(typeof e=="string")return $I(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $I(e,t)}}function $I(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Hye(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Lye(e){if(Array.isArray(e))return e}function jye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Bye(n.key),n)}}function Fye(e,t,r){return t&&AI(e.prototype,t),r&&AI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Bye(e){var t=Vye(e,"string");return wh(t)==="symbol"?t:String(t)}function Vye(e,t){if(wh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Wye=function(){function e(t,r){jye(this,e),r&&(this.eventManager=t.eventManager,this.instance=t,this.wot=t,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}return Fye(e,[{key:"registerListeners",value:function(){var r=this,n=this.wot.rootDocument.body;this.eventManager.addEventListener(n,"mousedown",function(){return r.onMouseDown()}),this.eventManager.addEventListener(n,"mouseup",function(){return r.onMouseUp()});for(var o=function(s){var u=r.main.childNodes[s];r.eventManager.addEventListener(u,"mouseenter",function(f){return r.onMouseEnter(f,r.main.childNodes[s])})},i=0,a=this.main.childNodes.length;i<a;i++)o(i)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(r,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;r.preventDefault(),pn(r);var o=this,i=this.wot.rootDocument.body,a=n.getBoundingClientRect();n.style.display="none";function l(u){if(u.clientY<Math.floor(a.top)||u.clientY>Math.ceil(a.top+a.height)||u.clientX<Math.floor(a.left)||u.clientX>Math.ceil(a.left+a.width))return!0}function s(u){l(u)&&(o.eventManager.removeEventListener(i,"mousemove",s),n.style.display="block")}this.eventManager.addEventListener(i,"mousemove",s)}},{key:"createBorders",value:function(r){var n=this.wot.rootDocument;this.main=n.createElement("div");var o=["top","start","bottom","end","corner"],i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(var a=0;a<5;a++){var l=o[a],s=n.createElement("div");s.className="wtBorder ".concat(this.settings.className||""),this.settings[l]&&this.settings[l].hide&&(s.className+=" hidden"),i=s.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:r.border.color,i.height=this.settings[l]&&this.settings[l].width?"".concat(this.settings[l].width,"px"):"".concat(r.border.width,"px"),i.width=this.settings[l]&&this.settings[l].width?"".concat(this.settings[l].width,"px"):"".concat(r.border.width,"px"),this.main.appendChild(s)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),cn()&&this.createMultipleSelectorHandles(),this.disappear();var u=this.wot.wtTable,f=u.bordersHolder;f||(f=n.createElement("div"),f.className="htBorders",u.bordersHolder=f,u.spreader.appendChild(f)),f.appendChild(this.main)}},{key:"createMultipleSelectorHandles",value:function(){var r=this,n=this.wot.rootDocument;this.selectionHandles={top:n.createElement("DIV"),topHitArea:n.createElement("DIV"),bottom:n.createElement("DIV"),bottomHitArea:n.createElement("DIV")};var o=10,i=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};var a={position:"absolute",height:"".concat(i,"px"),width:"".concat(i,"px"),"border-radius":"".concat(parseInt(i/1.5,10),"px")};We(a,function(s,u){r.selectionHandles.styles.bottomHitArea[u]=s,r.selectionHandles.styles.topHitArea[u]=s});var l={position:"absolute",height:"".concat(o,"px"),width:"".concat(o,"px"),"border-radius":"".concat(parseInt(o/1.5,10),"px"),background:"#F5F5FF",border:"1px solid #4285c8"};We(l,function(s,u){r.selectionHandles.styles.bottom[u]=s,r.selectionHandles.styles.top[u]=s}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}},{key:"isPartRange",value:function(r,n){var o=this.wot.selections.createOrGetArea();return!!(o.cellRange&&(r!==o.cellRange.to.row||n!==o.cellRange.to.col))}},{key:"updateMultipleSelectionHandlesPosition",value:function(r,n,o,i,a,l){var s=this.wot.wtSettings.getSetting("rtlMode"),u=s?"right":"left",f=this.selectionHandles.styles,c=f.top,h=f.topHitArea,d=f.bottom,v=f.bottomHitArea,g=parseInt(c.borderWidth,10),m=parseInt(c.width,10),w=parseInt(h.width,10),S=this.wot.wtTable.getWidth(),C=this.wot.wtTable.getHeight();c.top="".concat(parseInt(o-m-1,10),"px"),c[u]="".concat(parseInt(i-m-1,10),"px"),h.top="".concat(parseInt(o-w/4*3,10),"px"),h[u]="".concat(parseInt(i-w/4*3,10),"px");var k=Math.min(parseInt(i+a,10),S-m-g*2),R=Math.min(parseInt(i+a-w/4,10),S-w-g*2);d[u]="".concat(k,"px"),v[u]="".concat(R,"px");var V=Math.min(parseInt(o+l,10),C-m-g*2),U=Math.min(parseInt(o+l-w/4,10),C-w-g*2);d.top="".concat(V,"px"),v.top="".concat(U,"px"),this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(c.display="block",h.display="block",this.isPartRange(r,n)?(d.display="none",v.display="none"):(d.display="block",v.display="block")):(c.display="none",d.display="none",h.display="none",v.display="none"),r===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(c.zIndex="9999",h.zIndex="9999"):(c.zIndex="",h.zIndex="")}},{key:"appear",value:function(r){if(!this.disabled){for(var n=this.wot,o=n.wtTable,i=n.rootDocument,a=n.rootWindow,l,s,u,f,c,h,d=o.getRenderedRowsCount(),v=0;v<d;v+=1){var g=o.rowFilter.renderedToSource(v);if(g>=r[0]&&g<=r[2]){l=g,c=r[0];break}}for(var m=d-1;m>=0;m-=1){var w=o.rowFilter.renderedToSource(m);if(w>=r[0]&&w<=r[2]){s=w;break}}for(var S=o.getRenderedColumnsCount(),C=0;C<S;C+=1){var k=o.columnFilter.renderedToSource(C);if(k>=r[1]&&k<=r[3]){u=k,h=r[1];break}}for(var R=S-1;R>=0;R-=1){var V=o.columnFilter.renderedToSource(R);if(V>=r[1]&&V<=r[3]){f=V;break}}if(l===void 0||u===void 0){this.disappear();return}var U=o.getCell(this.wot.createCellCoords(l,u)),X=l!==s||u!==f,Y=X?o.getCell(this.wot.createCellCoords(s,f)):U,q=Vt(U),Z=X?Vt(Y):q,ie=Vt(o.TABLE),J=dt(o.TABLE),le=q.top,Se=q.left,me=this.wot.wtSettings.getSetting("rtlMode"),Ce=0,P=0;if(me){var y=dt(U),p=a.innerWidth-ie.left-J;P=Se+y-Z.left,Ce=a.innerWidth-Se-y-p-1}else P=Z.left+dt(Y)-Se,Ce=Se-ie.left-1;if(this.isEntireColumnSelected(l,s)){var b=this.getDimensionsFromHeader("columns",u,f,c,ie),_=null;if(b){var T=Pw(b,3);_=T[0],Ce=T[1],P=T[2]}_&&(U=_)}var I=le-ie.top-1,F=Z.top+Rt(Y)-le;if(this.isEntireRowSelected(u,f)){var W=this.getDimensionsFromHeader("rows",l,s,h,ie),G=null;if(W){var Q=Pw(W,3);G=Q[0],I=Q[1],F=Q[2]}G&&(U=G)}var ee=Ti(U,a);parseInt(ee.borderTopWidth,10)>0&&(I+=1,F=F>0?F-1:0),parseInt(ee[me?"borderRightWidth":"borderLeftWidth"],10)>0&&(Ce+=1,P=P>0?P-1:0);var se=me?"right":"left";this.topStyle.top="".concat(I,"px"),this.topStyle[se]="".concat(Ce,"px"),this.topStyle.width="".concat(P,"px"),this.topStyle.display="block",this.startStyle.top="".concat(I,"px"),this.startStyle[se]="".concat(Ce,"px"),this.startStyle.height="".concat(F,"px"),this.startStyle.display="block";var Re=Math.floor(this.settings.border.width/2);this.bottomStyle.top="".concat(I+F-Re,"px"),this.bottomStyle[se]="".concat(Ce,"px"),this.bottomStyle.width="".concat(P,"px"),this.bottomStyle.display="block",this.endStyle.top="".concat(I,"px"),this.endStyle[se]="".concat(Ce+P-Re,"px"),this.endStyle.height="".concat(F+1,"px"),this.endStyle.display="block";var ce=this.settings.border.cornerVisible;ce=typeof ce=="function"?ce(this.settings.layerLevel):ce;var de=this.wot.getSetting("onModifyGetCellCoords",s,f),K=s,Me=f;if(de&&Array.isArray(de)){var Ge=Pw(de,4);K=Ge[2],Me=Ge[3]}if(cn()||!ce||this.isPartRange(K,Me))this.cornerStyle.display="none";else{this.cornerStyle.top="".concat(I+F+this.cornerCenterPointOffset-1,"px"),this.cornerStyle[se]="".concat(Ce+P+this.cornerCenterPointOffset-1,"px"),this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";var Pe=Ha(o.TABLE),Ie=Pe===a;Ie&&(Pe=i.documentElement);var $e=parseInt(this.cornerDefaultStyle.width,10)/2,O=parseInt(this.cornerDefaultStyle.height,10)/2;if(f===this.wot.getSetting("totalColumns")-1){var E=Ie?Y.getBoundingClientRect().left:Y.offsetLeft,A=!1,H=0;me?(H=E-parseInt(this.cornerDefaultStyle.width,10)/2,A=H<0):(H=E+dt(Y)+parseInt(this.cornerDefaultStyle.width,10)/2,A=H>=Rc(Pe)),A&&(this.cornerStyle[se]="".concat(Math.floor(Ce+P+this.cornerCenterPointOffset-$e),"px"),this.cornerStyle[me?"borderLeftWidth":"borderRightWidth"]=0)}if(s===this.wot.getSetting("totalRows")-1){var M=Ie?Y.getBoundingClientRect().top:Y.offsetTop,j=M+Rt(Y)+parseInt(this.cornerDefaultStyle.height,10)/2,x=j>=lo(Pe);x&&(this.cornerStyle.top="".concat(Math.floor(I+F+this.cornerCenterPointOffset-O),"px"),this.cornerStyle.borderBottomWidth=0)}this.cornerStyle.display="block"}cn()&&this.updateMultipleSelectionHandlesPosition(s,f,I,Ce,P,F)}}},{key:"isEntireColumnSelected",value:function(r,n){return r===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}},{key:"isEntireRowSelected",value:function(r,n){return r===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}},{key:"getDimensionsFromHeader",value:function(r,n,o,i,a){var l=this.wot.wtTable,s=l.wtRootElement.parentNode,u=null,f=null,c=null,h=null,d=null,v=null,g=null,m=null;switch(r){case"rows":u=function(){return l.getRowHeader.apply(l,arguments)},f=function(){return Rt.apply(void 0,arguments)},c="ht__selection--rows",v="top";break;case"columns":u=function(){return l.getColumnHeader.apply(l,arguments)},f=function(){return dt.apply(void 0,arguments)},c="ht__selection--columns",v="left";break}if(s.classList.contains(c)){var w=this.wot.getSetting("columnHeaders").length;if(g=u(n,w-i),m=u(o,w-i),!g||!m)return!1;var S=Vt(g),C=Vt(m);return g&&m&&(h=S[v]-a[v]-1,d=C[v]+f(m)-S[v]),[g,h,d]}return!1}},{key:"changeBorderStyle",value:function(r,n){var o=this[r].style,i=n[r];!i||i.hide?re(this[r],"hidden"):(xe(this[r],"hidden")&&Le(this[r],"hidden"),o.backgroundColor=i.color,(r==="top"||r==="bottom")&&(o.height="".concat(i.width,"px")),(r==="start"||r==="end")&&(o.width="".concat(i.width,"px")))}},{key:"changeBorderToDefaultStyle",value:function(r){var n={width:1,color:"#000"},o=this[r].style;o.backgroundColor=n.color,o.width="".concat(n.width,"px"),o.height="".concat(n.width,"px")}},{key:"toggleHiddenClass",value:function(r,n){this.changeBorderToDefaultStyle(r),n?re(this[r],"hidden"):Le(this[r],"hidden")}},{key:"disappear",value:function(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",cn()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}},{key:"destroy",value:function(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}]),e}();const Uye=Wye;function zye(e,t){return qye(e)||Kye(e,t)||Gye(e,t)||Yye()}function Yye(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Gye(e,t){if(e){if(typeof e=="string")return II(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return II(e,t)}}function II(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Kye(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function qye(e){if(Array.isArray(e))return e}function Hs(e){"@babel/helpers - typeof";return Hs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hs(e)}function Xye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Jye(n.key),n)}}function Zye(e,t,r){return t&&MI(e.prototype,t),r&&MI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jye(e){var t=Qye(e,"string");return Hs(t)==="symbol"?t:String(t)}function Qye(e,t){if(Hs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ege=function(){function e(t,r){Xye(this,e),this.settings=t,this.cellRange=r||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}return Zye(e,[{key:"getBorder",value:function(r){return this.instanceBorders[r.guid]||(this.instanceBorders[r.guid]=new Uye(r,this.settings)),this.instanceBorders[r.guid]}},{key:"isEmpty",value:function(){return this.cellRange===null}},{key:"add",value:function(r){return this.isEmpty()?this.cellRange=this.settings.createCellRange(r):this.cellRange.expand(r),this}},{key:"replace",value:function(r,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(r))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(r))return this.cellRange.to=n,!0}return!1}},{key:"clear",value:function(){return this.cellRange=null,this}},{key:"getCorners",value:function(){var r=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[r.row,r.col,n.row,n.col]}},{key:"addClassAtCoords",value:function(r,n,o,i){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,l=r.wtTable.getCell(this.settings.createCellCoords(n,o));if(Hs(l)==="object"){var s=i;a&&(s=this.classNameGenerator(l),this.classNames.includes(s)||this.classNames.push(s)),re(l,s)}return this}},{key:"linearClassNameGenerator",value:function(r,n){return function o(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;if(n===0||a===0)return r;var l=a>=0?a:n,s=r;l-=1;var u=l===0?r:"".concat(r,"-").concat(l);if(xe(i,u)){var f=l+1;s="".concat(r,"-").concat(f)}else s=o(i,l);return s}}},{key:"draw",value:function(r){if(this.isEmpty()){this.settings.border&&this.getBorder(r).disappear();return}var n=r.wtTable.getRenderedRowsCount(),o=r.wtTable.getRenderedColumnsCount(),i=this.getCorners(),a=zye(i,4),l=a[0],s=a[1],u=a[2],f=a[3],c=this.settings,h=c.highlightHeaderClassName,d=c.highlightColumnClassName,v=c.highlightRowClassName,g=c.highlightOnlyClosestHeader,m=c.selectionType,w=m===void 0||["active-header","header"].includes(m);if(w&&s!==null&&f!==null)for(var S=0,C=0;C<o;C+=1){var k=r.wtTable.columnFilter.renderedToSource(C);if(k>=s&&k<=f){var R=r.wtTable.getColumnHeaders(k),V=R.length-1;g&&R.length>1&&(R=[R[V]]);for(var U=0;U<R.length;U+=1){var X=[],Y=R[U];h&&X.push(h),d&&X.push(d),U=g?V:U;var q=r.getSetting("onBeforeHighlightingColumnHeader",k,U,{selectionType:m,columnCursor:S,selectionWidth:f-s+1,classNames:X});q!==k&&(Y=r.wtTable.getColumnHeader(q,U)),re(Y,X)}S+=1}}if(l!==null&&u!==null)for(var Z=0,ie=0;ie<n;ie+=1){var J=r.wtTable.rowFilter.renderedToSource(ie);if(w&&J>=l&&J<=u){var le=r.wtTable.getRowHeaders(J),Se=le.length-1;g&&le.length>1&&(le=[le[Se]]);for(var me=0;me<le.length;me+=1){var Ce=[],P=le[me];h&&Ce.push(h),v&&Ce.push(v),me=g?Se:me;var y=r.getSetting("onBeforeHighlightingRowHeader",J,me,{selectionType:m,rowCursor:Z,selectionHeight:u-l+1,classNames:Ce});y!==J&&(P=r.wtTable.getRowHeader(y,me)),re(P,Ce)}Z+=1}if(s!==null&&f!==null)for(var p=0;p<o;p+=1){var b=r.wtTable.columnFilter.renderedToSource(p);J>=l&&J<=u&&b>=s&&b<=f?this.settings.className&&this.addClassAtCoords(r,J,b,this.settings.className,this.settings.markIntersections):J>=l&&J<=u?v&&this.addClassAtCoords(r,J,b,v):b>=s&&b<=f&&d&&this.addClassAtCoords(r,J,b,d);var _=r.getSetting("onAfterDrawSelection",J,b,this.settings.layerLevel);typeof _=="string"&&this.addClassAtCoords(r,J,b,_)}}r.getSetting("onBeforeDrawBorders",i,this.settings.className),this.settings.border&&this.getBorder(r).appear(i)}},{key:"destroy",value:function(){Object.values(this.instanceBorders).forEach(function(r){return r.destroy()})}}]),e}();const tge=ege;function xI(e){var t=e.isShiftKey,r=e.isLeftClick,n=e.isRightClick,o=e.coords,i=e.selection,a=e.controller,l=e.cellCoordsFactory,s=i.isSelected()?i.getSelectedRange().current():null,u=i.isSelectedByCorner(),f=i.isSelectedByRowHeader();if(t&&s)o.row>=0&&o.col>=0&&!a.cell?i.setRangeEnd(o):(u||f)&&o.row>=0&&o.col>=0&&!a.cell?i.setRangeEnd(l(o.row,o.col)):u&&o.row<0&&!a.column?i.setRangeEnd(l(s.to.row,o.col)):f&&o.col<0&&!a.row?i.setRangeEnd(l(o.row,s.to.col)):(!u&&!f&&o.col<0||u&&o.col<0)&&!a.row?i.selectRows(Math.max(s.from.row,0),o.row,o.col):(!u&&!f&&o.row<0||f&&o.row<0)&&!a.column&&i.selectColumns(Math.max(s.from.col,0),o.col,o.row);else{var c=!i.inInSelection(o),h=r||n&&c;o.row<0&&o.col>=0&&!a.column?h&&i.selectColumns(o.col,o.col,o.row):o.col<0&&o.row>=0&&!a.row?h&&i.selectRows(o.row,o.row,o.col):o.col>=0&&o.row>=0&&!a.cell?h&&i.setRangeStart(o):o.col<0&&o.row<0&&i.selectAll(!0,!0)}}function rge(e){var t=e.isLeftClick,r=e.coords,n=e.selection,o=e.controller,i=e.cellCoordsFactory;if(t){var a=n.isSelectedByRowHeader(),l=n.isSelectedByColumnHeader(),s=n.tableProps.countCols(),u=n.tableProps.countRows();l&&!o.column?n.setRangeEnd(i(u-1,r.col)):a&&!o.row?n.setRangeEnd(i(r.row,s-1)):o.cell||n.setRangeEnd(r)}}var nge=new Map([["mousedown",xI],["mouseover",rge],["touchstart",xI]]);function DI(e,t){var r=t.coords,n=t.selection,o=t.controller,i=t.cellCoordsFactory;nge.get(e.type)({coords:r,selection:n,controller:o,cellCoordsFactory:i,isShiftKey:e.shiftKey,isLeftClick:Hm(e)||e.type==="touchstart",isRightClick:ki(e)})}var J2=new WeakMap,BE=Symbol("rootInstance");function oge(e){J2.set(e,!0)}function ige(e){return e===BE}function E_(e){return J2.has(e)}function Sh(e){"@babel/helpers - typeof";return Sh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sh(e)}function Yf(e,t){return sge(e)||lge(e,t)||Q2(e,t)||age()}function age(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lge(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function sge(e){if(Array.isArray(e))return e}function NI(e){return cge(e)||fge(e)||Q2(e)||uge()}function uge(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Q2(e,t){if(e){if(typeof e=="string")return T_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return T_(e,t)}}function fge(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function cge(e){if(Array.isArray(e))return T_(e)}function T_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function hge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eW(n.key),n)}}function dge(e,t,r){return t&&HI(e.prototype,t),r&&HI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function LI(e,t,r){vge(e,t),t.set(e,r)}function vge(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yo(e,t,r){return t=eW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eW(e){var t=yge(e,"string");return Sh(t)==="symbol"?t:String(t)}function yge(e,t){if(Sh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jI(e,t){var r=tW(e,t,"get");return gge(e,r)}function gge(e,t){return t.get?t.get.call(e):t.value}function FI(e,t,r){var n=tW(e,t,"set");return pge(e,n,r),r}function tW(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function pge(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Wi=new WeakMap,$w=new WeakMap,Aw=new WeakMap,mge=function(){function e(t){hge(this,e),Yo(this,"instance",void 0),Yo(this,"eventManager",void 0),Yo(this,"settings",void 0),Yo(this,"THEAD",void 0),Yo(this,"TBODY",void 0),Yo(this,"_wt",void 0),Yo(this,"activeWt",void 0),LI(this,$w,{writable:!0,value:0}),LI(this,Aw,{writable:!0,value:0}),Yo(this,"postponedAdjustElementsSize",!1),this.instance=t,this.eventManager=new Tt(this.instance),this.settings=this.instance.getSettings(),Wi.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}return dge(e,[{key:"render",value:function(){this.instance.isRenderSuspended()||(this.instance.runHooks("beforeRender",this.instance.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.instance.forceFullRender),this.instance.runHooks("afterRender",this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}},{key:"adjustElementsSize",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(r)}},{key:"getCellAtCoords",value:function(r,n){var o=this._wt.getCell(r,n);return o<0?null:o}},{key:"scrollViewport",value:function(r,n,o,i,a){return this._wt.scrollViewport(r,n,o,i,a)}},{key:"scrollViewportHorizontally",value:function(r,n,o){return this._wt.scrollViewportHorizontally(r,n,o)}},{key:"scrollViewportVertically",value:function(r,n,o){return this._wt.scrollViewportVertically(r,n,o)}},{key:"createElements",value:function(){var r=Wi.get(this),n=this.instance,o=n.rootElement,i=n.rootDocument,a=o.getAttribute("style");a&&o.setAttribute("data-originalstyle",a),re(o,"handsontable"),r.table=i.createElement("TABLE"),re(r.table,"htCore"),this.instance.getSettings().tableClassName&&re(r.table,this.instance.getSettings().tableClassName),this.THEAD=i.createElement("THEAD"),r.table.appendChild(this.THEAD),this.TBODY=i.createElement("TBODY"),r.table.appendChild(this.TBODY),this.instance.table=r.table,this.instance.container.insertBefore(r.table,this.instance.container.firstChild)}},{key:"registerEvents",value:function(){var r=this,n=Wi.get(this),o=this.instance,i=o.rootElement,a=o.rootDocument,l=o.selection,s=a.documentElement;this.eventManager.addEventListener(i,"mousedown",function(u){if(n.selectionMouseDown=!0,!r.isTextSelectionAllowed(u.target)){var f=r.instance.rootWindow;UC(f),u.preventDefault(),f.focus()}}),this.eventManager.addEventListener(i,"mouseup",function(){n.selectionMouseDown=!1}),this.eventManager.addEventListener(i,"mousemove",function(u){n.selectionMouseDown&&!r.isTextSelectionAllowed(u.target)&&(r.settings.fragmentSelection&&UC(r.instance.rootWindow),u.preventDefault())}),this.eventManager.addEventListener(s,"keyup",function(u){l.isInProgress()&&!u.shiftKey&&l.finish()}),this.eventManager.addEventListener(s,"mouseup",function(u){l.isInProgress()&&Hm(u)&&l.finish(),n.mouseDown=!1,(Nm(a.activeElement)||!l.isSelected()&&!l.isSelectedByAnyHeader()&&!i.contains(u.target)&&!ki(u))&&r.instance.unlisten()}),this.eventManager.addEventListener(s,"contextmenu",function(u){l.isInProgress()&&ki(u)&&(l.finish(),n.mouseDown=!1)}),this.eventManager.addEventListener(s,"touchend",function(){l.isInProgress()&&l.finish(),n.mouseDown=!1}),this.eventManager.addEventListener(s,"mousedown",function(u){var f=u.target,c=u.x||u.clientX,h=u.y||u.clientY,d=u.target;if(!(n.mouseDown||!i||!r.instance.view)){var v=r.instance.view._wt.wtTable.holder;if(d===v){var g=Xt(a);if(a.elementFromPoint(c+g,h)!==v||a.elementFromPoint(c,h+g)!==v)return}else for(;d!==s;){if(d===null){if(u.isTargetWebComponent)break;return}if(d===i)return;d=d.parentNode}var m=typeof r.settings.outsideClickDeselects=="function"?r.settings.outsideClickDeselects(f):r.settings.outsideClickDeselects;m?r.instance.deselectCell():r.instance.destroyEditor(!1,!1)}}),this.eventManager.addEventListener(n.table,"selectstart",function(u){r.settings.fragmentSelection||Yc(u.target)||u.preventDefault()})}},{key:"translateFromRenderableToVisualCoords",value:function(r){var n,o=r.row,i=r.col;return(n=this.instance)._createCellCoords.apply(n,NI(this.translateFromRenderableToVisualIndex(o,i)))}},{key:"translateFromRenderableToVisualIndex",value:function(r,n){var o=r>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(r):r,i=n>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(n):n;return o===null&&(o=r),i===null&&(i=n),[o,i]}},{key:"countRenderableIndexes",value:function(r,n){var o=Math.min(r.getNotTrimmedIndexesLength(),n),i=r.getNearestNotHiddenIndex(o-1,-1);return i===null?0:r.getRenderableFromVisualIndex(i)+1}},{key:"countRenderableColumns",value:function(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}},{key:"countRenderableRows",value:function(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}},{key:"countNotHiddenRowIndexes",value:function(r,n){return this.countNotHiddenIndexes(r,n,this.instance.rowIndexMapper,this.countRenderableRows())}},{key:"countNotHiddenColumnIndexes",value:function(r,n){return this.countNotHiddenIndexes(r,n,this.instance.columnIndexMapper,this.countRenderableColumns())}},{key:"countNotHiddenIndexes",value:function(r,n,o,i){if(isNaN(r)||r<0)return 0;var a=o.getNearestNotHiddenIndex(r,n),l=o.getRenderableFromVisualIndex(a);if(!Number.isInteger(l))return 0;var s=0;return n<0?s=l+1:n>0&&(s=i-l),s}},{key:"countNotHiddenFixedColumnsStart",value:function(){var r=this.instance.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),r)-1;return this.countNotHiddenColumnIndexes(n,-1)}},{key:"countNotHiddenFixedRowsTop",value:function(){var r=this.instance.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),r)-1;return this.countNotHiddenRowIndexes(n,-1)}},{key:"countNotHiddenFixedRowsBottom",value:function(){var r=this.instance.countRows(),n=Math.max(r-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}},{key:"isMainTableNotFullyCoveredByOverlays",value:function(){var r=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.instance.countRenderedRows()>r&&this.instance.countRenderedCols()>n}},{key:"initializeWalkontable",value:function(){var r=this,n=Wi.get(this),o={rtlMode:this.instance.isRtl(),externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:n.table,isDataViewInstance:function(){return E_(r.instance)},preventOverflow:function(){return r.settings.preventOverflow},preventWheel:function(){return r.settings.preventWheel},stretchH:function(){return r.settings.stretchH},data:function(f,c){var h;return(h=r.instance).getDataAtCell.apply(h,NI(r.translateFromRenderableToVisualIndex(f,c)))},totalRows:function(){return r.countRenderableRows()},totalColumns:function(){return r.countRenderableColumns()},fixedColumnsStart:function(){return r.countNotHiddenFixedColumnsStart()},fixedRowsTop:function(){return r.countNotHiddenFixedRowsTop()},fixedRowsBottom:function(){return r.countNotHiddenFixedRowsBottom()},shouldRenderInlineStartOverlay:function(){return r.settings.fixedColumnsStart>0||o.rowHeaders().length>0},shouldRenderTopOverlay:function(){return r.settings.fixedRowsTop>0||o.columnHeaders().length>0},shouldRenderBottomOverlay:function(){return r.settings.fixedRowsBottom>0},minSpareRows:function(){return r.settings.minSpareRows},renderAllRows:this.settings.renderAllRows,rowHeaders:function(){var f=[];return r.instance.hasRowHeaders()&&f.push(function(c,h){var d=c>=0?r.instance.rowIndexMapper.getVisualFromRenderableIndex(c):c;r.appendRowHeader(d,h)}),r.instance.runHooks("afterGetRowHeaderRenderers",f),FI(r,Aw,f.length),f},columnHeaders:function(){var f=[];return r.instance.hasColHeaders()&&f.push(function(c,h){var d=c>=0?r.instance.columnIndexMapper.getVisualFromRenderableIndex(c):c;r.appendColHeader(d,h)}),r.instance.runHooks("afterGetColumnHeaderRenderers",f),FI(r,$w,f.length),f},columnWidth:function(f){var c=r.instance.columnIndexMapper.getVisualFromRenderableIndex(f);return r.instance.getColWidth(c===null?f:c)},rowHeight:function(f){var c=r.instance.rowIndexMapper.getVisualFromRenderableIndex(f);return r.instance.getRowHeight(c===null?f:c)},cellRenderer:function(f,c,h){var d=r.translateFromRenderableToVisualIndex(f,c),v=Yf(d,2),g=v[0],m=v[1],w=r.instance.runHooks("modifyGetCellCoords",g,m),S=g,C=m;if(Array.isArray(w)){var k=Yf(w,2);S=k[0],C=k[1]}var R=r.instance.getCellMeta(S,C),V=r.instance.colToProp(C),U=r.instance.getDataAtRowProp(S,V);r.instance.hasHook("beforeValueRender")&&(U=r.instance.runHooks("beforeValueRender",U,R)),r.instance.runHooks("beforeRenderer",h,g,m,V,U,R),r.instance.getCellRenderer(R)(r.instance,h,g,m,V,U,R),r.instance.runHooks("afterRenderer",h,g,m,V,U,R)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:function(){return r.settings.fragmentSelection},onWindowResize:function(){r.instance&&!r.instance.isDestroyed&&r.instance.refreshDimensions()},onContainerElementResize:function(){r.instance&&!r.instance.isDestroyed&&r.instance.refreshDimensions()},onCellMouseDown:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c),g={row:!1,column:!1,cell:!1};r.instance.listen(),r.activeWt=d,n.mouseDown=!0,r.instance.runHooks("beforeOnCellMouseDown",f,v,h,g),!ta(f)&&(DI(f,{coords:v,selection:r.instance.selection,controller:g,cellCoordsFactory:function(w,S){return r.instance._createCellCoords(w,S)}}),r.instance.runHooks("afterOnCellMouseDown",f,v,h),r.activeWt=r._wt)},onCellContextMenu:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c);r.activeWt=d,n.mouseDown=!1,r.instance.selection.isInProgress()&&r.instance.selection.finish(),r.instance.runHooks("beforeOnCellContextMenu",f,v,h),!ta(f)&&(r.instance.runHooks("afterOnCellContextMenu",f,v,h),r.activeWt=r._wt)},onCellMouseOut:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c);r.activeWt=d,r.instance.runHooks("beforeOnCellMouseOut",f,v,h),!ta(f)&&(r.instance.runHooks("afterOnCellMouseOut",f,v,h),r.activeWt=r._wt)},onCellMouseOver:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c),g={row:!1,column:!1,cell:!1};r.activeWt=d,r.instance.runHooks("beforeOnCellMouseOver",f,v,h,g),!ta(f)&&(n.mouseDown&&DI(f,{coords:v,selection:r.instance.selection,controller:g,cellCoordsFactory:function(w,S){return r.instance._createCellCoords(w,S)}}),r.instance.runHooks("afterOnCellMouseOver",f,v,h),r.activeWt=r._wt)},onCellMouseUp:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c);r.activeWt=d,r.instance.runHooks("beforeOnCellMouseUp",f,v,h),!(ta(f)||r.instance.isDestroyed)&&(r.instance.runHooks("afterOnCellMouseUp",f,v,h),r.activeWt=r._wt)},onCellCornerMouseDown:function(f){f.preventDefault(),r.instance.runHooks("afterOnCellCornerMouseDown",f)},onCellCornerDblClick:function(f){f.preventDefault(),r.instance.runHooks("afterOnCellCornerDblClick",f)},beforeDraw:function(f,c){return r.beforeRender(f,c)},onDraw:function(f){return r.afterRender(f)},onScrollVertically:function(){return r.instance.runHooks("afterScrollVertically")},onScrollHorizontally:function(){return r.instance.runHooks("afterScrollHorizontally")},onBeforeRemoveCellClassNames:function(){return r.instance.runHooks("beforeRemoveCellClassNames")},onBeforeHighlightingRowHeader:function(f,c,h){var d=r.instance.rowIndexMapper,v=d.getVisualFromRenderableIndex(f),g=r.instance.runHooks("beforeHighlightingRowHeader",v,c,h);return d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(g,1))},onBeforeHighlightingColumnHeader:function(f,c,h){var d=r.instance.columnIndexMapper,v=d.getVisualFromRenderableIndex(f),g=r.instance.runHooks("beforeHighlightingColumnHeader",v,c,h);return d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(g,1))},onAfterDrawSelection:function(f,c,h){var d,v=r.translateFromRenderableToVisualIndex(f,c),g=Yf(v,2),m=g[0],w=g[1],S=r.instance.selection.getSelectedRange(),C=S.size();if(C>0){var k=(h??0)+1-C,R=S.peekByIndex(k);d=[R.from.row,R.from.col,R.to.row,R.to.col]}return r.instance.runHooks("afterDrawSelection",m,w,d,h)},onBeforeDrawBorders:function(f,c){var h=Yf(f,4),d=h[0],v=h[1],g=h[2],m=h[3],w=[r.instance.rowIndexMapper.getVisualFromRenderableIndex(d),r.instance.columnIndexMapper.getVisualFromRenderableIndex(v),r.instance.rowIndexMapper.getVisualFromRenderableIndex(g),r.instance.columnIndexMapper.getVisualFromRenderableIndex(m)];return r.instance.runHooks("beforeDrawBorders",w,c)},onBeforeTouchScroll:function(){return r.instance.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){return r.instance.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(f,c){var h=r.instance.columnIndexMapper.getVisualFromRenderableIndex(c);return r.instance.runHooks("beforeStretchingColumnWidth",f,h)},onModifyRowHeaderWidth:function(f){return r.instance.runHooks("modifyRowHeaderWidth",f)},onModifyGetCellCoords:function(f,c,h){var d=r.instance.rowIndexMapper,v=r.instance.columnIndexMapper,g=c>=0?v.getVisualFromRenderableIndex(c):c,m=f>=0?d.getVisualFromRenderableIndex(f):f,w=r.instance.runHooks("modifyGetCellCoords",m,g,h);if(Array.isArray(w)){var S=Yf(w,4),C=S[0],k=S[1],R=S[2],V=S[3];return[C>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(C,1)):C,k>=0?v.getRenderableFromVisualIndex(v.getNearestNotHiddenIndex(k,1)):k,R>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(R,-1)):R,V>=0?v.getRenderableFromVisualIndex(v.getNearestNotHiddenIndex(V,-1)):V]}},viewportRowCalculatorOverride:function(f){var c=r.settings.viewportRowRenderingOffset;if(c==="auto"&&r.settings.fixedRowsTop&&(c=10),c>0||c==="auto"){var h=r.countRenderableRows(),d=f.startRow,v=f.endRow;if(typeof c=="number")f.startRow=Math.max(d-c,0),f.endRow=Math.min(v+c,h-1);else if(c==="auto"){var g=Math.ceil(v/h*12);f.startRow=Math.max(d-g,0),f.endRow=Math.min(v+g,h-1)}}r.instance.runHooks("afterViewportRowCalculatorOverride",f)},viewportColumnCalculatorOverride:function(f){var c=r.settings.viewportColumnRenderingOffset;if(c==="auto"&&r.settings.fixedColumnsStart&&(c=10),c>0||c==="auto"){var h=r.countRenderableColumns(),d=f.startColumn,v=f.endColumn;if(typeof c=="number"&&(f.startColumn=Math.max(d-c,0),f.endColumn=Math.min(v+c,h-1)),c==="auto"){var g=Math.ceil(v/h*6);f.startColumn=Math.max(d-g,0),f.endColumn=Math.min(v+g,h-1)}}r.instance.runHooks("afterViewportColumnCalculatorOverride",f)},rowHeaderWidth:function(){return r.settings.rowHeaderWidth},columnHeaderHeight:function(){var f=r.instance.runHooks("modifyColumnHeaderHeight");return r.settings.columnHeaderHeight||f}};this.instance.runHooks("beforeInitWalkontable",o),this._wt=new Oye(o),this.activeWt=this._wt;var i=this._wt.wtTable.spreader,a=this.instance.rootElement.getBoundingClientRect(),l=a.width,s=a.height;this.setLastSize(l,s),this.eventManager.addEventListener(i,"mousedown",function(u){u.target===i&&u.which===3&&u.stopPropagation()}),this.eventManager.addEventListener(i,"contextmenu",function(u){u.target===i&&u.which===3&&u.stopPropagation()}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",function(){r.settings.observeDOMVisibility&&r._wt.drawInterrupted&&(r.instance.forceFullRender=!0,r.render())})}},{key:"isTextSelectionAllowed",value:function(r){if(Yc(r))return!0;var n=vi(r,this.instance.view._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}},{key:"isMouseDown",value:function(){return Wi.get(this).mouseDown}},{key:"isSelectedOnlyCell",value:function(){var r,n;return(r=(n=this.instance.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())!==null&&r!==void 0?r:!1}},{key:"isCellEdited",value:function(){var r=this.instance.getActiveEditor();return r&&r.isOpened()}},{key:"beforeRender",value:function(r,n){r&&this.instance.runHooks("beforeViewRender",this.instance.forceFullRender,n)}},{key:"afterRender",value:function(r){r&&this.instance.runHooks("afterViewRender",this.instance.forceFullRender)}},{key:"appendRowHeader",value:function(r,n){if(n.firstChild){var o=n.firstChild;if(!xe(o,"relative")){gn(n),this.appendRowHeader(r,n);return}this.updateCellHeader(o.querySelector(".rowHeader"),r,this.instance.getRowHeader)}else{var i=this.instance,a=i.rootDocument,l=i.getRowHeader,s=a.createElement("div"),u=a.createElement("span");s.className="relative",u.className="rowHeader",this.updateCellHeader(u,r,l),s.appendChild(u),n.appendChild(s)}this.instance.runHooks("afterGetRowHeader",r,n)}},{key:"appendColHeader",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.instance.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(n.firstChild){var a=n.firstChild;xe(a,"relative")?this.updateCellHeader(a.querySelector(".colHeader"),r,o,i):(gn(n),this.appendColHeader(r,n,o,i))}else{var l=this.instance.rootDocument,s=l.createElement("div"),u=l.createElement("span");s.className="relative",u.className="colHeader",this.updateCellHeader(u,r,o,i),s.appendChild(u),n.appendChild(s)}this.instance.runHooks("afterGetColHeader",r,n,i)}},{key:"updateCellHeader",value:function(r,n,o){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,a=n,l=this._wt.wtOverlays.getParentOverlay(r)||this._wt;r.parentNode&&(xe(r,"colHeader")?a=l.wtTable.columnFilter.sourceToRendered(n):xe(r,"rowHeader")&&(a=l.wtTable.rowFilter.sourceToRendered(n))),a>-1?ol(r,o(n,i)):(Ei(r,String.fromCharCode(160)),re(r,"cornerHeader"))}},{key:"maximumVisibleElementWidth",value:function(r){var n=this._wt.wtViewport.getWorkspaceWidth(),o=n-r;return o>0?o:0}},{key:"maximumVisibleElementHeight",value:function(r){var n=this._wt.wtViewport.getWorkspaceHeight(),o=n-r;return o>0?o:0}},{key:"setLastSize",value:function(r,n){var o=Wi.get(this),i=[r,n];o.lastWidth=i[0],o.lastHeight=i[1]}},{key:"getLastSize",value:function(){var r=Wi.get(this);return{width:r.lastWidth,height:r.lastHeight}}},{key:"getFirstFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleRow())}},{key:"getLastFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleRow())}},{key:"getFirstFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleColumn())}},{key:"getLastFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleColumn())}},{key:"getColumnHeadersCount",value:function(){return jI(this,$w)}},{key:"getRowHeadersCount",value:function(){return jI(this,Aw)}},{key:"destroy",value:function(){this._wt.destroy(),this.eventManager.destroy()}}]),e}();const bge=mge;function k_(e){"@babel/helpers - typeof";return k_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},k_(e)}var rW="ABCDEFGHIJKLMNOPQRSTUVWXYZ",P_=rW.length;function Fm(e){for(var t=e+1,r="",n;t>0;)n=(t-1)%P_,r=String.fromCharCode(65+n)+r,t=parseInt((t-n)/P_,10);return r}function wge(e){var t=0;if(e)for(var r=0,n=e.length-1;r<e.length;r+=1,n-=1)t+=Math.pow(P_,n)*(rW.indexOf(e[r])+1);return t-=1,t}function Sge(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4,r=[],n,o;for(n=0;n<e;n++){var i=[];for(o=0;o<t;o++)i.push(Fm(o)+(n+1));r.push(i)}return r}function Cge(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4,r=[],n,o;for(n=0;n<e;n++){var i={};for(o=0;o<t;o++)i["prop".concat(o)]=Fm(o)+(n+1);r.push(i)}return r}function _ge(e,t){for(var r=[],n,o=0;o<e;o++){n=[];for(var i=0;i<t;i++)n.push("");r.push(n)}return r}function $_(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=e,n=[];return(!Array.isArray(e)||!Array.isArray(e[0]))&&(r=[e]),r.forEach(function(o,i){Array.isArray(o)?o.forEach(function(a,l){n.push([i+t,l,a])}):Object.keys(o).forEach(function(a){n.push([i+t,a,o[a]])})}),n}function VE(e){var t=0;return Array.isArray(e)&&(e[0]&&Array.isArray(e[0])?t=e[0].length:e[0]&&Ve(e[0])&&(t=Sm(e[0]))),t}function nW(e){return!!(Array.isArray(e)&&e.length&&e.every(function(t){return Array.isArray(t)}))}function oW(e){return!!(Array.isArray(e)&&e.length&&e.every(function(t){return k_(t)==="object"&&!Array.isArray(t)&&t!==null}))}const Oge=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:VE,createEmptySpreadsheetData:_ge,createSpreadsheetData:Sge,createSpreadsheetObjectData:Cge,dataRowToChangesArray:$_,isArrayOfArrays:nW,isArrayOfObjects:oW,spreadsheetColumnIndex:wge,spreadsheetColumnLabel:Fm},Symbol.toStringTag,{value:"Module"}));function Ch(e){"@babel/helpers - typeof";return Ch=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ch(e)}function Rge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Tge(n.key),n)}}function Ege(e,t,r){return t&&BI(e.prototype,t),r&&BI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Tge(e){var t=kge(e,"string");return Ch(t)==="symbol"?t:String(t)}function kge(e,t){if(Ch(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ch(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Pge=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Rge(this,e),this.hot=t,this.data=r,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}}return Ege(e,[{key:"modifyRowData",value:function(r){var n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",r)),n!==void 0&&!Number.isInteger(n)?n:this.data[r]}},{key:"getData",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,r)}},{key:"setData",value:function(r){this.data=r}},{key:"getAtColumn",value:function(r){var n=this,o=[];return $(this.data,function(i,a){var l=n.getAtCell(a,r);o.push(l)}),o}},{key:"getAtRow",value:function(r,n,o){var i=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,l=n===void 0&&o===void 0,s=null,u=null;if(s=this.modifyRowData(r),Array.isArray(s))u=[],l?s.forEach(function(h,d){u[d]=i.getAtPhysicalCell(r,d,s)}):_e(n,o,function(h){u[h-n]=i.getAtPhysicalCell(r,h,s)});else if(Ve(s)||bt(s))if(a?u=[]:u={},!l||a){var f=0,c=this.countFirstRowKeys()-1;_e(f,c,function(h){var d=i.colToProp(h);if(h>=(n||f)&&h<=(o||c)&&!Number.isInteger(d)){var v=i.getAtPhysicalCell(r,d,s);a?u.push(v):Zy(u,d,v)}})}else We(s,function(h,d){Zy(u,d,i.getAtPhysicalCell(r,d,s))});return u}},{key:"setAtCell",value:function(r,n,o){if(!(r>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){var i=Da(o);this.hot.runHooks("modifySourceData",r,n,i,"set"),i.isTouched()&&(o=i.value)}Number.isInteger(n)?this.data[r][n]=o:Zy(this.data[r],n,o)}}},{key:"getAtPhysicalCell",value:function(r,n,o){var i=null;if(o&&(typeof n=="string"?i=mB(o,n):typeof n=="function"?i=n(o):i=o[n]),this.hot.hasHook("modifySourceData")){var a=Da(i);this.hot.runHooks("modifySourceData",r,n,a,"get"),a.isTouched()&&(i=a.value)}return i}},{key:"getAtCell",value:function(r,n){var o=this.modifyRowData(r);return this.getAtPhysicalCell(r,this.colToProp(n),o)}},{key:"getByRange",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=!1,l=null,s=null,u=null,f=null;n===null||o===null?(a=!0,l=0,u=this.countRows()-1):(l=Math.min(n.row,o.row),s=Math.min(n.col,o.col),u=Math.max(n.row,o.row),f=Math.max(n.col,o.col));var c=[];return _e(l,u,function(h){c.push(a?r.getAtRow(h,void 0,void 0,i):r.getAtRow(h,s,f,i))}),c}},{key:"countRows",value:function(){if(this.hot.hasHook("modifySourceLength")){var r=this.hot.runHooks("modifySourceLength");if(Number.isInteger(r))return r}return this.data.length}},{key:"countFirstRowKeys",value:function(){return VE(this.data)}},{key:"destroy",value:function(){this.data=null,this.hot=null}}]),e}();const $ge=Pge;var VI=Mt,Age=function(e){return e!==void 0&&(VI(e,"value")||VI(e,"writable"))},Ige=Ae,Mge=zt,xge=Nt,Dge=Ht,Nge=Age,Hge=jn,Lge=sv;function iW(e,t){var r=arguments.length<3?e:arguments[2],n,o;if(Dge(e)===r)return e[t];if(n=Hge.f(e,t),n)return Nge(n)?n.value:n.get===void 0?void 0:Mge(n.get,r);if(xge(o=Lge(e)))return iW(o,t,r)}Ige({target:"Reflect",stat:!0},{get:iW});var jge=Ae,Fge=je,Bge=Br,aW=jn.f,lW=Ut,Vge=!lW||Fge(function(){aW(1)});jge({target:"Object",stat:!0,forced:Vge,sham:!lW},{getOwnPropertyDescriptor:function(t,r){return aW(Bge(t),r)}});var Wge="localHooks",sW={_localHooks:Object.create(null),addLocalHook:function(t,r){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(r),this},runLocalHooks:function(t,r,n,o,i,a,l){if(this._localHooks[t])for(var s=this._localHooks[t].length,u=0;u<s;u++)qg(this._localHooks[t][u],this,r,n,o,i,a,l)},clearLocalHooks:function(){return this._localHooks={},this}};Bn(sW,"MIXIN_NAME",Wge,{writable:!1,enumerable:!1});const Pr=sW;function _h(e){"@babel/helpers - typeof";return _h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_h(e)}function Uge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Yge(n.key),n)}}function zge(e,t,r){return t&&WI(e.prototype,t),r&&WI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Yge(e){var t=Gge(e,"string");return _h(t)==="symbol"?t:String(t)}function Gge(e,t){if(_h(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_h(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var il=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Uge(this,e),this.indexedValues=[],this.initValueOrFn=t}return zge(e,[{key:"getValues",value:function(){return this.indexedValues}},{key:"getValueAtIndex",value:function(r){var n=this.indexedValues;if(r<n.length)return n[r]}},{key:"setValues",value:function(r){this.indexedValues=r.slice(),this.runLocalHooks("change")}},{key:"setValueAtIndex",value:function(r,n){return r<this.indexedValues.length?(this.indexedValues[r]=n,this.runLocalHooks("change"),!0):!1}},{key:"clear",value:function(){this.setDefaultValues()}},{key:"getLength",value:function(){return this.getValues().length}},{key:"setDefaultValues",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,bt(this.initValueOrFn)?_e(n-1,function(o){return r.indexedValues.push(r.initValueOrFn(o))}):_e(n-1,function(){return r.indexedValues.push(r.initValueOrFn)}),this.runLocalHooks("change")}},{key:"init",value:function(r){return this.setDefaultValues(r),this.runLocalHooks("init"),this}},{key:"insert",value:function(){this.runLocalHooks("change")}},{key:"remove",value:function(){this.runLocalHooks("change")}},{key:"destroy",value:function(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}]),e}();pt(il,Pr);function Iw(e){return Zge(e)||Xge(e)||qge(e)||Kge()}function Kge(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qge(e,t){if(e){if(typeof e=="string")return A_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return A_(e,t)}}function Xge(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Zge(e){if(Array.isArray(e))return A_(e)}function A_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function WE(e,t,r,n){var o=r.length?r[0]:void 0;return[].concat(Iw(e.slice(0,o)),Iw(r.map(function(i,a){return bt(n)?n(i,a):n})),Iw(o===void 0?[]:e.slice(o)))}function UE(e,t){return jr(e,function(r,n){return t.includes(n)===!1})}function Ls(e){"@babel/helpers - typeof";return Ls=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ls(e)}function Jge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,epe(n.key),n)}}function Qge(e,t,r){return t&&UI(e.prototype,t),r&&UI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function epe(e){var t=tpe(e,"string");return Ls(t)==="symbol"?t:String(t)}function tpe(e,t){if(Ls(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ls(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Tc(){return typeof Reflect<"u"&&Reflect.get?Tc=Reflect.get.bind():Tc=function(t,r,n){var o=rpe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Tc.apply(this,arguments)}function rpe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ba(e),e!==null););return e}function npe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&I_(e,t)}function I_(e,t){return I_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},I_(e,t)}function ope(e){var t=lpe();return function(){var n=Ba(e),o;if(t){var i=Ba(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return ipe(this,o)}}function ipe(e,t){if(t&&(Ls(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ape(e)}function ape(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lpe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ba(e){return Ba=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ba(e)}var Mi=function(e){npe(r,e);var t=ope(r);function r(){return Jge(this,r),t.apply(this,arguments)}return Qge(r,[{key:"insert",value:function(o,i){this.indexedValues=WE(this.indexedValues,o,i,this.initValueOrFn),Tc(Ba(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){this.indexedValues=UE(this.indexedValues,o),Tc(Ba(r.prototype),"remove",this).call(this,o)}}]),r}(il);function js(e){"@babel/helpers - typeof";return js=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},js(e)}function spe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fpe(n.key),n)}}function upe(e,t,r){return t&&zI(e.prototype,t),r&&zI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fpe(e){var t=cpe(e,"string");return js(t)==="symbol"?t:String(t)}function cpe(e,t){if(js(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(js(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hpe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&M_(e,t)}function M_(e,t){return M_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},M_(e,t)}function dpe(e){var t=gpe();return function(){var n=Ep(e),o;if(t){var i=Ep(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return vpe(this,o)}}function vpe(e,t){if(t&&(js(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ype(e)}function ype(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gpe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ep(e){return Ep=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ep(e)}var Bm=function(e){hpe(r,e);var t=dpe(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return spe(this,r),t.call(this,n)}return upe(r,[{key:"getHiddenIndexes",value:function(){return Lt(this.getValues(),function(o,i,a){return i&&o.push(a),o},[])}}]),r}(Mi);function Mw(e){return wpe(e)||bpe(e)||mpe(e)||ppe()}function ppe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mpe(e,t){if(e){if(typeof e=="string")return x_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return x_(e,t)}}function bpe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function wpe(e){if(Array.isArray(e))return x_(e)}function x_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function zE(e,t,r){return[].concat(Mw(e.slice(0,t)),Mw(r),Mw(e.slice(t)))}function Oh(e,t){return jr(e,function(r){return t.includes(r)===!1})}function YE(e,t){return Be(e,function(r){return r-t.filter(function(n){return n<r}).length})}function GE(e,t){var r=t[0],n=t.length;return Be(e,function(o){return o>=r?o+n:o})}function Fs(e){"@babel/helpers - typeof";return Fs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fs(e)}function Spe(e){return Rpe(e)||Ope(e)||_pe(e)||Cpe()}function Cpe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _pe(e,t){if(e){if(typeof e=="string")return D_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return D_(e,t)}}function Ope(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Rpe(e){if(Array.isArray(e))return D_(e)}function D_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Epe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fW(n.key),n)}}function Tpe(e,t,r){return t&&YI(e.prototype,t),r&&YI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function no(){return typeof Reflect<"u"&&Reflect.get?no=Reflect.get.bind():no=function(t,r,n){var o=kpe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},no.apply(this,arguments)}function kpe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=un(e),e!==null););return e}function Ppe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&N_(e,t)}function N_(e,t){return N_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},N_(e,t)}function $pe(e){var t=Ipe();return function(){var n=un(e),o;if(t){var i=un(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Ape(this,o)}}function Ape(e,t){if(t&&(Fs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return uW(e)}function uW(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ipe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function un(e){return un=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},un(e)}function Mpe(e,t,r){return t=fW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fW(e){var t=xpe(e,"string");return Fs(t)==="symbol"?t:String(t)}function xpe(e,t){if(Fs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Vm=function(e){Ppe(r,e);var t=$pe(r);function r(){var n;Epe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),Mpe(uW(n),"orderOfIndexes",[]),n}return Tpe(r,[{key:"getValues",value:function(){var o=this;return this.orderOfIndexes.map(function(i){return o.indexedValues[i]})}},{key:"setValues",value:function(o){this.orderOfIndexes=Spe(Array(o.length).keys()),no(un(r.prototype),"setValues",this).call(this,o)}},{key:"setValueAtIndex",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return o<this.indexedValues.length?(this.indexedValues[o]=i,this.orderOfIndexes.includes(o)===!1&&this.orderOfIndexes.splice(a,0,o),this.runLocalHooks("change"),!0):!1}},{key:"clearValue",value:function(o){this.orderOfIndexes=Oh(this.orderOfIndexes,[o]),bt(this.initValueOrFn)?no(un(r.prototype),"setValueAtIndex",this).call(this,o,this.initValueOrFn(o)):no(un(r.prototype),"setValueAtIndex",this).call(this,o,this.initValueOrFn)}},{key:"getLength",value:function(){return this.orderOfIndexes.length}},{key:"setDefaultValues",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,no(un(r.prototype),"setDefaultValues",this).call(this,o)}},{key:"insert",value:function(o,i){this.indexedValues=WE(this.indexedValues,o,i,this.initValueOrFn),this.orderOfIndexes=GE(this.orderOfIndexes,i),no(un(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){this.indexedValues=UE(this.indexedValues,o),this.orderOfIndexes=Oh(this.orderOfIndexes,o),this.orderOfIndexes=YE(this.orderOfIndexes,o),no(un(r.prototype),"remove",this).call(this,o)}},{key:"getEntries",value:function(){var o=this;return this.orderOfIndexes.map(function(i){return[i,o.getValueAtIndex(i)]})}}]),r}(il);function Bs(e){"@babel/helpers - typeof";return Bs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bs(e)}function Dpe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Hpe(n.key),n)}}function Npe(e,t,r){return t&&GI(e.prototype,t),r&&GI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hpe(e){var t=Lpe(e,"string");return Bs(t)==="symbol"?t:String(t)}function Lpe(e,t){if(Bs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jpe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&H_(e,t)}function H_(e,t){return H_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},H_(e,t)}function Fpe(e){var t=Wpe();return function(){var n=Tp(e),o;if(t){var i=Tp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Bpe(this,o)}}function Bpe(e,t){if(t&&(Bs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Vpe(e)}function Vpe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Wpe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Tp(e){return Tp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Tp(e)}var Ev=function(e){jpe(r,e);var t=Fpe(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return Dpe(this,r),t.call(this,n)}return Npe(r,[{key:"getTrimmedIndexes",value:function(){return Lt(this.getValues(),function(o,i,a){return i&&o.push(a),o},[])}}]),r}(Mi),KI=new Map([["indexesSequence",{getListWithInsertedItems:zE,getListWithRemovedItems:Oh}],["physicallyIndexed",{getListWithInsertedItems:WE,getListWithRemovedItems:UE}]]),cW=function(t){if(KI.has(t)===!1)throw new Error("Alter strategy with ID '".concat(t,"' does not exist."));return KI.get(t)};function Vs(e){"@babel/helpers - typeof";return Vs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vs(e)}function Upe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ype(n.key),n)}}function zpe(e,t,r){return t&&qI(e.prototype,t),r&&qI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ype(e){var t=Gpe(e,"string");return Vs(t)==="symbol"?t:String(t)}function Gpe(e,t){if(Vs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kc(){return typeof Reflect<"u"&&Reflect.get?kc=Reflect.get.bind():kc=function(t,r,n){var o=Kpe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},kc.apply(this,arguments)}function Kpe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Va(e),e!==null););return e}function qpe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&L_(e,t)}function L_(e,t){return L_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},L_(e,t)}function Xpe(e){var t=Qpe();return function(){var n=Va(e),o;if(t){var i=Va(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Zpe(this,o)}}function Zpe(e,t){if(t&&(Vs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Jpe(e)}function Jpe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Qpe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Va(e){return Va=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Va(e)}var hW=function(e){qpe(r,e);var t=Xpe(r);function r(){return Upe(this,r),t.call(this,function(n){return n})}return zpe(r,[{key:"insert",value:function(o,i){var a=GE(this.indexedValues,i);this.indexedValues=zE(a,o,i),kc(Va(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){var i=Oh(this.indexedValues,o);this.indexedValues=YE(i,o),kc(Va(r.prototype),"remove",this).call(this,o)}}]),r}(il),XI=new Map([["hiding",Bm],["index",il],["linkedPhysicalIndexToValue",Vm],["physicalIndexToValue",Mi],["trimming",Ev]]);function eme(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!XI.has(e))throw new Error('The provided map type ("'.concat(e,'") does not exist.'));return new(XI.get(e))(t)}function Rh(e){"@babel/helpers - typeof";return Rh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rh(e)}function tme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nme(n.key),n)}}function rme(e,t,r){return t&&ZI(e.prototype,t),r&&ZI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nme(e){var t=ome(e,"string");return Rh(t)==="symbol"?t:String(t)}function ome(e,t){if(Rh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var j_=0,KE=function(){function e(){tme(this,e),this.collection=new Map}return rme(e,[{key:"register",value:function(r,n){var o=this;this.collection.has(r)===!1&&(this.collection.set(r,n),n.addLocalHook("change",function(){return o.runLocalHooks("change",n)}),j_+=1)}},{key:"unregister",value:function(r){var n=this.collection.get(r);ve(n)&&(n.destroy(),this.collection.delete(r),this.runLocalHooks("change",n),j_-=1)}},{key:"unregisterAll",value:function(){var r=this;this.collection.forEach(function(n,o){return r.unregister(o)}),this.collection.clear()}},{key:"get",value:function(r){return gt(r)?Array.from(this.collection.values()):this.collection.get(r)}},{key:"getLength",value:function(){return this.collection.size}},{key:"removeFromEvery",value:function(r){this.collection.forEach(function(n){n.remove(r)})}},{key:"insertToEvery",value:function(r,n){this.collection.forEach(function(o){o.insert(r,n)})}},{key:"initEvery",value:function(r){this.collection.forEach(function(n){n.init(r)})}}]),e}();pt(KE,Pr);function ime(){return j_}function Ws(e){"@babel/helpers - typeof";return Ws=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ws(e)}function ame(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sme(n.key),n)}}function lme(e,t,r){return t&&JI(e.prototype,t),r&&JI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sme(e){var t=ume(e,"string");return Ws(t)==="symbol"?t:String(t)}function ume(e,t){if(Ws(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ws(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fme(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&F_(e,t)}function F_(e,t){return F_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},F_(e,t)}function cme(e){var t=vme();return function(){var n=kp(e),o;if(t){var i=kp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return hme(this,o)}}function hme(e,t){if(t&&(Ws(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dme(e)}function dme(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vme(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function kp(e){return kp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},kp(e)}var QI=function(e){fme(r,e);var t=cme(r);function r(n,o){var i;return ame(this,r),i=t.call(this),i.mergedValuesCache=[],i.aggregationFunction=n,i.fallbackValue=o,i}return lme(r,[{key:"getMergedValues",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(o===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];for(var i=Be(this.get(),function(c){return c.getValues()}),a=[],l=ve(i[0])&&i[0].length||0,s=0;s<l;s+=1){for(var u=[],f=0;f<this.getLength();f+=1)u.push(i[f][s]);a.push(u)}return Be(a,this.aggregationFunction)}},{key:"getMergedValueAtIndex",value:function(o,i){var a=this.getMergedValues(i)[o];return ve(a)?a:this.fallbackValue}},{key:"updateCache",value:function(){this.mergedValuesCache=this.getMergedValues(!1)}}]),r}(KE);function Eh(e){"@babel/helpers - typeof";return Eh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Eh(e)}function yme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pme(n.key),n)}}function gme(e,t,r){return t&&eM(e.prototype,t),r&&eM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pme(e){var t=mme(e,"string");return Eh(t)==="symbol"?t:String(t)}function mme(e,t){if(Eh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Eh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bme(e,t,r){wme(e,t),t.set(e,r)}function wme(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sme(e,t,r){var n=dW(e,t,"set");return Cme(e,n,r),r}function Cme(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function _me(e,t){var r=dW(e,t,"get");return Ome(e,r)}function dW(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Ome(e,t){return t.get?t.get.call(e):t.value}var xw=new WeakMap,vW=function(){function e(){yme(this,e),bme(this,xw,{writable:!0,value:[]})}return gme(e,[{key:"subscribe",value:function(r){return this.addLocalHook("change",r),this._write(_me(this,xw)),this}},{key:"unsubscribe",value:function(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}},{key:"_write",value:function(r){return r.length>0&&this.runLocalHooks("change",r),this}},{key:"_writeInitialChanges",value:function(r){Sme(this,xw,r)}}]),e}();pt(vW,Pr);function tM(e,t){for(var r=[],n=0,o=0;n<e.length&&o<t.length;n++,o++)e[n]!==t[o]&&r.push({op:"replace",index:o,oldValue:e[n],newValue:t[o]});for(;n<t.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:t[n]});for(;o<e.length;o++)r.push({op:"remove",index:o,oldValue:e[o],newValue:void 0});return r}function Th(e){"@babel/helpers - typeof";return Th=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Th(e)}function Rme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Tme(n.key),n)}}function Eme(e,t,r){return t&&rM(e.prototype,t),r&&rM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Tme(e){var t=kme(e,"string");return Th(t)==="symbol"?t:String(t)}function kme(e,t){if(Th(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Th(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gf(e,t,r){Pme(e,t),t.set(e,r)}function Pme(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ur(e,t){var r=yW(e,t,"get");return $me(e,r)}function $me(e,t){return t.get?t.get.call(e):t.value}function ly(e,t,r){var n=yW(e,t,"set");return Ame(e,n,r),r}function yW(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Ame(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var sy=new WeakMap,Kf=new WeakMap,uy=new WeakMap,fy=new WeakMap,cy=new WeakMap,Ime=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.initialIndexValue;Rme(this,e),Gf(this,sy,{writable:!0,value:new Set}),Gf(this,Kf,{writable:!0,value:[]}),Gf(this,uy,{writable:!0,value:[]}),Gf(this,fy,{writable:!0,value:!1}),Gf(this,cy,{writable:!0,value:!1}),ly(this,cy,r??!1)}return Eme(e,[{key:"createObserver",value:function(){var r=this,n=new vW;return Ur(this,sy).add(n),n.addLocalHook("unsubscribe",function(){Ur(r,sy).delete(n)}),n._writeInitialChanges(tM(Ur(this,Kf),Ur(this,uy))),n}},{key:"emit",value:function(r){var n=Ur(this,uy);(!Ur(this,fy)||Ur(this,Kf).length!==r.length)&&(r.length===0?r=new Array(n.length).fill(Ur(this,cy)):ly(this,Kf,new Array(r.length).fill(Ur(this,cy))),Ur(this,fy)||(ly(this,fy,!0),n=Ur(this,Kf)));var o=tM(n,r);Ur(this,sy).forEach(function(i){return i._write(o)}),ly(this,uy,r)}}]),e}();function kh(e){"@babel/helpers - typeof";return kh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kh(e)}var nM;function Dw(e){return Nme(e)||Dme(e)||xme(e)||Mme()}function Mme(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xme(e,t){if(e){if(typeof e=="string")return B_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return B_(e,t)}}function Dme(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Nme(e){if(Array.isArray(e))return B_(e)}function B_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Hme(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Lme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Fme(n.key),n)}}function jme(e,t,r){return t&&oM(e.prototype,t),r&&oM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Fme(e){var t=Bme(e,"string");return kh(t)==="symbol"?t:String(t)}function Bme(e,t){if(kh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(kh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var iM=new Set(["getFirstNotHiddenIndex"]),V_=function(){function e(){var t=this;Lme(this,e),this.indexesSequence=new hW,this.trimmingMapsCollection=new QI(function(r){return r.some(function(n){return n===!0})},!1),this.hidingMapsCollection=new QI(function(r){return r.some(function(n){return n===!0})},!1),this.variousMapsCollection=new KE,this.hidingChangesObservable=new Ime({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.indexesChangeSource=void 0,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",function(){t.indexesSequenceChanged=!0,t.updateCache(),t.runLocalHooks("indexesSequenceChange",t.indexesChangeSource),t.runLocalHooks("change",t.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",function(r){t.trimmedIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",r,t.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",function(r){t.hiddenIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",r,t.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",function(r){t.runLocalHooks("change",r,t.variousMapsCollection)})}return jme(e,[{key:"suspendOperations",value:function(){this.isBatched=!0}},{key:"resumeOperations",value:function(){this.isBatched=!1,this.updateCache()}},{key:"createChangesObserver",value:function(r){if(r!=="hiding")throw new Error('Unsupported index map type "'.concat(r,'".'));return this.hidingChangesObservable.createObserver()}},{key:"createAndRegisterIndexMap",value:function(r,n,o){return this.registerMap(r,eme(n,o))}},{key:"registerMap",value:function(r,n){if(this.trimmingMapsCollection.get(r)||this.hidingMapsCollection.get(r)||this.variousMapsCollection.get(r))throw Error('Map with name "'.concat(r,'" has been already registered.'));n instanceof Ev?this.trimmingMapsCollection.register(r,n):n instanceof Bm?this.hidingMapsCollection.register(r,n):this.variousMapsCollection.register(r,n);var o=this.getNumberOfIndexes();return o>0&&n.init(o),n}},{key:"unregisterMap",value:function(r){this.trimmingMapsCollection.unregister(r),this.hidingMapsCollection.unregister(r),this.variousMapsCollection.unregister(r)}},{key:"unregisterAll",value:function(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}},{key:"getPhysicalFromVisualIndex",value:function(r){var n=this.notTrimmedIndexesCache[r];return ve(n)?n:null}},{key:"getPhysicalFromRenderableIndex",value:function(r){var n=this.renderablePhysicalIndexesCache[r];return ve(n)?n:null}},{key:"getVisualFromPhysicalIndex",value:function(r){var n=this.fromPhysicalToVisualIndexesCache.get(r);return ve(n)?n:null}},{key:"getVisualFromRenderableIndex",value:function(r){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(r))}},{key:"getRenderableFromVisualIndex",value:function(r){var n=this.fromVisualToRenderableIndexesCache.get(r);return ve(n)?n:null}},{key:"getFirstNotHiddenIndex",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:r-n;iM.has("getFirstNotHiddenIndex")&&(iM.delete("getFirstNotHiddenIndex"),ht(ft(nM||(nM=Hme([`The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next 
                        major release. Please use "getNearestNotHiddenIndex" instead.`],[`The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next\\x20
                        major release. Please use "getNearestNotHiddenIndex" instead.`])))));var a=this.getPhysicalFromVisualIndex(r);return a===null?o===!0&&i!==r-n?this.getFirstNotHiddenIndex(i,-n,!1,i):null:this.isHidden(a)===!1?r:this.getFirstNotHiddenIndex(r+n,n,o,i)}},{key:"getNearestNotHiddenIndex",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.getPhysicalFromVisualIndex(r);if(i===null)return null;if(this.fromVisualToRenderableIndexesCache.has(r))return r;var a=Array.from(this.fromVisualToRenderableIndexesCache.keys()),l=-1;return n>0?l=a.findIndex(function(s){return s>r}):l=a.reverse().findIndex(function(s){return s<r}),l===-1?o?this.getNearestNotHiddenIndex(r,-n,!1):null:a[l]}},{key:"initToLength",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=Dw(new Array(r).keys()),this.notHiddenIndexesCache=Dw(new Array(r).keys()),this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(r),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(r),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(r),this.variousMapsCollection.initEvery(r),this.resumeOperations(),this.runLocalHooks("init")}},{key:"fitToLength",value:function(r){var n=this.getNumberOfIndexes();if(r<n){var o=Dw(Array(this.getNumberOfIndexes()-r).keys()).map(function(i){return i+r});this.removeIndexes(o)}else this.insertIndexes(n,r-n)}},{key:"getIndexesSequence",value:function(){return this.indexesSequence.getValues()}},{key:"setIndexesSequence",value:function(r){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(r),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}},{key:"getNotTrimmedIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.notTrimmedIndexesCache;var o=this.getIndexesSequence();return o.filter(function(i){return r.isTrimmed(i)===!1})}},{key:"getNotTrimmedIndexesLength",value:function(){return this.getNotTrimmedIndexes().length}},{key:"getNotHiddenIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.notHiddenIndexesCache;var o=this.getIndexesSequence();return o.filter(function(i){return r.isHidden(i)===!1})}},{key:"getNotHiddenIndexesLength",value:function(){return this.getNotHiddenIndexes().length}},{key:"getRenderableIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.renderablePhysicalIndexesCache;var o=this.getNotTrimmedIndexes();return o.filter(function(i){return r.isHidden(i)===!1})}},{key:"getRenderableIndexesLength",value:function(){return this.getRenderableIndexes().length}},{key:"getNumberOfIndexes",value:function(){return this.getIndexesSequence().length}},{key:"moveIndexes",value:function(r,n){var o=this;typeof r=="number"&&(r=[r]);var i=Be(r,function(c){return o.getPhysicalFromVisualIndex(c)}),a=this.getNotTrimmedIndexesLength(),l=r.length,s=Oh(this.getIndexesSequence(),i),u=a-l;if(n+l<a){var f=s.filter(function(c){return o.isTrimmed(c)===!1})[n];u=s.indexOf(f)}this.indexesChangeSource="move",this.setIndexesSequence(zE(s,u,i)),this.indexesChangeSource=void 0}},{key:"isTrimmed",value:function(r){return this.trimmingMapsCollection.getMergedValueAtIndex(r)}},{key:"isHidden",value:function(r){return this.hidingMapsCollection.getMergedValueAtIndex(r)}},{key:"insertIndexes",value:function(r,n){var o=this.getNotTrimmedIndexes()[r],i=ve(o)?o:this.getNumberOfIndexes(),a=this.getIndexesSequence().includes(o)?this.getIndexesSequence().indexOf(o):this.getNumberOfIndexes(),l=Be(new Array(n).fill(i),function(s,u){return s+u});this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(a,l),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(a,l),this.hidingMapsCollection.insertToEvery(a,l),this.variousMapsCollection.insertToEvery(a,l),this.resumeOperations()}},{key:"removeIndexes",value:function(r){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(r),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(r),this.hidingMapsCollection.removeFromEvery(r),this.variousMapsCollection.removeFromEvery(r),this.resumeOperations()}},{key:"updateCache",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(r===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}},{key:"cacheFromPhysicalToVisualIndexes",value:function(){var r=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(var n=0;n<r;n+=1){var o=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(o,n)}}},{key:"cacheFromVisualToRenderableIndexes",value:function(){var r=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(var n=0;n<r;n+=1){var o=this.getPhysicalFromRenderableIndex(n),i=this.getVisualFromPhysicalIndex(o);this.fromVisualToRenderableIndexesCache.set(i,n)}}}]),e}();pt(V_,Pr);var aM;function Vme(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Wme(e,t){return We(t,function(r,n){gt(e[n])&&(e[n]=r)}),e}function gW(e){var t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/,r=t.exec(e);return r?"".concat(r[1].toLowerCase(),"-").concat(r[2].toUpperCase()):e}function pW(e){ve(e)&&_E(ft(aM||(aM=Vme(['Language with code "',`" was not found. You should register particular language 
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`],['Language with code "',`" was not found. You should register particular language\\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`])),e))}function Ume(e,t){var r=Array.isArray(e)&&Number.isInteger(t);return r?e[t]:e}var mW=en("phraseFormatters"),zme=mW.register,Yme=mW.getValues;function Gme(e,t){zme(e,t)}function Kme(){return Yme()}Gme("pluralize",Ume);var bW="ContextMenu:items",Fe=bW,qE="".concat(Fe,".noItems"),XE="".concat(Fe,".insertRowAbove"),ZE="".concat(Fe,".insertRowBelow"),JE="".concat(Fe,".insertColumnOnTheLeft"),QE="".concat(Fe,".insertColumnOnTheRight"),eT="".concat(Fe,".removeRow"),tT="".concat(Fe,".removeColumn"),rT="".concat(Fe,".undo"),nT="".concat(Fe,".redo"),oT="".concat(Fe,".readOnly"),iT="".concat(Fe,".clearColumn"),aT="".concat(Fe,".copy"),lT="".concat(Fe,".copyWithHeaders"),sT="".concat(Fe,".copyWithGroupHeaders"),uT="".concat(Fe,".copyHeadersOnly"),fT="".concat(Fe,".cut"),cT="".concat(Fe,".freezeColumn"),hT="".concat(Fe,".unfreezeColumn"),dT="".concat(Fe,".mergeCells"),vT="".concat(Fe,".unmergeCells"),yT="".concat(Fe,".addComment"),gT="".concat(Fe,".editComment"),pT="".concat(Fe,".removeComment"),mT="".concat(Fe,".readOnlyComment"),bT="".concat(Fe,".align"),wT="".concat(Fe,".align.left"),ST="".concat(Fe,".align.center"),CT="".concat(Fe,".align.right"),_T="".concat(Fe,".align.justify"),OT="".concat(Fe,".align.top"),RT="".concat(Fe,".align.middle"),ET="".concat(Fe,".align.bottom"),TT="".concat(Fe,".borders"),kT="".concat(Fe,".borders.top"),PT="".concat(Fe,".borders.right"),$T="".concat(Fe,".borders.bottom"),AT="".concat(Fe,".borders.left"),IT="".concat(Fe,".borders.remove"),MT="".concat(Fe,".nestedHeaders.insertChildRow"),xT="".concat(Fe,".nestedHeaders.detachFromParent"),DT="".concat(Fe,".hideColumn"),NT="".concat(Fe,".showColumn"),HT="".concat(Fe,".hideRow"),LT="".concat(Fe,".showRow"),wr="Filters:",xt="".concat(wr,"conditions"),Wm="".concat(xt,".none"),jT="".concat(xt,".isEmpty"),FT="".concat(xt,".isNotEmpty"),BT="".concat(xt,".isEqualTo"),VT="".concat(xt,".isNotEqualTo"),WT="".concat(xt,".beginsWith"),UT="".concat(xt,".endsWith"),zT="".concat(xt,".contains"),YT="".concat(xt,".doesNotContain"),qme="".concat(xt,".byValue"),GT="".concat(xt,".greaterThan"),KT="".concat(xt,".greaterThanOrEqualTo"),qT="".concat(xt,".lessThan"),XT="".concat(xt,".lessThanOrEqualTo"),ZT="".concat(xt,".isBetween"),JT="".concat(xt,".isNotBetween"),QT="".concat(xt,".after"),ek="".concat(xt,".before"),tk="".concat(xt,".today"),rk="".concat(xt,".tomorrow"),nk="".concat(xt,".yesterday"),ok="".concat(wr,"labels.filterByCondition"),ik="".concat(wr,"labels.filterByValue"),ak="".concat(wr,"labels.conjunction"),Um="".concat(wr,"labels.disjunction"),Pp="".concat(wr,"values.blankCells"),lk="".concat(wr,"buttons.selectAll"),sk="".concat(wr,"buttons.clear"),uk="".concat(wr,"buttons.ok"),fk="".concat(wr,"buttons.cancel"),ck="".concat(wr,"buttons.placeholder.search"),hk="".concat(wr,"buttons.placeholder.value"),dk="".concat(wr,"buttons.placeholder.secondValue");const Xme=Object.freeze(Object.defineProperty({__proto__:null,CONTEXTMENU_ITEMS_ADD_COMMENT:yT,CONTEXTMENU_ITEMS_ALIGNMENT:bT,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:ET,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:ST,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:_T,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:wT,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:RT,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:CT,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:OT,CONTEXTMENU_ITEMS_BORDERS:TT,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:$T,CONTEXTMENU_ITEMS_BORDERS_LEFT:AT,CONTEXTMENU_ITEMS_BORDERS_RIGHT:PT,CONTEXTMENU_ITEMS_BORDERS_TOP:kT,CONTEXTMENU_ITEMS_CLEAR_COLUMN:iT,CONTEXTMENU_ITEMS_COPY:aT,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:uT,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:sT,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:lT,CONTEXTMENU_ITEMS_CUT:fT,CONTEXTMENU_ITEMS_EDIT_COMMENT:gT,CONTEXTMENU_ITEMS_FREEZE_COLUMN:cT,CONTEXTMENU_ITEMS_HIDE_COLUMN:DT,CONTEXTMENU_ITEMS_HIDE_ROW:HT,CONTEXTMENU_ITEMS_INSERT_LEFT:JE,CONTEXTMENU_ITEMS_INSERT_RIGHT:QE,CONTEXTMENU_ITEMS_MERGE_CELLS:dT,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:xT,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:MT,CONTEXTMENU_ITEMS_NO_ITEMS:qE,CONTEXTMENU_ITEMS_READ_ONLY:oT,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:mT,CONTEXTMENU_ITEMS_REDO:nT,CONTEXTMENU_ITEMS_REMOVE_BORDERS:IT,CONTEXTMENU_ITEMS_REMOVE_COLUMN:tT,CONTEXTMENU_ITEMS_REMOVE_COMMENT:pT,CONTEXTMENU_ITEMS_REMOVE_ROW:eT,CONTEXTMENU_ITEMS_ROW_ABOVE:XE,CONTEXTMENU_ITEMS_ROW_BELOW:ZE,CONTEXTMENU_ITEMS_SHOW_COLUMN:NT,CONTEXTMENU_ITEMS_SHOW_ROW:LT,CONTEXTMENU_ITEMS_UNDO:rT,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:hT,CONTEXTMENU_ITEMS_UNMERGE_CELLS:vT,CONTEXT_MENU_ITEMS_NAMESPACE:bW,FILTERS_BUTTONS_CANCEL:fk,FILTERS_BUTTONS_CLEAR:sk,FILTERS_BUTTONS_OK:uk,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:ck,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:dk,FILTERS_BUTTONS_PLACEHOLDER_VALUE:hk,FILTERS_BUTTONS_SELECT_ALL:lk,FILTERS_CONDITIONS_AFTER:QT,FILTERS_CONDITIONS_BEFORE:ek,FILTERS_CONDITIONS_BEGINS_WITH:WT,FILTERS_CONDITIONS_BETWEEN:ZT,FILTERS_CONDITIONS_BY_VALUE:qme,FILTERS_CONDITIONS_CONTAINS:zT,FILTERS_CONDITIONS_EMPTY:jT,FILTERS_CONDITIONS_ENDS_WITH:UT,FILTERS_CONDITIONS_EQUAL:BT,FILTERS_CONDITIONS_GREATER_THAN:GT,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:KT,FILTERS_CONDITIONS_LESS_THAN:qT,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:XT,FILTERS_CONDITIONS_NAMESPACE:xt,FILTERS_CONDITIONS_NONE:Wm,FILTERS_CONDITIONS_NOT_BETWEEN:JT,FILTERS_CONDITIONS_NOT_CONTAIN:YT,FILTERS_CONDITIONS_NOT_EMPTY:FT,FILTERS_CONDITIONS_NOT_EQUAL:VT,FILTERS_CONDITIONS_TODAY:tk,FILTERS_CONDITIONS_TOMORROW:rk,FILTERS_CONDITIONS_YESTERDAY:nk,FILTERS_DIVS_FILTER_BY_CONDITION:ok,FILTERS_DIVS_FILTER_BY_VALUE:ik,FILTERS_LABELS_CONJUNCTION:ak,FILTERS_LABELS_DISJUNCTION:Um,FILTERS_NAMESPACE:wr,FILTERS_VALUES_BLANK_CELLS:Pp},Symbol.toStringTag,{value:"Module"}));function Ph(e){"@babel/helpers - typeof";return Ph=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ph(e)}var ue;function fe(e,t,r){return t=Zme(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Zme(e){var t=Jme(e,"string");return Ph(t)==="symbol"?t:String(t)}function Jme(e,t){if(Ph(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ph(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Qme=(ue={languageCode:"en-US"},fe(ue,qE,"No available options"),fe(ue,XE,"Insert row above"),fe(ue,ZE,"Insert row below"),fe(ue,JE,"Insert column left"),fe(ue,QE,"Insert column right"),fe(ue,eT,["Remove row","Remove rows"]),fe(ue,tT,["Remove column","Remove columns"]),fe(ue,rT,"Undo"),fe(ue,nT,"Redo"),fe(ue,oT,"Read only"),fe(ue,iT,"Clear column"),fe(ue,bT,"Alignment"),fe(ue,wT,"Left"),fe(ue,ST,"Center"),fe(ue,CT,"Right"),fe(ue,_T,"Justify"),fe(ue,OT,"Top"),fe(ue,RT,"Middle"),fe(ue,ET,"Bottom"),fe(ue,cT,"Freeze column"),fe(ue,hT,"Unfreeze column"),fe(ue,TT,"Borders"),fe(ue,kT,"Top"),fe(ue,PT,"Right"),fe(ue,$T,"Bottom"),fe(ue,AT,"Left"),fe(ue,IT,"Remove border(s)"),fe(ue,yT,"Add comment"),fe(ue,gT,"Edit comment"),fe(ue,pT,"Delete comment"),fe(ue,mT,"Read-only comment"),fe(ue,dT,"Merge cells"),fe(ue,vT,"Unmerge cells"),fe(ue,aT,"Copy"),fe(ue,lT,["Copy with header","Copy with headers"]),fe(ue,sT,["Copy with group header","Copy with group headers"]),fe(ue,uT,["Copy header only","Copy headers only"]),fe(ue,fT,"Cut"),fe(ue,MT,"Insert child row"),fe(ue,xT,"Detach from parent"),fe(ue,DT,["Hide column","Hide columns"]),fe(ue,NT,["Show column","Show columns"]),fe(ue,HT,["Hide row","Hide rows"]),fe(ue,LT,["Show row","Show rows"]),fe(ue,Wm,"None"),fe(ue,jT,"Is empty"),fe(ue,FT,"Is not empty"),fe(ue,BT,"Is equal to"),fe(ue,VT,"Is not equal to"),fe(ue,WT,"Begins with"),fe(ue,UT,"Ends with"),fe(ue,zT,"Contains"),fe(ue,YT,"Does not contain"),fe(ue,GT,"Greater than"),fe(ue,KT,"Greater than or equal to"),fe(ue,qT,"Less than"),fe(ue,XT,"Less than or equal to"),fe(ue,ZT,"Is between"),fe(ue,JT,"Is not between"),fe(ue,QT,"After"),fe(ue,ek,"Before"),fe(ue,tk,"Today"),fe(ue,rk,"Tomorrow"),fe(ue,nk,"Yesterday"),fe(ue,Pp,"Blank cells"),fe(ue,ok,"Filter by condition"),fe(ue,ik,"Filter by value"),fe(ue,ak,"And"),fe(ue,Um,"Or"),fe(ue,lk,"Select all"),fe(ue,sk,"Clear"),fe(ue,uk,"OK"),fe(ue,fk,"Cancel"),fe(ue,ck,"Search"),fe(ue,hk,"Value"),fe(ue,dk,"Second value"),ue);const wW=Qme;var W_=wW.languageCode,zm=en("languagesDictionaries"),ebe=zm.register,SW=zm.getItem,tbe=zm.hasItem,rbe=zm.getValues;CW(wW);function CW(e,t){var r=e,n=t;return Ve(e)&&(n=e,r=n.languageCode),nbe(r,n),ebe(r,lr(n)),lr(n)}function nbe(e,t){e!==W_&&Wme(t,SW(W_))}function _W(e){return vk(e)?lr(SW(e)):null}function vk(e){return tbe(e)}function obe(){return rbe()}function OW(e,t,r){var n=_W(e);if(n===null)return null;var o=n[t];if(gt(o))return null;var i=ibe(o,r);return Array.isArray(i)?i[0]:i}function ibe(e,t){var r=e;return $(Kme(),function(n){r=n(e,t)}),r}function abe(e){var t=gW(e);return vk(t)||(t=W_,pW(e)),t}var lbe=Ae,sbe=Ut,ube=gj,fbe=Br,cbe=jn,hbe=uv;lbe({target:"Object",stat:!0,sham:!sbe},{getOwnPropertyDescriptors:function(t){for(var r=fbe(t),n=cbe.f,o=ube(r),i={},a=0,l,s;o.length>a;)s=n(r,l=o[a++]),s!==void 0&&hbe(i,l,s);return i}});var Ym="active-header",Gm="area",$h="cell",yk="fill",Tv="header",gk="custom-selection";function Us(e){"@babel/helpers - typeof";return Us=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Us(e)}function dbe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,EW(n.key),n)}}function vbe(e,t,r){return t&&lM(e.prototype,t),r&&lM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dg(){return typeof Reflect<"u"&&Reflect.get?dg=Reflect.get.bind():dg=function(t,r,n){var o=ybe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},dg.apply(this,arguments)}function ybe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=zs(e),e!==null););return e}function gbe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&U_(e,t)}function U_(e,t){return U_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},U_(e,t)}function pbe(e){var t=bbe();return function(){var n=zs(e),o;if(t){var i=zs(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return mbe(this,o)}}function mbe(e,t){if(t&&(Us(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return RW(e)}function RW(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bbe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function zs(e){return zs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},zs(e)}function wbe(e,t,r){return t=EW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function EW(e){var t=Sbe(e,"string");return Us(t)==="symbol"?t:String(t)}function Sbe(e,t){if(Us(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Us(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Cbe=function(e){gbe(r,e);var t=pbe(r);function r(n,o){var i;return dbe(this,r),i=t.call(this,n,null),wbe(RW(i),"visualCellRange",null),i.visualCellRange=o||null,i.commit(),i}return vbe(r,[{key:"add",value:function(o){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(o):this.visualCellRange.expand(o),this}},{key:"clear",value:function(){return this.visualCellRange=null,dg(zs(r.prototype),"clear",this).call(this)}},{key:"trimToVisibleCellsRangeOnly",value:function(o){var i=o.from,a=o.to,l=this.getNearestNotHiddenCoords(i,1),s=this.getNearestNotHiddenCoords(a,-1);if(l===null||s===null)return null;if(l.row>s.row||l.col>s.col){var u=this.settings.type==="header"||this.settings.type==="active-header";if(!u)return null;l=i,s=a}return this.settings.createCellRange(l,l,s)}},{key:"getNearestNotHiddenCoords",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:i,l=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper(),o.row,i);if(l===null)return null;var s=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper(),o.col,a);return s===null?null:this.settings.createCellCoords(l,s)}},{key:"getNearestNotHiddenIndex",value:function(o,i,a){if(i<0)return i;var l=o.getNearestNotHiddenIndex(i,a),s=this.settings.type==="header"||this.settings.type==="active-header";return s&&l===null?-1:l}},{key:"commit",value:function(){if(this.visualCellRange===null)return this;var o=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return o===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(o.from,o.to),this}},{key:"syncWith",value:function(o){var i=o.getVerticalDirection()==="N-S"?1:-1,a=o.getHorizontalDirection()==="W-E"?1:-1,l=this.getNearestNotHiddenCoords(o.from.clone().normalize(),i,a);if(l!==null&&o.overlaps(l)){if(this.cellRange===null){var s=this.settings.visualToRenderableCoords(l);this.cellRange=this.settings.createCellRange(s)}return o.setHighlight(l),this}return o.setHighlight(o.from),this}},{key:"getCorners",value:function(){var o=this.cellRange,i=o.from,a=o.to,l=i.row===null||a.row===null,s=i.col===null||a.col===null,u=this.settings.createCellCoords(l?null:Math.min(i.row,a.row),s?null:Math.min(i.col,a.col)),f=this.settings.createCellCoords(l?null:Math.max(i.row,a.row),s?null:Math.max(i.col,a.col));return[u.row,u.col,f.row,f.col]}},{key:"getVisualCorners",value:function(){var o=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),i=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[o.row,o.col,i.row,i.col]}},{key:"createRenderableCellRange",value:function(o,i){var a=this.settings.visualToRenderableCoords(o),l=this.settings.visualToRenderableCoords(i);return this.settings.createCellRange(a,a,l)}}]),r}(tge);const Pf=Cbe;function Ah(e){"@babel/helpers - typeof";return Ah=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ah(e)}var _be=["activeHeaderClassName"];function sM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function uM(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?sM(Object(r),!0).forEach(function(n){Obe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Obe(e,t,r){return t=Rbe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Rbe(e){var t=Ebe(e,"string");return Ah(t)==="symbol"?t:String(t)}function Ebe(e,t){if(Ah(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ah(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Tbe(e,t){if(e==null)return{};var r=kbe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function kbe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function Pbe(e){var t=e.activeHeaderClassName,r=Tbe(e,_be),n=new Pf(uM(uM({highlightHeaderClassName:t},r),{},{selectionType:Ym}));return n}function Ih(e){"@babel/helpers - typeof";return Ih=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ih(e)}var $be=["layerLevel","areaCornerVisible"];function fM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function cM(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fM(Object(r),!0).forEach(function(n){Abe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Abe(e,t,r){return t=Ibe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ibe(e){var t=Mbe(e,"string");return Ih(t)==="symbol"?t:String(t)}function Mbe(e,t){if(Ih(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ih(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xbe(e,t){if(e==null)return{};var r=Dbe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Dbe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function Nbe(e){var t=e.layerLevel,r=e.areaCornerVisible,n=xbe(e,$be),o=new Pf(cM(cM({className:"area",markIntersections:!0,layerLevel:Math.min(t,7),border:{width:1,color:"#4b89ff",cornerVisible:r}},n),{},{selectionType:Gm}));return o}function Mh(e){"@babel/helpers - typeof";return Mh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mh(e)}var Hbe=["cellCornerVisible"];function hM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function dM(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hM(Object(r),!0).forEach(function(n){Lbe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Lbe(e,t,r){return t=jbe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jbe(e){var t=Fbe(e,"string");return Mh(t)==="symbol"?t:String(t)}function Fbe(e,t){if(Mh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Mh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Bbe(e,t){if(e==null)return{};var r=Vbe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Vbe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function Wbe(e){var t=e.cellCornerVisible,r=Bbe(e,Hbe),n=new Pf(dM(dM({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:t}},r),{},{selectionType:$h}));return n}function xh(e){"@babel/helpers - typeof";return xh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xh(e)}var Ube=["border","visualCellRange"];function vM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Nw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vM(Object(r),!0).forEach(function(n){zbe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zbe(e,t,r){return t=Ybe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ybe(e){var t=Gbe(e,"string");return xh(t)==="symbol"?t:String(t)}function Gbe(e,t){if(xh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Kbe(e,t){if(e==null)return{};var r=qbe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function qbe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function Xbe(e){var t=e.border,r=e.visualCellRange,n=Kbe(e,Ube),o=new Pf(Nw(Nw(Nw({},t),n),{},{selectionType:gk}),r);return o}var yM=Ut,Zbe=Ue,Jbe=zt,Qbe=je,Hw=Jd,ewe=Xd,twe=Wd,rwe=kr,nwe=zd,ml=Object.assign,gM=Object.defineProperty,owe=Zbe([].concat),iwe=!ml||Qbe(function(){if(yM&&ml({b:1},ml(gM({},"a",{enumerable:!0,get:function(){gM(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var e={},t={},r=Symbol("assign detection"),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(o){t[o]=o}),ml({},e)[r]!==7||Hw(ml({},t)).join("")!==n})?function(t,r){for(var n=rwe(t),o=arguments.length,i=1,a=ewe.f,l=twe.f;o>i;)for(var s=nwe(arguments[i++]),u=a?owe(Hw(s),a(s)):Hw(s),f=u.length,c=0,h;f>c;)h=u[c++],(!yM||Jbe(l,s,h))&&(n[h]=s[h]);return n}:ml,awe=Ae,pM=iwe;awe({target:"Object",stat:!0,arity:2,forced:Object.assign!==pM},{assign:pM});function Dh(e){"@babel/helpers - typeof";return Dh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dh(e)}function mM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function bM(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?mM(Object(r),!0).forEach(function(n){lwe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function lwe(e,t,r){return t=swe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function swe(e){var t=uwe(e,"string");return Dh(t)==="symbol"?t:String(t)}function uwe(e,t){if(Dh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Dh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fwe(e){if(e==null)throw new TypeError("Cannot destructure "+e)}function cwe(e){var t=Object.assign({},(fwe(e),e)),r=new Pf(bM(bM({className:"fill",border:{width:1,color:"#ff0000"}},t),{},{selectionType:yk}));return r}function Nh(e){"@babel/helpers - typeof";return Nh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nh(e)}var hwe=["headerClassName","rowClassName","columnClassName"];function wM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function SM(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wM(Object(r),!0).forEach(function(n){dwe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dwe(e,t,r){return t=vwe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vwe(e){var t=ywe(e,"string");return Nh(t)==="symbol"?t:String(t)}function ywe(e,t){if(Nh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Nh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gwe(e,t){if(e==null)return{};var r=pwe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function pwe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function mwe(e){var t=e.headerClassName,r=e.rowClassName,n=e.columnClassName,o=gwe(e,hwe),i=new Pf(SM(SM({className:"highlight",highlightHeaderClassName:t,highlightRowClassName:r,highlightColumnClassName:n},o),{},{highlightOnlyClosestHeader:!0,selectionType:Tv}));return i}function Hh(e){"@babel/helpers - typeof";return Hh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hh(e)}function CM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function bwe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?CM(Object(r),!0).forEach(function(n){wwe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):CM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function wwe(e,t,r){return t=Swe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Swe(e){var t=Cwe(e,"string");return Hh(t)==="symbol"?t:String(t)}function Cwe(e,t){if(Hh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TW=en("highlight/types"),$f=TW.register,_we=TW.getItem;$f(Ym,Pbe);$f(Gm,Nbe);$f($h,Wbe);$f(gk,Xbe);$f(yk,cwe);$f(Tv,mwe);function bl(e,t){return _we(e)(bwe({type:e},t))}function Lh(e){"@babel/helpers - typeof";return Lh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lh(e)}function Go(e){return Twe(e)||Ewe(e)||Rwe(e)||Owe()}function Owe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Rwe(e,t){if(e){if(typeof e=="string")return z_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return z_(e,t)}}function Ewe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Twe(e){if(Array.isArray(e))return z_(e)}function z_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _M(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function qf(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_M(Object(r),!0).forEach(function(n){kwe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_M(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function kwe(e,t,r){return t=kW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Pwe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kW(n.key),n)}}function $we(e,t,r){return t&&OM(e.prototype,t),r&&OM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kW(e){var t=Awe(e,"string");return Lh(t)==="symbol"?t:String(t)}function Awe(e,t){if(Lh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Lh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Iwe=function(e){function t(r){Pwe(this,t),this.options=r,this.layerLevel=0,this.cell=bl($h,r),this.fill=bl(yk,r),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}return $we(t,[{key:"isEnabledFor",value:function(n,o){var i=n;n===$h&&(i="current");var a=this.options.disabledCellSelection(o.row,o.col);return typeof a=="string"&&(a=[a]),a===!1||Array.isArray(a)&&!a.includes(i)}},{key:"useLayerLevel",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=n,this}},{key:"getCell",value:function(){return this.cell}},{key:"getFill",value:function(){return this.fill}},{key:"createOrGetArea",value:function(){var n=this.layerLevel,o;return this.areas.has(n)?o=this.areas.get(n):(o=bl(Gm,qf({layerLevel:n},this.options)),this.areas.set(n,o)),o}},{key:"getAreas",value:function(){return Go(this.areas.values())}},{key:"createOrGetHeader",value:function(){var n=this.layerLevel,o;return this.headers.has(n)?o=this.headers.get(n):(o=bl(Tv,qf({},this.options)),this.headers.set(n,o)),o}},{key:"getHeaders",value:function(){return Go(this.headers.values())}},{key:"createOrGetActiveHeader",value:function(){var n=this.layerLevel,o;return this.activeHeaders.has(n)?o=this.activeHeaders.get(n):(o=bl(Ym,qf({},this.options)),this.activeHeaders.set(n,o)),o}},{key:"getActiveHeaders",value:function(){return Go(this.activeHeaders.values())}},{key:"getCustomSelections",value:function(){return Go(this.customSelections.values())}},{key:"addCustomSelection",value:function(n){this.customSelections.push(bl(gk,qf(qf({},this.options),n)))}},{key:"clear",value:function(){this.cell.clear(),this.fill.clear(),$(this.areas.values(),function(n){return void n.clear()}),$(this.headers.values(),function(n){return void n.clear()}),$(this.activeHeaders.values(),function(n){return void n.clear()})}},{key:e,value:function(){return[this.cell,this.fill].concat(Go(this.areas.values()),Go(this.headers.values()),Go(this.activeHeaders.values()),Go(this.customSelections))[Symbol.iterator]()}}]),t}(Symbol.iterator);const Mwe=Iwe;function jh(e){"@babel/helpers - typeof";return jh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jh(e)}function xwe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Nwe(n.key),n)}}function Dwe(e,t,r){return t&&RM(e.prototype,t),r&&RM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Nwe(e){var t=Hwe(e,"string");return jh(t)==="symbol"?t:String(t)}function Hwe(e,t){if(jh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(jh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Lwe=function(e){function t(r){xwe(this,t),this.ranges=[],this.createCellRange=r}return Dwe(t,[{key:"isEmpty",value:function(){return this.size()===0}},{key:"set",value:function(n){return this.clear(),this.ranges.push(this.createCellRange(n)),this}},{key:"add",value:function(n){return this.ranges.push(this.createCellRange(n)),this}},{key:"pop",value:function(){return this.ranges.pop(),this}},{key:"current",value:function(){return this.peekByIndex(0)}},{key:"previous",value:function(){return this.peekByIndex(-1)}},{key:"includes",value:function(n){return this.ranges.some(function(o){return o.includes(n)})}},{key:"clear",value:function(){return this.ranges.length=0,this}},{key:"size",value:function(){return this.ranges.length}},{key:"peekByIndex",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,o=this.size()+n-1,i;return o>=0&&(i=this.ranges[o]),i}},{key:e,value:function(){return this.ranges[Symbol.iterator]()}}]),t}(Symbol.iterator);const jwe=Lwe;function Fh(e){"@babel/helpers - typeof";return Fh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fh(e)}function Fwe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Vwe(n.key),n)}}function Bwe(e,t,r){return t&&EM(e.prototype,t),r&&EM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vwe(e){var t=Wwe(e,"string");return Fh(t)==="symbol"?t:String(t)}function Wwe(e,t){if(Fh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var PW=function(){function e(t,r){Fwe(this,e),this.range=t,this.options=r}return Bwe(e,[{key:"transformStart",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.options.createCellCoords(r,n),a=this.range.current().highlight,l=this.options.visualToRenderableCoords(a),s=l.row,u=l.col,f=a,c=0,h=0;if(this.runLocalHooks("beforeTransformStart",i),s!==null&&u!==null){var d=this.options.countRows(),v=this.options.countCols(),g=this.options.fixedRowsBottom(),m=this.options.minSpareRows(),w=this.options.minSpareCols(),S=this.options.autoWrapRow(),C=this.options.autoWrapCol();s+r>d-1?o&&m>0&&!(g&&s>=d-g-1)?(this.runLocalHooks("insertRowRequire",d),d=this.options.countRows()):C&&(i.row=1-d,i.col=u+i.col===v-1?1-v:1):C&&s+i.row<0&&u+i.col>=0&&(i.row=d-1,i.col=u+i.col===0?v-1:-1),u+i.col>v-1?o&&w>0?(this.runLocalHooks("insertColRequire",v),v=this.options.countCols()):S&&(i.row=s+i.row===d-1?1-d:1,i.col=1-v):S&&u+i.col<0&&s+i.row>=0&&(i.row=s+i.row===0?d-1:-1,i.col=v-1);var k=this.options.createCellCoords(s+i.row,u+i.col);c=0,h=0,k.row<0?(c=-1,k.row=0):k.row>0&&k.row>=d&&(c=1,k.row=d-1),k.col<0?(h=-1,k.col=0):k.col>0&&k.col>=v&&(h=1,k.col=v-1),f=this.options.renderableToVisualCoords(k)}return this.runLocalHooks("afterTransformStart",f,c,h),f}},{key:"transformEnd",value:function(r,n){var o=this.options.createCellCoords(r,n),i=this.range.current(),a=i.to,l=0,s=0;this.runLocalHooks("beforeTransformEnd",o);var u=this.options.visualToRenderableCoords(i.highlight),f=u.row,c=u.col;if(f!==null&&c!==null){var h=this.options.countRows(),d=this.options.countCols(),v=this.options.visualToRenderableCoords(i.to),g=v.row,m=v.col,w=this.options.createCellCoords(g+o.row,m+o.col);l=0,s=0,w.row<0?(l=-1,w.row=0):w.row>0&&w.row>=h&&(l=1,w.row=h-1),w.col<0?(s=-1,w.col=0):w.col>0&&w.col>=d&&(s=1,w.col=d-1),a=this.options.renderableToVisualCoords(w)}return this.runLocalHooks("afterTransformEnd",a,l,s),a}}]),e}();pt(PW,Pr);const Uwe=PW;function $W(e,t){return Kwe(e)||Gwe(e,t)||Ywe(e,t)||zwe()}function zwe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ywe(e,t){if(e){if(typeof e=="string")return TM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return TM(e,t)}}function TM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Gwe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Kwe(e){if(Array.isArray(e))return e}function Y_(e){"@babel/helpers - typeof";return Y_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Y_(e)}var Km=0,qm=1,AW=2,pk=3,qwe=[pk,AW],Xwe=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],Lw=Symbol("root"),kM=Symbol("child");function Ys(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Lw;if(t!==Lw&&t!==kM)throw new Error("The second argument is used internally only and cannot be overwritten.");var r=Array.isArray(e),n=t===Lw,o=Km;if(r){var i=e[0];if(e.length===0)o=qm;else if(n&&i instanceof $E)o=pk;else if(n&&Array.isArray(i))o=Ys(i,kM);else if(e.length>=2&&e.length<=4){var a=!e.some(function(l,s){return!Xwe[s].includes(Y_(l))});a&&(o=AW)}}return o}function Bh(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.keepDirection,n=r===void 0?!1:r,o=t.propToCol;if(!qwe.includes(e))throw new Error("Unsupported selection ranges schema type was provided.");return function(i){var a=e===pk,l=a?i.from.row:i[0],s=a?i.from.col:i[1],u=a?i.to.row:i[2],f=a?i.to.col:i[3];if(typeof o=="function"&&(typeof s=="string"&&(s=o(s)),typeof f=="string"&&(f=o(f))),gt(u)&&(u=l),gt(f)&&(f=s),!n){var c=l,h=s,d=u,v=f;l=Math.min(c,d),s=Math.min(h,v),u=Math.max(c,d),f=Math.max(h,v)}return[l,s,u,f]}}function Zwe(e){var t=Ys(e);if(t===Km||t===qm)return[];var r=Bh(t),n=new Set;$(e,function(a){var l=r(a),s=$W(l,4),u=s[1],f=s[3],c=Math.max(u,0),h=f-c+1;$(Array.from(new Array(h),function(d,v){return c+v}),function(d){n.has(d)||n.add(d)})});var o=Array.from(n).sort(function(a,l){return a-l}),i=Lt(o,function(a,l,s,u){return s!==0&&l===u[s-1]+1?a[a.length-1][1]+=1:a.push([l,1]),a},[]);return i}function Jwe(e){var t=Ys(e);if(t===Km||t===qm)return[];var r=Bh(t),n=new Set;$(e,function(a){var l=r(a),s=$W(l,3),u=s[0],f=s[2],c=Math.max(u,0),h=f-c+1;$(Array.from(new Array(h),function(d,v){return c+v}),function(d){n.has(d)||n.add(d)})});var o=Array.from(n).sort(function(a,l){return a-l}),i=Lt(o,function(a,l,s,u){return s!==0&&l===u[s-1]+1?a[a.length-1][1]+=1:a.push([l,1]),a},[]);return i}function Ko(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;return typeof e=="number"&&e>=0&&e<t}function Vh(e){"@babel/helpers - typeof";return Vh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vh(e)}var PM;function $M(e,t){return rSe(e)||tSe(e,t)||eSe(e,t)||Qwe()}function Qwe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eSe(e,t){if(e){if(typeof e=="string")return AM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return AM(e,t)}}function AM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function tSe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function rSe(e){if(Array.isArray(e))return e}function nSe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function oSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function IM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,aSe(n.key),n)}}function iSe(e,t,r){return t&&IM(e.prototype,t),r&&IM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function aSe(e){var t=lSe(e,"string");return Vh(t)==="symbol"?t:String(t)}function lSe(e,t){if(Vh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var IW=function(){function e(t,r){var n=this;oSe(this,e),this.settings=t,this.tableProps=r,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new jwe(function(o,i,a){return n.tableProps.createCellRange(o,i,a)}),this.highlight=new Mwe({headerClassName:t.currentHeaderClassName,activeHeaderClassName:t.activeHeaderClassName,rowClassName:t.currentRowClassName,columnClassName:t.currentColClassName,disabledCellSelection:function(i,a){return n.tableProps.isDisabledCellSelection(i,a)},cellCornerVisible:function(){return n.isCellCornerVisible.apply(n,arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible.apply(n,arguments)},visualToRenderableCoords:function(i){return n.tableProps.visualToRenderableCoords(i)},renderableToVisualCoords:function(i){return n.tableProps.renderableToVisualCoords(i)},createCellCoords:function(i,a){return n.tableProps.createCellCoords(i,a)},createCellRange:function(i,a,l){return n.tableProps.createCellRange(i,a,l)},rowIndexMapper:function(){return n.tableProps.rowIndexMapper()},columnIndexMapper:function(){return n.tableProps.columnIndexMapper()}}),this.transformation=new Uwe(this.selectedRange,{countRows:function(){return n.tableProps.countRowsTranslated()},countCols:function(){return n.tableProps.countColsTranslated()},visualToRenderableCoords:function(i){return n.tableProps.visualToRenderableCoords(i)},renderableToVisualCoords:function(i){return n.tableProps.renderableToVisualCoords(i)},createCellCoords:function(i,a){return n.tableProps.createCellCoords(i,a)},fixedRowsBottom:function(){return t.fixedRowsBottom},minSpareRows:function(){return t.minSpareRows},minSpareCols:function(){return t.minSpareCols},autoWrapRow:function(){return t.autoWrapRow},autoWrapCol:function(){return t.autoWrapCol}}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["beforeModifyTransformStart"].concat(i))}),this.transformation.addLocalHook("afterTransformStart",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["afterModifyTransformStart"].concat(i))}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["beforeModifyTransformEnd"].concat(i))}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["afterModifyTransformEnd"].concat(i))}),this.transformation.addLocalHook("insertRowRequire",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["insertRowRequire"].concat(i))}),this.transformation.addLocalHook("insertColRequire",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["insertColRequire"].concat(i))})}return iSe(e,[{key:"getSelectedRange",value:function(){return this.selectedRange}},{key:"begin",value:function(){this.inProgress=!0}},{key:"finish",value:function(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}},{key:"isInProgress",value:function(){return this.inProgress}},{key:"setRangeStart",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.settings.selectionMode==="multiple",a=gt(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,l=r.row<0,s=r.col<0,u=l&&s,f=r.clone();this.selectedByCorner=u,this.runLocalHooks("beforeSetRangeStart".concat(o?"Only":""),f),(!i||i&&!a&&gt(n))&&this.selectedRange.clear(),this.selectedRange.add(f),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!u&&s&&this.selectedByRowHeader.add(this.getLayerLevel()),!u&&l&&this.selectedByColumnHeader.add(this.getLayerLevel()),o||this.setRangeEnd(r)}},{key:"setRangeStartOnly",value:function(r,n){this.setRangeStart(r,n,!0)}},{key:"setRangeEnd",value:function(r){if(!this.selectedRange.isEmpty()){var n=r.clone();this.runLocalHooks("beforeSetRangeEnd",n),this.begin();var o=this.selectedRange.current();this.settings.selectionMode!=="single"&&o.setTo(this.tableProps.createCellCoords(n.row,n.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor($h,o.highlight)&&this.highlight.getCell().add(this.selectedRange.current().highlight).commit().syncWith(o);var i=this.getLayerLevel();i<this.highlight.layerLevel&&($(this.highlight.getAreas(),function(g){return void g.clear()}),$(this.highlight.getHeaders(),function(g){return void g.clear()}),$(this.highlight.getActiveHeaders(),function(g){return void g.clear()})),this.highlight.useLayerLevel(i);var a=this.highlight.createOrGetArea(),l=this.highlight.createOrGetHeader(),s=this.highlight.createOrGetActiveHeader();if(a.clear(),l.clear(),s.clear(),this.highlight.isEnabledFor(Gm,o.highlight)&&(this.isMultiple()||i>=1)&&(a.add(o.from).add(o.to).commit(),i===1)){var u=this.selectedRange.previous();this.highlight.useLayerLevel(i-1).createOrGetArea().add(u.from).commit().syncWith(u),this.highlight.useLayerLevel(i)}if(this.highlight.isEnabledFor(Tv,o.highlight)){var f=this.tableProps.countRowsTranslated()===0,c=this.tableProps.countColsTranslated()===0,h=o;if((f||c)&&(h=o.clone()),f&&(h.from.row=-1),c&&(h.from.col=-1),this.settings.selectionMode==="single"?(this.isSelectedByAnyHeader()&&h.from.normalize(),l.add(h.from).commit()):l.add(h.from).add(h.to).commit(),this.isEntireRowSelected()){var d=this.tableProps.countCols()===o.getWidth();d&&s.add(this.tableProps.createCellCoords(o.from.row,-1)).add(this.tableProps.createCellCoords(o.to.row,-1)).commit()}if(this.isEntireColumnSelected()){var v=this.tableProps.countRows()===o.getHeight();v&&s.add(this.tableProps.createCellCoords(-1,o.from.col)).add(this.tableProps.createCellCoords(-1,o.to.col)).commit()}}this.runLocalHooks("afterSetRangeEnd",r)}}},{key:"isMultiple",value:function(){var r=Da(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",r),r.value}},{key:"transformStart",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.setRangeStart(this.transformation.transformStart(r,n,o))}},{key:"transformEnd",value:function(r,n){this.setRangeEnd(this.transformation.transformEnd(r,n))}},{key:"getLayerLevel",value:function(){return this.selectedRange.size()-1}},{key:"isSelected",value:function(){return!this.selectedRange.isEmpty()}},{key:"isSelectedByRowHeader",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(r)&&this.isEntireRowSelected(r)}},{key:"isEntireRowSelected",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return r===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(r)}},{key:"isSelectedByColumnHeader",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&this.isEntireColumnSelected(r)}},{key:"isEntireColumnSelected",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return r===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(r)}},{key:"isSelectedByAnyHeader",value:function(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}},{key:"isSelectedByCorner",value:function(){return this.selectedByCorner}},{key:"inInSelection",value:function(r){return this.selectedRange.includes(r)}},{key:"isCellCornerVisible",value:function(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}},{key:"isAreaCornerVisible",value:function(r){return Number.isInteger(r)&&r!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}},{key:"clear",value:function(){this.selectedRange.clear(),this.highlight.clear()}},{key:"deselect",value:function(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}},{key:"selectAll",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=this.tableProps.countRows(),i=this.tableProps.countCols();if(!(!r&&!n&&(o===0||i===0))){var a=this.tableProps.createCellCoords(n?-1:0,r?-1:0),l=this.tableProps.createCellCoords(o-1,i-1);this.clear(),this.setRangeStartOnly(a),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(l),this.finish()}}},{key:"selectCells",value:function(r){var n=this,o=Ys(r);if(o===qm)return!1;if(o===Km)throw new Error(ft(PM||(PM=nSe([`Unsupported format of the selection ranges was passed. To select cells pass 
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, 
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`],[`Unsupported format of the selection ranges was passed. To select cells pass\\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`]))));var i=Bh(o,{propToCol:function(f){return n.tableProps.propToCol(f)},keepDirection:!0}),a=this.tableProps.countRows(),l=this.tableProps.countCols(),s=!r.some(function(u){var f=i(u),c=$M(f,4),h=c[0],d=c[1],v=c[2],g=c[3],m=Ko(h,a)&&Ko(d,l)&&Ko(v,a)&&Ko(g,l);return!m});return s&&(this.clear(),$(r,function(u){var f=i(u),c=$M(f,4),h=c[0],d=c[1],v=c[2],g=c[3];n.setRangeStartOnly(n.tableProps.createCellCoords(h,d),!1),n.setRangeEnd(n.tableProps.createCellCoords(v,g)),n.finish()})),s}},{key:"selectColumns",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,i=typeof r=="string"?this.tableProps.propToCol(r):r,a=typeof n=="string"?this.tableProps.propToCol(n):n,l=this.tableProps.countCols(),s=this.tableProps.countRows(),u=Ko(i,l)&&Ko(a,l);return u&&(this.setRangeStartOnly(this.tableProps.createCellCoords(o,i)),this.setRangeEnd(this.tableProps.createCellCoords(s-1,a)),this.finish()),u}},{key:"selectRows",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,i=this.tableProps.countRows(),a=this.tableProps.countCols(),l=Ko(r,i)&&Ko(n,i);return l&&(this.setRangeStartOnly(this.tableProps.createCellCoords(r,o)),this.setRangeEnd(this.tableProps.createCellCoords(n,a-1)),this.finish()),l}},{key:"refresh",value:function(){var r=this.highlight.getCustomSelections();if(r.forEach(function(u){u.commit()}),!!this.isSelected()){var n=this.highlight.getCell(),o=this.getLayerLevel();n.commit().syncWith(this.selectedRange.current());for(var i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);var a=this.highlight.createOrGetArea(),l=this.highlight.createOrGetHeader(),s=this.highlight.createOrGetActiveHeader();a.commit(),l.commit(),s.commit()}this.highlight.useLayerLevel(o)}}}]),e}();pt(IW,Pr);const sSe=IW;var uSe=Ae,fSe=im,cSe=jn.f,hSe=Qa,MM=Yt,dSe=L0,vSe=Tr,ySe=j0,gSe=fSe("".slice),pSe=Math.min,MW=ySe("startsWith"),mSe=!MW&&!!function(){var e=cSe(String.prototype,"startsWith");return e&&!e.writable}();uSe({target:"String",proto:!0,forced:!mSe&&!MW},{startsWith:function(t){var r=MM(vSe(this));dSe(t);var n=hSe(pSe(arguments.length>1?arguments[1]:void 0,r.length)),o=MM(t);return gSe(r,n,n+o.length)===o}});var xM=/^(\r\n|\n\r|\r|\n)/,bSe=/^[^\t\r\n]+/,DM=/^\t/;function wSe(e){var t=[[""]];if(e.length===0)return t;for(var r=0,n=0,o;e.length>0&&o!==e.length;)if(o=e.length,e.match(DM))e=e.replace(DM,""),r+=1,t[n][r]="";else if(e.match(xM))e=e.replace(xM,""),r=0,n+=1,t[n]=[""];else{var i="";if(e.startsWith('"')){for(var a=0,l=!0;l;){var s=e.slice(0,1);s==='"'&&(a+=1),i+=s,e=e.slice(1),(e.length===0||e.match(/^[\t\r\n]/)&&a%2===0)&&(l=!1)}i=i.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,function(f){return new Array(Math.floor(f.length/2)).fill('"').join("")})}else{var u=e.match(bSe);i=u?u[0]:"",e=e.slice(i.length)}t[n][r]=i}return t}function Pc(e){var t,r,n,o,i="",a;for(t=0,r=e.length;t<r;t+=1){for(o=e[t].length,n=0;n<o;n+=1)n>0&&(i+="	"),a=e[t][n],typeof a=="string"?a.indexOf(`
`)>-1?i+='"'.concat(a.replace(/"/g,'""'),'"'):i+=a:a==null?i+="":i+=a;t!==r-1&&(i+=`
`)}return i}function jw(e){return OSe(e)||_Se(e)||CSe(e)||SSe()}function SSe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function CSe(e,t){if(e){if(typeof e=="string")return G_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return G_(e,t)}}function _Se(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function OSe(e){if(Array.isArray(e))return G_(e)}function G_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Gs(e){"@babel/helpers - typeof";return Gs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gs(e)}function RSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,TSe(n.key),n)}}function ESe(e,t,r){return t&&NM(e.prototype,t),r&&NM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function TSe(e){var t=kSe(e,"string");return Gs(t)==="symbol"?t:String(t)}function kSe(e,t){if(Gs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var PSe=function(){function e(t,r,n){RSe(this,e),this.instance=t,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=r,this.duckSchema=this.createDuckSchema(),this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}return ESe(e,[{key:"createMap",value:function(){var r=this.getSchema();if(typeof r>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");var n=this.tableMeta.columns,o;if(this.colToPropCache=[],this.propToColCache=new Map,n){var i=0,a=0,l=!1;if(typeof n=="function"){var s=Sm(r);i=s>0?s:this.countFirstRowKeys(),l=!0}else{var u=this.tableMeta.maxCols;i=Math.min(u,n.length)}for(o=0;o<i;o++){var f=l?n(o):n[o];if(Ve(f)){if(typeof f.data<"u"){var c=l?a:o;this.colToPropCache[c]=f.data,this.propToColCache.set(f.data,c)}a+=1}}}else this.recursiveDuckColumns(r)}},{key:"countFirstRowKeys",value:function(){return VE(this.dataSource)}},{key:"recursiveDuckColumns",value:function(r,n,o){var i=this,a=n,l=o,s;return typeof a>"u"&&(a=0,l=""),Gs(r)==="object"&&!Array.isArray(r)&&We(r,function(u,f){u===null?(s=l+f,i.colToPropCache.push(s),i.propToColCache.set(s,a),a+=1):a=i.recursiveDuckColumns(u,a,"".concat(f,"."))}),a}},{key:"colToProp",value:function(r){if(Number.isInteger(r)===!1)return r;var n=this.instance.toPhysicalColumn(r);return n===null?r:this.colToPropCache&&ve(this.colToPropCache[n])?this.colToPropCache[n]:n}},{key:"propToCol",value:function(r){var n=this.propToColCache.get(r);if(ve(n))return this.instance.toVisualColumn(n);var o=this.instance.toVisualColumn(r);return o===null?r:o}},{key:"getSchema",value:function(){var r=this.tableMeta.dataSchema;return r?typeof r=="function"?r():r:this.duckSchema}},{key:"createDuckSchema",value:function(){return this.dataSource&&this.dataSource[0]?ds(this.dataSource[0]):{}}},{key:"refreshDuckSchema",value:function(){this.duckSchema=this.createDuckSchema()}},{key:"createRow",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=i.source,l=i.mode,s=l===void 0?"above":l,u=this.instance.countSourceRows(),f=u,c=0,h=r;(typeof h!="number"||h>=u)&&(h=u),h<this.instance.countRows()&&(f=this.instance.toPhysicalRow(h));var d=this.instance.runHooks("beforeCreateRow",h,o,a);if(d===!1||f===null)return{delta:0};for(var v=this.tableMeta.maxRows,g=this.getSchema().length,m=[],w=function(){var k=null;n.instance.dataType==="array"?n.tableMeta.dataSchema?k=lr(n.getSchema()):(k=[],_e(g-1,function(){return k.push(null)})):n.instance.dataType==="function"?k=n.tableMeta.dataSchema(h+c):(k={},hv(k,n.getSchema())),m.push(k),c+=1};c<o&&u+c<v;)w();this.instance.rowIndexMapper.insertIndexes(h,c),s==="below"&&(f=Math.min(f+1,u)),this.spliceData(f,0,m);var S=this.instance.toVisualRow(f);return this.instance.countSourceRows()===m.length&&this.instance.columnIndexMapper.initToLength(this.instance.getInitialColumnCount()),c>0&&(r==null?this.metaManager.createRow(null,c):a!=="auto"&&this.metaManager.createRow(f,o)),this.instance.runHooks("afterCreateRow",S,c,a),this.instance.forceFullRender=!0,{delta:c,startPhysicalIndex:f}}},{key:"createCol",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=o.source,a=o.mode,l=a===void 0?"start":a;if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var s=this.dataSource,u=this.tableMeta.maxCols,f=this.instance.countSourceCols(),c=r;(typeof c!="number"||c>=f)&&(c=f);var h=this.instance.runHooks("beforeCreateCol",c,n,i);if(h===!1)return{delta:0};var d=f;c<this.instance.countCols()&&(d=this.instance.toPhysicalColumn(c));var v=this.instance.countSourceRows(),g=this.instance.countCols(),m=0,w=d;l==="end"&&(w=Math.min(w+1,f));for(var S=w;m<n&&g<u;){if(typeof c!="number"||c>=g)if(v>0)for(var C=0;C<v;C+=1)typeof s[C]>"u"&&(s[C]=[]),s[C].push(null);else s.push([null]);else for(var k=0;k<v;k++)s[k].splice(w,0,null);m+=1,w+=1,g+=1}this.instance.columnIndexMapper.insertIndexes(c,m),m>0&&(r==null?this.metaManager.createColumn(null,m):i!=="auto"&&this.metaManager.createColumn(S,n));var R=this.instance.toVisualColumn(S);return this.instance.runHooks("afterCreateCol",R,m,i),this.instance.forceFullRender=!0,this.refreshDuckSchema(),{delta:m,startPhysicalIndex:S}}},{key:"removeRow",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0,a=Number.isInteger(r)?r:-o,l=this.visualRowsToPhysical(a,o),s=this.instance.countSourceRows();a=(s+a)%s;var u=this.instance.runHooks("beforeRemoveRow",a,l.length,l,i);if(u===!1)return!1;var f=l.length;if(this.filterData(a,f,l),a<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(l);var c=ve(this.tableMeta.columns)||ve(this.tableMeta.dataSchema);this.instance.rowIndexMapper.getNotTrimmedIndexesLength()===0&&c===!1&&this.instance.columnIndexMapper.setIndexesSequence([])}var h=l.slice(0).sort(function(d,v){return v-d});return h.forEach(function(d){n.metaManager.removeRow(d,1)}),this.instance.runHooks("afterRemoveRow",a,f,l,i),this.instance.forceFullRender=!0,!0}},{key:"removeCol",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2?arguments[2]:void 0;if(this.instance.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");var i=typeof r!="number"?-n:r;i=(this.instance.countCols()+i)%this.instance.countCols();var a=this.visualColumnsToPhysical(i,n),l=a.slice(0).sort(function(S,C){return C-S}),s=this.instance.runHooks("beforeRemoveCol",i,n,a,o);if(s===!1)return!1;for(var u=!0,f=l.length,c=this.dataSource,h=0;h<f;h++)u&&a[0]!==a[h]-h&&(u=!1);if(u)for(var d=0,v=this.instance.countSourceRows();d<v;d++)c[d].splice(a[0],n),d===0&&this.metaManager.removeColumn(a[0],n);else for(var g=0,m=this.instance.countSourceRows();g<m;g++)for(var w=0;w<f;w++)c[g].splice(l[w],1),g===0&&this.metaManager.removeColumn(l[w],1);return i<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(a),this.instance.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",i,n,a,o),this.instance.forceFullRender=!0,this.refreshDuckSchema(),!0}},{key:"spliceCol",value:function(r,n,o){for(var i=this.instance.getDataAtCol(r),a=i.slice(n,n+o),l=i.slice(n+o),s=arguments.length,u=new Array(s>3?s-3:0),f=3;f<s;f++)u[f-3]=arguments[f];_C(u,l);for(var c=0;c<o;)u.push(null),c+=1;return yB(u),this.instance.populateFromArray(n,r,u,null,null,"spliceCol"),a}},{key:"spliceRow",value:function(r,n,o){for(var i=this.instance.getSourceDataAtRow(r),a=i.slice(n,n+o),l=i.slice(n+o),s=arguments.length,u=new Array(s>3?s-3:0),f=3;f<s;f++)u[f-3]=arguments[f];_C(u,l);for(var c=0;c<o;)u.push(null),c+=1;return this.instance.populateFromArray(r,n,[u],null,null,"spliceRow"),a}},{key:"spliceData",value:function(r,n,o){var i=this,a=this.instance.runHooks("beforeDataSplice",r,n,o);if(a!==!1){var l=[].concat(jw(this.dataSource.slice(0,r)),jw(o),jw(this.dataSource.slice(r)));this.dataSource.length=0,l.forEach(function(s){return i.dataSource.push(s)})}}},{key:"filterData",value:function(r,n,o){var i=this.instance.runHooks("filterData",r,n,o);Array.isArray(i)===!1&&(i=this.dataSource.filter(function(a,l){return o.indexOf(l)===-1})),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}},{key:"get",value:function(r,n){var o=this.instance.toPhysicalRow(r),i=this.dataSource[o],a=this.instance.runHooks("modifyRowData",o);i=isNaN(a)?a:i;var l=null;if(i&&i.hasOwnProperty&&At(i,n))l=i[n];else if(typeof n=="string"&&n.indexOf(".")>-1){var s=n.split("."),u=i;if(!u)return null;for(var f=0,c=s.length;f<c;f++)if(u=u[s[f]],typeof u>"u")return null;l=u}else typeof n=="function"&&(l=n(this.dataSource.slice(o,o+1)[0]));if(this.instance.hasHook("modifyData")){var h=Da(l);this.instance.runHooks("modifyData",o,this.propToCol(n),h,"get"),h.isTouched()&&(l=h.value)}return l}},{key:"getCopyable",value:function(r,n){return this.instance.getCellMeta(r,this.propToCol(n)).copyable?this.get(r,n):""}},{key:"set",value:function(r,n,o){var i=this.instance.toPhysicalRow(r),a=o,l=this.dataSource[i],s=this.instance.runHooks("modifyRowData",i);if(l=isNaN(s)?s:l,this.instance.hasHook("modifyData")){var u=Da(a);this.instance.runHooks("modifyData",i,this.propToCol(n),u,"set"),u.isTouched()&&(a=u.value)}if(l&&l.hasOwnProperty&&At(l,n))l[n]=a;else if(typeof n=="string"&&n.indexOf(".")>-1){var f=n.split("."),c=l,h=0,d;for(h=0,d=f.length-1;h<d;h++)typeof c[f[h]]>"u"&&(c[f[h]]={}),c=c[f[h]];c[f[h]]=a}else typeof n=="function"?n(this.dataSource.slice(i,i+1)[0],a):l[n]=a}},{key:"visualRowsToPhysical",value:function(r,n){for(var o=this.instance.countSourceRows(),i=[],a=(o+r)%o,l=n,s;a<o&&l;)s=this.instance.toPhysicalRow(a),i.push(s),l-=1,a+=1;return i}},{key:"visualColumnsToPhysical",value:function(r,n){for(var o=this.instance.countCols(),i=[],a=(o+r)%o,l=n;a<o&&l;){var s=this.instance.toPhysicalColumn(a);i.push(s),l-=1,a+=1}return i}},{key:"clear",value:function(){for(var r=0;r<this.instance.countSourceRows();r++)for(var n=0;n<this.instance.countCols();n++)this.set(r,this.colToProp(n),"")}},{key:"getLength",value:function(){var r=this.tableMeta.maxRows,n;r<0||r===0?n=0:n=r||1/0;var o=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(o,n)}},{key:"getAll",value:function(){var r={row:0,col:0},n={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return r.row-n.row===0&&!this.instance.countSourceRows()?[]:this.getRange(r,n,e.DESTINATION_RENDERER)}},{key:"countCachedColumns",value:function(){return this.colToPropCache.length}},{key:"getRange",value:function(r,n,o){var i=[],a,l,s,u=this.tableMeta.maxRows,f=this.tableMeta.maxCols;if(u===0||f===0)return[];var c=o===e.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(u-1,0),Math.max(r.row,n.row)),d=Math.min(Math.max(f-1,0),Math.max(r.col,n.col));for(a=Math.min(r.row,n.row);a<=h;a++){s=[];var v=a>=0?this.instance.toPhysicalRow(a):a;for(l=Math.min(r.col,n.col);l<=d&&v!==null;l++)s.push(c.call(this,a,this.colToProp(l)));v!==null&&i.push(s)}return i}},{key:"getText",value:function(r,n){return Pc(this.getRange(r,n,e.DESTINATION_RENDERER))}},{key:"getCopyableText",value:function(r,n){return Pc(this.getRange(r,n,e.DESTINATION_CLIPBOARD_GENERATOR))}},{key:"destroy",value:function(){this.instance=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}],[{key:"DESTINATION_RENDERER",get:function(){return 1}},{key:"DESTINATION_CLIPBOARD_GENERATOR",get:function(){return 2}}]),e}();const $Se=PSe;var kv=en("cellTypes"),ASe=kv.register,ISe=kv.getItem,xW=kv.hasItem,MSe=kv.getNames;kv.getValues;function mk(e){if(!xW(e))throw Error('You declared cell type "'.concat(e,`" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`));return ISe(e)}function an(e,t){typeof e!="string"&&(t=e,e=t.CELL_TYPE);var r=t,n=r.editor,o=r.renderer,i=r.validator;n&&Or(e,n),o&&In(e,o),i&&Gl(e,i),ASe(e,t)}function xSe(e,t){var r;return e==="CELL_TYPE"?!1:((r=t._automaticallyAssignedMetaProps)===null||r===void 0?void 0:r.has(e))||!At(t,e)}function Xm(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,n=typeof t.type=="string"?mk(t.type):t.type;if(e._automaticallyAssignedMetaProps&&We(t,function(i,a){return void e._automaticallyAssignedMetaProps.delete(a)}),!!Ve(n)){r===e&&!e._automaticallyAssignedMetaProps&&(e._automaticallyAssignedMetaProps=new Set);var o={};We(n,function(i,a){if(xSe(a,r)){var l;o[a]=i,(l=e._automaticallyAssignedMetaProps)===null||l===void 0||l.add(a)}}),Wt(e,o)}}function DSe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}Bo(r,e);for(var n=0;n<t.length;n++)r.prototype[t[n]]=void 0;return r}function vg(e){return Number.isInteger(e)&&e>=0}function yg(e,t){if(!e())throw new Error("Assertion failed: ".concat(t))}function hy(e){return e==null}function K_(e){"@babel/helpers - typeof";return K_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},K_(e)}const DW=function(){return{_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",isEmptyCol:function(t){var r,n,o;for(r=0,n=this.countRows();r<n;r++)if(o=this.getDataAtCell(r,t),Kt(o)===!1)return!1;return!0},isEmptyRow:function(t){var r,n,o,i;for(r=0,n=this.countCols();r<n;r++)if(o=this.getDataAtCell(t,r),Kt(o)===!1)return K_(o)==="object"?(i=this.getCellMeta(t,r),wm(this.getSchema()[i.prop],o)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0}};function Wh(e){"@babel/helpers - typeof";return Wh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wh(e)}function HM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function LM(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?HM(Object(r),!0).forEach(function(n){NSe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):HM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function NSe(e,t,r){return t=HW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,HW(n.key),n)}}function NW(e,t,r){return t&&jM(e.prototype,t),r&&jM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function HW(e){var t=HSe(e,"string");return Wh(t)==="symbol"?t:String(t)}function HSe(e,t){if(Wh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function LW(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LSe(){return NW(function e(){LW(this,e)})}var jSe=function(){function e(t){LW(this,e),this.metaCtor=LSe(),this.meta=this.metaCtor.prototype,Wt(this.meta,DW()),this.meta.instance=t}return NW(e,[{key:"getMetaConstructor",value:function(){return this.metaCtor}},{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(r){var n;Wt(this.meta,r),Xm(this.meta,LM(LM({},r),{},{type:(n=r.type)!==null&&n!==void 0?n:this.meta.type}),r)}}]),e}();function Uh(e){"@babel/helpers - typeof";return Uh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uh(e)}function FSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,VSe(n.key),n)}}function BSe(e,t,r){return t&&FM(e.prototype,t),r&&FM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function VSe(e){var t=WSe(e,"string");return Uh(t)==="symbol"?t:String(t)}function WSe(e,t){if(Uh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Uh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var USe=function(){function e(t){FSe(this,e);var r=t.getMetaConstructor();this.meta=new r}return BSe(e,[{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(r){Wt(this.meta,r),Xm(this.meta,r,r)}}]),e}();function zh(e){"@babel/helpers - typeof";return zh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zh(e)}function BM(e){return KSe(e)||GSe(e)||YSe(e)||zSe()}function zSe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function YSe(e,t){if(e){if(typeof e=="string")return q_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return q_(e,t)}}function GSe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function KSe(e){if(Array.isArray(e))return q_(e)}function q_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function qSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ZSe(n.key),n)}}function XSe(e,t,r){return t&&VM(e.prototype,t),r&&VM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ZSe(e){var t=JSe(e,"string");return zh(t)==="symbol"?t:String(t)}function JSe(e,t){if(zh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var X_=function(e){function t(r){qSe(this,t),this.valueFactory=r,this.data=[],this.index=[],this.holes=new Set}return XSe(t,[{key:"obtain",value:function(n){yg(function(){return vg(n)},"Expecting an unsigned number.");var o=this._getStorageIndexByKey(n),i;if(o>=0)i=this.data[o],i===void 0&&(i=this.valueFactory(n),this.data[o]=i);else if(i=this.valueFactory(n),this.holes.size>0){var a=this.holes.values().next().value;this.holes.delete(a),this.data[a]=i,this.index[n]=a}else this.data.push(i),this.index[n]=this.data.length-1;return i}},{key:"insert",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;yg(function(){return vg(n)||hy(n)},"Expecting an unsigned number or null/undefined argument.");for(var i=[],a=this.data.length,l=0;l<o;l++)i.push(a+l),this.data.push(void 0);var s=hy(n)?this.index.length:n;this.index=[].concat(BM(this.index.slice(0,s)),i,BM(this.index.slice(s)))}},{key:"remove",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;yg(function(){return vg(n)||hy(n)},"Expecting an unsigned number or null/undefined argument.");for(var i=this.index.splice(hy(n)?this.index.length-o:n,o),a=0;a<i.length;a++){var l=i[a];typeof l=="number"&&this.holes.add(l)}}},{key:"size",value:function(){return this.data.length-this.holes.size}},{key:"values",value:function(){var n=this;return jr(this.data,function(o,i){return!n.holes.has(i)})[Symbol.iterator]()}},{key:"entries",value:function(){for(var n=[],o=0;o<this.data.length;o++){var i=this._getKeyByStorageIndex(o);i!==-1&&n.push([i,this.data[o]])}var a=0;return{next:function(){if(a<n.length){var s=n[a];return a+=1,{value:s,done:!1}}return{done:!0}}}}},{key:"clear",value:function(){this.data=[],this.index=[],this.holes.clear()}},{key:"_getStorageIndexByKey",value:function(n){return this.index.length>n?this.index[n]:-1}},{key:"_getKeyByStorageIndex",value:function(n){return this.index.indexOf(n)}},{key:e,value:function(){return this.entries()}}]),t}(Symbol.iterator);function Yh(e){"@babel/helpers - typeof";return Yh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yh(e)}function QSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tCe(n.key),n)}}function eCe(e,t,r){return t&&WM(e.prototype,t),r&&WM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tCe(e){var t=rCe(e,"string");return Yh(t)==="symbol"?t:String(t)}function rCe(e,t){if(Yh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Yh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var nCe=["data","width"],oCe=function(){function e(t){var r=this;QSe(this,e),this.globalMeta=t,this.metas=new X_(function(){return r._createMeta()})}return eCe(e,[{key:"updateMeta",value:function(r,n){var o=this.getMeta(r);Wt(o,n),Xm(o,n)}},{key:"createColumn",value:function(r,n){this.metas.insert(r,n)}},{key:"removeColumn",value:function(r,n){this.metas.remove(r,n)}},{key:"getMeta",value:function(r){return this.metas.obtain(r)}},{key:"getMetaConstructor",value:function(r){return this.metas.obtain(r).constructor}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createMeta",value:function(){return DSe(this.globalMeta.getMetaConstructor(),nCe).prototype}}]),e}();function Gh(e){"@babel/helpers - typeof";return Gh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gh(e)}function iCe(e){return uCe(e)||sCe(e)||lCe(e)||aCe()}function aCe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lCe(e,t){if(e){if(typeof e=="string")return Z_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Z_(e,t)}}function sCe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function uCe(e){if(Array.isArray(e))return Z_(e)}function Z_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function fCe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hCe(n.key),n)}}function cCe(e,t,r){return t&&UM(e.prototype,t),r&&UM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hCe(e){var t=dCe(e,"string");return Gh(t)==="symbol"?t:String(t)}function dCe(e,t){if(Gh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var vCe=function(){function e(t){var r=this;fCe(this,e),this.columnMeta=t,this.metas=new X_(function(){return r._createRow()})}return cCe(e,[{key:"updateMeta",value:function(r,n,o){var i=this.getMeta(r,n);Wt(i,o),Xm(i,o)}},{key:"createRow",value:function(r,n){this.metas.insert(r,n)}},{key:"createColumn",value:function(r,n){for(var o=0;o<this.metas.size();o++)this.metas.obtain(o).insert(r,n)}},{key:"removeRow",value:function(r,n){this.metas.remove(r,n)}},{key:"removeColumn",value:function(r,n){for(var o=0;o<this.metas.size();o++)this.metas.obtain(o).remove(r,n)}},{key:"getMeta",value:function(r,n,o){var i=this.metas.obtain(r).obtain(n);return o===void 0?i:i[o]}},{key:"setMeta",value:function(r,n,o,i){var a,l=this.metas.obtain(r).obtain(n);(a=l._automaticallyAssignedMetaProps)===null||a===void 0||a.delete(o),l[o]=i}},{key:"removeMeta",value:function(r,n,o){var i=this.metas.obtain(r).obtain(n);delete i[o]}},{key:"getMetas",value:function(){for(var r=[],n=Array.from(this.metas.values()),o=0;o<n.length;o++)r.push.apply(r,iCe(n[o].values()));return r}},{key:"getMetasAtRow",value:function(r){yg(function(){return vg(r)},"Expecting an unsigned number.");var n=new Map(this.metas);return n.has(r)?Array.from(n.get(r).values()):[]}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createRow",value:function(){var r=this;return new X_(function(n){return r._createMeta(n)})}},{key:"_createMeta",value:function(r){var n=this.columnMeta.getMetaConstructor(r);return new n}}]),e}();function Kh(e){"@babel/helpers - typeof";return Kh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kh(e)}function yCe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pCe(n.key),n)}}function gCe(e,t,r){return t&&zM(e.prototype,t),r&&zM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pCe(e){var t=mCe(e,"string");return Kh(t)==="symbol"?t:String(t)}function mCe(e,t){if(Kh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Kh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var jW=function(){function e(t){var r=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];yCe(this,e),this.hot=t,this.globalMeta=new jSe(t),this.tableMeta=new USe(this.globalMeta),this.columnMeta=new oCe(this.globalMeta),this.cellMeta=new vCe(this.columnMeta),o.forEach(function(i){return new i(r)}),this.globalMeta.updateMeta(n)}return gCe(e,[{key:"getGlobalMeta",value:function(){return this.globalMeta.getMeta()}},{key:"updateGlobalMeta",value:function(r){this.globalMeta.updateMeta(r)}},{key:"getTableMeta",value:function(){return this.tableMeta.getMeta()}},{key:"updateTableMeta",value:function(r){this.tableMeta.updateMeta(r)}},{key:"getColumnMeta",value:function(r){return this.columnMeta.getMeta(r)}},{key:"updateColumnMeta",value:function(r,n){this.columnMeta.updateMeta(r,n)}},{key:"getCellMeta",value:function(r,n,o){var i=o.visualRow,a=o.visualColumn,l=this.cellMeta.getMeta(r,n);return l.visualRow=i,l.visualCol=a,l.row=r,l.col=n,this.runLocalHooks("afterGetCellMeta",l),l}},{key:"getCellMetaKeyValue",value:function(r,n,o){if(typeof o!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(r,n,o)}},{key:"setCellMeta",value:function(r,n,o,i){this.cellMeta.setMeta(r,n,o,i)}},{key:"updateCellMeta",value:function(r,n,o){this.cellMeta.updateMeta(r,n,o)}},{key:"removeCellMeta",value:function(r,n,o){this.cellMeta.removeMeta(r,n,o)}},{key:"getCellsMeta",value:function(){return this.cellMeta.getMetas()}},{key:"getCellsMetaAtRow",value:function(r){return this.cellMeta.getMetasAtRow(r)}},{key:"createRow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(r,n)}},{key:"removeRow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(r,n)}},{key:"createColumn",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(r,n),this.columnMeta.createColumn(r,n)}},{key:"removeColumn",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(r,n),this.columnMeta.removeColumn(r,n)}},{key:"clearCellsCache",value:function(){this.cellMeta.clearCache()}},{key:"clearCache",value:function(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}]),e}();pt(jW,Pr);function $p(e){"@babel/helpers - typeof";return $p=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$p(e)}function YM(e,t,r,n){var o=n.hotInstance,i=n.dataMap,a=n.dataSource,l=n.internalSource,s=n.source,u=n.metaManager,f=n.firstRun,c=ar(l),h=o.getSettings();Array.isArray(h.dataSchema)?o.dataType="array":bt(h.dataSchema)?o.dataType="function":o.dataType="object",i&&i.destroy(),e=o.runHooks("before".concat(c),e,f,s);var d=new $Se(o,e,u);if(t(d),$p(e)==="object"&&e!==null)e.push&&e.splice||(e=[e]);else if(e===null){var v=d.getSchema();e=[];var g,m=0,w=0;for(m=0,w=h.startRows;m<w;m++)if((o.dataType==="object"||o.dataType==="function")&&h.dataSchema)g=lr(v),e.push(g);else if(o.dataType==="array")g=lr(v[0]),e.push(g);else{g=[];for(var S=0,C=h.startCols;S<C;S++)g.push(null);e.push(g)}}else throw new Error("".concat(l," only accepts array of objects or array of arrays (").concat($p(e)," given)"));Array.isArray(e[0])&&(o.dataType="array"),h.data=e,d.dataSource=e,a.data=e,a.dataType=o.dataType,a.colToProp=d.colToProp.bind(d),a.propToCol=d.propToCol.bind(d),a.countCachedColumns=d.countCachedColumns.bind(d),r(d),o.runHooks("after".concat(c),e,f,s),f||(o.runHooks("afterChange",null,l),o.render())}function qh(e){"@babel/helpers - typeof";return qh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qh(e)}function bCe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,SCe(n.key),n)}}function wCe(e,t,r){return t&&GM(e.prototype,t),r&&GM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function SCe(e){var t=CCe(e,"string");return qh(t)==="symbol"?t:String(t)}function CCe(e,t){if(qh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _Ce=function(){function e(t){var r=this;bCe(this,e),this.metaManager=t,this.metaSyncMemo=new Map,t.addLocalHook("afterGetCellMeta",function(n){return r.extendCellMeta(n)}),pe.getSingleton().add("beforeRender",function(n){n&&r.metaSyncMemo.clear()},this.metaManager.hot)}return wCe(e,[{key:"extendCellMeta",value:function(r){var n,o=r.row,i=r.col;if(!((n=this.metaSyncMemo.get(o))!==null&&n!==void 0&&n.has(i))){var a=r.visualRow,l=r.visualCol,s=this.metaManager.hot,u=s.colToProp(l);r.prop=u,s.runHooks("beforeGetCellMeta",a,l,r);var f=At(r,"type")?r.type:null,c=bt(r.cells)?r.cells(o,i,u):null;if(f)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:f}else c={type:f};c&&this.metaManager.updateCellMeta(o,i,c),s.runHooks("afterGetCellMeta",a,l,r),this.metaSyncMemo.has(o)||this.metaSyncMemo.set(o,new Set),this.metaSyncMemo.get(o).add(i)}}}]),e}();function Xh(e){"@babel/helpers - typeof";return Xh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xh(e)}function OCe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ECe(n.key),n)}}function RCe(e,t,r){return t&&KM(e.prototype,t),r&&KM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ECe(e){var t=TCe(e,"string");return Xh(t)==="symbol"?t:String(t)}function TCe(e,t){if(Xh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kCe=function(){function e(t){OCe(this,e),this.metaManager=t,this.usageTracker=new Set,this.propDescriptors=new Map([["fixedColumnsLeft",{target:"fixedColumnsStart",onChange:function(n){var o=this.metaManager.hot.isRtl();if(o&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange:function(n,o,i){if(!i)throw new Error("The `".concat(n,"` option can not be updated after the Handsontable is initialized."))}}]]),this.extendMetaProps()}return RCe(e,[{key:"extendMetaProps",value:function(){var r=this;this.propDescriptors.forEach(function(n,o){var i=n.target,a=n.onChange,l=a===void 0?function(){}:a,s=typeof i=="string",u=s?i:o,f="_".concat(u);r.metaManager.globalMeta.meta[f]=r.metaManager.globalMeta.meta[u],r.installPropWatcher(o,f,l),s&&r.installPropWatcher(i,f,l)})}},{key:"installPropWatcher",value:function(r,n,o){var i=this;Object.defineProperty(this.metaManager.globalMeta.meta,r,{get:function(){return this[n]},set:function(l){var s=!i.usageTracker.has(r);i.usageTracker.add(r),o.call(i,r,l,s),this[n]=l},enumerable:!0,configurable:!0})}}]),e}(),qM=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),dy=function(t){return t.map(function(r){var n=r.toLowerCase();return qM.has(n)?qM.get(n):n}).sort().join("+")},PCe=function(t){return t.split("+")},XM=function(t){return t.toLowerCase()},ZM;function $Ce(e){return MCe(e)||ICe(e)||FW(e)||ACe()}function ACe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ICe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function MCe(e){if(Array.isArray(e))return J_(e)}function xCe(e,t){return HCe(e)||NCe(e,t)||FW(e,t)||DCe()}function DCe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function FW(e,t){if(e){if(typeof e=="string")return J_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return J_(e,t)}}function J_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function NCe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function HCe(e){if(Array.isArray(e))return e}function LCe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var jCe=function(t){var r=jm({errorIdExists:function(f){return'The "'.concat(f,'" shortcut is already registered in the "').concat(t,'" context.')}}),n=function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=f.keys,h=f.callback,d=f.group,v=f.runOnlyIf,g=v===void 0?function(){return!0}:v,m=f.captureCtrl,w=m===void 0?!1:m,S=f.preventDefault,C=S===void 0?!0:S,k=f.stopPropagation,R=k===void 0?!1:k,V=f.relativeToGroup,U=f.position;if(gt(d))throw new Error("You need to define the shortcut's group.");if(bt(h)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(c)===!1)throw new Error(ft(ZM||(ZM=LCe([`Pass the shortcut's keys as an array of arrays, 
      using the KeyboardEvent.key properties: 
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`],[`Pass the shortcut\\'s keys as an array of arrays,\\x20
      using the KeyboardEvent.key properties:\\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`]))));var X={callback:h,group:d,runOnlyIf:g,captureCtrl:w,preventDefault:C,stopPropagation:R};if(ve(V)){var Y=[V,U];X.relativeToGroup=Y[0],X.position=Y[1]}c.forEach(function(q){var Z=dy(q),ie=r.hasItem(Z);if(ie){var J=r.getItem(Z),le=J.findIndex(function(Se){return Se.group===V});le!==-1?U==="before"?le-=1:le+=1:le=J.length,J.splice(le,0,X)}else r.addItem(Z,[X])})},o=function(f){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};f.forEach(function(h){We(c,function(d,v){Object.prototype.hasOwnProperty.call(h,v)===!1&&(h[v]=c[v])}),n(h)})},i=function(f){var c=dy(f);r.removeItem(c)},a=function(f){var c=r.getItems();c.forEach(function(h){var d=xCe(h,2),v=d[0],g=d[1],m=g.filter(function(w){return w.group!==f});m.length===0?i(PCe(v)):(g.length=0,g.push.apply(g,$Ce(m)))})},l=function(f){var c=dy(f),h=r.getItem(c);return ve(h)?h.slice():[]},s=function(f){var c=dy(f);return r.hasItem(c)};return{addShortcut:n,addShortcuts:o,getShortcuts:l,hasShortcut:s,removeShortcutsByKeys:i,removeShortcutsByGroup:a}};function FCe(){var e=new Set;return{press:function(r){e.add(r)},release:function(r){e.delete(r)},releaseAll:function(){e.clear()},isPressed:function(r){return e.has(r)}}}var BCe=["meta","alt","shift","control"],Xf=FCe();function VCe(e,t,r,n,o){var i=function(d){return BCe.includes(d)},a=function(d){var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,g=[];return d.altKey&&g.push("alt"),v&&(d.ctrlKey||d.metaKey)?g.push("control/meta"):(d.ctrlKey&&g.push("control"),d.metaKey&&g.push("meta")),d.shiftKey&&g.push("shift"),g},l=function(d){if(t(d)!==!1){var v=r(d);if(!(d.keyCode===229||v===!1||ta(d))){var g=XM(d.key),m=[];i(g)?Xf.press(g):m=a(d);var w=[g].concat(m),S=o(d,w);!S&&(jg()&&m.includes("meta")||!jg()&&m.includes("control"))&&o(d,[g].concat(a(d,!0))),n(d)}}},s=function(d){if(t(d)!==!1){var v=XM(d.key);i(v)!==!1&&Xf.release(v)}},u=function(){Xf.releaseAll()},f=function(){for(var d=e;d;)d.document.documentElement.addEventListener("keydown",l),d.document.documentElement.addEventListener("keyup",s),d.document.documentElement.addEventListener("blur",u),d=Wc(d)},c=function(){for(var d=e;d;)d.document.documentElement.removeEventListener("keydown",l),d.document.documentElement.removeEventListener("keyup",s),d.document.documentElement.removeEventListener("blur",u),d=Wc(d)};return{mount:f,unmount:c,isPressed:function(d){return Xf.isPressed(d)},releasePressedKeys:function(){return Xf.releaseAll()}}}var WCe=function(t){var r=t.ownerWindow,n=t.handleEvent,o=t.beforeKeyDown,i=t.afterKeyDown,a=jm({errorIdExists:function(g){return'The "'.concat(g,'" context name is already registered.')}}),l="grid",s=function(g){var m=jCe(g);return a.addItem(g,m),m},u=function(){return l},f=function(g){return a.getItem(g)},c=function(g){l=g},h=!1,d=VCe(r,n,o,i,function(v,g){var m=f(u()),w=!1;if(!m.hasShortcut(g))return w;for(var S=m.getShortcuts(g),C=0;C<S.length;C++){var k=S[C],R=k.callback,V=k.runOnlyIf,U=k.preventDefault,X=k.stopPropagation,Y=k.captureCtrl;if(V(v)!==!1&&(h=Y,w=R(v,g)===!1,h=!1,U&&v.preventDefault(),X&&v.stopPropagation(),w))break}return w});return d.mount(),{addContext:s,getActiveContextName:u,getContext:f,setActiveContextName:c,isCtrlPressed:function(){return!h&&(d.isPressed("control")||d.isPressed("meta"))},releasePressedKeys:function(){return d.releasePressedKeys()},destroy:function(){return d.unmount()}}},JM,QM;function Cr(e){"@babel/helpers - typeof";return Cr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cr(e)}function ex(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function On(e,t){return YCe(e)||zCe(e,t)||BW(e,t)||UCe()}function UCe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zCe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function YCe(e){if(Array.isArray(e))return e}function wl(e){return qCe(e)||KCe(e)||BW(e)||GCe()}function GCe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function BW(e,t){if(e){if(typeof e=="string")return Q_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Q_(e,t)}}function KCe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function qCe(e){if(Array.isArray(e))return Q_(e)}function Q_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var XCe="gridDefault",Fw=null,vy=new Set;function bk(e,t){var r,n=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,a=this,l=new Tt(a),s,u,f,c,h=!0;ige(o)&&oge(this),this.rootElement=e,this.rootDocument=e.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;var d=(r=t==null?void 0:t.layoutDirection)!==null&&r!==void 0?r:"inherit",v=["rtl","ltr"].includes(d)?d:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",v),this.isRtl=function(){return v==="rtl"},this.isLtr=function(){return!a.isRtl()},this.getDirectionFactor=function(){return a.isLtr()?1:-1},t.language=abe(t.language);var g=new jW(a,t,[_Ce,kCe]),m=g.getTableMeta(),w=g.getGlobalMeta(),S=jm();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,e.insertBefore(this.container,e.firstChild),E_(this)&&CV(t.licenseKey,e),this.guid="ht_".concat(yE()),this.columnIndexMapper=new V_,this.rowIndexMapper=new V_,this.columnIndexMapper.addLocalHook("indexesSequenceChange",function(y){a.runHooks("afterColumnSequenceChange",y)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",function(y){a.runHooks("afterRowSequenceChange",y)}),u=new $ge(a),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);var C=function(p){var b=p.row,_=p.col;return a._createCellCoords(b>=0?a.rowIndexMapper.getRenderableFromVisualIndex(b):b,_>=0?a.columnIndexMapper.getRenderableFromVisualIndex(_):_)},k=function(p){var b=p.row,_=p.col;return a._createCellCoords(b>=0?a.rowIndexMapper.getVisualFromRenderableIndex(b):b,_>=0?a.columnIndexMapper.getVisualFromRenderableIndex(_):_)},R=new sSe(m,{rowIndexMapper:function(){return a.rowIndexMapper},columnIndexMapper:function(){return a.columnIndexMapper},countCols:function(){return a.countCols()},countRows:function(){return a.countRows()},propToCol:function(p){return s.propToCol(p)},isEditorOpened:function(){return a.getActiveEditor()?a.getActiveEditor().isOpened():!1},countColsTranslated:function(){return n.view.countRenderableColumns()},countRowsTranslated:function(){return n.view.countRenderableRows()},getShortcutManager:function(){return a.getShortcutManager()},createCellCoords:function(p,b){return a._createCellCoords(p,b)},createCellRange:function(p,b,_){return a._createCellRange(p,b,_)},visualToRenderableCoords:C,renderableToVisualCoords:k,isDisabledCellSelection:function(p,b){return a.getCellMeta(p,b).disableVisualSelection}});this.selection=R;var V=function(p){var b=p.hiddenIndexesChanged;b&&n.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",V),this.rowIndexMapper.addLocalHook("cacheUpdated",V),this.selection.addLocalHook("beforeSetRangeStart",function(y){n.runHooks("beforeSetRangeStart",y)}),this.selection.addLocalHook("beforeSetRangeStartOnly",function(y){n.runHooks("beforeSetRangeStartOnly",y)}),this.selection.addLocalHook("beforeSetRangeEnd",function(y){n.runHooks("beforeSetRangeEnd",y),y.row<0&&(y.row=n.view._wt.wtTable.getFirstVisibleRow()),y.col<0&&(y.col=n.view._wt.wtTable.getFirstVisibleColumn())}),this.selection.addLocalHook("afterSetRangeEnd",function(y){var p=Da(!1),b=n.selection.getSelectedRange(),_=b.current(),T=_.from,I=_.to,F=b.size()-1;n.runHooks("afterSelection",T.row,T.col,I.row,I.col,p,F),n.runHooks("afterSelectionByProp",T.row,a.colToProp(T.col),I.row,a.colToProp(I.col),p,F);var W=n.selection.isSelectedByAnyHeader(),G=n.selection.selectedRange.current(),Q=!0;i&&(Q=!1),p.isTouched()&&(Q=!p.value);var ee=n.selection.isSelectedByRowHeader(),se=n.selection.isSelectedByColumnHeader();Q!==!1&&(W?ee?n.view.scrollViewportVertically(a.rowIndexMapper.getRenderableFromVisualIndex(y.row)):se&&n.view.scrollViewportHorizontally(a.columnIndexMapper.getRenderableFromVisualIndex(y.col)):G&&!n.selection.isMultiple()?n.view.scrollViewport(C(G.from)):n.view.scrollViewport(C(y))),ee&&se?re(n.rootElement,["ht__selection--rows","ht__selection--columns"]):ee?(Le(n.rootElement,"ht__selection--columns"),re(n.rootElement,"ht__selection--rows")):se?(Le(n.rootElement,"ht__selection--rows"),re(n.rootElement,"ht__selection--columns")):Le(n.rootElement,["ht__selection--rows","ht__selection--columns"]),n._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",function(y){var p=y.length-1,b=y[p],_=b.from,T=b.to;n.runHooks("afterSelectionEnd",_.row,_.col,T.row,T.col,p),n.runHooks("afterSelectionEndByProp",_.row,a.colToProp(_.col),T.row,a.colToProp(T.col),p)}),this.selection.addLocalHook("afterIsMultipleSelection",function(y){var p=n.runHooks("afterIsMultipleSelection",y.value);y.value&&(y.value=p)}),this.selection.addLocalHook("beforeModifyTransformStart",function(y){n.runHooks("modifyTransformStart",y)}),this.selection.addLocalHook("afterModifyTransformStart",function(y,p,b){n.runHooks("afterModifyTransformStart",y,p,b)}),this.selection.addLocalHook("beforeModifyTransformEnd",function(y){n.runHooks("modifyTransformEnd",y)}),this.selection.addLocalHook("afterModifyTransformEnd",function(y,p,b){n.runHooks("afterModifyTransformEnd",y,p,b)}),this.selection.addLocalHook("afterDeselect",function(){c.destroyEditor(),n._refreshBorders(),Le(n.rootElement,["ht__selection--rows","ht__selection--columns"]),n.runHooks("afterDeselect")}),this.selection.addLocalHook("insertRowRequire",function(y){n.alter("insert_row_above",y,1,"auto")}),this.selection.addLocalHook("insertColRequire",function(y){n.alter("insert_col_start",y,1,"auto")}),f={alter:function(p,b){var _,T,I=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,F=arguments.length>3?arguments[3]:void 0,W=arguments.length>4?arguments[4]:void 0,G=function(Ne){if(Ne.length===0)return[];var He=wl(Ne);He.sort(function(it,Qe){var Xe=On(it,1),Je=Xe[0],jt=On(Qe,1),yt=jt[0];return Je===yt?0:Je>yt?1:-1});var rt=Lt(He,function(it,Qe){var Xe=On(Qe,2),Je=Xe[0],jt=Xe[1],yt=it[it.length-1],st=On(yt,2),nt=st[0],Di=st[1],Uo=nt+Di;if(Je<=Uo){var sl=Math.max(jt-(Uo-Je),0);yt[1]+=sl}else it.push([Je,jt]);return it},[He[0]]);return rt};switch(p){case"insert_row":vy.has(p)||(vy.add(p),ht(ft(JM||(JM=ex(["The `","` action of the `alter()` method is deprecated and will be removed \n                              in the next major release of Handsontable. Use the `insert_row_above` action instead."],["The \\`","\\` action of the \\`alter()\\` method is deprecated and will be removed\\x20\n                              in the next major release of Handsontable. Use the \\`insert_row_above\\` action instead."])),p)));case"insert_row_below":case"insert_row_above":var Q=a.countSourceRows();if(m.maxRows===Q)return;var ee=p==="insert_row_below"?"below":"above";b=(_=b)!==null&&_!==void 0?_:p==="insert_row"||ee==="below"?Q:0;var se=s.createRow(b,I,{source:F,mode:ee}),Re=se.delta,ce=se.startPhysicalIndex;if(Re){var de=R.selectedRange.current(),K=de==null?void 0:de.from,Me=K==null?void 0:K.row,Ge=a.toVisualRow(ce);if(R.isSelectedByCorner())a.selectAll();else if(ve(Me)&&Me>=Ge){var Pe=de.to,Ie=Pe.row,$e=Pe.col,O=K.col;R.isSelectedByRowHeader()&&(O=-1),R.getSelectedRange().pop(),R.setRangeStartOnly(a._createCellCoords(Me+Re,O),!0),R.setRangeEnd(a._createCellCoords(Ie+Re,$e))}else a._refreshBorders()}break;case"insert_col":vy.has(p)||(vy.add(p),ht(ft(QM||(QM=ex(["The `","` action of the `alter()` method is deprecated and will be removed \n                              in the next major release of Handsontable. Use the `insert_col_start` action instead."],["The \\`","\\` action of the \\`alter()\\` method is deprecated and will be removed\\x20\n                              in the next major release of Handsontable. Use the \\`insert_col_start\\` action instead."])),p)));case"insert_col_start":case"insert_col_end":var E=p==="insert_col_end"?"end":"start";b=(T=b)!==null&&T!==void 0?T:p==="insert_col"||E==="end"?a.countSourceCols():0;var A=s.createCol(b,I,{source:F,mode:E}),H=A.delta,M=A.startPhysicalIndex;if(H){if(Array.isArray(m.colHeaders)){var j=[a.toVisualColumn(M),0];j.length+=H,Array.prototype.splice.apply(m.colHeaders,j)}var x=R.selectedRange.current(),D=x==null?void 0:x.from,B=D==null?void 0:D.col,L=a.toVisualColumn(M);if(R.isSelectedByCorner())a.selectAll();else if(ve(B)&&B>=L){var z=x.to,ae=z.row,ge=z.col,Oe=D.row;R.isSelectedByColumnHeader()&&(Oe=-1),R.getSelectedRange().pop(),R.setRangeStartOnly(a._createCellCoords(Oe,B+H),!0),R.setRangeEnd(a._createCellCoords(ae,ge+H))}else a._refreshBorders()}break;case"remove_row":var De=function(Ne){var He=0;$(Ne,function(rt){var it=On(rt,2),Qe=it[0],Xe=it[1],Je=Kt(Qe)?a.countRows()-1:Math.max(Qe-He,0);Number.isInteger(Qe)&&(Qe=Math.max(Qe-He,0));var jt=s.removeRow(Qe,Xe,F);if(jt){var yt=a.countRows(),st=m.fixedRowsTop;st>=Je+1&&(m.fixedRowsTop-=Math.min(Xe,st-Je));var nt=m.fixedRowsBottom;nt&&Je>=yt-nt&&(m.fixedRowsBottom-=Math.min(Xe,nt)),He+=Xe}})};Array.isArray(b)?De(G(b)):De([[b,I]]),f.adjustRowsAndCols(),a._refreshBorders();break;case"remove_col":var qe=function(Ne){var He=0;$(Ne,function(rt){var it=On(rt,2),Qe=it[0],Xe=it[1],Je=Kt(Qe)?a.countCols()-1:Math.max(Qe-He,0),jt=a.toPhysicalColumn(Je);Number.isInteger(Qe)&&(Qe=Math.max(Qe-He,0));var yt=s.removeCol(Qe,Xe,F);if(yt){var st=m.fixedColumnsStart;st>=Je+1&&(m.fixedColumnsStart-=Math.min(Xe,st-Je)),Array.isArray(m.colHeaders)&&(typeof jt>"u"&&(jt=-1),m.colHeaders.splice(jt,Xe)),He+=Xe}})};Array.isArray(b)?qe(G(b)):qe([[b,I]]),f.adjustRowsAndCols(),a._refreshBorders();break;default:throw new Error('There is no such action "'.concat(p,'"'))}W||f.adjustRowsAndCols()},adjustRowsAndCols:function(){var p=m.minRows,b=m.minSpareRows,_=m.minCols,T=m.minSpareCols;if(a.countRows()===0&&a.countCols()===0&&R.deselect(),p){var I=a.countRows();I<p&&s.createRow(I,p-I,{source:"auto"})}if(b){var F=a.countEmptyRows(!0);if(F<b){var W=b-F,G=Math.min(W,m.maxRows-a.countSourceRows());s.createRow(a.countRows(),G,{source:"auto"})}}{var Q;(_||T)&&(Q=a.countEmptyCols(!0));var ee=a.countCols();if(_&&!m.columns&&ee<_){var se=_-ee;Q+=se,s.createCol(ee,se,{source:"auto"})}if(T&&!m.columns&&a.dataType==="array"&&Q<T){ee=a.countCols();var Re=T-Q,ce=Math.min(Re,m.maxCols-ee);s.createCol(ee,ce,{source:"auto"})}}if(R.isSelected()){var de=a.countRows(),K=a.countCols();$(R.selectedRange,function(Me){var Ge=!1,Pe=Me.from.row,Ie=Me.from.col,$e=Me.to.row,O=Me.to.col;Pe>de-1?(Pe=de-1,Ge=!0,$e>Pe&&($e=Pe)):$e>de-1&&($e=de-1,Ge=!0,Pe>$e&&(Pe=$e)),Ie>K-1?(Ie=K-1,Ge=!0,O>Ie&&(O=Ie)):O>K-1&&(O=K-1,Ge=!0,Ie>O&&(Ie=O)),Ge&&a.selectCell(Pe,Ie,$e,O)})}a.view&&a.view.adjustElementsSize()},populateFromArray:function(p,b,_,T,I,F,W){var G,Q,ee,se,Re=[],ce={},de=[],K=p.row,Me=p.col;if(Q=b.length,Q===0)return!1;var Ge=0,Pe=0;switch(Ve(_)&&(Ge=_.col-Me+1,Pe=_.row-K+1),I){case"shift_down":var Ie=wc(b),$e=Ie.length,O=Math.max($e,Ge),E=a.getData().slice(K),A=wc(E).slice(Me,Me+O);for(ee=0;ee<O;ee+=1)if(ee<$e){for(G=0,Q=Ie[ee].length;G<Pe-Q;G+=1)Ie[ee].push(Ie[ee][G%Q]);ee<A.length?de.push(Ie[ee].concat(A[ee])):de.push(Ie[ee].concat(new Array(E.length).fill(null)))}else de.push(Ie[ee%$e].concat(A[ee]));a.populateFromArray(K,Me,wc(de));break;case"shift_right":var H=b.length,M=Math.max(H,Pe),j=a.getData().slice(K).map(function(st){return st.slice(Me)});for(G=0;G<M;G+=1)if(G<H){for(ee=0,se=b[G].length;ee<Ge-se;ee+=1)b[G].push(b[G][ee%se]);if(G<j.length)for(var x=0;x<j[G].length;x+=1)b[G].push(j[G][x]);else{var D;(D=b[G]).push.apply(D,wl(new Array(j[0].length).fill(null)))}}else b.push(b[G%Q].slice(0,M).concat(j[G]));a.populateFromArray(K,Me,b);break;case"overwrite":default:ce.row=p.row,ce.col=p.col;var B={row:_&&p?_.row-p.row+1:1,col:_&&p?_.col-p.col+1:1},L=0,z=0,ae=!0,ge,Oe=function(nt){var Di=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,Uo=b[nt%b.length];return Di!==null?Uo[Di%Uo.length]:Uo},De=b.length,qe=_?_.row-p.row+1:0;for(_?Q=qe:Q=Math.max(De,qe),G=0;G<Q&&!(_&&ce.row>_.row&&qe>De||!m.allowInsertRow&&ce.row>a.countRows()-1||ce.row>=m.maxRows);G++){var ct=G-L,Ne=Oe(ct).length,He=_?_.col-p.col+1:0;if(_?se=He:se=Math.max(Ne,He),ce.col=p.col,ge=a.getCellMeta(ce.row,ce.col),(T==="CopyPaste.paste"||T==="Autofill.fill")&&ge.skipRowOnPaste){L+=1,ce.row+=1,Q+=1;continue}for(z=0,ee=0;ee<se&&!(_&&ce.col>_.col&&He>Ne||!m.allowInsertColumn&&ce.col>a.countCols()-1||ce.col>=m.maxCols);ee++){if(ge=a.getCellMeta(ce.row,ce.col),(T==="CopyPaste.paste"||T==="Autofill.fill")&&ge.skipColumnOnPaste){z+=1,ce.col+=1,se+=1;continue}if(ge.readOnly&&T!=="UndoRedo.undo"){ce.col+=1;continue}var rt=ee-z,it=Oe(ct,rt),Qe=a.getDataAtCell(ce.row,ce.col),Xe={row:ct,col:rt};if(T==="Autofill.fill"){var Je=a.runHooks("beforeAutofillInsidePopulate",Xe,F,b,W,{},B);Je&&(it=gt(Je.value)?it:Je.value)}if(it!==null&&Cr(it)==="object")if(Array.isArray(it)&&Qe===null&&(Qe=[]),Qe===null||Cr(Qe)!=="object")ae=!1;else{var jt=ds(Array.isArray(Qe)?Qe:Qe[0]||Qe),yt=ds(Array.isArray(it)?it:it[0]||it);wm(jt,yt)||Array.isArray(jt)&&Array.isArray(yt)?it=lr(it):ae=!1}else Qe!==null&&Cr(Qe)==="object"&&(ae=!1);ae&&Re.push([ce.row,ce.col,it]),ae=!0,ce.col+=1}ce.row+=1}a.setDataAtCell(Re,null,null,T||"populateFromArray");break}}};function U(y){var p=gW(y);vk(p)?(a.runHooks("beforeLanguageChange",p),w.language=p,a.runHooks("afterLanguageChange",p)):pW(y)}function X(y,p){var b=y==="className"?a.rootElement:a.table;if(h)re(b,p);else{var _=[],T=[];w[y]&&(_=Array.isArray(w[y])?w[y]:RC(w[y])),p&&(T=Array.isArray(p)?p:RC(p));var I=OC(_,T),F=OC(T,_);I.length&&Le(b,I),F.length&&re(b,F)}w[y]=p}this.init=function(){u.setData(m.data),a.runHooks("beforeInit"),(cn()||G0())&&re(a.rootElement,"mobile"),this.updateSettings(m,!0),this.view=new bge(this),c=Sle.getInstance(a,m,R),a.runHooks("init"),this.forceFullRender=!0,this.view.render(),h&&a.rootElement.offsetParent===null&&IV(a.rootElement,function(){a.view._wt.wtOverlays.updateLastSpreaderSize(),a.render(),a.view.adjustElementsSize()}),Cr(h)==="object"&&(a.runHooks("afterChange",h[0],h[1]),h=!1),a.runHooks("afterInit")};function Y(){var y=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue+=1,y=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){this.validatorsInQueue===0&&y===!1&&(y=!0,this.onQueueEmpty(this.valid))}}}function q(y){var p=y.replace(",",".");return isNaN(parseFloat(p))===!1?parseFloat(p):y}function Z(y,p,b){if(y.length){var _=a.getActiveEditor(),T=a.runHooks("beforeChange",y,p||"edit"),I=!0;if(T===!1){_&&_.cancelChanges();return}var F=new Y;F.onQueueEmpty=function(de){_&&I&&_.cancelChanges(),b(de)};for(var W=y.length-1;W>=0;W--)if(y[W]===null)y.splice(W,1);else{var G=On(y[W],4),Q=G[0],ee=G[1],se=G[3],Re=s.propToCol(ee),ce=a.getCellMeta(Q,Re);ce.type==="numeric"&&typeof se=="string"&&t2(se)&&(y[W][3]=q(se)),a.getCellValidator(ce)&&(F.addValidatorToQueue(),a.validateCell(y[W][3],ce,function(de,K){return function(Me){if(typeof Me!="boolean")throw new Error("Validation error: result is not boolean");if(Me===!1&&K.allowInvalid===!1){I=!1,y.splice(de,1),K.valid=!0;var Ge=a.getCell(K.visualRow,K.visualCol);Ge!==null&&Le(Ge,m.invalidCellClassName)}F.removeValidatorFormQueue()}}(W,ce),p))}F.checkIfQueueIsEmpty()}}function ie(y,p){var b=y.length-1;if(!(b<0)){for(;b>=0;b--){var _=!1;if(y[b]===null){y.splice(b,1);continue}if(!((y[b][2]===null||y[b][2]===void 0)&&(y[b][3]===null||y[b][3]===void 0))){if(m.allowInsertRow)for(;y[b][0]>a.countRows()-1;){var T=s.createRow(void 0,void 0,{source:p}),I=T.delta;if(I===0){_=!0;break}}if(a.dataType==="array"&&(!m.columns||m.columns.length===0)&&m.allowInsertColumn)for(;s.propToCol(y[b][1])>a.countCols()-1;){var F=s.createCol(void 0,void 0,{source:p}),W=F.delta;if(W===0){_=!0;break}}_||s.set(y[b][0],y[b][1],y[b][3])}}a.forceFullRender=!0,f.adjustRowsAndCols(),a.runHooks("beforeChangeRender",y,p),c.lockEditor(),a._refreshBorders(null),c.unlockEditor(),a.view.adjustElementsSize(),a.runHooks("afterChange",y,p||"edit");var G=a.getActiveEditor();G&&ve(G.refreshValue)&&G.refreshValue()}}this._createCellCoords=function(y,p){return a.view._wt.createCellCoords(y,p)},this._createCellRange=function(y,p,b){return a.view._wt.createCellRange(y,p,b)},this.validateCell=function(y,p,b,_){var T=a.getCellValidator(p);function I(F){var W=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!W||p.hidden===!0){b(F);return}var G=p.visualCol,Q=p.visualRow,ee=a.getCell(Q,G,!0);if(ee&&ee.nodeName!=="TH"){var se=a.rowIndexMapper.getRenderableFromVisualIndex(Q),Re=a.columnIndexMapper.getRenderableFromVisualIndex(G);a.view._wt.getSetting("cellRenderer",se,Re,ee)}b(F)}SV(T)&&(T=function(F){return function(W,G){G(F.test(W))}}(T)),bt(T)?(y=a.runHooks("beforeValidate",y,p.visualRow,p.prop,_),a._registerImmediate(function(){T.call(p,y,function(F){a&&(F=a.runHooks("afterValidate",F,y,p.visualRow,p.prop,_),p.valid=F,I(F),a.runHooks("postAfterValidate",F,y,p.visualRow,p.prop,_))})})):a._registerImmediate(function(){p.valid=!0,I(p.valid,!1)})};function J(y,p,b){return Array.isArray(y)?y:[[y,p,b]]}this.setDataAtCell=function(y,p,b,_){var T=J(y,p,b),I=[],F=_,W,G,Q;for(W=0,G=T.length;W<G;W++){if(Cr(T[W])!=="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof T[W][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");T[W][1]>=this.countCols()?Q=T[W][1]:Q=s.colToProp(T[W][1]),I.push([T[W][0],Q,u.getAtCell(this.toPhysicalRow(T[W][0]),T[W][1]),T[W][2]])}!F&&Cr(y)==="object"&&(F=p),a.runHooks("afterSetDataAtCell",I,F),Z(I,F,function(){ie(I,F)})},this.setDataAtRowProp=function(y,p,b,_){var T=J(y,p,b),I=[],F=_,W,G;for(W=0,G=T.length;W<G;W++)I.push([T[W][0],T[W][1],u.getAtCell(this.toPhysicalRow(T[W][0]),T[W][1]),T[W][2]]);!F&&Cr(y)==="object"&&(F=p),a.runHooks("afterSetDataAtRowProp",I,F),Z(I,F,function(){ie(I,F)})},this.listen=function(){a&&!a.isListening()&&(Fw=a.guid,a.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(Fw=null,a.runHooks("afterUnlisten"))},this.isListening=function(){return Fw===a.guid},this.destroyEditor=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;a._refreshBorders(y,p)},this.populateFromArray=function(y,p,b,_,T,I,F,W,G){if(!(Cr(b)==="object"&&Cr(b[0])==="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");var Q=typeof _=="number"?a._createCellCoords(_,T):null;return f.populateFromArray(a._createCellCoords(y,p),b,Q,I,F,W,G)},this.spliceCol=function(y,p,b){for(var _,T=arguments.length,I=new Array(T>3?T-3:0),F=3;F<T;F++)I[F-3]=arguments[F];return(_=s).spliceCol.apply(_,[y,p,b].concat(I))},this.spliceRow=function(y,p,b){for(var _,T=arguments.length,I=new Array(T>3?T-3:0),F=3;F<T;F++)I[F-3]=arguments[F];return(_=s).spliceRow.apply(_,[y,p,b].concat(I))},this.getSelected=function(){if(R.isSelected())return Be(R.getSelectedRange(),function(y){var p=y.from,b=y.to;return[p.row,p.col,b.row,b.col]})},this.getSelectedLast=function(){var y=this.getSelected(),p;return y&&y.length>0&&(p=y[y.length-1]),p},this.getSelectedRange=function(){if(R.isSelected())return Array.from(R.getSelectedRange())},this.getSelectedRangeLast=function(){var y=this.getSelectedRange(),p;return y&&y.length>0&&(p=y[y.length-1]),p},this.emptySelectedCells=function(y){var p=this;if(!(!R.isSelected()||this.countRows()===0||this.countCols()===0)){var b=[];$(R.getSelectedRange(),function(_){var T=_.getTopStartCorner(),I=_.getBottomEndCorner();_e(T.row,I.row,function(F){_e(T.col,I.col,function(W){p.getCellMeta(F,W).readOnly||b.push([F,W,null])})})}),b.length>0&&this.setDataAtCell(b,y)}},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){var y=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(y,0),!this.isRenderSuspended()&&y===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(c.lockEditor(),this._refreshBorders(null),c.unlockEditor()))},this.batchRender=function(y){this.suspendRender();var p=y();return this.resumeRender(),p},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(p,0),(!this.isExecutionSuspended()&&p===this.executionSuspendedCounter||y)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(y){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();var b=y();return this.resumeExecution(p),b},this.batch=function(y){this.suspendRender(),this.suspendExecution();var p=y();return this.resumeExecution(),this.resumeRender(),p},this.refreshDimensions=function(){if(a.view){var y=a.view.getLastSize(),p=y.width,b=y.height,_=a.rootElement.getBoundingClientRect(),T=_.width,I=_.height,F=T!==p||I!==b,W=a.runHooks("beforeRefreshDimensions",{width:p,height:b},{width:T,height:I},F)===!1;W||((F||a.view._wt.wtOverlays.scrollableElement===a.rootWindow)&&(a.view.setLastSize(T,I),a.render()),a.runHooks("afterRefreshDimensions",{width:p,height:b},{width:T,height:I},F))}},this.updateData=function(y,p){var b=this;YM(y,function(_){s=_},function(_){s=_,a.columnIndexMapper.fitToLength(b.getInitialColumnCount()),a.rowIndexMapper.fitToLength(b.countSourceRows()),f.adjustRowsAndCols()},{hotInstance:a,dataMap:s,dataSource:u,internalSource:"updateData",source:p,metaManager:g,firstRun:h})},this.loadData=function(y,p){YM(y,function(b){s=b},function(){g.clearCellsCache(),a.initIndexMappers(),f.adjustRowsAndCols(),h&&(h=[null,"loadData"])},{hotInstance:a,dataMap:s,dataSource:u,internalSource:"loadData",source:p,metaManager:g,firstRun:h})},this.getInitialColumnCount=function(){var y=m.columns,p=0;if(Array.isArray(y))p=y.length;else if(bt(y))if(a.dataType==="array")for(var b=this.countSourceCols(),_=0;_<b;_+=1)y(_)&&(p+=1);else(a.dataType==="object"||a.dataType==="function")&&(p=s.colToPropCache.length);else if(ve(m.dataSchema)){var T=s.getSchema();p=Array.isArray(T)?T.length:Sm(T)}else p=this.countSourceCols();return p},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(y,p,b,_){return gt(y)?s.getAll():s.getRange(a._createCellCoords(y,p),a._createCellCoords(b,_),s.DESTINATION_RENDERER)},this.getCopyableText=function(y,p,b,_){return s.getCopyableText(a._createCellCoords(y,p),a._createCellCoords(b,_))},this.getCopyableData=function(y,p){return s.getCopyable(y,s.colToProp(p))},this.getSchema=function(){return s.getSchema()},this.updateSettings=function(y){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,b=(h?a.loadData:a.updateData).bind(this),_=!1,T,I;if(ve(y.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(ve(y.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(ve(y.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(T in y)T==="data"||(T==="language"?U(y.language):T==="className"?X("className",y.className):T==="tableClassName"&&a.table?(X("tableClassName",y.tableClassName),a.view._wt.wtOverlays.syncOverlayTableClassNames()):pe.getSingleton().isRegistered(T)||pe.getSingleton().isDeprecated(T)?(bt(y[T])||Array.isArray(y[T]))&&(y[T].initialHook=!0,a.addHook(T,y[T])):!p&&At(y,T)&&(w[T]=y[T]));y.data===void 0&&m.data===void 0?b(null,"updateSettings"):y.data!==void 0?b(y.data,"updateSettings"):y.columns!==void 0&&(s.createMap(),a.initIndexMappers());var F=a.countCols(),W=m.columns;if(W&&bt(W)&&(_=!0),(y.cell!==void 0||y.cells!==void 0||y.columns!==void 0)&&g.clearCache(),F>0)for(T=0,I=0;T<F;T++){if(W){var G=_?W(T):W[I];G&&g.updateColumnMeta(I,G)}I+=1}ve(y.cell)&&We(y.cell,function(de){a.setCellMetaObject(de.row,de.col,de)}),a.runHooks("afterCellMetaReset");var Q=a.rootElement.style.height;Q!==""&&(Q=parseInt(a.rootElement.style.height,10));var ee=y.height;if(bt(ee)&&(ee=ee()),p){var se=a.rootElement.getAttribute("style");se&&a.rootElement.setAttribute("data-initialstyle",a.rootElement.getAttribute("style"))}if(ee===null){var Re=a.rootElement.getAttribute("data-initialstyle");Re&&(Re.indexOf("height")>-1||Re.indexOf("overflow")>-1)?a.rootElement.setAttribute("style",Re):(a.rootElement.style.height="",a.rootElement.style.overflow="")}else ee!==void 0&&(a.rootElement.style.height=isNaN(ee)?"".concat(ee):"".concat(ee,"px"),a.rootElement.style.overflow="hidden");if(typeof y.width<"u"){var ce=y.width;bt(ce)&&(ce=ce()),a.rootElement.style.width=isNaN(ce)?"".concat(ce):"".concat(ce,"px")}p||(a.view&&(a.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),a.view._wt.exportSettingsAsClassNames()),a.runHooks("afterUpdateSettings",y)),f.adjustRowsAndCols(),a.view&&!h&&(a.forceFullRender=!0,c.lockEditor(),a._refreshBorders(null),a.view._wt.wtOverlays.adjustElementsSize(),c.unlockEditor()),!p&&a.view&&(Q===""||ee===""||ee===void 0)&&Q!==ee&&a.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var y=a.getSelectedLast();if(m.getValue){if(bt(m.getValue))return m.getValue.call(a);if(y)return a.getData()[y[0][0]][m.getValue]}else if(y)return a.getDataAtCell(y[0],y[1])},this.getSettings=function(){return m},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(y,p,b,_,T){f.alter(y,p,b,_,T)},this.getCell=function(y,p){var b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,_=p,T=y;if(p>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(p)))return null;_=this.columnIndexMapper.getRenderableFromVisualIndex(p)}if(y>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(y)))return null;T=this.rowIndexMapper.getRenderableFromVisualIndex(y)}return T===null||_===null?null:a.view.getCellAtCoords(a._createCellCoords(T,_),b)},this.getCoords=function(y){var p=this.view._wt.wtTable.getCoords(y);if(p===null)return null;var b=p.row,_=p.col,T=b,I=_;return b>=0&&(T=this.rowIndexMapper.getVisualFromRenderableIndex(b)),_>=0&&(I=this.columnIndexMapper.getVisualFromRenderableIndex(_)),a._createCellCoords(T,I)},this.colToProp=function(y){return s.colToProp(y)},this.propToCol=function(y){return s.propToCol(y)},this.toVisualRow=function(y){return n.rowIndexMapper.getVisualFromPhysicalIndex(y)},this.toVisualColumn=function(y){return n.columnIndexMapper.getVisualFromPhysicalIndex(y)},this.toPhysicalRow=function(y){return n.rowIndexMapper.getPhysicalFromVisualIndex(y)},this.toPhysicalColumn=function(y){return n.columnIndexMapper.getPhysicalFromVisualIndex(y)},this.getDataAtCell=function(y,p){return s.get(y,s.colToProp(p))},this.getDataAtRowProp=function(y,p){return s.get(y,p)},this.getDataAtCol=function(y){for(var p=[],b=s.getRange(a._createCellCoords(0,y),a._createCellCoords(m.data.length-1,y),s.DESTINATION_RENDERER),_=0;_<b.length;_+=1)for(var T=0;T<b[_].length;T+=1)p.push(b[_][T]);return p},this.getDataAtProp=function(y){for(var p=[],b=s.getRange(a._createCellCoords(0,s.propToCol(y)),a._createCellCoords(m.data.length-1,s.propToCol(y)),s.DESTINATION_RENDERER),_=0;_<b.length;_+=1)for(var T=0;T<b[_].length;T+=1)p.push(b[_][T]);return p},this.getSourceData=function(y,p,b,_){var T;return y===void 0?T=u.getData():T=u.getByRange(a._createCellCoords(y,p),a._createCellCoords(b,_)),T},this.getSourceDataArray=function(y,p,b,_){var T;return y===void 0?T=u.getData(!0):T=u.getByRange(a._createCellCoords(y,p),a._createCellCoords(b,_),!0),T},this.getSourceDataAtCol=function(y){return u.getAtColumn(y)},this.setSourceDataAtCell=function(y,p,b,_){var T=J(y,p,b),I=this.hasHook("afterSetSourceDataAtCell"),F=[];I&&$(T,function(G){var Q=On(G,3),ee=Q[0],se=Q[1],Re=Q[2];F.push([ee,se,u.getAtCell(ee,se),Re])}),$(T,function(G){var Q=On(G,3),ee=Q[0],se=Q[1],Re=Q[2];u.setAtCell(ee,se,Re)}),I&&this.runHooks("afterSetSourceDataAtCell",F,_),this.render();var W=a.getActiveEditor();W&&ve(W.refreshValue)&&W.refreshValue()},this.getSourceDataAtRow=function(y){return u.getAtRow(y)},this.getSourceDataAtCell=function(y,p){return u.getAtCell(y,p)},this.getDataAtRow=function(y){var p=s.getRange(a._createCellCoords(y,0),a._createCellCoords(y,this.countCols()-1),s.DESTINATION_RENDERER);return p[0]||[]},this.getDataType=function(y,p,b,_){var T=this,I=y===void 0?[0,0,this.countRows(),this.countCols()]:[y,p,b,_],F=I[0],W=I[1],G=I[2],Q=I[3],ee=null,se=null;G===void 0&&(G=F),Q===void 0&&(Q=W);var Re="mixed";return _e(Math.max(Math.min(F,G),0),Math.max(F,G),function(ce){var de=!0;return _e(Math.max(Math.min(W,Q),0),Math.max(W,Q),function(K){var Me=T.getCellMeta(ce,K);return se=Me.type,ee?de=ee===se:ee=se,de}),Re=de?se:"mixed",de}),Re},this.removeCellMeta=function(y,p,b){var _=[this.toPhysicalRow(y),this.toPhysicalColumn(p)],T=_[0],I=_[1],F=g.getCellMetaKeyValue(T,I,b),W=a.runHooks("beforeRemoveCellMeta",y,p,b,F);W!==!1&&(g.removeCellMeta(T,I,b),a.runHooks("afterRemoveCellMeta",y,p,b,F)),F=null},this.spliceCellsMeta=function(y){for(var p=this,b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,_=arguments.length,T=new Array(_>2?_-2:0),I=2;I<_;I++)T[I-2]=arguments[I];if(T.length>0&&!Array.isArray(T[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");b>0&&g.removeRow(this.toPhysicalRow(y),b),T.length>0&&$(T.reverse(),function(F){g.createRow(p.toPhysicalRow(y)),$(F,function(W,G){return p.setCellMetaObject(y,G,W)})}),a.render()},this.setCellMetaObject=function(y,p,b){var _=this;Cr(b)==="object"&&We(b,function(T,I){_.setCellMeta(y,p,I,T)})},this.setCellMeta=function(y,p,b,_){var T=a.runHooks("beforeSetCellMeta",y,p,b,_);if(T!==!1){var I=y,F=p;y<this.countRows()&&(I=this.toPhysicalRow(y)),p<this.countCols()&&(F=this.toPhysicalColumn(p)),g.setCellMeta(I,F,b,_),a.runHooks("afterSetCellMeta",y,p,b,_)}},this.getCellsMeta=function(){return g.getCellsMeta()},this.getCellMeta=function(y,p){var b=this.toPhysicalRow(y),_=this.toPhysicalColumn(p);return b===null&&(b=y),_===null&&(_=p),g.getCellMeta(b,_,{visualRow:y,visualColumn:p})},this.getCellMetaAtRow=function(y){return g.getCellsMetaAtRow(y)},this.isColumnModificationAllowed=function(){return!(a.dataType==="object"||m.columns)},this.getCellRenderer=function(y,p){var b=typeof y=="number"?a.getCellMeta(y,p).renderer:y.renderer;return typeof b=="string"?Jg(b):gt(b)?Jg("text"):b},this.getCellEditor=function(y,p){var b=typeof y=="number"?a.getCellMeta(y,p).editor:y.editor;return typeof b=="string"?Xg(b):gt(b)?Xg("text"):b},this.getCellValidator=function(y,p){var b=typeof y=="number"?a.getCellMeta(y,p).validator:y.validator;return typeof b=="string"?kE(b):b},this.validateCells=function(y){this._validateCells(y)},this.validateRows=function(y,p){if(!Array.isArray(y))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(p,y)},this.validateColumns=function(y,p){if(!Array.isArray(y))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(p,void 0,y)},this._validateCells=function(y,p,b){var _=new Y;y&&(_.onQueueEmpty=y);for(var T=a.countRows()-1;T>=0;){if(p!==void 0&&p.indexOf(T)===-1){T-=1;continue}for(var I=a.countCols()-1;I>=0;){if(b!==void 0&&b.indexOf(I)===-1){I-=1;continue}_.addValidatorToQueue(),a.validateCell(a.getDataAtCell(T,I),a.getCellMeta(T,I),function(F){if(typeof F!="boolean")throw new Error("Validation error: result is not boolean");F===!1&&(_.valid=!1),_.removeValidatorFormQueue()},"validateCells"),I-=1}T-=1}_.checkIfQueueIsEmpty()},this.getRowHeader=function(y){var p=m.rowHeaders,b=y;return b!==void 0&&(b=a.runHooks("modifyRowHeader",b)),b===void 0?(p=[],_e(a.countRows()-1,function(_){p.push(a.getRowHeader(_))})):Array.isArray(p)&&p[b]!==void 0?p=p[b]:bt(p)?p=p(b):p&&typeof p!="string"&&typeof p!="number"&&(p=b+1),p},this.hasRowHeaders=function(){return!!m.rowHeaders},this.hasColHeaders=function(){if(m.colHeaders!==void 0&&m.colHeaders!==null)return!!m.colHeaders;for(var y=0,p=a.countCols();y<p;y++)if(a.getColHeader(y))return!0;return!1},this.getColHeader=function(y){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,b=a.runHooks("modifyColHeader",y);if(b===void 0){for(var _=[],T=a.countCols(),I=0;I<T;I++)_.push(a.getColHeader(I));return _}var F=m.colHeaders,W=function(se){for(var Re=[],ce=a.countCols(),de=0;de<ce;de++)bt(m.columns)&&m.columns(de)&&Re.push(de);return Re[se]},G=a.toPhysicalColumn(b),Q=W(G);return m.colHeaders===!1?F=null:m.columns&&bt(m.columns)&&m.columns(Q)&&m.columns(Q).title?F=m.columns(Q).title:m.columns&&m.columns[G]&&m.columns[G].title?F=m.columns[G].title:Array.isArray(m.colHeaders)&&m.colHeaders[G]!==void 0?F=m.colHeaders[G]:bt(m.colHeaders)?F=m.colHeaders(G):m.colHeaders&&typeof m.colHeaders!="string"&&typeof m.colHeaders!="number"&&(F=Fm(b)),F=a.runHooks("modifyColumnHeaderValue",F,y,p),F},this._getColWidthFromSettings=function(y){var p;if(y>=0){var b=a.getCellMeta(0,y);p=b.width}if((p===void 0||p===m.width)&&(p=m.colWidths),p!=null){switch(Cr(p)){case"object":p=p[y];break;case"function":p=p(y);break}typeof p=="string"&&(p=parseInt(p,10))}return p},this.getColWidth=function(y){var p=a._getColWidthFromSettings(y);return p=a.runHooks("modifyColWidth",p,y),p===void 0&&(p=PE.DEFAULT_WIDTH),p},this._getRowHeightFromSettings=function(y){var p=m.rowHeights;if(p!=null){switch(Cr(p)){case"object":p=p[y];break;case"function":p=p(y);break}typeof p=="string"&&(p=parseInt(p,10))}return p},this.getRowHeight=function(y){var p=a._getRowHeightFromSettings(y);return p=a.runHooks("modifyRowHeight",p,y),p},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return s.getLength()},this.countCols=function(){var y=m.maxCols,p=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(y,p)},this.countRenderedRows=function(){return a.view._wt.drawn?a.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return a.view._wt.drawn?a.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return a.view._wt.drawn?a.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return a.view._wt.drawn?a.view._wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=0;return Zg(a.countRows()-1,function(b){if(a.isEmptyRow(b))p+=1;else if(y===!0)return!1}),p},this.countEmptyCols=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=0;return Zg(a.countCols()-1,function(b){if(a.isEmptyCol(b))p+=1;else if(y===!0)return!1}),p},this.isEmptyRow=function(y){return m.isEmptyRow.call(a,y)},this.isEmptyCol=function(y){return m.isEmptyCol.call(a,y)},this.selectCell=function(y,p,b,_){var T=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,I=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return gt(y)||gt(p)?!1:this.selectCells([[y,p,b,_]],T,I)},this.selectCells=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;p===!1&&(i=!0);var _=R.selectCells(y);return _&&b&&a.listen(),i=!1,_},this.selectColumns=function(y){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:y;return R.selectColumns(y,p)},this.selectRows=function(y){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:y;return R.selectRows(y,p)},this.deselectCell=function(){R.deselect()},this.selectAll=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,p=y&&this.hasRowHeaders(),b=y&&this.hasColHeaders();i=!0,R.selectAll(p,b),i=!1};var le=function(p,b){return p.getNearestNotHiddenIndex(b,1,!0)};this.scrollViewportTo=function(y,p){var b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,_=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,T=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,I=!b,F=!_,W=y,G=p;if(T){var Q=Number.isInteger(y),ee=Number.isInteger(p),se=Q?le(this.rowIndexMapper,y):void 0,Re=ee?le(this.columnIndexMapper,p):void 0;if(se===null||Re===null)return!1;W=Q?a.rowIndexMapper.getRenderableFromVisualIndex(se):void 0,G=ee?a.columnIndexMapper.getRenderableFromVisualIndex(Re):void 0}var ce=Number.isInteger(W),de=Number.isInteger(G);return ce&&de?a.view.scrollViewport(a._createCellCoords(W,G),I,_,b,F):ce&&de===!1?a.view.scrollViewportVertically(W,I,b):de&&ce===!1?a.view.scrollViewportHorizontally(G,_,F):!1},this.destroy=function(){if(a._clearTimeouts(),a._clearImmediates(),a.view&&a.view.destroy(),u&&u.destroy(),u=null,this.getShortcutManager().destroy(),g.clearCache(),E_(a)){var y=this.rootDocument.querySelector(".hot-display-license-info");y&&y.parentNode.removeChild(y)}gn(a.rootElement),l.destroy(),c&&c.destroy(),a.batchExecution(function(){a.rowIndexMapper.unregisterAll(),a.columnIndexMapper.unregisterAll(),S.getItems().forEach(function(p){var b=On(p,2),_=b[1];_.destroy()}),S.clear(),a.runHooks("afterDestroy")},!0),pe.getSingleton().destroy(a),We(a,function(p,b,_){bt(p)?_[b]=Se(b):b!=="guid"&&(_[b]=null)}),a.isDestroyed=!0,s&&s.destroy(),s=null,f=null,R=null,c=null,a=null};function Se(y){return function(){throw new Error('The "'.concat(y,'" method cannot be called because this Handsontable instance has been destroyed'))}}this.getActiveEditor=function(){return c.getActiveEditor()},this.getPlugin=function(y){var p=ar(y);return p==="UndoRedo"?this.undoRedo:S.getItem(p)},this.getPluginName=function(y){return y===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:S.getId(y)},this.getInstance=function(){return a},this.addHook=function(y,p){pe.getSingleton().add(y,p,a)},this.hasHook=function(y){return pe.getSingleton().has(y,a)||pe.getSingleton().has(y)},this.addHookOnce=function(y,p){pe.getSingleton().once(y,p,a)},this.removeHook=function(y,p){pe.getSingleton().remove(y,p,a)},this.runHooks=function(y,p,b,_,T,I,F){return pe.getSingleton().run(a,y,p,b,_,T,I,F)},this.getTranslatedPhrase=function(y,p){return OW(m.language,y,p)},this.toHTML=function(){return ZC(n)},this.toTableElement=function(){var y=n.rootDocument.createElement("div");return y.insertAdjacentHTML("afterbegin",ZC(n)),y.firstElementChild},this.timeouts=[],this._registerTimeout=function(y){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,b=y;typeof b=="function"&&(b=setTimeout(b,p)),this.timeouts.push(b)},this._clearTimeouts=function(){$(this.timeouts,function(y){clearTimeout(y)})},this.immediates=[],this._registerImmediate=function(y){this.immediates.push(setImmediate(y))},this._clearImmediates=function(){$(this.immediates,function(y){clearImmediate(y)})},this._refreshBorders=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;c.destroyEditor(y),a.view.render(),p&&R.isSelected()&&c.prepareEditor()},this.isRtl=function(){return a.rootWindow.getComputedStyle(a.rootElement).direction==="rtl"},this.isLtr=function(){return!a.isRtl()},this.getDirectionFactor=function(){return a.isLtr()?1:-1};var me=WCe({handleEvent:function(p){var b=a.isListening(),_=(p==null?void 0:p.key)!==void 0;return b&&_},beforeKeyDown:function(p){return n.runHooks("beforeKeyDown",p)},afterKeyDown:function(p){n.isDestroyed||a.runHooks("afterDocumentKeyDown",p)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",function(y){y.ctrlKey===!1&&y.metaKey===!1&&me.releasePressedKeys()}),this.getShortcutManager=function(){return me};var Ce=me.addContext("grid"),P={runOnlyIf:function(){return ve(a.getSelected())&&a.countRenderedRows()>0&&a.countRenderedCols()>0},group:XCe};me.setActiveContextName("grid"),Ce.addShortcuts([{keys:[["Control/Meta","A"]],callback:function(){a.selectAll()}},{keys:[["Control/Meta","Enter"]],callback:function(){for(var p=a.getSelectedRange(),b=p[p.length-1].highlight,_=b.row,T=b.col,I=a.getDataAtCell(_,T),F=new Map,W=0;W<p.length;W++)p[W].forAll(function(G,Q){if(G>=0&&Q>=0&&(G!==_||Q!==T)){var ee=a.getCellMeta(G,Q),se=ee.readOnly;se||F.set("".concat(G,"x").concat(Q),[G,Q,I])}});a.setDataAtCell(Array.from(F.values()))},runOnlyIf:function(){return a.getSelectedRangeLast().getCellsCount()>1}},{keys:[["ArrowUp"]],callback:function(){R.transformStart(-1,0)}},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:function(){R.setRangeStart(a._createCellCoords(a.rowIndexMapper.getNearestNotHiddenIndex(0,1),a.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowUp","Shift"]],callback:function(){R.transformEnd(-1,0)}},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var p=a.getSelectedRangeLast(),b=p.from,_=p.to,T=a.rowIndexMapper.getNearestNotHiddenIndex(0,1);R.setRangeStart(b.clone()),R.setRangeEnd(a._createCellCoords(T,_.col))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByColumnHeader())}},{keys:[["ArrowDown"]],callback:function(){R.transformStart(1,0)}},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:function(){R.setRangeStart(a._createCellCoords(a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-1,-1),a.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowDown","Shift"]],callback:function(){R.transformEnd(1,0)}},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var p=a.getSelectedRangeLast(),b=p.from,_=p.to,T=a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-1,-1);R.setRangeStart(b.clone()),R.setRangeEnd(a._createCellCoords(T,_.col))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByColumnHeader())}},{keys:[["ArrowLeft"]],callback:function(){R.transformStart(0,-1*a.getDirectionFactor())}},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:function(){var p,b=a.getSelectedRangeLast().highlight.row,_=(p=a.columnIndexMapper).getNearestNotHiddenIndex.apply(p,wl(a.isRtl()?[a.countCols()-1,-1]:[0,1]));R.setRangeStart(a._createCellCoords(b,_))}},{keys:[["ArrowLeft","Shift"]],callback:function(){R.transformEnd(0,-1*a.getDirectionFactor())}},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var p,b=a.getSelectedRangeLast(),_=b.from,T=b.to,I=(p=a.columnIndexMapper).getNearestNotHiddenIndex.apply(p,wl(a.isRtl()?[a.countCols()-1,-1]:[0,1]));R.setRangeStart(_.clone()),R.setRangeEnd(a._createCellCoords(T.row,I))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByRowHeader())}},{keys:[["ArrowRight"]],callback:function(){R.transformStart(0,a.getDirectionFactor())}},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:function(){var p,b=a.getSelectedRangeLast().highlight.row,_=(p=a.columnIndexMapper).getNearestNotHiddenIndex.apply(p,wl(a.isRtl()?[0,1]:[a.countCols()-1,-1]));R.setRangeStart(a._createCellCoords(b,_))}},{keys:[["ArrowRight","Shift"]],callback:function(){R.transformEnd(0,a.getDirectionFactor())}},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var p,b=a.getSelectedRangeLast(),_=b.from,T=b.to,I=(p=a.columnIndexMapper).getNearestNotHiddenIndex.apply(p,wl(a.isRtl()?[0,1]:[a.countCols()-1,-1]));R.setRangeStart(_.clone()),R.setRangeEnd(a._createCellCoords(T.row,I))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByRowHeader())}},{keys:[["Home"]],captureCtrl:!0,callback:function(){var p=parseInt(a.getSettings().fixedColumnsStart,10),b=a.getSelectedRangeLast().highlight.row,_=a.columnIndexMapper.getNearestNotHiddenIndex(p,1);R.setRangeStart(a._createCellCoords(b,_))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["Home","Shift"]],callback:function(){R.setRangeEnd(a._createCellCoords(R.selectedRange.current().from.row,a.columnIndexMapper.getNearestNotHiddenIndex(0,1)))}},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:function(){var p=parseInt(a.getSettings().fixedRowsTop,10),b=parseInt(a.getSettings().fixedColumnsStart,10),_=a.rowIndexMapper.getNearestNotHiddenIndex(p,1),T=a.columnIndexMapper.getNearestNotHiddenIndex(b,1);R.setRangeStart(a._createCellCoords(_,T))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End"]],captureCtrl:!0,callback:function(){R.setRangeStart(a._createCellCoords(a.getSelectedRangeLast().highlight.row,a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1)))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End","Shift"]],callback:function(){R.setRangeEnd(a._createCellCoords(R.selectedRange.current().from.row,a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1)))}},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:function(){var p=parseInt(a.getSettings().fixedRowsBottom,10),b=a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-p-1,-1),_=a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1);R.setRangeStart(a._createCellCoords(b,_))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["PageUp"]],callback:function(){R.transformStart(-a.countVisibleRows(),0)}},{keys:[["PageUp","Shift"]],callback:function(){var p=a.getSelectedRangeLast(),b=p.to,_=Math.max(b.row-a.countVisibleRows(),0),T=a.rowIndexMapper.getNearestNotHiddenIndex(_,1);if(T!==null){var I=a._createCellCoords(T,b.col),F=b.row-a.view.getFirstFullyVisibleRow(),W=Math.max(I.row-F,0);R.setRangeEnd(I),a.scrollViewportTo(W)}}},{keys:[["PageDown"]],callback:function(){R.transformStart(a.countVisibleRows(),0)}},{keys:[["PageDown","Shift"]],callback:function(){var p=a.getSelectedRangeLast(),b=p.to,_=Math.min(b.row+a.countVisibleRows(),a.countRows()-1),T=a.rowIndexMapper.getNearestNotHiddenIndex(_,-1);if(T!==null){var I=a._createCellCoords(T,b.col),F=b.row-a.view.getFirstFullyVisibleRow(),W=Math.min(I.row-F,a.countRows()-1);R.setRangeEnd(I),a.scrollViewportTo(W)}}},{keys:[["Tab"]],callback:function(p){var b=typeof m.tabMoves=="function"?m.tabMoves(p):m.tabMoves;R.transformStart(b.row,b.col,!0)}},{keys:[["Shift","Tab"]],callback:function(p){var b=typeof m.tabMoves=="function"?m.tabMoves(p):m.tabMoves;R.transformStart(-b.row,-b.col)}}],P),TE().forEach(function(y){var p=Sv(y);S.addItem(y,new p(n))}),pe.getSingleton().run(a,"construct")}var ZCe="hooksRefRegisterer",VW={_hooksStorage:Object.create(null),addHook:function(t,r){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,r),this._hooksStorage[t].push(r),this},removeHooksByKey:function(t){var r=this;$(this._hooksStorage[t]||[],function(n){r.hot.removeHook(t,n)})},clearHooks:function(){var t=this;We(this._hooksStorage,function(r,n){return t.removeHooksByKey(n)}),this._hooksStorage={}}};Bn(VW,"MIXIN_NAME",ZCe,{writable:!1,enumerable:!1});const JCe=VW;function Ks(e){"@babel/helpers - typeof";return Ks=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ks(e)}function QCe(e,t){return n_e(e)||r_e(e,t)||t_e(e,t)||e_e()}function e_e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function t_e(e,t){if(e){if(typeof e=="string")return tx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tx(e,t)}}function tx(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function r_e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function n_e(e){if(Array.isArray(e))return e}function o_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&eO(e,t)}function eO(e,t){return eO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},eO(e,t)}function i_e(e){var t=s_e();return function(){var n=Ap(e),o;if(t){var i=Ap(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return a_e(this,o)}}function a_e(e,t){if(t&&(Ks(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return l_e(e)}function l_e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s_e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ap(e){return Ap=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ap(e)}function rx(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,u_e(n.key),n)}}function ox(e,t,r){return t&&nx(e.prototype,t),r&&nx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function u_e(e){var t=f_e(e,"string");return Ks(t)==="symbol"?t:String(t)}function f_e(e,t){if(Ks(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ks(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var c_e="base",Jt=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),tO="baseEditor",Af=function(){function e(t){rx(this,e),this.hot=t,this.instance=t,this.state=Jt.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}return ox(e,[{key:"_fireCallbacks",value:function(r){this._closeCallback&&(this._closeCallback(r),this._closeCallback=null)}},{key:"init",value:function(){}},{key:"getValue",value:function(){throw Error("Editor getValue() method unimplemented")}},{key:"setValue",value:function(){throw Error("Editor setValue() method unimplemented")}},{key:"open",value:function(){throw Error("Editor open() method unimplemented")}},{key:"close",value:function(){throw Error("Editor close() method unimplemented")}},{key:"prepare",value:function(r,n,o,i,a,l){this.TD=i,this.row=r,this.col=n,this.prop=o,this.originalValue=a,this.cellProperties=l,this.state=Jt.VIRGIN}},{key:"extend",value:function(){return function(r){o_e(o,r);var n=i_e(o);function o(){return rx(this,o),n.apply(this,arguments)}return ox(o)}(this.constructor)}},{key:"saveValue",value:function(r,n){var o=this,i,a,l,s;if(n){var u=this.hot.getSelectedLast();i=Math.max(Math.min(u[0],u[2]),0),a=Math.max(Math.min(u[1],u[3]),0),l=Math.max(u[0],u[2]),s=Math.max(u[1],u[3])}else{var f=[this.row,this.col,null,null];i=f[0],a=f[1],l=f[2],s=f[3]}var c=this.hot.runHooks("modifyGetCellCoords",i,a);if(Array.isArray(c)){var h=QCe(c,2);i=h[0],a=h[1]}var d=this.hot.getShortcutManager(),v=d.getContext("editor"),g={runOnlyIf:function(){return ve(o.hot.getSelected())},group:tO};this.isInFullEditMode()&&v.addShortcuts([{keys:[["ArrowUp"]],callback:function(){o.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){o.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){o.hot.selection.transformStart(0,-1*o.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){o.hot.selection.transformStart(0,o.hot.getDirectionFactor())}}],g),this.hot.populateFromArray(i,a,r,l,s,"edit")}},{key:"beginEditing",value:function(r,n){if(this.state===Jt.VIRGIN){var o=this.hot,i=o.rowIndexMapper.getRenderableFromVisualIndex(this.row),a=o.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(o.view.scrollViewport(o._createCellCoords(i,a)),this.state=Jt.EDITING,this.isInFullEditMode()){var l=typeof r=="string"?r:It(this.originalValue);this.setValue(l)}this.open(n),this._opened=!0,this.focus(),o.view.render(),o.runHooks("afterBeginEditing",this.row,this.col)}}},{key:"finishEditing",value:function(r,n,o){var i=this,a;if(o){var l=this._closeCallback;this._closeCallback=function(c){l&&l(c),o(c),i.hot.view.render()}}if(!this.isWaiting()){var s=this.hot.getShortcutManager(),u=s.getContext("editor");if(u.removeShortcutsByGroup(tO),u.removeShortcutsByGroup(Lm),this.state===Jt.VIRGIN){this.hot._registerTimeout(function(){i._fireCallbacks(!0)});return}if(this.state===Jt.EDITING){if(r){this.cancelChanges(),this.hot.view.render();return}var f=this.getValue();this.cellProperties.trimWhitespace?a=[[typeof f=="string"?String.prototype.trim.call(f||""):f]]:a=[[f]],this.state=Jt.WAITING,this.saveValue(a,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",function(c){i.state=Jt.FINISHED,i.discardEditor(c)}):(this.state=Jt.FINISHED,this.discardEditor(!0))}}}},{key:"cancelChanges",value:function(){this.state=Jt.FINISHED,this.discardEditor()}},{key:"discardEditor",value:function(r){if(this.state===Jt.FINISHED)if(r===!1&&this.cellProperties.allowInvalid!==!0)this.hot.selectCell(this.row,this.col),this.focus(),this.state=Jt.EDITING,this._fireCallbacks(!1);else{this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Jt.VIRGIN,this._fireCallbacks(!0);var n=this.hot.getShortcutManager();n.setActiveContextName("grid")}}},{key:"enableFullEditMode",value:function(){this._fullEditMode=!0}},{key:"isInFullEditMode",value:function(){return this._fullEditMode}},{key:"isOpened",value:function(){return this._opened}},{key:"isWaiting",value:function(){return this.state===Jt.WAITING}},{key:"getEditedCellRect",value:function(){var r,n=this.getEditedCell();if(n){var o=this.hot.view._wt,i=o.wtOverlays,a=o.wtViewport,l=this.hot.rootWindow,s=Vt(n),u=dt(n),f=Vt(this.hot.rootElement),c=dt(this.hot.rootElement),h=i.topOverlay.holder,d=i.inlineStartOverlay.holder,v=h!==l?h.scrollTop:0,g=d!==l?d.scrollLeft:0,m=l.innerWidth-f.left-c,w=(r=i.getParentOverlay(n))!==null&&r!==void 0?r:this.hot.view._wt,S=w.wtTable,C=S.name,k=["master","inline_start"].includes(C)?v:0,R=["master","top","bottom"].includes(C)?g:0,V=s.top===f.top?0:1,U=s.top-f.top-V-k,X=0;this.hot.isRtl()?X=l.innerWidth-s.left-u-m-1+R:X=s.left-f.left-1-R,["top","top_inline_start_corner"].includes(C)&&(U+=i.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(C)&&(X+=Math.abs(i.inlineStartOverlay.getOverlayOffset()));var Y=this.hot.hasColHeaders(),q=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),Z=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),ie=this.hot.rowIndexMapper.getRenderableIndexesLength(),J=ie-this.hot.view._wt.getSetting("fixedRowsBottom");(Y&&q<=0||q===J)&&(U+=1),Z<=0&&(X+=1);var le=a.rowsRenderCalculator.startPosition,Se=a.columnsRenderCalculator.startPosition,me=Math.abs(i.inlineStartOverlay.getScrollPosition()),Ce=i.topOverlay.getScrollPosition(),P=Xt(this.hot.rootDocument),y=n.offsetTop+le-Ce,p=0;if(this.hot.isRtl()){var b=n.offsetLeft;b>=0?p=S.getWidth()-n.offsetLeft:p=Math.abs(b),p+=Se-me-u}else p=n.offsetLeft+Se-me;var _=Ti(this.TD,this.hot.rootWindow),T=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",I=parseInt(_[T],10)>0?0:1,F=parseInt(_.borderTopWidth,10)>0?0:1,W=dt(n)+I,G=Rt(n)+F,Q=PV(h)?P:0,ee=$V(d)?P:0,se=this.hot.view.maximumVisibleElementWidth(p)-Q+I,Re=Math.max(this.hot.view.maximumVisibleElementHeight(y)-ee+F,23);return{top:U,start:X,height:G,maxHeight:Re,width:W,maxWidth:se}}}},{key:"getEditedCellsLayerClass",value:function(){var r=this.checkEditorSection();switch(r){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}},{key:"getEditedCell",value:function(){return this.hot.getCell(this.row,this.col,!0)}},{key:"checkEditorSection",value:function(){var r=this.hot.countRows(),n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=r-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}],[{key:"EDITOR_TYPE",get:function(){return c_e}}]),e}();pt(Af,JCe);function h_e(){var e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},t,r=document.body,n=document.createTextNode(""),o=document.createElement("SPAN"),i=function(d,v,g){d.addEventListener(v,g,!1)},a=function(d,v,g){d.removeEventListener(v,g,!1)},l=function(d){var v,g;d?/^[a-zA-Z \.,\\\/\|0-9]$/.test(d)||(d="."):d="",n.textContent!==void 0?n.textContent=t.value+d:n.data=t.value+d,o.style.position="absolute",o.style.fontSize=c(t).fontSize,o.style.fontFamily=c(t).fontFamily,o.style.whiteSpace="pre",r.appendChild(o),v=o.clientWidth+2,r.removeChild(o),t.style.height=e.minHeight+"px",e.minWidth>v?t.style.width=e.minWidth+"px":v>e.maxWidth?t.style.width=e.maxWidth+"px":t.style.width=v+"px",g=t.scrollHeight?t.scrollHeight-1:0,e.minHeight>g?t.style.height=e.minHeight+"px":e.maxHeight<g?(t.style.height=e.maxHeight+"px",t.style.overflowY="visible"):t.style.height=g+"px"},s=function(){window.setTimeout(l,0)},u=function(d){if(d&&d.minHeight)if(d.minHeight=="inherit")e.minHeight=t.clientHeight;else{var v=parseInt(d.minHeight);isNaN(v)||(e.minHeight=v)}if(d&&d.maxHeight)if(d.maxHeight=="inherit")e.maxHeight=t.clientHeight;else{var g=parseInt(d.maxHeight);isNaN(g)||(e.maxHeight=g)}if(d&&d.minWidth)if(d.minWidth=="inherit")e.minWidth=t.clientWidth;else{var m=parseInt(d.minWidth);isNaN(m)||(e.minWidth=m)}if(d&&d.maxWidth)if(d.maxWidth=="inherit")e.maxWidth=t.clientWidth;else{var w=parseInt(d.maxWidth);isNaN(w)||(e.maxWidth=w)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(n))},f=function(d,v,g){t=d,u(v),t.nodeName=="TEXTAREA"&&(t.style.resize="none",t.style.overflowY="",t.style.height=e.minHeight+"px",t.style.minWidth=e.minWidth+"px",t.style.maxWidth=e.maxWidth+"px",t.style.overflowY="hidden"),g&&(i(t,"change",l),i(t,"cut",s),i(t,"paste",s),i(t,"drop",s),i(t,"keydown",s),i(t,"focus",l),i(t,"compositionstart",s),i(t,"compositionupdate",s),i(t,"compositionend",s)),l()};function c(h){return h.currentStyle||document.defaultView.getComputedStyle(h)}return{init:function(d,v,g){f(d,v,g)},unObserve:function(){a(t,"change",l),a(t,"cut",s),a(t,"paste",s),a(t,"drop",s),a(t,"keydown",s),a(t,"focus",l),a(t,"compositionstart",s),a(t,"compositionupdate",s),a(t,"compositionend",s)},resize:l}}function ix(e,t){for(var r=bE(t),n=t.value.split(`
`),o=r,i=0,a=0;a<n.length;a++){var l=n[a];a!==0&&(i+=n[a-1].length+1);var s=i+l.length;if(e==="home"?o=i:e==="end"&&(o=s),r<=s)break}pv(t,o)}function qs(e){"@babel/helpers - typeof";return qs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qs(e)}function ax(e,t){return g_e(e)||y_e(e,t)||v_e(e,t)||d_e()}function d_e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function v_e(e,t){if(e){if(typeof e=="string")return lx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return lx(e,t)}}function lx(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function y_e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function g_e(e){if(Array.isArray(e))return e}function p_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,b_e(n.key),n)}}function m_e(e,t,r){return t&&sx(e.prototype,t),r&&sx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function b_e(e){var t=w_e(e,"string");return qs(t)==="symbol"?t:String(t)}function w_e(e,t){if(qs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $c(){return typeof Reflect<"u"&&Reflect.get?$c=Reflect.get.bind():$c=function(t,r,n){var o=S_e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},$c.apply(this,arguments)}function S_e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Wa(e),e!==null););return e}function C_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rO(e,t)}function rO(e,t){return rO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},rO(e,t)}function __e(e){var t=R_e();return function(){var n=Wa(e),o;if(t){var i=Wa(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return O_e(this,o)}}function O_e(e,t){if(t&&(qs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return WW(e)}function WW(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function R_e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Wa(e){return Wa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Wa(e)}var E_e="ht_editor_visible",yy="ht_editor_hidden",ux="textEditor",T_e="text",al=function(e){C_e(r,e);var t=__e(r);function r(n){var o;return p_e(this,r),o=t.call(this,n),o.eventManager=new Tt(WW(o)),o.autoResize=h_e(),o.TEXTAREA=void 0,o.textareaStyle=void 0,o.TEXTAREA_PARENT=void 0,o.textareaParentStyle=void 0,o.layerClass=void 0,o.createElements(),o.bindEvents(),o.hot.addHookOnce("afterDestroy",function(){return o.destroy()}),o}return m_e(r,[{key:"getValue",value:function(){return this.TEXTAREA.value}},{key:"setValue",value:function(o){this.TEXTAREA.value=o}},{key:"open",value:function(){var o=this;this.refreshDimensions(),this.showEditableElement();var i=this.hot.getShortcutManager();i.setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",function(a){return o.onAfterDocumentKeyDown(a)}),this.registerShortcuts()}},{key:"close",value:function(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}},{key:"prepare",value:function(o,i,a,l,s,u){var f=this.state;if($c(Wa(r.prototype),"prepare",this).call(this,o,i,a,l,s,u),!u.readOnly){this.refreshDimensions(!0);var c=u.allowInvalid,h=u.fragmentSelection;c&&(this.TEXTAREA.value=""),f!==Jt.FINISHED&&this.hideEditableElement();var d=!h;d&&!cn()&&this.focus()}}},{key:"beginEditing",value:function(o,i){this.state===Jt.VIRGIN&&(this.TEXTAREA.value="",$c(Wa(r.prototype),"beginEditing",this).call(this,o,i))}},{key:"focus",value:function(){this.TEXTAREA.select(),pv(this.TEXTAREA,this.TEXTAREA.value.length)}},{key:"createElements",value:function(){var o=this.hot.rootDocument;this.TEXTAREA=o.createElement("TEXTAREA"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.tabIndex=-1,re(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=o.createElement("DIV"),re(this.TEXTAREA_PARENT,"handsontableInputHolder"),xe(this.TEXTAREA_PARENT,this.layerClass)&&Le(this.TEXTAREA_PARENT,this.layerClass),re(this.TEXTAREA_PARENT,yy),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}},{key:"hideEditableElement",value:function(){(RB()||OB())&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Le(this.TEXTAREA_PARENT,this.layerClass),re(this.TEXTAREA_PARENT,yy)}},{key:"showEditableElement",value:function(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";var o=this.TEXTAREA_PARENT.childNodes,i=!1;_e(o.length-1,function(a){var l=o[a];if(xe(l,"handsontableEditor"))return i=!0,!1}),xe(this.TEXTAREA_PARENT,yy)&&Le(this.TEXTAREA_PARENT,yy),i?(this.layerClass=E_e,re(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),re(this.TEXTAREA_PARENT,this.layerClass))}},{key:"refreshValue",value:function(){var o=this.hot.toPhysicalRow(this.row),i=this.hot.getSourceDataAtCell(o,this.col);this.originalValue=i,this.setValue(i),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(this.state!==Jt.EDITING&&!o)){if(this.TD=this.getEditedCell(),!this.TD){o||this.close();return}var i=this.getEditedCellRect(),a=i.top,l=i.start,s=i.width,u=i.maxWidth,f=i.height,c=i.maxHeight;this.textareaParentStyle.top="".concat(a,"px"),this.textareaParentStyle[this.hot.isRtl()?"right":"left"]="".concat(l,"px"),this.showEditableElement();var h=Ti(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=h.fontSize,this.TEXTAREA.style.fontFamily=h.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;var d=Ti(this.TEXTAREA),v=parseInt(d.paddingLeft,10)+parseInt(d.paddingRight,10),g=parseInt(d.paddingTop,10)+parseInt(d.paddingBottom,10),m=s-v,w=f-g,S=u-v,C=c-g;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(m,S),minHeight:Math.min(w,C),maxWidth:S,maxHeight:C},!0)}}},{key:"bindEvents",value:function(){var o=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(i){return i.stopPropagation()}),this.eventManager.addEventListener(this.TEXTAREA,"paste",function(i){return i.stopPropagation()}),Y0()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",function(){return o.finishEditing(!1)}),this.addHook("afterScrollHorizontally",function(){return o.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return o.refreshDimensions()}),this.addHook("afterColumnResize",function(){o.refreshDimensions(),o.focus()}),this.addHook("afterRowResize",function(){o.refreshDimensions(),o.focus()})}},{key:"allowKeyEventPropagation",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.clearHooks()}},{key:"registerShortcuts",value:function(){var o=this,i=this.hot.getShortcutManager(),a=i.getContext("editor"),l={runOnlyIf:function(){return ve(o.hot.getSelected())},group:ux},s=function(){o.hot.rootDocument.execCommand("insertText",!1,`
`)};a.addShortcuts([{keys:[["Tab"]],callback:function(f){var c=o.hot.getSettings(),h=typeof c.tabMoves=="function"?c.tabMoves(f):c.tabMoves;o.hot.selection.transformStart(h.row,h.col,!0)}},{keys:[["Shift","Tab"]],callback:function(f){var c=o.hot.getSettings(),h=typeof c.tabMoves=="function"?c.tabMoves(f):c.tabMoves;o.hot.selection.transformStart(-h.row,-h.col)}},{keys:[["Control","Enter"]],callback:function(){return s(),!1},runOnlyIf:function(f){return!o.hot.selection.isMultiple()&&!f.altKey},relativeToGroup:Ec,position:"before"},{keys:[["Meta","Enter"]],callback:function(){return s(),!1},runOnlyIf:function(){return!o.hot.selection.isMultiple()},relativeToGroup:Ec,position:"before"},{keys:[["Alt","Enter"]],callback:function(){return s(),!1},relativeToGroup:Ec,position:"before"},{keys:[["PageUp"]],callback:function(){o.hot.selection.transformStart(-o.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:function(){o.hot.selection.transformStart(o.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:function(f,c){var h=ax(c,1),d=h[0];ix(d,o.TEXTAREA)}},{keys:[["End"]],callback:function(f,c){var h=ax(c,1),d=h[0];ix(d,o.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:function(){o.hot._registerTimeout(function(){o.autoResize.resize()},10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:function(){o.hot._registerTimeout(function(){o.autoResize.resize()},10)}}],l)}},{key:"unregisterShortcuts",value:function(){var o=this.hot.getShortcutManager(),i=o.getContext("editor");i.removeShortcutsByGroup(Lm),i.removeShortcutsByGroup(ux),i.removeShortcutsByGroup(tO)}},{key:"onAfterDocumentKeyDown",value:function(o){var i=[be.ARROW_UP,be.ARROW_RIGHT,be.ARROW_DOWN,be.ARROW_LEFT];i.indexOf(o.keyCode)===-1&&this.autoResize.resize(String.fromCharCode(o.keyCode))}}],[{key:"EDITOR_TYPE",get:function(){return T_e}}]),r}(Af),k_e="base";function Pv(e,t,r,n,o,i,a){var l=[],s=[];a.className&&re(t,a.className),a.readOnly&&l.push(a.readOnlyCellClassName),a.valid===!1&&a.invalidCellClassName?l.push(a.invalidCellClassName):s.push(a.invalidCellClassName),a.wordWrap===!1&&a.noWordWrapClassName&&l.push(a.noWordWrapClassName),!i&&a.placeholder&&l.push(a.placeholderCellClassName),Le(t,s),re(t,l)}Pv.RENDERER_TYPE=k_e;var P_e="text";function xi(e,t,r,n,o,i,a){Pv.apply(this,[e,t,r,n,o,i,a]);var l=i;if(!l&&a.placeholder&&(l=a.placeholder),l=It(l),a.trimWhitespace&&(l=l.trim()),a.rendererTemplate){gn(t);var s=e.rootDocument.createElement("TEMPLATE");s.setAttribute("bind","{{}}"),s.innerHTML=a.rendererTemplate,HTMLTemplateElement.decorate(s),s.model=e.getSourceDataAtRow(r),t.appendChild(s)}else Ei(t,l)}xi.RENDERER_TYPE=P_e;var $_e="text",UW={CELL_TYPE:$_e,editor:al,renderer:xi};an(UW);Te.editors={BaseEditor:Af};function Te(e,t){var r=new bk(e,t||{},BE);return r.init(),r}Te.Core=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new bk(e,t,BE)};Te.DefaultSettings=DW();Te.hooks=pe.getSingleton();Te.CellCoords=Qg;Te.CellRange=$E;Te.packageName="handsontable";Te.buildDate="23/05/2023 09:21:52";Te.version="12.4.0";Te.languages={dictionaryKeys:Xme,getLanguageDictionary:_W,getLanguagesDictionaries:obe,registerLanguageDictionary:CW,getTranslatedPhrase:OW};function Xs(e){"@babel/helpers - typeof";return Xs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xs(e)}function A_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,M_e(n.key),n)}}function I_e(e,t,r){return t&&fx(e.prototype,t),r&&fx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function M_e(e){var t=x_e(e,"string");return Xs(t)==="symbol"?t:String(t)}function x_e(e,t){if(Xs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ln(){return typeof Reflect<"u"&&Reflect.get?ln=Reflect.get.bind():ln=function(t,r,n){var o=D_e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ln.apply(this,arguments)}function D_e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Nr(e),e!==null););return e}function N_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nO(e,t)}function nO(e,t){return nO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},nO(e,t)}function H_e(e){var t=F_e();return function(){var n=Nr(e),o;if(t){var i=Nr(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return L_e(this,o)}}function L_e(e,t){if(t&&(Xs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return j_e(e)}function j_e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function F_e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Nr(e){return Nr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Nr(e)}var cx="handsontableEditor",B_e="handsontable",wk=function(e){N_e(r,e);var t=H_e(r);function r(){return A_e(this,r),t.apply(this,arguments)}return I_e(r,[{key:"open",value:function(){ln(Nr(r.prototype),"open",this).call(this),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),pv(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}},{key:"close",value:function(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),ln(Nr(r.prototype),"close",this).call(this)}},{key:"prepare",value:function(o,i,a,l,s,u){ln(Nr(r.prototype),"prepare",this).call(this,o,i,a,l,s,u);var f=this,c={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,afterOnCellMouseDown:function(d,v){var g=this.getSourceData(v.row,v.col);g!==void 0&&f.setValue(g),f.instance.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&Wt(c,u.handsontable),this.htOptions=c}},{key:"beginEditing",value:function(o,i){var a=this.hot.getSettings().onBeginEditing;a&&a()===!1||ln(Nr(r.prototype),"beginEditing",this).call(this,o,i)}},{key:"createElements",value:function(){ln(Nr(r.prototype),"createElements",this).call(this);var o=this.hot.rootDocument.createElement("DIV");o.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(o),this.htContainer=o,this.assignHooks()}},{key:"finishEditing",value:function(o,i,a){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){var l=this.htEditor.getInstance().getValue();l!==void 0&&this.setValue(l)}ln(Nr(r.prototype),"finishEditing",this).call(this,o,i,a)}},{key:"assignHooks",value:function(){var o=this;this.hot.addHook("afterDestroy",function(){o.htEditor&&o.htEditor.destroy()})}},{key:"registerShortcuts",value:function(){var o=this,i=this.hot.getShortcutManager(),a=i.getContext("editor");ln(Nr(r.prototype),"registerShortcuts",this).call(this);var l={group:cx,relativeToGroup:Lm,position:"before"},s=function(f,c){var h=o.htEditor.getInstance();if(f!==void 0&&(f<0||h.flipped&&f>h.countRows()-1?h.deselectCell():h.selectCell(f,0),h.getData().length))return c.preventDefault(),pn(c),o.hot.listen(),o.TEXTAREA.focus(),!1};a.addShortcuts([{keys:[["ArrowUp"]],callback:function(f){var c=o.htEditor.getInstance(),h,d;return!c.getSelectedLast()&&c.flipped?h=c.countRows()-1:c.getSelectedLast()&&(c.flipped?(d=c.getSelectedLast()[0],h=Math.max(0,d-1)):(d=c.getSelectedLast()[0],h=d-1)),s(h,f)},preventDefault:!1},{keys:[["ArrowDown"]],callback:function(f){var c=o.htEditor.getInstance(),h,d;if(!c.getSelectedLast()&&!c.flipped)h=0;else if(c.getSelectedLast()){if(c.flipped)h=c.getSelectedLast()[0]+1;else if(!c.flipped){var v=c.countRows()-1;d=c.getSelectedLast()[0],h=Math.min(v,d+1)}}return s(h,f)},preventDefault:!1}],l)}},{key:"unregisterShortcuts",value:function(){ln(Nr(r.prototype),"unregisterShortcuts",this).call(this);var o=this.hot.getShortcutManager(),i=o.getContext("editor");i.removeShortcutsByGroup(cx)}}],[{key:"EDITOR_TYPE",get:function(){return B_e}}]),r}(al);function Zs(e){"@babel/helpers - typeof";return Zs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zs(e)}function V_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zW(n.key),n)}}function W_e(e,t,r){return t&&hx(e.prototype,t),r&&hx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function oa(){return typeof Reflect<"u"&&Reflect.get?oa=Reflect.get.bind():oa=function(t,r,n){var o=U_e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},oa.apply(this,arguments)}function U_e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=so(e),e!==null););return e}function z_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oO(e,t)}function oO(e,t){return oO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},oO(e,t)}function Y_e(e){var t=K_e();return function(){var n=so(e),o;if(t){var i=so(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return G_e(this,o)}}function G_e(e,t){if(t&&(Zs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return iO(e)}function iO(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function K_e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function so(e){return so=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},so(e)}function q_e(e,t,r){return t=zW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zW(e){var t=X_e(e,"string");return Zs(t)==="symbol"?t:String(t)}function X_e(e,t){if(Zs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Bw=new WeakMap,Z_e="autocomplete",Sk=function(e){z_e(r,e);var t=Y_e(r);function r(n){var o;return V_e(this,r),o=t.call(this,n),q_e(iO(o),"sortByRelevance",function(i,a,l){var s=[],u=[],f=i.length,c=a.length,h,d,v,g;if(f===0){for(v=0;v<c;v++)u.push(v);return u}for(v=0;v<c;v++){if(d=jC(It(a[v])),l)g=d.indexOf(i);else{var m=this.cellProperties.locale;g=d.toLocaleLowerCase(m).indexOf(i.toLocaleLowerCase(m))}g!==-1&&(h=d.length-g-f,s.push({baseIndex:v,index:g,charsLeft:h,value:d}))}for(s.sort(function(w,S){if(S.index===-1)return-1;if(w.index===-1)return 1;if(w.index<S.index)return-1;if(S.index<w.index)return 1;if(w.index===S.index){if(w.charsLeft<S.charsLeft)return-1;if(w.charsLeft>S.charsLeft)return 1}return 0}),v=0,c=s.length;v<c;v++)u.push(s[v].baseIndex);return u}),o.query=null,o.strippedChoices=[],o.rawChoices=[],Bw.set(iO(o),{skipOne:!1,isMacOS:o.hot.rootWindow.navigator.platform.indexOf("Mac")>-1}),o}return W_e(r,[{key:"getValue",value:function(){var o=this,i=this.rawChoices.find(function(a){var l=o.stripValueIfNeeded(a);return l===o.TEXTAREA.value});return ve(i)?i:this.TEXTAREA.value}},{key:"createElements",value:function(){oa(so(r.prototype),"createElements",this).call(this),re(this.htContainer,"autocompleteEditor"),re(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll")}},{key:"open",value:function(){var o=this,i=Bw.get(this);oa(so(r.prototype),"open",this).call(this);var a=this.htEditor.getInstance(),l=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown;this.showEditableElement(),this.focus();var s=Xt();s===0&&i.isMacOS&&(s+=15),this.addHook("beforeKeyDown",function(u){return o.onBeforeKeyDown(u)}),a.updateSettings({colWidths:l?[dt(this.TEXTAREA)-2]:void 0,width:l?dt(this.TEXTAREA)+s:void 0,renderer:function(f,c,h,d,v,g,m){xi(f,c,h,d,v,g,m);var w=o.cellProperties,S=w.filteringCaseSensitive,C=w.allowHtml,k=w.locale,R=o.query,V=It(g),U,X;V&&!C&&(U=S===!0?V.indexOf(R):V.toLocaleLowerCase(k).indexOf(R.toLocaleLowerCase(k)),U!==-1&&(X=V.substr(U,R.length),V=V.replace(X,"<strong>".concat(X,"</strong>")))),c.innerHTML=V},autoColumnSize:!0}),i.skipOne&&(i.skipOne=!1),this.hot._registerTimeout(function(){o.queryChoices(o.TEXTAREA.value)})}},{key:"close",value:function(){this.removeHooksByKey("beforeKeyDown"),oa(so(r.prototype),"close",this).call(this)}},{key:"discardEditor",value:function(o){oa(so(r.prototype),"discardEditor",this).call(this,o),this.hot.view.render()}},{key:"queryChoices",value:function(o){var i=this,a=this.cellProperties.source;this.query=o,typeof a=="function"?a.call(this.cellProperties,o,function(l){i.rawChoices=l,i.updateChoicesList(i.stripValuesIfNeeded(l))}):Array.isArray(a)?(this.rawChoices=a,this.updateChoicesList(this.stripValuesIfNeeded(a))):this.updateChoicesList([])}},{key:"updateChoicesList",value:function(o){var i=bE(this.TEXTAREA),a=TV(this.TEXTAREA),l=this.cellProperties.sortByRelevance,s=this.cellProperties.filter,u=null,f=null,c=o;l&&(u=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),c,this.cellProperties.filteringCaseSensitive));var h=Array.isArray(u)?u.length:0;if(s===!1)h&&(f=u[0]);else{for(var d=[],v=0,g=c.length;v<g&&!(l&&h<=v);v++)h?d.push(c[u[v]]):d.push(c[v]);f=0,c=d}this.strippedChoices=c,this.htEditor.loadData(wc([c])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(f),this.hot.listen(),pv(this.TEXTAREA,i,i===a?void 0:a)}},{key:"flipDropdownIfNeeded",value:function(){var o=Ha(this.hot.view._wt.wtTable.TABLE),i=o===this.hot.rootWindow,a=this.cellProperties.preventOverflow;if(i||!i&&(a||a==="horizontal"))return!1;var l=Vt(this.TEXTAREA),s=Rt(this.TEXTAREA),u=this.getDropdownHeight(),f=o.scrollTop,c=Rt(this.hot.view._wt.wtTable.THEAD),h=Vt(o),d=l.top-h.top-c+f,v=o.scrollHeight-d-c-s,g=u>v&&d>v;return g?this.flipDropdown(u):this.unflipDropdown(),this.limitDropdownIfNeeded(g?d:v,u),g}},{key:"limitDropdownIfNeeded",value:function(o,i){if(i>o){var a=0,l=0,s=0,u=null;do s=this.htEditor.getRowHeight(l)||this.htEditor.view._wt.getSetting("defaultRowHeight"),a+=s,l+=1;while(a<o);u=a-s,this.htEditor.flipped&&(this.htEditor.rootElement.style.top="".concat(parseInt(this.htEditor.rootElement.style.top,10)+i-u,"px")),this.setDropdownHeight(a-s)}}},{key:"flipDropdown",value:function(o){var i=this.htEditor.rootElement.style;i.position="absolute",i.top="".concat(-o,"px"),this.htEditor.flipped=!0}},{key:"unflipDropdown",value:function(){var o=this.htEditor.rootElement.style;o.position="absolute",o.top="",this.htEditor.flipped=void 0}},{key:"updateDropdownHeight",value:function(){var o=this.htEditor.getColWidth(0)+Xt(this.hot.rootDocument)+2,i=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:i?void 0:o}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}},{key:"setDropdownHeight",value:function(o){this.htEditor.updateSettings({height:o})}},{key:"highlightBestMatchingChoice",value:function(o){typeof o=="number"?this.htEditor.selectCell(o,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}},{key:"getDropdownHeight",value:function(){var o=this.htEditor.getInstance().getRowHeight(0)||23,i=this.cellProperties.visibleRows;return this.strippedChoices.length>=i?i*o:this.strippedChoices.length*o+8}},{key:"stripValueIfNeeded",value:function(o){return this.stripValuesIfNeeded([o])[0]}},{key:"stripValuesIfNeeded",value:function(o){var i=this.cellProperties.allowHtml,a=Be(o,function(s){return It(s)}),l=Be(a,function(s){return i?s:jC(s)});return l}},{key:"allowKeyEventPropagation",value:function(o){var i=this.htEditor.getSelectedRangeLast(),a={row:i?i.from.row:-1},l=!1;return o===be.ARROW_DOWN&&a.row>0&&a.row<this.htEditor.countRows()-1&&(l=!0),o===be.ARROW_UP&&a.row>-1&&(l=!0),l}},{key:"onBeforeKeyDown",value:function(o){var i=this,a=Bw.get(this);if(a.skipOne=!1,UV(o.keyCode)||o.keyCode===be.BACKSPACE||o.keyCode===be.DELETE||o.keyCode===be.INSERT){var l=10;if(o.keyCode===be.C&&(o.ctrlKey||o.metaKey))return;this.isOpened()||(l+=10),this.htEditor&&this.hot._registerTimeout(function(){i.queryChoices(i.TEXTAREA.value),a.skipOne=!0},l)}}}],[{key:"EDITOR_TYPE",get:function(){return Z_e}}]),r}(wk);function Js(e){"@babel/helpers - typeof";return Js=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Js(e)}function J_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eOe(n.key),n)}}function Q_e(e,t,r){return t&&dx(e.prototype,t),r&&dx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function eOe(e){var t=tOe(e,"string");return Js(t)==="symbol"?t:String(t)}function tOe(e,t){if(Js(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Js(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aO(e,t)}function aO(e,t){return aO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},aO(e,t)}function nOe(e){var t=aOe();return function(){var n=Ip(e),o;if(t){var i=Ip(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return oOe(this,o)}}function oOe(e,t){if(t&&(Js(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return iOe(e)}function iOe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function aOe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ip(e){return Ip=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ip(e)}var lOe="checkbox",YW=function(e){rOe(r,e);var t=nOe(r);function r(){return J_e(this,r),t.apply(this,arguments)}return Q_e(r,[{key:"beginEditing",value:function(o,i){if(i&&i.type==="mouseup"){var a=this.TD.querySelector('input[type="checkbox"]');xe(a,"htBadValue")||a.click()}}},{key:"finishEditing",value:function(){}},{key:"init",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"focus",value:function(){}}],[{key:"EDITOR_TYPE",get:function(){return lOe}}]),r}(Af),GW={exports:{}};const sOe=mY(Zie);/*!
 * Pikaday
 *
 * Copyright Â© 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */(function(e,t){(function(r,n){var o;{try{o=sOe}catch{}e.exports=n(o)}})(cc,function(r){var n=typeof r=="function",o=!!window.addEventListener,i=window.document,a=window.setTimeout,l=function(P,y,p,b){o?P.addEventListener(y,p,!!b):P.attachEvent("on"+y,p)},s=function(P,y,p,b){o?P.removeEventListener(y,p,!!b):P.detachEvent("on"+y,p)},u=function(P){return P.trim?P.trim():P.replace(/^\s+|\s+$/g,"")},f=function(P,y){return(" "+P.className+" ").indexOf(" "+y+" ")!==-1},c=function(P,y){f(P,y)||(P.className=P.className===""?y:P.className+" "+y)},h=function(P,y){P.className=u((" "+P.className+" ").replace(" "+y+" "," "))},d=function(P){return/Array/.test(Object.prototype.toString.call(P))},v=function(P){return/Date/.test(Object.prototype.toString.call(P))&&!isNaN(P.getTime())},g=function(P){var y=P.getDay();return y===0||y===6},m=function(P){return P%4===0&&P%100!==0||P%400===0},w=function(P,y){return[31,m(P)?29:28,31,30,31,30,31,31,30,31,30,31][y]},S=function(P){v(P)&&P.setHours(0,0,0,0)},C=function(P,y){return P.getTime()===y.getTime()},k=function(P,y,p){var b,_;for(b in y)_=P[b]!==void 0,_&&typeof y[b]=="object"&&y[b]!==null&&y[b].nodeName===void 0?v(y[b])?p&&(P[b]=new Date(y[b].getTime())):d(y[b])?p&&(P[b]=y[b].slice(0)):P[b]=k({},y[b],p):(p||!_)&&(P[b]=y[b]);return P},R=function(P,y,p){var b;i.createEvent?(b=i.createEvent("HTMLEvents"),b.initEvent(y,!0,!1),b=k(b,p),P.dispatchEvent(b)):i.createEventObject&&(b=i.createEventObject(),b=k(b,p),P.fireEvent("on"+y,b))},V=function(P){return P.month<0&&(P.year-=Math.ceil(Math.abs(P.month)/12),P.month+=12),P.month>11&&(P.year+=Math.floor(Math.abs(P.month)/12),P.month-=12),P},U={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},X=function(P,y,p){for(y+=P.firstDay;y>=7;)y-=7;return p?P.i18n.weekdaysShort[y]:P.i18n.weekdays[y]},Y=function(P){var y=[],p="false";if(P.isEmpty)if(P.showDaysInNextAndPreviousMonths)y.push("is-outside-current-month"),P.enableSelectionDaysInNextAndPreviousMonths||y.push("is-selection-disabled");else return'<td class="is-empty"></td>';return P.isDisabled&&y.push("is-disabled"),P.isToday&&y.push("is-today"),P.isSelected&&(y.push("is-selected"),p="true"),P.hasEvent&&y.push("has-event"),P.isInRange&&y.push("is-inrange"),P.isStartRange&&y.push("is-startrange"),P.isEndRange&&y.push("is-endrange"),'<td data-day="'+P.day+'" class="'+y.join(" ")+'" aria-selected="'+p+'"><button class="pika-button pika-day" type="button" data-pika-year="'+P.year+'" data-pika-month="'+P.month+'" data-pika-day="'+P.day+'">'+P.day+"</button></td>"},q=function(P,y){P.setHours(0,0,0,0);var p=P.getDate(),b=P.getDay(),_=y,T=_-1,I=7,F=function(se){return(se+I-1)%I};P.setDate(p+T-F(b));var W=new Date(P.getFullYear(),0,_),G=24*60*60*1e3,Q=(P.getTime()-W.getTime())/G,ee=1+Math.round((Q-T+F(W.getDay()))/I);return ee},Z=function(P,y,p,b){var _=new Date(p,y,P),T=n?r(_).isoWeek():q(_,b);return'<td class="pika-week">'+T+"</td>"},ie=function(P,y,p,b){return'<tr class="pika-row'+(p?" pick-whole-week":"")+(b?" is-selected":"")+'">'+(y?P.reverse():P).join("")+"</tr>"},J=function(P){return"<tbody>"+P.join("")+"</tbody>"},le=function(P){var y,p=[];for(P.showWeekNumber&&p.push("<th></th>"),y=0;y<7;y++)p.push('<th scope="col"><abbr title="'+X(P,y)+'">'+X(P,y,!0)+"</abbr></th>");return"<thead><tr>"+(P.isRTL?p.reverse():p).join("")+"</tr></thead>"},Se=function(P,y,p,b,_,T){var I,F,W,G=P._o,Q=p===G.minYear,ee=p===G.maxYear,se='<div id="'+T+'" class="pika-title" role="heading" aria-live="assertive">',Re,ce,de=!0,K=!0;for(W=[],I=0;I<12;I++)W.push('<option value="'+(p===_?I-y:12+I-y)+'"'+(I===b?' selected="selected"':"")+(Q&&I<G.minMonth||ee&&I>G.maxMonth?' disabled="disabled"':"")+">"+G.i18n.months[I]+"</option>");for(Re='<div class="pika-label">'+G.i18n.months[b]+'<select class="pika-select pika-select-month" tabindex="-1">'+W.join("")+"</select></div>",d(G.yearRange)?(I=G.yearRange[0],F=G.yearRange[1]+1):(I=p-G.yearRange,F=1+p+G.yearRange),W=[];I<F&&I<=G.maxYear;I++)I>=G.minYear&&W.push('<option value="'+I+'"'+(I===p?' selected="selected"':"")+">"+I+"</option>");return ce='<div class="pika-label">'+p+G.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+W.join("")+"</select></div>",G.showMonthAfterYear?se+=ce+Re:se+=Re+ce,Q&&(b===0||G.minMonth>=b)&&(de=!1),ee&&(b===11||G.maxMonth<=b)&&(K=!1),y===0&&(se+='<button class="pika-prev'+(de?"":" is-disabled")+'" type="button">'+G.i18n.previousMonth+"</button>"),y===P._o.numberOfMonths-1&&(se+='<button class="pika-next'+(K?"":" is-disabled")+'" type="button">'+G.i18n.nextMonth+"</button>"),se+="</div>"},me=function(P,y,p){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+p+'">'+le(P)+J(y)+"</table>"},Ce=function(P){var y=this,p=y.config(P);y._onMouseDown=function(_){if(y._v){_=_||window.event;var T=_.target||_.srcElement;if(T)if(f(T,"is-disabled")||(f(T,"pika-button")&&!f(T,"is-empty")&&!f(T.parentNode,"is-disabled")?(y.setDate(new Date(T.getAttribute("data-pika-year"),T.getAttribute("data-pika-month"),T.getAttribute("data-pika-day"))),p.bound&&a(function(){y.hide(),p.blurFieldOnSelect&&p.field&&p.field.blur()},100)):f(T,"pika-prev")?y.prevMonth():f(T,"pika-next")&&y.nextMonth()),f(T,"pika-select"))y._c=!0;else if(_.preventDefault)_.preventDefault();else return _.returnValue=!1,!1}},y._onChange=function(_){_=_||window.event;var T=_.target||_.srcElement;T&&(f(T,"pika-select-month")?y.gotoMonth(T.value):f(T,"pika-select-year")&&y.gotoYear(T.value))},y._onKeyChange=function(_){if(_=_||window.event,y.isVisible())switch(_.keyCode){case 13:case 27:p.field&&p.field.blur();break;case 37:y.adjustDate("subtract",1);break;case 38:y.adjustDate("subtract",7);break;case 39:y.adjustDate("add",1);break;case 40:y.adjustDate("add",7);break;case 8:case 46:y.setDate(null);break}},y._parseFieldValue=function(){if(p.parse)return p.parse(p.field.value,p.format);if(n){var _=r(p.field.value,p.format,p.formatStrict);return _&&_.isValid()?_.toDate():null}else return new Date(Date.parse(p.field.value))},y._onInputChange=function(_){var T;_.firedBy!==y&&(T=y._parseFieldValue(),v(T)&&y.setDate(T),y._v||y.show())},y._onInputFocus=function(){y.show()},y._onInputClick=function(){y.show()},y._onInputBlur=function(){var _=i.activeElement;do if(f(_,"pika-single"))return;while(_=_.parentNode);y._c||(y._b=a(function(){y.hide()},50)),y._c=!1},y._onClick=function(_){_=_||window.event;var T=_.target||_.srcElement,I=T;if(T){!o&&f(T,"pika-select")&&(T.onchange||(T.setAttribute("onchange","return;"),l(T,"change",y._onChange)));do if(f(I,"pika-single")||I===p.trigger)return;while(I=I.parentNode);y._v&&T!==p.trigger&&I!==p.trigger&&y.hide()}},y.el=i.createElement("div"),y.el.className="pika-single"+(p.isRTL?" is-rtl":"")+(p.theme?" "+p.theme:""),l(y.el,"mousedown",y._onMouseDown,!0),l(y.el,"touchend",y._onMouseDown,!0),l(y.el,"change",y._onChange),p.keyboardInput&&l(i,"keydown",y._onKeyChange),p.field&&(p.container?p.container.appendChild(y.el):p.bound?i.body.appendChild(y.el):p.field.parentNode.insertBefore(y.el,p.field.nextSibling),l(p.field,"change",y._onInputChange),p.defaultDate||(p.defaultDate=y._parseFieldValue(),p.setDefaultDate=!0));var b=p.defaultDate;v(b)?p.setDefaultDate?y.setDate(b,!0):y.gotoDate(b):y.gotoDate(new Date),p.bound?(this.hide(),y.el.className+=" is-bound",l(p.trigger,"click",y._onInputClick),l(p.trigger,"focus",y._onInputFocus),l(p.trigger,"blur",y._onInputBlur)):this.show()};return Ce.prototype={config:function(P){this._o||(this._o=k({},U,!0));var y=k(this._o,P,!0);y.isRTL=!!y.isRTL,y.field=y.field&&y.field.nodeName?y.field:null,y.theme=typeof y.theme=="string"&&y.theme?y.theme:null,y.bound=!!(y.bound!==void 0?y.field&&y.bound:y.field),y.trigger=y.trigger&&y.trigger.nodeName?y.trigger:y.field,y.disableWeekends=!!y.disableWeekends,y.disableDayFn=typeof y.disableDayFn=="function"?y.disableDayFn:null;var p=parseInt(y.numberOfMonths,10)||1;if(y.numberOfMonths=p>4?4:p,v(y.minDate)||(y.minDate=!1),v(y.maxDate)||(y.maxDate=!1),y.minDate&&y.maxDate&&y.maxDate<y.minDate&&(y.maxDate=y.minDate=!1),y.minDate&&this.setMinDate(y.minDate),y.maxDate&&this.setMaxDate(y.maxDate),d(y.yearRange)){var b=new Date().getFullYear()-10;y.yearRange[0]=parseInt(y.yearRange[0],10)||b,y.yearRange[1]=parseInt(y.yearRange[1],10)||b}else y.yearRange=Math.abs(parseInt(y.yearRange,10))||U.yearRange,y.yearRange>100&&(y.yearRange=100);return y},toString:function(P){return P=P||this._o.format,v(this._d)?this._o.toString?this._o.toString(this._d,P):n?r(this._d).format(P):this._d.toDateString():""},getMoment:function(){return n?r(this._d):null},setMoment:function(P,y){n&&r.isMoment(P)&&this.setDate(P.toDate(),y)},getDate:function(){return v(this._d)?new Date(this._d.getTime()):null},setDate:function(P,y){if(!P)return this._d=null,this._o.field&&(this._o.field.value="",R(this._o.field,"change",{firedBy:this})),this.draw();if(typeof P=="string"&&(P=new Date(Date.parse(P))),!!v(P)){var p=this._o.minDate,b=this._o.maxDate;v(p)&&P<p?P=p:v(b)&&P>b&&(P=b),this._d=new Date(P.getTime()),S(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),R(this._o.field,"change",{firedBy:this})),!y&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())}},clear:function(){this.setDate(null)},gotoDate:function(P){var y=!0;if(v(P)){if(this.calendars){var p=new Date(this.calendars[0].year,this.calendars[0].month,1),b=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),_=P.getTime();b.setMonth(b.getMonth()+1),b.setDate(b.getDate()-1),y=_<p.getTime()||b.getTime()<_}y&&(this.calendars=[{month:P.getMonth(),year:P.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(P,y){var p=this.getDate()||new Date,b=parseInt(y)*24*60*60*1e3,_;P==="add"?_=new Date(p.valueOf()+b):P==="subtract"&&(_=new Date(p.valueOf()-b)),this.setDate(_)},adjustCalendars:function(){this.calendars[0]=V(this.calendars[0]);for(var P=1;P<this._o.numberOfMonths;P++)this.calendars[P]=V({month:this.calendars[0].month+P,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(P){isNaN(P)||(this.calendars[0].month=parseInt(P,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(P){isNaN(P)||(this.calendars[0].year=parseInt(P,10),this.adjustCalendars())},setMinDate:function(P){P instanceof Date?(S(P),this._o.minDate=P,this._o.minYear=P.getFullYear(),this._o.minMonth=P.getMonth()):(this._o.minDate=U.minDate,this._o.minYear=U.minYear,this._o.minMonth=U.minMonth,this._o.startRange=U.startRange),this.draw()},setMaxDate:function(P){P instanceof Date?(S(P),this._o.maxDate=P,this._o.maxYear=P.getFullYear(),this._o.maxMonth=P.getMonth()):(this._o.maxDate=U.maxDate,this._o.maxYear=U.maxYear,this._o.maxMonth=U.maxMonth,this._o.endRange=U.endRange),this.draw()},setStartRange:function(P){this._o.startRange=P},setEndRange:function(P){this._o.endRange=P},draw:function(P){if(!(!this._v&&!P)){var y=this._o,p=y.minYear,b=y.maxYear,_=y.minMonth,T=y.maxMonth,I="",F;this._y<=p&&(this._y=p,!isNaN(_)&&this._m<_&&(this._m=_)),this._y>=b&&(this._y=b,!isNaN(T)&&this._m>T&&(this._m=T));for(var W=0;W<y.numberOfMonths;W++)F="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),I+='<div class="pika-lendar">'+Se(this,W,this.calendars[W].year,this.calendars[W].month,this.calendars[0].year,F)+this.render(this.calendars[W].year,this.calendars[W].month,F)+"</div>";this.el.innerHTML=I,y.bound&&y.field.type!=="hidden"&&a(function(){y.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),y.bound&&y.field.setAttribute("aria-label",y.ariaLabel)}},adjustPosition:function(){var P,y,p,b,_,T,I,F,W,G,Q,ee;if(!this._o.container){if(this.el.style.position="absolute",P=this._o.trigger,y=P,p=this.el.offsetWidth,b=this.el.offsetHeight,_=window.innerWidth||i.documentElement.clientWidth,T=window.innerHeight||i.documentElement.clientHeight,I=window.pageYOffset||i.body.scrollTop||i.documentElement.scrollTop,Q=!0,ee=!0,typeof P.getBoundingClientRect=="function")G=P.getBoundingClientRect(),F=G.left+window.pageXOffset,W=G.bottom+window.pageYOffset;else for(F=y.offsetLeft,W=y.offsetTop+y.offsetHeight;y=y.offsetParent;)F+=y.offsetLeft,W+=y.offsetTop;(this._o.reposition&&F+p>_||this._o.position.indexOf("right")>-1&&F-p+P.offsetWidth>0)&&(F=F-p+P.offsetWidth,Q=!1),(this._o.reposition&&W+b>T+I||this._o.position.indexOf("top")>-1&&W-b-P.offsetHeight>0)&&(W=W-b-P.offsetHeight,ee=!1),this.el.style.left=F+"px",this.el.style.top=W+"px",c(this.el,Q?"left-aligned":"right-aligned"),c(this.el,ee?"bottom-aligned":"top-aligned"),h(this.el,Q?"right-aligned":"left-aligned"),h(this.el,ee?"top-aligned":"bottom-aligned")}},render:function(P,y,p){var b=this._o,_=new Date,T=w(P,y),I=new Date(P,y,1).getDay(),F=[],W=[];S(_),b.firstDay>0&&(I-=b.firstDay,I<0&&(I+=7));for(var G=y===0?11:y-1,Q=y===11?0:y+1,ee=y===0?P-1:P,se=y===11?P+1:P,Re=w(ee,G),ce=T+I,de=ce;de>7;)de-=7;ce+=7-de;for(var K=!1,Me=0,Ge=0;Me<ce;Me++){var Pe=new Date(P,y,1+(Me-I)),Ie=v(this._d)?C(Pe,this._d):!1,$e=C(Pe,_),O=b.events.indexOf(Pe.toDateString())!==-1,E=Me<I||Me>=T+I,A=1+(Me-I),H=y,M=P,j=b.startRange&&C(b.startRange,Pe),x=b.endRange&&C(b.endRange,Pe),D=b.startRange&&b.endRange&&b.startRange<Pe&&Pe<b.endRange,B=b.minDate&&Pe<b.minDate||b.maxDate&&Pe>b.maxDate||b.disableWeekends&&g(Pe)||b.disableDayFn&&b.disableDayFn(Pe);E&&(Me<I?(A=Re+A,H=G,M=ee):(A=A-T,H=Q,M=se));var L={day:A,month:H,year:M,hasEvent:O,isSelected:Ie,isToday:$e,isDisabled:B,isEmpty:E,isStartRange:j,isEndRange:x,isInRange:D,showDaysInNextAndPreviousMonths:b.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:b.enableSelectionDaysInNextAndPreviousMonths};b.pickWholeWeek&&Ie&&(K=!0),W.push(Y(L)),++Ge===7&&(b.showWeekNumber&&W.unshift(Z(Me-I,y,P,b.firstWeekOfYearMinDays)),F.push(ie(W,b.isRTL,b.pickWholeWeek,K)),W=[],Ge=0,K=!1)}return me(b,F,p)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),h(this.el,"is-hidden"),this._o.bound&&(l(i,"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){var P=this._v;P!==!1&&(this._o.bound&&s(i,"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),c(this.el,"is-hidden"),this._v=!1,P!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){var P=this._o;this.hide(),s(this.el,"mousedown",this._onMouseDown,!0),s(this.el,"touchend",this._onMouseDown,!0),s(this.el,"change",this._onChange),P.keyboardInput&&s(i,"keydown",this._onKeyChange),P.field&&(s(P.field,"change",this._onInputChange),P.bound&&(s(P.trigger,"click",this._onInputClick),s(P.trigger,"focus",this._onInputFocus),s(P.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},Ce})})(GW);var uOe=GW.exports;const vx=qL(uOe);function Qs(e){"@babel/helpers - typeof";return Qs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qs(e)}function fOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hOe(n.key),n)}}function cOe(e,t,r){return t&&yx(e.prototype,t),r&&yx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hOe(e){var t=dOe(e,"string");return Qs(t)==="symbol"?t:String(t)}function dOe(e,t){if(Qs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function oo(){return typeof Reflect<"u"&&Reflect.get?oo=Reflect.get.bind():oo=function(t,r,n){var o=vOe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},oo.apply(this,arguments)}function vOe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=fn(e),e!==null););return e}function yOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lO(e,t)}function lO(e,t){return lO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},lO(e,t)}function gOe(e){var t=bOe();return function(){var n=fn(e),o;if(t){var i=fn(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return pOe(this,o)}}function pOe(e,t){if(t&&(Qs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mOe(e)}function mOe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bOe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fn(e){return fn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},fn(e)}var KW="date",gx="dateEditor",qW=function(e){yOe(r,e);var t=gOe(r);function r(n){var o;return fOe(this,r),o=t.call(this,n),o.defaultDateFormat="DD/MM/YYYY",o.isCellEdited=!1,o.parentDestroyed=!1,o.$datePicker=null,o}return cOe(r,[{key:"init",value:function(){var o=this;if(typeof te!="function")throw new Error("You need to include moment.js to your project.");if(typeof vx!="function")throw new Error("You need to include Pikaday to your project.");oo(fn(r.prototype),"init",this).call(this),this.instance.addHook("afterDestroy",function(){o.parentDestroyed=!0,o.destroyElements()})}},{key:"createElements",value:function(){oo(fn(r.prototype),"createElements",this).call(this),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),re(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker);var o=new Tt(this);o.addEventListener(this.datePicker,"mousedown",function(i){return i.stopPropagation()})}},{key:"destroyElements",value:function(){var o=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),o&&o.removeChild(this.datePicker)}},{key:"prepare",value:function(o,i,a,l,s,u){oo(fn(r.prototype),"prepare",this).call(this,o,i,a,l,s,u)}},{key:"open",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,i=this.hot.getShortcutManager(),a=i.getContext("editor");oo(fn(r.prototype),"open",this).call(this),this.showDatepicker(o),a.addShortcut({keys:[["Enter"]],callback:function(s){s.stopPropagation()},group:gx})}},{key:"close",value:function(){var o,i=this;this._opened=!1,(o=this.$datePicker)!==null&&o!==void 0&&o.destroy&&this.$datePicker.destroy(),this.instance._registerTimeout(function(){i.instance._refreshBorders()});var a=this.hot.getShortcutManager(),l=a.getContext("editor");l.removeShortcutsByGroup(gx),oo(fn(r.prototype),"close",this).call(this)}},{key:"finishEditing",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(o){var a=this.originalValue;a!==void 0&&this.setValue(a)}oo(fn(r.prototype),"finishEditing",this).call(this,o,i)}},{key:"showDatepicker",value:function(o){var i=this.TD.getBoundingClientRect(),a=this.cellProperties.dateFormat||this.defaultDateFormat,l=this.instance.view.isMouseDown(),s=o?OE(o.keyCode):!1,u;this.datePicker.style.display="block",this.$datePicker=new vx(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top="".concat(this.hot.rootWindow.pageYOffset+i.top+Rt(this.TD),"px");var f=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?f=i.right-dt(this.datePicker):f=i.left,this.datePickerStyle.left="".concat(f,"px"),this.originalValue?(u=this.originalValue,te(u,a,!0).isValid()&&this.$datePicker.setMoment(te(u,a),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!s&&!l&&this.setValue("")):this.cellProperties.defaultDate?(u=this.cellProperties.defaultDate,te(u,a,!0).isValid()&&this.$datePicker.setMoment(te(u,a),!0),!s&&!l&&this.setValue("")):this.$datePicker.gotoToday()}},{key:"hideDatepicker",value:function(){this.datePickerStyle.display="none",this.$datePicker.hide()}},{key:"getDatePickerConfig",value:function(){var o=this,i=this.TEXTAREA,a={};this.cellProperties&&this.cellProperties.datePickerConfig&&hv(a,this.cellProperties.datePickerConfig);var l=a.onSelect,s=a.onClose;return a.field=i,a.trigger=i,a.container=this.datePicker,a.bound=!1,a.format=a.format||this.defaultDateFormat,a.reposition=a.reposition||!1,a.isRTL=!1,a.onSelect=function(u){var f=u;isNaN(f.getTime())||(f=te(f).format(o.cellProperties.dateFormat||o.defaultDateFormat)),o.setValue(f),o.hideDatepicker(),l&&l()},a.onClose=function(){o.parentDestroyed||o.finishEditing(!1),s&&s()},a}}],[{key:"EDITOR_TYPE",get:function(){return KW}}]),r}(al);function eu(e){"@babel/helpers - typeof";return eu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eu(e)}function wOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function px(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,COe(n.key),n)}}function SOe(e,t,r){return t&&px(e.prototype,t),r&&px(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function COe(e){var t=_Oe(e,"string");return eu(t)==="symbol"?t:String(t)}function _Oe(e,t){if(eu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(eu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gg(){return typeof Reflect<"u"&&Reflect.get?gg=Reflect.get.bind():gg=function(t,r,n){var o=OOe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},gg.apply(this,arguments)}function OOe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=tu(e),e!==null););return e}function ROe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sO(e,t)}function sO(e,t){return sO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},sO(e,t)}function EOe(e){var t=POe();return function(){var n=tu(e),o;if(t){var i=tu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return TOe(this,o)}}function TOe(e,t){if(t&&(eu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kOe(e)}function kOe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function POe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function tu(e){return tu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},tu(e)}var $Oe="dropdown",Ck=function(e){ROe(r,e);var t=EOe(r);function r(){return wOe(this,r),t.apply(this,arguments)}return SOe(r,[{key:"prepare",value:function(o,i,a,l,s,u){gg(tu(r.prototype),"prepare",this).call(this,o,i,a,l,s,u),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}],[{key:"EDITOR_TYPE",get:function(){return $Oe}}]),r}(Sk);pe.getSingleton().add("beforeValidate",function(e,t,r){var n=this.getCellMeta(t,this.propToCol(r));n.editor===Ck&&n.strict===void 0&&(n.filter=!1,n.strict=!0)});function ru(e){"@babel/helpers - typeof";return ru=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ru(e)}function AOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,MOe(n.key),n)}}function IOe(e,t,r){return t&&mx(e.prototype,t),r&&mx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function MOe(e){var t=xOe(e,"string");return ru(t)==="symbol"?t:String(t)}function xOe(e,t){if(ru(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ru(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function DOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&uO(e,t)}function uO(e,t){return uO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},uO(e,t)}function NOe(e){var t=jOe();return function(){var n=Mp(e),o;if(t){var i=Mp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return HOe(this,o)}}function HOe(e,t){if(t&&(ru(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return LOe(e)}function LOe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jOe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Mp(e){return Mp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Mp(e)}var FOe="numeric",XW=function(e){DOe(r,e);var t=NOe(r);function r(){return AOe(this,r),t.apply(this,arguments)}return IOe(r,null,[{key:"EDITOR_TYPE",get:function(){return FOe}}]),r}(al);function nu(e){"@babel/helpers - typeof";return nu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nu(e)}function BOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,WOe(n.key),n)}}function VOe(e,t,r){return t&&bx(e.prototype,t),r&&bx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function WOe(e){var t=UOe(e,"string");return nu(t)==="symbol"?t:String(t)}function UOe(e,t){if(nu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pg(){return typeof Reflect<"u"&&Reflect.get?pg=Reflect.get.bind():pg=function(t,r,n){var o=zOe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},pg.apply(this,arguments)}function zOe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ou(e),e!==null););return e}function YOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fO(e,t)}function fO(e,t){return fO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},fO(e,t)}function GOe(e){var t=XOe();return function(){var n=ou(e),o;if(t){var i=ou(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return KOe(this,o)}}function KOe(e,t){if(t&&(nu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qOe(e)}function qOe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function XOe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ou(e){return ou=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ou(e)}var ZOe="password",ZW=function(e){YOe(r,e);var t=GOe(r);function r(){return BOe(this,r),t.apply(this,arguments)}return VOe(r,[{key:"createElements",value:function(){pg(ou(r.prototype),"createElements",this).call(this),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,gn(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}],[{key:"EDITOR_TYPE",get:function(){return ZOe}}]),r}(al);function Ua(e){"@babel/helpers - typeof";return Ua=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ua(e)}function JOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eRe(n.key),n)}}function QOe(e,t,r){return t&&wx(e.prototype,t),r&&wx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function eRe(e){var t=tRe(e,"string");return Ua(t)==="symbol"?t:String(t)}function tRe(e,t){if(Ua(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ua(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function mg(){return typeof Reflect<"u"&&Reflect.get?mg=Reflect.get.bind():mg=function(t,r,n){var o=rRe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},mg.apply(this,arguments)}function rRe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=iu(e),e!==null););return e}function nRe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&cO(e,t)}function cO(e,t){return cO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},cO(e,t)}function oRe(e){var t=lRe();return function(){var n=iu(e),o;if(t){var i=iu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return iRe(this,o)}}function iRe(e,t){if(t&&(Ua(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return aRe(e)}function aRe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lRe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function iu(e){return iu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},iu(e)}var Vw="ht_editor_visible",Sx="selectEditor",sRe="select",uRe=function(e){nRe(r,e);var t=oRe(r);function r(){return JOe(this,r),t.apply(this,arguments)}return QOe(r,[{key:"init",value:function(){this.select=this.hot.rootDocument.createElement("SELECT"),re(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}},{key:"getValue",value:function(){return this.select.value}},{key:"setValue",value:function(o){this.select.value=o}},{key:"open",value:function(){this._opened=!0,this.refreshDimensions(),this.select.style.display="";var o=this.hot.getShortcutManager();o.setActiveContextName("editor"),this.registerShortcuts()}},{key:"close",value:function(){this._opened=!1,this.select.style.display="none",xe(this.select,Vw)&&Le(this.select,Vw),this.unregisterShortcuts(),this.clearHooks()}},{key:"focus",value:function(){this.select.focus()}},{key:"registerHooks",value:function(){var o=this;this.addHook("afterScrollHorizontally",function(){return o.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return o.refreshDimensions()}),this.addHook("afterColumnResize",function(){return o.refreshDimensions()}),this.addHook("afterRowResize",function(){return o.refreshDimensions()})}},{key:"prepare",value:function(o,i,a,l,s,u){var f=this;mg(iu(r.prototype),"prepare",this).call(this,o,i,a,l,s,u);var c=this.cellProperties.selectOptions,h;typeof c=="function"?h=this.prepareOptions(c(this.row,this.col,this.prop)):h=this.prepareOptions(c),gn(this.select),We(h,function(d,v){var g=f.hot.rootDocument.createElement("OPTION");g.value=v,ol(g,d),f.select.appendChild(g)})}},{key:"prepareOptions",value:function(o){var i={};if(Array.isArray(o))for(var a=0,l=o.length;a<l;a++)i[o[a]]=o[a];else Ua(o)==="object"&&(i=o);return i}},{key:"refreshValue",value:function(){var o=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=o,this.setValue(o),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){if(this.state===Jt.EDITING){if(this.TD=this.getEditedCell(),!this.TD){this.close();return}var o=this.getEditedCellRect(),i=o.top,a=o.start,l=o.width,s=o.height,u=this.select.style;u.height="".concat(s,"px"),u.width="".concat(l,"px"),u.top="".concat(i,"px"),u[this.hot.isRtl()?"right":"left"]="".concat(a,"px"),u.margin="0px",re(this.select,Vw)}}},{key:"registerShortcuts",value:function(){var o=this,i=this.hot.getShortcutManager(),a=i.getContext("editor"),l={group:Sx};this.isInFullEditMode()!==!1&&a.addShortcuts([{keys:[["ArrowUp"]],callback:function(){var u=o.select.selectedIndex-1;u>=0&&(o.select[u].selected=!0)}},{keys:[["ArrowDown"]],callback:function(){var u=o.select.selectedIndex+1;u<=o.select.length-1&&(o.select[u].selected=!0)}}],l)}},{key:"unregisterShortcuts",value:function(){var o=this.hot.getShortcutManager(),i=o.getContext("editor");i.removeShortcutsByGroup(Sx)}}],[{key:"EDITOR_TYPE",get:function(){return sRe}}]),r}(Af);function au(e){"@babel/helpers - typeof";return au=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},au(e)}function fRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Cx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hRe(n.key),n)}}function cRe(e,t,r){return t&&Cx(e.prototype,t),r&&Cx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hRe(e){var t=dRe(e,"string");return au(t)==="symbol"?t:String(t)}function dRe(e,t){if(au(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(au(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bg(){return typeof Reflect<"u"&&Reflect.get?bg=Reflect.get.bind():bg=function(t,r,n){var o=vRe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},bg.apply(this,arguments)}function vRe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=lu(e),e!==null););return e}function yRe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hO(e,t)}function hO(e,t){return hO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},hO(e,t)}function gRe(e){var t=bRe();return function(){var n=lu(e),o;if(t){var i=lu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return pRe(this,o)}}function pRe(e,t){if(t&&(au(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mRe(e)}function mRe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bRe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function lu(e){return lu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},lu(e)}var wRe="time",JW=function(e){yRe(r,e);var t=gRe(r);function r(){return fRe(this,r),t.apply(this,arguments)}return cRe(r,[{key:"prepare",value:function(o,i,a,l,s,u){bg(lu(r.prototype),"prepare",this).call(this,o,i,a,l,s,u),this.TEXTAREA.dir="ltr"}}],[{key:"EDITOR_TYPE",get:function(){return wRe}}]),r}(al);function SRe(){Or(Af),Or(Sk),Or(YW),Or(qW),Or(Ck),Or(wk),Or(XW),Or(ZW),Or(uRe),Or(al),Or(JW)}var CRe="html";function _k(e,t,r,n,o,i,a){Pv.apply(this,[e,t,r,n,o,i,a]),ol(t,i??"",!1)}_k.RENDERER_TYPE=CRe;var _Re="autocomplete";function If(e,t,r,n,o,i,a){var l=e.rootDocument,s=a.allowHtml?_k:xi,u=l.createElement("DIV");if(u.className="htAutocompleteArrow",u.appendChild(l.createTextNode(String.fromCharCode(9660))),s.apply(this,[e,t,r,n,o,i,a]),t.firstChild||t.appendChild(l.createTextNode(String.fromCharCode(160))),t.insertBefore(u,t.firstChild),re(t,"htAutocomplete"),!e.acArrowListener){var f=new Tt(e);e.acArrowListener=function(c){xe(c.target,"htAutocompleteArrow")&&e.view._wt.getSetting("onCellDblClick",null,e._createCellCoords(r,n),t)},f.addEventListener(e.rootElement,"mousedown",e.acArrowListener),e.addHookOnce("afterDestroy",function(){f.destroy()})}}If.RENDERER_TYPE=_Re;var _x=new WeakMap,Ox=new WeakMap,ORe="htBadValue",su="data-row",uu="data-col",RRe="checkboxRenderer",QW="checkbox";pe.getSingleton().add("modifyAutoColumnSizeSeed",function(e,t,r){var n=t.label,o=t.type,i=t.row,a=t.column,l=t.prop;if(o===QW){if(n){var s=n.value,u=n.property,f=r;if(s)f=typeof s=="function"?s(i,a,l,r):s;else if(u){var c=this.getDataAtRowProp(i,u);f=c!==null?c:r}e=f}return e}});function Ok(e,t,r,n,o,i,a){var l=e.rootDocument;Pv.apply(this,[e,t,r,n,o,i,a]),ERe(e);var s=TRe(l),u=a.label,f=!1;if(typeof a.checkedTemplate>"u"&&(a.checkedTemplate=!0),typeof a.uncheckedTemplate>"u"&&(a.uncheckedTemplate=!1),gn(t),i===a.checkedTemplate||It(i).toLocaleLowerCase(a.locale)===It(a.checkedTemplate).toLocaleLowerCase(a.locale)?s.checked=!0:i===a.uncheckedTemplate||It(i).toLocaleLowerCase(a.locale)===It(a.uncheckedTemplate).toLocaleLowerCase(a.locale)?s.checked=!1:Kt(i)?re(s,"noValue"):(s.style.display="none",re(s,ORe),f=!0),s.setAttribute(su,r),s.setAttribute(uu,n),!f&&u){var c="";if(u.value)c=typeof u.value=="function"?u.value.call(this,r,n,o,i):u.value;else if(u.property){var h=e.getDataAtRowProp(r,u.property);c=h!==null?h:""}var d=kRe(l,c,u.separated!==!0);u.position==="before"?u.separated?(t.appendChild(d),t.appendChild(s)):(d.appendChild(s),s=d):(!u.position||u.position==="after")&&(u.separated?(t.appendChild(s),t.appendChild(d)):(d.insertBefore(s,d.firstChild),s=d))}(!u||u&&!u.separated)&&t.appendChild(s),f&&t.appendChild(l.createTextNode("#bad-value#")),_x.has(e)||(_x.set(e,!0),v());function v(){var w=e.getShortcutManager(),S=w.getContext("grid"),C={group:RRe};S.addShortcuts([{keys:[["space"]],callback:function(){return g(),!m()}},{keys:[["enter"]],callback:function(){return g(),!m()},runOnlyIf:function(){return e.getSettings().enterBeginsEditing}},{keys:[["delete"],["backspace"]],callback:function(){return g(!0),!m()},relativeToGroup:Ec,position:"before"}],C)}function g(){var w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,S=e.getSelectedRange();if(S)for(var C=0;C<S.length;C++){for(var k=S[C].getTopStartCorner(),R=k.row,V=k.col,U=S[C].getBottomEndCorner(),X=U.row,Y=U.col,q=[],Z=R;Z<=X;Z+=1)for(var ie=V;ie<=Y;ie+=1){var J=e.getCellMeta(Z,ie);if(J.type!=="checkbox")return;if(J.readOnly!==!0){typeof J.checkedTemplate>"u"&&(J.checkedTemplate=!0),typeof J.uncheckedTemplate>"u"&&(J.uncheckedTemplate=!1);var le=e.getDataAtCell(Z,ie);w===!1?[J.checkedTemplate,J.checkedTemplate.toString()].includes(le)?q.push([Z,ie,J.uncheckedTemplate]):[J.uncheckedTemplate,J.uncheckedTemplate.toString(),null,void 0].includes(le)&&q.push([Z,ie,J.checkedTemplate]):q.push([Z,ie,J.uncheckedTemplate])}}q.length>0&&e.setDataAtCell(q)}}function m(){var w=e.getSelectedRange();if(w){for(var S=0;S<w.length;S++)for(var C=w[S].getTopStartCorner(),k=w[S].getBottomEndCorner(),R=C.row;R<=k.row;R++)for(var V=C.col;V<=k.col;V++){var U=e.getCellMeta(R,V);if(U.type!=="checkbox")return!1;var X=e.getCell(R,V);if(X==null)return!0;var Y=X.querySelectorAll("input[type=checkbox]");if(Y.length>0&&!U.readOnly)return!0}return!1}}}Ok.RENDERER_TYPE=QW;function ERe(e){var t=Ox.get(e);if(!t){var r=e.rootElement;t=new Tt(e),t.addEventListener(r,"click",function(n){return $Re(n,e)}),t.addEventListener(r,"mouseup",function(n){return PRe(n,e)}),t.addEventListener(r,"change",function(n){return ARe(n,e)}),Ox.set(e,t)}return t}function TRe(e){var t=e.createElement("input");return t.className="htCheckboxRendererInput",t.type="checkbox",t.setAttribute("autocomplete","off"),t.setAttribute("tabindex","-1"),t.cloneNode(!1)}function kRe(e,t,r){var n=e.createElement("label");return n.className="htCheckboxRendererLabel ".concat(r?"fullWidth":""),n.appendChild(e.createTextNode(t)),n.cloneNode(!0)}function PRe(e,t){var r=e.target;Rk(r)&&(!r.hasAttribute(su)||!r.hasAttribute(uu)||setTimeout(t.listen,10))}function $Re(e,t){var r=e.target;if(Rk(r)&&!(!r.hasAttribute(su)||!r.hasAttribute(uu))){var n=parseInt(r.getAttribute(su),10),o=parseInt(r.getAttribute(uu),10),i=t.getCellMeta(n,o);i.readOnly&&e.preventDefault()}}function ARe(e,t){var r=e.target;if(Rk(r)&&!(!r.hasAttribute(su)||!r.hasAttribute(uu))){var n=parseInt(r.getAttribute(su),10),o=parseInt(r.getAttribute(uu),10),i=t.getCellMeta(n,o);if(!i.readOnly){var a=null;e.target.checked?a=i.uncheckedTemplate===void 0?!0:i.checkedTemplate:a=i.uncheckedTemplate===void 0?!1:i.uncheckedTemplate,t.setDataAtCell(n,o,a)}}}function Rk(e){return e.tagName==="INPUT"&&e.getAttribute("type")==="checkbox"}var eU={exports:{}};(function(e,t){(function(r){e.exports=r()})(function(){return function r(n,o,i){function a(u,f){if(!o[u]){if(!n[u]){var c=typeof Hv=="function"&&Hv;if(!f&&c)return c(u,!0);if(l)return l(u,!0);var h=new Error("Cannot find module '"+u+"'");throw h.code="MODULE_NOT_FOUND",h}var d=o[u]={exports:{}};n[u][0].call(d.exports,function(v){return a(n[u][1][v]||v)},d,d.exports,r,n,o,i)}return o[u].exports}for(var l=typeof Hv=="function"&&Hv,s=0;s<i.length;s++)a(i[s]);return a}({1:[function(r,n,o){(function(i){var a,l=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,s=Math.ceil,u=Math.floor,f="[BigNumber Error] ",c=f+"Number primitive has more than 15 significant digits: ",h=1e14,d=14,v=9007199254740991,g=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],m=1e7,w=1e9;function S(Y){var q=0|Y;return 0<Y||Y===q?q:q-1}function C(Y){for(var q,Z,ie=1,J=Y.length,le=Y[0]+"";ie<J;){for(q=Y[ie++]+"",Z=d-q.length;Z--;q="0"+q);le+=q}for(J=le.length;le.charCodeAt(--J)===48;);return le.slice(0,J+1||1)}function k(Y,q){var Z,ie,J=Y.c,le=q.c,Se=Y.s,me=q.s,Ce=Y.e,P=q.e;if(!Se||!me)return null;if(Z=J&&!J[0],ie=le&&!le[0],Z||ie)return Z?ie?0:-me:Se;if(Se!=me)return Se;if(Z=Se<0,ie=Ce==P,!J||!le)return ie?0:!J^Z?1:-1;if(!ie)return P<Ce^Z?1:-1;for(me=(Ce=J.length)<(P=le.length)?Ce:P,Se=0;Se<me;Se++)if(J[Se]!=le[Se])return J[Se]>le[Se]^Z?1:-1;return Ce==P?0:P<Ce^Z?1:-1}function R(Y,q,Z,ie){if(Y<q||Z<Y||Y!==(Y<0?s(Y):u(Y)))throw Error(f+(ie||"Argument")+(typeof Y=="number"?Y<q||Z<Y?" out of range: ":" not an integer: ":" not a primitive number: ")+String(Y))}function V(Y){var q=Y.c.length-1;return S(Y.e/d)==q&&Y.c[q]%2!=0}function U(Y,q){return(1<Y.length?Y.charAt(0)+"."+Y.slice(1):Y)+(q<0?"e":"e+")+q}function X(Y,q,Z){var ie,J;if(q<0){for(J=Z+".";++q;J+=Z);Y=J+Y}else if(++q>(ie=Y.length)){for(J=Z,q-=ie;--q;J+=Z);Y+=J}else q<ie&&(Y=Y.slice(0,q)+"."+Y.slice(q));return Y}(a=function Y(q){var Z,ie,J,le,Se,me,Ce,P,y,p,b=K.prototype={constructor:K,toString:null,valueOf:null},_=new K(1),T=20,I=4,F=-7,W=21,G=-1e7,Q=1e7,ee=!1,se=1,Re=0,ce={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},de="0123456789abcdefghijklmnopqrstuvwxyz";function K(O,E){var A,H,M,j,x,D,B,L,z=this;if(!(z instanceof K))return new K(O,E);if(E==null){if(O instanceof K)return z.s=O.s,z.e=O.e,void(z.c=(O=O.c)?O.slice():O);if((D=typeof O=="number")&&0*O==0){if(z.s=1/O<0?(O=-O,-1):1,O===~~O){for(j=0,x=O;10<=x;x/=10,j++);return z.e=j,void(z.c=[O])}L=String(O)}else{if(L=String(O),!l.test(L))return J(z,L,D);z.s=L.charCodeAt(0)==45?(L=L.slice(1),-1):1}-1<(j=L.indexOf("."))&&(L=L.replace(".","")),0<(x=L.search(/e/i))?(j<0&&(j=x),j+=+L.slice(x+1),L=L.substring(0,x)):j<0&&(j=L.length)}else{if(R(E,2,de.length,"Base"),L=String(O),E==10)return Ie(z=new K(O instanceof K?O:L),T+z.e+1,I);if(D=typeof O=="number"){if(0*O!=0)return J(z,L,D,E);if(z.s=1/O<0?(L=L.slice(1),-1):1,K.DEBUG&&15<L.replace(/^0\.0*|\./,"").length)throw Error(c+O);D=!1}else z.s=L.charCodeAt(0)===45?(L=L.slice(1),-1):1;for(A=de.slice(0,E),j=x=0,B=L.length;x<B;x++)if(A.indexOf(H=L.charAt(x))<0){if(H=="."){if(j<x){j=B;continue}}else if(!M&&(L==L.toUpperCase()&&(L=L.toLowerCase())||L==L.toLowerCase()&&(L=L.toUpperCase()))){M=!0,x=-1,j=0;continue}return J(z,String(O),D,E)}-1<(j=(L=ie(L,E,10,z.s)).indexOf("."))?L=L.replace(".",""):j=L.length}for(x=0;L.charCodeAt(x)===48;x++);for(B=L.length;L.charCodeAt(--B)===48;);if(L=L.slice(x,++B)){if(B-=x,D&&K.DEBUG&&15<B&&(v<O||O!==u(O)))throw Error(c+z.s*O);if(Q<(j=j-x-1))z.c=z.e=null;else if(j<G)z.c=[z.e=0];else{if(z.e=j,z.c=[],x=(j+1)%d,j<0&&(x+=d),x<B){for(x&&z.c.push(+L.slice(0,x)),B-=d;x<B;)z.c.push(+L.slice(x,x+=d));L=L.slice(x),x=d-L.length}else x-=B;for(;x--;L+="0");z.c.push(+L)}}else z.c=[z.e=0]}function Me(O,E,A,H){var M,j,x,D,B;if(A==null?A=I:R(A,0,8),!O.c)return O.toString();if(M=O.c[0],x=O.e,E==null)B=C(O.c),B=H==1||H==2&&(x<=F||W<=x)?U(B,x):X(B,x,"0");else if(j=(O=Ie(new K(O),E,A)).e,D=(B=C(O.c)).length,H==1||H==2&&(E<=j||j<=F)){for(;D<E;B+="0",D++);B=U(B,j)}else if(E-=x,B=X(B,j,"0"),D<j+1){if(0<--E)for(B+=".";E--;B+="0");}else if(0<(E+=j-D))for(j+1==D&&(B+=".");E--;B+="0");return O.s<0&&M?"-"+B:B}function Ge(O,E){for(var A,H=1,M=new K(O[0]);H<O.length;H++){if(!(A=new K(O[H])).s){M=A;break}E.call(M,A)&&(M=A)}return M}function Pe(O,E,A){for(var H=1,M=E.length;!E[--M];E.pop());for(M=E[0];10<=M;M/=10,H++);return(A=H+A*d-1)>Q?O.c=O.e=null:O.c=A<G?[O.e=0]:(O.e=A,E),O}function Ie(O,E,A,H){var M,j,x,D,B,L,z,ae=O.c,ge=g;if(ae){e:{for(M=1,D=ae[0];10<=D;D/=10,M++);if((j=E-M)<0)j+=d,x=E,z=(B=ae[L=0])/ge[M-x-1]%10|0;else if((L=s((j+1)/d))>=ae.length){if(!H)break e;for(;ae.length<=L;ae.push(0));B=z=0,x=(j%=d)-d+(M=1)}else{for(B=D=ae[L],M=1;10<=D;D/=10,M++);z=(x=(j%=d)-d+M)<0?0:B/ge[M-x-1]%10|0}if(H=H||E<0||ae[L+1]!=null||(x<0?B:B%ge[M-x-1]),H=A<4?(z||H)&&(A==0||A==(O.s<0?3:2)):5<z||z==5&&(A==4||H||A==6&&(0<j?0<x?B/ge[M-x]:0:ae[L-1])%10&1||A==(O.s<0?8:7)),E<1||!ae[0])return ae.length=0,H?(E-=O.e+1,ae[0]=ge[(d-E%d)%d],O.e=-E||0):ae[0]=O.e=0,O;if(j==0?(ae.length=L,D=1,L--):(ae.length=L+1,D=ge[d-j],ae[L]=0<x?u(B/ge[M-x]%ge[x])*D:0),H)for(;;){if(L==0){for(j=1,x=ae[0];10<=x;x/=10,j++);for(x=ae[0]+=D,D=1;10<=x;x/=10,D++);j!=D&&(O.e++,ae[0]==h&&(ae[0]=1));break}if(ae[L]+=D,ae[L]!=h)break;ae[L--]=0,D=1}for(j=ae.length;ae[--j]===0;ae.pop());}O.e>Q?O.c=O.e=null:O.e<G&&(O.c=[O.e=0])}return O}function $e(O){var E,A=O.e;return A===null?O.toString():(E=C(O.c),E=A<=F||W<=A?U(E,A):X(E,A,"0"),O.s<0?"-"+E:E)}return K.clone=Y,K.ROUND_UP=0,K.ROUND_DOWN=1,K.ROUND_CEIL=2,K.ROUND_FLOOR=3,K.ROUND_HALF_UP=4,K.ROUND_HALF_DOWN=5,K.ROUND_HALF_EVEN=6,K.ROUND_HALF_CEIL=7,K.ROUND_HALF_FLOOR=8,K.EUCLID=9,K.config=K.set=function(O){var E,A;if(O!=null){if(typeof O!="object")throw Error(f+"Object expected: "+O);if(O.hasOwnProperty(E="DECIMAL_PLACES")&&(R(A=O[E],0,w,E),T=A),O.hasOwnProperty(E="ROUNDING_MODE")&&(R(A=O[E],0,8,E),I=A),O.hasOwnProperty(E="EXPONENTIAL_AT")&&((A=O[E])&&A.pop?(R(A[0],-w,0,E),R(A[1],0,w,E),F=A[0],W=A[1]):(R(A,-w,w,E),F=-(W=A<0?-A:A))),O.hasOwnProperty(E="RANGE"))if((A=O[E])&&A.pop)R(A[0],-w,-1,E),R(A[1],1,w,E),G=A[0],Q=A[1];else{if(R(A,-w,w,E),!A)throw Error(f+E+" cannot be zero: "+A);G=-(Q=A<0?-A:A)}if(O.hasOwnProperty(E="CRYPTO")){if((A=O[E])!==!!A)throw Error(f+E+" not true or false: "+A);if(A){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw ee=!A,Error(f+"crypto unavailable");ee=A}else ee=A}if(O.hasOwnProperty(E="MODULO_MODE")&&(R(A=O[E],0,9,E),se=A),O.hasOwnProperty(E="POW_PRECISION")&&(R(A=O[E],0,w,E),Re=A),O.hasOwnProperty(E="FORMAT")){if(typeof(A=O[E])!="object")throw Error(f+E+" not an object: "+A);ce=A}if(O.hasOwnProperty(E="ALPHABET")){if(typeof(A=O[E])!="string"||/^.$|[+-.\s]|(.).*\1/.test(A))throw Error(f+E+" invalid: "+A);de=A}}return{DECIMAL_PLACES:T,ROUNDING_MODE:I,EXPONENTIAL_AT:[F,W],RANGE:[G,Q],CRYPTO:ee,MODULO_MODE:se,POW_PRECISION:Re,FORMAT:ce,ALPHABET:de}},K.isBigNumber=function(O){return O instanceof K||O&&O._isBigNumber===!0||!1},K.maximum=K.max=function(){return Ge(arguments,b.lt)},K.minimum=K.min=function(){return Ge(arguments,b.gt)},K.random=(le=9007199254740992,Se=Math.random()*le&2097151?function(){return u(Math.random()*le)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(O){var E,A,H,M,j,x=0,D=[],B=new K(_);if(O==null?O=T:R(O,0,w),M=s(O/d),ee)if(crypto.getRandomValues){for(E=crypto.getRandomValues(new Uint32Array(M*=2));x<M;)9e15<=(j=131072*E[x]+(E[x+1]>>>11))?(A=crypto.getRandomValues(new Uint32Array(2)),E[x]=A[0],E[x+1]=A[1]):(D.push(j%1e14),x+=2);x=M/2}else{if(!crypto.randomBytes)throw ee=!1,Error(f+"crypto unavailable");for(E=crypto.randomBytes(M*=7);x<M;)9e15<=(j=281474976710656*(31&E[x])+1099511627776*E[x+1]+4294967296*E[x+2]+16777216*E[x+3]+(E[x+4]<<16)+(E[x+5]<<8)+E[x+6])?crypto.randomBytes(7).copy(E,x):(D.push(j%1e14),x+=7);x=M/7}if(!ee)for(;x<M;)(j=Se())<9e15&&(D[x++]=j%1e14);for(M=D[--x],O%=d,M&&O&&(j=g[d-O],D[x]=u(M/j)*j);D[x]===0;D.pop(),x--);if(x<0)D=[H=0];else{for(H=-1;D[0]===0;D.splice(0,1),H-=d);for(x=1,j=D[0];10<=j;j/=10,x++);x<d&&(H-=d-x)}return B.e=H,B.c=D,B}),K.sum=function(){for(var O=1,E=arguments,A=new K(E[0]);O<E.length;)A=A.plus(E[O++]);return A},ie=function(){var O="0123456789";function E(A,H,M,j){for(var x,D,B=[0],L=0,z=A.length;L<z;){for(D=B.length;D--;B[D]*=H);for(B[0]+=j.indexOf(A.charAt(L++)),x=0;x<B.length;x++)B[x]>M-1&&(B[x+1]==null&&(B[x+1]=0),B[x+1]+=B[x]/M|0,B[x]%=M)}return B.reverse()}return function(A,H,M,j,x){var D,B,L,z,ae,ge,Oe,De,qe=A.indexOf("."),ct=T,Ne=I;for(0<=qe&&(z=Re,Re=0,A=A.replace(".",""),ge=(De=new K(H)).pow(A.length-qe),Re=z,De.c=E(X(C(ge.c),ge.e,"0"),10,M,O),De.e=De.c.length),L=z=(Oe=E(A,H,M,x?(D=de,O):(D=O,de))).length;Oe[--z]==0;Oe.pop());if(!Oe[0])return D.charAt(0);if(qe<0?--L:(ge.c=Oe,ge.e=L,ge.s=j,Oe=(ge=Z(ge,De,ct,Ne,M)).c,ae=ge.r,L=ge.e),qe=Oe[B=L+ct+1],z=M/2,ae=ae||B<0||Oe[B+1]!=null,ae=Ne<4?(qe!=null||ae)&&(Ne==0||Ne==(ge.s<0?3:2)):z<qe||qe==z&&(Ne==4||ae||Ne==6&&1&Oe[B-1]||Ne==(ge.s<0?8:7)),B<1||!Oe[0])A=ae?X(D.charAt(1),-ct,D.charAt(0)):D.charAt(0);else{if(Oe.length=B,ae)for(--M;++Oe[--B]>M;)Oe[B]=0,B||(++L,Oe=[1].concat(Oe));for(z=Oe.length;!Oe[--z];);for(qe=0,A="";qe<=z;A+=D.charAt(Oe[qe++]));A=X(A,L,D.charAt(0))}return A}}(),Z=function(){function O(H,M,j){var x,D,B,L,z=0,ae=H.length,ge=M%m,Oe=M/m|0;for(H=H.slice();ae--;)z=((D=ge*(B=H[ae]%m)+(x=Oe*B+(L=H[ae]/m|0)*ge)%m*m+z)/j|0)+(x/m|0)+Oe*L,H[ae]=D%j;return z&&(H=[z].concat(H)),H}function E(H,M,j,x){var D,B;if(j!=x)B=x<j?1:-1;else for(D=B=0;D<j;D++)if(H[D]!=M[D]){B=H[D]>M[D]?1:-1;break}return B}function A(H,M,j,x){for(var D=0;j--;)H[j]-=D,D=H[j]<M[j]?1:0,H[j]=D*x+H[j]-M[j];for(;!H[0]&&1<H.length;H.splice(0,1));}return function(H,M,j,x,D){var B,L,z,ae,ge,Oe,De,qe,ct,Ne,He,rt,it,Qe,Xe,Je,jt,yt=H.s==M.s?1:-1,st=H.c,nt=M.c;if(!(st&&st[0]&&nt&&nt[0]))return new K(H.s&&M.s&&(st?!nt||st[0]!=nt[0]:nt)?st&&st[0]==0||!nt?0*yt:yt/0:NaN);for(ct=(qe=new K(yt)).c=[],yt=j+(L=H.e-M.e)+1,D||(D=h,L=S(H.e/d)-S(M.e/d),yt=yt/d|0),z=0;nt[z]==(st[z]||0);z++);if(nt[z]>(st[z]||0)&&L--,yt<0)ct.push(1),ae=!0;else{for(Qe=st.length,Je=nt.length,yt+=2,1<(ge=u(D/(nt[z=0]+1)))&&(nt=O(nt,ge,D),st=O(st,ge,D),Je=nt.length,Qe=st.length),it=Je,He=(Ne=st.slice(0,Je)).length;He<Je;Ne[He++]=0);jt=nt.slice(),jt=[0].concat(jt),Xe=nt[0],nt[1]>=D/2&&Xe++;do{if(ge=0,(B=E(nt,Ne,Je,He))<0){if(rt=Ne[0],Je!=He&&(rt=rt*D+(Ne[1]||0)),1<(ge=u(rt/Xe)))for(D<=ge&&(ge=D-1),De=(Oe=O(nt,ge,D)).length,He=Ne.length;E(Oe,Ne,De,He)==1;)ge--,A(Oe,Je<De?jt:nt,De,D),De=Oe.length,B=1;else ge==0&&(B=ge=1),De=(Oe=nt.slice()).length;if(De<He&&(Oe=[0].concat(Oe)),A(Ne,Oe,He,D),He=Ne.length,B==-1)for(;E(nt,Ne,Je,He)<1;)ge++,A(Ne,Je<He?jt:nt,He,D),He=Ne.length}else B===0&&(ge++,Ne=[0]);ct[z++]=ge,Ne[0]?Ne[He++]=st[it]||0:(Ne=[st[it]],He=1)}while((it++<Qe||Ne[0]!=null)&&yt--);ae=Ne[0]!=null,ct[0]||ct.splice(0,1)}if(D==h){for(z=1,yt=ct[0];10<=yt;yt/=10,z++);Ie(qe,j+(qe.e=z+L*d-1)+1,x,ae)}else qe.e=L,qe.r=+ae;return qe}}(),me=/^(-?)0([xbo])(?=\w[\w.]*$)/i,Ce=/^([^.]+)\.$/,P=/^\.([^.]+)$/,y=/^-?(Infinity|NaN)$/,p=/^\s*\+(?=[\w.])|^\s+|\s+$/g,J=function(O,E,A,H){var M,j=A?E:E.replace(p,"");if(y.test(j))O.s=isNaN(j)?null:j<0?-1:1,O.c=O.e=null;else{if(!A&&(j=j.replace(me,function(x,D,B){return M=(B=B.toLowerCase())=="x"?16:B=="b"?2:8,H&&H!=M?x:D}),H&&(M=H,j=j.replace(Ce,"$1").replace(P,"0.$1")),E!=j))return new K(j,M);if(K.DEBUG)throw Error(f+"Not a"+(H?" base "+H:"")+" number: "+E);O.c=O.e=O.s=null}},b.absoluteValue=b.abs=function(){var O=new K(this);return O.s<0&&(O.s=1),O},b.comparedTo=function(O,E){return k(this,new K(O,E))},b.decimalPlaces=b.dp=function(O,E){var A,H,M;if(O!=null)return R(O,0,w),E==null?E=I:R(E,0,8),Ie(new K(this),O+this.e+1,E);if(!(A=this.c))return null;if(H=((M=A.length-1)-S(this.e/d))*d,M=A[M])for(;M%10==0;M/=10,H--);return H<0&&(H=0),H},b.dividedBy=b.div=function(O,E){return Z(this,new K(O,E),T,I)},b.dividedToIntegerBy=b.idiv=function(O,E){return Z(this,new K(O,E),0,1)},b.exponentiatedBy=b.pow=function(O,E){var A,H,M,j,x,D,B,L,z=this;if((O=new K(O)).c&&!O.isInteger())throw Error(f+"Exponent not an integer: "+$e(O));if(E!=null&&(E=new K(E)),x=14<O.e,!z.c||!z.c[0]||z.c[0]==1&&!z.e&&z.c.length==1||!O.c||!O.c[0])return L=new K(Math.pow(+$e(z),x?2-V(O):+$e(O))),E?L.mod(E):L;if(D=O.s<0,E){if(E.c?!E.c[0]:!E.s)return new K(NaN);(H=!D&&z.isInteger()&&E.isInteger())&&(z=z.mod(E))}else{if(9<O.e&&(0<z.e||z.e<-1||(z.e==0?1<z.c[0]||x&&24e7<=z.c[1]:z.c[0]<8e13||x&&z.c[0]<=9999975e7)))return j=z.s<0&&V(O)?-0:0,-1<z.e&&(j=1/j),new K(D?1/j:j);Re&&(j=s(Re/d+2))}for(B=x?(A=new K(.5),D&&(O.s=1),V(O)):(M=Math.abs(+$e(O)))%2,L=new K(_);;){if(B){if(!(L=L.times(z)).c)break;j?L.c.length>j&&(L.c.length=j):H&&(L=L.mod(E))}if(M){if((M=u(M/2))===0)break;B=M%2}else if(Ie(O=O.times(A),O.e+1,1),14<O.e)B=V(O);else{if((M=+$e(O))==0)break;B=M%2}z=z.times(z),j?z.c&&z.c.length>j&&(z.c.length=j):H&&(z=z.mod(E))}return H?L:(D&&(L=_.div(L)),E?L.mod(E):j?Ie(L,Re,I,void 0):L)},b.integerValue=function(O){var E=new K(this);return O==null?O=I:R(O,0,8),Ie(E,E.e+1,O)},b.isEqualTo=b.eq=function(O,E){return k(this,new K(O,E))===0},b.isFinite=function(){return!!this.c},b.isGreaterThan=b.gt=function(O,E){return 0<k(this,new K(O,E))},b.isGreaterThanOrEqualTo=b.gte=function(O,E){return(E=k(this,new K(O,E)))===1||E===0},b.isInteger=function(){return!!this.c&&S(this.e/d)>this.c.length-2},b.isLessThan=b.lt=function(O,E){return k(this,new K(O,E))<0},b.isLessThanOrEqualTo=b.lte=function(O,E){return(E=k(this,new K(O,E)))===-1||E===0},b.isNaN=function(){return!this.s},b.isNegative=function(){return this.s<0},b.isPositive=function(){return 0<this.s},b.isZero=function(){return!!this.c&&this.c[0]==0},b.minus=function(O,E){var A,H,M,j,x=this,D=x.s;if(E=(O=new K(O,E)).s,!D||!E)return new K(NaN);if(D!=E)return O.s=-E,x.plus(O);var B=x.e/d,L=O.e/d,z=x.c,ae=O.c;if(!B||!L){if(!z||!ae)return z?(O.s=-E,O):new K(ae?x:NaN);if(!z[0]||!ae[0])return ae[0]?(O.s=-E,O):new K(z[0]?x:I==3?-0:0)}if(B=S(B),L=S(L),z=z.slice(),D=B-L){for((M=(j=D<0)?(D=-D,z):(L=B,ae)).reverse(),E=D;E--;M.push(0));M.reverse()}else for(H=(j=(D=z.length)<(E=ae.length))?D:E,D=E=0;E<H;E++)if(z[E]!=ae[E]){j=z[E]<ae[E];break}if(j&&(M=z,z=ae,ae=M,O.s=-O.s),0<(E=(H=ae.length)-(A=z.length)))for(;E--;z[A++]=0);for(E=h-1;D<H;){if(z[--H]<ae[H]){for(A=H;A&&!z[--A];z[A]=E);--z[A],z[H]+=h}z[H]-=ae[H]}for(;z[0]==0;z.splice(0,1),--L);return z[0]?Pe(O,z,L):(O.s=I==3?-1:1,O.c=[O.e=0],O)},b.modulo=b.mod=function(O,E){var A,H,M=this;return O=new K(O,E),!M.c||!O.s||O.c&&!O.c[0]?new K(NaN):!O.c||M.c&&!M.c[0]?new K(M):(se==9?(H=O.s,O.s=1,A=Z(M,O,0,3),O.s=H,A.s*=H):A=Z(M,O,0,se),(O=M.minus(A.times(O))).c[0]||se!=1||(O.s=M.s),O)},b.multipliedBy=b.times=function(O,E){var A,H,M,j,x,D,B,L,z,ae,ge,Oe,De,qe,ct,Ne=this,He=Ne.c,rt=(O=new K(O,E)).c;if(!(He&&rt&&He[0]&&rt[0]))return!Ne.s||!O.s||He&&!He[0]&&!rt||rt&&!rt[0]&&!He?O.c=O.e=O.s=null:(O.s*=Ne.s,He&&rt?(O.c=[0],O.e=0):O.c=O.e=null),O;for(H=S(Ne.e/d)+S(O.e/d),O.s*=Ne.s,(B=He.length)<(ae=rt.length)&&(De=He,He=rt,rt=De,M=B,B=ae,ae=M),M=B+ae,De=[];M--;De.push(0));for(qe=h,ct=m,M=ae;0<=--M;){for(A=0,ge=rt[M]%ct,Oe=rt[M]/ct|0,j=M+(x=B);M<j;)A=((L=ge*(L=He[--x]%ct)+(D=Oe*L+(z=He[x]/ct|0)*ge)%ct*ct+De[j]+A)/qe|0)+(D/ct|0)+Oe*z,De[j--]=L%qe;De[j]=A}return A?++H:De.splice(0,1),Pe(O,De,H)},b.negated=function(){var O=new K(this);return O.s=-O.s||null,O},b.plus=function(O,E){var A,H=this,M=H.s;if(E=(O=new K(O,E)).s,!M||!E)return new K(NaN);if(M!=E)return O.s=-E,H.minus(O);var j=H.e/d,x=O.e/d,D=H.c,B=O.c;if(!j||!x){if(!D||!B)return new K(M/0);if(!D[0]||!B[0])return B[0]?O:new K(D[0]?H:0*M)}if(j=S(j),x=S(x),D=D.slice(),M=j-x){for((A=0<M?(x=j,B):(M=-M,D)).reverse();M--;A.push(0));A.reverse()}for((M=D.length)-(E=B.length)<0&&(A=B,B=D,D=A,E=M),M=0;E;)M=(D[--E]=D[E]+B[E]+M)/h|0,D[E]=h===D[E]?0:D[E]%h;return M&&(D=[M].concat(D),++x),Pe(O,D,x)},b.precision=b.sd=function(O,E){var A,H,M;if(O!=null&&O!==!!O)return R(O,1,w),E==null?E=I:R(E,0,8),Ie(new K(this),O,E);if(!(A=this.c))return null;if(H=(M=A.length-1)*d+1,M=A[M]){for(;M%10==0;M/=10,H--);for(M=A[0];10<=M;M/=10,H++);}return O&&this.e+1>H&&(H=this.e+1),H},b.shiftedBy=function(O){return R(O,-v,v),this.times("1e"+O)},b.squareRoot=b.sqrt=function(){var O,E,A,H,M,j=this,x=j.c,D=j.s,B=j.e,L=T+4,z=new K("0.5");if(D!==1||!x||!x[0])return new K(!D||D<0&&(!x||x[0])?NaN:x?j:1/0);if((A=(D=Math.sqrt(+$e(j)))==0||D==1/0?(((E=C(x)).length+B)%2==0&&(E+="0"),D=Math.sqrt(+E),B=S((B+1)/2)-(B<0||B%2),new K(E=D==1/0?"1e"+B:(E=D.toExponential()).slice(0,E.indexOf("e")+1)+B)):new K(D+"")).c[0]){for((D=(B=A.e)+L)<3&&(D=0);;)if(M=A,A=z.times(M.plus(Z(j,M,L,1))),C(M.c).slice(0,D)===(E=C(A.c)).slice(0,D)){if(A.e<B&&--D,(E=E.slice(D-3,D+1))!="9999"&&(H||E!="4999")){+E&&(+E.slice(1)||E.charAt(0)!="5")||(Ie(A,A.e+T+2,1),O=!A.times(A).eq(j));break}if(!H&&(Ie(M,M.e+T+2,0),M.times(M).eq(j))){A=M;break}L+=4,D+=4,H=1}}return Ie(A,A.e+T+1,I,O)},b.toExponential=function(O,E){return O!=null&&(R(O,0,w),O++),Me(this,O,E,1)},b.toFixed=function(O,E){return O!=null&&(R(O,0,w),O=O+this.e+1),Me(this,O,E)},b.toFormat=function(O,E,A){var H;if(A==null)O!=null&&E&&typeof E=="object"?(A=E,E=null):O&&typeof O=="object"?(A=O,O=E=null):A=ce;else if(typeof A!="object")throw Error(f+"Argument not an object: "+A);if(H=this.toFixed(O,E),this.c){var M,j=H.split("."),x=+A.groupSize,D=+A.secondaryGroupSize,B=A.groupSeparator||"",L=j[0],z=j[1],ae=this.s<0,ge=ae?L.slice(1):L,Oe=ge.length;if(D&&(M=x,x=D,Oe-=D=M),0<x&&0<Oe){for(M=Oe%x||x,L=ge.substr(0,M);M<Oe;M+=x)L+=B+ge.substr(M,x);0<D&&(L+=B+ge.slice(M)),ae&&(L="-"+L)}H=z?L+(A.decimalSeparator||"")+((D=+A.fractionGroupSize)?z.replace(new RegExp("\\d{"+D+"}\\B","g"),"$&"+(A.fractionGroupSeparator||"")):z):L}return(A.prefix||"")+H+(A.suffix||"")},b.toFraction=function(O){var E,A,H,M,j,x,D,B,L,z,ae,ge,Oe=this,De=Oe.c;if(O!=null&&(!(D=new K(O)).isInteger()&&(D.c||D.s!==1)||D.lt(_)))throw Error(f+"Argument "+(D.isInteger()?"out of range: ":"not an integer: ")+$e(D));if(!De)return new K(Oe);for(E=new K(_),L=A=new K(_),H=B=new K(_),ge=C(De),j=E.e=ge.length-Oe.e-1,E.c[0]=g[(x=j%d)<0?d+x:x],O=!O||0<D.comparedTo(E)?0<j?E:L:D,x=Q,Q=1/0,D=new K(ge),B.c[0]=0;z=Z(D,E,0,1),(M=A.plus(z.times(H))).comparedTo(O)!=1;)A=H,H=M,L=B.plus(z.times(M=L)),B=M,E=D.minus(z.times(M=E)),D=M;return M=Z(O.minus(A),H,0,1),B=B.plus(M.times(L)),A=A.plus(M.times(H)),B.s=L.s=Oe.s,ae=Z(L,H,j*=2,I).minus(Oe).abs().comparedTo(Z(B,A,j,I).minus(Oe).abs())<1?[L,H]:[B,A],Q=x,ae},b.toNumber=function(){return+$e(this)},b.toPrecision=function(O,E){return O!=null&&R(O,1,w),Me(this,O,E,2)},b.toString=function(O){var E,A=this,H=A.s,M=A.e;return M===null?H?(E="Infinity",H<0&&(E="-"+E)):E="NaN":(E=O==null?M<=F||W<=M?U(C(A.c),M):X(C(A.c),M,"0"):O===10?X(C((A=Ie(new K(A),T+M+1,I)).c),A.e,"0"):(R(O,2,de.length,"Base"),ie(X(C(A.c),M,"0"),10,O,H,!0)),H<0&&A.c[0]&&(E="-"+E)),E},b.valueOf=b.toJSON=function(){return $e(this)},b._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(b[Symbol.toStringTag]="BigNumber",b[Symbol.for("nodejs.util.inspect.custom")]=b.valueOf),q!=null&&K.set(q),K}()).default=a.BigNumber=a,n!==void 0&&n.exports?n.exports=a:(i||(i=typeof self<"u"&&self?self:window),i.BigNumber=a)})(this)},{}],2:[function(r,n,o){n.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(i){var a=i%10;return~~(i%100/10)==1?"th":a===1?"st":a===2?"nd":a===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(r,n,o){function i(S,C){return function(k){if(Array.isArray(k))return k}(S)||function(k,R){var V=[],U=!0,X=!1,Y=void 0;try{for(var q,Z=k[Symbol.iterator]();!(U=(q=Z.next()).done)&&(V.push(q.value),!R||V.length!==R);U=!0);}catch(ie){X=!0,Y=ie}finally{try{U||Z.return==null||Z.return()}finally{if(X)throw Y}}return V}(S,C)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var a=r("./globalState"),l=r("./validating"),s=r("./parsing"),u=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],f={general:{scale:1024,suffixes:u,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:u,marker:"d"}},c={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function h(S){var C=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},k=2<arguments.length?arguments[2]:void 0;if(typeof C=="string"&&(C=s.parseFormat(C)),!l.validateFormat(C))return"ERROR: invalid format";var R=C.prefix||"",V=C.postfix||"",U=function(X,Y,q){switch(Y.output){case"currency":return Y=w(Y,a.currentCurrencyDefaultFormat()),function(de,K,Me){var Ge=Me.currentCurrency(),Pe=Object.assign({},c,K),Ie=void 0,$e="",O=!!Pe.totalLength||!!Pe.forceAverage||Pe.average,E=K.currencyPosition||Ge.position,A=K.currencySymbol||Ge.symbol;Pe.spaceSeparated&&($e=" "),E==="infix"&&(Ie=$e+A+$e);var H=m({instance:de,providedFormat:K,state:Me,decimalSeparator:Ie});return E==="prefix"&&(H=de._value<0&&Pe.negative==="sign"?"-".concat($e).concat(A).concat(H.slice(1)):A+$e+H),E&&E!=="postfix"||(H=H+($e=O?"":$e)+A),H}(X,Y,a);case"percent":return Y=w(Y,a.currentPercentageDefaultFormat()),function(de,K,Me,Ge){var Pe=K.prefixSymbol,Ie=m({instance:Ge(100*de._value),providedFormat:K,state:Me}),$e=Object.assign({},c,K);return Pe?"%".concat($e.spaceSeparated?" ":"").concat(Ie):"".concat(Ie).concat($e.spaceSeparated?" ":"","%")}(X,Y,a,q);case"byte":return Y=w(Y,a.currentByteDefaultFormat()),_=X,I=a,F=q,W=(T=Y).base||"binary",G=f[W],Q=d(_._value,G.suffixes,G.scale),ee=Q.value,se=Q.suffix,Re=m({instance:F(ee),providedFormat:T,state:I,defaults:I.currentByteDefaultFormat()}),ce=I.currentAbbreviations(),"".concat(Re).concat(ce.spaced?" ":"").concat(se);case"time":return Y=w(Y,a.currentTimeDefaultFormat()),P=X,y=Math.floor(P._value/60/60),p=Math.floor((P._value-60*y*60)/60),b=Math.round(P._value-60*y*60-60*p),"".concat(y,":").concat(p<10?"0":"").concat(p,":").concat(b<10?"0":"").concat(b);case"ordinal":return Y=w(Y,a.currentOrdinalDefaultFormat()),Z=X,ie=Y,le=(J=a).currentOrdinal(),Se=Object.assign({},c,ie),me=m({instance:Z,providedFormat:ie,state:J}),Ce=le(Z._value),"".concat(me).concat(Se.spaceSeparated?" ":"").concat(Ce);case"number":default:return m({instance:X,providedFormat:Y,numbro:q})}var Z,ie,J,le,Se,me,Ce,P,y,p,b,_,T,I,F,W,G,Q,ee,se,Re,ce}(S,C,k);return U=(U=R+U)+V}function d(S,C,k){var R=C[0],V=Math.abs(S);if(k<=V){for(var U=1;U<C.length;++U){var X=Math.pow(k,U),Y=Math.pow(k,U+1);if(X<=V&&V<Y){R=C[U],S/=X;break}}R===C[0]&&(S/=Math.pow(k,C.length-1),R=C[C.length-1])}return{value:S,suffix:R}}function v(S){for(var C="",k=0;k<S;k++)C+="0";return C}function g(S,C){return S.toString().indexOf("e")!==-1?function(k,R){var V=k.toString(),U=i(V.split("e"),2),X=U[0],Y=U[1],q=i(X.split("."),2),Z=q[0],ie=q[1],J=ie===void 0?"":ie;if(0<+Y)V=Z+J+v(Y-J.length);else{var le=".";le=+Z<0?"-0".concat(le):"0".concat(le);var Se=(v(-Y-1)+Math.abs(Z)+J).substr(0,R);Se.length<R&&(Se+=v(R-Se.length)),V=le+Se}return 0<+Y&&0<R&&(V+=".".concat(v(R))),V}(S,C):(Math.round(+"".concat(S,"e+").concat(C))/Math.pow(10,C)).toFixed(C)}function m(S){var C=S.instance,k=S.providedFormat,R=S.state,V=R===void 0?a:R,U=S.decimalSeparator,X=S.defaults,Y=X===void 0?V.currentDefaults():X,q=C._value;if(q===0&&V.hasZeroFormat())return V.getZeroFormat();if(!isFinite(q))return q.toString();var Z,ie,J,le,Se,me,Ce,P,y=Object.assign({},c,Y,k),p=y.totalLength,b=p?0:y.characteristic,_=y.optionalCharacteristic,T=y.forceAverage,I=!!p||!!T||y.average,F=p?-1:I&&k.mantissa===void 0?0:y.mantissa,W=!p&&(k.optionalMantissa===void 0?F===-1:y.optionalMantissa),G=y.trimMantissa,Q=y.thousandSeparated,ee=y.spaceSeparated,se=y.negative,Re=y.forceSign,ce=y.exponential,de="";if(I){var K=function(O){var E=O.value,A=O.forceAverage,H=O.abbreviations,M=O.spaceSeparated,j=M!==void 0&&M,x=O.totalLength,D=x===void 0?0:x,B="",L=Math.abs(E),z=-1;if(L>=Math.pow(10,12)&&!A||A==="trillion"?(B=H.trillion,E/=Math.pow(10,12)):L<Math.pow(10,12)&&L>=Math.pow(10,9)&&!A||A==="billion"?(B=H.billion,E/=Math.pow(10,9)):L<Math.pow(10,9)&&L>=Math.pow(10,6)&&!A||A==="million"?(B=H.million,E/=Math.pow(10,6)):(L<Math.pow(10,6)&&L>=Math.pow(10,3)&&!A||A==="thousand")&&(B=H.thousand,E/=Math.pow(10,3)),B&&(B=(j?" ":"")+B),D){var ae=E.toString().split(".")[0];z=Math.max(D-ae.length,0)}return{value:E,abbreviation:B,mantissaPrecision:z}}({value:q,forceAverage:T,abbreviations:V.currentAbbreviations(),spaceSeparated:ee,totalLength:p});q=K.value,de+=K.abbreviation,p&&(F=K.mantissaPrecision)}if(ce){var Me=(ie=(Z={value:q,characteristicPrecision:b}).value,J=Z.characteristicPrecision,le=J===void 0?0:J,Se=i(ie.toExponential().split("e"),2),me=Se[0],Ce=Se[1],P=+me,le&&1<le&&(P*=Math.pow(10,le-1),Ce=0<=(Ce=+Ce-(le-1))?"+".concat(Ce):Ce),{value:P,abbreviation:"e".concat(Ce)});q=Me.value,de=Me.abbreviation+de}var Ge,Pe,Ie,$e=function(O,E,A,H,M){if(H===-1)return O;var j=g(E,H),x=i(j.toString().split("."),2),D=x[0],B=x[1],L=B===void 0?"":B;if(L.match(/^0+$/)&&(A||M))return D;var z=L.match(/0+$/);return M&&z?"".concat(D,".").concat(L.toString().slice(0,z.index)):j.toString()}(q.toString(),q,W,F,G);return $e=function(O,E,A,H,M){var j=H.currentDelimiters(),x=j.thousands;M=M||j.decimal;var D=j.thousandsSize||3,B=O.toString(),L=B.split(".")[0],z=B.split(".")[1];return A&&(E<0&&(L=L.slice(1)),function(ae,ge){for(var Oe=[],De=0,qe=ae;0<qe;qe--)De===ge&&(Oe.unshift(qe),De=0),De++;return Oe}(L.length,D).forEach(function(ae,ge){L=L.slice(0,ae+ge)+x+L.slice(ae+ge)}),E<0&&(L="-".concat(L))),B=z?L+M+z:L}($e=function(O,E,A,H){var M=O,j=i(M.toString().split("."),2),x=j[0],D=j[1];if(x.match(/^-?0$/)&&A)return D?"".concat(x.replace("0",""),".").concat(D):x.replace("0","");if(x.length<H)for(var B=H-x.length,L=0;L<B;L++)M="0".concat(M);return M.toString()}($e,0,_,b),q,Q,V,U),(I||ce)&&($e=$e+de),(Re||q<0)&&(Ge=$e,Ie=se,$e=(Pe=q)===0?Ge:+Ge==0?Ge.replace("-",""):0<Pe?"+".concat(Ge):Ie==="sign"?Ge:"(".concat(Ge.replace("-",""),")")),$e}function w(S,C){if(!S)return C;var k=Object.keys(S);return k.length===1&&k[0]==="output"?C:S}n.exports=function(S){return{format:function(){for(var C=arguments.length,k=new Array(C),R=0;R<C;R++)k[R]=arguments[R];return h.apply(void 0,k.concat([S]))},getByteUnit:function(){for(var C=arguments.length,k=new Array(C),R=0;R<C;R++)k[R]=arguments[R];return(function(V){var U=f.general;return d(V._value,U.suffixes,U.scale).suffix}).apply(void 0,k.concat([S]))},getBinaryByteUnit:function(){for(var C=arguments.length,k=new Array(C),R=0;R<C;R++)k[R]=arguments[R];return(function(V){var U=f.binary;return d(V._value,U.suffixes,U.scale).suffix}).apply(void 0,k.concat([S]))},getDecimalByteUnit:function(){for(var C=arguments.length,k=new Array(C),R=0;R<C;R++)k[R]=arguments[R];return(function(V){var U=f.decimal;return d(V._value,U.suffixes,U.scale).suffix}).apply(void 0,k.concat([S]))},formatOrDefault:w}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(r,n,o){var i=r("./en-US"),a=r("./validating"),l=r("./parsing"),s={},u=void 0,f={},c=null,h={};function d(g){u=g}function v(){return f[u]}s.languages=function(){return Object.assign({},f)},s.currentLanguage=function(){return u},s.currentCurrency=function(){return v().currency},s.currentAbbreviations=function(){return v().abbreviations},s.currentDelimiters=function(){return v().delimiters},s.currentOrdinal=function(){return v().ordinal},s.currentDefaults=function(){return Object.assign({},v().defaults,h)},s.currentOrdinalDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().ordinalFormat)},s.currentByteDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().byteFormat)},s.currentPercentageDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().percentageFormat)},s.currentCurrencyDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().currencyFormat)},s.currentTimeDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().timeFormat)},s.setDefaults=function(g){g=l.parseFormat(g),a.validateFormat(g)&&(h=g)},s.getZeroFormat=function(){return c},s.setZeroFormat=function(g){return c=typeof g=="string"?g:null},s.hasZeroFormat=function(){return c!==null},s.languageData=function(g){if(g){if(f[g])return f[g];throw new Error('Unknown tag "'.concat(g,'"'))}return v()},s.registerLanguage=function(g){var m=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!a.validateLanguage(g))throw new Error("Invalid language data");f[g.languageTag]=g,m&&d(g.languageTag)},s.setLanguage=function(g){var m=1<arguments.length&&arguments[1]!==void 0?arguments[1]:i.languageTag;if(!f[g]){var w=g.split("-")[0],S=Object.keys(f).find(function(C){return C.split("-")[0]===w});return f[S]?void d(S):void d(m)}d(g)},s.registerLanguage(i),u=i.languageTag,n.exports=s},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(r,n,o){n.exports=function(i){return{loadLanguagesInNode:function(a){return l=i,void a.forEach(function(s){var u=void 0;try{u=r("../languages/".concat(s))}catch{console.error('Unable to load "'.concat(s,'". No matching language file found.'))}u&&l.registerLanguage(u)});var l}}}},{}],6:[function(r,n,o){var i=r("bignumber.js");function a(l,s,u){var f=new i(l._value),c=s;return u.isNumbro(s)&&(c=s._value),c=new i(c),l._value=f.minus(c).toNumber(),l}n.exports=function(l){return{add:function(s,u){return c=u,h=l,d=new i((f=s)._value),v=c,h.isNumbro(c)&&(v=c._value),v=new i(v),f._value=d.plus(v).toNumber(),f;var f,c,h,d,v},subtract:function(s,u){return a(s,u,l)},multiply:function(s,u){return c=u,h=l,d=new i((f=s)._value),v=c,h.isNumbro(c)&&(v=c._value),v=new i(v),f._value=d.times(v).toNumber(),f;var f,c,h,d,v},divide:function(s,u){return c=u,h=l,d=new i((f=s)._value),v=c,h.isNumbro(c)&&(v=c._value),v=new i(v),f._value=d.dividedBy(v).toNumber(),f;var f,c,h,d,v},set:function(s,u){return f=s,h=c=u,l.isNumbro(c)&&(h=c._value),f._value=h,f;var f,c,h},difference:function(s,u){return f=u,a(h=(c=l)(s._value),f,c),Math.abs(h._value);var f,c,h}}}},{"bignumber.js":1}],7:[function(r,n,o){function i(m,w){for(var S=0;S<w.length;S++){var C=w[S];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(m,C.key,C)}}var a=r("./globalState"),l=r("./validating"),s=r("./loading")(g),u=r("./unformatting"),f=r("./formatting")(g),c=r("./manipulating")(g),h=r("./parsing"),d=function(){function m(C){(function(k,R){if(!(k instanceof R))throw new TypeError("Cannot call a class as a function")})(this,m),this._value=C}var w,S;return w=m,(S=[{key:"clone",value:function(){return g(this._value)}},{key:"format",value:function(){var C=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return f.format(this,C)}},{key:"formatCurrency",value:function(C){return typeof C=="string"&&(C=h.parseFormat(C)),(C=f.formatOrDefault(C,a.currentCurrencyDefaultFormat())).output="currency",f.format(this,C)}},{key:"formatTime",value:function(){var C=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return C.output="time",f.format(this,C)}},{key:"binaryByteUnits",value:function(){return f.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return f.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return f.getByteUnit(this)}},{key:"difference",value:function(C){return c.difference(this,C)}},{key:"add",value:function(C){return c.add(this,C)}},{key:"subtract",value:function(C){return c.subtract(this,C)}},{key:"multiply",value:function(C){return c.multiply(this,C)}},{key:"divide",value:function(C){return c.divide(this,C)}},{key:"set",value:function(C){return c.set(this,v(C))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&i(w.prototype,S),m}();function v(m){var w=m;return g.isNumbro(m)?w=m._value:typeof m=="string"?w=g.unformat(m):isNaN(m)&&(w=NaN),w}function g(m){return new d(v(m))}g.version="2.1.2",g.isNumbro=function(m){return m instanceof d},g.language=a.currentLanguage,g.registerLanguage=a.registerLanguage,g.setLanguage=a.setLanguage,g.languages=a.languages,g.languageData=a.languageData,g.zeroFormat=a.setZeroFormat,g.defaultFormat=a.currentDefaults,g.setDefaults=a.setDefaults,g.defaultCurrencyFormat=a.currentCurrencyDefaultFormat,g.validate=l.validate,g.loadLanguagesInNode=s.loadLanguagesInNode,g.unformat=u.unformat,n.exports=g},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(r,n,o){n.exports={parseFormat:function(i){var a,l,s,u,f,c,h,d,v,g,m,w,S,C,k,R,V,U,X,Y,q=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof i!="string"?i:(l=q,i=(s=(a=i).match(/^{([^}]*)}/))?(l.prefix=s[1],a.slice(s[0].length)):a,f=q,function(Z,ie){if(Z.indexOf("$")===-1){if(Z.indexOf("%")===-1)return Z.indexOf("bd")!==-1?(ie.output="byte",ie.base="general"):Z.indexOf("b")!==-1?(ie.output="byte",ie.base="binary"):Z.indexOf("d")!==-1?(ie.output="byte",ie.base="decimal"):Z.indexOf(":")===-1?Z.indexOf("o")!==-1&&(ie.output="ordinal"):ie.output="time";ie.output="percent"}else ie.output="currency"}(i=(c=(u=i).match(/{([^}]*)}$/))?(f.postfix=c[1],u.slice(0,-c[0].length)):u,q),h=q,(d=i.match(/[1-9]+[0-9]*/))&&(h.totalLength=+d[0]),v=q,(g=i.split(".")[0].match(/0+/))&&(v.characteristic=g[0].length),function(Z,ie){if(Z.indexOf(".")!==-1){var J=Z.split(".")[0];ie.optionalCharacteristic=J.indexOf("0")===-1}}(i,q),m=q,i.indexOf("a")!==-1&&(m.average=!0),S=q,(w=i).indexOf("K")!==-1?S.forceAverage="thousand":w.indexOf("M")!==-1?S.forceAverage="million":w.indexOf("B")!==-1?S.forceAverage="billion":w.indexOf("T")!==-1&&(S.forceAverage="trillion"),function(Z,ie){var J=Z.split(".")[1];if(J){var le=J.match(/0+/);le&&(ie.mantissa=le[0].length)}}(i,q),k=q,(C=i).match(/\[\.]/)?k.optionalMantissa=!0:C.match(/\./)&&(k.optionalMantissa=!1),R=q,i.indexOf(",")!==-1&&(R.thousandSeparated=!0),V=q,i.indexOf(" ")!==-1&&(V.spaceSeparated=!0),X=q,(U=i).match(/^\+?\([^)]*\)$/)&&(X.negative="parenthesis"),U.match(/^\+?-/)&&(X.negative="sign"),Y=q,i.match(/^\+/)&&(Y.forceSign=!0),q)}}},{}],9:[function(r,n,o){var i=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function a(s){return s.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function l(s,u){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",c=3<arguments.length?arguments[3]:void 0,h=4<arguments.length?arguments[4]:void 0,d=5<arguments.length?arguments[5]:void 0,v=6<arguments.length?arguments[6]:void 0;if(s!=="")return s===h?0:function g(m,w){var S=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",C=3<arguments.length?arguments[3]:void 0,k=4<arguments.length?arguments[4]:void 0,R=5<arguments.length?arguments[5]:void 0,V=6<arguments.length?arguments[6]:void 0;if(!isNaN(+m))return+m;var U="",X=m.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(X!==m)return-1*g(X,w,S,C,k,R,V);for(var Y=0;Y<i.length;Y++){var q=i[Y];if((U=m.replace(q.key,""))!==m)return g(U,w,S,C,k,R,V)*q.factor}if((U=m.replace("%",""))!==m)return g(U,w,S,C,k,R,V)/100;var Z=parseFloat(m);if(!isNaN(Z)){var ie=C(Z);if(ie&&ie!=="."&&(U=m.replace(new RegExp("".concat(a(ie),"$")),""))!==m)return g(U,w,S,C,k,R,V);var J={};Object.keys(R).forEach(function(p){J[R[p]]=p});for(var le=Object.keys(J).sort().reverse(),Se=le.length,me=0;me<Se;me++){var Ce=le[me],P=J[Ce];if((U=m.replace(Ce,""))!==m){var y=void 0;switch(P){case"thousand":y=Math.pow(10,3);break;case"million":y=Math.pow(10,6);break;case"billion":y=Math.pow(10,9);break;case"trillion":y=Math.pow(10,12)}return g(U,w,S,C,k,R,V)*y}}}}(function(g,m){var w=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",S=g.replace(w,"");return S=(S=S.replace(new RegExp("([0-9])".concat(a(m.thousands),"([0-9])"),"g"),"$1$2")).replace(m.decimal,".")}(s,u,f),u,f,c,h,d,v)}n.exports={unformat:function(s,u){var f,c,h,d=r("./globalState"),v=d.currentDelimiters(),g=d.currentCurrency().symbol,m=d.currentOrdinal(),w=d.getZeroFormat(),S=d.currentAbbreviations(),C=void 0;if(typeof s=="string")C=function(k,R){if(!k.indexOf(":")||R.thousands===":")return!1;var V=k.split(":");if(V.length!==3)return!1;var U=+V[0],X=+V[1],Y=+V[2];return!isNaN(U)&&!isNaN(X)&&!isNaN(Y)}(s,v)?(f=s.split(":"),c=+f[0],h=+f[1],+f[2]+60*h+3600*c):l(s,v,g,m,w,S,u);else{if(typeof s!="number")return;C=s}if(C!==void 0)return C}}},{"./globalState":4}],10:[function(r,n,o){function i(v){return function(g){if(Array.isArray(g)){for(var m=0,w=new Array(g.length);m<g.length;m++)w[m]=g[m];return w}}(v)||function(g){if(Symbol.iterator in Object(g)||Object.prototype.toString.call(g)==="[object Arguments]")return Array.from(g)}(v)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function a(v){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g})(v)}var l=r("./unformatting"),s=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,u={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(v,g){return g.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(v){return v.output==="byte"}},characteristic:{type:"number",restriction:function(v){return 0<=v},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(v){return 0<=v},message:"value must be positive"},{restriction:function(v,g){return!g.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(v){return 0<=v},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(v,g){return g.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},f={languageTag:{type:"string",mandatory:!0,restriction:function(v){return v.match(s)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function c(v){return!!l.unformat(v)}function h(v,g,m){var w=3<arguments.length&&arguments[3]!==void 0&&arguments[3],S=Object.keys(v).map(function(C){if(!g[C])return console.error("".concat(m," Invalid key: ").concat(C)),!1;var k=v[C],R=g[C];if(typeof R=="string"&&(R={type:R}),R.type==="format"){if(!h(k,u,"[Validate ".concat(C,"]"),!0))return!1}else if(a(k)!==R.type)return console.error("".concat(m," ").concat(C,' type mismatched: "').concat(R.type,'" expected, "').concat(a(k),'" provided')),!1;if(R.restrictions&&R.restrictions.length)for(var V=R.restrictions.length,U=0;U<V;U++){var X=R.restrictions[U],Y=X.restriction,q=X.message;if(!Y(k,v))return console.error("".concat(m," ").concat(C," invalid value: ").concat(q)),!1}return R.restriction&&!R.restriction(k,v)?(console.error("".concat(m," ").concat(C," invalid value: ").concat(R.message)),!1):R.validValues&&R.validValues.indexOf(k)===-1?(console.error("".concat(m," ").concat(C," invalid value: must be among ").concat(JSON.stringify(R.validValues),', "').concat(k,'" provided')),!1):!(R.children&&!h(k,R.children,"[Validate ".concat(C,"]")))});return w||S.push.apply(S,i(Object.keys(g).map(function(C){var k=g[C];if(typeof k=="string"&&(k={type:k}),k.mandatory){var R=k.mandatory;if(typeof R=="function"&&(R=R(v)),R&&v[C]===void 0)return console.error("".concat(m,' Missing mandatory key "').concat(C,'"')),!1}return!0}))),S.reduce(function(C,k){return C&&k},!0)}function d(v){return h(v,u,"[Validate format]")}n.exports={validate:function(v,g){var m=c(v),w=d(g);return m&&w},validateFormat:d,validateInput:c,validateLanguage:function(v){return h(v,f,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})(eU);var IRe=eU.exports;const Ui=qL(IRe);var MRe="numeric";function Ek(e,t,r,n,o,i,a){var l=i;if(gr(l)){var s=a.numericFormat,u=s&&s.culture||"-",f=s&&s.pattern,c=a.className||"",h=c.length?c.split(" "):[];if(typeof u<"u"&&!Ui.languages()[u]){var d=u.replace("-",""),v=Ui.allLanguages?Ui.allLanguages[u]:Ui[d];v&&Ui.registerLanguage(v)}Ui.setLanguage(u),l=Ui(l).format(f||"0"),h.indexOf("htLeft")<0&&h.indexOf("htCenter")<0&&h.indexOf("htRight")<0&&h.indexOf("htJustify")<0&&h.push("htRight"),h.indexOf("htNumeric")<0&&h.push("htNumeric"),a.className=h.join(" "),t.dir="ltr"}xi(e,t,r,n,o,l,a)}Ek.RENDERER_TYPE=MRe;var xRe="password";function Tk(e,t,r,n,o,i,a){xi.apply(this,[e,t,r,n,o,i,a]);var l=a.hashLength||t.innerHTML.length,s=a.hashSymbol||"*",u="";_e(l-1,function(){u+=s}),ol(t,u)}Tk.RENDERER_TYPE=xRe;var DRe="time";function kk(e,t,r,n,o,i,a){xi.apply(this,[e,t,r,n,o,i,a]),t.dir="ltr"}kk.RENDERER_TYPE=DRe;function NRe(){In(If),In(Pv),In(Ok),In(_k),In(Ek),In(Tk),In(xi),In(kk)}var HRe="autocomplete";function Zm(e,t){var r=e;if(r==null&&(r=""),this.allowEmpty&&r===""){t(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(r,Rx(r,t)):Rx(r,t)(this.source):t(!0)}Zm.VALIDATOR_TYPE=HRe;function Rx(e,t){var r=e;return function(n){for(var o=!1,i=0,a=n.length;i<a;i++)if(r===n[i]){o=!0;break}t(o)}}var LRe=Object.is||function(t,r){return t===r?t!==0||1/t===1/r:t!==t&&r!==r},jRe=zt,FRe=gm,BRe=Ht,VRe=mn,WRe=Tr,Ex=LRe,Tx=Yt,URe=Xa,zRe=pm;FRe("search",function(e,t,r){return[function(o){var i=WRe(this),a=VRe(o)?void 0:URe(o,e);return a?jRe(a,o,i):new RegExp(o)[e](Tx(i))},function(n){var o=BRe(this),i=Tx(n),a=r(t,o,i);if(a.done)return a.value;var l=o.lastIndex;Ex(l,0)||(o.lastIndex=0);var s=zRe(o,i);return Ex(o.lastIndex,l)||(o.lastIndex=l),s===null?-1:s.index}]});function tU(e){var t=new Date(e);return isNaN(new Date("".concat(e,"T00:00")).getDate())?t:new Date(t.getTime()+t.getTimezoneOffset()*6e4)}const YRe=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:tU},Symbol.toStringTag,{value:"Module"}));var GRe="date";function Pk(e,t){var r=qV(KW,this.instance),n=e,o=!0;n==null&&(n="");var i=te(n,this.dateFormat||r.defaultDateFormat,!0).isValid(),a=te(new Date(n)).isValid()||i;if(this.allowEmpty&&n===""&&(a=!0,i=!0),a||(o=!1),!a&&i&&(o=!0),a&&!i)if(this.correctFormat===!0){var l=KRe(n,this.dateFormat),s=this.instance.toVisualRow(this.row),u=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(s,u,l,"dateValidator"),o=!0}else o=!1;t(o)}Pk.VALIDATOR_TYPE=GRe;function KRe(e,t){var r=te(tU(e)),n=te(e,t),o=e.search(/[A-z]/g)>-1,i;return r.isValid()&&r.format("x")===n.format("x")||!n.isValid()||o?i=r:i=n,i.format(t)}var qRe="numeric";function $k(e,t){var r=e;r==null&&(r=""),this.allowEmpty&&r===""?t(!0):t(r===""?!1:gr(e))}$k.VALIDATOR_TYPE=qRe;var XRe=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],ZRe="time";function Ak(e,t){var r=this.timeFormat||"h:mm:ss a",n=!0,o=e;o===null&&(o=""),o=/^\d{3,}$/.test(o)?parseInt(o,10):o;var i=/^\d{1,2}$/.test(o);i&&(o+=":00");var a=te(o,XRe,!0).isValid()?te(o):te(o,r),l=a.isValid(),s=te(o,r,!0).isValid()&&!i;if(this.allowEmpty&&o===""&&(l=!0,s=!0),l||(n=!1),!l&&s&&(n=!0),l&&!s)if(this.correctFormat===!0){var u=a.format(r),f=this.instance.toVisualRow(this.row),c=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(f,c,u,"timeValidator"),n=!0}else n=!1;t(n)}Ak.VALIDATOR_TYPE=ZRe;function JRe(){Gl(Zm),Gl(Pk),Gl($k),Gl(Ak)}var QRe="autocomplete",e0e={CELL_TYPE:QRe,editor:Sk,renderer:If,validator:Zm},t0e="checkbox",r0e={CELL_TYPE:t0e,editor:YW,renderer:Ok},n0e="date",o0e={CELL_TYPE:n0e,editor:qW,renderer:If,validator:Pk},i0e="dropdown",a0e={CELL_TYPE:i0e,editor:Ck,renderer:If,validator:Zm},l0e="handsontable",s0e={CELL_TYPE:l0e,editor:wk,renderer:If},u0e="numeric",f0e={CELL_TYPE:u0e,editor:XW,renderer:Ek,validator:$k,dataType:"number"},c0e="password",h0e={CELL_TYPE:c0e,editor:ZW,renderer:Tk,copyable:!1},d0e="time",v0e={CELL_TYPE:d0e,editor:JW,renderer:kk,validator:Ak};function y0e(){an(e0e),an(r0e),an(o0e),an(a0e),an(s0e),an(f0e),an(h0e),an(UW),an(v0e)}var g0e=hm,p0e=LV;g0e("WeakSet",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},p0e);function Zh(e){"@babel/helpers - typeof";return Zh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zh(e)}function m0e(e,t){return C0e(e)||S0e(e,t)||w0e(e,t)||b0e()}function b0e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function w0e(e,t){if(e){if(typeof e=="string")return kx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return kx(e,t)}}function kx(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function S0e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function C0e(e){if(Array.isArray(e))return e}function _0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Px(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,R0e(n.key),n)}}function O0e(e,t,r){return t&&Px(e.prototype,t),r&&Px(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function R0e(e){var t=E0e(e,"string");return Zh(t)==="symbol"?t:String(t)}function E0e(e,t){if(Zh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function T0e(e,t){k0e(e,t),t.add(e)}function k0e(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function P0e(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}var $x=new Map([["plugin",iue],["cell-type",xW],["editor",KV],["renderer",s2],["validator",u2]]),$0e="base",zi=new WeakMap,Ww=[],Rn=null,Ax=new WeakSet,ot=function(){function e(t){var r=this;_0e(this,e),T0e(this,Ax),Bn(this,"hot",t,{writable:!1}),zi.set(this,{hooks:{}}),Rn=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",function(){return r.onAfterPluginsInitialized()}),this.hot.addHook("afterUpdateSettings",function(n){return r.onUpdateSettings(n)}),this.hot.addHook("beforeInit",function(){return r.init()})}return O0e(e,[{key:"init",value:function(){var r=this;this.pluginName=this.hot.getPluginName(this);var n=this.constructor.PLUGIN_DEPS,o=Array.isArray(n)?n:[];if(o.length>0){var i=[];if(o.forEach(function(u){var f=u.split(":"),c=m0e(f,2),h=c[0],d=c[1];if(!$x.has(h))throw new Error('Unknown plugin dependency type "'.concat(h,'" was found.'));$x.get(h)(d)||i.push(" - ".concat(d," (").concat(h,")"))}),i.length>0){var a=["The ".concat(this.pluginName,` plugin requires the following modules:
`),"".concat(i.join(`
`),`
`)].join("");Ww.push(a)}}Rn||(Rn=TE()),Rn.indexOf("UndoRedo")>=0&&Rn.splice(Rn.indexOf("UndoRedo"),1),Rn.indexOf(this.pluginName)>=0&&Rn.splice(Rn.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",function(){r.isEnabled&&r.isEnabled()&&r.enablePlugin()});var l=Rn.length===0;if(l){if(Ww.length>0){var s=["".concat(Ww.join(`
`),`
`),"You have to import and register them manually."].join("");throw new Error(s)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}},{key:"enablePlugin",value:function(){this.enabled=!0}},{key:"disablePlugin",value:function(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}},{key:"addHook",value:function(r,n){zi.get(this).hooks[r]=zi.get(this).hooks[r]||[];var o=zi.get(this).hooks[r];this.hot.addHook(r,n),o.push(n),zi.get(this).hooks[r]=o}},{key:"removeHooks",value:function(r){var n=this;$(zi.get(this).hooks[r]||[],function(o){n.hot.removeHook(r,o)})}},{key:"clearHooks",value:function(){var r=this,n=zi.get(this).hooks;We(n,function(o,i){return r.removeHooks(i)}),n.length=0}},{key:"callOnPluginsReady",value:function(r){this.isPluginsReady?r():this.pluginsInitializedCallbacks.push(r)}},{key:"onAfterPluginsInitialized",value:function(){$(this.pluginsInitializedCallbacks,function(r){return r()}),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}},{key:"onUpdateSettings",value:function(r){var n=P0e(this,Ax,A0e).call(this,r);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(r))}},{key:"updatePlugin",value:function(){}},{key:"destroy",value:function(){var r=this;this.eventManager&&this.eventManager.destroy(),this.clearHooks(),We(this,function(n,o){o!=="hot"&&(r[o]=null)}),delete this.t,delete this.hot}}],[{key:"PLUGIN_KEY",get:function(){return $0e}},{key:"SETTING_KEYS",get:function(){return[this.PLUGIN_KEY]}}]),e}();function A0e(e){if(!e)return!1;var t=this.constructor.SETTING_KEYS;if(typeof t=="boolean")return t;for(var r=0;r<t.length;r++)if(e[t[r]]!==void 0)return!0;return!1}function Jh(e){"@babel/helpers - typeof";return Jh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jh(e)}function I0e(e,t){return N0e(e)||D0e(e,t)||x0e(e,t)||M0e()}function M0e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function x0e(e,t){if(e){if(typeof e=="string")return Ix(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ix(e,t)}}function Ix(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function D0e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function N0e(e){if(Array.isArray(e))return e}function H0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Mx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,j0e(n.key),n)}}function L0e(e,t,r){return t&&Mx(e.prototype,t),r&&Mx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function j0e(e){var t=F0e(e,"string");return Jh(t)==="symbol"?t:String(t)}function F0e(e,t){if(Jh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Jh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var B0e=function(){function e(t){H0e(this,e),this.hot=t,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}return L0e(e,[{key:"addRow",value:function(r,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var o={row:r};this.rows.push(o),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(r)),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}},{key:"addColumnHeadersRow",value:function(r){var n=this.hot.getColHeader(0);if(n!=null){var o={row:-1};this.rows.push(o),this.container=this.createContainer(this.hot.rootElement.className),this.samples=r,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}}},{key:"addColumn",value:function(r,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var o={col:r};this.columns.push(o),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(r)!==null&&this.hot.view.appendColHeader(r,this.table.th),this.table.tBody.appendChild(this.createCol(r)),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}},{key:"getHeights",value:function(r){this.injected||this.injectTable(),$(this.rows,function(n){r(n.row,Rt(n.table)-1)})}},{key:"getWidths",value:function(r){this.injected||this.injectTable(),$(this.columns,function(n){var o=n.table.getBoundingClientRect(),i=o.width;r(n.col,Math.ceil(i))})}},{key:"setSettings",value:function(r){this.settings=r}},{key:"setSetting",value:function(r,n){this.settings||(this.settings={}),this.settings[r]=n}},{key:"getSettings",value:function(){return this.settings}},{key:"getSetting",value:function(r){return this.settings?this.settings[r]:null}},{key:"createColGroupsCol",value:function(){var r=this,n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1)),this.samples.forEach(function(o){$(o.strings,function(i){n.appendChild(r.createColElement(i.col))})}),n}},{key:"createRow",value:function(r){var n=this,o=this.hot.rootDocument,i=o.createDocumentFragment(),a=o.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(r,a),i.appendChild(a)),this.samples.forEach(function(l){$(l.strings,function(s){var u=s.col,f=n.hot.getCellMeta(r,u);f.col=u,f.row=r;var c=n.hot.getCellRenderer(f),h=o.createElement("td");h.setAttribute("ghost-table",1),c(n.hot,h,r,u,n.hot.colToProp(u),s.value,f),i.appendChild(h)})}),i}},{key:"appendColumnHeadersRow",value:function(){var r=this,n=this.hot.rootDocument,o=n.createDocumentFragment(),i=[];if(this.hot.hasRowHeaders()){var a=n.createElement("th");i.push([-1,a]),o.appendChild(a)}this.samples.forEach(function(l){$(l.strings,function(s){var u=s.col,f=n.createElement("th");i.push([u,f]),o.appendChild(f)})}),this.table.tHead.appendChild(o),$(i,function(l){var s=I0e(l,2),u=s[0],f=s[1];r.hot.view.appendColHeader(u,f)})}},{key:"createCol",value:function(r){var n=this,o=this.hot.rootDocument,i=o.createDocumentFragment();return this.samples.forEach(function(a){$(a.strings,function(l){var s=l.row,u=n.hot.getCellMeta(s,r);u.col=r,u.row=s;var f=n.hot.getCellRenderer(u),c=o.createElement("td"),h=o.createElement("tr");c.setAttribute("ghost-table",1),f(n.hot,c,s,r,n.hot.colToProp(r),l.value,u),h.appendChild(c),i.appendChild(h)})}),i}},{key:"clean",value:function(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}},{key:"injectTable",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((r||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}},{key:"removeTable",value:function(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}},{key:"createColElement",value:function(r){var n=this.hot.rootDocument.createElement("col");return n.style.width="".concat(this.hot.view._wt.wtTable.getStretchedColumnWidth(r),"px"),n}},{key:"createTable",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=this.hot.rootDocument,o=n.createDocumentFragment(),i=n.createElement("table"),a=n.createElement("thead"),l=n.createElement("tbody"),s=n.createElement("colgroup"),u=n.createElement("tr"),f=n.createElement("th");return this.isVertical()&&i.appendChild(s),this.isHorizontal()&&(u.appendChild(f),a.appendChild(u),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(a),this.isVertical()&&l.appendChild(u),i.appendChild(l),re(i,r),o.appendChild(i),{fragment:o,table:i,tHead:a,tBody:l,colGroup:s,tr:u,th:f}}},{key:"createContainer",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=this.hot.rootDocument,o=n.createDocumentFragment(),i=n.createElement("div"),a="htGhostTable htAutoSize ".concat(r.trim());return re(i,a),o.appendChild(i),{fragment:o,container:i}}},{key:"isVertical",value:function(){return!!(this.rows.length&&!this.columns.length)}},{key:"isHorizontal",value:function(){return!!(this.columns.length&&!this.rows.length)}}]),e}();const Ik=B0e;function Qh(e){"@babel/helpers - typeof";return Qh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qh(e)}function V0e(e,t,r){return t=rU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function W0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rU(n.key),n)}}function U0e(e,t,r){return t&&xx(e.prototype,t),r&&xx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rU(e){var t=z0e(e,"string");return Qh(t)==="symbol"?t:String(t)}function z0e(e,t){if(Qh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Y0e=function(){function e(t){W0e(this,e),this.samples=null,this.dataFactory=t,this.customSampleCount=null,this.allowDuplicates=!1}return U0e(e,[{key:"getSampleCount",value:function(){return this.customSampleCount?this.customSampleCount:e.SAMPLE_COUNT}},{key:"setSampleCount",value:function(r){this.customSampleCount=r}},{key:"setAllowDuplicates",value:function(r){this.allowDuplicates=r}},{key:"generateRowSamples",value:function(r,n){return this.generateSamples("row",n,r)}},{key:"generateColumnSamples",value:function(r,n){return this.generateSamples("col",n,r)}},{key:"generateSamples",value:function(r,n,o){var i=this,a=new Map,l=typeof o=="number"?{from:o,to:o}:o,s=l.from,u=l.to;return _e(s,u,function(f){var c=i.generateSample(r,n,f);a.set(f,c)}),a}},{key:"generateSample",value:function(r,n,o){var i=this;if(r!=="row"&&r!=="col")throw new Error("Unsupported sample type");var a=new Map,l=r==="row"?"col":"row",s=[];return _e(n.from,n.to,function(u){var f=r==="row"?i.dataFactory(o,u):i.dataFactory(u,o),c=f.value,h=f.bundleSeed,d=typeof h=="string"&&h.length>0,v;d?v=h:Ve(c)?v="".concat(Object.keys(c).length):Array.isArray(c)?v="".concat(c.length):v="".concat(It(c).length),a.has(v)||a.set(v,{needed:i.getSampleCount(),strings:[]});var g=a.get(v);if(g.needed){var m=s.indexOf(c)>-1;(!m||i.allowDuplicates||d)&&(g.strings.push(V0e({value:c},l,u)),s.push(c),g.needed-=1)}}),a}}],[{key:"SAMPLE_COUNT",get:function(){return 3}}]),e}();const nU=Y0e;function fu(e){"@babel/helpers - typeof";return fu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fu(e)}function Dx(e,t){return X0e(e)||q0e(e,t)||K0e(e,t)||G0e()}function G0e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function K0e(e,t){if(e){if(typeof e=="string")return Nx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Nx(e,t)}}function Nx(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function q0e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function X0e(e){if(Array.isArray(e))return e}function Z0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Hx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Q0e(n.key),n)}}function J0e(e,t,r){return t&&Hx(e.prototype,t),r&&Hx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Q0e(e){var t=eEe(e,"string");return fu(t)==="symbol"?t:String(t)}function eEe(e,t){if(fu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ia(){return typeof Reflect<"u"&&Reflect.get?ia=Reflect.get.bind():ia=function(t,r,n){var o=tEe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ia.apply(this,arguments)}function tEe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=uo(e),e!==null););return e}function rEe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dO(e,t)}function dO(e,t){return dO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},dO(e,t)}function nEe(e){var t=iEe();return function(){var n=uo(e),o;if(t){var i=uo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return oEe(this,o)}}function oEe(e,t){if(t&&(fu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return oU(e)}function oU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iEe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function uo(e){return uo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},uo(e)}pe.getSingleton().register("modifyAutoColumnSizeSeed");var Zf="autoColumnSize",aEe=10,Uw=new WeakMap,lEe="autoColumnSize",sEe=function(e){rEe(r,e);var t=nEe(r);function r(n){var o;return Z0e(this,r),o=t.call(this,n),Uw.set(oU(o),{cachedColumnHeaders:[]}),o.ghostTable=new Ik(o.hot),o.samplesGenerator=new nU(function(i,a){var l=o.hot.getCellMeta(i,a),s="";l.spanned||(s=o.hot.getDataAtCell(i,a));var u="";return o.hot.hasHook("modifyAutoColumnSizeSeed")&&(u=o.hot.runHooks("modifyAutoColumnSizeSeed",u,l,s)),{value:s,bundleSeed:u}}),o.firstCalculation=!0,o.inProgress=!1,o.measuredColumns=0,o.columnWidthsMap=new Mi,o.hot.columnIndexMapper.registerMap(lEe,o.columnWidthsMap),o.addHook("beforeColumnResize",function(i,a,l){return o.onBeforeColumnResize(i,a,l)}),o}return J0e(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[Zf]!==!1&&!this.hot.getSettings().colWidths}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[Zf];i&&i.useHeaders!==null&&i.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",i.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("beforeChangeRender",function(a){return o.onBeforeChange(a)}),this.addHook("afterFormulasValuesUpdate",function(a){return o.onAfterFormulasValuesUpdate(a)}),this.addHook("beforeViewRender",function(a){return o.onBeforeViewRender(a)}),this.addHook("modifyColWidth",function(a,l){return o.getColumnWidth(l,a)}),this.addHook("afterInit",function(){return o.onAfterInit()}),ia(uo(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var o=this.findColumnsWhereHeaderWasChanged();o.length&&(this.clearCache(o),this.calculateVisibleColumnsWidth()),ia(uo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var o=this;ia(uo(r.prototype),"disablePlugin",this).call(this),this.addHook("beforeColumnResize",function(i,a,l){return o.onBeforeColumnResize(i,a,l)})}},{key:"calculateVisibleColumnsWidth",value:function(){var o=this.hot.countRows();if(o){var i=this.hot.renderCall,a=this.getFirstVisibleColumn(),l=this.getLastVisibleColumn();a===-1||l===-1||this.calculateColumnsWidth({from:a,to:l},void 0,i)}}},{key:"calculateColumnsWidth",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=typeof i=="number"?{from:i,to:i}:i,u=typeof a=="number"?{from:a,to:a}:a;_e(s.from,s.to,function(f){var c=o.hot.toPhysicalColumn(f);if(c===null&&(c=f),l||o.columnWidthsMap.getValueAtIndex(c)===null&&!o.hot._getColWidthFromSettings(c)){var h=o.samplesGenerator.generateColumnSamples(f,u);$(h,function(d){var v=Dx(d,2),g=v[0],m=v[1];return o.ghostTable.addColumn(g,m)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(function(){o.ghostTable.getWidths(function(f,c){var h=o.hot.toPhysicalColumn(f);o.columnWidthsMap.setValueAtIndex(h,c)})},!0),this.measuredColumns=s.to+1,this.ghostTable.clean())}},{key:"calculateAllColumnsWidth",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},a=0,l=this.hot.countCols()-1,s=null;this.inProgress=!0;var u=function c(){if(!o.hot){jc(s),o.inProgress=!1;return}o.calculateColumnsWidth({from:a,to:Math.min(a+r.CALCULATION_STEP,l)},i),a=a+r.CALCULATION_STEP+1,a<l?s=bm(c):(jc(s),o.inProgress=!1,o.hot.view.adjustElementsSize())},f=this.getSyncCalculationLimit();this.firstCalculation&&f>=0&&(this.calculateColumnsWidth({from:0,to:f},i),this.firstCalculation=!1,a=f+1),a<l?u():this.inProgress=!1}},{key:"setSamplingOptions",value:function(){var o=this.hot.getSettings()[Zf],i=o&&At(o,"samplingRatio")?o.samplingRatio:void 0,a=o&&At(o,"allowSampleDuplicates")?o.allowSampleDuplicates:void 0;i&&!isNaN(i)&&this.samplesGenerator.setSampleCount(parseInt(i,10)),a&&this.samplesGenerator.setAllowDuplicates(a)}},{key:"recalculateAllColumnsWidth",value:function(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}},{key:"getSyncCalculationLimit",value:function(){var o=this.hot.getSettings()[Zf],i=r.SYNC_CALCULATION_LIMIT,a=this.hot.countCols()-1;return Ve(o)&&(i=o.syncLimit,gE(i)?i=RE(a,i):i>>=0),Math.min(i,a)}},{key:"getColumnWidth",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=i;return l===void 0&&(l=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(o)),a&&typeof l=="number"&&(l=Math.max(l,PE.DEFAULT_WIDTH))),l}},{key:"getFirstVisibleColumn",value:function(){var o=this.hot.view._wt;if(o.wtViewport.columnsVisibleCalculator){var i=o.wtTable.getFirstVisibleColumn();if(i!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)}if(o.wtViewport.columnsRenderCalculator){var a=o.wtTable.getFirstRenderedColumn();if(a!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(a)}return-1}},{key:"getLastVisibleColumn",value:function(){var o=this.hot.view._wt;if(o.wtViewport.columnsVisibleCalculator){var i=o.wtTable.getLastVisibleColumn();if(i!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)}if(o.wtViewport.columnsRenderCalculator){var a=o.wtTable.getLastRenderedColumn();if(a!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(a)}return-1}},{key:"findColumnsWhereHeaderWasChanged",value:function(){var o=this.hot.getColHeader(),i=Uw.get(this),a=i.cachedColumnHeaders,l=Lt(o,function(s,u,f){var c=a.length;return(c-1<f||a[f]!==u)&&s.push(f),c-1<f?a.push(u):a[f]=u,s},[]);return l}},{key:"clearCache",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];i.length?this.hot.batchExecution(function(){$(i,function(a){o.columnWidthsMap.setValueAtIndex(a,null)})},!0):this.columnWidthsMap.clear()}},{key:"isNeedRecalculate",value:function(){return!!jr(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),function(o){return o===null}).length}},{key:"onBeforeViewRender",value:function(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}},{key:"onAfterLoadData",value:function(){var o=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout(function(){o.hot&&o.recalculateAllColumnsWidth()},0)}},{key:"onBeforeChange",value:function(o){var i=this,a=Be(o,function(l){var s=Dx(l,2),u=s[1];return i.hot.toPhysicalColumn(i.hot.propToCol(u))});this.clearCache(Array.from(new Set(a)))}},{key:"onBeforeColumnResize",value:function(o,i,a){var l=o;return a&&(this.calculateColumnsWidth(i,void 0,!0),l=this.getColumnWidth(i,void 0,!1)),l}},{key:"onAfterInit",value:function(){Uw.get(this).cachedColumnHeaders=this.hot.getColHeader()}},{key:"onAfterFormulasValuesUpdate",value:function(o){var i=jr(o,function(l){var s;return ve((s=l.address)===null||s===void 0?void 0:s.col)}),a=Be(i,function(l){return l.address.col});this.clearCache(Array.from(new Set(a)))}},{key:"destroy",value:function(){this.ghostTable.clean(),ia(uo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Zf}},{key:"PLUGIN_PRIORITY",get:function(){return aEe}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 50}}]),r}(ot),aa={horizontal:"horizontal",vertical:"vertical"};function uEe(e,t,r,n){var o=r.length,i=r?r[0].length:0,a=[],l=t.row-e.row,s=t.col-e.col;if(["down","up"].indexOf(n)!==-1){for(var u=[],f=0;f<s;f++){var c=parseInt(r[0][f],10),h=parseInt(r[o-1][f],10),d=(n==="down"?h-c:c-h)/(o-1)||0;u.push(d)}a.push(u)}if(["right","left"].indexOf(n)!==-1)for(var v=0;v<l;v++){var g=parseInt(r[v][0],10),m=parseInt(r[v][i-1],10),w=(n==="right"?m-g:g-m)/(i-1)||0;a.push([w])}return a}function fEe(e,t,r){var n,o,i;return t[0]===e[0]&&t[1]<e[1]?(i="left",n=r(t[0],t[1]),o=r(t[2],e[1]-1)):t[2]===e[2]&&t[0]===e[0]&&t[3]>e[3]?(i="right",n=r(t[0],e[3]+1),o=r(t[2],t[3])):t[0]<e[0]&&t[1]===e[1]?(i="up",n=r(t[0],t[1]),o=r(e[0]-1,t[3])):t[2]>e[2]&&t[1]===e[1]&&(i="down",n=r(e[2]+1,t[1]),o=r(t[2],t[3])),n&&n.normalize(),o&&o.normalize(),{directionOfDrag:i,startOfDragCoords:n,endOfDragCoords:o}}function cEe(e){var t={};return e===!0?(t.directions=Object.keys(aa),t.autoInsertRow=!0):Ve(e)?(ve(e.autoInsertRow)?e.direction===aa.horizontal?t.autoInsertRow=!1:t.autoInsertRow=e.autoInsertRow:t.autoInsertRow=!1,ve(e.direction)?t.directions=[e.direction]:t.directions=Object.keys(aa)):typeof e=="string"?(t.directions=[e],t.autoInsertRow=!0):(t.directions=[],t.autoInsertRow=!1),t}function cu(e){"@babel/helpers - typeof";return cu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cu(e)}function hEe(e){return yEe(e)||vEe(e)||iU(e)||dEe()}function dEe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vEe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function yEe(e){if(Array.isArray(e))return vO(e)}function gEe(e,t){return bEe(e)||mEe(e,t)||iU(e,t)||pEe()}function pEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iU(e,t){if(e){if(typeof e=="string")return vO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vO(e,t)}}function vO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function mEe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function bEe(e){if(Array.isArray(e))return e}function wEe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Lx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,CEe(n.key),n)}}function SEe(e,t,r){return t&&Lx(e.prototype,t),r&&Lx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function CEe(e){var t=_Ee(e,"string");return cu(t)==="symbol"?t:String(t)}function _Ee(e,t){if(cu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function la(){return typeof Reflect<"u"&&Reflect.get?la=Reflect.get.bind():la=function(t,r,n){var o=OEe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},la.apply(this,arguments)}function OEe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=fo(e),e!==null););return e}function REe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yO(e,t)}function yO(e,t){return yO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},yO(e,t)}function EEe(e){var t=kEe();return function(){var n=fo(e),o;if(t){var i=fo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return TEe(this,o)}}function TEe(e,t){if(t&&(cu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return aU(e)}function aU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kEe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fo(e){return fo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},fo(e)}pe.getSingleton().register("modifyAutofillRange");pe.getSingleton().register("beforeAutofill");pe.getSingleton().register("afterAutofill");var jx="autofill",PEe=20,$Ee=["fillHandle"],AEe="insert_row_below",IEe=200,MEe=function(e){REe(r,e);var t=EEe(r);function r(n){var o;return wEe(this,r),o=t.call(this,n),o.eventManager=new Tt(aU(o)),o.addingStarted=!1,o.mouseDownOnCellCorner=!1,o.mouseDragOutside=!1,o.handleDraggedCells=0,o.directions=[],o.autoInsertRow=!1,o}return SEe(r,[{key:"isEnabled",value:function(){return this.hot.getSettings().fillHandle}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",function(i){return o.onAfterCellCornerMouseDown(i)}),this.addHook("afterOnCellCornerDblClick",function(i){return o.onCellCornerDblClick(i)}),this.addHook("beforeOnCellMouseOver",function(i,a){return o.onBeforeCellMouseOver(a)}),la(fo(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),la(fo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.clearMappedSettings(),la(fo(r.prototype),"disablePlugin",this).call(this)}},{key:"getSelectionData",value:function(){var o=this,i=this.hot.getSelectedRangeLast(),a=i.getTopStartCorner(),l=a.row,s=a.col,u=i.getBottomEndCorner(),f=u.row,c=u.col,h=this.hot.runHooks("modifyCopyableRange",[{startRow:l,startCol:s,endRow:f,endCol:c}]),d=[],v=[],g=[];return $(h,function(m){for(var w=m.startRow;w<=m.endRow;w+=1)d.indexOf(w)===-1&&d.push(w);for(var S=m.startCol;S<=m.endCol;S+=1)v.indexOf(S)===-1&&v.push(S)}),$(d,function(m){var w=[];$(v,function(S){w.push(o.hot.getCopyableData(m,S))}),g.push(w)}),g}},{key:"fillIn",value:function(){var o=this;if(this.hot.selection.highlight.getFill().isEmpty())return!1;var i=this.hot.selection.highlight.getFill().getVisualCorners(),a=gEe(i,4),l=a[0],s=a[1],u=a[2],f=a[3],c=this.hot.getSelectedRangeLast(),h=c.getTopStartCorner(),d=c.getBottomEndCorner();this.resetSelectionOfDraggedArea();var v=[h.row,h.col,d.row,d.col],g=this.hot.runHooks("modifyAutofillRange",[Math.min(h.row,l),Math.min(h.col,s),Math.max(d.row,u),Math.max(d.col,f)],v),m=fEe(v,g,function(P,y){return o.hot._createCellCoords(P,y)}),w=m.directionOfDrag,S=m.startOfDragCoords,C=m.endOfDragCoords;if(S&&S.row>-1&&S.col>-1){var k=this.getSelectionData(),R=c.clone(),V=this.hot._createCellRange(S,S,C),U=this.hot.runHooks("beforeAutofill",k,R,V,w);if(U===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;var X=uEe(S,C,k,w),Y=U,q=U;if(["up","left"].indexOf(w)>-1&&!(q.length===1&&q[0].length===0))if(Y=[],w==="up")for(var Z=C.row-S.row+1,ie=Z%q.length,J=0;J<Z;J++)Y.push(q[(J+(q.length-ie))%q.length]);else for(var le=C.col-S.col+1,Se=le%q[0].length,me=0;me<q.length;me++){Y.push([]);for(var Ce=0;Ce<le;Ce++)Y[me].push(q[me][(Ce+(q[me].length-Se))%q[me].length])}this.hot.populateFromArray(S.row,S.col,Y,C.row,C.col,"".concat(this.pluginName,".fill"),null,w,X),this.setSelection(g),this.hot.runHooks("afterAutofill",Y,R,V,w),this.hot.render()}else this.hot._refreshBorders();return!0}},{key:"reduceSelectionAreaIfNeeded",value:function(o){return o.row<0&&(o.row=0),o.col<0&&(o.col=0),o}},{key:"getCoordsOfDragAndDropBorders",value:function(o){var i=this.hot.getSelectedRangeLast(),a=i.getBottomEndCorner(),l=o;if(this.directions.includes(aa.vertical)&&this.directions.includes(aa.horizontal)){var s=i.getTopStartCorner();(a.col<=o.col||s.col>=o.col)&&(l=this.hot._createCellCoords(a.row,o.col)),(a.row<o.row||s.row>o.row)&&(l=this.hot._createCellCoords(o.row,a.col))}else if(this.directions.includes(aa.vertical))l=this.hot._createCellCoords(o.row,a.col);else if(this.directions.includes(aa.horizontal))l=this.hot._createCellCoords(a.row,o.col);else return;return this.reduceSelectionAreaIfNeeded(l)}},{key:"showBorder",value:function(o){var i=this.getCoordsOfDragAndDropBorders(o);i&&this.redrawBorders(i)}},{key:"addRow",value:function(){var o=this;this.hot._registerTimeout(function(){o.hot.alter(AEe,void 0,1,"".concat(o.pluginName,".fill")),o.addingStarted=!1},IEe)}},{key:"addNewRowIfNeeded",value:function(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){var o=this.hot.getSelectedLast(),i=this.hot.selection.highlight.getFill().getVisualCorners(),a=this.hot.countRows();o[2]<a-1&&i[2]===a-1&&(this.addingStarted=!0,this.addRow())}}},{key:"getIndexOfLastAdjacentFilledInRow",value:function(o){for(var i=this.hot.getData(),a=this.hot.countRows(),l,s=o[2]+1;s<a;s++){for(var u=o[1];u<=o[3];u++){var f=i[s][u];if(f)return-1}var c=i[s][o[1]-1],h=i[s][o[3]+1];(c||h)&&(l=s)}return l}},{key:"addSelectionFromStartAreaToSpecificRowIndex",value:function(o,i){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(o[0],o[1])).add(this.hot._createCellCoords(i,o[3])).commit()}},{key:"setSelection",value:function(o){var i;(i=this.hot).selectCell.apply(i,hEe(Be(o,function(a){return Math.max(a,0)})).concat([!1,!1]))}},{key:"selectAdjacent",value:function(){var o=this.hot.getSelectedLast(),i=this.getIndexOfLastAdjacentFilledInRow(o);return i===-1||i===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(o,i),!0)}},{key:"resetSelectionOfDraggedArea",value:function(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}},{key:"redrawBorders",value:function(o){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(o).commit(),this.hot.view.render()}},{key:"getIfMouseWasDraggedOutside",value:function(o){var i=this.hot.rootDocument.documentElement,a=Vt(this.hot.table).top-(this.hot.rootWindow.pageYOffset||i.scrollTop)+Rt(this.hot.table),l=Vt(this.hot.table).left-(this.hot.rootWindow.pageXOffset||i.scrollLeft)+dt(this.hot.table);return o.clientY>a&&o.clientX<=l}},{key:"registerEvents",value:function(){var o=this,i=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()}),this.eventManager.addEventListener(i,"mousemove",function(a){return o.onMouseMove(a)})}},{key:"onCellCornerDblClick",value:function(){var o=this.selectAdjacent();o&&this.fillIn()}},{key:"onAfterCellCornerMouseDown",value:function(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}},{key:"onBeforeCellMouseOver",value:function(o){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(o),this.addNewRowIfNeeded())}},{key:"onMouseUp",value:function(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}},{key:"onMouseMove",value:function(o){var i=this.getIfMouseWasDraggedOutside(o);this.addingStarted===!1&&this.handleDraggedCells>0&&i?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}},{key:"clearMappedSettings",value:function(){this.directions.length=0,this.autoInsertRow=!1}},{key:"mapSettings",value:function(){var o=cEe(this.hot.getSettings().fillHandle);this.directions=o.directions,this.autoInsertRow=o.autoInsertRow}},{key:"destroy",value:function(){la(fo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return jx}},{key:"PLUGIN_PRIORITY",get:function(){return PEe}},{key:"SETTING_KEYS",get:function(){return[jx].concat($Ee)}}]),r}(ot);function hu(e){"@babel/helpers - typeof";return hu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hu(e)}function xEe(e,t){return LEe(e)||HEe(e,t)||NEe(e,t)||DEe()}function DEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NEe(e,t){if(e){if(typeof e=="string")return Fx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Fx(e,t)}}function Fx(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function HEe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function LEe(e){if(Array.isArray(e))return e}function jEe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Bx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,BEe(n.key),n)}}function FEe(e,t,r){return t&&Bx(e.prototype,t),r&&Bx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function BEe(e){var t=VEe(e,"string");return hu(t)==="symbol"?t:String(t)}function VEe(e,t){if(hu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function es(){return typeof Reflect<"u"&&Reflect.get?es=Reflect.get.bind():es=function(t,r,n){var o=WEe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},es.apply(this,arguments)}function WEe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=gi(e),e!==null););return e}function UEe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gO(e,t)}function gO(e,t){return gO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},gO(e,t)}function zEe(e){var t=KEe();return function(){var n=gi(e),o;if(t){var i=gi(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return YEe(this,o)}}function YEe(e,t){if(t&&(hu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return GEe(e)}function GEe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function KEe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function gi(e){return gi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},gi(e)}var gy="autoRowSize",qEe=40,XEe="autoRowSize",ZEe=function(e){UEe(r,e);var t=zEe(r);function r(n){var o;return jEe(this,r),o=t.call(this,n),o.rowHeightsMap=void 0,o.headerHeight=null,o.ghostTable=new Ik(o.hot),o.samplesGenerator=new nU(function(i,a){var l;return i>=0?l=o.hot.getDataAtCell(i,a):i===-1&&(l=o.hot.getColHeader(a)),{value:l}}),o.firstCalculation=!0,o.inProgress=!1,o.measuredRows=0,o.rowHeightsMap=new Mi,o.hot.rowIndexMapper.registerMap(XEe,o.rowHeightsMap),o.addHook("beforeRowResize",function(i,a,l){return o.onBeforeRowResize(i,a,l)}),o}return FEe(r,[{key:"isEnabled",value:function(){var o=this.hot.getSettings()[gy];return o===!0||Ve(o)}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("beforeChangeRender",function(i){return o.onBeforeChange(i)}),this.addHook("beforeColumnResize",function(){return o.recalculateAllRowsHeight()}),this.addHook("beforeViewRender",function(i){return o.onBeforeViewRender(i)}),this.addHook("modifyRowHeight",function(i,a){return o.getRowHeight(a,i)}),this.addHook("modifyColumnHeaderHeight",function(){return o.getColumnHeaderHeight()}),es(gi(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var o=this;this.headerHeight=null,es(gi(r.prototype),"disablePlugin",this).call(this),this.addHook("beforeRowResize",function(i,a,l){return o.onBeforeRowResize(i,a,l)})}},{key:"calculateRowsHeight",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=typeof i=="number"?{from:i,to:i}:i,u=typeof a=="number"?{from:a,to:a}:a;if(this.hot.getColHeader(0)!==null){var f=this.samplesGenerator.generateRowSamples(-1,u);this.ghostTable.addColumnHeadersRow(f.get(-1))}_e(s.from,s.to,function(c){if(l||o.rowHeightsMap.getValueAtIndex(c)===null){var h=o.samplesGenerator.generateRowSamples(c,u);$(h,function(d){var v=xEe(d,2),g=v[0],m=v[1];return o.ghostTable.addRow(g,m)})}}),this.ghostTable.rows.length&&(this.hot.batchExecution(function(){o.ghostTable.getHeights(function(c,h){c<0?o.headerHeight=h:o.rowHeightsMap.setValueAtIndex(o.hot.toPhysicalRow(c),h)})},!0),this.measuredRows=s.to+1,this.ghostTable.clean())}},{key:"calculateAllRowsHeight",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},a=0,l=this.hot.countRows()-1,s=null;this.inProgress=!0;var u=function c(){if(!o.hot){jc(s),o.inProgress=!1;return}o.calculateRowsHeight({from:a,to:Math.min(a+r.CALCULATION_STEP,l)},i),a=a+r.CALCULATION_STEP+1,a<l?s=bm(c):(jc(s),o.inProgress=!1,o.hot.view.adjustElementsSize(!0),o.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&o.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},f=this.getSyncCalculationLimit();this.firstCalculation&&f>=0&&(this.calculateRowsHeight({from:0,to:f},i),this.firstCalculation=!1,a=f+1),a<l?u():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}},{key:"setSamplingOptions",value:function(){var o=this.hot.getSettings()[gy],i=o&&At(o,"samplingRatio")?o.samplingRatio:void 0,a=o&&At(o,"allowSampleDuplicates")?o.allowSampleDuplicates:void 0;i&&!isNaN(i)&&this.samplesGenerator.setSampleCount(parseInt(i,10)),a&&this.samplesGenerator.setAllowDuplicates(a)}},{key:"recalculateAllRowsHeight",value:function(){vs(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}},{key:"getSyncCalculationLimit",value:function(){var o=this.hot.getSettings()[gy],i=r.SYNC_CALCULATION_LIMIT,a=this.hot.countRows()-1;return Ve(o)&&(i=o.syncLimit,gE(i)?i=RE(a,i):i>>=0),Math.min(i,a)}},{key:"getRowHeight",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,a=o<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(o)),l=i;return a!==null&&a>(i||0)&&(l=a),l}},{key:"getColumnHeaderHeight",value:function(){return this.headerHeight}},{key:"getFirstVisibleRow",value:function(){var o=this.hot.view._wt;return o.wtViewport.rowsVisibleCalculator?o.wtTable.getFirstVisibleRow():o.wtViewport.rowsRenderCalculator?o.wtTable.getFirstRenderedRow():-1}},{key:"getLastVisibleRow",value:function(){var o=this.hot.view._wt;return o.wtViewport.rowsVisibleCalculator?o.wtTable.getLastVisibleRow():o.wtViewport.rowsRenderCalculator?o.wtTable.getLastRenderedRow():-1}},{key:"clearCache",value:function(){this.headerHeight=null,this.rowHeightsMap.init()}},{key:"clearCacheByRange",value:function(o){var i=this,a=typeof o=="number"?{from:o,to:o}:o,l=a.from,s=a.to;this.hot.batchExecution(function(){_e(Math.min(l,s),Math.max(l,s),function(u){i.rowHeightsMap.setValueAtIndex(u,null)})},!0)}},{key:"isNeedRecalculate",value:function(){return!!jr(this.rowHeightsMap.getValues().slice(0,this.measuredRows),function(o){return o===null}).length}},{key:"onBeforeViewRender",value:function(){var o=this.hot.renderCall,i=this.hot.getSettings().fixedRowsBottom,a=this.getFirstVisibleRow(),l=this.getLastVisibleRow();if(!(a===-1||l===-1)){if(this.calculateRowsHeight({from:a,to:l},void 0,o),i){var s=this.hot.countRows()-1;this.calculateRowsHeight({from:s-i,to:s})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}},{key:"onBeforeRowMove",value:function(o,i){this.clearCacheByRange({from:o,to:i}),this.calculateAllRowsHeight()}},{key:"onBeforeRowResize",value:function(o,i,a){var l=o;return a&&(this.calculateRowsHeight(i,void 0,!0),l=this.getRowHeight(i)),l}},{key:"onAfterLoadData",value:function(){var o=this;this.hot.view?this.recalculateAllRowsHeight():setTimeout(function(){o.hot&&o.recalculateAllRowsHeight()},0)}},{key:"onBeforeChange",value:function(o){var i=null;o.length===1?i=o[0][0]:o.length>1&&(i={from:o[0][0],to:o[o.length-1][0]}),i!==null&&this.clearCacheByRange(i)}},{key:"destroy",value:function(){this.ghostTable.clean(),es(gi(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return gy}},{key:"PLUGIN_PRIORITY",get:function(){return qEe}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 500}}]),r}(ot);function du(e){"@babel/helpers - typeof";return du=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},du(e)}function JEe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Vx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eTe(n.key),n)}}function QEe(e,t,r){return t&&Vx(e.prototype,t),r&&Vx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function eTe(e){var t=tTe(e,"string");return du(t)==="symbol"?t:String(t)}function tTe(e,t){if(du(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(du(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ac(){return typeof Reflect<"u"&&Reflect.get?Ac=Reflect.get.bind():Ac=function(t,r,n){var o=rTe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ac.apply(this,arguments)}function rTe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=za(e),e!==null););return e}function nTe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pO(e,t)}function pO(e,t){return pO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},pO(e,t)}function oTe(e){var t=lTe();return function(){var n=za(e),o;if(t){var i=za(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return iTe(this,o)}}function iTe(e,t){if(t&&(du(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return aTe(e)}function aTe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lTe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function za(e){return za=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},za(e)}var lU=cW("physicallyIndexed"),sTe=lU.getListWithInsertedItems,uTe=lU.getListWithRemovedItems,fTe=function(e){nTe(r,e);var t=oTe(r);function r(){return JEe(this,r),t.call(this,function(n){return n})}return QEe(r,[{key:"insert",value:function(o,i){var a=GE(this.indexedValues,i);this.indexedValues=sTe(a,o,i,this.initValueOrFn),Ac(za(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){var i=uTe(this.indexedValues,o);this.indexedValues=YE(i,o),Ac(za(r.prototype),"remove",this).call(this,o)}}]),r}(il);const cTe=fTe;function vu(e){"@babel/helpers - typeof";return vu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vu(e)}function hTe(e){return gTe(e)||yTe(e)||vTe(e)||dTe()}function dTe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vTe(e,t){if(e){if(typeof e=="string")return mO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mO(e,t)}}function yTe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function gTe(e){if(Array.isArray(e))return mO(e)}function mO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function pTe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Wx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bTe(n.key),n)}}function mTe(e,t,r){return t&&Wx(e.prototype,t),r&&Wx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bTe(e){var t=wTe(e,"string");return vu(t)==="symbol"?t:String(t)}function wTe(e,t){if(vu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ic(){return typeof Reflect<"u"&&Reflect.get?Ic=Reflect.get.bind():Ic=function(t,r,n){var o=STe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ic.apply(this,arguments)}function STe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ya(e),e!==null););return e}function CTe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bO(e,t)}function bO(e,t){return bO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},bO(e,t)}function _Te(e){var t=ETe();return function(){var n=Ya(e),o;if(t){var i=Ya(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return OTe(this,o)}}function OTe(e,t){if(t&&(vu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return RTe(e)}function RTe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ETe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ya(e){return Ya=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ya(e)}var sU=cW("physicallyIndexed"),TTe=sU.getListWithInsertedItems,kTe=sU.getListWithRemovedItems,PTe=function(e){CTe(r,e);var t=_Te(r);function r(){return pTe(this,r),t.call(this,function(n){return n})}return mTe(r,[{key:"insert",value:function(o,i){var a=this;this.indexedValues=TTe(this.indexedValues,o,i,function(l,s){return a.getNextValue(s)}),Ic(Ya(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){this.indexedValues=kTe(this.indexedValues,o),Ic(Ya(r.prototype),"remove",this).call(this,o)}},{key:"getNextValue",value:function(o){return Math.max.apply(Math,hTe(this.getValues()))+1+o}}]),r}(il);const $Te=PTe;function yu(e){"@babel/helpers - typeof";return yu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yu(e)}function ATe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ux(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,MTe(n.key),n)}}function ITe(e,t,r){return t&&Ux(e.prototype,t),r&&Ux(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function MTe(e){var t=xTe(e,"string");return yu(t)==="symbol"?t:String(t)}function xTe(e,t){if(yu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ts(){return typeof Reflect<"u"&&Reflect.get?ts=Reflect.get.bind():ts=function(t,r,n){var o=DTe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ts.apply(this,arguments)}function DTe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=pi(e),e!==null););return e}function NTe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wO(e,t)}function wO(e,t){return wO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},wO(e,t)}function HTe(e){var t=FTe();return function(){var n=pi(e),o;if(t){var i=pi(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return LTe(this,o)}}function LTe(e,t){if(t&&(yu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jTe(e)}function jTe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function FTe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function pi(e){return pi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},pi(e)}var zw="bindRowsWithHeaders",BTe=210,VTe="loose",WTe=new Map([["loose",cTe],["strict",$Te]]),UTe=function(e){NTe(r,e);var t=HTe(r);function r(n){var o;return ATe(this,r),o=t.call(this,n),o.headerIndexes=null,o}return ITe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[zw]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[zw];typeof i!="string"&&(i=VTe);var a=WTe.get(i);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new a),this.addHook("modifyRowHeader",function(l){return o.onModifyRowHeader(l)}),ts(pi(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),ts(pi(r.prototype),"disablePlugin",this).call(this)}},{key:"onModifyRowHeader",value:function(o){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(o))}},{key:"destroy",value:function(){ts(pi(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return zw}},{key:"PLUGIN_PRIORITY",get:function(){return BTe}}]),r}(ot);function gu(e){"@babel/helpers - typeof";return gu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gu(e)}function zx(e){return KTe(e)||GTe(e)||YTe(e)||zTe()}function zTe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function YTe(e,t){if(e){if(typeof e=="string")return SO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return SO(e,t)}}function GTe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function KTe(e){if(Array.isArray(e))return SO(e)}function SO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function qTe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Yx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uU(n.key),n)}}function XTe(e,t,r){return t&&Yx(e.prototype,t),r&&Yx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sa(){return typeof Reflect<"u"&&Reflect.get?sa=Reflect.get.bind():sa=function(t,r,n){var o=ZTe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},sa.apply(this,arguments)}function ZTe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=co(e),e!==null););return e}function JTe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&CO(e,t)}function CO(e,t){return CO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},CO(e,t)}function QTe(e){var t=tke();return function(){var n=co(e),o;if(t){var i=co(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return eke(this,o)}}function eke(e,t){if(t&&(gu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Wl(e)}function Wl(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tke(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function co(e){return co=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},co(e)}function rke(e,t,r){nke(e,t),t.set(e,r)}function nke(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yw(e,t,r){return t=uU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uU(e){var t=oke(e,"string");return gu(t)==="symbol"?t:String(t)}function oke(e,t){if(gu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gx(e,t){var r=fU(e,t,"get");return ike(e,r)}function ike(e,t){return t.get?t.get.call(e):t.value}function Gw(e,t,r){var n=fU(e,t,"set");return ake(e,n,r),r}function fU(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function ake(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Kw="collapsibleColumns",lke=290,ske=["nestedHeaders"],Sl="collapsibleIndicator",Kx=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]),Cl=new WeakMap,uke=function(e){JTe(r,e);var t=QTe(r);function r(){var n;qTe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),Yw(Wl(n),"nestedHeadersPlugin",null),Yw(Wl(n),"eventManager",new Tt(Wl(n))),Yw(Wl(n),"headerStateManager",null),rke(Wl(n),Cl,{writable:!0,value:null}),n}return XTe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Kw]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings(),a=i.nestedHeaders;a||ht("You need to configure the Nested Headers plugin in order to use collapsible headers."),Gw(this,Cl,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",function(){return o.onInit()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("afterGetColHeader",function(){return o.onAfterGetColHeader.apply(o,arguments)}),this.addHook("beforeOnCellMouseDown",function(l,s,u){return o.onBeforeOnCellMouseDown(l,s,u)}),sa(co(r.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){var o=this.hot.getSettings(),i=o.collapsibleColumns;typeof i=="boolean"?this.headerStateManager.mapState(function(a){return{collapsible:a.origColspan>1}}):Array.isArray(i)&&(this.headerStateManager.mapState(function(){return{collapsible:!1}}),this.headerStateManager.mergeStateWith(i))}sa(co(r.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Gw(this,Cl,null),this.nestedHeadersPlugin=null,this.clearButtons(),sa(co(r.prototype),"disablePlugin",this).call(this)}},{key:"clearButtons",value:function(){if(this.hot.view){var o=this.hot.view._wt.getSetting("columnHeaders").length,i=this.hot.view._wt.wtTable.THEAD,a=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,l=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,s=function(f){f&&f.parentNode.removeChild(f)};_e(0,o-1,function(u){var f=i.childNodes[u],c=a.childNodes[u],h=l?l.childNodes[u]:null;_e(0,f.childNodes.length-1,function(d){var v=f.childNodes[d].querySelector(".".concat(Sl));s(v),c&&c.childNodes[d]&&(v=c.childNodes[d].querySelector(".".concat(Sl)),s(v)),l&&h&&h.childNodes[d]&&(v=h.childNodes[d].querySelector(".".concat(Sl)),s(v))})})}}},{key:"expandSection",value:function(o){this.toggleCollapsibleSection([o],"expand")}},{key:"collapseSection",value:function(o){this.toggleCollapsibleSection([o],"collapse")}},{key:"toggleAllCollapsibleSections",value:function(o){var i=this,a=this.headerStateManager.mapNodes(function(l){var s=l.collapsible,u=l.origColspan,f=l.headerLevel,c=l.columnIndex,h=l.isCollapsed;if(s===!0&&u>1&&(h&&o==="expand"||!h&&o==="collapse"))return{row:i.headerStateManager.levelToRowCoords(f),col:c}});this.toggleCollapsibleSection(a,o)}},{key:"collapseAll",value:function(){this.toggleAllCollapsibleSections("collapse")}},{key:"expandAll",value:function(){this.toggleAllCollapsibleSections("expand")}},{key:"toggleCollapsibleSection",value:function(o,i){var a=this;if(!Kx.has(i))throw new Error("Unsupported action is passed (".concat(i,")."));if(Array.isArray(o)){var l=jr(o,function(m){var w=m.row;return w<0}),s=l.length>0;$(l,function(m){var w,S=m.row,C=m.col,k=(w=a.headerStateManager.getHeaderSettings(S,C))!==null&&w!==void 0?w:{},R=k.collapsible,V=k.isCollapsed;if(!R||V&&i==="collapse"||!V&&i==="expand")return s=!1,!1});var u=[],f=[];s&&$(l,function(m){var w=m.row,S=m.col,C=a.headerStateManager.triggerNodeModification(i,w,S),k=C.colspanCompensation,R=C.affectedColumns,V=C.rollbackModification;k>0&&(f.push.apply(f,zx(R)),u.push(V))});var c=this.getCollapsedColumns(),h=[];i==="collapse"?h=U0([].concat(zx(c),f)):i==="expand"&&(h=jr(c,function(m){return!f.includes(m)}));var d=Kx.get(i),v=this.hot.runHooks(d.beforeHook,c,h,s);if(v===!1){$(u,function(m){m()});return}this.hot.batchExecution(function(){$(f,function(m){Gx(a,Cl).setValueAtIndex(a.hot.toPhysicalColumn(m),d.hideColumn)})},!0);var g=this.getCollapsedColumns().length!==c.length;this.hot.runHooks(d.afterHook,c,h,s,g),this.hot.render(),this.hot.view.adjustElementsSize(!0)}}},{key:"getCollapsedColumns",value:function(){return Gx(this,Cl).getHiddenIndexes()}},{key:"onAfterGetColHeader",value:function(o,i,a){var l,s=(l=this.headerStateManager.getHeaderSettings(a,o))!==null&&l!==void 0?l:{},u=s.collapsible,f=s.origColspan,c=s.isCollapsed,h=u&&f>1&&o>=this.hot.getSettings().fixedColumnsStart,d=i.querySelector(".".concat(Sl));if(h)d||(d=this.hot.rootDocument.createElement("div"),re(d,Sl),i.querySelector("div:first-child").appendChild(d)),Le(d,["collapsed","expanded"]),c?(re(d,"collapsed"),Ei(d,"+")):(re(d,"expanded"),Ei(d,"-"));else{var v;(v=d)===null||v===void 0||v.remove()}}},{key:"onBeforeOnCellMouseDown",value:function(o,i){xe(o.target,Sl)&&(xe(o.target,"expanded")?(this.eventManager.fireEvent(o.target,"mouseup"),this.toggleCollapsibleSection([i],"collapse")):xe(o.target,"collapsed")&&(this.eventManager.fireEvent(o.target,"mouseup"),this.toggleCollapsibleSection([i],"expand")),pn(o))}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(o,i){i||this.updatePlugin()}},{key:"destroy",value:function(){Gw(this,Cl,null),sa(co(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Kw}},{key:"PLUGIN_PRIORITY",get:function(){return lke}},{key:"PLUGIN_DEPS",get:function(){return["plugin:NestedHeaders"]}},{key:"SETTING_KEYS",get:function(){return[Kw].concat(ske)}}]),r}(ot);function ed(e){"@babel/helpers - typeof";return ed=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ed(e)}function qx(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function fke(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?qx(Object(r),!0).forEach(function(n){cke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qx(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function cke(e,t,r){return t=cU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Xx(e,t){return yke(e)||vke(e,t)||dke(e,t)||hke()}function hke(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dke(e,t){if(e){if(typeof e=="string")return Zx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Zx(e,t)}}function Zx(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function vke(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function yke(e){if(Array.isArray(e))return e}function gke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Jx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cU(n.key),n)}}function pke(e,t,r){return t&&Jx(e.prototype,t),r&&Jx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cU(e){var t=mke(e,"string");return ed(t)==="symbol"?t:String(t)}function mke(e,t){if(ed(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ed(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bke=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],wke=!1,Ske=!0,Cke=!0,_ke=function(){function e(t,r){gke(this,e),this.hot=t,this.sortingStates=new Vm,this.sortEmptyCells=wke,this.indicator=Ske,this.headerAction=Cke,this.compareFunctionFactory=void 0,this.mapName=r,this.hot.columnIndexMapper.registerMap(r,this.sortingStates)}return pke(e,[{key:"updateAllColumnsProperties",value:function(r){var n=this;Ve(r)&&We(r,function(o,i){bke.includes(i)&&(n[i]=o)})}},{key:"getAllColumnsProperties",value:function(){var r={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(r.compareFunctionFactory=this.compareFunctionFactory),r}},{key:"getSortOrderOfColumn",value:function(r){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(r)))===null||n===void 0?void 0:n.sortOrder}},{key:"getIndexOfColumnInSortQueue",value:function(r){return r=this.hot.toPhysicalColumn(r),this.sortingStates.getEntries().findIndex(function(n){var o=Xx(n,1),i=o[0];return i===r})}},{key:"getNumberOfSortedColumns",value:function(){return this.sortingStates.getLength()}},{key:"isListOfSortedColumnsEmpty",value:function(){return this.getNumberOfSortedColumns()===0}},{key:"isColumnSorted",value:function(r){return Ve(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(r)))}},{key:"getSortStates",value:function(){var r=this;if(this.sortingStates===null)return[];var n=this.sortingStates.getEntries();return n.map(function(o){var i=Xx(o,2),a=i[0],l=i[1];return fke({column:r.hot.toVisualColumn(a)},l)})}},{key:"getColumnSortState",value:function(r){var n=this.getSortOrderOfColumn(r);if(ve(n))return{column:r,sortOrder:n}}},{key:"setSortStates",value:function(r){this.sortingStates.clear();for(var n=0;n<r.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(r[n].column),{sortOrder:r[n].sortOrder})}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}]),e}(),xp="asc",Dp="desc",Oke="colHeader";function Rke(e){if(Ve(e)===!1)return!1;var t=e.column,r=e.sortOrder;return Number.isInteger(t)&&[xp,Dp].includes(r)}function Eke(e){if(e.some(function(r){return Rke(r)===!1}))return!1;var t=e.map(function(r){var n=r.column;return n});return new Set(t).size===t.length}function Qx(e){if(e!==Dp)return e===xp?Dp:xp}function eD(e){var t=e.querySelector(".".concat(Oke));return t}function tD(e,t){if(e<0||!t.parentNode)return!1;var r=t.parentNode.parentNode.childNodes,n=Array.from(r).indexOf(t.parentNode)-r.length;return n===-1}function _O(e,t,r){return e===-1&&t>=0&&ki(r)===!1}var Tke="ascending",kke="descending",hU="indicatorDisabled",dU="columnSorting",vU="sortAction",yU=new Map([[xp,Tke],[Dp,kke]]);function Pke(e,t,r,n){var o=[dU];if(n&&o.push(vU),r===!1)return o.push(hU),o;var i=e.getSortOrderOfColumn(t);return ve(i)&&o.push(yU.get(i)),o}function $ke(){return Array.from(yU.values()).concat(vU,hU,dU)}function gU(e,t,r){var n=t.locale;return function(o,i){var a=r.sortEmptyCells;return typeof o=="string"&&(o=o.toLocaleLowerCase(n)),typeof i=="string"&&(i=i.toLocaleLowerCase(n)),o===i?Hn:Kt(o)?Kt(i)?Hn:a&&e==="asc"?Pt:$t:Kt(i)?a&&e==="asc"?$t:Pt:isNaN(o)&&!isNaN(i)?e==="asc"?$t:Pt:!isNaN(o)&&isNaN(i)||(isNaN(o)||isNaN(i)||(o=parseFloat(o),i=parseFloat(i)),o<i)?e==="asc"?Pt:$t:o>i?e==="asc"?$t:Pt:Hn}}var pU="default";function Ake(e,t,r){return function(n,o){var i=parseFloat(n),a=parseFloat(o),l=r.sortEmptyCells;if(i===a||isNaN(i)&&isNaN(a))return Hn;if(l){if(Kt(n))return e==="asc"?Pt:$t;if(Kt(o))return e==="asc"?$t:Pt}return isNaN(i)?$t:isNaN(a)?Pt:i<a?e==="asc"?Pt:$t:i>a?e==="asc"?$t:Pt:Hn}}var Ike="numeric";function Mke(e,t,r){var n=t.checkedTemplate,o=t.uncheckedTemplate,i=r.sortEmptyCells;return function(a,l){var s=Kt(a),u=Kt(l),f=s?o:a,c=u?o:l,h=f===o||f===n,d=c===o||c===n;if(i===!1){if(s&&u===!1)return $t;if(s===!1&&u)return Pt}return h===!1&&d?e==="asc"?Pt:$t:h&&d===!1?e==="asc"?$t:Pt:h===!1&&d===!1?gU(e,t,r)(a,l):f===o&&c===n?e==="asc"?Pt:$t:f===n&&c===o?e==="asc"?$t:Pt:Hn}}var xke="checkbox";function Dke(e,t,r){return function(n,o){var i=r.sortEmptyCells;if(n===o)return Hn;if(Kt(n))return Kt(o)?Hn:i&&e==="asc"?Pt:$t;if(Kt(o))return i&&e==="asc"?$t:Pt;var a=t.dateFormat,l=te(n,a),s=te(o,a);return l.isValid()?s.isValid()?s.isAfter(l)?e==="asc"?Pt:$t:s.isBefore(l)?e==="asc"?$t:Pt:Hn:Pt:$t}}var Nke="date",Mk=en("sorting.compareFunctionFactory"),Jm=Mk.register,rD=Mk.getItem,Hke=Mk.hasItem,mU=en("sorting.mainSortComparator"),bU=mU.register,Lke=mU.getItem;function wU(e){return Hke(e)?rD(e):rD(pU)}Jm(Ike,Ake);Jm(xke,Mke);Jm(Nke,Dke);Jm(pU,gU);var Hn=0,Pt=-1,$t=1;function jke(e,t){for(var r=Lke(t),n=arguments.length,o=new Array(n>2?n-2:0),i=2;i<n;i++)o[i-2]=arguments[i];e.sort(r.apply(void 0,o))}function nD(e){return Wke(e)||Vke(e)||Bke(e)||Fke()}function Fke(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Bke(e,t){if(e){if(typeof e=="string")return oD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return oD(e,t)}}function oD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Vke(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Wke(e){if(Array.isArray(e))return e}function Uke(e,t){return function(r,n){var o=nD(r),i=o.slice(1),a=nD(n),l=a.slice(1);return function(u){var f=e[u],c=t[u],h=i[u],d=l[u],v=c.columnSorting,g=v.compareFunctionFactory?v.compareFunctionFactory:wU(c.type),m=g(f,c,v)(h,d);return m}(0)}}function pu(e){"@babel/helpers - typeof";return pu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pu(e)}var zke=["column"],Yke=["column"];function _l(e){return Xke(e)||qke(e)||Kke(e)||Gke()}function Gke(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Kke(e,t){if(e){if(typeof e=="string")return OO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return OO(e,t)}}function qke(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Xke(e){if(Array.isArray(e))return OO(e)}function OO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function iD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function aD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?iD(Object(r),!0).forEach(function(n){Zke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):iD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Zke(e,t,r){return t=SU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lD(e,t){if(e==null)return{};var r=Jke(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Jke(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function Qke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,SU(n.key),n)}}function ePe(e,t,r){return t&&sD(e.prototype,t),r&&sD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function SU(e){var t=tPe(e,"string");return pu(t)==="symbol"?t:String(t)}function tPe(e,t){if(pu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ua(){return typeof Reflect<"u"&&Reflect.get?ua=Reflect.get.bind():ua=function(t,r,n){var o=rPe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ua.apply(this,arguments)}function rPe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ho(e),e!==null););return e}function nPe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&RO(e,t)}function RO(e,t){return RO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},RO(e,t)}function oPe(e){var t=lPe();return function(){var n=ho(e),o;if(t){var i=ho(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return iPe(this,o)}}function iPe(e,t){if(t&&(pu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return aPe(e)}function aPe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lPe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ho(e){return ho=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ho(e)}var EO="columnSorting",sPe=50,uD="append",uPe="replace";bU(EO,Uke);pe.getSingleton().register("beforeColumnSort");pe.getSingleton().register("afterColumnSort");var CU=function(e){nPe(r,e);var t=oPe(r);function r(n){var o;return Qke(this,r),o=t.call(this,n),o.columnStatesManager=null,o.columnMetaCache=null,o.pluginKey=EO,o.indexesSequenceCache=null,o}return ePe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[this.pluginKey]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.columnStatesManager=new _ke(this.hot,"".concat(this.pluginKey,".sortingStates")),this.columnMetaCache=new Mi(function(i){var a=o.hot.toVisualColumn(i);return a===null&&(a=i),o.getMergedPluginSettings(a)}),this.hot.columnIndexMapper.registerMap("".concat(this.pluginKey,".columnMeta"),this.columnMetaCache),this.addHook("afterGetColHeader",function(i,a){return o.onAfterGetColHeader(i,a)}),this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("afterOnCellMouseDown",function(i,a){return o.onAfterOnCellMouseDown(i,a)}),this.addHook("afterInit",function(){return o.loadOrSortBySettings()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.hot.view&&this.loadOrSortBySettings(),ua(ho(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var o=this,i=function(l,s){var u=eD(s);tD(l,s)===!1||u===null||o.updateHeaderClasses(u)};this.hot.addHook("afterGetColHeader",i),this.hot.addHookOnce("afterViewRender",function(){o.hot.removeHook("afterGetColHeader",i)}),this.hot.batchExecution(function(){o.indexesSequenceCache!==null&&(o.hot.rowIndexMapper.setIndexesSequence(o.indexesSequenceCache.getValues()),o.hot.rowIndexMapper.unregisterMap(o.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap("".concat(this.pluginKey,".columnMeta")),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,ua(ho(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(o){var i=this.getSortConfig(),a=this.getNormalizedSortConfigs(o),l=this.areValidSortConfigs(a),s=this.hot.runHooks("beforeColumnSort",i,a,l);s!==!1&&(i.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new hW),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),l&&(this.columnStatesManager.setSortStates(a),this.sortByPresetSortStates(a),this.saveAllSortSettings(a)),this.hot.runHooks("afterColumnSort",i,l?a:i,l),l&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}},{key:"clearSort",value:function(){this.sort([])}},{key:"isSorted",value:function(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}},{key:"getSortConfig",value:function(o){return ve(o)?this.columnStatesManager.getColumnSortState(o):this.columnStatesManager.getSortStates()}},{key:"setSortConfig",value:function(o){var i=this.getNormalizedSortConfigs(o);this.areValidSortConfigs(i)&&this.columnStatesManager.setSortStates(i)}},{key:"getNormalizedSortConfigs",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(o)?o.slice(0,1):[o]}},{key:"areValidSortConfigs",value:function(o){var i=this.hot.countCols();return Eke(o)&&o.every(function(a){var l=a.column;return l<=i&&l>=0})}},{key:"saveAllSortSettings",value:function(o){var i=this,a=this.columnStatesManager.getAllColumnsProperties(),l=function(u){var f=u.column,c=lD(u,zke);return aD({column:i.hot.toPhysicalColumn(f)},c)};a.initialConfig=Be(o,l),this.hot.runHooks("persistentStateSave","columnSorting",a)}},{key:"getAllSavedSortSettings",value:function(){var o=this,i={};this.hot.runHooks("persistentStateLoad","columnSorting",i);var a=i.value,l=function(u){var f=u.column,c=lD(u,Yke);return aD({column:o.hot.toVisualColumn(f)},c)};return ve(a)&&Array.isArray(a.initialConfig)&&(a.initialConfig=Be(a.initialConfig,l)),a}},{key:"getColumnNextConfig",value:function(o){var i=this.columnStatesManager.getSortOrderOfColumn(o);if(ve(i)){var a=Qx(i);return ve(a)?{column:o,sortOrder:a}:void 0}var l=this.hot.countCols();if(Number.isInteger(o)&&o>=0&&o<l)return{column:o,sortOrder:Qx()}}},{key:"getNextSortConfig",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:uD,a=this.columnStatesManager.getIndexOfColumnInSortQueue(o),l=a!==-1,s=this.getSortConfig(),u=this.getColumnNextConfig(o);if(l){if(gt(u))return[].concat(_l(s.slice(0,a)),_l(s.slice(a+1)));if(i===uD)return[].concat(_l(s.slice(0,a)),_l(s.slice(a+1)),[u]);if(i===uPe)return[].concat(_l(s.slice(0,a)),[u],_l(s.slice(a+1)))}return ve(u)?s.concat(u):s}},{key:"getPluginColumnConfig",value:function(o){if(Ve(o)){var i=o[this.pluginKey];if(Ve(i))return i}return{}}},{key:"getMergedPluginSettings",value:function(o){var i=this.hot.getSettings()[this.pluginKey],a=this.columnStatesManager.getAllColumnsProperties(),l=this.hot.getCellMeta(0,o),s=Object.getPrototypeOf(l);return Array.isArray(s.columns)?Object.assign(a,i,this.getPluginColumnConfig(s.columns[o])):bt(s.columns)?Object.assign(a,i,this.getPluginColumnConfig(s.columns(o))):Object.assign(a,i)}},{key:"getFirstCellSettings",value:function(o){var i=this.hot.getCellMeta(0,o),a=Object.create(i);return a[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(o)),a}},{key:"getNumberOfRowsToSort",value:function(o){var i=this.hot.getSettings();return i.maxRows<=o?i.maxRows:o-i.minSpareRows}},{key:"sortByPresetSortStates",value:function(o){var i=this;if(o.length===0){this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());return}for(var a=[],l=this.hot.countRows(),s=function(m){return Be(o,function(w){return i.hot.getDataAtCell(m,w.column)})},u=0;u<this.getNumberOfRowsToSort(l);u+=1)a.push([this.hot.toPhysicalRow(u)].concat(s(u)));var f=Be(a,function(g){return g[0]});jke(a,this.pluginKey,Be(o,function(g){return g.sortOrder}),Be(o,function(g){return i.getFirstCellSettings(g.column)}));for(var c=a.length;c<l;c+=1)a.push([c].concat(s(c)));var h=Be(a,function(g){return g[0]}),d=new Map(Be(f,function(g,m){return[g,h[m]]})),v=Be(this.hot.rowIndexMapper.getIndexesSequence(),function(g){return d.has(g)?d.get(g):g});this.hot.rowIndexMapper.setIndexesSequence(v)}},{key:"loadOrSortBySettings",value:function(){var o=this.getAllSavedSortSettings();if(Ve(o))this.sortBySettings(o);else{var i=this.hot.getSettings()[this.pluginKey];this.sortBySettings(i)}}},{key:"sortBySettings",value:function(o){if(Ve(o)){this.columnStatesManager.updateAllColumnsProperties(o);var i=o.initialConfig;(Array.isArray(i)||Ve(i))&&this.sort(i)}else this.hot.render()}},{key:"onAfterGetColHeader",value:function(o,i){var a=eD(i);if(!(tD(o,i)===!1||a===null)){var l=this.getFirstCellSettings(o)[this.pluginKey],s=l.indicator,u=l.headerAction;this.updateHeaderClasses(a,this.columnStatesManager,o,s,u)}}},{key:"updateHeaderClasses",value:function(o){if(Le(o,$ke()),this.enabled!==!1){for(var i=arguments.length,a=new Array(i>1?i-1:0),l=1;l<i;l++)a[l-1]=arguments[l];re(o,Pke.apply(void 0,a))}}},{key:"onUpdateSettings",value:function(o){ua(ho(r.prototype),"onUpdateSettings",this).call(this),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),ve(o[this.pluginKey])&&this.sortBySettings(o[this.pluginKey])}},{key:"onAfterLoadData",value:function(o){o===!0&&this.hot.view&&this.loadOrSortBySettings()}},{key:"wasClickableHeaderClicked",value:function(o,i){var a=this.getFirstCellSettings(i)[this.pluginKey],l=a.headerAction;return l&&o.target.nodeName==="SPAN"}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,l){_O(i.row,i.col,o)!==!1&&this.wasClickableHeaderClicked(o,i.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(l.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(o,i){_O(i.row,i.col,o)!==!1&&this.wasClickableHeaderClicked(o,i.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(i.col)),this.sort(this.getColumnNextConfig(i.col)))}},{key:"destroy",value:function(){var o;(o=this.columnStatesManager)===null||o===void 0||o.destroy(),ua(ho(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return EO}},{key:"PLUGIN_PRIORITY",get:function(){return sPe}}]),r}(ot),fPe=Ae,xk=Ue,cPe=Ii,hPe=PF,dPe=K0,fD=je,vPe=RangeError,_U=String,OU=Math.floor,TO=xk(dPe),cD=xk("".slice),Jf=xk(1 .toFixed),Kl=function(e,t,r){return t===0?r:t%2===1?Kl(e,t-1,r*e):Kl(e*e,t/2,r)},yPe=function(e){for(var t=0,r=e;r>=4096;)t+=12,r/=4096;for(;r>=2;)t+=1,r/=2;return t},Ol=function(e,t,r){for(var n=-1,o=r;++n<6;)o+=t*e[n],e[n]=o%1e7,o=OU(o/1e7)},qw=function(e,t){for(var r=6,n=0;--r>=0;)n+=e[r],e[r]=OU(n/t),n=n%t*1e7},hD=function(e){for(var t=6,r="";--t>=0;)if(r!==""||t===0||e[t]!==0){var n=_U(e[t]);r=r===""?n:r+TO("0",7-n.length)+n}return r},gPe=fD(function(){return Jf(8e-5,3)!=="0.000"||Jf(.9,0)!=="1"||Jf(1.255,2)!=="1.25"||Jf(0xde0b6b3a7640080,0)!=="1000000000000000128"})||!fD(function(){Jf({})});fPe({target:"Number",proto:!0,forced:gPe},{toFixed:function(t){var r=hPe(this),n=cPe(t),o=[0,0,0,0,0,0],i="",a="0",l,s,u,f;if(n<0||n>20)throw new vPe("Incorrect fraction digits");if(r!==r)return"NaN";if(r<=-1e21||r>=1e21)return _U(r);if(r<0&&(i="-",r=-r),r>1e-21)if(l=yPe(r*Kl(2,69,1))-69,s=l<0?r*Kl(2,-l,1):r/Kl(2,l,1),s*=4503599627370496,l=52-l,l>0){for(Ol(o,0,s),u=n;u>=7;)Ol(o,1e7,0),u-=7;for(Ol(o,Kl(10,u,1),0),u=l-1;u>=23;)qw(o,1<<23),u-=23;qw(o,1<<u),Ol(o,1,1),qw(o,2),a=hD(o)}else Ol(o,0,s),Ol(o,1<<-l,0),a=hD(o)+TO("0",n);return n>0?(f=a.length,a=i+(f<=n?"0."+TO("0",n-f)+a:cD(a,0,f-n)+"."+cD(a,f-n))):a=i+a,a}});function td(e){"@babel/helpers - typeof";return td=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},td(e)}function pPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bPe(n.key),n)}}function mPe(e,t,r){return t&&dD(e.prototype,t),r&&dD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bPe(e){var t=wPe(e,"string");return td(t)==="symbol"?t:String(t)}function wPe(e,t){if(td(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(td(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var SPe=function(){function e(t,r){pPe(this,e),this.plugin=t,this.hot=this.plugin.hot,this.endpoints=[],this.settings=r,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[]}return mPe(e,[{key:"getEndpoint",value:function(r){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[r]:this.endpoints[r]}},{key:"getAllEndpoints",value:function(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}},{key:"fillMissingEndpointData",value:function(r){return this.parseSettings(r.call(this))}},{key:"parseSettings",value:function(r){var n=this,o=[],i=r;if(!i&&typeof this.settings=="function"){this.settingsType="function";return}return i||(i=this.settings),$(i,function(a){var l={};n.assignSetting(a,l,"ranges",[[0,n.hot.countRows()-1]]),n.assignSetting(a,l,"reversedRowCoords",!1),n.assignSetting(a,l,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),n.assignSetting(a,l,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),n.assignSetting(a,l,"sourceColumn",a.destinationColumn),n.assignSetting(a,l,"type","sum"),n.assignSetting(a,l,"forceNumeric",!1),n.assignSetting(a,l,"suppressDataTypeErrors",!0),n.assignSetting(a,l,"suppressDataTypeErrors",!0),n.assignSetting(a,l,"customFunction",null),n.assignSetting(a,l,"readOnly",!0),n.assignSetting(a,l,"roundFloat",!1),o.push(l)}),o}},{key:"assignSetting",value:function(r,n,o,i){if(o==="ranges"&&r[o]===void 0){n[o]=i;return}else if(o==="ranges"&&r[o].length===0)return;if(r[o]===void 0){if(i instanceof Error)throw i;n[o]=i}else o==="destinationRow"&&n.reversedRowCoords?n[o]=this.hot.countRows()-r[o]-1:n[o]=r[o]}},{key:"resetSetupBeforeStructureAlteration",value:function(r,n,o){if(this.settingsType==="function"){var i=r.indexOf("row")>-1?"row":"col",a=this.getAllEndpoints();$(a,function(l){i==="row"&&l.destinationRow>=n&&(r==="insert_row"?l.alterRowOffset=o:r==="remove_row"&&(l.alterRowOffset=-1*o)),i==="col"&&l.destinationColumn>=n&&(r==="insert_col"?l.alterColumnOffset=o:r==="remove_col"&&(l.alterColumnOffset=-1*o))}),this.resetAllEndpoints(a,!1)}}},{key:"resetSetupAfterStructureAlteration",value:function(r,n,o,i,a){var l=this,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){var u=function g(){return l.hot.removeHook("beforeViewRender",g),l.refreshAllEndpoints()};this.hot.addHookOnce("beforeViewRender",u);return}var f=r.indexOf("row")>-1?"row":"col",c=r.indexOf("remove")>-1?-1:1,h=this.getAllEndpoints(),d=r.indexOf("move_row")===0,v=n;$(h,function(g){f==="row"&&g.destinationRow>=v&&(g.alterRowOffset=c*o),f==="col"&&g.destinationColumn>=v&&(g.alterColumnOffset=c*o)}),this.resetAllEndpoints(h,!d),d?$(h,function(g){l.extendEndpointRanges(g,v,i[0],i.length),l.recreatePhysicalRanges(g),l.clearOffsetInformation(g)}):$(h,function(g){l.shiftEndpointCoordinates(g,v)}),s&&this.refreshAllEndpoints()}},{key:"clearOffsetInformation",value:function(r){r.alterRowOffset=void 0,r.alterColumnOffset=void 0}},{key:"extendEndpointRanges",value:function(r,n,o,i){$(r.ranges,function(a){a[1]&&(n>=a[0]&&n<=a[1]?o>a[1]?a[1]+=i:o<a[0]&&(a[0]-=i):o>=a[0]&&o<=a[1]&&(a[1]-=i,n<=a[0]&&(a[0]+=1,a[1]+=1)))})}},{key:"recreatePhysicalRanges",value:function(r){var n=this,o=r.ranges,i=[],a=[];$(o,function(l){var s=[];if(l[1])for(var u=l[0];u<=l[1];u++)s.push(n.hot.toPhysicalRow(u));else s.push(n.hot.toPhysicalRow(l[0]));a.push(s)}),$(a,function(l){var s=[];$(l,function(u,f){f===0?s.push(u):l[f]!==l[f-1]+1&&(s.push(l[f-1]),i.push(s),s=[],s.push(u)),f===l.length-1&&(s.push(u),i.push(s))})}),r.ranges=i}},{key:"shiftEndpointCoordinates",value:function(r,n){r.alterRowOffset&&r.alterRowOffset!==0?(r.destinationRow+=r.alterRowOffset||0,$(r.ranges,function(o){$(o,function(i,a){i>=n&&(o[a]+=r.alterRowOffset||0)})})):r.alterColumnOffset&&r.alterColumnOffset!==0&&(r.destinationColumn+=r.alterColumnOffset||0,r.sourceColumn+=r.alterColumnOffset||0)}},{key:"resetAllEndpoints",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=n.some(function(a){var l=a.alterRowOffset||0,s=a.alterColumnOffset||0;return a.destinationRow+l>=r.hot.countRows()||a.destinationColumn+s>=r.hot.countCols()});i||(this.cellsToSetCache=[],$(n,function(a){r.resetEndpointValue(a,o)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}},{key:"refreshAllEndpoints",value:function(){var r=this;this.cellsToSetCache=[],$(this.getAllEndpoints(),function(n){r.currentEndpoint=n,r.plugin.calculate(n),r.setEndpointValue(n,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshChangedEndpoints",value:function(r){var n=this,o=[];this.cellsToSetCache=[],$(r,function(i,a,l){"".concat(i[2]||"")!=="".concat(i[3])&&$(n.getAllEndpoints(),function(s,u){n.hot.propToCol(l[a][1])===s.sourceColumn&&o.indexOf(u)===-1&&o.push(u)})}),$(o,function(i){n.refreshEndpoint(n.getEndpoint(i))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshEndpoint",value:function(r){this.currentEndpoint=r,this.plugin.calculate(r),this.setEndpointValue(r),this.currentEndpoint=null}},{key:"resetEndpointValue",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,o=r.alterRowOffset||0,i=r.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(r.destinationRow+(n?o:0)),this.hot.toVisualColumn(r.destinationColumn+(n?i:0)),""])}},{key:"setEndpointValue",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.hot.toVisualRow(r.destinationRow);if(r.destinationRow>=this.hot.countRows()||r.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}var a=this.hot.toVisualRow(r.destinationRow);if(a!==null){var l=this.hot.getCellMeta(a,r.destinationColumn);(n==="init"||l.readOnly!==r.readOnly)&&(l.readOnly=r.readOnly,l.className="columnSummaryResult")}r.roundFloat&&!isNaN(r.result)&&(r.result=r.result.toFixed(r.roundFloat)),o?this.hot.setDataAtCell(i,r.destinationColumn,r.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,r.destinationColumn,r.result]),r.alterRowOffset=void 0,r.alterColumnOffset=void 0}},{key:"throwOutOfBoundsWarning",value:function(){ht("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}]),e}();const CPe=SPe;function Xw(e){return e==null||isNaN(e)}function mu(e){"@babel/helpers - typeof";return mu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mu(e)}var vD;function _Pe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function OPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,EPe(n.key),n)}}function RPe(e,t,r){return t&&yD(e.prototype,t),r&&yD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function EPe(e){var t=TPe(e,"string");return mu(t)==="symbol"?t:String(t)}function TPe(e,t){if(mu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(mu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wg(){return typeof Reflect<"u"&&Reflect.get?wg=Reflect.get.bind():wg=function(t,r,n){var o=kPe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},wg.apply(this,arguments)}function kPe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=bu(e),e!==null););return e}function PPe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kO(e,t)}function kO(e,t){return kO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},kO(e,t)}function $Pe(e){var t=MPe();return function(){var n=bu(e),o;if(t){var i=bu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return APe(this,o)}}function APe(e,t){if(t&&(mu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return IPe(e)}function IPe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MPe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bu(e){return bu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bu(e)}var Zw="columnSummary",xPe=220,DPe=function(e){PPe(r,e);var t=$Pe(r);function r(n){var o;return OPe(this,r),o=t.call(this,n),o.endpoints=null,o}return RPe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Zw]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.settings=this.hot.getSettings()[Zw],this.endpoints=new CPe(this,this.settings),this.addHook("afterInit",function(){return o.onAfterInit.apply(o,arguments)}),this.addHook("afterChange",function(){return o.onAfterChange.apply(o,arguments)}),this.addHook("beforeCreateRow",function(i,a,l){return o.endpoints.resetSetupBeforeStructureAlteration("insert_row",i,a,null,l)}),this.addHook("beforeCreateCol",function(i,a,l){return o.endpoints.resetSetupBeforeStructureAlteration("insert_col",i,a,null,l)}),this.addHook("beforeRemoveRow",function(){for(var i,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return(i=o.endpoints).resetSetupBeforeStructureAlteration.apply(i,["remove_row"].concat(l))}),this.addHook("beforeRemoveCol",function(){for(var i,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return(i=o.endpoints).resetSetupBeforeStructureAlteration.apply(i,["remove_col"].concat(l))}),this.addHook("afterCreateRow",function(i,a,l){return o.endpoints.resetSetupAfterStructureAlteration("insert_row",i,a,null,l)}),this.addHook("afterCreateCol",function(i,a,l){return o.endpoints.resetSetupAfterStructureAlteration("insert_col",i,a,null,l)}),this.addHook("afterRemoveRow",function(){for(var i,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return(i=o.endpoints).resetSetupAfterStructureAlteration.apply(i,["remove_row"].concat(l))}),this.addHook("afterRemoveCol",function(){for(var i,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return(i=o.endpoints).resetSetupAfterStructureAlteration.apply(i,["remove_col"].concat(l))}),this.addHook("afterRowMove",function(){return o.onAfterRowMove.apply(o,arguments)}),wg(bu(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}},{key:"calculate",value:function(o){switch(o.type.toLowerCase()){case"sum":o.result=this.calculateSum(o);break;case"min":o.result=this.calculateMinMax(o,o.type);break;case"max":o.result=this.calculateMinMax(o,o.type);break;case"count":o.result=this.countEntries(o);break;case"average":o.result=this.calculateAverage(o);break;case"custom":o.result=o.customFunction.call(this,o);break}}},{key:"calculateSum",value:function(o){var i=this,a=0;return We(o.ranges,function(l){a+=i.getPartialSum(l,o.sourceColumn)}),a}},{key:"getPartialSum",value:function(o,i){var a=0,l=o[1]||o[0],s=null,u=0;do{if(s=this.getCellValue(l,i),s=Xw(s)?null:s,s!==null){var f=("".concat(s).split(".")[1]||[]).length||1;f>u&&(u=f)}a+=s||0,l-=1}while(l>=o[0]);return Math.round(a*Math.pow(10,u))/Math.pow(10,u)}},{key:"calculateMinMax",value:function(o,i){var a=this,l=null;return We(o.ranges,function(s){var u=a.getPartialMinMax(s,o.sourceColumn,i);if(l===null&&u!==null&&(l=u),u!==null)switch(i){case"min":l=Math.min(l,u);break;case"max":l=Math.max(l,u);break}}),l===null?"Not enough data":l}},{key:"getPartialMinMax",value:function(o,i,a){var l=null,s=o[1]||o[0],u;do{if(u=this.getCellValue(s,i),u=Xw(u)?null:u,l===null)l=u;else if(u!==null)switch(a){case"min":l=Math.min(l,u);break;case"max":l=Math.max(l,u);break}s-=1}while(s>=o[0]);return l}},{key:"countEmpty",value:function(o,i){var a,l=0,s=o[1]||o[0];do a=this.getCellValue(s,i),a=Xw(a)?null:a,a===null&&(l+=1),s-=1;while(s>=o[0]);return l}},{key:"countEntries",value:function(o){var i=this,a=0,l=o.ranges;return We(l,function(s){var u=s[1]===void 0?1:s[1]-s[0]+1,f=i.countEmpty(s,o.sourceColumn);a+=u,a-=f}),a}},{key:"calculateAverage",value:function(o){var i=this.calculateSum(o),a=this.countEntries(o);return i/a}},{key:"getCellValue",value:function(o,i){var a=this.hot.toVisualRow(o),l=this.hot.toVisualColumn(i),s=this.hot.getSourceDataAtCell(o,i),u="";if(a!==null&&l!==null&&(u=this.hot.getCellMeta(a,l).className||""),u.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof s=="string"&&(s=s.replace(/,/,".")),s=parseFloat(s)),isNaN(s)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(ft(vD||(vD=_Pe(["ColumnSummary plugin: cell at (",", ",`) is not in a 
          numeric format. Cannot do the calculation.`],["ColumnSummary plugin: cell at (",", ",`) is not in a\\x20
          numeric format. Cannot do the calculation.`])),o,i));return s}},{key:"onAfterInit",value:function(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}},{key:"onAfterChange",value:function(o,i){o&&i!=="ColumnSummary.reset"&&i!=="ColumnSummary.set"&&i!=="loadData"&&this.endpoints.refreshChangedEndpoints(o)}},{key:"onAfterRowMove",value:function(o,i){this.endpoints.resetSetupBeforeStructureAlteration("move_row",o[0],o.length,o,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",i,o.length,o,this.pluginName)}}],[{key:"PLUGIN_KEY",get:function(){return Zw}},{key:"PLUGIN_PRIORITY",get:function(){return xPe}}]),r}(ot);function rd(e){"@babel/helpers - typeof";return rd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rd(e)}function NPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,LPe(n.key),n)}}function HPe(e,t,r){return t&&gD(e.prototype,t),r&&gD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function LPe(e){var t=jPe(e,"string");return rd(t)==="symbol"?t:String(t)}function jPe(e,t){if(rd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var FPe=function(){function e(t,r){NPe(this,e),this.rootDocument=t,this.isRtl=r,this.container=null,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}return HPe(e,[{key:"setPosition",value:function(r,n){this.editorStyle.left="".concat(r,"px"),this.editorStyle.top="".concat(n,"px")}},{key:"setSize",value:function(r,n){if(r&&n){var o=this.getInputElement();o.style.width="".concat(r,"px"),o.style.height="".concat(n,"px")}}},{key:"getSize",value:function(){return{width:dt(this.getInputElement()),height:Rt(this.getInputElement())}}},{key:"resetSize",value:function(){var r=this.getInputElement();r.style.width="",r.style.height=""}},{key:"setReadOnlyState",value:function(r){var n=this.getInputElement();n.readOnly=r}},{key:"show",value:function(){this.editorStyle.display="block",this.hidden=!1}},{key:"hide",value:function(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}},{key:"isVisible",value:function(){return this.editorStyle.display==="block"}},{key:"setValue",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=r||"";this.getInputElement().value=n}},{key:"getValue",value:function(){return this.getInputElement().value}},{key:"isFocused",value:function(){return this.rootDocument.activeElement===this.getInputElement()}},{key:"focus",value:function(){this.getInputElement().focus()}},{key:"createEditor",value:function(){var r=this.rootDocument.createElement("div"),n=this.rootDocument.createElement("textarea");return r.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),re(this.container,e.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),re(r,e.CLASS_EDITOR),re(n,e.CLASS_INPUT),r.appendChild(n),this.container.appendChild(r),r}},{key:"getInputElement",value:function(){return this.editor.querySelector(".".concat(e.CLASS_INPUT))}},{key:"destroy",value:function(){var r=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,r&&r.removeChild(this.container)}}],[{key:"CLASS_EDITOR_CONTAINER",get:function(){return"htCommentsContainer"}},{key:"CLASS_EDITOR",get:function(){return"htComments"}},{key:"CLASS_INPUT",get:function(){return"htCommentTextArea"}},{key:"CLASS_CELL",get:function(){return"htCommentCell"}}]),e}();const BPe=FPe;var Ye="---------";function VPe(){return{name:Ye}}function WPe(e){return Be(e,function(t){return{start:t.getTopStartCorner(),end:t.getBottomEndCorner()}})}function py(e){return xe(e,"htSeparator")}function UPe(e){return xe(e,"htSubmenu")}function my(e){return xe(e,"htDisabled")}function by(e){return xe(e,"htSelectionDisabled")}function ll(e){var t=e.getSelected();return!t||t[0]<0?null:t}function zPe(e,t){if(e.indexOf(t)!==-1)return e;var r=e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return"".concat(r," ").concat(t)}function YPe(e,t){if(e.indexOf(t)!==-1)return e;var r=e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return"".concat(r," ").concat(t)}function Yi(e,t){var r={};return $(e,function(n){n.forAll(function(o,i){o>=0&&i>=0&&(r[o]||(r[o]=[]),r[o][i]=t(o,i))})}),r}function oi(e,t,r,n,o){$(e,function(i){i.forAll(function(a,l){a>=0&&l>=0&&GPe(a,l,t,r,n,o)})})}function GPe(e,t,r,n,o,i){var a=o(e,t),l=n;a.className&&(r==="vertical"?l=zPe(a.className,n):l=YPe(a.className,n)),i(e,t,"className",l)}function xn(e,t){var r=!1;return Array.isArray(e)&&$(e,function(n){return n.forAll(function(o,i){if(o>=0&&i>=0&&t(o,i))return r=!0,!1}),r}),r}function ro(e){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(e)}function KPe(e,t){return!e.hidden||!(typeof e.hidden=="function"&&e.hidden.call(t))}function RU(e,t){for(var r=e.slice(0),n=0;n<r.length&&r[n].name===t;)r.shift();return r}function qPe(e,t){var r=e.slice(0);return r.reverse(),r=RU(r,t),r.reverse(),r}function XPe(e){var t=[];return $(e,function(r,n){n>0?t[t.length-1].name!==r.name&&t.push(r):t.push(r)}),t}function ZPe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ye,r=e.slice(0);return r=RU(r,t),r=qPe(r,t),r=XPe(r),r}function nd(e){"@babel/helpers - typeof";return nd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nd(e)}function JPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,e$e(n.key),n)}}function QPe(e,t,r){return t&&pD(e.prototype,t),r&&pD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function e$e(e){var t=t$e(e,"string");return nd(t)==="symbol"?t:String(t)}function t$e(e,t){if(nd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var r$e=250,n$e=250,EU=function(){function e(t){JPe(this,e),this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(t)}return QPe(e,[{key:"hide",value:function(){var r=this;this.wasLastActionShow=!1,this.hidingTimer=setTimeout(function(){r.wasLastActionShow===!1&&r.runLocalHooks("hide")},n$e)}},{key:"show",value:function(r){this.wasLastActionShow=!0,this.showDebounced(r)}},{key:"cancelHiding",value:function(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}},{key:"updateDelay",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:r$e;this.showDebounced=SE(function(o){r.wasLastActionShow&&r.runLocalHooks("show",o.from.row,o.from.col)},n)}},{key:"destroy",value:function(){this.clearLocalHooks()}}]),e}();pt(EU,Pr);const o$e=EU;function wu(e){"@babel/helpers - typeof";return wu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wu(e)}function Jw(e,t,r){return t=TU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,TU(n.key),n)}}function a$e(e,t,r){return t&&mD(e.prototype,t),r&&mD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function TU(e){var t=l$e(e,"string");return wu(t)==="symbol"?t:String(t)}function l$e(e,t){if(wu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fa(){return typeof Reflect<"u"&&Reflect.get?fa=Reflect.get.bind():fa=function(t,r,n){var o=s$e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},fa.apply(this,arguments)}function s$e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=vo(e),e!==null););return e}function u$e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&PO(e,t)}function PO(e,t){return PO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},PO(e,t)}function f$e(e){var t=h$e();return function(){var n=vo(e),o;if(t){var i=vo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return c$e(this,o)}}function c$e(e,t){if(t&&(wu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kU(e)}function kU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h$e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vo(e){return vo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vo(e)}var Qw="comments",d$e=60,wy=new WeakMap,En="comment",Rl="value",bD="style",Sy="readOnly",v$e=function(e){u$e(r,e);var t=f$e(r);function r(n){var o;return i$e(this,r),o=t.call(this,n),o.editor=null,o.displaySwitch=null,o.eventManager=null,o.range={},o.preventEditorAutoSwitch=!1,wy.set(kU(o),{tempEditorDimensions:{},cellBelowCursor:null}),o}return a$e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Qw]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.editor||(this.editor=new BPe(this.hot.rootDocument,this.hot.isRtl())),this.eventManager||(this.eventManager=new Tt(this)),this.displaySwitch||(this.displaySwitch=new o$e(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",function(i){return o.addToContextMenu(i)}),this.addHook("afterRenderer",function(i,a,l,s,u,f){return o.onAfterRenderer(i,f)}),this.addHook("afterScrollHorizontally",function(){return o.hide()}),this.addHook("afterScrollVertically",function(){return o.hide()}),this.addHook("afterBeginEditing",function(){return o.hide()}),this.displaySwitch.addLocalHook("hide",function(){return o.hide()}),this.displaySwitch.addLocalHook("show",function(i,a){return o.showAtCell(i,a)}),this.registerListeners(),fa(vo(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),fa(vo(r.prototype),"updatePlugin",this).call(this),this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}},{key:"disablePlugin",value:function(){fa(vo(r.prototype),"disablePlugin",this).call(this)}},{key:"registerListeners",value:function(){var o=this,i=this.hot.rootDocument;this.eventManager.addEventListener(i,"mouseover",function(a){return o.onMouseOver(a)}),this.eventManager.addEventListener(i,"mousedown",function(a){return o.onMouseDown(a)}),this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()}),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",function(){return o.onEditorBlur()}),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",function(a){return o.onEditorMouseDown(a)}),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",function(a){return o.onEditorMouseUp(a)})}},{key:"setRange",value:function(o){this.range=o}},{key:"clearRange",value:function(){this.range={}}},{key:"targetIsCellWithComment",value:function(o){var i=di(o.target,"TD","TBODY");return!!(i&&xe(i,"htCommentCell")&&di(i,[this.hot.rootElement]))}},{key:"targetIsCommentTextArea",value:function(o){return this.editor.getInputElement()===o.target}},{key:"setComment",value:function(o){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var i=this.editor.getValue(),a="";o!=null?a=o:i!=null&&(a=i);var l=this.range.from.row,s=this.range.from.col;this.updateCommentMeta(l,s,Jw({},Rl,a)),this.hot.render()}},{key:"setCommentAtCell",value:function(o,i,a){this.setRange({from:this.hot._createCellCoords(o,i)}),this.setComment(a)}},{key:"removeComment",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,En),o&&this.hot.render(),this.hide()}},{key:"removeCommentAtCell",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(o,i)}),this.removeComment(a)}},{key:"getComment",value:function(){var o=this.range.from.row,i=this.range.from.col;return this.getCommentMeta(o,i,Rl)}},{key:"getCommentAtCell",value:function(o,i){return this.getCommentMeta(o,i,Rl)}},{key:"show",value:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var o=this.range.from,i=o.row,a=o.col;if(i<0||i>this.hot.countSourceRows()-1||a<0||a>this.hot.countSourceCols()-1)return!1;var l=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.editor.setValue(l[En]?l[En][Rl]:""),this.editor.show(),this.refreshEditor(!0),!0}},{key:"showAtCell",value:function(o,i){return this.setRange({from:this.hot._createCellCoords(o,i)}),this.show()}},{key:"hide",value:function(){this.editor.hide()}},{key:"refreshEditor",value:function(){var o,i,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(!a&&(!this.range.from||!this.editor.isVisible()))){var l=this.hot,s=l.rowIndexMapper,u=l.columnIndexMapper,f=this.range.from,c=f.row,h=f.col,d=s.getRenderableFromVisualIndex(c),v=u.getRenderableFromVisualIndex(h),g=d===null;this.editor.setPosition(0,0),d===null&&(d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(c,-1))),v===null&&(v=u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(h,-1)));var m=d===null,w=v===null;d=(o=d)!==null&&o!==void 0?o:0,v=(i=v)!==null&&i!==void 0?i:0;var S=this.hot,C=S.rootWindow,k=S.view._wt,R=k.wtTable,V=k.getCell({row:d,col:v},!0),U=this.getCommentMeta(c,h,bD);U?this.editor.setSize(U.width,U.height):this.editor.resetSize();var X=w?0:R.getStretchedColumnWidth(v),Y=g&&!m?Rt(V):0,q=V.getBoundingClientRect(),Z=q.left,ie=q.top,J=q.width,le=q.height,Se=this.editor.getSize(),me=Se.width,Ce=Se.height,P=this.hot.rootWindow,y=P.innerWidth,p=P.innerHeight,b=this.hot.rootDocument.documentElement,_=Z+C.scrollX+X,T=ie+C.scrollY+Y;this.hot.isRtl()&&(_-=me+X),this.hot.isLtr()&&Z+J+me>y?_=Z+C.scrollX-me-1:this.hot.isRtl()&&_<-(b.scrollWidth-b.clientWidth)&&(_=Z+C.scrollX+X+1),ie+Ce>p&&(T-=Ce-le+1),this.editor.setPosition(_,T),this.editor.setReadOnlyState(this.getCommentMeta(c,h,Sy))}}},{key:"checkSelectionCommentsConsistency",value:function(){var o=this.hot.getSelectedRangeLast();if(!o)return!1;var i=!1,a=o.getTopStartCorner();return this.getCommentMeta(a.row,a.col,Rl)&&(i=!0),i}},{key:"updateCommentMeta",value:function(o,i,a){var l=this.hot.getCellMeta(o,i)[En],s;l?(s=lr(l),hv(s,a)):s=a,this.hot.setCellMeta(o,i,En,s)}},{key:"getCommentMeta",value:function(o,i,a){var l=this.hot.getCellMeta(o,i);if(l[En])return l[En][a]}},{key:"onMouseDown",value:function(o){if(!(!this.hot.view||!this.hot.view._wt)&&!this.preventEditorAutoSwitch&&!this.targetIsCommentTextArea(o)){var i=di(o.target,"TD","TBODY"),a=null;i&&(a=this.hot.getCoords(i)),(!i||this.range.from&&a&&(this.range.from.row!==a.row||this.range.from.col!==a.col))&&this.hide()}}},{key:"onMouseOver",value:function(o){var i=wy.get(this),a=this.hot.rootDocument;if(!(this.preventEditorAutoSwitch||this.editor.isFocused()||xe(o.target,"wtBorder")||i.cellBelowCursor===o.target||!this.editor))if(i.cellBelowCursor=a.elementFromPoint(o.clientX,o.clientY),this.targetIsCellWithComment(o)){var l=this.hot._createCellRange(this.hot.getCoords(o.target));this.displaySwitch.show(l)}else vi(o.target,a)&&!this.targetIsCommentTextArea(o)&&this.displaySwitch.hide()}},{key:"onMouseUp",value:function(){this.preventEditorAutoSwitch=!1}},{key:"onAfterRenderer",value:function(o,i){i[En]&&i[En][Rl]&&re(o,i.commentedCellClassName)}},{key:"onEditorBlur",value:function(){this.setComment()}},{key:"onEditorMouseDown",value:function(o){var i=wy.get(this);i.tempEditorDimensions={width:dt(o.target),height:Rt(o.target)}}},{key:"onEditorMouseUp",value:function(o){var i=wy.get(this),a=dt(o.target),l=Rt(o.target);(a!==i.tempEditorDimensions.width+1||l!==i.tempEditorDimensions.height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,Jw({},bD,{width:a,height:l}))}},{key:"onContextMenuAddComment",value:function(){var o=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,this.displaySwitch.cancelHiding(),this.setRange({from:o.highlight}),this.show(),this.hot.deselectCell(),this.editor.focus()}},{key:"onContextMenuRemoveComment",value:function(){var o=this,i=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,i.forAll(function(a,l){a>=0&&l>=0&&o.removeCommentAtCell(a,l,!1)}),this.hot.render()}},{key:"onContextMenuMakeReadOnly",value:function(){var o=this,i=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,i.forAll(function(a,l){if(a>=0&&l>=0){var s=!!o.getCommentMeta(a,l,Sy);o.updateCommentMeta(a,l,Jw({},Sy,!s))}})}},{key:"addToContextMenu",value:function(o){var i=this,a=function(){return i.hot.rowIndexMapper.getRenderableIndexesLength()>0&&i.hot.columnIndexMapper.getRenderableIndexesLength()>0};o.items.push({name:"---------"},{key:"commentsAddEdit",name:function(){return i.checkSelectionCommentsConsistency()?i.hot.getTranslatedPhrase(gT):i.hot.getTranslatedPhrase(yT)},callback:function(){return i.onContextMenuAddComment()},disabled:function(){return a()?!(i.hot.getSelectedLast()&&!i.hot.selection.isSelectedByCorner()):!0}},{key:"commentsRemove",name:function(){return this.getTranslatedPhrase(pT)},callback:function(){return i.onContextMenuRemoveComment()},disabled:function(){return a()?!(i.hot.getSelectedLast()&&!i.hot.selection.isSelectedByCorner()):!0}},{key:"commentsReadOnly",name:function(){var s=this,u=this.getTranslatedPhrase(mT),f=xn(this.getSelectedRangeLast(),function(c,h){var d=s.getCellMeta(c,h)[En];if(d&&(d=d[Sy]),d)return!0});return f&&(u=ro(u)),u},callback:function(){return i.onContextMenuMakeReadOnly()},disabled:function(){return a()?!(i.hot.getSelectedLast()&&!i.hot.selection.isSelectedByCorner())||!i.checkSelectionCommentsConsistency():!0}})}},{key:"getDisplayDelaySetting",value:function(){var o=this.hot.getSettings()[Qw];if(Ve(o))return o.displayDelay}},{key:"destroy",value:function(){this.editor&&this.editor.destroy(),this.displaySwitch&&this.displaySwitch.destroy(),fa(vo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Qw}},{key:"PLUGIN_PRIORITY",get:function(){return d$e}}]),r}(ot);function od(e){"@babel/helpers - typeof";return od=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},od(e)}function y$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,p$e(n.key),n)}}function g$e(e,t,r){return t&&wD(e.prototype,t),r&&wD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function p$e(e){var t=m$e(e,"string");return od(t)==="symbol"?t:String(t)}function m$e(e,t){if(od(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(od(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var b$e=function(){function e(t){y$e(this,e),this.hot=t,this.commands={},this.commonCallback=null}return g$e(e,[{key:"registerCommand",value:function(r,n){this.commands[r]=n}},{key:"setCommonCallback",value:function(r){this.commonCallback=r}},{key:"execute",value:function(r){for(var n=this,o=arguments.length,i=new Array(o>1?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];var l=r.split(":"),s=l[0],u=l.length===2?l[1]:null,f=this.commands[s];if(!f)throw new Error("Menu command '".concat(s,"' not exists."));if(u&&f.submenu&&(f=w$e(u,f.submenu.items)),f.disabled!==!0&&!(typeof f.disabled=="function"&&f.disabled.call(this.hot)===!0)&&!At(f,"submenu")){var c=[];typeof f.callback=="function"&&c.push(f.callback),typeof this.commonCallback=="function"&&c.push(this.commonCallback),i.unshift(l.join(":")),$(c,function(h){return h.apply(n.hot,i)})}}}]),e}();function w$e(e,t){var r;return $(t,function(n){var o=n.key?n.key.split(":"):null;if(Array.isArray(o)&&o[1]===e)return r=n,!1}),r}const PU=b$e;var Gr="alignment";function S$e(){return{key:Gr,name:function(){return this.getTranslatedPhrase(bT)},disabled:function(){return this.countRows()===0||this.countCols()===0?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:"".concat(Gr,":left"),name:function(){var t=this,r=this.getTranslatedPhrase(wT),n=xn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htLeft")!==-1)return!0});return n&&(r=ro(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Yi(r,function(a,l){return t.getCellMeta(a,l).className}),o="horizontal",i="htLeft";this.runHooks("beforeCellAlignment",n,r,o,i),oi(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(Gr,":center"),name:function(){var t=this,r=this.getTranslatedPhrase(ST),n=xn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htCenter")!==-1)return!0});return n&&(r=ro(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Yi(r,function(a,l){return t.getCellMeta(a,l).className}),o="horizontal",i="htCenter";this.runHooks("beforeCellAlignment",n,r,o,i),oi(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(Gr,":right"),name:function(){var t=this,r=this.getTranslatedPhrase(CT),n=xn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htRight")!==-1)return!0});return n&&(r=ro(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Yi(r,function(a,l){return t.getCellMeta(a,l).className}),o="horizontal",i="htRight";this.runHooks("beforeCellAlignment",n,r,o,i),oi(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(Gr,":justify"),name:function(){var t=this,r=this.getTranslatedPhrase(_T),n=xn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htJustify")!==-1)return!0});return n&&(r=ro(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Yi(r,function(a,l){return t.getCellMeta(a,l).className}),o="horizontal",i="htJustify";this.runHooks("beforeCellAlignment",n,r,o,i),oi(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{name:Ye},{key:"".concat(Gr,":top"),name:function(){var t=this,r=this.getTranslatedPhrase(OT),n=xn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htTop")!==-1)return!0});return n&&(r=ro(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Yi(r,function(a,l){return t.getCellMeta(a,l).className}),o="vertical",i="htTop";this.runHooks("beforeCellAlignment",n,r,o,i),oi(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(Gr,":middle"),name:function(){var t=this,r=this.getTranslatedPhrase(RT),n=xn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htMiddle")!==-1)return!0});return n&&(r=ro(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Yi(r,function(a,l){return t.getCellMeta(a,l).className}),o="vertical",i="htMiddle";this.runHooks("beforeCellAlignment",n,r,o,i),oi(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(Gr,":bottom"),name:function(){var t=this,r=this.getTranslatedPhrase(ET),n=xn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htBottom")!==-1)return!0});return n&&(r=ro(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Yi(r,function(a,l){return t.getCellMeta(a,l).className}),o="vertical",i="htBottom";this.runHooks("beforeCellAlignment",n,r,o,i),oi(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1}]}}}var Qm="clear_column";function C$e(){return{key:Qm,name:function(){return this.getTranslatedPhrase(iT)},callback:function(t,r){var n=r[0].start.col,o=r[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(r[0].start.row,r[0].end.row),o,"ContextMenu.clearColumn")},disabled:function(){var t=ll(this);return t?!this.selection.isSelectedByColumnHeader():!0}}}var $v="col_left";function _$e(){return{key:$v,name:function(){return this.getTranslatedPhrase(JE)},callback:function(){var t=this.getSelectedRangeLast().getTopLeftCorner(),r=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(r,t.col,1,"ContextMenu.columnLeft")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=ll(this);if(!t)return!0;if(this.selection.isSelectedByCorner()){var r=this.countCols();return r===0}return this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden:function(){return!this.getSettings().allowInsertColumn}}}var Av="col_right";function O$e(){return{key:Av,name:function(){return this.getTranslatedPhrase(QE)},callback:function(){var t=this.getSelectedRangeLast().getTopRightCorner(),r=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(r,t.col,1,"ContextMenu.columnRight")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=ll(this);return t?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols:!0},hidden:function(){return!this.getSettings().allowInsertColumn}}}var Iv="make_read_only";function R$e(){return{key:Iv,name:function(){var t=this,r=this.getTranslatedPhrase(oT),n=xn(this.getSelectedRange(),function(o,i){return t.getCellMeta(o,i).readOnly});return n&&(r=ro(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=xn(r,function(o,i){return t.getCellMeta(o,i).readOnly});$(r,function(o){o.forAll(function(i,a){i>=0&&a>=0&&t.setCellMeta(i,a,"readOnly",!n)})}),this.render()},disabled:function(){return!!(this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}var eb="redo";function E$e(){return{key:eb,name:function(){return this.getTranslatedPhrase(nT)},callback:function(){this.redo()},hidden:function(){var t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}function T$e(e,t){return A$e(e)||$$e(e,t)||P$e(e,t)||k$e()}function k$e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function P$e(e,t){if(e){if(typeof e=="string")return SD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return SD(e,t)}}function SD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function $$e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function A$e(e){if(Array.isArray(e))return e}var Mv="remove_col";function I$e(){return{key:Mv,name:function(){var t=this.getSelected(),r=0;if(t)if(t.length>1)r=1;else{var n=T$e(t[0],4),o=n[1],i=n[3];o-i!==0&&(r=1)}return this.getTranslatedPhrase(tT,r)},callback:function(){this.alter("remove_col",Zwe(this.getSelected()),null,"ContextMenu.removeColumn")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=ll(this);if(!t)return!0;var r=this.countCols();return this.selection.isSelectedByCorner()?r===0:this.selection.isSelectedByRowHeader()||r===0},hidden:function(){return!this.getSettings().allowRemoveColumn}}}function M$e(e,t){return H$e(e)||N$e(e,t)||D$e(e,t)||x$e()}function x$e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function D$e(e,t){if(e){if(typeof e=="string")return CD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return CD(e,t)}}function CD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function N$e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function H$e(e){if(Array.isArray(e))return e}var tb="remove_row";function L$e(){return{key:tb,name:function(){var t=this.getSelected(),r=0;if(t)if(t.length>1)r=1;else{var n=M$e(t[0],3),o=n[0],i=n[2];o-i!==0&&(r=1)}return this.getTranslatedPhrase(eT,r)},callback:function(){this.alter("remove_row",Jwe(this.getSelected()),1,"ContextMenu.removeRow")},disabled:function(){var t=ll(this);if(!t)return!0;var r=this.countRows();return this.selection.isSelectedByCorner()?r===0:this.selection.isSelectedByColumnHeader()||r===0},hidden:function(){return!this.getSettings().allowRemoveRow}}}var rb="row_above";function j$e(){return{key:rb,name:function(){return this.getTranslatedPhrase(XE)},callback:function(){var t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled:function(){var t=ll(this);if(!t)return!0;if(this.selection.isSelectedByCorner()){var r=this.countRows();return r===0}return this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden:function(){return!this.getSettings().allowInsertRow}}}var nb="row_below";function F$e(){return{key:nb,name:function(){return this.getTranslatedPhrase(ZE)},callback:function(){var t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled:function(){var t=ll(this);return t?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows:!0},hidden:function(){return!this.getSettings().allowInsertRow}}}var id="no_items";function B$e(){return{key:id,name:function(){return this.getTranslatedPhrase(qE)},disabled:!0,isCommand:!1}}var ob="undo";function V$e(){return{key:ob,name:function(){return this.getTranslatedPhrase(rT)},callback:function(){this.undo()},hidden:function(){var t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}function ad(e){"@babel/helpers - typeof";return ad=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ad(e)}var cr;function $r(e,t,r){return t=W$e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function W$e(e){var t=U$e(e,"string");return ad(t)==="symbol"?t:String(t)}function U$e(e,t){if(ad(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ad(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var z$e=[rb,nb,$v,Av,Qm,tb,Mv,ob,eb,Iv,Gr,Ye,id],Y$e=(cr={},$r(cr,Ye,VPe),$r(cr,id,B$e),$r(cr,rb,j$e),$r(cr,nb,F$e),$r(cr,$v,_$e),$r(cr,Av,O$e),$r(cr,Qm,C$e),$r(cr,tb,L$e),$r(cr,Mv,I$e),$r(cr,ob,V$e),$r(cr,eb,E$e),$r(cr,Iv,R$e),$r(cr,Gr,S$e),cr);function $U(){var e={};return We(Y$e,function(t,r){e[r]=t()}),e}function ld(e){"@babel/helpers - typeof";return ld=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ld(e)}function G$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _D(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,q$e(n.key),n)}}function K$e(e,t,r){return t&&_D(e.prototype,t),r&&_D(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function q$e(e){var t=X$e(e,"string");return ld(t)==="symbol"?t:String(t)}function X$e(e,t){if(ld(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ld(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Z$e=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;G$e(this,e),this.hot=t,this.predefinedItems=$U(),this.defaultOrderPattern=r}return K$e(e,[{key:"setPredefinedItems",value:function(r){var n=this,o={};this.defaultOrderPattern.length=0,We(r,function(i,a){var l="";i.name===Ye?(o[Ye]=i,l=Ye):isNaN(parseInt(a,10))?(i.key=i.key===void 0?a:i.key,o[a]=i,l=i.key):(o[i.key]=i,l=i.key),n.defaultOrderPattern.push(l)}),this.predefinedItems=o}},{key:"getItems",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return J$e(r,this.defaultOrderPattern,this.predefinedItems)}}]),e}();function J$e(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=[],o=e;return o&&o.items?o=o.items:Array.isArray(o)||(o=t),Ve(o)?We(o,function(i,a){var l=r[typeof i=="string"?i:a];l||(l=i),Ve(i)?Wt(l,i):typeof l=="string"&&(l={name:l}),l.key===void 0&&(l.key=a),n.push(l)}):$(o,function(i,a){var l=r[i];!l&&z$e.indexOf(i)>=0||(l||(l={name:i,key:"".concat(a)}),Ve(i)&&Wt(l,i),l.key===void 0&&(l.key=a),n.push(l))}),n}const AU=Z$e;function sd(e){"@babel/helpers - typeof";return sd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sd(e)}function Q$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,t1e(n.key),n)}}function e1e(e,t,r){return t&&OD(e.prototype,t),r&&OD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function t1e(e){var t=r1e(e,"string");return sd(t)==="symbol"?t:String(t)}function r1e(e,t){if(sd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var n1e=function(){function e(t,r){Q$e(this,e);var n=ys(r),o=Na(r),i,a,l,s,u,f;this.rootWindow=r,this.type=this.getSourceType(t),this.type==="literal"?(i=parseInt(t.top,10),l=parseInt(t.left,10),u=t.height||0,f=t.width||0,a=i,s=l,i+=n,l+=o):this.type==="event"&&(i=parseInt(t.pageY,10),l=parseInt(t.pageX,10),u=t.target.clientHeight,f=t.target.clientWidth,a=i-n,s=l-o),this.top=i,this.topRelative=a,this.left=l,this.leftRelative=s,this.scrollTop=n,this.scrollLeft=o,this.cellHeight=u,this.cellWidth=f}return e1e(e,[{key:"getSourceType",value:function(r){var n="literal";return r instanceof Event&&(n="event"),n}},{key:"fitsAbove",value:function(r){return this.topRelative>=r.offsetHeight}},{key:"fitsBelow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+r.offsetHeight<=n}},{key:"fitsOnRight",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+r.offsetWidth<=n}},{key:"fitsOnLeft",value:function(r){return this.leftRelative>=r.offsetWidth}}]),e}();const o1e=n1e;function ud(e){"@babel/helpers - typeof";return ud=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ud(e)}function RD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function ED(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?RD(Object(r),!0).forEach(function(n){i1e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):RD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function i1e(e,t,r){return t=IU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,IU(n.key),n)}}function l1e(e,t,r){return t&&TD(e.prototype,t),r&&TD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function IU(e){var t=s1e(e,"string");return ud(t)==="symbol"?t:String(t)}function s1e(e,t){if(ud(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ud(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kD=215,MU="menu",u1e=MU,xU=function(){function e(t,r){a1e(this,e),this.hot=t,this.options=r||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:kD,container:this.hot.rootDocument.documentElement},this.eventManager=new Tt(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}return l1e(e,[{key:"registerEvents",value:function(){for(var r=this,n=this.hot.rootWindow;n;)this.eventManager.addEventListener(n.document,"mousedown",function(o){return r.onDocumentMouseDown(o)}),this.eventManager.addEventListener(n.document,"contextmenu",function(o){return r.onDocumentContextMenu(o)}),n=Wc(n)}},{key:"setMenuItems",value:function(r){this.menuItems=r}},{key:"getSelectedItem",value:function(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}},{key:"hasSelectedItem",value:function(){return Array.isArray(this.hotMenu.getSelectedLast())}},{key:"setOffset",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.offset[r]=n}},{key:"isSubMenu",value:function(){return this.parentMenu!==null}},{key:"open",value:function(){var r=this;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";var n=SE(function(d){return r.openSubMenu(d)},300),o=this.options.minWidth||kD,i=!1,a=jr(this.menuItems,function(d){return d.key===id&&(i=!0),KPe(d,r.hot)});if(a.length<1&&!i)a.push($U()[id]);else if(a.length===0)return;a=ZPe(a,Ye);var l=!1,s={data:a,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:function(v){return ve(v)&&v<o?o:v},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,maxCols:1,columns:[{data:"name",renderer:function(v,g,m,w,S,C){return r.menuItemRenderer(v,g,m,w,S,C)}}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",afterOnCellMouseOver:function(v,g){r.isAllSubMenusClosed()?n(g.row):r.openSubMenu(g.row)},rowHeights:function(v){return a[v].name===Ye?1:23},afterOnCellContextMenu:function(v){v.preventDefault(),EC()&&l&&r.hasSelectedItem()&&r.close(!0)},beforeOnCellMouseUp:function(v){r.hasSelectedItem()&&(l=!r.isCommandPassive(r.getSelectedItem()),r.executeCommand(v))},afterOnCellMouseUp:function(v){(!EC()||!ki(v))&&l&&r.hasSelectedItem()&&(cn()||G0()?setTimeout(function(){return r.close(!0)},325):r.close(!0))},afterUnlisten:function(){!r.hasSelectedItem()&&r.isOpened()&&r.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new bk(this.container,s),this.hotMenu.addHook("afterInit",function(){return r.onAfterInit()}),this.hotMenu.addHook("afterSelection",function(){return r.onAfterSelection.apply(r,arguments)}),this.hotMenu.init(),this.hotMenu.listen();var u=this.hotMenu.getShortcutManager(),f=u.addContext(u1e),c={group:MU},h=ED(ED({},c),{},{runOnlyIf:function(v){return Yc(v.target)===!1||r.container.contains(v.target)===!1}});u.setActiveContextName("menu"),f.addShortcuts([{keys:[["Escape"]],callback:function(){r.keyEvent=!0,r.close(),r.keyEvent=!1}},{keys:[["ArrowDown"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.selectNextCell(v[0],v[1]):r.selectFirstCell(),r.keyEvent=!1}},{keys:[["ArrowUp"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.selectPrevCell(v[0],v[1]):r.selectLastCell(),r.keyEvent=!1}},{keys:[["ArrowRight"]],callback:function(){var v=r.hotMenu.getSelectedLast();if(r.keyEvent=!0,v){var g=r.openSubMenu(v[0]);g&&g.selectFirstCell()}r.keyEvent=!1}},{keys:[["ArrowLeft"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v&&r.isSubMenu()&&(r.close(),r.parentMenu&&r.parentMenu.hotMenu.listen()),r.keyEvent=!1}},{keys:[["Enter"]],callback:function(v){var g=r.hotMenu.getSelectedLast();r.keyEvent=!0,r.hotMenu.getSourceDataAtRow(g[0]).submenu||(r.executeCommand(v),r.close(!0)),r.keyEvent=!1}},{keys:[["PageUp"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.hotMenu.selection.transformStart(-r.hotMenu.countVisibleRows(),0):r.selectFirstCell(),r.keyEvent=!1}},{keys:[["PageDown"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.hotMenu.selection.transformStart(r.hotMenu.countVisibleRows(),0):r.selectLastCell(),r.keyEvent=!1}}],h),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}},{key:"close",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.isOpened()&&(r&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}},{key:"openSubMenu",value:function(r){if(!this.hotMenu)return!1;var n=this.hotMenu.getCell(r,0);if(this.closeAllSubMenus(),!n||!UPe(n))return!1;var o=this.hotMenu.getSourceDataAtRow(r),i=new e(this.hot,{parent:this,name:o.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(o.submenu.items),i.open(),i.setPosition(n.getBoundingClientRect()),this.hotSubMenus[o.key]=i,i}},{key:"closeSubMenu",value:function(r){var n=this.hotMenu.getSourceDataAtRow(r),o=this.hotSubMenus[n.key];o&&(o.destroy(),delete this.hotSubMenus[n.key])}},{key:"closeAllSubMenus",value:function(){var r=this;$(this.hotMenu.getData(),function(n,o){return r.closeSubMenu(o)})}},{key:"isAllSubMenusClosed",value:function(){return Object.keys(this.hotSubMenus).length===0}},{key:"destroy",value:function(){var r=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),r&&r.removeChild(this.container)}},{key:"isOpened",value:function(){return this.hotMenu!==null}},{key:"executeCommand",value:function(r){if(!(!this.isOpened()||!this.hasSelectedItem())){var n=this.getSelectedItem();if(this.runLocalHooks("select",n,r),!this.isCommandPassive(n)){var o=this.hot.getSelectedRange(),i=o?WPe(o):[];this.runLocalHooks("executeCommand",n.key,i,r),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,i,r)}}}},{key:"isCommandPassive",value:function(r){var n=r.isCommand,o=r.name,i=r.disabled,a=r.submenu,l=i===!0||typeof i=="function"&&i.call(this.hot)===!0;return n===!1||o===Ye||l===!0||a}},{key:"setPosition",value:function(r){var n=new o1e(r,this.container.ownerDocument.defaultView);this.options.keepInViewport?(n.fitsBelow(this.container)?this.setPositionBelowCursor(n):n.fitsAbove(this.container)?this.setPositionAboveCursor(n):this.setPositionBelowCursor(n),this.hot.isLtr()?this.setHorizontalPositionForLtr(n):this.setHorizontalPositionForRtl(n)):(this.setPositionBelowCursor(n),this.setPositionOnRightOfCursor(n))}},{key:"setHorizontalPositionForRtl",value:function(r){r.fitsOnLeft(this.container)?this.setPositionOnLeftOfCursor(r):this.setPositionOnRightOfCursor(r)}},{key:"setHorizontalPositionForLtr",value:function(r){r.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(r):this.setPositionOnLeftOfCursor(r)}},{key:"setPositionAboveCursor",value:function(r){var n=this.offset.above+r.top-this.container.offsetHeight;this.isSubMenu()&&(n=r.top+r.cellHeight-this.container.offsetHeight+3),this.container.style.top="".concat(n,"px")}},{key:"setPositionBelowCursor",value:function(r){var n=this.offset.below+r.top+1;this.isSubMenu()&&(n=r.top-1),this.container.style.top="".concat(n,"px")}},{key:"setPositionOnRightOfCursor",value:function(r){var n=r.left;if(this.isSubMenu()){var o=this.parentMenu.container.getBoundingClientRect(),i=o.right;n+=r.cellWidth+i-(r.left+r.cellWidth)}else n+=this.offset.right;this.container.style.left="".concat(n,"px")}},{key:"setPositionOnLeftOfCursor",value:function(r){var n=this.offset.left+r.left-this.container.offsetWidth;if(this.isSubMenu()){var o=this.parentMenu.container.getBoundingClientRect(),i=o.left;n-=r.left-i}this.container.style.left="".concat(n,"px")}},{key:"selectFirstCell",value:function(){var r=this.hotMenu.getCell(0,0);py(r)||my(r)||by(r)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}},{key:"selectLastCell",value:function(){var r=this.hotMenu.countRows()-1,n=this.hotMenu.getCell(r,0);py(n)||my(n)||by(n)?this.selectPrevCell(r,0):(this.hotMenu.selectCell(r,0,void 0,void 0,!1),this.hotMenu.scrollViewportTo(r,0,!0,!1))}},{key:"selectNextCell",value:function(r,n){var o=r+1,i=o<this.hotMenu.countRows()?this.hotMenu.getCell(o,n):null;i&&(py(i)||my(i)||by(i)?this.selectNextCell(o,n):this.hotMenu.selectCell(o,n))}},{key:"selectPrevCell",value:function(r,n){var o=r-1,i=o>=0?this.hotMenu.getCell(o,n):null;i&&(py(i)||my(i)||by(i)?this.selectPrevCell(o,n):this.hotMenu.selectCell(o,n))}},{key:"menuItemRenderer",value:function(r,n,o,i,a,l){var s=this,u=r.getSourceDataAtRow(o),f=this.hot.rootDocument.createElement("div"),c=function(w){return At(w,"submenu")},h=function(w){return new RegExp(Ye,"i").test(w.name)},d=function(w){return w.disabled===!0||typeof w.disabled=="function"&&w.disabled.call(s.hot)===!0},v=function(w){return w.disableSelection},g=l;typeof g=="function"&&(g=g.call(this.hot)),gn(n),re(f,"htItemWrapper"),n.appendChild(f),h(u)?re(n,"htSeparator"):typeof u.renderer=="function"?(re(n,"htCustomMenuRenderer"),n.appendChild(u.renderer(r,f,o,i,a,g))):ol(f,g),d(u)?(re(n,"htDisabled"),this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()})):v(u)?(re(n,"htSelectionDisabled"),this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()})):c(u)?(re(n,"htSubmenu"),v(u)?this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()}):this.eventManager.addEventListener(n,"mouseenter",function(){return r.selectCell(o,i,void 0,void 0,!1,!1)})):(Le(n,["htSubmenu","htDisabled"]),v(u)?this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()}):this.eventManager.addEventListener(n,"mouseenter",function(){return r.selectCell(o,i,void 0,void 0,!1,!1)}))}},{key:"createContainer",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=this.options.container.ownerDocument,o=r,i;return o&&(bt(o)&&(o=o.call(this.hot),o===null||gt(o)?o="":o=o.toString()),o=o.replace(/[^A-z0-9]/g,"_"),o="".concat(this.options.className,"Sub_").concat(o),i=n.querySelector(".".concat(this.options.className,".").concat(o))),i||(i=n.createElement("div"),re(i,"htMenu ".concat(this.options.className)),o&&re(i,o),this.options.container.appendChild(i)),i}},{key:"blockMainTableCallbacks",value:function(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}},{key:"releaseMainTableCallbacks",value:function(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}},{key:"onAfterInit",value:function(){var r=this.hotMenu.view._wt.wtTable,n=this.hotMenu.getSettings().data,o=r.hider.style,i=r.holder.style,a=parseInt(o.width,10),l=Lt(n,function(s,u){return s+(u.name===Ye?1:26)},0);i.width="".concat(a+3,"px"),i.height="".concat(l+3,"px"),o.height=i.height}},{key:"onAfterSelection",value:function(r,n,o,i,a){this.keyEvent===!1&&(a.value=!0)}},{key:"onDocumentMouseDown",value:function(r){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!vi(r.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!vi(r.target,".htMenu")&&this.close(!0))}},{key:"onDocumentContextMenu",value:function(r){this.isOpened()&&xe(r.target,"htCore")&&vi(r.target,this.hotMenu.rootElement)&&r.preventDefault()}}]),e}();pt(xU,Pr);const Dk=xU;function Su(e){"@babel/helpers - typeof";return Su=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Su(e)}function f1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,h1e(n.key),n)}}function c1e(e,t,r){return t&&PD(e.prototype,t),r&&PD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function h1e(e){var t=d1e(e,"string");return Su(t)==="symbol"?t:String(t)}function d1e(e,t){if(Su(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Su(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ca(){return typeof Reflect<"u"&&Reflect.get?ca=Reflect.get.bind():ca=function(t,r,n){var o=v1e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ca.apply(this,arguments)}function v1e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=yo(e),e!==null););return e}function y1e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$O(e,t)}function $O(e,t){return $O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},$O(e,t)}function g1e(e){var t=m1e();return function(){var n=yo(e),o;if(t){var i=yo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return p1e(this,o)}}function p1e(e,t){if(t&&(Su(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return DU(e)}function DU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m1e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yo(e){return yo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yo(e)}var Cy="contextMenu",b1e=70;pe.getSingleton().register("afterContextMenuDefaultOptions");pe.getSingleton().register("beforeContextMenuShow");pe.getSingleton().register("afterContextMenuShow");pe.getSingleton().register("afterContextMenuHide");pe.getSingleton().register("afterContextMenuExecute");var NU=function(e){y1e(r,e);var t=g1e(r);function r(n){var o;return f1e(this,r),o=t.call(this,n),o.eventManager=new Tt(DU(o)),o.commandExecutor=new PU(o.hot),o.itemsFactory=null,o.menu=null,o}return c1e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Cy]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[Cy];typeof i.callback=="function"&&this.commandExecutor.setCommonCallback(i.callback),this.menu=new Dk(this.hot,{className:"htContextMenu",keepInViewport:!0,container:i.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",function(){return o.onMenuBeforeOpen()}),this.menu.addLocalHook("afterOpen",function(){return o.onMenuAfterOpen()}),this.menu.addLocalHook("afterClose",function(){return o.onMenuAfterClose()}),this.menu.addLocalHook("executeCommand",function(){for(var a,l=arguments.length,s=new Array(l),u=0;u<l;u++)s[u]=arguments[u];return(a=o.executeCommand).call.apply(a,[o].concat(s))}),this.addHook("afterOnCellContextMenu",function(a){return o.onAfterOnCellContextMenu(a)}),ca(yo(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ca(yo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),ca(yo(r.prototype),"disablePlugin",this).call(this)}},{key:"open",value:function(o){if(this.menu&&(this.prepareMenuItems(),this.menu.open(),!!this.menu.isOpened())){var i=0,a=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var l=this.hot.rootWindow.frameElement,s=l.getBoundingClientRect(),u=s.top,f=s.left;i=u-ys(o.view),a=f-Na(o.view)}else i=-1*ys(this.menu.hotMenu.rootWindow),a=-1*Na(this.menu.hotMenu.rootWindow);this.menu.setPosition({top:parseInt(o.pageY,10)+i,left:parseInt(o.pageX,10)+a})}}},{key:"close",value:function(){this.menu&&(this.menu.close(),this.itemsFactory=null)}},{key:"executeCommand",value:function(o){var i;this.itemsFactory===null&&this.prepareMenuItems();for(var a=arguments.length,l=new Array(a>1?a-1:0),s=1;s<a;s++)l[s-1]=arguments[s];(i=this.commandExecutor).execute.apply(i,[o].concat(l))}},{key:"prepareMenuItems",value:function(){var o=this;this.itemsFactory=new AU(this.hot,r.DEFAULT_ITEMS);var i=this.hot.getSettings()[Cy],a={items:this.itemsFactory.getItems(i)};this.hot.runHooks("afterContextMenuDefaultOptions",a),this.itemsFactory.setPredefinedItems(a.items);var l=this.itemsFactory.getItems(i);this.hot.runHooks("beforeContextMenuSetItems",l),this.menu.setMenuItems(l),$(l,function(s){return o.commandExecutor.registerCommand(s.key,s)})}},{key:"onAfterOnCellContextMenu",value:function(o){var i=this.hot.getSettings(),a=i.rowHeaders,l=i.colHeaders;function s(f){return f.nodeName==="TD"||f.parentNode.nodeName==="TD"}var u=o.target;this.close(),!xe(u,"handsontableInput")&&(o.preventDefault(),o.stopPropagation(),!(!(a||l)&&!s(u)&&!(xe(u,"current")&&xe(u,"wtBorder")))&&this.open(o))}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeContextMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterContextMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),ca(yo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Cy}},{key:"PLUGIN_PRIORITY",get:function(){return b1e}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[rb,nb,Ye,$v,Av,Ye,tb,Mv,Ye,ob,eb,Ye,Iv,Ye,Gr]}}]),r}(ot);NU.SEPARATOR={name:Ye};function w1e(e){return{key:"copy",name:function(){return this.getTranslatedPhrase(aT)},callback:function(){e.copyCellsOnly()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function S1e(e){return{key:"copy_column_headers_only",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(uT,n)},callback:function(){e.copyColumnHeadersOnly()},disabled:function(){if(!this.hasColHeaders())return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function C1e(e){return{key:"copy_with_column_group_headers",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(sT,n)},callback:function(){e.copyWithAllColumnHeaders()},disabled:function(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function _1e(e){return{key:"copy_with_column_headers",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(lT,n)},callback:function(){e.copyWithColumnHeaders()},disabled:function(){if(!this.hasColHeaders())return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function O1e(e){return{key:"cut",name:function(){return this.getTranslatedPhrase(fT)},callback:function(){e.cut()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function fd(e){"@babel/helpers - typeof";return fd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fd(e)}function R1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $D(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,T1e(n.key),n)}}function E1e(e,t,r){return t&&$D(e.prototype,t),r&&$D(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function T1e(e){var t=k1e(e,"string");return fd(t)==="symbol"?t:String(t)}function k1e(e,t){if(fd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var P1e=function(){function e(){R1e(this,e),this.data={}}return E1e(e,[{key:"setData",value:function(r,n){this.data[r]=n}},{key:"getData",value:function(r){return this.data[r]||void 0}}]),e}();function cd(e){"@babel/helpers - typeof";return cd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cd(e)}function AD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,A1e(n.key),n)}}function $1e(e,t,r){return t&&AD(e.prototype,t),r&&AD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function A1e(e){var t=I1e(e,"string");return cd(t)==="symbol"?t:String(t)}function I1e(e,t){if(cd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function M1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var x1e=$1e(function e(){M1e(this,e),this.clipboardData=new P1e});function hd(e){"@babel/helpers - typeof";return hd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hd(e)}function D1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ID(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,H1e(n.key),n)}}function N1e(e,t,r){return t&&ID(e.prototype,t),r&&ID(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function H1e(e){var t=L1e(e,"string");return hd(t)==="symbol"?t:String(t)}function L1e(e,t){if(hd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Nk=function(){function e(t){D1e(this,e),this.rootDocument=t.defaultView?t:t.ownerDocument,this.mainElement=null,this.eventManager=new Tt(this),this.listenersCount=new WeakSet,this.container=t}return N1e(e,[{key:"useSecondaryElement",value:function(){var r=B1e(this.container);this.listenersCount.has(r)||(this.listenersCount.add(r),MD(this.eventManager,r,this)),this.mainElement=r}},{key:"setFocusableElement",value:function(r){this.listenersCount.has(r)||(this.listenersCount.add(r),MD(this.eventManager,r,this)),this.mainElement=r}},{key:"getFocusableElement",value:function(){return this.mainElement}},{key:"focus",value:function(){this.mainElement.value=" ",cn()||AV(this.mainElement)}}]),e}();pt(Nk,Pr);var Np=new WeakMap;function j1e(e){var t=new Nk(e),r=Np.get(e);return r=isNaN(r)?0:r,Np.set(e,r+1),t}function F1e(e){e.eventManager.clear()}var eS=function(t,r){return function(n){return r.runLocalHooks(t,n)}};function MD(e,t,r){e.addEventListener(t,"copy",eS("copy",r)),e.addEventListener(t,"cut",eS("cut",r)),e.addEventListener(t,"paste",eS("paste",r))}var Hp=new WeakMap;function B1e(e){var t=Hp.get(e);if(t)return t.parentElement||e.appendChild(t),t;var r=e.defaultView?e:e.ownerDocument,n=r.createElement("textarea");return Hp.set(e,n),n.setAttribute("data-hot-input",""),n.className="HandsontableCopyPaste",n.tabIndex=-1,n.autocomplete="off",n.wrap="hard",n.value=" ",e.appendChild(n),n}function xD(e){if(e instanceof Nk){var t=Np.get(e.container);if(t=isNaN(t)?0:t,t>0&&(t-=1),F1e(e),t<=0){t=0;var r=Hp.get(e.container);r&&r.parentNode&&(r.parentNode.removeChild(r),Hp.delete(e.container)),e.mainElement=null}Np.set(e.container,t)}}function dd(e){"@babel/helpers - typeof";return dd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dd(e)}function V1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,U1e(n.key),n)}}function W1e(e,t,r){return t&&DD(e.prototype,t),r&&DD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function U1e(e){var t=z1e(e,"string");return dd(t)==="symbol"?t:String(t)}function z1e(e,t){if(dd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(dd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ND(e,t){HU(e,t),t.add(e)}function El(e,t,r){HU(e,t),t.set(e,r)}function HU(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _y(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}function vr(e,t){var r=LU(e,t,"get");return Y1e(e,r)}function Y1e(e,t){return t.get?t.get.call(e):t.value}function Tl(e,t,r){var n=LU(e,t,"set");return G1e(e,n,r),r}function LU(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function G1e(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var qo=new WeakMap,tS=new WeakMap,Qf=new WeakMap,AO=new WeakMap,IO=new WeakMap,ec=new WeakMap,Oy=new WeakSet,HD=new WeakSet,K1e=function(){function e(t){var r=t.countRows,n=t.countColumns,o=t.rowsLimit,i=t.columnsLimit,a=t.countColumnHeaders;V1e(this,e),ND(this,HD),ND(this,Oy),El(this,qo,{writable:!0,value:void 0}),El(this,tS,{writable:!0,value:void 0}),El(this,Qf,{writable:!0,value:void 0}),El(this,AO,{writable:!0,value:void 0}),El(this,IO,{writable:!0,value:void 0}),El(this,ec,{writable:!0,value:void 0}),Tl(this,tS,r),Tl(this,Qf,n),Tl(this,AO,o),Tl(this,IO,i),Tl(this,ec,a)}return W1e(e,[{key:"setSelectedRange",value:function(r){Tl(this,qo,r)}},{key:"getCellsRange",value:function(){if(vr(this,tS).call(this)===0||vr(this,Qf).call(this)===0)return null;var r=vr(this,qo).getTopStartCorner(),n=r.row,o=r.col,i=vr(this,qo).getBottomEndCorner(),a=i.row,l=i.col,s=_y(this,HD,q1e).call(this,n,a),u=_y(this,Oy,rS).call(this,o,l),f=a!==s||l!==u;return{isRangeTrimmed:f,startRow:n,startCol:o,endRow:s,endCol:u}}},{key:"getMostBottomColumnHeadersRange",value:function(){if(vr(this,Qf).call(this)===0||vr(this,ec).call(this)===0)return null;var r=vr(this,qo).getTopStartCorner(),n=r.col,o=vr(this,qo).getBottomEndCorner(),i=o.col,a=_y(this,Oy,rS).call(this,n,i),l=i!==a;return{isRangeTrimmed:l,startRow:-1,startCol:n,endRow:-1,endCol:a}}},{key:"getAllColumnHeadersRange",value:function(){if(vr(this,Qf).call(this)===0||vr(this,ec).call(this)===0)return null;var r=vr(this,qo).getTopStartCorner(),n=r.col,o=vr(this,qo).getBottomEndCorner(),i=o.col,a=_y(this,Oy,rS).call(this,n,i),l=i!==a;return{isRangeTrimmed:l,startRow:-vr(this,ec).call(this),startCol:n,endRow:-1,endCol:a}}}]),e}();function rS(e,t){return Math.min(t,Math.max(e+vr(this,IO).call(this)-1,e))}function q1e(e,t){return Math.min(t,Math.max(e+vr(this,AO).call(this)-1,e))}function jU(e){var t=[],r=[];return $(e,function(n){var o=Math.min(n.startRow,n.endRow),i=Math.max(n.startRow,n.endRow);_e(o,i,function(s){t.indexOf(s)===-1&&t.push(s)});var a=Math.min(n.startCol,n.endCol),l=Math.max(n.startCol,n.endCol);_e(a,l,function(s){r.indexOf(s)===-1&&r.push(s)})}),{rows:t,columns:r}}function X1e(e,t){return eAe(e)||Q1e(e,t)||J1e(e,t)||Z1e()}function Z1e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function J1e(e,t){if(e){if(typeof e=="string")return LD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return LD(e,t)}}function LD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Q1e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function eAe(e){if(Array.isArray(e))return e}function Ga(e){"@babel/helpers - typeof";return Ga=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ga(e)}function tAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,BU(n.key),n)}}function rAe(e,t,r){return t&&jD(e.prototype,t),r&&jD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ha(){return typeof Reflect<"u"&&Reflect.get?ha=Reflect.get.bind():ha=function(t,r,n){var o=nAe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ha.apply(this,arguments)}function nAe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=go(e),e!==null););return e}function oAe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&MO(e,t)}function MO(e,t){return MO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},MO(e,t)}function iAe(e){var t=lAe();return function(){var n=go(e),o;if(t){var i=go(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return aAe(this,o)}}function aAe(e,t){if(t&&(Ga(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dr(e)}function dr(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lAe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function go(e){return go=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},go(e)}function sAe(e,t){FU(e,t),t.add(e)}function Gi(e,t,r){FU(e,t),t.set(e,r)}function FU(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kl(e,t,r){return t=BU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function BU(e){var t=uAe(e,"string");return Ga(t)==="symbol"?t:String(t)}function uAe(e,t){if(Ga(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ga(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fAe(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}function Ar(e,t){var r=VU(e,t,"get");return cAe(e,r)}function cAe(e,t){return t.get?t.get.call(e):t.value}function Kn(e,t,r){var n=VU(e,t,"set");return hAe(e,n,r),r}function VU(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function hAe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}pe.getSingleton().register("afterCopyLimit");pe.getSingleton().register("modifyCopyableRange");pe.getSingleton().register("beforeCut");pe.getSingleton().register("afterCut");pe.getSingleton().register("beforePaste");pe.getSingleton().register("afterPaste");pe.getSingleton().register("beforeCopy");pe.getSingleton().register("afterCopy");var Ry="copyPaste",dAe=80,vAe=["fragmentSelection"],FD=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join(""),nS=new WeakMap,oS=new WeakMap,iS=new WeakMap,Pl=new WeakMap,Ey=new WeakMap,Ty=new WeakMap,$l=new WeakMap,BD=new WeakSet,yAe=function(e){oAe(r,e);var t=iAe(r);function r(){var n;tAe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),sAe(dr(n),BD),kl(dr(n),"columnsLimit",1/0),kl(dr(n),"rowsLimit",1/0),kl(dr(n),"pasteMode","overwrite"),kl(dr(n),"uiContainer",n.hot.rootDocument.body),Gi(dr(n),nS,{writable:!0,value:!1}),Gi(dr(n),oS,{writable:!0,value:!1}),Gi(dr(n),iS,{writable:!0,value:!1}),Gi(dr(n),Pl,{writable:!0,value:"cells-only"}),Gi(dr(n),Ey,{writable:!0,value:!1}),Gi(dr(n),Ty,{writable:!0,value:!1}),Gi(dr(n),$l,{writable:!0,value:new K1e({countRows:function(){return n.hot.countRows()},countColumns:function(){return n.hot.countCols()},rowsLimit:function(){return n.rowsLimit},columnsLimit:function(){return n.columnsLimit},countColumnHeaders:function(){return n.hot.view.getColumnHeadersCount()}})}),kl(dr(n),"copyableRanges",[]),kl(dr(n),"focusableElement",void 0),n}return rAe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Ry]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings(),a=i[Ry];if(Ga(a)==="object"){var l,s;this.pasteMode=(l=a.pasteMode)!==null&&l!==void 0?l:this.pasteMode,this.rowsLimit=isNaN(a.rowsLimit)?this.rowsLimit:a.rowsLimit,this.columnsLimit=isNaN(a.columnsLimit)?this.columnsLimit:a.columnsLimit,Kn(this,nS,!!a.copyColumnHeaders),Kn(this,oS,!!a.copyColumnGroupHeaders),Kn(this,iS,!!a.copyColumnHeadersOnly),this.uiContainer=(s=a.uiContainer)!==null&&s!==void 0?s:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",function(u){return o.onAfterContextMenuDefaultOptions(u)}),this.addHook("afterOnCellMouseUp",function(){return o.onAfterOnCellMouseUp()}),this.addHook("afterSelectionEnd",function(){return o.onAfterSelectionEnd()}),this.addHook("beforeKeyDown",function(){return o.onBeforeKeyDown()}),this.focusableElement=j1e(this.uiContainer),this.focusableElement.addLocalHook("copy",function(u){return o.onCopy(u)}).addLocalHook("cut",function(u){return o.onCut(u)}).addLocalHook("paste",function(u){return o.onPaste(u)}),ha(go(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),ha(go(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.focusableElement&&xD(this.focusableElement),ha(go(r.prototype),"disablePlugin",this).call(this)}},{key:"copy",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Kn(this,Pl,o),Kn(this,Ey,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}},{key:"copyCellsOnly",value:function(){this.copy("cells-only")}},{key:"copyColumnHeadersOnly",value:function(){this.copy("column-headers-only")}},{key:"copyWithAllColumnHeaders",value:function(){this.copy("with-column-group-headers")}},{key:"copyWithColumnHeaders",value:function(){this.copy("with-column-headers")}},{key:"cut",value:function(){Kn(this,Ty,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}},{key:"getRangedCopyableData",value:function(o){return Pc(this.getRangedData(o))}},{key:"getRangedData",value:function(o){var i=this,a=[],l=jU(o),s=l.rows,u=l.columns;return $(s,function(f){var c=[];$(u,function(h){f<0?c.push(i.hot.getColHeader(h,f)):c.push(i.hot.getCopyableData(f,h))}),a.push(c)}),a}},{key:"paste",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:o;if(!(!o&&!i)){var a=new x1e;o&&a.clipboardData.setData("text/plain",o),i&&a.clipboardData.setData("text/html",i),this.getOrCreateFocusableElement(),this.onPaste(a)}}},{key:"setCopyableText",value:function(){var o=this.hot.getSelectedRangeLast();if(o){Ar(this,$l).setSelectedRange(o);var i=new Map([["headers",null],["cells",null]]);Ar(this,Pl)==="column-headers-only"?i.set("headers",Ar(this,$l).getMostBottomColumnHeadersRange()):(Ar(this,Pl)==="with-column-headers"?i.set("headers",Ar(this,$l).getMostBottomColumnHeadersRange()):Ar(this,Pl)==="with-column-group-headers"&&i.set("headers",Ar(this,$l).getAllColumnHeadersRange()),i.set("cells",Ar(this,$l).getCellsRange())),this.copyableRanges=Array.from(i.values()).filter(function(c){return c!==null}).map(function(c){var h=c.startRow,d=c.startCol,v=c.endRow,g=c.endCol;return{startRow:h,startCol:d,endRow:v,endCol:g}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);var a=i.get("cells");if(a!==null&&a.isRangeTrimmed){var l=a.startRow,s=a.startCol,u=a.endRow,f=a.endCol;this.hot.runHooks("afterCopyLimit",u-l+1,f-s+1,this.rowsLimit,this.columnsLimit)}}}},{key:"getOrCreateFocusableElement",value:function(){var o,i=(o=this.hot.getActiveEditor())===null||o===void 0?void 0:o.TEXTAREA;i?this.focusableElement.setFocusableElement(i):this.focusableElement.useSecondaryElement()}},{key:"isEditorOpened",value:function(){var o;return(o=this.hot.getActiveEditor())===null||o===void 0?void 0:o.isOpened()}},{key:"populateValues",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(o.length){for(var a=o.length,l=o[0].length,s=[],u=i.getTopStartCorner(),f=u.row,c=u.col,h=i.getBottomEndCorner(),d=h.row,v=h.col,g=f,m=c,w=f,S=c;s.length<a||g<=d;){var C=this.hot.getCellMeta(g,c),k=C.skipRowOnPaste,R=C.visualRow;if(g=R+1,k!==!0){w=R,m=c;for(var V=[],U=s.length%a;V.length<l||m<=v;){var X=this.hot.getCellMeta(f,m),Y=X.skipColumnOnPaste,q=X.visualCol;if(m=q+1,Y!==!0){S=q;var Z=V.length%l;V.push(o[U][Z])}}s.push(V)}}return this.hot.populateFromArray(f,c,s,void 0,void 0,"CopyPaste.paste",this.pasteMode),[f,c,w,S]}}},{key:"onCopy",value:function(o){if(!(!this.hot.isListening()&&!Ar(this,Ey)||this.isEditorOpened())){this.setCopyableText(),Kn(this,Ey,!1);var i=this.getRangedData(this.copyableRanges),a=fAe(this,BD,gAe).call(this,this.copyableRanges),l=!!this.hot.runHooks("beforeCopy",i,this.copyableRanges,a);if(l){var s=Pc(i);if(o&&o.clipboardData){var u=JC(i,this.hot.rootDocument);o.clipboardData.setData("text/plain",s),o.clipboardData.setData("text/html",[FD,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",s);this.hot.runHooks("afterCopy",i,this.copyableRanges,a)}Kn(this,Pl,"cells-only"),o.preventDefault()}}},{key:"onCut",value:function(o){if(!(!this.hot.isListening()&&!Ar(this,Ty)||this.isEditorOpened())){this.setCopyableText(),Kn(this,Ty,!1);var i=this.getRangedData(this.copyableRanges),a=!!this.hot.runHooks("beforeCut",i,this.copyableRanges);if(a){var l=Pc(i);if(o&&o.clipboardData){var s=JC(i,this.hot.rootDocument);o.clipboardData.setData("text/plain",l),o.clipboardData.setData("text/html",[FD,s].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",i,this.copyableRanges)}o.preventDefault()}}},{key:"onPaste",value:function(o){if(!(!this.hot.isListening()||this.isEditorOpened())){o&&o.preventDefault&&o.preventDefault();var i;if(o&&typeof o.clipboardData<"u"){var a=xm(o.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});if(a&&/(<table)|(<TABLE)/g.test(a)){var l=e2(a,this.hot.rootDocument);i=l.data}else i=o.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(i=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof i=="string"&&(i=wSe(i)),!(i&&i.length===0)&&this.hot.runHooks("beforePaste",i,this.copyableRanges)!==!1){var s=this.populateValues(i),u=X1e(s,4),f=u[0],c=u[1],h=u[2],d=u[3];this.hot.selectCell(f,c,Math.min(this.hot.countRows()-1,h),Math.min(this.hot.countCols()-1,d)),this.hot.runHooks("afterPaste",i,this.copyableRanges)}}}},{key:"onAfterContextMenuDefaultOptions",value:function(o){o.items.push({name:"---------"},w1e(this)),Ar(this,nS)&&o.items.push(_1e(this)),Ar(this,oS)&&o.items.push(C1e(this)),Ar(this,iS)&&o.items.push(S1e(this)),o.items.push(O1e(this))}},{key:"onAfterOnCellMouseUp",value:function(){!this.hot.isListening()||this.isEditorOpened()||this.hot.getSettings().fragmentSelection||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}},{key:"onAfterSelectionEnd",value:function(){this.isEditorOpened()||(this.getOrCreateFocusableElement(),!(this.hot.getSettings().fragmentSelection&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&kV())&&(this.setCopyableText(),this.focusableElement.focus()))}},{key:"onBeforeKeyDown",value:function(){if(!(!this.hot.isListening()||this.isEditorOpened())){var o=this.hot.rootDocument.activeElement,i=this.hot.getActiveEditor();!i||o!==this.focusableElement.getFocusableElement()&&o!==i.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}}},{key:"destroy",value:function(){this.focusableElement&&(xD(this.focusableElement),this.focusableElement=null),ha(go(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Ry}},{key:"SETTING_KEYS",get:function(){return[Ry].concat(vAe)}},{key:"PLUGIN_PRIORITY",get:function(){return dAe}}]),r}(ot);function gAe(e){for(var t=jU(e),r=t.rows,n=0,o=0;o<r.length&&!(r[o]>=0);o++)n+=1;return{columnHeadersCount:n}}function WU(e,t){return"border_row".concat(e,"col").concat(t)}function gc(){return{width:1,color:"#000"}}function po(){return{hide:!0}}function pAe(){return{width:1,color:"#000",cornerVisible:!1}}function aS(e){if(ve(e.start)||ve(e.left)){var t;e.start=(t=e.start)!==null&&t!==void 0?t:e.left}if(ve(e.end)||ve(e.right)){var r;e.end=(r=e.end)!==null&&r!==void 0?r:e.right}return delete e.left,delete e.right,e}function tc(e){return ve(e.start)&&(e.left=e.start),ve(e.end)&&(e.right=e.end),e}function lS(e,t){return{id:WU(e,t),border:pAe(),row:e,col:t,top:po(),bottom:po(),start:po(),end:po()}}function mAe(e,t){return At(t,"border")&&t.border&&(e.border=t.border),At(t,"top")&&ve(t.top)&&(t.top?(Ve(t.top)||(t.top=gc()),e.top=t.top):(t.top=po(),e.top=t.top)),At(t,"bottom")&&ve(t.bottom)&&(t.bottom?(Ve(t.bottom)||(t.bottom=gc()),e.bottom=t.bottom):(t.bottom=po(),e.bottom=t.bottom)),At(t,"start")&&ve(t.start)&&(t.start?(Ve(t.start)||(t.start=gc()),e.start=t.start):(t.start=po(),e.start=t.start)),At(t,"end")&&ve(t.end)&&(t.end?(Ve(t.end)||(t.end=gc()),e.end=t.end):(t.end=po(),e.end=t.end)),e}function Lo(e,t){var r=!1;return $(e.getSelectedRange(),function(n){n.forAll(function(o,i){if(!(o<0||i<0)){var a=e.getCellMeta(o,i).borders;if(a)if(t){if(!At(a[t],"hide")||a[t].hide===!1)return r=!0,!1}else return r=!0,!1}})}),r}function ib(e){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(e)}function bAe(e){return e.some(function(t){return ve(t.left)||ve(t.right)})}function wAe(e){return e.some(function(t){return ve(t.start)||ve(t.end)})}var SAe=new Map([["left","start"],["right","end"]]);function CAe(e){var t;return(t=SAe.get(e))!==null&&t!==void 0?t:e}function _Ae(e){return{key:"borders:bottom",name:function(){var r=this.getTranslatedPhrase($T),n=Lo(this,"bottom");return n&&(r=ib(r)),r},callback:function(r,n){var o=Lo(this,"bottom");e.prepareBorder(n,"bottom",o)}}}function OAe(e){var t=e.hot.isRtl()?"end":"start";return{key:"borders:left",name:function(){var n=this.getTranslatedPhrase(AT),o=Lo(this,t);return o&&(n=ib(n)),n},callback:function(n,o){var i=Lo(this,t);e.prepareBorder(o,t,i)}}}function RAe(e){return{key:"borders:no_borders",name:function(){return this.getTranslatedPhrase(IT)},callback:function(r,n){e.prepareBorder(n,"noBorders")},disabled:function(){return!Lo(this)}}}function EAe(e){var t=e.hot.isRtl()?"start":"end";return{key:"borders:right",name:function(){var n=this.getTranslatedPhrase(PT),o=Lo(this,t);return o&&(n=ib(n)),n},callback:function(n,o){var i=Lo(this,t);e.prepareBorder(o,t,i)}}}function TAe(e){return{key:"borders:top",name:function(){var r=this.getTranslatedPhrase(kT),n=Lo(this,"top");return n&&(r=ib(r)),r},callback:function(r,n){var o=Lo(this,"top");e.prepareBorder(n,"top",o)}}}function Cu(e){"@babel/helpers - typeof";return Cu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cu(e)}function VD(e,t){return AAe(e)||$Ae(e,t)||PAe(e,t)||kAe()}function kAe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PAe(e,t){if(e){if(typeof e=="string")return WD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return WD(e,t)}}function WD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function $Ae(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function AAe(e){if(Array.isArray(e))return e}function IAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zU(n.key),n)}}function MAe(e,t,r){return t&&UD(e.prototype,t),r&&UD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function da(){return typeof Reflect<"u"&&Reflect.get?da=Reflect.get.bind():da=function(t,r,n){var o=xAe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},da.apply(this,arguments)}function xAe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=mo(e),e!==null););return e}function DAe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xO(e,t)}function xO(e,t){return xO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},xO(e,t)}function NAe(e){var t=LAe();return function(){var n=mo(e),o;if(t){var i=mo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return HAe(this,o)}}function HAe(e,t){if(t&&(Cu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return UU(e)}function UU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function LAe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mo(e){return mo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},mo(e)}function jAe(e,t,r){return t=zU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zU(e){var t=FAe(e,"string");return Cu(t)==="symbol"?t:String(t)}function FAe(e,t){if(Cu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ky="customBorders",BAe=90,VAe=function(e){DAe(r,e);var t=NAe(r);function r(){var n;IAe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),jAe(UU(n),"savedBorders",[]),n}return MAe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[ky]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(i){return o.onAfterContextMenuDefaultOptions(i)}),this.addHook("init",function(){return o.onAfterInit()}),da(mo(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hideBorders(),da(mo(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),da(mo(r.prototype),"updatePlugin",this).call(this)}},{key:"setBorders",value:function(o,i){var a=this,l=["top","bottom","start","end"],s=null;i&&(this.checkSettingsCohesion([i]),l=Object.keys(i),s=aS(i));var u=Ys(o),f=Bh(u);$(o,function(c){for(var h=f(c),d=VD(h,4),v=d[0],g=d[1],m=d[2],w=d[3],S=function(R){for(var V=function(Y){$(l,function(q){a.prepareBorderFromCustomAdded(R,Y,s,CAe(q))})},U=g;U<=w;U+=1)V(U)},C=v;C<=m;C+=1)S(C)}),this.hot.view.render()}},{key:"getBorders",value:function(o){var i=this;if(!Array.isArray(o))return this.savedBorders;var a=Ys(o),l=Bh(a),s=[];return $(o,function(u){for(var f=l(u),c=VD(f,4),h=c[0],d=c[1],v=c[2],g=c[3],m=function(C){for(var k=function(U){$(i.savedBorders,function(X){X.row===C&&X.col===U&&s.push(tc(X))})},R=d;R<=g;R+=1)k(R)},w=h;w<=v;w+=1)m(w)}),s}},{key:"clearBorders",value:function(o){var i=this;o?this.setBorders(o):($(this.savedBorders,function(a){i.clearBordersFromSelectionSettings(a.id),i.clearNullCellRange(),i.hot.removeCellMeta(a.row,a.col,"borders")}),this.savedBorders.length=0)}},{key:"insertBorderIntoSettings",value:function(o,i){var a=this.checkSavedBorders(o);a||this.savedBorders.push(o);var l=this.hot._createCellRange(this.hot._createCellCoords(o.row,o.col)),s=this.checkCustomSelections(o,l,i);s||this.hot.selection.highlight.addCustomSelection({border:o,visualCellRange:l})}},{key:"prepareBorderFromCustomAdded",value:function(o,i,a,l){var s=this.hot.countRows(),u=this.hot.countCols();if(!(o>=s||i>=u)){var f=lS(o,i);a&&(f=mAe(f,a),$(this.hot.selection.highlight.customSelections,function(c){if(f.id===c.settings.id)return Object.assign(c.settings,a),f.id=c.settings.id,f.top=c.settings.top,f.bottom=c.settings.bottom,f.start=c.settings.start,f.end=c.settings.end,!1})),this.hot.setCellMeta(o,i,"borders",tc(f)),this.insertBorderIntoSettings(f,l)}}},{key:"prepareBorderFromCustomAddedRange",value:function(o,i){var a=this,l=Math.min(o.to.row,this.hot.countRows()-1),s=Math.min(o.to.col,this.hot.countCols()-1);_e(o.from.row,l,function(u){_e(o.from.col,s,function(f){var c=lS(u,f),h=0;u===o.from.row&&At(i,"top")&&(h+=1,c.top=i.top),u===o.to.row&&At(i,"bottom")&&(h+=1,c.bottom=i.bottom),f===o.from.col&&At(i,"start")&&(h+=1,c.start=i.start),f===o.to.col&&At(i,"end")&&(h+=1,c.end=i.end),h>0&&(a.hot.setCellMeta(u,f,"borders",tc(c)),a.insertBorderIntoSettings(c))})})}},{key:"removeAllBorders",value:function(o,i){var a=WU(o,i);this.spliceBorder(a),this.clearBordersFromSelectionSettings(a),this.clearNullCellRange(),this.hot.removeCellMeta(o,i,"borders")}},{key:"setBorder",value:function(o,i,a,l){var s=this.hot.getCellMeta(o,i).borders;if(!s||s.border===void 0?s=lS(o,i):s=aS(s),l){s[a]=po();var u=this.countHide(s);if(u===4)this.removeAllBorders(o,i);else{var f=this.checkCustomSelectionsFromContextMenu(s,a,l);f||this.insertBorderIntoSettings(s),this.hot.setCellMeta(o,i,"borders",tc(s))}}else{s[a]=gc();var c=this.checkCustomSelectionsFromContextMenu(s,a,l);c||this.insertBorderIntoSettings(s),this.hot.setCellMeta(o,i,"borders",tc(s))}}},{key:"prepareBorder",value:function(o,i,a){var l=this;$(o,function(s){var u=s.start,f=s.end;if(u.row===f.row&&u.col===f.col)i==="noBorders"?l.removeAllBorders(u.row,u.col):l.setBorder(u.row,u.col,i,a);else switch(i){case"noBorders":_e(u.col,f.col,function(c){_e(u.row,f.row,function(h){l.removeAllBorders(h,c)})});break;case"top":_e(u.col,f.col,function(c){l.setBorder(u.row,c,i,a)});break;case"bottom":_e(u.col,f.col,function(c){l.setBorder(f.row,c,i,a)});break;case"start":_e(u.row,f.row,function(c){l.setBorder(c,u.col,i,a)});break;case"end":_e(u.row,f.row,function(c){l.setBorder(c,f.col,i,a)});break}})}},{key:"createCustomBorders",value:function(o){var i=this;$(o,function(a){var l=aS(a);a.range?i.prepareBorderFromCustomAddedRange(a.range,l):i.prepareBorderFromCustomAdded(a.row,a.col,l)})}},{key:"countHide",value:function(o){var i=o.top,a=o.bottom,l=o.start,s=o.end,u=[i,a,l,s];return Lt(u,function(f,c){var h=f;return c&&c.hide&&(h+=1),h},0)}},{key:"clearBordersFromSelectionSettings",value:function(o){var i=Be(this.hot.selection.highlight.customSelections,function(a){return a.settings.id}).indexOf(o);i>-1&&this.hot.selection.highlight.customSelections[i].clear()}},{key:"clearNullCellRange",value:function(){var o=this;$(this.hot.selection.highlight.customSelections,function(i,a){if(i.cellRange===null)return o.hot.selection.highlight.customSelections[a].destroy(),o.hot.selection.highlight.customSelections.splice(a,1),!1})}},{key:"hideBorders",value:function(){var o=this;$(this.savedBorders,function(i){o.clearBordersFromSelectionSettings(i.id),o.clearNullCellRange()})}},{key:"spliceBorder",value:function(o){var i=Be(this.savedBorders,function(a){return a.id}).indexOf(o);i>-1&&this.savedBorders.splice(i,1)}},{key:"checkSavedBorders",value:function(o){var i=this,a=!1,l=this.countHide(o);return l===4?(this.spliceBorder(o.id),a=!0):$(this.savedBorders,function(s,u){if(o.id===s.id)return i.savedBorders[u]=o,a=!0,!1}),a}},{key:"checkCustomSelectionsFromContextMenu",value:function(o,i,a){var l=!1;return $(this.hot.selection.highlight.customSelections,function(s){if(o.id===s.settings.id)return We(s.instanceBorders,function(u){u.toggleHiddenClass(i,a)}),l=!0,!1}),l}},{key:"checkCustomSelections",value:function(o,i,a){var l=this.countHide(o),s=!1;return l===4?(this.removeAllBorders(o.row,o.col),s=!0):$(this.hot.selection.highlight.customSelections,function(u){if(o.id===u.settings.id)return u.visualCellRange=i,u.commit(),a&&We(u.instanceBorders,function(f){f.changeBorderStyle(a,o)}),s=!0,!1}),s}},{key:"changeBorderSettings",value:function(){var o=this.hot.getSettings()[ky];if(Array.isArray(o)){var i=lr(o);this.checkSettingsCohesion(i),i.length||(this.savedBorders=i),this.createCustomBorders(i)}else o!==void 0&&this.createCustomBorders(this.savedBorders)}},{key:"checkSettingsCohesion",value:function(o){var i=bAe(o),a=wAe(o);if(i&&a)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&i)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}},{key:"onAfterContextMenuDefaultOptions",value:function(o){this.hot.getSettings()[ky]&&o.items.push({name:"---------"},{key:"borders",name:function(){return this.getTranslatedPhrase(TT)},disabled:function(){return this.selection.isSelectedByCorner()},submenu:{items:[TAe(this),EAe(this),_Ae(this),OAe(this),RAe(this)]}})}},{key:"onAfterInit",value:function(){this.changeBorderSettings()}},{key:"destroy",value:function(){da(mo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return ky}},{key:"PLUGIN_PRIORITY",get:function(){return BAe}}]),r}(ot);function _u(e){"@babel/helpers - typeof";return _u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_u(e)}function WAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zAe(n.key),n)}}function UAe(e,t,r){return t&&zD(e.prototype,t),r&&zD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zAe(e){var t=YAe(e,"string");return _u(t)==="symbol"?t:String(t)}function YAe(e,t){if(_u(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_u(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function va(){return typeof Reflect<"u"&&Reflect.get?va=Reflect.get.bind():va=function(t,r,n){var o=GAe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},va.apply(this,arguments)}function GAe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=bo(e),e!==null););return e}function KAe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&DO(e,t)}function DO(e,t){return DO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},DO(e,t)}function qAe(e){var t=ZAe();return function(){var n=bo(e),o;if(t){var i=bo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return XAe(this,o)}}function XAe(e,t){if(t&&(_u(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return YU(e)}function YU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ZAe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bo(e){return bo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bo(e)}var YD="dragToScroll",JAe=100,QAe=function(e){KAe(r,e);var t=qAe(r);function r(n){var o;return WAe(this,r),o=t.call(this,n),o.eventManager=new Tt(YU(o)),o.boundaries=null,o.callback=null,o.listening=!1,o}return UAe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[YD]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterOnCellMouseDown",function(i){return o.setupListening(i)}),this.addHook("afterOnCellCornerMouseDown",function(i){return o.setupListening(i)}),this.registerEvents(),va(bo(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),va(bo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.unregisterEvents(),va(bo(r.prototype),"disablePlugin",this).call(this)}},{key:"setBoundaries",value:function(o){this.boundaries=o}},{key:"setCallback",value:function(o){this.callback=o}},{key:"check",value:function(o,i){var a=0,l=0;i<this.boundaries.top?l=i-this.boundaries.top:i>this.boundaries.bottom&&(l=i-this.boundaries.bottom),o<this.boundaries.left?a=o-this.boundaries.left:o>this.boundaries.right&&(a=o-this.boundaries.right),this.callback(a,l)}},{key:"listen",value:function(){this.listening=!0}},{key:"unlisten",value:function(){this.listening=!1}},{key:"isListening",value:function(){return this.listening}},{key:"registerEvents",value:function(){for(var o=this,i=this.hot.rootWindow,a=i;a;)this.eventManager.addEventListener(a.document,"contextmenu",function(){return o.unlisten()}),this.eventManager.addEventListener(a.document,"mouseup",function(){return o.unlisten()}),this.eventManager.addEventListener(a.document,"mousemove",function(l){return o.onMouseMove(l)}),a=Wc(a)}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"setupListening",value:function(o){if(!ki(o)){var i=this.hot.view._wt.wtTable.holder;i!==this.hot.rootWindow&&(this.setBoundaries(i.getBoundingClientRect()),this.setCallback(function(a,l){a<0?i.scrollLeft-=50:a>0&&(i.scrollLeft+=50),l<0?i.scrollTop-=20:l>0&&(i.scrollTop+=20)}),this.listen())}}},{key:"onMouseMove",value:function(o){this.isListening()&&this.check(o.clientX,o.clientY)}},{key:"destroy",value:function(){va(bo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return YD}},{key:"PLUGIN_PRIORITY",get:function(){return JAe}}]),r}(ot);function Ou(e){"@babel/helpers - typeof";return Ou=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ou(e)}function eIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rIe(n.key),n)}}function tIe(e,t,r){return t&&GD(e.prototype,t),r&&GD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rIe(e){var t=nIe(e,"string");return Ou(t)==="symbol"?t:String(t)}function nIe(e,t){if(Ou(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ou(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ya(){return typeof Reflect<"u"&&Reflect.get?ya=Reflect.get.bind():ya=function(t,r,n){var o=oIe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ya.apply(this,arguments)}function oIe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=wo(e),e!==null););return e}function iIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&NO(e,t)}function NO(e,t){return NO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},NO(e,t)}function aIe(e){var t=sIe();return function(){var n=wo(e),o;if(t){var i=wo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return lIe(this,o)}}function lIe(e,t){if(t&&(Ou(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return GU(e)}function GU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sIe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wo(e){return wo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wo(e)}pe.getSingleton().register("afterDropdownMenuDefaultOptions");pe.getSingleton().register("beforeDropdownMenuShow");pe.getSingleton().register("afterDropdownMenuShow");pe.getSingleton().register("afterDropdownMenuHide");pe.getSingleton().register("afterDropdownMenuExecute");var sS="dropdownMenu",uIe=230,uS="changeType",KU=function(e){iIe(r,e);var t=aIe(r);function r(n){var o;return eIe(this,r),o=t.call(this,n),o.eventManager=new Tt(GU(o)),o.commandExecutor=new PU(o.hot),o.itemsFactory=null,o.menu=null,o.hot.addHook("afterGetColHeader",function(i,a){return o.onAfterGetColHeader(i,a)}),o}return tIe(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[sS]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){this.itemsFactory=new AU(this.hot,r.DEFAULT_ITEMS);var i=this.hot.getSettings()[sS],a={items:this.itemsFactory.getItems(i)};this.registerEvents(),typeof i.callback=="function"&&this.commandExecutor.setCommonCallback(i.callback),ya(wo(r.prototype),"enablePlugin",this).call(this),this.callOnPluginsReady(function(){o.hot.runHooks("afterDropdownMenuDefaultOptions",a),o.itemsFactory.setPredefinedItems(a.items);var l=o.itemsFactory.getItems(i);o.menu&&o.menu.destroy(),o.menu=new Dk(o.hot,{className:"htDropdownMenu",keepInViewport:!0,container:i.uiContainer||o.hot.rootDocument.body}),o.hot.runHooks("beforeDropdownMenuSetItems",l),o.menu.setMenuItems(l),o.menu.addLocalHook("beforeOpen",function(){return o.onMenuBeforeOpen()}),o.menu.addLocalHook("afterOpen",function(){return o.onMenuAfterOpen()}),o.menu.addLocalHook("afterClose",function(){return o.onMenuAfterClose()}),o.menu.addLocalHook("executeCommand",function(){for(var s,u=arguments.length,f=new Array(u),c=0;c<u;c++)f[c]=arguments[c];return(s=o.executeCommand).call.apply(s,[o].concat(f))}),$(l,function(s){return o.commandExecutor.registerCommand(s.key,s)})})}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ya(wo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&this.menu.destroy(),ya(wo(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var o=this;this.eventManager.addEventListener(this.hot.rootElement,"click",function(i){return o.onTableClick(i)})}},{key:"open",value:function(o){this.menu&&(this.menu.open(),o.width&&this.menu.setOffset("left",o.width),this.menu.setPosition(o))}},{key:"close",value:function(){this.menu&&this.menu.close()}},{key:"executeCommand",value:function(o){for(var i,a=arguments.length,l=new Array(a>1?a-1:0),s=1;s<a;s++)l[s-1]=arguments[s];(i=this.commandExecutor).execute.apply(i,[o].concat(l))}},{key:"setListening",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(o?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}},{key:"onTableClick",value:function(o){if(o.stopPropagation(),xe(o.target,uS)&&!this.menu.isOpened()){var i=0,a=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var l=this.hot.rootWindow.frameElement,s=l.getBoundingClientRect(),u=s.top,f=s.left;i=u,a=f}var c=o.target.getBoundingClientRect();this.open({left:c.left+a,top:c.top+o.target.offsetHeight+3+i,width:c.width,height:c.height})}}},{key:"onAfterGetColHeader",value:function(o,i){var a=i.parentNode;if(a){var l=a.parentNode.childNodes,s=Array.prototype.indexOf.call(l,a);if(!(o<0||s!==l.length-1)){var u=i.querySelector(".".concat(uS));if(!(this.enabled&&u)){if(!this.enabled){u&&u.parentNode.removeChild(u);return}var f=this.hot.rootDocument.createElement("button");f.className=uS,f.type="button",f.onclick=function(){return!1},i.firstChild.insertBefore(f,i.firstChild.firstChild)}}}}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeDropdownMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterDropdownMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),ya(wo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return sS}},{key:"PLUGIN_PRIORITY",get:function(){return uIe}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[$v,Av,Ye,Mv,Ye,Qm,Ye,Iv,Ye,Gr]}}]),r}(ot);KU.SEPARATOR={name:Ye};function vd(e){"@babel/helpers - typeof";return vd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vd(e)}function fIe(e,t){return vIe(e)||dIe(e,t)||hIe(e,t)||cIe()}function cIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hIe(e,t){if(e){if(typeof e=="string")return KD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return KD(e,t)}}function KD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function dIe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function vIe(e){if(Array.isArray(e))return e}function yIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pIe(n.key),n)}}function gIe(e,t,r){return t&&qD(e.prototype,t),r&&qD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pIe(e){var t=mIe(e,"string");return vd(t)==="symbol"?t:String(t)}function mIe(e,t){if(vd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bIe=function(){function e(t){yIe(this,e),this.hot=t,this.options={}}return gIe(e,[{key:"setOptions",value:function(r){this.options=r}},{key:"getData",value:function(){var r=this,n=this._getDataRange(),o=n.startRow,i=n.startCol,a=n.endRow,l=n.endCol,s=this.options,u=[];return _e(o,a,function(f){var c=[];!s.exportHiddenRows&&r._isHiddenRow(f)||(_e(i,l,function(h){!s.exportHiddenColumns&&r._isHiddenColumn(h)||c.push(r.hot.getDataAtCell(f,h))}),u.push(c))}),u}},{key:"getRowHeaders",value:function(){var r=this,n=[];if(this.options.rowHeaders){var o=this._getDataRange(),i=o.startRow,a=o.endRow,l=this.hot.getRowHeader();_e(i,a,function(s){!r.options.exportHiddenRows&&r._isHiddenRow(s)||n.push(l[s])})}return n}},{key:"getColumnHeaders",value:function(){var r=this,n=[];if(this.options.columnHeaders){var o=this._getDataRange(),i=o.startCol,a=o.endCol,l=this.hot.getColHeader();_e(i,a,function(s){!r.options.exportHiddenColumns&&r._isHiddenColumn(s)||n.push(l[s])})}return n}},{key:"_getDataRange",value:function(){var r=this.hot.countCols()-1,n=this.hot.countRows()-1,o=fIe(this.options.range,4),i=o[0],a=i===void 0?0:i,l=o[1],s=l===void 0?0:l,u=o[2],f=u===void 0?n:u,c=o[3],h=c===void 0?r:c;return a=Math.max(a,0),s=Math.max(s,0),f=Math.min(f,n),h=Math.min(h,r),{startRow:a,startCol:s,endRow:f,endCol:h}}},{key:"_isHiddenRow",value:function(r){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(r))}},{key:"_isHiddenColumn",value:function(r){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(r))}}]),e}();const wIe=bIe;function yd(e){"@babel/helpers - typeof";return yd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yd(e)}function SIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_Ie(n.key),n)}}function CIe(e,t,r){return t&&XD(e.prototype,t),r&&XD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _Ie(e){var t=OIe(e,"string");return yd(t)==="symbol"?t:String(t)}function OIe(e,t){if(yd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var RIe=function(){function e(t,r){SIe(this,e),this.dataProvider=t,this.options=this._mergeOptions(r),this.dataProvider.setOptions(this.options)}return CIe(e,[{key:"_mergeOptions",value:function(r){var n=pr(this.constructor.DEFAULT_OPTIONS),o=new Date;return n=Wt(pr(e.DEFAULT_OPTIONS),n),n=Wt(n,r),n.filename=pE(n.filename,{YYYY:o.getFullYear(),MM:"".concat(o.getMonth()+1).padStart(2,"0"),DD:"".concat(o.getDate()).padStart(2,"0")}),n}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}}]),e}();const EIe=RIe;function Ru(e){"@babel/helpers - typeof";return Ru=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ru(e)}function TIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,PIe(n.key),n)}}function kIe(e,t,r){return t&&ZD(e.prototype,t),r&&ZD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function PIe(e){var t=$Ie(e,"string");return Ru(t)==="symbol"?t:String(t)}function $Ie(e,t){if(Ru(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ru(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function AIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&HO(e,t)}function HO(e,t){return HO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},HO(e,t)}function IIe(e){var t=DIe();return function(){var n=Lp(e),o;if(t){var i=Lp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return MIe(this,o)}}function MIe(e,t){if(t&&(Ru(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xIe(e)}function xIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function DIe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Lp(e){return Lp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Lp(e)}var NIe=String.fromCharCode(13),HIe=String.fromCharCode(34),LIe=String.fromCharCode(10),jIe=function(e){AIe(r,e);var t=IIe(r);function r(){return TIe(this,r),t.apply(this,arguments)}return kIe(r,[{key:"export",value:function(){var o=this,i=this.options,a=this.dataProvider.getData(),l=this.dataProvider.getColumnHeaders(),s=l.length>0,u=this.dataProvider.getRowHeaders(),f=u.length>0,c=i.bom?String.fromCharCode(65279):"";return s&&(l=Be(l,function(h){return o._escapeCell(h,!0)}),f&&(c+=i.columnDelimiter),c+=l.join(i.columnDelimiter),c+=i.rowDelimiter),$(a,function(h,d){d>0&&(c+=i.rowDelimiter),f&&(c+=o._escapeCell(u[d])+i.columnDelimiter),c+=h.map(function(v){return o._escapeCell(v)}).join(i.columnDelimiter)}),c}},{key:"_escapeCell",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=It(o);return a!==""&&(i||a.indexOf(NIe)>=0||a.indexOf(HIe)>=0||a.indexOf(LIe)>=0||a.indexOf(this.options.columnDelimiter)>=0)&&(a=a.replace(new RegExp('"',"g"),'""'),a='"'.concat(a,'"')),a}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}}]),r}(EIe);const FIe=jIe;function gd(e){"@babel/helpers - typeof";return gd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gd(e)}function BIe(e,t,r){return t=VIe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function VIe(e){var t=WIe(e,"string");return gd(t)==="symbol"?t:String(t)}function WIe(e,t){if(gd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var UIe="csv",LO=BIe({},UIe,FIe);function zIe(e,t,r){return typeof LO[e]=="function"?new LO[e](t,r):null}function Eu(e){"@babel/helpers - typeof";return Eu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Eu(e)}function YIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,KIe(n.key),n)}}function GIe(e,t,r){return t&&JD(e.prototype,t),r&&JD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function KIe(e){var t=qIe(e,"string");return Eu(t)==="symbol"?t:String(t)}function qIe(e,t){if(Eu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Eu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function XIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jO(e,t)}function jO(e,t){return jO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},jO(e,t)}function ZIe(e){var t=eMe();return function(){var n=jp(e),o;if(t){var i=jp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return JIe(this,o)}}function JIe(e,t){if(t&&(Eu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return QIe(e)}function QIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eMe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function jp(e){return jp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},jp(e)}var tMe="exportFile",rMe=240,nMe=function(e){XIe(r,e);var t=ZIe(r);function r(){return YIe(this,r),t.apply(this,arguments)}return GIe(r,[{key:"isEnabled",value:function(){return!0}},{key:"exportAsString",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(o,i).export()}},{key:"exportAsBlob",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(o,i))}},{key:"downloadFile",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=this.hot,l=a.rootDocument,s=a.rootWindow,u=this._createTypeFormatter(o,i),f=this._createBlob(u),c=s.URL||s.webkitURL,h=l.createElement("a"),d="".concat(u.options.filename,".").concat(u.options.fileExtension);if(h.download!==void 0){var v=c.createObjectURL(f);h.style.display="none",h.setAttribute("href",v),h.setAttribute("download",d),l.body.appendChild(h),h.dispatchEvent(new MouseEvent("click")),l.body.removeChild(h),setTimeout(function(){c.revokeObjectURL(v)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(f,d)}},{key:"_createTypeFormatter",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!LO[o])throw new Error('Export format type "'.concat(o,'" is not supported.'));return zIe(o,new wIe(this.hot),i)}},{key:"_createBlob",value:function(o){var i=null;return typeof Blob<"u"&&(i=new Blob([o.export()],{type:"".concat(o.options.mimeType,";charset=").concat(o.options.encoding)})),i}}],[{key:"PLUGIN_KEY",get:function(){return tMe}},{key:"PLUGIN_PRIORITY",get:function(){return rMe}}]),r}(ot);function pd(e){"@babel/helpers - typeof";return pd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pd(e)}function oMe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,aMe(n.key),n)}}function iMe(e,t,r){return t&&QD(e.prototype,t),r&&QD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function aMe(e){var t=lMe(e,"string");return pd(t)==="symbol"?t:String(t)}function lMe(e,t){if(pd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qU=function(){function e(t,r){var n=r.id,o=r.stateless,i=o===void 0?!0:o;oMe(this,e),this.hot=t,this.id=n,this.elements=[],this.hidden=!1,this.stateId="Filters.component.".concat(this.id),this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Vm)}return iMe(e,[{key:"reset",value:function(){$(this.elements,function(r){return r.reset()})}},{key:"hide",value:function(){this.hidden=!0}},{key:"show",value:function(){this.hidden=!1}},{key:"isHidden",value:function(){return this.hot===null||this.hidden}},{key:"restoreState",value:function(r){this.state&&this.setState(this.state.getValueAtIndex(r))}},{key:"setState",value:function(){throw new Error("The state setting logic is not implemented")}},{key:"saveState",value:function(r){this.state&&this.state.setValueAtIndex(r,this.getState())}},{key:"getState",value:function(){throw new Error("The state gathering logic is not implemented")}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),$(this.elements,function(r){return r.destroy()}),this.state=null,this.elements=null,this.hot=null}}]),e}();pt(qU,Pr);const ab=qU;var md={};function Pi(e,t){if(!md[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));var r=md[e],n=r.condition,o=r.descriptor,i=t;return o.inputValuesDecorator&&(i=o.inputValuesDecorator(i)),function(a){return n.apply(a.meta.instance,[].concat([a],[i]))}}function ga(e){if(!md[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));return md[e].descriptor}function Gt(e,t,r){r.key=e,md[e]={condition:t,descriptor:r}}var Qt="none";function sMe(){return!0}Gt(Qt,sMe,{name:Wm,inputsCount:0,showOperators:!1});var Mc="empty";function uMe(e){return Kt(e.value)}Gt(Mc,uMe,{name:jT,inputsCount:0,showOperators:!0});var Sg="not_empty";function fMe(e,t){return!Pi(Mc,t)(e)}Gt(Sg,fMe,{name:FT,inputsCount:0,showOperators:!0});function cMe(e,t){return yMe(e)||vMe(e,t)||dMe(e,t)||hMe()}function hMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dMe(e,t){if(e){if(typeof e=="string")return eN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return eN(e,t)}}function eN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function vMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function yMe(e){if(Array.isArray(e))return e}var xc="eq";function gMe(e,t){var r=cMe(t,1),n=r[0];return It(e.value).toLocaleLowerCase(e.meta.locale)===It(n)}Gt(xc,gMe,{name:BT,inputsCount:1,showOperators:!0});var Cg="neq";function pMe(e,t){return!Pi(xc,t)(e)}Gt(Cg,pMe,{name:VT,inputsCount:1,showOperators:!0});function mMe(e,t){return CMe(e)||SMe(e,t)||wMe(e,t)||bMe()}function bMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wMe(e,t){if(e){if(typeof e=="string")return tN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tN(e,t)}}function tN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function SMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function CMe(e){if(Array.isArray(e))return e}var XU="gt";function _Me(e,t){var r=mMe(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value>o}Gt(XU,_Me,{name:GT,inputsCount:1,showOperators:!0});function OMe(e,t){return kMe(e)||TMe(e,t)||EMe(e,t)||RMe()}function RMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function EMe(e,t){if(e){if(typeof e=="string")return rN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return rN(e,t)}}function rN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function TMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function kMe(e){if(Array.isArray(e))return e}var ZU="gte";function PMe(e,t){var r=OMe(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value>=o}Gt(ZU,PMe,{name:KT,inputsCount:1,showOperators:!0});function $Me(e,t){return xMe(e)||MMe(e,t)||IMe(e,t)||AMe()}function AMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function IMe(e,t){if(e){if(typeof e=="string")return nN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nN(e,t)}}function nN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function MMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function xMe(e){if(Array.isArray(e))return e}var JU="lt";function DMe(e,t){var r=$Me(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value<o}Gt(JU,DMe,{name:qT,inputsCount:1,showOperators:!0});function NMe(e,t){return FMe(e)||jMe(e,t)||LMe(e,t)||HMe()}function HMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LMe(e,t){if(e){if(typeof e=="string")return oN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return oN(e,t)}}function oN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function jMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function FMe(e){if(Array.isArray(e))return e}var QU="lte";function BMe(e,t){var r=NMe(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value<=o}Gt(QU,BMe,{name:XT,inputsCount:1,showOperators:!0});function VMe(e,t){return YMe(e)||zMe(e,t)||UMe(e,t)||WMe()}function WMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function UMe(e,t){if(e){if(typeof e=="string")return iN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return iN(e,t)}}function iN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function zMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function YMe(e){if(Array.isArray(e))return e}var Hk="date_after";function GMe(e,t){var r=VMe(t,1),n=r[0],o=te(e.value,e.meta.dateFormat),i=te(n,e.meta.dateFormat);return!o.isValid()||!i.isValid()?!1:o.diff(i)>=0}Gt(Hk,GMe,{name:QT,inputsCount:1,showOperators:!0});function KMe(e,t){return JMe(e)||ZMe(e,t)||XMe(e,t)||qMe()}function qMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function XMe(e,t){if(e){if(typeof e=="string")return aN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return aN(e,t)}}function aN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ZMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function JMe(e){if(Array.isArray(e))return e}var Lk="date_before";function QMe(e,t){var r=KMe(t,1),n=r[0],o=te(e.value,e.meta.dateFormat),i=te(n,e.meta.dateFormat);return!o.isValid()||!i.isValid()?!1:o.diff(i)<=0}Gt(Lk,QMe,{name:ek,inputsCount:1,showOperators:!0});function exe(e,t){return oxe(e)||nxe(e,t)||rxe(e,t)||txe()}function txe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rxe(e,t){if(e){if(typeof e=="string")return lN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return lN(e,t)}}function lN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function nxe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function oxe(e){if(Array.isArray(e))return e}var Fp="between";function ixe(e,t){var r=exe(t,2),n=r[0],o=r[1],i=n,a=o;if(e.meta.type==="numeric"){var l=parseFloat(i,10),s=parseFloat(a,10);i=Math.min(l,s),a=Math.max(l,s)}else if(e.meta.type==="date"){var u=Pi(Lk,[a]),f=Pi(Hk,[i]);return u(e)&&f(e)}return e.value>=i&&e.value<=a}Gt(Fp,ixe,{name:ZT,inputsCount:2,showOperators:!0});var ez="not_between";function axe(e,t){return!Pi(Fp,t)(e)}Gt(ez,axe,{name:JT,inputsCount:2,showOperators:!0});function lxe(e,t){return cxe(e)||fxe(e,t)||uxe(e,t)||sxe()}function sxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uxe(e,t){if(e){if(typeof e=="string")return sN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return sN(e,t)}}function sN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function fxe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function cxe(e){if(Array.isArray(e))return e}var tz="begins_with";function hxe(e,t){var r=lxe(t,1),n=r[0];return It(e.value).toLocaleLowerCase(e.meta.locale).startsWith(It(n))}Gt(tz,hxe,{name:WT,inputsCount:1,showOperators:!0});var dxe=Ae,vxe=im,yxe=jn.f,gxe=Qa,uN=Yt,pxe=L0,mxe=Tr,bxe=j0,wxe=vxe("".slice),Sxe=Math.min,rz=bxe("endsWith"),Cxe=!rz&&!!function(){var e=yxe(String.prototype,"endsWith");return e&&!e.writable}();dxe({target:"String",proto:!0,forced:!Cxe&&!rz},{endsWith:function(t){var r=uN(mxe(this));pxe(t);var n=arguments.length>1?arguments[1]:void 0,o=r.length,i=n===void 0?o:Sxe(gxe(n),o),a=uN(t);return wxe(r,i-a.length,i)===a}});function _xe(e,t){return Txe(e)||Exe(e,t)||Rxe(e,t)||Oxe()}function Oxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Rxe(e,t){if(e){if(typeof e=="string")return fN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fN(e,t)}}function fN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Exe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Txe(e){if(Array.isArray(e))return e}var nz="ends_with";function kxe(e,t){var r=_xe(t,1),n=r[0];return It(e.value).toLocaleLowerCase(e.meta.locale).endsWith(It(n))}Gt(nz,kxe,{name:UT,inputsCount:1,showOperators:!0});function Pxe(e,t){return Mxe(e)||Ixe(e,t)||Axe(e,t)||$xe()}function $xe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Axe(e,t){if(e){if(typeof e=="string")return cN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return cN(e,t)}}function cN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ixe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Mxe(e){if(Array.isArray(e))return e}var jk="contains";function xxe(e,t){var r=Pxe(t,1),n=r[0];return It(e.value).toLocaleLowerCase(e.meta.locale).indexOf(It(n))>=0}Gt(jk,xxe,{name:zT,inputsCount:1,showOperators:!0});var oz="not_contains";function Dxe(e,t){return!Pi(jk,t)(e)}Gt(oz,Dxe,{name:YT,inputsCount:1,showOperators:!0});var iz="date_tomorrow";function Nxe(e){var t=te(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(te().subtract(-1,"days").startOf("day"),"d"):!1}Gt(iz,Nxe,{name:rk,inputsCount:0});var az="date_today";function Hxe(e){var t=te(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(te().startOf("day"),"d"):!1}Gt(az,Hxe,{name:tk,inputsCount:0});var lz="date_yesterday";function Lxe(e){var t=te(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(te().subtract(1,"days").startOf("day"),"d"):!1}Gt(lz,Lxe,{name:nk,inputsCount:0});cB();function jxe(e,t){var r=e;return r===""&&(r="(".concat(t,")")),r}var FO=new Set([1]).has(1),Fxe=FO&&typeof Array.from=="function";function xv(e){var t=e;return FO&&(t=new Set(t)),function(r){var n;return FO?n=t.has(r):n=!!~t.indexOf(r),n}}function sz(e){return e??""}function BO(e){var t=e;return Fxe?t=Array.from(new Set(t)):t=U0(t),t=t.sort(function(r,n){return typeof r=="number"&&typeof n=="number"?r-n:r===n?0:r>n?1:-1}),t}function hN(e,t,r,n){var o=[],i=e===t,a;return i||(a=xv(t)),$(e,function(l){var s=!1;(i||a(l))&&(s=!0);var u={checked:s,value:l,visualValue:jxe(l,r)};n&&n(u),o.push(u)}),o}function uz(e,t){return Uxe(e)||Wxe(e,t)||Vxe(e,t)||Bxe()}function Bxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Vxe(e,t){if(e){if(typeof e=="string")return dN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dN(e,t)}}function dN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Wxe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Uxe(e){if(Array.isArray(e))return e}var pa="by_value";function zxe(e,t){var r=uz(t,1),n=r[0];return n(e.value)}Gt(pa,zxe,{name:"By value",inputsCount:0,inputValuesDecorator:function(t){var r=uz(t,1),n=r[0];return[xv(n)]},showOperators:!1});var bd={};function Yxe(e){if(!bd[e])throw Error('Operation with id "'.concat(e,'" does not exist.'));var t=bd[e].func;return function(r,n){return t(r,n)}}function Gxe(e){return bd[e].name}function Fk(e,t,r){bd[e]={name:t,func:r}}var mi="conjunction",Kxe=ak;function qxe(e,t){return e.every(function(r){return r.func(t)})}Fk(mi,Kxe,qxe);var Bp="disjunction",Xxe=Um;function Zxe(e,t){return e.some(function(r){return r.func(t)})}Fk(Bp,Xxe,Zxe);var Bk="disjunctionWithExtraCondition",Jxe=Um;function Qxe(e,t){if(e.length<3)throw Error("Operation doesn't work on less then three conditions.");return e.slice(0,e.length-1).some(function(r){return r.func(t)})&&e[e.length-1].func(t)}Fk(Bk,Jxe,Qxe);function wd(e){"@babel/helpers - typeof";return wd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wd(e)}var rc;function fS(e,t,r){return t=eDe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eDe(e){var t=tDe(e,"string");return wd(t)==="symbol"?t:String(t)}function tDe(e,t){if(wd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rDe="numeric",fz="text",nDe="date",vN=(rc={},fS(rc,rDe,[Qt,Ye,Mc,Sg,Ye,xc,Cg,Ye,XU,ZU,JU,QU,Fp,ez]),fS(rc,fz,[Qt,Ye,Mc,Sg,Ye,xc,Cg,Ye,tz,nz,Ye,jk,oz]),fS(rc,nDe,[Qt,Ye,Mc,Sg,Ye,xc,Cg,Ye,Lk,Hk,Fp,Ye,iz,az,lz]),rc);function oDe(e){var t=[],r=e;return vN[r]||(r=fz),$(vN[r],function(n){var o;n===Ye?o={name:Ye}:o=pr(ga(n)),t.push(o)}),t}function Sd(e){"@babel/helpers - typeof";return Sd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sd(e)}function iDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lDe(n.key),n)}}function aDe(e,t,r){return t&&yN(e.prototype,t),r&&yN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lDe(e){var t=sDe(e,"string");return Sd(t)==="symbol"?t:String(t)}function sDe(e,t){if(Sd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cS="built",hS="building",gN=["click","input","keydown","keypress","keyup","focus","blur","change"],cz=function(){function e(t,r){iDe(this,e),this.hot=t,this.eventManager=new Tt(this),this.options=Wt(e.DEFAULTS,r),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName),this.buildState=null}return aDe(e,[{key:"setValue",value:function(r){this.options.value=r,this.update()}},{key:"getValue",value:function(){return this.options.value}},{key:"element",get:function(){return this.buildState===hS?this._element:this.buildState===cS?(this.update(),this._element):(this.buildState=hS,this.build(),this.buildState=cS,this._element)}},{key:"isBuilt",value:function(){return this.buildState===cS}},{key:"translateIfPossible",value:function(r){return typeof r=="string"&&r.startsWith(wr)?this.hot.getTranslatedPhrase(r):r}},{key:"build",value:function(){var r=this,n=function(a,l){r.eventManager.addEventListener(a,l,function(s){return r.runLocalHooks(l,s,r)})};if(this.buildState||(this.buildState=hS),this.options.className&&re(this._element,this.options.className),this.options.children.length)$(this.options.children,function(i){return r._element.appendChild(i.element)});else if(this.options.wrapIt){var o=this.hot.rootDocument.createElement(this.options.tagName);We(this.options,function(i,a){o[a]!==void 0&&a!=="className"&&a!=="tagName"&&a!=="children"&&(o[a]=r.translateIfPossible(i))}),this._element.appendChild(o),$(gN,function(i){return n(o,i)})}else $(gN,function(i){return n(r._element,i)})}},{key:"update",value:function(){}},{key:"reset",value:function(){this.options.value="",this.update()}},{key:"show",value:function(){this.element.style.display=""}},{key:"hide",value:function(){this.element.style.display="none"}},{key:"focus",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}],[{key:"DEFAULTS",get:function(){return pr({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}}]),e}();pt(cz,Pr);const bi=cz;function Tu(e){"@babel/helpers - typeof";return Tu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tu(e)}function uDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cDe(n.key),n)}}function fDe(e,t,r){return t&&pN(e.prototype,t),r&&pN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cDe(e){var t=hDe(e,"string");return Tu(t)==="symbol"?t:String(t)}function hDe(e,t){if(Tu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Tu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _g(){return typeof Reflect<"u"&&Reflect.get?_g=Reflect.get.bind():_g=function(t,r,n){var o=dDe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_g.apply(this,arguments)}function dDe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ku(e),e!==null););return e}function vDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&VO(e,t)}function VO(e,t){return VO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},VO(e,t)}function yDe(e){var t=pDe();return function(){var n=ku(e),o;if(t){var i=ku(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return gDe(this,o)}}function gDe(e,t){if(t&&(Tu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hz(e)}function hz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pDe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ku(e){return ku=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ku(e)}var Py=new WeakMap,mDe=function(e){vDe(r,e);var t=yDe(r);function r(n,o){var i;return uDe(this,r),i=t.call(this,n,Wt(r.DEFAULTS,o)),Py.set(hz(i),{}),i.registerHooks(),i}return fDe(r,[{key:"registerHooks",value:function(){var o=this;this.addLocalHook("click",function(){return o.onClick()}),this.addLocalHook("keyup",function(i){return o.onKeyup(i)})}},{key:"build",value:function(){_g(ku(r.prototype),"build",this).call(this);var o=Py.get(this),i=this.hot.rootDocument.createElement("div");o.input=this._element.firstChild,re(this._element,"htUIInput"),re(i,"htUIInputIcon"),this._element.appendChild(i),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var o=Py.get(this).input;o.type=this.options.type,o.placeholder=this.translateIfPossible(this.options.placeholder),o.value=this.translateIfPossible(this.options.value)}}},{key:"focus",value:function(){this.isBuilt()&&Py.get(this).input.focus()}},{key:"onClick",value:function(){}},{key:"onKeyup",value:function(o){this.options.value=o.target.value}}],[{key:"DEFAULTS",get:function(){return pr({placeholder:"",type:"text",tagName:"input"})}}]),r}(bi);const rs=mDe;function Pu(e){"@babel/helpers - typeof";return Pu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pu(e)}function bDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,SDe(n.key),n)}}function wDe(e,t,r){return t&&mN(e.prototype,t),r&&mN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function SDe(e){var t=CDe(e,"string");return Pu(t)==="symbol"?t:String(t)}function CDe(e,t){if(Pu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Pu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ns(){return typeof Reflect<"u"&&Reflect.get?ns=Reflect.get.bind():ns=function(t,r,n){var o=_De(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ns.apply(this,arguments)}function _De(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=wi(e),e!==null););return e}function ODe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&WO(e,t)}function WO(e,t){return WO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},WO(e,t)}function RDe(e){var t=TDe();return function(){var n=wi(e),o;if(t){var i=wi(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return EDe(this,o)}}function EDe(e,t){if(t&&(Pu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dz(e)}function dz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function TDe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wi(e){return wi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wi(e)}var $y=new WeakMap,kDe=function(e){ODe(r,e);var t=RDe(r);function r(n,o){var i;return bDe(this,r),i=t.call(this,n,Wt(r.DEFAULTS,o)),$y.set(dz(i),{}),i.menu=null,i.items=[],i.registerHooks(),i}return wDe(r,[{key:"registerHooks",value:function(){var o=this;this.addLocalHook("click",function(){return o.onClick()})}},{key:"setItems",value:function(o){this.items=this.translateNames(o),this.menu&&this.menu.setMenuItems(this.items)}},{key:"translateNames",value:function(o){var i=this;return $(o,function(a){a.name=i.translateIfPossible(a.name)}),o}},{key:"build",value:function(){var o=this;ns(wi(r.prototype),"build",this).call(this),this.menu=new Dk(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer}),this.menu.setMenuItems(this.items);var i=new bi(this.hot,{className:"htUISelectCaption"}),a=new bi(this.hot,{className:"htUISelectDropdown"}),l=$y.get(this);l.caption=i,l.captionElement=i.element,l.dropdown=a,$([i,a],function(s){return o._element.appendChild(s.element)}),this.menu.addLocalHook("select",function(s){return o.onMenuSelect(s)}),this.menu.addLocalHook("afterClose",function(){return o.onMenuClosed()}),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var o;this.options.value?o=this.options.value.name:o=this.menu.hot.getTranslatedPhrase(Wm),$y.get(this).captionElement.textContent=o,ns(wi(r.prototype),"update",this).call(this)}}},{key:"openOptions",value:function(){var o=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:this.hot.isLtr()?o.left-5:o.left-31,top:o.top-1,width:o.width,height:o.height}))}},{key:"closeOptions",value:function(){this.menu&&this.menu.close()}},{key:"onMenuSelect",value:function(o){o.name!==Ye&&(this.options.value=o,this.update(),this.runLocalHooks("select",this.options.value))}},{key:"onMenuClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onClick",value:function(){this.openOptions()}},{key:"destroy",value:function(){this.menu&&(this.menu.destroy(),this.menu=null);var o=$y.get(this),i=o.caption,a=o.dropdown;i&&i.destroy(),a&&a.destroy(),ns(wi(r.prototype),"destroy",this).call(this)}}],[{key:"DEFAULTS",get:function(){return pr({className:"htUISelect",wrapIt:!1})}}]),r}(bi);const bN=kDe;function $u(e){"@babel/helpers - typeof";return $u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$u(e)}function PDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ADe(n.key),n)}}function $De(e,t,r){return t&&wN(e.prototype,t),r&&wN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ADe(e){var t=IDe(e,"string");return $u(t)==="symbol"?t:String(t)}function IDe(e,t){if($u(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($u(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Og(){return typeof Reflect<"u"&&Reflect.get?Og=Reflect.get.bind():Og=function(t,r,n){var o=MDe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Og.apply(this,arguments)}function MDe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Au(e),e!==null););return e}function xDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&UO(e,t)}function UO(e,t){return UO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},UO(e,t)}function DDe(e){var t=LDe();return function(){var n=Au(e),o;if(t){var i=Au(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return NDe(this,o)}}function NDe(e,t){if(t&&($u(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return HDe(e)}function HDe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function LDe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Au(e){return Au=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Au(e)}var jDe=function(e){xDe(r,e);var t=DDe(r);function r(n,o){var i;return PDe(this,r),i=t.call(this,n,{id:o.id,stateless:!1}),i.name=o.name,i.addSeparator=o.addSeparator,i.elements.push(new bN(i.hot,{menuContainer:o.menuContainer})),i.elements.push(new rs(i.hot,{placeholder:hk})),i.elements.push(new rs(i.hot,{placeholder:dk})),i.registerHooks(),i}return $De(r,[{key:"registerHooks",value:function(){var o=this;this.getSelectElement().addLocalHook("select",function(i){return o.onConditionSelect(i)}),this.getSelectElement().addLocalHook("afterClose",function(){return o.onSelectUIClosed()}),$(this.getInputElements(),function(i){i.addLocalHook("keydown",function(a){return o.onInputKeyDown(a)})})}},{key:"setState",value:function(o){var i=this;if(this.reset(),!!o){var a=pr(o.command);a.name.startsWith(xt)&&(a.name=this.hot.getTranslatedPhrase(a.name)),this.getSelectElement().setValue(a),$(o.args,function(l,s){if(s>a.inputsCount-1)return!1;var u=i.getInputElement(s);u.setValue(l),u[a.inputsCount>s?"show":"hide"](),s||setTimeout(function(){return u.focus()},10)})}}},{key:"getState",value:function(){var o=this.getSelectElement().getValue()||ga(Qt),i=[];return $(this.getInputElements(),function(a,l){o.inputsCount>l&&i.push(a.getValue())}),{command:o,args:i}}},{key:"updateState",value:function(o,i){var a=ga(o?o.name:Qt);this.state.setValueAtIndex(i,{command:a,args:o?o.args:[]}),o||$(this.getInputElements(),function(l){return l.setValue(null)})}},{key:"getSelectElement",value:function(){return this.elements.filter(function(o){return o instanceof bN})[0]}},{key:"getInputElement",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[o]}},{key:"getInputElements",value:function(){return this.elements.filter(function(o){return o instanceof rs})}},{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,l,s,u,f,c){re(l.parentNode,"htFiltersMenuCondition"),o.addSeparator&&re(l.parentNode,"border");var h=o.hot.rootDocument.createElement("div");return re(h,"htFiltersMenuLabel"),h.textContent=c,l.appendChild(h),l.parentNode.hasAttribute("ghost-table")||$(o.elements,function(d){return l.appendChild(d.element)}),l}}}},{key:"reset",value:function(){var o=this.hot.getPlugin("filters").getSelectedColumn(),i=[ga(Qt)];if(o!==null){var a=o.visualIndex;i=oDe(this.hot.getDataType(0,a,this.hot.countRows(),a))}$(this.getInputElements(),function(l){return l.hide()}),this.getSelectElement().setItems(i),Og(Au(r.prototype),"reset",this).call(this),this.getSelectElement().setValue(i[0])}},{key:"onConditionSelect",value:function(o){$(this.getInputElements(),function(i,a){i[o.inputsCount>a?"show":"hide"](),a===0&&setTimeout(function(){return i.focus()},10)}),this.runLocalHooks("change",o)}},{key:"onSelectUIClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onInputKeyDown",value:function(o){ps(o.keyCode,"ENTER")?(this.runLocalHooks("accept"),pn(o)):ps(o.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),pn(o))}}]),r}(ab);const dS=jDe;function Iu(e){"@babel/helpers - typeof";return Iu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Iu(e)}function FDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,VDe(n.key),n)}}function BDe(e,t,r){return t&&SN(e.prototype,t),r&&SN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function VDe(e){var t=WDe(e,"string");return Iu(t)==="symbol"?t:String(t)}function WDe(e,t){if(Iu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Iu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Rg(){return typeof Reflect<"u"&&Reflect.get?Rg=Reflect.get.bind():Rg=function(t,r,n){var o=UDe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Rg.apply(this,arguments)}function UDe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Mu(e),e!==null););return e}function zDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zO(e,t)}function zO(e,t){return zO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},zO(e,t)}function YDe(e){var t=KDe();return function(){var n=Mu(e),o;if(t){var i=Mu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return GDe(this,o)}}function GDe(e,t){if(t&&(Iu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vz(e)}function vz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function KDe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Mu(e){return Mu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Mu(e)}var Ay=new WeakMap,qDe=function(e){zDe(r,e);var t=YDe(r);function r(n,o){var i;return FDe(this,r),i=t.call(this,n,Wt(r.DEFAULTS,o)),Ay.set(vz(i),{}),i}return BDe(r,[{key:"build",value:function(){Rg(Mu(r.prototype),"build",this).call(this);var o=Ay.get(this);o.input=this._element.firstChild;var i=this.hot.rootDocument.createElement("label");i.textContent=this.translateIfPossible(this.options.label.textContent),i.htmlFor=this.translateIfPossible(this.options.label.htmlFor),o.label=i,this._element.appendChild(i),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var o=Ay.get(this);o.input.checked=this.options.checked,o.label.textContent=this.translateIfPossible(this.options.label.textContent)}}},{key:"isChecked",value:function(){return this.options.checked}},{key:"setChecked",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.options.checked=o,this.update()}},{key:"focus",value:function(){this.isBuilt()&&Ay.get(this).input.focus()}}],[{key:"DEFAULTS",get:function(){return pr({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}}]),r}(bi);const CN=qDe;function xu(e){"@babel/helpers - typeof";return xu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xu(e)}var _N;function XDe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function ZDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ON(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,QDe(n.key),n)}}function JDe(e,t,r){return t&&ON(e.prototype,t),r&&ON(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function QDe(e){var t=eNe(e,"string");return xu(t)==="symbol"?t:String(t)}function eNe(e,t){if(xu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&YO(e,t)}function YO(e,t){return YO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},YO(e,t)}function rNe(e){var t=iNe();return function(){var n=Vp(e),o;if(t){var i=Vp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return nNe(this,o)}}function nNe(e,t){if(t&&(xu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return oNe(e)}function oNe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iNe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Vp(e){return Vp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Vp(e)}var RN=0,aNe=function(e){tNe(r,e);var t=rNe(r);function r(n,o){var i;return ZDe(this,r),i=t.call(this,n,{id:o.id,stateless:!1}),i.name=o.name,i.buildOperatorsElement(),i}return JDe(r,[{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,l){return re(l.parentNode,"htFiltersMenuOperators"),l.parentNode.hasAttribute("ghost-table")||$(o.elements,function(s){return l.appendChild(s.element)}),l}}}},{key:"buildOperatorsElement",value:function(){var o=this,i=[mi,Bp];$(i,function(a){var l=new CN(o.hot,{name:"operator",label:{htmlFor:a,textContent:Gxe(a)},value:a,checked:a===i[RN],id:a});l.addLocalHook("change",function(s){return o.onRadioInputChange(s)}),o.elements.push(l)})}},{key:"setChecked",value:function(o){if(this.elements.length<o)throw Error(ft(_N||(_N=XDe(["Radio button with index "," doesn't exist."])),o));$(this.elements,function(i,a){i.setChecked(a===o)})}},{key:"getActiveOperationId",value:function(){var o=this.elements.find(function(i){return i instanceof CN&&i.isChecked()});return o?o.getValue():mi}},{key:"getState",value:function(){return this.getActiveOperationId()}},{key:"setState",value:function(o){this.reset(),o&&this.getActiveOperationId()!==o&&$(this.elements,function(i){i.setChecked(i.getValue()===o)})}},{key:"updateState",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:mi,i=arguments.length>1?arguments[1]:void 0,a=o;a===Bk&&(a=Bp),this.state.setValueAtIndex(i,a)}},{key:"reset",value:function(){this.setChecked(RN)}},{key:"onRadioInputChange",value:function(o){this.setState(o.target.value)}}]),r}(ab);const lNe=aNe;var sNe=Ue,uNe=Tr,EN=Yt,fNe=/"/g,cNe=sNe("".replace),hNe=function(e,t,r,n){var o=EN(uNe(e)),i="<"+t;return r!==""&&(i+=" "+r+'="'+cNe(EN(n),fNe,"&quot;")+'"'),i+">"+o+"</"+t+">"},dNe=je,vNe=function(e){return dNe(function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3})},yNe=Ae,gNe=hNe,pNe=vNe;yNe({target:"String",proto:!0,forced:pNe("link")},{link:function(t){return gNe(this,"a","href",t)}});function Du(e){"@babel/helpers - typeof";return Du=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Du(e)}function mNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wNe(n.key),n)}}function bNe(e,t,r){return t&&TN(e.prototype,t),r&&TN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wNe(e){var t=SNe(e,"string");return Du(t)==="symbol"?t:String(t)}function SNe(e,t){if(Du(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Du(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Eg(){return typeof Reflect<"u"&&Reflect.get?Eg=Reflect.get.bind():Eg=function(t,r,n){var o=CNe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Eg.apply(this,arguments)}function CNe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Nu(e),e!==null););return e}function _Ne(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&GO(e,t)}function GO(e,t){return GO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},GO(e,t)}function ONe(e){var t=ENe();return function(){var n=Nu(e),o;if(t){var i=Nu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return RNe(this,o)}}function RNe(e,t){if(t&&(Du(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yz(e)}function yz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ENe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Nu(e){return Nu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Nu(e)}var vS=new WeakMap,TNe=function(e){_Ne(r,e);var t=ONe(r);function r(n,o){var i;return mNe(this,r),i=t.call(this,n,Wt(r.DEFAULTS,o)),vS.set(yz(i),{}),i}return bNe(r,[{key:"build",value:function(){Eg(Nu(r.prototype),"build",this).call(this);var o=vS.get(this);o.link=this._element.firstChild}},{key:"update",value:function(){this.isBuilt()&&(vS.get(this).link.textContent=this.translateIfPossible(this.options.textContent))}}],[{key:"DEFAULTS",get:function(){return pr({href:"#",tagName:"a"})}}]),r}(bi);const kN=TNe;function Hu(e){"@babel/helpers - typeof";return Hu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hu(e)}function PN(e){return ANe(e)||$Ne(e)||PNe(e)||kNe()}function kNe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PNe(e,t){if(e){if(typeof e=="string")return KO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return KO(e,t)}}function $Ne(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ANe(e){if(Array.isArray(e))return KO(e)}function KO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function INe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $N(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xNe(n.key),n)}}function MNe(e,t,r){return t&&$N(e.prototype,t),r&&$N(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xNe(e){var t=DNe(e,"string");return Hu(t)==="symbol"?t:String(t)}function DNe(e,t){if(Hu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function os(){return typeof Reflect<"u"&&Reflect.get?os=Reflect.get.bind():os=function(t,r,n){var o=NNe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},os.apply(this,arguments)}function NNe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Si(e),e!==null););return e}function HNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qO(e,t)}function qO(e,t){return qO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},qO(e,t)}function LNe(e){var t=FNe();return function(){var n=Si(e),o;if(t){var i=Si(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return jNe(this,o)}}function jNe(e,t){if(t&&(Hu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gz(e)}function gz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function FNe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Si(e){return Si=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Si(e)}var BNe=new WeakMap,VNe="multipleSelect.itemBox",WNe=function(e){HNe(r,e);var t=LNe(r);function r(n,o){var i;return INe(this,r),i=t.call(this,n,Wt(r.DEFAULTS,o)),BNe.set(gz(i),{}),i.searchInput=new rs(i.hot,{placeholder:ck,className:"htUIMultipleSelectSearch"}),i.selectAllUI=new kN(i.hot,{textContent:lk,className:"htUISelectAll"}),i.clearAllUI=new kN(i.hot,{textContent:sk,className:"htUIClearAll"}),i.items=[],i.itemsBox=null,i.registerHooks(),i}return MNe(r,[{key:"registerHooks",value:function(){var o=this;this.searchInput.addLocalHook("keydown",function(i){return o.onInputKeyDown(i)}),this.searchInput.addLocalHook("input",function(i){return o.onInput(i)}),this.selectAllUI.addLocalHook("click",function(i){return o.onSelectAllClick(i)}),this.clearAllUI.addLocalHook("click",function(i){return o.onClearAllClick(i)})}},{key:"setItems",value:function(o){this.items=o,this.itemsBox&&this.itemsBox.loadData(this.items)}},{key:"setLocale",value:function(o){this.locale=o}},{key:"getLocale",value:function(){return this.locale}},{key:"getItems",value:function(){return PN(this.items)}},{key:"getValue",value:function(){return zNe(this.items)}},{key:"isSelectedAllValues",value:function(){return this.items.length===this.getValue().length}},{key:"build",value:function(){var o=this;os(Si(r.prototype),"build",this).call(this);var i=this.hot.rootDocument,a=i.createElement("div"),l=new bi(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element),this._element.appendChild(l.element),this._element.appendChild(a);var s=function(f){if(o._element){o.itemsBox&&o.itemsBox.destroy(),re(f,"htUIMultipleSelectHot"),o.itemsBox=new o.hot.constructor(f,{data:o.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:function(v,g,m,w,S,C){v.title=C.instance.getDataAtRowProp(g,C.label.property)},maxCols:1,autoWrapCol:!0,height:110,colWidths:function(){return o.itemsBox.container.scrollWidth-Xt(i)},copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:o.hot.isRtl()?"rtl":"ltr"}),o.itemsBox.init();var c=o.itemsBox.getShortcutManager(),h=c.getContext("grid");h.addShortcut({keys:[["Escape"]],callback:function(v){o.runLocalHooks("keydown",v,o)},group:VNe})}};s(a),setTimeout(function(){return s(a)},100)}},{key:"reset",value:function(){this.searchInput.reset(),this.selectAllUI.reset(),this.clearAllUI.reset()}},{key:"update",value:function(){this.isBuilt()&&(this.itemsBox.loadData(UNe(this.items,this.options.value)),os(Si(r.prototype),"update",this).call(this))}},{key:"destroy",value:function(){this.itemsBox&&this.itemsBox.destroy(),this.searchInput.destroy(),this.clearAllUI.destroy(),this.selectAllUI.destroy(),this.searchInput=null,this.clearAllUI=null,this.selectAllUI=null,this.itemsBox=null,this.items=null,os(Si(r.prototype),"destroy",this).call(this)}},{key:"onInput",value:function(o){var i=this,a=o.target.value.toLocaleLowerCase(this.getLocale()),l;a===""?l=PN(this.items):l=jr(this.items,function(s){return"".concat(s.value).toLocaleLowerCase(i.getLocale()).indexOf(a)>=0}),this.itemsBox.loadData(l)}},{key:"onInputKeyDown",value:function(o){this.runLocalHooks("keydown",o,this);var i=CE(ps,o.keyCode);i("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&(pn(o),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))}},{key:"onSelectAllClick",value:function(o){var i=[];o.preventDefault(),$(this.itemsBox.getSourceData(),function(a,l){a.checked=!0,i.push($_(a,l)[0])}),this.itemsBox.setSourceDataAtCell(i)}},{key:"onClearAllClick",value:function(o){var i=[];o.preventDefault(),$(this.itemsBox.getSourceData(),function(a,l){a.checked=!1,i.push($_(a,l)[0])}),this.itemsBox.setSourceDataAtCell(i)}}],[{key:"DEFAULTS",get:function(){return pr({className:"htUIMultipleSelect",value:[]})}}]),r}(bi);const AN=WNe;function UNe(e,t){var r=xv(t);return Be(e,function(n){return n.checked=r(n.value),n})}function zNe(e){var t=[];return $(e,function(r){r.checked&&t.push(r.value)}),t}function Lu(e){"@babel/helpers - typeof";return Lu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lu(e)}function YNe(e,t){return XNe(e)||qNe(e,t)||KNe(e,t)||GNe()}function GNe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function KNe(e,t){if(e){if(typeof e=="string")return IN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return IN(e,t)}}function IN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function qNe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function XNe(e){if(Array.isArray(e))return e}function ZNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,QNe(n.key),n)}}function JNe(e,t,r){return t&&MN(e.prototype,t),r&&MN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function QNe(e){var t=eHe(e,"string");return Lu(t)==="symbol"?t:String(t)}function eHe(e,t){if(Lu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Lu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Tg(){return typeof Reflect<"u"&&Reflect.get?Tg=Reflect.get.bind():Tg=function(t,r,n){var o=tHe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Tg.apply(this,arguments)}function tHe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ju(e),e!==null););return e}function rHe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&XO(e,t)}function XO(e,t){return XO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},XO(e,t)}function nHe(e){var t=aHe();return function(){var n=ju(e),o;if(t){var i=ju(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return oHe(this,o)}}function oHe(e,t){if(t&&(Lu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return iHe(e)}function iHe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function aHe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ju(e){return ju=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ju(e)}var lHe=function(e){rHe(r,e);var t=nHe(r);function r(n,o){var i;return ZNe(this,r),i=t.call(this,n,{id:o.id,stateless:!1}),i.name=o.name,i.elements.push(new AN(i.hot)),i.registerHooks(),i}return JNe(r,[{key:"registerHooks",value:function(){var o=this;this.getMultipleSelectElement().addLocalHook("keydown",function(i){return o.onInputKeyDown(i)})}},{key:"setState",value:function(o){if(this.reset(),o&&o.command.key===pa){var i=this.getMultipleSelectElement();i.setItems(o.itemsSnapshot),i.setValue(o.args[0]),i.setLocale(o.locale)}}},{key:"getState",value:function(){var o=this.getMultipleSelectElement(),i=o.getItems();return{command:{key:o.isSelectedAllValues()||!i.length?Qt:pa},args:[o.getValue()],itemsSnapshot:i}}},{key:"updateState",value:function(o){var i=this,a=function(s,u,f,c,h){var d=jr(u,function(V){return V.name===pa}),v=YNe(d,1),g=v[0],m={},w=i.hot.getTranslatedPhrase(Pp);if(g){var S=BO(Be(c(s,h),function(V){return V.value}));f&&(g.args[0]=f);var C=[],k=hN(S,g.args[0],w,function(V){V.checked&&C.push(V.value)}),R=o.editedConditionStack.column;m.locale=i.hot.getCellMeta(0,R).locale,m.args=[C],m.command=ga(pa),m.itemsSnapshot=k}else m.args=[],m.command=ga(Qt);i.state.setValueAtIndex(s,m)};a(o.editedConditionStack.column,o.editedConditionStack.conditions,o.conditionArgsChange,o.filteredRowsFactory),o.dependentConditionStacks.length&&a(o.dependentConditionStacks[0].column,o.dependentConditionStacks[0].conditions,o.conditionArgsChange,o.filteredRowsFactory,o.editedConditionStack)}},{key:"getMultipleSelectElement",value:function(){return this.elements.filter(function(o){return o instanceof AN})[0]}},{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,l,s,u,f,c){re(l.parentNode,"htFiltersMenuValue");var h=o.hot.rootDocument.createElement("div");return re(h,"htFiltersMenuLabel"),h.textContent=c,l.appendChild(h),l.parentNode.hasAttribute("ghost-table")||$(o.elements,function(d){return l.appendChild(d.element)}),l}}}},{key:"reset",value:function(){var o=this.hot.getTranslatedPhrase(Pp),i=BO(this._getColumnVisibleValues()),a=hN(i,i,o);this.getMultipleSelectElement().setItems(a),Tg(ju(r.prototype),"reset",this).call(this),this.getMultipleSelectElement().setValue(i);var l=this.hot.getPlugin("filters").getSelectedColumn();l!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,l.visualIndex).locale)}},{key:"onInputKeyDown",value:function(o){ps(o.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),pn(o))}},{key:"_getColumnVisibleValues",value:function(){var o=this.hot.getPlugin("filters").getSelectedColumn();return o===null?[]:Be(this.hot.getDataAtCol(o.visualIndex),function(i){return sz(i)})}}]),r}(ab);const sHe=lHe;function Fu(e){"@babel/helpers - typeof";return Fu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fu(e)}function uHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cHe(n.key),n)}}function fHe(e,t,r){return t&&xN(e.prototype,t),r&&xN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cHe(e){var t=hHe(e,"string");return Fu(t)==="symbol"?t:String(t)}function hHe(e,t){if(Fu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dHe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ZO(e,t)}function ZO(e,t){return ZO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},ZO(e,t)}function vHe(e){var t=pHe();return function(){var n=Wp(e),o;if(t){var i=Wp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return yHe(this,o)}}function yHe(e,t){if(t&&(Fu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gHe(e)}function gHe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pHe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Wp(e){return Wp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Wp(e)}var mHe=function(e){dHe(r,e);var t=vHe(r);function r(n,o){var i;return uHe(this,r),i=t.call(this,n,{id:o.id,stateless:!0}),i.name=o.name,i.elements.push(new rs(i.hot,{type:"button",value:uk,className:"htUIButton htUIButtonOK",identifier:r.BUTTON_OK})),i.elements.push(new rs(i.hot,{type:"button",value:fk,className:"htUIButton htUIButtonCancel",identifier:r.BUTTON_CANCEL})),i.registerHooks(),i}return fHe(r,[{key:"registerHooks",value:function(){var o=this;$(this.elements,function(i){i.addLocalHook("click",function(a,l){return o.onButtonClick(a,l)})})}},{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,l){return re(l.parentNode,"htFiltersMenuActionBar"),l.parentNode.hasAttribute("ghost-table")||$(o.elements,function(s){return l.appendChild(s.element)}),l}}}},{key:"accept",value:function(){this.runLocalHooks("accept")}},{key:"cancel",value:function(){this.runLocalHooks("cancel")}},{key:"onButtonClick",value:function(o,i){i.options.identifier===r.BUTTON_OK?this.accept():this.cancel()}}],[{key:"BUTTON_OK",get:function(){return"ok"}},{key:"BUTTON_CANCEL",get:function(){return"cancel"}}]),r}(ab);const bHe=mHe;function Cd(e){"@babel/helpers - typeof";return Cd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cd(e)}var DN,NN;function HN(e,t){return _He(e)||CHe(e,t)||SHe(e,t)||wHe()}function wHe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function SHe(e,t){if(e){if(typeof e=="string")return LN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return LN(e,t)}}function LN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function CHe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function _He(e){if(Array.isArray(e))return e}function jN(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function OHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,EHe(n.key),n)}}function RHe(e,t,r){return t&&FN(e.prototype,t),r&&FN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function EHe(e){var t=THe(e,"string");return Cd(t)==="symbol"?t:String(t)}function THe(e,t){if(Cd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var BN="ConditionCollection.filteringStates",pz=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;OHe(this,e),this.hot=t,this.isMapRegistrable=r,this.filteringStates=new Vm,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(BN,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}return RHe(e,[{key:"isEmpty",value:function(){return this.getFilteredColumns().length===0}},{key:"isMatch",value:function(r,n){var o,i=this.filteringStates.getValueAtIndex(n),a=(o=i==null?void 0:i.conditions)!==null&&o!==void 0?o:[],l=i==null?void 0:i.operation;return this.isMatchInConditions(a,r,l)}},{key:"isMatchInConditions",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:mi;return r.length?Yxe(o)(r,n):!0}},{key:"addCondition",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:mi,i=arguments.length>3?arguments[3]:void 0,a=this.hot.getCellMeta(0,r).locale,l=Be(n.args,function(c){return typeof c=="string"?c.toLocaleLowerCase(a):c}),s=n.name||n.command.key;this.runLocalHooks("beforeAdd",r);var u=this.getOperation(r);if(u){if(u!==o)throw Error(ft(DN||(DN=jN(["The column of index "," has been already applied with a `","` \n        filter operation. Use `removeConditions` to clear the current conditions and then add new ones. \n        Mind that you cannot mix different types of operations (for instance, if you use `conjunction`, \n        use it consequently for a particular column)."],["The column of index "," has been already applied with a \\`","\\`\\x20\n        filter operation. Use \\`removeConditions\\` to clear the current conditions and then add new ones.\\x20\n        Mind that you cannot mix different types of operations (for instance, if you use \\`conjunction\\`,\\x20\n        use it consequently for a particular column)."])),r,u))}else if(gt(bd[o]))throw new Error(ft(NN||(NN=jN(["Unexpected operation named `","`. Possible ones are \n        `disjunction` and `conjunction`."],["Unexpected operation named \\`","\\`. Possible ones are\\x20\n        \\`disjunction\\` and \\`conjunction\\`."])),o));var f=this.getConditions(r);f.length===0?this.filteringStates.setValueAtIndex(r,{operation:o,conditions:[{name:s,args:l,func:Pi(s,l)}]},i):f.push({name:s,args:l,func:Pi(s,l)}),this.runLocalHooks("afterAdd",r)}},{key:"getConditions",value:function(r){var n,o;return(n=(o=this.filteringStates.getValueAtIndex(r))===null||o===void 0?void 0:o.conditions)!==null&&n!==void 0?n:[]}},{key:"getOperation",value:function(r){var n;return(n=this.filteringStates.getValueAtIndex(r))===null||n===void 0?void 0:n.operation}},{key:"getFilteredColumns",value:function(){return this.filteringStates.getEntries().map(function(r){var n=HN(r,1),o=n[0];return o})}},{key:"getColumnStackPosition",value:function(r){return this.getFilteredColumns().indexOf(r)}},{key:"exportAllConditions",value:function(){return Lt(this.filteringStates.getEntries(),function(r,n){var o=HN(n,2),i=o[0],a=o[1],l=a.operation,s=a.conditions;return r.push({column:i,operation:l,conditions:Be(s,function(u){var f=u.name,c=u.args;return{name:f,args:c}})}),r},[])}},{key:"importAllConditions",value:function(r){var n=this;this.clean(),$(r,function(o){$(o.conditions,function(i){return n.addCondition(o.column,i)})})}},{key:"removeConditions",value:function(r){this.runLocalHooks("beforeRemove",r),this.filteringStates.clearValue(r),this.runLocalHooks("afterRemove",r)}},{key:"clean",value:function(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}},{key:"hasConditions",value:function(r,n){var o=this.getConditions(r);return n?o.some(function(i){return i.name===n}):o.length>0}},{key:"destroy",value:function(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(BN),this.filteringStates=null,this.clearLocalHooks()}}]),e}();pt(pz,Pr);const mz=pz;function _d(e){"@babel/helpers - typeof";return _d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_d(e)}function kHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$He(n.key),n)}}function PHe(e,t,r){return t&&VN(e.prototype,t),r&&VN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $He(e){var t=AHe(e,"string");return _d(t)==="symbol"?t:String(t)}function AHe(e,t){if(_d(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_d(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var IHe=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return[]};kHe(this,e),this.conditionCollection=t,this.columnDataFactory=r}return PHe(e,[{key:"filter",value:function(){var r=this,n=[];return $(this.conditionCollection.getFilteredColumns(),function(o,i){var a=r.columnDataFactory(o);i&&(a=r._getIntersectData(a,n)),n=r.filterByColumn(o,a)}),n}},{key:"filterByColumn",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=[];return $(o,function(a){a!==void 0&&n.conditionCollection.isMatch(a,r)&&i.push(a)}),i}},{key:"_getIntersectData",value:function(r,n){var o=[];return $(n,function(i){var a=i.meta.visualRow;r[a]!==void 0&&(o[a]=r[a])}),o}}]),e}();const bz=IHe;function Od(e){"@babel/helpers - typeof";return Od=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Od(e)}function MHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,DHe(n.key),n)}}function xHe(e,t,r){return t&&WN(e.prototype,t),r&&WN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function DHe(e){var t=NHe(e,"string");return Od(t)==="symbol"?t:String(t)}function NHe(e,t){if(Od(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Od(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wz=function(){function e(t,r){var n=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){return[]};MHe(this,e),this.hot=t,this.conditionCollection=r,this.columnDataFactory=o,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.conditionCollection.addLocalHook("beforeRemove",function(i){return n._onConditionBeforeModify(i)}),this.conditionCollection.addLocalHook("afterRemove",function(i){return n.updateStatesAtColumn(i)}),this.conditionCollection.addLocalHook("afterAdd",function(i){return n.updateStatesAtColumn(i)}),this.conditionCollection.addLocalHook("beforeClean",function(){return n._onConditionBeforeClean()}),this.conditionCollection.addLocalHook("afterClean",function(){return n._onConditionAfterClean()})}return xHe(e,[{key:"groupChanges",value:function(){this.grouping=!0}},{key:"flush",value:function(){var r=this;this.grouping=!1,$(this.changes,function(n){r.updateStatesAtColumn(n)}),this.changes.length=0}},{key:"_onConditionBeforeModify",value:function(r){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(r)}},{key:"updateStatesAtColumn",value:function(r,n){var o=this;if(this.grouping){this.changes.indexOf(r)===-1&&this.changes.push(r);return}var i=this.conditionCollection.exportAllConditions(),a=this.conditionCollection.getColumnStackPosition(r);a===-1&&(a=this.latestEditedColumnPosition);var l=i.slice(0,a),s=i.slice(a);s.length&&s[0].column===r&&s.shift();var u=xV(function(c,h){var d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],v=new mz(o.hot,!1),g=[].concat(c,d);v.importAllConditions(g);var m=o.columnDataFactory(h),w;v.isEmpty()?w=m:w=new bz(v,function(C){return o.columnDataFactory(C)}).filter(),w=Be(w,function(C){return C.meta.visualRow});var S=xv(w);return v.destroy(),jr(m,function(C){return S(C.meta.visualRow)})})(l),f=[].concat(this.conditionCollection.getConditions(r));this.runLocalHooks("update",{editedConditionStack:{column:r,conditions:f},dependentConditionStacks:s,filteredRowsFactory:u,conditionArgsChange:n})}},{key:"_onConditionBeforeClean",value:function(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}},{key:"_onConditionAfterClean",value:function(){var r=this;$(this.latestOrderStack,function(n){r.updateStatesAtColumn(n)})}},{key:"destroy",value:function(){var r=this;this.clearLocalHooks(),We(this,function(n,o){r[o]=null})}}]),e}();pt(wz,Pr);const HHe=wz;function Bu(e){"@babel/helpers - typeof";return Bu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bu(e)}var UN;function LHe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function jHe(e,t){return WHe(e)||VHe(e,t)||BHe(e,t)||FHe()}function FHe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function BHe(e,t){if(e){if(typeof e=="string")return zN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return zN(e,t)}}function zN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function VHe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function WHe(e){if(Array.isArray(e))return e}function UHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,YHe(n.key),n)}}function zHe(e,t,r){return t&&YN(e.prototype,t),r&&YN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function YHe(e){var t=GHe(e,"string");return Bu(t)==="symbol"?t:String(t)}function GHe(e,t){if(Bu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function is(){return typeof Reflect<"u"&&Reflect.get?is=Reflect.get.bind():is=function(t,r,n){var o=KHe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},is.apply(this,arguments)}function KHe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ci(e),e!==null););return e}function qHe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&JO(e,t)}function JO(e,t){return JO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},JO(e,t)}function XHe(e){var t=JHe();return function(){var n=Ci(e),o;if(t){var i=Ci(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return ZHe(this,o)}}function ZHe(e,t){if(t&&(Bu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Sz(e)}function Sz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function JHe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ci(e){return Ci=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ci(e)}var GN="filters",QHe=250,eLe=function(e){qHe(r,e);var t=XHe(r);function r(n){var o;return UHe(this,r),o=t.call(this,n),o.eventManager=new Tt(Sz(o)),o.dropdownMenuPlugin=null,o.conditionCollection=null,o.conditionUpdateObserver=null,o.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]),o.filtersRowsMap=null,o.hot.addHook("afterGetColHeader",function(i,a){return o.onAfterGetColHeader(i,a)}),o}return zHe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[GN]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Ev),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");var i=this.hot.getSettings().dropdownMenu,a=i&&i.uiContainer||this.hot.rootDocument.body,l=function(d){return d.addLocalHook("accept",function(){return o.onActionBarSubmit("accept")}),d.addLocalHook("cancel",function(){return o.onActionBarSubmit("cancel")}),d.addLocalHook("change",function(v){return o.onComponentChange(d,v)}),d},s=function(){return"".concat(o.hot.getTranslatedPhrase(ok),":")},u=function(){return"".concat(o.hot.getTranslatedPhrase(ik),":")};if(!this.components.get("filter_by_condition")){var f=new dS(this.hot,{id:"filter_by_condition",name:s,addSeparator:!1,menuContainer:a});f.addLocalHook("afterClose",function(){return o.onSelectUIClosed()}),this.components.set("filter_by_condition",l(f))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new lNe(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){var c=new dS(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:a});c.addLocalHook("afterClose",function(){return o.onSelectUIClosed()}),this.components.set("filter_by_condition2",l(c))}this.components.get("filter_by_value")||this.components.set("filter_by_value",l(new sHe(this.hot,{id:"filter_by_value",name:u}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",l(new bHe(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new mz(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new HHe(this.hot,this.conditionCollection,function(h){return o.getDataMapAtColumn(h)}),this.conditionUpdateObserver.addLocalHook("update",function(h){return o.updateComponents(h)})),this.components.forEach(function(h){return h.show()}),this.addHook("beforeDropdownMenuSetItems",function(h){return o.onBeforeDropdownMenuSetItems(h)}),this.addHook("afterDropdownMenuDefaultOptions",function(h){return o.onAfterDropdownMenuDefaultOptions(h)}),this.addHook("afterDropdownMenuShow",function(){return o.onAfterDropdownMenuShow()}),this.addHook("afterDropdownMenuHide",function(){return o.onAfterDropdownMenuHide()}),this.addHook("afterChange",function(h){return o.onAfterChange(h)}),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),is(Ci(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var o=this;if(this.enabled){var i;(i=this.dropdownMenuPlugin)!==null&&i!==void 0&&i.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach(function(a,l){a.destroy(),o.components.set(l,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}is(Ci(r.prototype),"disablePlugin",this).call(this)}},{key:"addCondition",value:function(o,i,a){var l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:mi,s=this.hot.toPhysicalColumn(o);this.conditionCollection.addCondition(s,{command:{key:i},args:a},l)}},{key:"removeConditions",value:function(o){var i=this.hot.toPhysicalColumn(o);this.conditionCollection.removeConditions(i)}},{key:"clearConditions",value:function(o){if(o===void 0)this.conditionCollection.clean();else{var i=this.hot.toPhysicalColumn(o);this.conditionCollection.removeConditions(i)}}},{key:"filter",value:function(){var o=this,i=this._createDataFilter(),a=!this.conditionCollection.isEmpty(),l=[],s=this.conditionCollection.exportAllConditions(),u=this.hot.runHooks("beforeFilter",s);if(u!==!1)if(a){var f=[];this.hot.batchExecution(function(){o.filtersRowsMap.clear(),l=Be(i.filter(),function(h){return h.meta.visualRow});var c=xv(l);_e(o.hot.countSourceRows()-1,function(h){c(h)||f.push(h)}),$(f,function(h){o.filtersRowsMap.setValueAtIndex(h,!0)})},!0),l.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",s),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.clearColumnSelection()}},{key:"getSelectedColumn",value:function(){var o,i=(o=this.hot.getSelectedRangeLast())===null||o===void 0?void 0:o.highlight;return i?{visualIndex:i.col,physicalIndex:this.hot.toPhysicalColumn(i.col)}:null}},{key:"clearColumnSelection",value:function(){var o=this.getSelectedColumn();o!==null&&this.hot.selectCell(0,o.visualIndex)}},{key:"getDataMapAtColumn",value:function(o){var i=this,a=this.hot.toVisualColumn(o),l=[];return $(this.hot.getSourceDataAtCol(a),function(s,u){var f,c=i.hot.getCellMeta(u,a),h=c.row,d=c.col,v=c.visualCol,g=c.visualRow,m=c.type,w=c.instance,S=c.dateFormat,C=c.locale,k=(f=i.hot.getDataAtCell(i.hot.toVisualRow(u),a))!==null&&f!==void 0?f:s;l.push({meta:{row:h,col:d,visualCol:v,visualRow:g,type:m,instance:w,dateFormat:S,locale:C},value:sz(k)})}),l}},{key:"onAfterChange",value:function(o){var i=this;o&&$(o,function(a){var l=jHe(a,2),s=l[1],u=i.hot.propToCol(s);i.conditionCollection.hasConditions(u)&&i.updateValueComponentCondition(u)})}},{key:"updateValueComponentCondition",value:function(o){var i=this.hot.getDataAtCol(o),a=BO(i);this.conditionUpdateObserver.updateStatesAtColumn(o,a)}},{key:"restoreComponents",value:function(o){var i,a=(i=this.getSelectedColumn())===null||i===void 0?void 0:i.physicalIndex;o.forEach(function(l){l.isHidden()||l.restoreState(a)}),this.updateDependentComponentsVisibility()}},{key:"onAfterDropdownMenuShow",value:function(){this.restoreComponents(Array.from(this.components.values()))}},{key:"onAfterDropdownMenuHide",value:function(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}},{key:"onBeforeDropdownMenuSetItems",value:function(){var o=this;this.dropdownMenuPlugin&&this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",function(){o.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:!0})})}},{key:"onAfterDropdownMenuDefaultOptions",value:function(o){o.items.push({name:Ye}),this.components.forEach(function(i){o.items.push(i.getMenuItemDescriptor())})}},{key:"getOperationBasedOnArguments",value:function(o,i,a,l){var s=o;return s===Bp&&i.command.key!==Qt&&a.command.key!==Qt&&l.command.key!==Qt?s=Bk:l.command.key!==Qt&&(i.command.key===Qt||a.command.key===Qt)&&(s=mi),s}},{key:"onActionBarSubmit",value:function(o){var i;if(o==="accept"){var a=this.getSelectedColumn();if(a===null){var l;(l=this.dropdownMenuPlugin)===null||l===void 0||l.close();return}var s=a.physicalIndex,u=this.components.get("filter_by_condition").getState(),f=this.components.get("filter_by_condition2").getState(),c=this.components.get("filter_by_value").getState(),h=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),u,f,c);this.conditionUpdateObserver.groupChanges();var d=this.conditionCollection.getColumnStackPosition(s);d===-1&&(d=void 0),this.conditionCollection.removeConditions(s),u.command.key!==Qt&&(this.conditionCollection.addCondition(s,u,h,d),f.command.key!==Qt&&this.conditionCollection.addCondition(s,f,h,d)),c.command.key!==Qt&&this.conditionCollection.addCondition(s,c,h,d),this.conditionUpdateObserver.flush(),this.components.forEach(function(v){return v.saveState(s)}),this.filtersRowsMap.clear(),this.filter()}(i=this.dropdownMenuPlugin)===null||i===void 0||i.close()}},{key:"onComponentChange",value:function(o,i){this.updateDependentComponentsVisibility(),o.constructor===dS&&!i.inputsCount&&this.setListeningDropdownMenu()}},{key:"onSelectUIClosed",value:function(){this.setListeningDropdownMenu()}},{key:"setListeningDropdownMenu",value:function(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}},{key:"updateDependentComponentsVisibility",value:function(){var o=this.components.get("filter_by_condition"),i=o.getState(),a=i.command,l=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];a.showOperators?this.showComponents.apply(this,l):this.hideComponents.apply(this,l)}},{key:"onAfterGetColHeader",value:function(o,i){var a=this.hot.toPhysicalColumn(o);this.enabled&&this.conditionCollection.hasConditions(a)?re(i,"htFiltersActive"):Le(i,"htFiltersActive")}},{key:"_createDataFilter",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new bz(i,function(a){return o.getDataMapAtColumn(a)})}},{key:"updateComponents",value:function(o){var i;if((i=this.dropdownMenuPlugin)!==null&&i!==void 0&&i.enabled){var a=o.editedConditionStack,l=a.conditions,s=a.column,u=l.filter(function(h){return h.name===pa}),f=l.filter(function(h){return h.name!==pa});if(u.length>=2||f.length>=3)ht(ft(UN||(UN=LHe([`The filter conditions have been applied properly, but couldnât be displayed visually. 
        The overall amount of conditions exceed the capability of the dropdown menu. 
        For more details see the documentation.`],[`The filter conditions have been applied properly, but couldnât be displayed visually.\\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\\x20
        For more details see the documentation.`]))));else{var c=this.conditionCollection.getOperation(s);this.components.get("filter_by_condition").updateState(f[0],s),this.components.get("filter_by_condition2").updateState(f[1],s),this.components.get("filter_operators").updateState(c,s),this.components.get("filter_by_value").updateState(o)}}}},{key:"getIndexesOfComponents",value:function(){var o=[];if(!this.dropdownMenuPlugin)return o;for(var i=this.dropdownMenuPlugin.menu,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return $(l,function(u){$(i.menuItems,function(f,c){f.key===u.getMenuItemDescriptor().key&&o.push(c)})}),o}},{key:"changeComponentsVisibility",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(this.dropdownMenuPlugin){for(var i=this.dropdownMenuPlugin.menu,a=i.hotMenu,l=a.getPlugin("hiddenRows"),s=arguments.length,u=new Array(s>1?s-1:0),f=1;f<s;f++)u[f-1]=arguments[f];var c=this.getIndexesOfComponents.apply(this,u);o?l.showRows(c):l.hideRows(c),a.render()}}},{key:"hideComponents",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.changeComponentsVisibility.apply(this,[!1].concat(i))}},{key:"showComponents",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.changeComponentsVisibility.apply(this,[!0].concat(i))}},{key:"destroy",value:function(){var o=this;this.enabled&&(this.components.forEach(function(i,a){i!==null&&(i.destroy(),o.components.set(a,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),is(Ci(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return GN}},{key:"PLUGIN_PRIORITY",get:function(){return QHe}},{key:"PLUGIN_DEPS",get:function(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}}]),r}(ot);function Rd(e){"@babel/helpers - typeof";return Rd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rd(e)}function KN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Dc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?KN(Object(r),!0).forEach(function(n){tLe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):KN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function tLe(e,t,r){return t=rLe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rLe(e){var t=nLe(e,"string");return Rd(t)==="symbol"?t:String(t)}function nLe(e,t){if(Rd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Cz="internal-use-in-handsontable",QO={licenseKey:Cz,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function _z(e){var t,r;return{maxColumns:e.maxColumns,maxRows:e.maxRows,language:(t=e[nr])===null||t===void 0||(r=t.language)===null||r===void 0?void 0:r.langCode}}function Oz(e){return Object.keys(e).reduce(function(t,r){return r!=="hyperformula"&&(t[r]=e[r]),t},{})}function oLe(e){var t,r=e[nr],n=Oz(r!=null&&(t=r.engine)!==null&&t!==void 0&&t.hyperformula?r.engine:{}),o=_z(e);return Dc(Dc(Dc({},QO),n),o)}function iLe(e){var t,r=e[nr],n=Oz(r!=null&&(t=r.engine)!==null&&t!==void 0&&t.hyperformula?r.engine:{}),o=_z(e);return Dc(Dc({},n),o)}function aLe(e,t){return Object.keys(t).some(function(r){return t[r]!==void 0&&t[r]!==e[r]})}var qN;function lLe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function eR(e){"@babel/helpers - typeof";return eR=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eR(e)}function lb(){var e="engine_relationship",t=en(nr);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function Vk(){var e="shared_engine_usage",t=en(nr);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function sLe(e){var t=e.getSettings(),r=t[nr],n=r==null?void 0:r.engine;if(r===!0||gt(n))return null;if(typeof n.hyperformula=="function"||typeof n=="function"){var o;return uLe((o=n.hyperformula)!==null&&o!==void 0?o:n,t,e)}else if(eR(n)==="object"&&gt(n.hyperformula)){var i=lb(),a=Vk().get(n);return i.has(n)||i.set(n,[]),i.get(n).push(e),a&&a.push(e.guid),n.getConfig().licenseKey||n.updateConfig({licenseKey:Cz}),(n.getConfig().leapYear1900!==QO.leapYear1900||wm(n.getConfig().nullDate,QO.nullDate)===!1)&&ht(ft(qN||(qN=lLe(["If you use HyperFormula with Handsontable, keep the default `leapYear1900` and `nullDate` \n      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates."],["If you use HyperFormula with Handsontable, keep the default \\`leapYear1900\\` and \\`nullDate\\` \n      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates."])))),n}return null}function uLe(e,t,r){var n=t[nr],o=oLe(t),i=lb(),a=Vk();fLe(e,n.functions),cLe(e,n.language);var l=e.buildEmpty(o);return i.set(l,[r]),a.set(l,[r.guid]),hLe(l,n.namedExpressions),l.on("sheetAdded",function(){l.rebuildAndRecalculate()}),l.on("sheetRemoved",function(){l.rebuildAndRecalculate()}),l}function XN(e){var t,r=lb(),n=r.size===0?[]:Array.from((t=r.get(e))!==null&&t!==void 0?t:[]);return new Map(n.map(function(o){return[o.getPlugin("formulas").sheetId,o]}))}function ZN(e,t){if(e){var r=lb(),n=r.get(e),o=Vk(),i=o.get(e);n&&n.includes(t)&&(n.splice(n.indexOf(t),1),n.length===0&&r.delete(e)),i&&i.includes(t.guid)&&(i.splice(i.indexOf(t.guid),1),i.length===0&&(o.delete(e),e.destroy()))}}function fLe(e,t){t&&t.forEach(function(r){var n=r.name,o=r.plugin,i=r.translations;try{e.registerFunction(n,o,i)}catch(a){ht(a.message)}})}function cLe(e,t){if(t){var r=t.langCode;try{e.registerLanguage(r,t)}catch(n){ht(n.message)}}}function hLe(e,t){t&&(e.suspendEvaluation(),t.forEach(function(r){var n=r.name,o=r.expression,i=r.scope,a=r.options;try{e.addNamedExpression(n,o,i,a)}catch(l){ht(l.message)}}),e.resumeEvaluation())}function dLe(e,t){return(gt(t)||!e.doesSheetExist(t))&&(t=e.addSheet(t)),t}var Rz="DD/MM/YYYY";function Ez(e){return typeof e=="string"&&e.charAt(0)==="'"&&e.charAt(1)==="="}function vLe(e){return Ez(e)?e.substr(1):e}function yLe(e){return typeof e=="string"&&e.startsWith("=")}function yS(e,t){return typeof e=="string"&&t==="date"}function JN(e,t){return te(e,t,!0).isValid()}function QN(e,t){return te(e,t,!0).format(Rz)}function gLe(e,t){return te(e,Rz,!0).format(t)}function eH(e,t){var r=-1,n=new Date(Date.UTC(0,0,e+r));return te(n).format(t)}function Ed(e){"@babel/helpers - typeof";return Ed=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ed(e)}function pLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bLe(n.key),n)}}function mLe(e,t,r){return t&&tH(e.prototype,t),r&&tH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bLe(e){var t=wLe(e,"string");return Ed(t)==="symbol"?t:String(t)}function wLe(e,t){if(Ed(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ed(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ki(e,t,r){SLe(e,t),t.set(e,r)}function SLe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function St(e,t){var r=Tz(e,t,"get");return CLe(e,r)}function CLe(e,t){return t.get?t.get.call(e):t.value}function Xo(e,t,r){var n=Tz(e,t,"set");return _Le(e,n,r),r}function Tz(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function _Le(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var nc=new WeakMap,Zo=new WeakMap,Ir=new WeakMap,Iy=new WeakMap,gS=new WeakMap,pS=new WeakMap,My=new WeakMap,OLe=function(){function e(t,r,n){pLe(this,e),Ki(this,nc,{writable:!0,value:void 0}),Ki(this,Zo,{writable:!0,value:void 0}),Ki(this,Ir,{writable:!0,value:void 0}),Ki(this,Iy,{writable:!0,value:[]}),Ki(this,gS,{writable:!0,value:[]}),Ki(this,pS,{writable:!0,value:void 0}),Ki(this,My,{writable:!0,value:[]}),Xo(this,nc,t),Xo(this,Zo,r),Xo(this,Ir,n)}return mLe(e,[{key:"setRemovedHfIndexes",value:function(r){var n=this;return Xo(this,My,r.map(function(o){var i=St(n,Zo).getVisualFromPhysicalIndex(o);return n.getHfIndexFromVisualIndex(i)})),St(this,My)}},{key:"getRemovedHfIndexes",value:function(){return St(this,My)}},{key:"getHfIndexFromVisualIndex",value:function(r){var n=St(this,Zo).getIndexesSequence(),o=St(this,Zo).getNotTrimmedIndexes();return n.indexOf(o[r])}},{key:"syncMoves",value:function(r){var n=this,o=1,i="move".concat(ar(St(this,nc)),"s");St(this,Ir).getEngine().batch(function(){r.forEach(function(a){var l=a.from!==a.to,s=a.from+1!==a.to;l&&s&&St(n,Ir).getEngine()[i](St(n,Ir).getSheetId(),a.from,o,a.to)})})}},{key:"storeMovesInformation",value:function(r,n,o){var i=this;o!==!1&&(Xo(this,gS,r.map(function(a){return i.getHfIndexFromVisualIndex(a)})),Xo(this,pS,this.getHfIndexFromVisualIndex(n)))}},{key:"getMoveLine",value:function(r,n){var o=St(this,Zo).getNumberOfIndexes(),i=Array.from(Array(o).keys()).filter(function(l){return r.includes(l)===!1});if(n===0){var a;return(a=i[n])!==null&&a!==void 0?a:0}return i[n-1]+1}},{key:"getInitiallyCalculatedMoves",value:function(r,n){var o=this.getMoveLine(r,n),i=[];return r.forEach(function(a){var l={from:a,to:o};i.forEach(function(s){var u=s.from>s.to,f=s.to<=l.from,c=s.from>l.from;c&&f&&u&&(l.from+=1)}),l.from>=o&&(o+=1),i.push(l)}),i}},{key:"adjustedCalculatedMoves",value:function(r){return r.forEach(function(n,o){var i=r.slice(o+1);i.forEach(function(a){var l=a.from<a.to;a.from>n.from&&l&&(a.from-=1)})}),r}},{key:"calculateAndSyncMoves",value:function(r,n){var o=this;if(!St(this,Ir).isPerformingUndoRedo()&&!(r===!1||n===!1)){var i=this.adjustedCalculatedMoves(this.getInitiallyCalculatedMoves(St(this,gS),St(this,pS)));St(this,Ir).getSheetId()===null?St(this,Ir).getPostponeAction(function(){return o.syncMoves(i)}):this.syncMoves(i)}}},{key:"getIndexesChangeSyncMethod",value:function(){var r=this,n="set".concat(ar(St(this,nc)),"Order");return function(o){if(!St(r,Ir).isPerformingUndoRedo()){var i=St(r,Zo).getIndexesSequence();if(o==="update"){var a=St(r,Iy).map(function(c){return i.indexOf(c)}),l=St(r,Ir).getEngine().getSheetDimensions(St(r,Ir).getSheetId()),s;St(r,nc)==="row"?s=l.height:s=l.width;for(var u=a.length,f=u;f<s;f+=1)a.push(f);St(r,Ir).getEngine()[n](St(r,Ir).getSheetId(),a)}Xo(r,Iy,i)}}}},{key:"init",value:function(){Xo(this,Iy,St(this,Zo).getIndexesSequence())}}]),e}();const rH=OLe;function Td(e){"@babel/helpers - typeof";return Td=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Td(e)}function RLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,TLe(n.key),n)}}function ELe(e,t,r){return t&&nH(e.prototype,t),r&&nH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function TLe(e){var t=kLe(e,"string");return Td(t)==="symbol"?t:String(t)}function kLe(e,t){if(Td(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Td(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qi(e,t,r){PLe(e,t),t.set(e,r)}function PLe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qn(e,t){var r=kz(e,t,"get");return $Le(e,r)}function $Le(e,t){return t.get?t.get.call(e):t.value}function Xi(e,t,r){var n=kz(e,t,"set");return ALe(e,n,r),r}function kz(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function ALe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var xy=new WeakMap,Dy=new WeakMap,mS=new WeakMap,bS=new WeakMap,wS=new WeakMap,SS=new WeakMap,CS=new WeakMap,ILe=function(){function e(t,r,n){RLe(this,e),qi(this,xy,{writable:!0,value:void 0}),qi(this,Dy,{writable:!0,value:void 0}),qi(this,mS,{writable:!0,value:void 0}),qi(this,bS,{writable:!0,value:!1}),qi(this,wS,{writable:!0,value:!1}),qi(this,SS,{writable:!0,value:null}),qi(this,CS,{writable:!0,value:null}),Xi(this,xy,new rH("row",t,this)),Xi(this,Dy,new rH("column",r,this)),Xi(this,mS,n)}return ELe(e,[{key:"getForAxis",value:function(r){return r==="row"?qn(this,xy):qn(this,Dy)}},{key:"setPerformUndo",value:function(r){Xi(this,bS,r)}},{key:"setPerformRedo",value:function(r){Xi(this,wS,r)}},{key:"isPerformingUndoRedo",value:function(){return qn(this,bS)||qn(this,wS)}},{key:"getSheetId",value:function(){return qn(this,CS)}},{key:"getEngine",value:function(){return qn(this,SS)}},{key:"getPostponeAction",value:function(){return qn(this,mS)}},{key:"setupSyncEndpoint",value:function(r,n){Xi(this,SS,r),Xi(this,CS,n),qn(this,xy).init(),qn(this,Dy).init()}}]),e}();const MLe=ILe;function xLe(e){return HLe(e)||NLe(e)||Pz(e)||DLe()}function DLe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NLe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function HLe(e){if(Array.isArray(e))return tR(e)}function $i(e){"@babel/helpers - typeof";return $i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$i(e)}function Al(e,t){return FLe(e)||jLe(e,t)||Pz(e,t)||LLe()}function LLe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Pz(e,t){if(e){if(typeof e=="string")return tR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tR(e,t)}}function tR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function jLe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function FLe(e){if(Array.isArray(e))return e}function BLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$z(n.key),n)}}function VLe(e,t,r){return t&&oH(e.prototype,t),r&&oH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ma(){return typeof Reflect<"u"&&Reflect.get?ma=Reflect.get.bind():ma=function(t,r,n){var o=WLe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ma.apply(this,arguments)}function WLe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=So(e),e!==null););return e}function ULe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rR(e,t)}function rR(e,t){return rR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},rR(e,t)}function zLe(e){var t=GLe();return function(){var n=So(e),o;if(t){var i=So(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return YLe(this,o)}}function YLe(e,t){if(t&&($i(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return An(e)}function An(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function GLe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function So(e){return So=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},So(e)}function Il(e,t,r){return t=$z(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $z(e){var t=KLe(e,"string");return $i(t)==="symbol"?t:String(t)}function KLe(e,t){if($i(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($i(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _S(e,t,r){qLe(e,t),t.set(e,r)}function qLe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Jo(e,t,r){var n=Az(e,t,"set");return XLe(e,n,r),r}function XLe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function Ml(e,t){var r=Az(e,t,"get");return ZLe(e,r)}function Az(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function ZLe(e,t){return t.get?t.get.call(e):t.value}var nr="formulas",JLe=["maxRows","maxColumns","language"],QLe=260;pe.getSingleton().register("afterNamedExpressionAdded");pe.getSingleton().register("afterNamedExpressionRemoved");pe.getSingleton().register("afterSheetAdded");pe.getSingleton().register("afterSheetRemoved");pe.getSingleton().register("afterSheetRenamed");pe.getSingleton().register("afterFormulasValuesUpdate");var xl=function(t){return t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto"},Xn=new WeakMap,OS=new WeakMap,oc=new WeakMap,eje=function(e){ULe(r,e);var t=zLe(r);function r(){var n;BLe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),_S(An(n),Xn,{writable:!0,value:!1}),_S(An(n),OS,{writable:!0,value:!1}),_S(An(n),oc,{writable:!0,value:[["valuesUpdated",function(){var l;return(l=n).onEngineValuesUpdated.apply(l,arguments)}],["namedExpressionAdded",function(){var l;return(l=n).onEngineNamedExpressionsAdded.apply(l,arguments)}],["namedExpressionRemoved",function(){var l;return(l=n).onEngineNamedExpressionsRemoved.apply(l,arguments)}],["sheetAdded",function(){var l;return(l=n).onEngineSheetAdded.apply(l,arguments)}],["sheetRenamed",function(){var l;return(l=n).onEngineSheetRenamed.apply(l,arguments)}],["sheetRemoved",function(){var l;return(l=n).onEngineSheetRemoved.apply(l,arguments)}]]}),Il(An(n),"staticRegister",en("formulas")),Il(An(n),"engine",null),Il(An(n),"sheetName",null),Il(An(n),"indexSyncer",null),Il(An(n),"rowAxisSyncer",null),Il(An(n),"columnAxisSyncer",null),n}return VLe(r,[{key:"sheetId",get:function(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}},{key:"isEnabled",value:function(){return!!this.hot.getSettings()[nr]}},{key:"enablePlugin",value:function(){var o,i=this;if(!this.enabled){if(this.engine=(o=sLe(this.hot))!==null&&o!==void 0?o:this.engine,!this.engine){ht("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){var a=this.addSheet(this.sheetName,this.hot.getSourceDataArray());a!==!1&&(this.sheetName=a)}this.addHook("beforeLoadData",function(){return i.onBeforeLoadData.apply(i,arguments)}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("beforeUpdateData",function(){return i.onBeforeLoadData.apply(i,arguments)}),this.addHook("afterUpdateData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("modifyData",function(){return i.onModifyData.apply(i,arguments)}),this.addHook("modifySourceData",function(){return i.onModifySourceData.apply(i,arguments)}),this.addHook("beforeValidate",function(){return i.onBeforeValidate.apply(i,arguments)}),this.addHook("afterSetSourceDataAtCell",function(){return i.onAfterSetSourceDataAtCell.apply(i,arguments)}),this.addHook("afterSetDataAtCell",function(){return i.onAfterSetDataAtCell.apply(i,arguments)}),this.addHook("afterSetDataAtRowProp",function(){return i.onAfterSetDataAtCell.apply(i,arguments)}),this.addHook("beforeCreateRow",function(){return i.onBeforeCreateRow.apply(i,arguments)}),this.addHook("beforeCreateCol",function(){return i.onBeforeCreateCol.apply(i,arguments)}),this.addHook("afterCreateRow",function(){return i.onAfterCreateRow.apply(i,arguments)}),this.addHook("afterCreateCol",function(){return i.onAfterCreateCol.apply(i,arguments)}),this.addHook("beforeRemoveRow",function(){return i.onBeforeRemoveRow.apply(i,arguments)}),this.addHook("beforeRemoveCol",function(){return i.onBeforeRemoveCol.apply(i,arguments)}),this.addHook("afterRemoveRow",function(){return i.onAfterRemoveRow.apply(i,arguments)}),this.addHook("afterRemoveCol",function(){return i.onAfterRemoveCol.apply(i,arguments)}),this.indexSyncer=new MLe(this.hot.rowIndexMapper,this.hot.columnIndexMapper,function(l){i.hot.addHookOnce("init",function(){l()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",function(l,s,u,f){i.rowAxisSyncer.storeMovesInformation(l,s,f)}),this.hot.addHook("beforeColumnMove",function(l,s,u,f){i.columnAxisSyncer.storeMovesInformation(l,s,f)}),this.hot.addHook("afterRowMove",function(l,s,u,f,c){i.rowAxisSyncer.calculateAndSyncMoves(f,c)}),this.hot.addHook("afterColumnMove",function(l,s,u,f,c){i.columnAxisSyncer.calculateAndSyncMoves(f,c)}),this.hot.addHook("beforeColumnFreeze",function(l,s){i.columnAxisSyncer.storeMovesInformation([l],i.hot.getSettings().fixedColumnsStart,s)}),this.hot.addHook("afterColumnFreeze",function(l,s){i.columnAxisSyncer.calculateAndSyncMoves(s,s)}),this.hot.addHook("beforeColumnUnfreeze",function(l,s){i.columnAxisSyncer.storeMovesInformation([l],i.hot.getSettings().fixedColumnsStart-1,s)}),this.hot.addHook("afterColumnUnfreeze",function(l,s){i.columnAxisSyncer.calculateAndSyncMoves(s,s)}),this.addHook("afterCellMetaReset",function(){return i.onAfterCellMetaReset.apply(i,arguments)}),this.addHook("beforeUndo",function(){i.indexSyncer.setPerformUndo(!0),i.engine.undo()}),this.addHook("beforeRedo",function(){i.indexSyncer.setPerformRedo(!0),i.engine.redo()}),this.addHook("afterUndo",function(){i.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",function(){i.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){return i.onAfterDetachChild.apply(i,arguments)}),this.addHook("beforeAutofill",function(){return i.onBeforeAutofill.apply(i,arguments)}),Ml(this,oc).forEach(function(l){var s=Al(l,2),u=s[0],f=s[1];return i.engine.on(u,f)}),ma(So(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var o=this;Ml(this,oc).forEach(function(i){var a=Al(i,2),l=a[0],s=a[1];return o.engine.off(l,s)}),ZN(this.engine,this.hot),this.engine=null,ma(So(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(o){var i=iLe(this.hot.getSettings());aLe(this.engine.getConfig(),i)&&this.engine.updateConfig(i);var a=this.hot.getSettings()[nr];if(ve(a)&&ve(a.sheetName)&&a.sheetName!==this.sheetName&&this.switchSheet(a.sheetName),!o.data&&this.sheetName===null){var l=this.hot.getSettings()[nr].sheetName;l&&this.engine.doesSheetExist(l)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(l??void 0,this.hot.getSourceDataArray())}ma(So(r.prototype),"updatePlugin",this).call(this,o)}},{key:"destroy",value:function(){var o=this;Ml(this,oc).forEach(function(i){var a,l=Al(i,2),s=l[0],u=l[1];return(a=o.engine)===null||a===void 0?void 0:a.off(s,u)}),Jo(this,oc,null),ZN(this.engine,this.hot),this.engine=null,ma(So(r.prototype),"destroy",this).call(this)}},{key:"addSheet",value:function(o,i){if(ve(i)&&!nW(i))return ht("The provided data should be an array of arrays."),!1;if(o!=null&&this.engine.doesSheetExist(o))return ht("Sheet with the provided name already exists."),!1;try{var a=this.engine.addSheet(o??void 0);return i&&this.engine.setSheetContent(this.engine.getSheetId(a),i),a}catch(l){return ht(l.message),!1}}},{key:"switchSheet",value:function(o){if(!this.engine.doesSheetExist(o)){_E("The sheet named `".concat(o,"` does not exist, switch aborted."));return}this.sheetName=o;var i=this.engine.getSheetSerialized(this.sheetId);i.length>0&&this.hot.loadData(i,"".concat(ar(nr),".switchSheet"))}},{key:"getCellType",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId,l=this.hot.toPhysicalRow(o),s=this.hot.toPhysicalColumn(i);return l!==null&&s!==null?this.engine.getCellType({sheet:a,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i)}):"EMPTY"}},{key:"isFormulaCellType",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:a,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i)})}},{key:"renderDependentSheets",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,l=new Set;o.forEach(function(s){var u,f=s==null||(u=s.address)===null||u===void 0?void 0:u.sheet;f!==void 0&&(l.has(f)||l.add(f))}),XN(this.engine).forEach(function(s,u){if((a||u!==i.sheetId)&&l.has(u)){var f;s.render(),(f=s.view)===null||f===void 0||f.adjustElementsSize()}})}},{key:"validateDependentCells",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],l=function(f){var c,h=(c=f==null?void 0:f.address)!==null&&c!==void 0?c:{},d=h.row,v=h.col,g=h.sheet;return ve(g)?"".concat(g,":").concat(d,"x").concat(v):""},s=new Set(a.map(function(u){return l(u)}));o.forEach(function(u){var f,c,h=(f=u.address)!==null&&f!==void 0?f:{},d=h.row,v=h.col;if(!(ve(d)===!1||ve(v)===!1||d>=i.hot.countRows()||v>=i.hot.countCols())){var g=u==null||(c=u.address)===null||c===void 0?void 0:c.sheet,m=l(u);if(g!==void 0&&!s.has(m)){var w=XN(i.engine).get(g);if(!w)return;w.validateCell(w.getDataAtCell(d,v),w.getCellMeta(d,v),function(){})}}})}},{key:"syncChangeWithEngine",value:function(o,i,a){var l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(l)){ht("Not possible to set cell data at ".concat(JSON.stringify(l)));return}var s=this.hot.getCellMeta(o,i);return yS(a,s.type)&&(JN(a,s.dateFormat)?a=QN(a,s.dateFormat):yLe(a)===!1&&(a="'".concat(a))),this.engine.setCellContents(l,a)}},{key:"onBeforeValidate",value:function(o,i,a){var l=this.hot.propToCol(a);if(this.isFormulaCellType(i,l)){var s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},u=this.hot.getCellMeta(i,l),f=this.engine.getCellValue(s);return u.type==="date"&&gr(f)&&(f=eH(f,u.dateFormat)),$i(f)==="object"&&f!==null?f.value:f}return o}},{key:"onBeforeAutofill",value:function(o,i,a){var l=i.getTopStartCorner(),s=l.row,u=l.col,f=i.getBottomEndCorner(),c=f.row,h=f.col,d=a.getTopStartCorner(),v=d.row,g=d.col,m=a.getBottomEndCorner(),w=m.row,S=m.col,C={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(c),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(h),sheet:this.sheetId}},k={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(v),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(g),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(w),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(S),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(k)===!1)return!1;for(var R=this.engine.getFillRangeData(C,k),V=C.start,U=V.row,X=V.col,Y=C.end,q=Y.row,Z=Y.col,ie=q-U+1,J=Z-X+1,le=0;le<R.length;le+=1)for(var Se=0;Se<R[le].length;Se+=1){var me=R[le][Se],Ce=le%ie,P=Se%J,y=this.hot.getCellMeta(Ce,P);yS(me,y.type)&&(me.startsWith("'")?R[le][Se]=me.slice(1):this.isFormulaCellType(Ce,P,this.sheetId)===!1&&(R[le][Se]=gLe(me,y.dateFormat)))}return R}},{key:"onBeforeLoadData",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";a.includes(ar(nr))||Jo(this,OS,gt(this.hot.getSettings().data))}},{key:"onAfterCellMetaReset",value:function(){var o=this,i=this.hot.getSourceDataArray(),a=!1;i.forEach(function(l,s){l.forEach(function(u,f){var c=o.hot.getCellMeta(s,f),h=c.dateFormat;yS(u,c.type)&&(a=!0,JN(u,h)?i[s][f]=QN(u,h):o.isFormulaCellType(s,f)===!1&&(i[s][f]="'".concat(u)))})}),a===!0&&(Jo(this,Xn,!0),this.engine.setSheetContent(this.sheetId,i),Jo(this,Xn,!1))}},{key:"onAfterLoadData",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(!a.includes(ar(nr)))if(this.sheetName=dLe(this.engine,this.hot.getSettings()[nr].sheetName),Ml(this,OS))this.switchSheet(this.sheetName);else{var l=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,l)){Jo(this,Xn,!0);var s=this.engine.setSheetContent(this.sheetId,l);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(s),Jo(this,Xn,!1)}}}},{key:"onModifyData",value:function(o,i,a,l){if(!(l!=="get"||Ml(this,Xn)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))){var s=this.hot.toVisualRow(o);if(!(s===null||i===null)){var u=this.isFormulaCellType(s,i);if(!u){var f=this.getCellType(s,i);if(f!=="ARRAY"){Ez(a.value)&&(a.value=vLe(a.value));return}}var c={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},h=this.engine.getCellValue(c),d=this.hot.getCellMeta(s,i);d.type==="date"&&gr(h)&&(h=eH(h,d.dateFormat));var v=$i(h)==="object"&&h!==null?h.value:h;a.value=v}}}},{key:"onModifySourceData",value:function(o,i,a,l){if(!(l!=="get"||Ml(this,Xn)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))){var s=this.hot.toVisualRow(o),u=this.hot.propToCol(i);if(!(s===null||u===null)){var f=this.isFormulaCellType(s,u);if(!f){var c=this.getCellType(s,u);if(c!=="ARRAY")return}var h=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(!(h.width===0&&h.height===0)){var d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};a.value=this.engine.getCellSerialized(d)}}}}},{key:"onAfterSetDataAtCell",value:function(o,i){var a=this;if(!xl(i)){var l=[],s=[],u=this.engine.batch(function(){o.forEach(function(f){var c=Al(f,4),h=c[0],d=c[1],v=c[3],g=a.hot.propToCol(d),m=a.hot.toPhysicalRow(h),w=a.hot.toPhysicalColumn(g),S={row:a.rowAxisSyncer.getHfIndexFromVisualIndex(h),col:a.columnAxisSyncer.getHfIndexFromVisualIndex(g),sheet:a.sheetId};m!==null&&w!==null?a.syncChangeWithEngine(h,g,v):l.push([h,g,v]),s.push({address:S})})});l.length&&this.hot.addHookOnce("afterChange",function(){var f=a.engine.batch(function(){l.forEach(function(c){var h=Al(c,3),d=h[0],v=h[1],g=h[2];a.syncChangeWithEngine(d,v,g)})});a.renderDependentSheets(f,!0)}),this.renderDependentSheets(u),this.validateDependentCells(u,s)}}},{key:"onAfterSetSourceDataAtCell",value:function(o,i){var a=this;if(!xl(i)){var l=[],s=[];o.forEach(function(u){var f=Al(u,4),c=f[0],h=f[1],d=f[3],v=a.hot.propToCol(h);if(gr(v)){var g={row:a.rowAxisSyncer.getHfIndexFromVisualIndex(c),col:a.columnAxisSyncer.getHfIndexFromVisualIndex(v),sheet:a.sheetId};if(!a.engine.isItPossibleToSetCellContents(g)){ht("Not possible to set source cell data at ".concat(JSON.stringify(g)));return}s.push({address:g}),l.push.apply(l,xLe(a.engine.setCellContents(g,d)))}}),this.renderDependentSheets(l),this.validateDependentCells(l,s)}}},{key:"onBeforeCreateRow",value:function(o,i){var a=this.rowAxisSyncer.getHfIndexFromVisualIndex(o);if(o>=this.hot.countRows()&&(a=o),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[a,i]))return!1}},{key:"onBeforeCreateCol",value:function(o,i){var a=this.columnAxisSyncer.getHfIndexFromVisualIndex(o);if(o>=this.hot.countCols()&&(a=o),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[a,i]))return!1}},{key:"onBeforeRemoveRow",value:function(o,i,a){var l=this,s=this.rowAxisSyncer.setRemovedHfIndexes(a),u=s.every(function(f){return l.engine.isItPossibleToRemoveRows(l.sheetId,[f,1])});return u===!1?!1:void 0}},{key:"onBeforeRemoveCol",value:function(o,i,a){var l=this,s=this.columnAxisSyncer.setRemovedHfIndexes(a),u=s.every(function(f){return l.engine.isItPossibleToRemoveColumns(l.sheetId,[f,1])});return u===!1?!1:void 0}},{key:"onAfterCreateRow",value:function(o,i,a){if(!xl(a)){var l=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(o),i]);this.renderDependentSheets(l)}}},{key:"onAfterCreateCol",value:function(o,i,a){if(!xl(a)){var l=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(o),i]);this.renderDependentSheets(l)}}},{key:"onAfterRemoveRow",value:function(o,i,a,l){var s=this;if(!xl(l)){var u=this.rowAxisSyncer.getRemovedHfIndexes().sort().reverse(),f=this.engine.batch(function(){u.forEach(function(c){s.engine.removeRows(s.sheetId,[c,1])})});this.renderDependentSheets(f)}}},{key:"onAfterRemoveCol",value:function(o,i,a,l){var s=this;if(!xl(l)){var u=this.columnAxisSyncer.getRemovedHfIndexes().sort().reverse(),f=this.engine.batch(function(){u.forEach(function(c){s.engine.removeColumns(s.sheetId,[c,1])})});this.renderDependentSheets(f)}}},{key:"onAfterDetachChild",value:function(o,i,a){var l,s=this;Jo(this,Xn,!0);var u=this.hot.getSourceDataArray(a,0,a+(((l=i.__children)===null||l===void 0?void 0:l.length)||0),this.hot.countSourceCols());Jo(this,Xn,!1),u.forEach(function(f,c){f.forEach(function(h,d){s.engine.setCellContents({col:d,row:a+c,sheet:s.sheetId},[[h]])})})}},{key:"onEngineValuesUpdated",value:function(o){this.hot.runHooks("afterFormulasValuesUpdate",o)}},{key:"onEngineNamedExpressionsAdded",value:function(o,i){this.hot.runHooks("afterNamedExpressionAdded",o,i)}},{key:"onEngineNamedExpressionsRemoved",value:function(o,i){this.hot.runHooks("afterNamedExpressionRemoved",o,i)}},{key:"onEngineSheetAdded",value:function(o){this.hot.runHooks("afterSheetAdded",o)}},{key:"onEngineSheetRenamed",value:function(o,i){this.hot.runHooks("afterSheetRenamed",o,i)}},{key:"onEngineSheetRemoved",value:function(o,i){this.hot.runHooks("afterSheetRemoved",o,i)}}],[{key:"PLUGIN_KEY",get:function(){return nr}},{key:"PLUGIN_PRIORITY",get:function(){return QLe}},{key:"SETTING_KEYS",get:function(){return[nr].concat(JLe)}}]),r}(ot);function tje(e,t){return ije(e)||oje(e,t)||nje(e,t)||rje()}function rje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nje(e,t){if(e){if(typeof e=="string")return iH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return iH(e,t)}}function iH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function oje(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function ije(e){if(Array.isArray(e))return e}function aje(e){return{key:"hidden_columns_hide",name:function(){var r=this.getSelectedLast(),n=0;if(Array.isArray(r)){var o=tje(r,4),i=o[1],a=o[3];i-a!==0&&(n=1)}return this.getTranslatedPhrase(DT,n)},callback:function(){for(var r=this.getSelectedRangeLast(),n=r.from,o=r.to,i=Math.max(Math.min(n.col,o.col),0),a=Math.max(n.col,o.col),l=[],s=i;s<=a;s+=1)l.push(s);e.hideColumns(l);var u=l[l.length-1],f=this.columnIndexMapper.getNearestNotHiddenIndex(u,1,!0);Number.isInteger(f)&&f>=0?this.selectColumns(f):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function Ny(e){return fje(e)||uje(e)||sje(e)||lje()}function lje(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sje(e,t){if(e){if(typeof e=="string")return nR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nR(e,t)}}function uje(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function fje(e){if(Array.isArray(e))return nR(e)}function nR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function cje(e){var t=[];return{key:"hidden_columns_show",name:function(){var n=t.length>1?1:0;return this.getTranslatedPhrase(NT,n)},callback:function(){var n,o;if(t.length!==0){var i=t[0],a=t[t.length-1];i=(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,a=(o=this.columnIndexMapper.getNearestNotHiddenIndex(a+1,1))!==null&&o!==void 0?o:this.countCols()-1,e.showColumns(t),this.render(),this.view.adjustElementsSize(!0);var l=a-i+1===this.countCols();l||this.selectColumns(i,a)}},disabled:!1,hidden:function(){var n=this,o=Be(e.getHiddenColumns(),function(S){return n.toPhysicalColumn(S)});if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||o.length<1)return!0;t.length=0;var i=this.getSelectedRangeLast(),a=i.getTopStartCorner().col,l=i.getBottomEndCorner().col,s=this.columnIndexMapper,u=s.getRenderableFromVisualIndex(a),f=s.getRenderableFromVisualIndex(l),c=s.getNotTrimmedIndexes(),h=[];if(a!==l){var d=l-a+1,v=f-u+1;if(d>v){var g=c.slice(a,l+1);h.push.apply(h,Ny(g.filter(function(S){return o.includes(S)})))}}else if(u===0&&u<a)h.push.apply(h,Ny(c.slice(0,a)));else if(u===null)h.push.apply(h,Ny(c.slice(0,this.countCols())));else{var m=this.countCols()-1,w=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(m,-1));f===w&&m>l&&h.push.apply(h,Ny(c.slice(l+1)))}return $(h,function(S){t.push(n.toVisualColumn(S))}),t.length===0}}}function Vu(e){"@babel/helpers - typeof";return Vu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vu(e)}function hje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vje(n.key),n)}}function dje(e,t,r){return t&&aH(e.prototype,t),r&&aH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vje(e){var t=yje(e,"string");return Vu(t)==="symbol"?t:String(t)}function yje(e,t){if(Vu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ba(){return typeof Reflect<"u"&&Reflect.get?ba=Reflect.get.bind():ba=function(t,r,n){var o=gje(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ba.apply(this,arguments)}function gje(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Co(e),e!==null););return e}function pje(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oR(e,t)}function oR(e,t){return oR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},oR(e,t)}function mje(e){var t=wje();return function(){var n=Co(e),o;if(t){var i=Co(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return bje(this,o)}}function bje(e,t){if(t&&(Vu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return iR(e)}function iR(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wje(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Co(e){return Co=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Co(e)}function lH(e,t,r){Sje(e,t),t.set(e,r)}function Sje(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mr(e,t){var r=Iz(e,t,"get");return Cje(e,r)}function Cje(e,t){return t.get?t.get.call(e):t.value}function ic(e,t,r){var n=Iz(e,t,"set");return _je(e,n,r),r}function Iz(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function _je(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}pe.getSingleton().register("beforeHideColumns");pe.getSingleton().register("afterHideColumns");pe.getSingleton().register("beforeUnhideColumns");pe.getSingleton().register("afterUnhideColumns");var RS="hiddenColumns",Oje=310,Tn=new WeakMap,kn=new WeakMap,Rje=function(e){pje(r,e);var t=mje(r);function r(){var n;hje(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),lH(iR(n),Tn,{writable:!0,value:{}}),lH(iR(n),kn,{writable:!0,value:null}),n}return dje(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[RS]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[RS];Ve(i)&&(ic(this,Tn,i),gt(i.copyPasteEnabled)&&(i.copyPasteEnabled=!0)),ic(this,kn,new Bm),Mr(this,kn).addLocalHook("init",function(){return o.onMapInit()}),this.hot.columnIndexMapper.registerMap(this.pluginName,Mr(this,kn)),this.addHook("afterContextMenuDefaultOptions",function(){return o.onAfterContextMenuDefaultOptions.apply(o,arguments)}),this.addHook("afterGetCellMeta",function(a,l,s){return o.onAfterGetCellMeta(a,l,s)}),this.addHook("modifyColWidth",function(a,l){return o.onModifyColWidth(a,l)}),this.addHook("afterGetColHeader",function(){return o.onAfterGetColHeader.apply(o,arguments)}),this.addHook("modifyCopyableRange",function(a){return o.onModifyCopyableRange(a)}),ba(Co(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ba(Co(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),ic(this,Tn,{}),ba(Co(r.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showColumns",value:function(o){var i=this,a=this.getHiddenColumns(),l=this.isValidConfig(o),s=a,u=Mr(this,kn).getValues().slice(),f=o.length>0;if(l&&f){var c=o.map(function(d){return i.hot.toPhysicalColumn(d)});$(c,function(d){u[d]=!1}),s=Lt(u,function(d,v,g){return v&&d.push(i.hot.toVisualColumn(g)),d},[])}var h=this.hot.runHooks("beforeUnhideColumns",a,s,l&&f);h!==!1&&(l&&f&&Mr(this,kn).setValues(u),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",a,s,l&&f,l&&s.length<a.length))}},{key:"showColumn",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.showColumns(i)}},{key:"hideColumns",value:function(o){var i=this,a=this.getHiddenColumns(),l=this.isValidConfig(o),s=a;l&&(s=Array.from(new Set(a.concat(o))));var u=this.hot.runHooks("beforeHideColumns",a,s,l);u!==!1&&(l&&this.hot.batchExecution(function(){$(o,function(f){Mr(i,kn).setValueAtIndex(i.hot.toPhysicalColumn(f),!0)})},!0),this.hot.runHooks("afterHideColumns",a,s,l,l&&s.length>a.length))}},{key:"hideColumn",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.hideColumns(i)}},{key:"getHiddenColumns",value:function(){var o=this;return Be(Mr(this,kn).getHiddenIndexes(),function(i){return o.hot.toVisualColumn(i)})}},{key:"isHidden",value:function(o){return Mr(this,kn).getValueAtIndex(this.hot.toPhysicalColumn(o))||!1}},{key:"isValidConfig",value:function(o){var i=this.hot.countCols();return Array.isArray(o)&&o.length>0?o.every(function(a){return Number.isInteger(a)&&a>=0&&a<i}):!1}},{key:"resetCellsMeta",value:function(){$(this.hot.getCellsMeta(),function(o){o&&(o.skipColumnOnPaste=!1)})}},{key:"onModifyColWidth",value:function(o,i){if(this.isHidden(i))return 0;if(Mr(this,Tn).indicators&&(this.isHidden(i+1)||this.isHidden(i-1))&&typeof o=="number"&&this.hot.hasColHeaders())return o+15}},{key:"onAfterGetCellMeta",value:function(o,i,a){if(Mr(this,Tn).copyPasteEnabled===!1&&this.isHidden(i)&&(a.skipColumnOnPaste=!0),this.isHidden(i-1))a.className=a.className||"",a.className.indexOf("afterHiddenColumn")===-1&&(a.className+=" afterHiddenColumn");else if(a.className){var l=a.className.split(" ");if(l.length>0){var s=l.indexOf("afterHiddenColumn");s>-1&&l.splice(s,1),a.className=l.join(" ")}}}},{key:"onModifyCopyableRange",value:function(o){var i=this;if(Mr(this,Tn).copyPasteEnabled)return o;var a=[],l=function(u,f,c,h){a.push({startRow:u,endRow:f,startCol:c,endCol:h})};return $(o,function(s){var u=!0,f=0;_e(s.startCol,s.endCol,function(c){i.isHidden(c)?(u||l(s.startRow,s.endRow,f,c-1),u=!0):(u&&(f=c),c===s.endCol&&l(s.startRow,s.endRow,f,c),u=!1)})}),a}},{key:"onAfterGetColHeader",value:function(o,i){if(!(!Mr(this,Tn).indicators||o<0)){var a=[];o>=1&&this.isHidden(o-1)&&a.push("afterHiddenColumn"),o<this.hot.countCols()-1&&this.isHidden(o+1)&&a.push("beforeHiddenColumn"),re(i,a)}}},{key:"onAfterContextMenuDefaultOptions",value:function(o){o.items.push({name:Ye},aje(this),cje(this))}},{key:"onMapInit",value:function(){Array.isArray(Mr(this,Tn).columns)&&this.hideColumns(Mr(this,Tn).columns)}},{key:"destroy",value:function(){ic(this,Tn,null),ic(this,kn,null),ba(Co(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return RS}},{key:"PLUGIN_PRIORITY",get:function(){return Oje}}]),r}(ot);function Eje(e,t){return $je(e)||Pje(e,t)||kje(e,t)||Tje()}function Tje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kje(e,t){if(e){if(typeof e=="string")return sH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return sH(e,t)}}function sH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Pje(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function $je(e){if(Array.isArray(e))return e}function Aje(e){return{key:"hidden_rows_hide",name:function(){var r=this.getSelectedLast(),n=0;if(Array.isArray(r)){var o=Eje(r,3),i=o[0],a=o[2];i-a!==0&&(n=1)}return this.getTranslatedPhrase(HT,n)},callback:function(){for(var r=this.getSelectedRangeLast(),n=r.from,o=r.to,i=Math.max(Math.min(n.row,o.row),0),a=Math.max(n.row,o.row),l=[],s=i;s<=a;s+=1)l.push(s);e.hideRows(l);var u=l[l.length-1],f=this.rowIndexMapper.getNearestNotHiddenIndex(u,1,!0);Number.isInteger(f)&&f>=0?this.selectRows(f):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function Hy(e){return Dje(e)||xje(e)||Mje(e)||Ije()}function Ije(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Mje(e,t){if(e){if(typeof e=="string")return aR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return aR(e,t)}}function xje(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Dje(e){if(Array.isArray(e))return aR(e)}function aR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Nje(e){var t=[];return{key:"hidden_rows_show",name:function(){var n=t.length>1?1:0;return this.getTranslatedPhrase(LT,n)},callback:function(){var n,o;if(t.length!==0){var i=t[0],a=t[t.length-1];i=(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,a=(o=this.rowIndexMapper.getNearestNotHiddenIndex(a+1,1))!==null&&o!==void 0?o:this.countRows()-1,e.showRows(t),this.render(),this.view.adjustElementsSize(!0);var l=a-i+1===this.countRows();l||this.selectRows(i,a)}},disabled:!1,hidden:function(){var n=this,o=Be(e.getHiddenRows(),function(S){return n.toPhysicalRow(S)});if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||o.length<1)return!0;t.length=0;var i=this.getSelectedRangeLast(),a=i.getTopStartCorner().row,l=i.getBottomEndCorner().row,s=this.rowIndexMapper,u=s.getRenderableFromVisualIndex(a),f=s.getRenderableFromVisualIndex(l),c=s.getNotTrimmedIndexes(),h=[];if(a!==l){var d=l-a+1,v=f-u+1;if(d>v){var g=c.slice(a,l+1);h.push.apply(h,Hy(g.filter(function(S){return o.includes(S)})))}}else if(u===0&&u<a)h.push.apply(h,Hy(c.slice(0,a)));else if(u===null)h.push.apply(h,Hy(c.slice(0,this.countRows())));else{var m=this.countRows()-1,w=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(m,-1));f===w&&m>l&&h.push.apply(h,Hy(c.slice(l+1)))}return $(h,function(S){t.push(n.toVisualRow(S))}),t.length===0}}}function Wu(e){"@babel/helpers - typeof";return Wu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wu(e)}function Hje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jje(n.key),n)}}function Lje(e,t,r){return t&&uH(e.prototype,t),r&&uH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jje(e){var t=Fje(e,"string");return Wu(t)==="symbol"?t:String(t)}function Fje(e,t){if(Wu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wa(){return typeof Reflect<"u"&&Reflect.get?wa=Reflect.get.bind():wa=function(t,r,n){var o=Bje(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},wa.apply(this,arguments)}function Bje(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_o(e),e!==null););return e}function Vje(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lR(e,t)}function lR(e,t){return lR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},lR(e,t)}function Wje(e){var t=zje();return function(){var n=_o(e),o;if(t){var i=_o(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Uje(this,o)}}function Uje(e,t){if(t&&(Wu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sR(e)}function sR(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zje(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _o(e){return _o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_o(e)}function fH(e,t,r){Yje(e,t),t.set(e,r)}function Yje(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zr(e,t){var r=Mz(e,t,"get");return Gje(e,r)}function Gje(e,t){return t.get?t.get.call(e):t.value}function ac(e,t,r){var n=Mz(e,t,"set");return Kje(e,n,r),r}function Mz(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Kje(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}pe.getSingleton().register("beforeHideRows");pe.getSingleton().register("afterHideRows");pe.getSingleton().register("beforeUnhideRows");pe.getSingleton().register("afterUnhideRows");var ES="hiddenRows",qje=320,Zn=new WeakMap,Pn=new WeakMap,Xje=function(e){Vje(r,e);var t=Wje(r);function r(){var n;Hje(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),fH(sR(n),Zn,{writable:!0,value:{}}),fH(sR(n),Pn,{writable:!0,value:null}),n}return Lje(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[ES]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[ES];Ve(i)&&(ac(this,Zn,i),gt(i.copyPasteEnabled)&&(i.copyPasteEnabled=!0)),ac(this,Pn,new Bm),zr(this,Pn).addLocalHook("init",function(){return o.onMapInit()}),this.hot.rowIndexMapper.registerMap(this.pluginName,zr(this,Pn)),this.addHook("afterContextMenuDefaultOptions",function(){return o.onAfterContextMenuDefaultOptions.apply(o,arguments)}),this.addHook("afterGetCellMeta",function(a,l,s){return o.onAfterGetCellMeta(a,l,s)}),this.addHook("modifyRowHeight",function(a,l){return o.onModifyRowHeight(a,l)}),this.addHook("afterGetRowHeader",function(){return o.onAfterGetRowHeader.apply(o,arguments)}),this.addHook("modifyCopyableRange",function(a){return o.onModifyCopyableRange(a)}),wa(_o(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),wa(_o(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),ac(this,Zn,{}),wa(_o(r.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showRows",value:function(o){var i=this,a=this.getHiddenRows(),l=this.isValidConfig(o),s=a,u=zr(this,Pn).getValues().slice(),f=o.length>0;if(l&&f){var c=o.map(function(d){return i.hot.toPhysicalRow(d)});$(c,function(d){u[d]=!1}),s=Lt(u,function(d,v,g){return v&&d.push(i.hot.toVisualRow(g)),d},[])}var h=this.hot.runHooks("beforeUnhideRows",a,s,l&&f);h!==!1&&(l&&f&&zr(this,Pn).setValues(u),this.hot.runHooks("afterUnhideRows",a,s,l&&f,l&&s.length<a.length))}},{key:"showRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.showRows(i)}},{key:"hideRows",value:function(o){var i=this,a=this.getHiddenRows(),l=this.isValidConfig(o),s=a;l&&(s=Array.from(new Set(a.concat(o))));var u=this.hot.runHooks("beforeHideRows",a,s,l);u!==!1&&(l&&this.hot.batchExecution(function(){$(o,function(f){zr(i,Pn).setValueAtIndex(i.hot.toPhysicalRow(f),!0)})},!0),this.hot.runHooks("afterHideRows",a,s,l,l&&s.length>a.length))}},{key:"hideRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.hideRows(i)}},{key:"getHiddenRows",value:function(){var o=this;return Be(zr(this,Pn).getHiddenIndexes(),function(i){return o.hot.toVisualRow(i)})}},{key:"isHidden",value:function(o){return zr(this,Pn).getValueAtIndex(this.hot.toPhysicalRow(o))||!1}},{key:"isValidConfig",value:function(o){var i=this.hot.countRows();return Array.isArray(o)&&o.length>0?o.every(function(a){return Number.isInteger(a)&&a>=0&&a<i}):!1}},{key:"resetCellsMeta",value:function(){$(this.hot.getCellsMeta(),function(o){o&&(o.skipRowOnPaste=!1)})}},{key:"onModifyRowHeight",value:function(o,i){return this.isHidden(i)?0:o}},{key:"onAfterGetCellMeta",value:function(o,i,a){if(zr(this,Zn).copyPasteEnabled===!1&&this.isHidden(o)&&(a.skipRowOnPaste=!0),this.isHidden(o-1))a.className=a.className||"",a.className.indexOf("afterHiddenRow")===-1&&(a.className+=" afterHiddenRow");else if(a.className){var l=a.className.split(" ");if(l.length>0){var s=l.indexOf("afterHiddenRow");s>-1&&l.splice(s,1),a.className=l.join(" ")}}}},{key:"onModifyCopyableRange",value:function(o){var i=this;if(zr(this,Zn).copyPasteEnabled)return o;var a=[],l=function(u,f,c,h){a.push({startRow:u,endRow:f,startCol:c,endCol:h})};return $(o,function(s){var u=!0,f=0;_e(s.startRow,s.endRow,function(c){i.isHidden(c)?(u||l(f,c-1,s.startCol,s.endCol),u=!0):(u&&(f=c),c===s.endRow&&l(f,c,s.startCol,s.endCol),u=!1)})}),a}},{key:"onAfterGetRowHeader",value:function(o,i){if(!(!zr(this,Zn).indicators||o<0)){var a=[];o>=1&&this.isHidden(o-1)&&a.push("afterHiddenRow"),o<this.hot.countRows()-1&&this.isHidden(o+1)&&a.push("beforeHiddenRow"),re(i,a)}}},{key:"onAfterContextMenuDefaultOptions",value:function(o){o.items.push({name:Ye},Aje(this),Nje(this))}},{key:"onMapInit",value:function(){Array.isArray(zr(this,Zn).rows)&&this.hideRows(zr(this,Zn).rows)}},{key:"destroy",value:function(){ac(this,Zn,null),ac(this,Pn,null),wa(_o(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return ES}},{key:"PLUGIN_PRIORITY",get:function(){return qje}}]),r}(ot);function Zje(e,t){return tFe(e)||eFe(e,t)||Qje(e,t)||Jje()}function Jje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Qje(e,t){if(e){if(typeof e=="string")return cH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return cH(e,t)}}function cH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function eFe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function tFe(e){if(Array.isArray(e))return e}function rFe(e){return{key:"freeze_column",name:function(){return this.getTranslatedPhrase(cT)},callback:function(r,n){var o=Zje(n,1),i=o[0].start.col;e.freezeColumn(i),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var r=this.getSelectedRange(),n=!1;return(r===void 0||r.length>1||r[0].from.col!==r[0].to.col||r[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function nFe(e,t){return lFe(e)||aFe(e,t)||iFe(e,t)||oFe()}function oFe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iFe(e,t){if(e){if(typeof e=="string")return hH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hH(e,t)}}function hH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function aFe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function lFe(e){if(Array.isArray(e))return e}function sFe(e){return{key:"unfreeze_column",name:function(){return this.getTranslatedPhrase(hT)},callback:function(r,n){var o=nFe(n,1),i=o[0].start.col;e.unfreezeColumn(i),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var r=this.getSelectedRange(),n=!1;return(r===void 0||r.length>1||r[0].from.col!==r[0].to.col||r[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function Uu(e){"@babel/helpers - typeof";return Uu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uu(e)}function uFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cFe(n.key),n)}}function fFe(e,t,r){return t&&dH(e.prototype,t),r&&dH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cFe(e){var t=hFe(e,"string");return Uu(t)==="symbol"?t:String(t)}function hFe(e,t){if(Uu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Uu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function as(){return typeof Reflect<"u"&&Reflect.get?as=Reflect.get.bind():as=function(t,r,n){var o=dFe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},as.apply(this,arguments)}function dFe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_i(e),e!==null););return e}function vFe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&uR(e,t)}function uR(e,t){return uR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},uR(e,t)}function yFe(e){var t=pFe();return function(){var n=_i(e),o;if(t){var i=_i(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return gFe(this,o)}}function gFe(e,t){if(t&&(Uu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xz(e)}function xz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pFe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _i(e){return _i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_i(e)}pe.getSingleton().register("beforeColumnFreeze");pe.getSingleton().register("afterColumnFreeze");pe.getSingleton().register("beforeColumnUnfreeze");pe.getSingleton().register("afterColumnUnfreeze");var vH="manualColumnFreeze",mFe=110,lc=new WeakMap,bFe=function(e){vFe(r,e);var t=yFe(r);function r(n){var o;return uFe(this,r),o=t.call(this,n),lc.set(xz(o),{afterFirstUse:!1}),o}return fFe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[vH]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(i){return o.addContextMenuEntry(i)}),this.addHook("beforeColumnMove",function(i,a){return o.onBeforeColumnMove(i,a)}),as(_i(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var o=lc.get(this);o.afterFirstUse=!1,as(_i(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),as(_i(r.prototype),"updatePlugin",this).call(this)}},{key:"freezeColumn",value:function(o){var i=lc.get(this),a=this.hot.getSettings(),l=a.fixedColumnsStart<this.hot.countCols()&&o>a.fixedColumnsStart-1;i.afterFirstUse||(i.afterFirstUse=!0);var s=this.hot.runHooks("beforeColumnFreeze",o,l);s!==!1&&(l&&(this.hot.columnIndexMapper.moveIndexes(o,a.fixedColumnsStart),a._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",o,l))}},{key:"unfreezeColumn",value:function(o){var i=lc.get(this),a=this.hot.getSettings(),l=a.fixedColumnsStart>0&&o<=a.fixedColumnsStart-1;i.afterFirstUse||(i.afterFirstUse=!0);var s=this.hot.runHooks("beforeColumnUnfreeze",o,l);s!==!1&&(l&&(a._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(o,a.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",o,l))}},{key:"addContextMenuEntry",value:function(o){o.items.push({name:"---------"},rFe(this),sFe(this))}},{key:"onBeforeColumnMove",value:function(o,i){var a=lc.get(this);if(a.afterFirstUse){var l=this.hot.getSettings().fixedColumnsStart;if(i<l||o.some(function(s){return s<l}))return!1}}}],[{key:"PLUGIN_KEY",get:function(){return vH}},{key:"PLUGIN_PRIORITY",get:function(){return mFe}}]),r}(ot);function kd(e){"@babel/helpers - typeof";return kd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kd(e)}function wFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,CFe(n.key),n)}}function SFe(e,t,r){return t&&yH(e.prototype,t),r&&yH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function CFe(e){var t=_Fe(e,"string");return kd(t)==="symbol"?t:String(t)}function _Fe(e,t){if(kd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(kd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TS=0,gH=1,pH=2,Dl="px",OFe=function(){function e(t){wFe(this,e),this.hot=t,this._element=null,this.state=TS,this.inlineProperty=t.isRtl()?"right":"left"}return SFe(e,[{key:"appendTo",value:function(r){r.appendChild(this._element),this.state=pH}},{key:"build",value:function(){this.state===TS&&(this._element=this.hot.rootDocument.createElement("div"),this.state=gH)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=TS}},{key:"isAppended",value:function(){return this.state===pH}},{key:"isBuilt",value:function(){return this.state>=gH}},{key:"setPosition",value:function(r,n){gr(r)&&(this._element.style.top=r+Dl),gr(n)&&(this._element.style[this.inlineProperty]=n+Dl)}},{key:"getPosition",value:function(){var r=this._element.style;return{top:r.top?parseInt(r.top,10):0,start:r[this.inlineProperty]?parseInt(r[this.inlineProperty],10):0}}},{key:"setSize",value:function(r,n){gr(r)&&(this._element.style.width=r+Dl),gr(n)&&(this._element.style.height=n+Dl)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(r,n){gr(r)&&(this._element.style.marginTop=r+Dl),gr(n)&&(this._element.style["margin".concat(ar(this.inlineProperty))]=n+Dl)}},{key:"getOffset",value:function(){var r=this._element.style,n="margin".concat(ar(this.inlineProperty));return{top:r.marginTop?parseInt(r.marginTop,10):0,start:r[n]?parseInt(r[n],10):0}}}]),e}();const Dz=OFe;function zu(e){"@babel/helpers - typeof";return zu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zu(e)}function RFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,TFe(n.key),n)}}function EFe(e,t,r){return t&&mH(e.prototype,t),r&&mH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function TFe(e){var t=kFe(e,"string");return zu(t)==="symbol"?t:String(t)}function kFe(e,t){if(zu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kg(){return typeof Reflect<"u"&&Reflect.get?kg=Reflect.get.bind():kg=function(t,r,n){var o=PFe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},kg.apply(this,arguments)}function PFe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Yu(e),e!==null););return e}function $Fe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fR(e,t)}function fR(e,t){return fR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},fR(e,t)}function AFe(e){var t=xFe();return function(){var n=Yu(e),o;if(t){var i=Yu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return IFe(this,o)}}function IFe(e,t){if(t&&(zu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return MFe(e)}function MFe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xFe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Yu(e){return Yu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Yu(e)}var DFe="ht__manualColumnMove--backlight",NFe=function(e){$Fe(r,e);var t=AFe(r);function r(){return RFe(this,r),t.apply(this,arguments)}return EFe(r,[{key:"build",value:function(){kg(Yu(r.prototype),"build",this).call(this),re(this._element,DFe)}}]),r}(Dz);const HFe=NFe;function Gu(e){"@babel/helpers - typeof";return Gu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gu(e)}function LFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,FFe(n.key),n)}}function jFe(e,t,r){return t&&bH(e.prototype,t),r&&bH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function FFe(e){var t=BFe(e,"string");return Gu(t)==="symbol"?t:String(t)}function BFe(e,t){if(Gu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Pg(){return typeof Reflect<"u"&&Reflect.get?Pg=Reflect.get.bind():Pg=function(t,r,n){var o=VFe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Pg.apply(this,arguments)}function VFe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ku(e),e!==null););return e}function WFe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&cR(e,t)}function cR(e,t){return cR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},cR(e,t)}function UFe(e){var t=GFe();return function(){var n=Ku(e),o;if(t){var i=Ku(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return zFe(this,o)}}function zFe(e,t){if(t&&(Gu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return YFe(e)}function YFe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function GFe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ku(e){return Ku=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ku(e)}var KFe="ht__manualColumnMove--guideline",qFe=function(e){WFe(r,e);var t=UFe(r);function r(){return LFe(this,r),t.apply(this,arguments)}return jFe(r,[{key:"build",value:function(){Pg(Ku(r.prototype),"build",this).call(this),re(this._element,KFe)}}]),r}(Dz);const XFe=qFe;function qu(e){"@babel/helpers - typeof";return qu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qu(e)}function ZFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,QFe(n.key),n)}}function JFe(e,t,r){return t&&wH(e.prototype,t),r&&wH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function QFe(e){var t=eBe(e,"string");return qu(t)==="symbol"?t:String(t)}function eBe(e,t){if(qu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Sa(){return typeof Reflect<"u"&&Reflect.get?Sa=Reflect.get.bind():Sa=function(t,r,n){var o=tBe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Sa.apply(this,arguments)}function tBe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Oo(e),e!==null););return e}function rBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hR(e,t)}function hR(e,t){return hR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},hR(e,t)}function nBe(e){var t=iBe();return function(){var n=Oo(e),o;if(t){var i=Oo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return oBe(this,o)}}function oBe(e,t){if(t&&(qu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dR(e)}function dR(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iBe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Oo(e){return Oo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Oo(e)}pe.getSingleton().register("beforeColumnMove");pe.getSingleton().register("afterColumnMove");var kS="manualColumnMove",aBe=120,Qo=new WeakMap,SH="ht__manualColumnMove",Ly="show-ui",PS="on-moving--columns",$S="after-selection--columns",lBe=function(e){rBe(r,e);var t=nBe(r);function r(n){var o;return ZFe(this,r),o=t.call(this,n),Qo.set(dR(o),{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0},cachedDropIndex:void 0}),o.eventManager=new Tt(dR(o)),o.backlight=new HFe(n),o.guideline=new XFe(n),o}return JFe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[kS]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return o.onBeforeOnCellMouseOver.apply(o,arguments)}),this.addHook("afterScrollVertically",function(){return o.onAfterScrollVertically()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.buildPluginUI(),this.registerEvents(),re(this.hot.rootElement,SH),Sa(Oo(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),Sa(Oo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Le(this.hot.rootElement,SH),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),Sa(Oo(r.prototype),"disablePlugin",this).call(this)}},{key:"moveColumn",value:function(o,i){return this.moveColumns([o],i)}},{key:"moveColumns",value:function(o,i){var a=Qo.get(this),l=a.cachedDropIndex,s=this.isMovePossible(o,i),u=this.hot.runHooks("beforeColumnMove",o,i,l,s);if(a.cachedDropIndex=void 0,u!==!1){s&&this.hot.columnIndexMapper.moveIndexes(o,i);var f=s&&this.isColumnOrderChanged(o,i);return this.hot.runHooks("afterColumnMove",o,i,l,s,f),f}}},{key:"dragColumn",value:function(o,i){return this.dragColumns([o],i)}},{key:"dragColumns",value:function(o,i){var a=this.countFinalIndex(o,i),l=Qo.get(this);return l.cachedDropIndex=i,this.moveColumns(o,a)}},{key:"isMovePossible",value:function(o,i){var a=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),l=o.length+i>a,s=i<0,u=o.some(function(c){return c<0}),f=o.some(function(c){return c>=a});return!(l||s||u||f)}},{key:"isColumnOrderChanged",value:function(o,i){return o.some(function(a,l){return a-l!==i})}},{key:"countFinalIndex",value:function(o,i){var a=Lt(o,function(l,s){return s<i&&(l+=1),l},0);return i-a}},{key:"getColumnsWidth",value:function(o,i){for(var a=this.hot.columnIndexMapper,l=0,s=o;s<=i;s+=1){var u=a.getRenderableFromVisualIndex(s);s<0?l+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:u!==null&&(l+=this.hot.view._wt.wtTable.getStretchedColumnWidth(u)||0)}return l}},{key:"moveBySettingsOrLoad",value:function(){var o=this.hot.getSettings()[kS];if(Array.isArray(o))this.moveColumns(o,0);else if(o!==void 0){var i=this.persistentStateLoad();i.length&&this.moveColumns(i,0)}}},{key:"isFixedColumnsStart",value:function(o){return o<this.hot.getSettings().fixedColumnsStart}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var o={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",o),o.value?o.value:[]}},{key:"prepareColumnsToMoving",value:function(o,i){var a=[];return _e(o,i,function(l){a.push(l)}),a}},{key:"refreshPositions",value:function(){var o=Qo.get(this),i=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(o.hoveredColumn)&&i>0&&this.hot.scrollViewportTo(void 0,this.hot.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1));var a=this.hot.view._wt.wtTable,l=this.hot.view._wt.wtOverlays.scrollableElement,s=typeof l.scrollX=="number"?l.scrollX:l.scrollLeft,u=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,o.hoveredColumn-1),f=a.hider.offsetWidth,c=a.TBODY.offsetLeft,h=this.backlight.getOffset().start,d=this.backlight.getSize().width,v=0,g=0;if(this.hot.isRtl()){var m=this.hot.rootWindow,w=dt(this.hot.rootElement),S=m.innerWidth-o.rootElementOffset-w;g=m.innerWidth-o.target.eventPageX-S-(l.scrollX===void 0?s:0)}else g=o.target.eventPageX-(o.rootElementOffset-(l.scrollX===void 0?s:0));if(o.hasRowHeaders&&(v=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(o.hoveredColumn)&&(u+=s),u+=v,o.hoveredColumn<0)o.fixedColumnsStart>0?o.target.col=0:o.target.col=i>0?i-1:i;else if(o.target.TD.offsetWidth/2+u<=g){var C=o.hoveredColumn>=o.countCols?o.countCols-1:o.hoveredColumn;o.target.col=C+1,u+=o.target.TD.offsetWidth}else o.target.col=o.hoveredColumn;var k=g,R=u;g+d+h>=f?k=f-d-h:g+h<c+v&&(k=c+v+Math.abs(h)),u>=f-1?R=f-1:R===0?R=1:l.scrollX!==void 0&&o.hoveredColumn<o.fixedColumnsStart&&(R-=o.rootElementOffset<=l.scrollX?o.rootElementOffset:0),this.backlight.setPosition(null,k),this.guideline.setPosition(null,R)}},{key:"registerEvents",value:function(){var o=this,i=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(i,"mousemove",function(a){return o.onMouseMove(a)}),this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,l){var s=this.hot.view._wt.wtTable,u=this.hot.selection.isSelectedByColumnHeader(),f=this.hot.getSelectedRangeLast(),c=Qo.get(this),h=xe(o.target,"sortAction");if(!f||!u||c.pressed||o.button!==0||h){c.pressed=!1,c.columnsToMove.length=0,Le(this.hot.rootElement,[PS,Ly]);return}var d=this.guideline.isBuilt()&&!this.guideline.isAppended(),v=this.backlight.isBuilt()&&!this.backlight.isAppended();d&&v&&(this.guideline.appendTo(s.hider),this.backlight.appendTo(s.hider));var g=f.from,m=f.to,w=Math.min(g.col,m.col),S=Math.max(g.col,m.col);if(i.row<0&&i.col>=w&&i.col<=S){l.column=!0,c.pressed=!0,c.target.eventPageX=o.pageX,c.target.eventOffsetX=o.offsetX,c.hoveredColumn=i.col,c.target.TD=a,c.target.col=i.col,c.columnsToMove=this.prepareColumnsToMoving(w,S),c.hasRowHeaders=!!this.hot.getSettings().rowHeaders,c.countCols=this.hot.countCols(),c.fixedColumnsStart=this.hot.getSettings().fixedColumnsStart,c.rootElementOffset=Vt(this.hot.rootElement).left;var C=c.hasRowHeaders?-1:0,k=s.holder.scrollTop+s.getColumnHeaderHeight(0)+1,R=i.col<c.fixedColumnsStart,V=Math.abs(this.hot.view._wt.wtOverlays.inlineStartOverlay.getScrollPosition()),U=Math.abs(o.offsetX-(this.hot.isRtl()?o.target.offsetWidth:0)),X=this.getColumnsWidth(w,i.col-1)+U,Y=this.getColumnsWidth(C,w-1)+(R?V:0)+X;this.backlight.setPosition(k,Y),this.backlight.setSize(this.getColumnsWidth(w,S),s.hider.offsetHeight-k),this.backlight.setOffset(null,-X),re(this.hot.rootElement,PS)}else Le(this.hot.rootElement,$S),c.pressed=!1,c.columnsToMove.length=0}},{key:"onMouseMove",value:function(o){var i=Qo.get(this);if(i.pressed){if(o.target===this.backlight.element){var a=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout(function(){this.backlight.setPosition(a)})}i.target.eventPageX=o.pageX,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(o,i,a,l){var s=this.hot.getSelectedRangeLast(),u=Qo.get(this);!s||!u.pressed||(u.columnsToMove.indexOf(i.col)>-1?Le(this.hot.rootElement,Ly):re(this.hot.rootElement,Ly),l.row=!0,l.column=!0,l.cell=!0,u.hoveredColumn=i.col,u.target.TD=a)}},{key:"onMouseUp",value:function(){var o=Qo.get(this),i=o.target.col,a=o.columnsToMove.length;if(o.hoveredColumn=void 0,o.pressed=!1,o.backlightWidth=0,Le(this.hot.rootElement,[PS,Ly,$S]),this.hot.selection.isSelectedByColumnHeader()&&re(this.hot.rootElement,$S),!(a<1||i===void 0)){var l=o.columnsToMove[0],s=this.hot.toPhysicalColumn(l),u=this.dragColumns(o.columnsToMove,i);if(o.columnsToMove.length=0,u===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var f=this.hot.toVisualColumn(s),c=f+a-1;this.hot.selectColumns(f,c)}}}},{key:"onAfterScrollVertically",value:function(){var o=this.hot.view._wt.wtTable,i=o.getColumnHeaderHeight(0)+1,a=o.holder.scrollTop,l=i+a;this.backlight.setPosition(l),this.backlight.setSize(null,o.hider.offsetHeight-l)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),Sa(Oo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return kS}},{key:"PLUGIN_PRIORITY",get:function(){return aBe}}]),r}(ot);function Xu(e){"@babel/helpers - typeof";return Xu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xu(e)}function sBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fBe(n.key),n)}}function uBe(e,t,r){return t&&CH(e.prototype,t),r&&CH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fBe(e){var t=cBe(e,"string");return Xu(t)==="symbol"?t:String(t)}function cBe(e,t){if(Xu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ca(){return typeof Reflect<"u"&&Reflect.get?Ca=Reflect.get.bind():Ca=function(t,r,n){var o=hBe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ca.apply(this,arguments)}function hBe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ro(e),e!==null););return e}function dBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vR(e,t)}function vR(e,t){return vR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},vR(e,t)}function vBe(e){var t=gBe();return function(){var n=Ro(e),o;if(t){var i=Ro(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return yBe(this,o)}}function yBe(e,t){if(t&&(Xu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yR(e)}function yR(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gBe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ro(e){return Ro=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ro(e)}var jy="manualColumnResize",pBe=130,_H="manualColumnWidths",AS=new WeakMap,mBe=function(e){dBe(r,e);var t=vBe(r);function r(n){var o;sBe(this,r),o=t.call(this,n);var i=o.hot.rootDocument;return o.currentTH=null,o.currentCol=null,o.selectedCols=[],o.currentWidth=null,o.newSize=null,o.startY=null,o.startWidth=null,o.startOffset=null,o.handle=i.createElement("DIV"),o.guide=i.createElement("DIV"),o.eventManager=new Tt(yR(o)),o.pressed=null,o.dblclick=0,o.autoresizeTimeout=null,o.columnWidthsMap=void 0,AS.set(yR(o),{config:void 0}),re(o.handle,"manualColumnResizer"),re(o.guide,"manualColumnResizerGuide"),o}return uBe(r,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[jy]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.columnWidthsMap=new Mi,this.columnWidthsMap.addLocalHook("init",function(){return o.onMapInit()}),this.hot.columnIndexMapper.registerMap(this.pluginName,this.columnWidthsMap),this.addHook("modifyColWidth",function(i,a){return o.onModifyColWidth(i,a)}),this.addHook("beforeStretchingColumnWidth",function(i,a){return o.onBeforeStretchingColumnWidth(i,a)}),this.addHook("beforeColumnResize",function(i,a,l){return o.onBeforeColumnResize(i,a,l)}),this.bindEvents(),Ca(Ro(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Ca(Ro(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var o=AS.get(this);o.config=this.columnWidthsMap.getValues(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),Ca(Ro(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualColumnWidths",value:function(){this.hot.runHooks("persistentStateSave",_H,this.columnWidthsMap.getValues())}},{key:"loadManualColumnWidths",value:function(){var o={};return this.hot.runHooks("persistentStateLoad",_H,o),o.value}},{key:"setManualSize",value:function(o,i){var a=Math.max(i,20),l=this.hot.toPhysicalColumn(o);return this.columnWidthsMap.setValueAtIndex(l,a),a}},{key:"clearManualSize",value:function(o){var i=this.hot.toPhysicalColumn(o);this.columnWidthsMap.setValueAtIndex(i,null)}},{key:"onMapInit",value:function(){var o=this,i=AS.get(this),a=this.hot.getSettings()[jy],l=this.loadManualColumnWidths();typeof l<"u"?this.hot.batchExecution(function(){l.forEach(function(s,u){o.columnWidthsMap.setValueAtIndex(u,s)})},!0):Array.isArray(a)?(this.hot.batchExecution(function(){a.forEach(function(s,u){o.columnWidthsMap.setValueAtIndex(u,s)})},!0),i.config=a):a===!0&&Array.isArray(i.config)&&this.hot.batchExecution(function(){i.config.forEach(function(s,u){o.columnWidthsMap.setValueAtIndex(u,s)})},!0)}},{key:"setupHandlePosition",value:function(o){var i=this;if(o.parentNode){this.currentTH=o;var a=this.hot.view._wt,l=a.wtTable.getCoords(this.currentTH),s=l.col;if(!(s<0)){var u=Rt(this.currentTH),f=this.currentTH.getBoundingClientRect(),c=s<a.getSetting("fixedColumnsStart"),h;c&&(h=a.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col)),h||(h=a.wtOverlays.topOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col)),this.currentCol=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s),this.selectedCols=[];var d=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&d){var v=this.hot.getSelectedRange();$(v,function(g){var m=g.getTopStartCorner().col,w=g.getBottomEndCorner().col;_e(m,w,function(S){i.selectedCols.includes(S)||i.selectedCols.push(S)})})}this.selectedCols.includes(this.currentCol)||(this.selectedCols=[this.currentCol]),this.startOffset=h.start-6,this.startWidth=parseInt(f.width,10),this.handle.style.top="".concat(h.top,"px"),this.handle.style[this.inlineDir]="".concat(this.startOffset+this.startWidth,"px"),this.handle.style.height="".concat(u,"px"),this.hot.rootElement.appendChild(this.handle)}}}},{key:"refreshHandlePosition",value:function(){this.handle.style[this.inlineDir]="".concat(this.startOffset+this.currentWidth,"px")}},{key:"setupGuidePosition",value:function(){var o=parseInt(Rt(this.handle),10),i=parseInt(this.handle.style.top,10)+o,a=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);re(this.handle,"active"),re(this.guide,"active"),this.guide.style.top="".concat(i,"px"),this.refreshGuidePosition(),this.guide.style.height="".concat(a-o,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style[this.inlineDir]=this.handle.style[this.inlineDir]}},{key:"hideHandleAndGuide",value:function(){Le(this.handle,"active"),Le(this.guide,"active")}},{key:"checkIfColumnHeader",value:function(o){return!!di(o,["THEAD"],this.hot.rootElement)}},{key:"getClosestTHParent",value:function(o){return o.tagName!=="TABLE"?o.tagName==="TH"?o:this.getClosestTHParent(o.parentNode):null}},{key:"onMouseOver",value:function(o){if(!wE(o.target)&&this.checkIfColumnHeader(o.target)){var i=this.getClosestTHParent(o.target);if(!i)return;var a=i.getAttribute("colspan");i&&(a===null||a==="1")&&(this.pressed||this.setupHandlePosition(i))}}},{key:"afterMouseDownTimeout",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,f){var c=o.hot.runHooks("beforeColumnResize",o.newSize,u,!0);c!==void 0&&(o.newSize=c),o.hot.getSettings().stretchH==="all"?o.clearManualSize(u):o.setManualSize(u,o.newSize),o.saveManualColumnWidths(),o.hot.runHooks("afterColumnResize",o.newSize,u,!0),f&&i()};if(this.dblclick>=2){var l=this.selectedCols.length;l>1?($(this.selectedCols,function(s){a(s)}),i()):$(this.selectedCols,function(s){a(s,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(o){var i=this;xe(o.target,"manualColumnResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return i.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=o.pageX,this.newSize=this.startWidth)}},{key:"onMouseMove",value:function(o){var i=this;if(this.pressed){var a=(o.pageX-this.startX)*this.hot.getDirectionFactor();this.currentWidth=this.startWidth+a,$(this.selectedCols,function(l){i.newSize=i.setManualSize(l,i.currentWidth)}),this.refreshHandlePosition(),this.refreshGuidePosition()}}},{key:"onMouseUp",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,f){o.hot.runHooks("beforeColumnResize",o.newSize,u,!1),f&&i(),o.saveManualColumnWidths(),o.hot.runHooks("afterColumnResize",o.newSize,u,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth){var l=this.selectedCols.length;l>1?($(this.selectedCols,function(s){a(s)}),i()):$(this.selectedCols,function(s){a(s,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var o=this,i=this.hot,a=i.rootWindow,l=i.rootElement;this.eventManager.addEventListener(l,"mouseover",function(s){return o.onMouseOver(s)}),this.eventManager.addEventListener(l,"mousedown",function(s){return o.onMouseDown(s)}),this.eventManager.addEventListener(a,"mousemove",function(s){return o.onMouseMove(s)}),this.eventManager.addEventListener(a,"mouseup",function(){return o.onMouseUp()})}},{key:"onModifyColWidth",value:function(o,i){var a=o;if(this.enabled){var l=this.hot.toPhysicalColumn(i),s=this.columnWidthsMap.getValueAtIndex(l);this.hot.getSettings()[jy]&&s&&(a=s)}return a}},{key:"onBeforeStretchingColumnWidth",value:function(o,i){var a=this.columnWidthsMap.getValueAtIndex(i);return a===null&&(a=o),a}},{key:"onBeforeColumnResize",value:function(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}},{key:"destroy",value:function(){Ca(Ro(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return jy}},{key:"PLUGIN_PRIORITY",get:function(){return pBe}}]),r}(ot);function Pd(e){"@babel/helpers - typeof";return Pd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pd(e)}function bBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,SBe(n.key),n)}}function wBe(e,t,r){return t&&OH(e.prototype,t),r&&OH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function SBe(e){var t=CBe(e,"string");return Pd(t)==="symbol"?t:String(t)}function CBe(e,t){if(Pd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Pd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var IS=0,RH=1,EH=2,Nl="px",_Be=function(){function e(t){bBe(this,e),this.hot=t,this._element=null,this.state=IS}return wBe(e,[{key:"appendTo",value:function(r){r.appendChild(this._element),this.state=EH}},{key:"build",value:function(){this.state===IS&&(this._element=this.hot.rootDocument.createElement("div"),this.state=RH)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=IS}},{key:"isAppended",value:function(){return this.state===EH}},{key:"isBuilt",value:function(){return this.state>=RH}},{key:"setPosition",value:function(r,n){r!==void 0&&(this._element.style.top=r+Nl),n!==void 0&&(this._element.style.left=n+Nl)}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(r,n){r&&(this._element.style.width=r+Nl),n&&(this._element.style.height=n+Nl)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(r,n){r&&(this._element.style.marginTop=r+Nl),n&&(this._element.style.marginLeft=n+Nl)}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}]),e}();const Nz=_Be;function Zu(e){"@babel/helpers - typeof";return Zu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zu(e)}function OBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,EBe(n.key),n)}}function RBe(e,t,r){return t&&TH(e.prototype,t),r&&TH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function EBe(e){var t=TBe(e,"string");return Zu(t)==="symbol"?t:String(t)}function TBe(e,t){if(Zu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $g(){return typeof Reflect<"u"&&Reflect.get?$g=Reflect.get.bind():$g=function(t,r,n){var o=kBe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},$g.apply(this,arguments)}function kBe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ju(e),e!==null););return e}function PBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gR(e,t)}function gR(e,t){return gR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},gR(e,t)}function $Be(e){var t=MBe();return function(){var n=Ju(e),o;if(t){var i=Ju(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return ABe(this,o)}}function ABe(e,t){if(t&&(Zu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return IBe(e)}function IBe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MBe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ju(e){return Ju=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ju(e)}var xBe="ht__manualRowMove--backlight",DBe=function(e){PBe(r,e);var t=$Be(r);function r(){return OBe(this,r),t.apply(this,arguments)}return RBe(r,[{key:"build",value:function(){$g(Ju(r.prototype),"build",this).call(this),re(this._element,xBe)}}]),r}(Nz);const NBe=DBe;function Qu(e){"@babel/helpers - typeof";return Qu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qu(e)}function HBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jBe(n.key),n)}}function LBe(e,t,r){return t&&kH(e.prototype,t),r&&kH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jBe(e){var t=FBe(e,"string");return Qu(t)==="symbol"?t:String(t)}function FBe(e,t){if(Qu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ag(){return typeof Reflect<"u"&&Reflect.get?Ag=Reflect.get.bind():Ag=function(t,r,n){var o=BBe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ag.apply(this,arguments)}function BBe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ef(e),e!==null););return e}function VBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pR(e,t)}function pR(e,t){return pR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},pR(e,t)}function WBe(e){var t=YBe();return function(){var n=ef(e),o;if(t){var i=ef(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return UBe(this,o)}}function UBe(e,t){if(t&&(Qu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zBe(e)}function zBe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function YBe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ef(e){return ef=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ef(e)}var GBe="ht__manualRowMove--guideline",KBe=function(e){VBe(r,e);var t=WBe(r);function r(){return HBe(this,r),t.apply(this,arguments)}return LBe(r,[{key:"build",value:function(){Ag(ef(r.prototype),"build",this).call(this),re(this._element,GBe)}}]),r}(Nz);const qBe=KBe;function tf(e){"@babel/helpers - typeof";return tf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tf(e)}function XBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,JBe(n.key),n)}}function ZBe(e,t,r){return t&&PH(e.prototype,t),r&&PH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function JBe(e){var t=QBe(e,"string");return tf(t)==="symbol"?t:String(t)}function QBe(e,t){if(tf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(tf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _a(){return typeof Reflect<"u"&&Reflect.get?_a=Reflect.get.bind():_a=function(t,r,n){var o=eVe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_a.apply(this,arguments)}function eVe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Eo(e),e!==null););return e}function tVe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mR(e,t)}function mR(e,t){return mR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},mR(e,t)}function rVe(e){var t=oVe();return function(){var n=Eo(e),o;if(t){var i=Eo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return nVe(this,o)}}function nVe(e,t){if(t&&(tf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bR(e)}function bR(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oVe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Eo(e){return Eo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Eo(e)}pe.getSingleton().register("beforeRowMove");pe.getSingleton().register("afterRowMove");var MS="manualRowMove",iVe=140,ei=new WeakMap,$H="ht__manualRowMove",Fy="show-ui",xS="on-moving--rows",DS="after-selection--rows",aVe=function(e){tVe(r,e);var t=rVe(r);function r(n){var o;return XBe(this,r),o=t.call(this,n),ei.set(bR(o),{rowsToMove:[],pressed:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0},cachedDropIndex:void 0}),o.eventManager=new Tt(bR(o)),o.backlight=new NBe(n),o.guideline=new qBe(n),o}return ZBe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[MS]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return o.onBeforeOnCellMouseOver.apply(o,arguments)}),this.addHook("afterScrollHorizontally",function(){return o.onAfterScrollHorizontally()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.buildPluginUI(),this.registerEvents(),re(this.hot.rootElement,$H),_a(Eo(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),_a(Eo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Le(this.hot.rootElement,$H),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),_a(Eo(r.prototype),"disablePlugin",this).call(this)}},{key:"moveRow",value:function(o,i){return this.moveRows([o],i)}},{key:"moveRows",value:function(o,i){var a=ei.get(this),l=a.cachedDropIndex,s=this.isMovePossible(o,i),u=this.hot.runHooks("beforeRowMove",o,i,l,s);if(a.cachedDropIndex=void 0,u!==!1){s&&this.hot.rowIndexMapper.moveIndexes(o,i);var f=s&&this.isRowOrderChanged(o,i);return this.hot.runHooks("afterRowMove",o,i,l,s,f),f}}},{key:"dragRow",value:function(o,i){return this.dragRows([o],i)}},{key:"dragRows",value:function(o,i){var a=this.countFinalIndex(o,i),l=ei.get(this);return l.cachedDropIndex=i,this.moveRows(o,a)}},{key:"isMovePossible",value:function(o,i){var a=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),l=o.length+i>a,s=i<0,u=o.some(function(c){return c<0}),f=o.some(function(c){return c>=a});return!(l||s||u||f)}},{key:"isRowOrderChanged",value:function(o,i){return o.some(function(a,l){return a-l!==i})}},{key:"countFinalIndex",value:function(o,i){var a=Lt(o,function(l,s){return s<i&&(l+=1),l},0);return i-a}},{key:"getRowsHeight",value:function(o,i){for(var a=this.hot.rowIndexMapper,l=0,s=o;s<=i;s++){var u=a.getRenderableFromVisualIndex(s);u!==null&&(l+=this.hot.view._wt.wtTable.getRowHeight(u)||23)}return l}},{key:"moveBySettingsOrLoad",value:function(){var o=this.hot.getSettings()[MS];if(Array.isArray(o))this.moveRows(o,0);else if(o!==void 0){var i=this.persistentStateLoad();i.length&&this.moveRows(i,0)}}},{key:"isFixedRowTop",value:function(o){return o<this.hot.getSettings().fixedRowsTop}},{key:"isFixedRowBottom",value:function(o){return o>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var o={};return this.hot.runHooks("persistentStateLoad","manualRowMove",o),o.value?o.value:[]}},{key:"prepareRowsToMoving",value:function(){var o=this.hot.getSelectedRangeLast(),i=[];if(!o)return i;var a=o.from,l=o.to,s=Math.min(a.row,l.row),u=Math.max(a.row,l.row);return _e(s,u,function(f){i.push(f)}),i}},{key:"refreshPositions",value:function(){var o=ei.get(this),i=o.target.coords,a=this.hot.view.getFirstFullyVisibleRow(),l=this.hot.view.getLastFullyVisibleRow(),s=this.hot.countRows();this.isFixedRowTop(i.row)&&a>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(a-1,-1)),this.isFixedRowBottom(i.row)&&l<s&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(l+1,1),void 0,!0);var u=this.hot.view._wt.wtTable,f=o.target.TD,c=this.hot.rootElement,h=Vt(c),d=Ha(c),v=u.holder.scrollTop,g;this.hot.rootWindow===d?g=d.scrollY:g=d.scrollTop;var m=h.top-g,w=o.target.eventPageY-m+v,S=u.hider.offsetHeight,C=u.TBODY.offsetTop,k=this.backlight.getOffset().top,R=this.backlight.getSize().height,V=f.offsetHeight/2,U=f.offsetHeight,X=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,i.row-1),Y=w>=X+V;this.isFixedRowTop(i.row)&&(X+=u.holder.scrollTop),i.row<0?o.target.row=a>0?a-1:a:Y?(o.target.row=i.row+1,X+=i.row===0?U-1:U):o.target.row=i.row;var q=w,Z=X;w+R+k>=S?q=S-R-k:w+k<C&&(q=C+Math.abs(k)),X>=S-1&&(Z=S-1),this.backlight.setPosition(q),this.guideline.setPosition(Z)}},{key:"registerEvents",value:function(){var o=this,i=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(i,"mousemove",function(a){return o.onMouseMove(a)}),this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,l){var s=this.hot.view._wt,u=s.wtTable,f=s.wtViewport,c=this.hot.selection.isSelectedByRowHeader(),h=this.hot.getSelectedRangeLast(),d=ei.get(this);if(!h||!c||d.pressed||o.button!==0){d.pressed=!1,d.rowsToMove.length=0,Le(this.hot.rootElement,[xS,Fy]);return}var v=this.guideline.isBuilt()&&!this.guideline.isAppended(),g=this.backlight.isBuilt()&&!this.backlight.isAppended();v&&g&&(this.guideline.appendTo(u.hider),this.backlight.appendTo(u.hider));var m=h.from,w=h.to,S=Math.min(m.row,w.row),C=Math.max(m.row,w.row);if(i.col<0&&i.row>=S&&i.row<=C){l.row=!0,d.pressed=!0,d.target.eventPageY=o.pageY,d.target.coords=i,d.target.TD=a,d.rowsToMove=this.prepareRowsToMoving();var k=u.holder.scrollLeft+f.getRowHeaderWidth();this.backlight.setPosition(null,k),this.backlight.setSize(u.hider.offsetWidth-k,this.getRowsHeight(S,C)),this.backlight.setOffset((this.getRowsHeight(S,i.row-1)+o.offsetY)*-1,null),re(this.hot.rootElement,xS),this.refreshPositions()}else Le(this.hot.rootElement,DS),d.pressed=!1,d.rowsToMove.length=0}},{key:"onMouseMove",value:function(o){var i=ei.get(this);if(i.pressed){if(o.target===this.backlight.element){var a=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout(function(){this.backlight.setPosition(null,a)})}i.target.eventPageY=o.pageY,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(o,i,a,l){var s=this.hot.getSelectedRangeLast(),u=ei.get(this);!s||!u.pressed||(u.rowsToMove.indexOf(i.row)>-1?Le(this.hot.rootElement,Fy):re(this.hot.rootElement,Fy),l.row=!0,l.column=!0,l.cell=!0,u.target.coords=i,u.target.TD=a)}},{key:"onMouseUp",value:function(){var o=ei.get(this),i=o.target.row,a=o.rowsToMove.length;if(o.pressed=!1,o.backlightHeight=0,Le(this.hot.rootElement,[xS,Fy,DS]),this.hot.selection.isSelectedByRowHeader()&&re(this.hot.rootElement,DS),!(a<1||i===void 0)){var l=o.rowsToMove[0],s=this.hot.toPhysicalRow(l),u=this.dragRows(o.rowsToMove,i);if(o.rowsToMove.length=0,u===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var f=this.hot.toVisualRow(s),c=f+a-1;this.hot.selectRows(f,c)}}}},{key:"onAfterScrollHorizontally",value:function(){var o=this.hot.view._wt.wtTable,i=this.hot.view._wt.wtViewport.getRowHeaderWidth(),a=o.holder.scrollLeft,l=i+a;this.backlight.setPosition(null,l),this.backlight.setSize(o.hider.offsetWidth-l)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),_a(Eo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return MS}},{key:"PLUGIN_PRIORITY",get:function(){return iVe}}]),r}(ot);function rf(e){"@babel/helpers - typeof";return rf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rf(e)}function lVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uVe(n.key),n)}}function sVe(e,t,r){return t&&AH(e.prototype,t),r&&AH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uVe(e){var t=fVe(e,"string");return rf(t)==="symbol"?t:String(t)}function fVe(e,t){if(rf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Oa(){return typeof Reflect<"u"&&Reflect.get?Oa=Reflect.get.bind():Oa=function(t,r,n){var o=cVe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Oa.apply(this,arguments)}function cVe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=To(e),e!==null););return e}function hVe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wR(e,t)}function wR(e,t){return wR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},wR(e,t)}function dVe(e){var t=yVe();return function(){var n=To(e),o;if(t){var i=To(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return vVe(this,o)}}function vVe(e,t){if(t&&(rf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return SR(e)}function SR(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yVe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function To(e){return To=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},To(e)}var By="manualRowResize",gVe=30,IH="manualRowHeights",NS=new WeakMap,pVe=function(e){hVe(r,e);var t=dVe(r);function r(n){var o;lVe(this,r),o=t.call(this,n);var i=o.hot.rootDocument;return o.currentTH=null,o.currentRow=null,o.selectedRows=[],o.currentHeight=null,o.newSize=null,o.startY=null,o.startHeight=null,o.startOffset=null,o.handle=i.createElement("DIV"),o.guide=i.createElement("DIV"),o.eventManager=new Tt(SR(o)),o.pressed=null,o.dblclick=0,o.autoresizeTimeout=null,o.rowHeightsMap=void 0,NS.set(SR(o),{config:void 0}),re(o.handle,"manualRowResizer"),re(o.guide,"manualRowResizerGuide"),o}return sVe(r,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[By]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.rowHeightsMap=new Mi,this.rowHeightsMap.addLocalHook("init",function(){return o.onMapInit()}),this.hot.rowIndexMapper.registerMap(this.pluginName,this.rowHeightsMap),this.addHook("modifyRowHeight",function(i,a){return o.onModifyRowHeight(i,a)}),this.bindEvents(),Oa(To(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Oa(To(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var o=NS.get(this);o.config=this.rowHeightsMap.getValues(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),Oa(To(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualRowHeights",value:function(){this.hot.runHooks("persistentStateSave",IH,this.rowHeightsMap.getValues())}},{key:"loadManualRowHeights",value:function(){var o={};return this.hot.runHooks("persistentStateLoad",IH,o),o.value}},{key:"setManualSize",value:function(o,i){var a=this.hot.toPhysicalRow(o),l=Math.max(i,f2.DEFAULT_HEIGHT);return this.rowHeightsMap.setValueAtIndex(a,l),l}},{key:"setupHandlePosition",value:function(o){var i=this;this.currentTH=o;var a=this.hot.view,l=a._wt,s=l.wtTable.getCoords(this.currentTH),u=s.row;if(!(u<0)){var f=dt(this.currentTH),c=this.currentTH.getBoundingClientRect(),h=u<l.getSetting("fixedRowsTop"),d=u>=a.countNotHiddenRowIndexes(0,1)-l.getSetting("fixedRowsBottom"),v;h?v=l.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col):d&&(v=l.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),v||(v=l.wtOverlays.inlineStartOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),this.currentRow=this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.selectedRows=[];var g=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&g){var m=this.hot.getSelectedRange();$(m,function(w){var S=w.getTopStartCorner().row,C=w.getBottomStartCorner().row;_e(S,C,function(k){i.selectedRows.includes(k)||i.selectedRows.push(k)})})}this.selectedRows.includes(this.currentRow)||(this.selectedRows=[this.currentRow]),this.startOffset=v.top-6,this.startHeight=parseInt(c.height,10),this.handle.style.top="".concat(this.startOffset+this.startHeight,"px"),this.handle.style[this.inlineDir]="".concat(v.start,"px"),this.handle.style.width="".concat(f,"px"),this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.top="".concat(this.startOffset+this.currentHeight,"px")}},{key:"setupGuidePosition",value:function(){var o=parseInt(dt(this.handle),10),i=parseInt(this.handle.style[this.inlineDir],10)+o,a=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);re(this.handle,"active"),re(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style[this.inlineDir]="".concat(i,"px"),this.guide.style.width="".concat(a-o,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.top=this.handle.style.top}},{key:"hideHandleAndGuide",value:function(){Le(this.handle,"active"),Le(this.guide,"active")}},{key:"checkIfRowHeader",value:function(o){var i,a,l=di(o,["TH"],this.hot.rootElement);return l&&((i=o.parentNode)===null||i===void 0||(a=i.parentNode)===null||a===void 0?void 0:a.tagName)==="TBODY"}},{key:"getClosestTHParent",value:function(o){return o.tagName!=="TABLE"?o.tagName==="TH"?o:this.getClosestTHParent(o.parentNode):null}},{key:"getActualRowHeight",value:function(o){var i=this.hot.view._wt.wtTable.getRowHeight(o);return i!==void 0&&this.newSize<i?i:this.newSize}},{key:"onMouseOver",value:function(o){if(!wE(o.target)&&this.checkIfRowHeader(o.target)){var i=this.getClosestTHParent(o.target);i&&(this.pressed||this.setupHandlePosition(i))}}},{key:"afterMouseDownTimeout",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,f){var c=o.hot.runHooks("beforeRowResize",o.getActualRowHeight(u),u,!0);c!==void 0&&(o.newSize=c),o.setManualSize(u,o.newSize),o.hot.runHooks("afterRowResize",o.getActualRowHeight(u),u,!0),f&&i()};if(this.dblclick>=2){var l=this.selectedRows.length;l>1?($(this.selectedRows,function(s){a(s)}),i()):$(this.selectedRows,function(s){a(s,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(o){var i=this;xe(o.target,"manualRowResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return i.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=o.pageY,this.newSize=this.startHeight)}},{key:"onMouseMove",value:function(o){var i=this;this.pressed&&(this.currentHeight=this.startHeight+(o.pageY-this.startY),$(this.selectedRows,function(a){i.newSize=i.setManualSize(a,i.currentHeight)}),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,f){o.hot.runHooks("beforeRowResize",o.getActualRowHeight(u),u,!1),f&&i(),o.saveManualRowHeights(),o.hot.runHooks("afterRowResize",o.getActualRowHeight(u),u,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight){var l=this.selectedRows.length;l>1?($(this.selectedRows,function(s){a(s)}),i()):$(this.selectedRows,function(s){a(s,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var o=this,i=this.hot,a=i.rootElement,l=i.rootWindow;this.eventManager.addEventListener(a,"mouseover",function(s){return o.onMouseOver(s)}),this.eventManager.addEventListener(a,"mousedown",function(s){return o.onMouseDown(s)}),this.eventManager.addEventListener(l,"mousemove",function(s){return o.onMouseMove(s)}),this.eventManager.addEventListener(l,"mouseup",function(){return o.onMouseUp()})}},{key:"onModifyRowHeight",value:function(o,i){var a=o;if(this.enabled){var l=this.hot.toPhysicalRow(i),s=this.rowHeightsMap.getValueAtIndex(l);this.hot.getSettings()[By]&&s&&(a=s)}return a}},{key:"onMapInit",value:function(){var o=this,i=NS.get(this),a=this.hot.getSettings()[By],l=this.loadManualRowHeights();this.hot.batchExecution(function(){typeof l<"u"?l.forEach(function(s,u){o.rowHeightsMap.setValueAtIndex(u,s)}):Array.isArray(a)?(a.forEach(function(s,u){o.rowHeightsMap.setValueAtIndex(u,s)}),i.config=a):a===!0&&Array.isArray(i.config)&&i.config.forEach(function(s,u){o.rowHeightsMap.setValueAtIndex(u,s)})},!0)}},{key:"destroy",value:function(){Oa(To(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return By}},{key:"PLUGIN_PRIORITY",get:function(){return gVe}}]),r}(ot);function $d(e){"@babel/helpers - typeof";return $d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$d(e)}var MH,xH,DH,NH;function Vy(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function mVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wVe(n.key),n)}}function bVe(e,t,r){return t&&HH(e.prototype,t),r&&HH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wVe(e){var t=SVe(e,"string");return $d(t)==="symbol"?t:String(t)}function SVe(e,t){if($d(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($d(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var CVe=function(){function e(t,r,n,o,i,a){mVe(this,e),this.row=t,this.col=r,this.rowspan=n,this.colspan=o,this.removed=!1,this.cellCoordsFactory=i,this.cellRangeFactory=a}return bVe(e,[{key:"normalize",value:function(r){var n=r.countRows(),o=r.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>o-1&&(this.col=o-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>o-1&&(this.colspan=o-this.col)}},{key:"includes",value:function(r,n){return this.row<=r&&this.col<=n&&this.row+this.rowspan-1>=r&&this.col+this.colspan-1>=n}},{key:"includesHorizontally",value:function(r){return this.col<=r&&this.col+this.colspan-1>=r}},{key:"includesVertically",value:function(r){return this.row<=r&&this.row+this.rowspan-1>=r}},{key:"shift",value:function(r,n){var o=r[0]||r[1],i=n+Math.abs(r[0]||r[1])-1,a=r[0]?"colspan":"rowspan",l=r[0]?"col":"row",s=Math.min(n,i),u=Math.max(n,i),f=this[l],c=this[l]+this[a]-1;if(f>=n&&(this[l]+=o),o>0)n<=c&&n>f&&(this[a]+=o);else if(o<0){if(s<=f&&u>=c)return this.removed=!0,!1;if(f>=s&&f<=u){var h=u-f+1,d=Math.abs(o)-h;this[l]-=d+o,this[a]-=h}else if(f<=s&&c>=u)this[a]+=o;else if(f<=s&&c>=s&&c<u){var v=c-s+1;this[a]-=v}}return!0}},{key:"isFarther",value:function(r,n){return r?n==="down"?r.row+r.rowspan-1<this.row+this.rowspan-1:n==="up"?r.row>this.row:n==="right"?r.col+r.colspan-1<this.col+this.colspan-1:n==="left"?r.col>this.col:null:!0}},{key:"getLastRow",value:function(){return this.row+this.rowspan-1}},{key:"getLastColumn",value:function(){return this.col+this.colspan-1}},{key:"getRange",value:function(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}],[{key:"NEGATIVE_VALUES_WARNING",value:function(r){return ft(MH||(MH=Vy(["The merged cell declared with {row: ",", col: ",`, 
      rowspan: `,", colspan: ",`} contains negative values, which is 
      not supported. It will not be added to the collection.`],["The merged cell declared with {row: ",", col: ",`,\\x20
      rowspan: `,", colspan: ",`} contains negative values, which is\\x20
      not supported. It will not be added to the collection.`])),r.row,r.col,r.rowspan,r.colspan)}},{key:"IS_OUT_OF_BOUNDS_WARNING",value:function(r){return ft(xH||(xH=Vy(["The merged cell declared at [",", ",`] is positioned 
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`],["The merged cell declared at [",", ",`] is positioned\\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`])),r.row,r.col)}},{key:"IS_SINGLE_CELL",value:function(r){return ft(DH||(DH=Vy(["The merged cell declared at [",", ",`] has both "rowspan" 
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has both "rowspan"\\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`])),r.row,r.col)}},{key:"ZERO_SPAN_WARNING",value:function(r){return ft(NH||(NH=Vy(["The merged cell declared at [",", ",`] has "rowspan" 
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has "rowspan"\\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`])),r.row,r.col)}},{key:"containsNegativeValues",value:function(r){return r.row<0||r.col<0||r.rowspan<0||r.colspan<0}},{key:"isSingleCell",value:function(r){return r.colspan===1&&r.rowspan===1}},{key:"containsZeroSpan",value:function(r){return r.colspan===0||r.rowspan===0}},{key:"isOutOfBounds",value:function(r,n,o){return r.row<0||r.col<0||r.row>=n||r.row+r.rowspan-1>=n||r.col>=o||r.col+r.colspan-1>=o}}]),e}();const Mn=CVe;function CR(e,t,r,n){t?t.row===r&&t.col===n?(e.setAttribute("rowspan",t.rowspan.toString()),e.setAttribute("colspan",t.colspan.toString())):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="none"):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="")}function Ad(e){"@babel/helpers - typeof";return Ad=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ad(e)}var LH;function _Ve(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function jH(e){return TVe(e)||EVe(e)||RVe(e)||OVe()}function OVe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function RVe(e,t){if(e){if(typeof e=="string")return _R(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _R(e,t)}}function EVe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function TVe(e){if(Array.isArray(e))return _R(e)}function _R(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function kVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$Ve(n.key),n)}}function PVe(e,t,r){return t&&FH(e.prototype,t),r&&FH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $Ve(e){var t=AVe(e,"string");return Ad(t)==="symbol"?t:String(t)}function AVe(e,t){if(Ad(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ad(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var IVe=function(){function e(t){kVe(this,e),this.plugin=t,this.mergedCells=[],this.hot=t.hot}return PVe(e,[{key:"get",value:function(r,n){var o=this.mergedCells,i=!1;return $(o,function(a){return a.row<=r&&a.row+a.rowspan-1>=r&&a.col<=n&&a.col+a.colspan-1>=n?(i=a,!1):!0}),i}},{key:"getByRange",value:function(r){var n=this.mergedCells,o=!1;return $(n,function(i){return i.row<=r.from.row&&i.row+i.rowspan-1>=r.to.row&&i.col<=r.from.col&&i.col+i.colspan-1>=r.to.col?(o=i,o):!0}),o}},{key:"getWithinRange",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=this.mergedCells,a=[],l=r;if(!l.includesRange){var s=this.hot._createCellCoords(l.from.row,l.from.col),u=this.hot._createCellCoords(l.to.row,l.to.col);l=this.hot._createCellRange(s,s,u)}return $(i,function(f){var c=n.hot._createCellCoords(f.row,f.col),h=n.hot._createCellCoords(f.row+f.rowspan-1,f.col+f.colspan-1),d=n.hot._createCellRange(c,c,h);o?l.overlaps(d)&&a.push(f):l.includesRange(d)&&a.push(f)}),a.length?a:!1}},{key:"add",value:function(r){var n=this.mergedCells,o=r.row,i=r.col,a=r.rowspan,l=r.colspan,s=new Mn(o,i,a,l,this.hot._createCellCoords,this.hot._createCellRange),u=this.get(o,i),f=this.isOverlapping(s);return!u&&!f?(this.hot&&s.normalize(this.hot),n.push(s),s):(ht(e.IS_OVERLAPPING_WARNING(s)),!1)}},{key:"remove",value:function(r,n){var o=this.mergedCells,i=this.get(r,n),a=i?this.mergedCells.indexOf(i):-1;return i&&a!==-1?(o.splice(a,1),i):!1}},{key:"clear",value:function(){var r=this,n=this.mergedCells,o=[],i=[];$(n,function(a){var l=r.hot.getCell(a.row,a.col);l&&o.push([l,r.get(a.row,a.col),a.row,a.col])}),this.mergedCells.length=0,$(o,function(a,l){_e(0,a.rowspan-1,function(s){_e(0,a.colspan-1,function(u){if(u!==0||s!==0){var f=r.hot.getCell(a.row+s,a.col+u);f&&i.push([f,null,null,null])}})}),o[l][1]=null}),$(o,function(a){CR.apply(void 0,jH(a))}),$(i,function(a){CR.apply(void 0,jH(a))})}},{key:"isOverlapping",value:function(r){var n=this,o=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(r.row,r.col),this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1)),i=!1;return $(this.mergedCells,function(a){var l=n.hot._createCellRange(n.hot._createCellCoords(0,0),n.hot._createCellCoords(a.row,a.col),n.hot._createCellCoords(a.row+a.rowspan-1,a.col+a.colspan-1));return l.overlaps(o)?(i=!0,!1):!0}),i}},{key:"isFirstRenderableMergedCell",value:function(r,n){var o=this.get(r,n);return o&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(o.row,1)===r&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(o.col,1)===n}},{key:"getFirstRenderableCoords",value:function(r,n){var o=this.get(r,n);if(!o||this.isFirstRenderableMergedCell(r,n))return this.hot._createCellCoords(r,n);var i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(o.row,1),a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o.col,1);return this.hot._createCellCoords(i,a)}},{key:"shiftCollections",value:function(r,n,o){var i=this,a=[0,0];switch(r){case"right":a[0]+=o;break;case"left":a[0]-=o;break;case"down":a[1]+=o;break;case"up":a[1]-=o;break}$(this.mergedCells,function(l){l.shift(a,n)}),Zg(this.mergedCells.length-1,0,function(l){var s=i.mergedCells[l];s&&s.removed&&i.mergedCells.splice(i.mergedCells.indexOf(s),1)})}}],[{key:"IS_OVERLAPPING_WARNING",value:function(r){return ft(LH||(LH=_Ve(["The merged cell declared at [",", ",`], overlaps 
      with the other declared merged cell. The overlapping merged cell was not added to the table, please 
      fix your setup.`],["The merged cell declared at [",", ",`], overlaps\\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\\x20
      fix your setup.`])),r.row,r.col)}}]),e}();const MVe=IVe;function Id(e){"@babel/helpers - typeof";return Id=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Id(e)}function Zi(e,t){return HVe(e)||NVe(e,t)||DVe(e,t)||xVe()}function xVe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function DVe(e,t){if(e){if(typeof e=="string")return BH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return BH(e,t)}}function BH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function NVe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function HVe(e){if(Array.isArray(e))return e}function LVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,FVe(n.key),n)}}function jVe(e,t,r){return t&&VH(e.prototype,t),r&&VH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function FVe(e){var t=BVe(e,"string");return Id(t)==="symbol"?t:String(t)}function BVe(e,t){if(Id(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Id(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var VVe=function(){function e(t){LVe(this,e),this.plugin=t,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}return jVe(e,[{key:"correctSelectionAreaSize",value:function(r){if(r[0]===r[2]&&r[1]===r[3]){var n=this.mergedCellsCollection.get(r[0],r[1]);n&&(r[2]=r[0]+n.rowspan-1,r[3]=r[1]+n.colspan-1)}}},{key:"getDirection",value:function(r,n){var o=null;return n[0]===r[0]&&n[1]===r[1]&&n[3]===r[3]?o="down":n[2]===r[2]&&n[1]===r[1]&&n[3]===r[3]?o="up":n[1]===r[1]&&n[2]===r[2]?o="right":o="left",o}},{key:"snapDragArea",value:function(r,n,o,i){var a=n.slice(0),l=this.getAutofillSize(r,n,o),s=Zi(r,4),u=s[0],f=s[1],c=s[2],h=s[3],d=["up","down"].indexOf(o)>-1,v=d?c-u+1:h-f+1,g=Math.floor(l/v)*v,m=l-g,w=this.getFarthestCollection(r,n,o,i);if(w){if(o==="down"){var S=w.row+w.rowspan-u-m,C=a[2]+S;C>=this.plugin.hot.countRows()?a[2]-=m:a[2]+=m?S:0}else if(o==="right"){var k=w.col+w.colspan-f-m,R=a[3]+k;R>=this.plugin.hot.countCols()?a[3]-=m:a[3]+=m?k:0}else if(o==="up"){var V=c-m-w.row+1,U=a[0]+V;U<0?a[0]+=m:a[0]-=m?V:0}else if(o==="left"){var X=h-m-w.col+1,Y=a[1]+X;Y<0?a[1]+=m:a[1]-=m?X:0}}return this.updateCurrentFillCache({baseArea:r,dragDirection:o,foundMergedCells:i,fillSize:l,dragArea:a,cycleLength:v}),a}},{key:"updateCurrentFillCache",value:function(r){this.currentFillData||(this.currentFillData={}),Wt(this.currentFillData,r)}},{key:"getAutofillSize",value:function(r,n,o){var i=Zi(r,4),a=i[0],l=i[1],s=i[2],u=i[3],f=Zi(n,4),c=f[0],h=f[1],d=f[2],v=f[3];switch(o){case"up":return a-c;case"down":return d-s;case"left":return l-h;case"right":return v-u;default:return null}}},{key:"getDragArea",value:function(r,n,o){var i=Zi(r,4),a=i[0],l=i[1],s=i[2],u=i[3],f=Zi(n,4),c=f[0],h=f[1],d=f[2],v=f[3];switch(o){case"up":return[c,h,a-1,u];case"down":return[s+1,l,d,u];case"left":return[c,h,s,l-1];case"right":return[a,u+1,d,v];default:return null}}},{key:"getFarthestCollection",value:function(r,n,o,i){var a=Zi(r,4),l=a[0],s=a[1],u=a[2],f=a[3],c=["up","down"].indexOf(o)>-1,h=c?u:f,d=c?l:s,v=this.getAutofillSize(r,n,o),g=c?u-l+1:f-s+1,m=Math.floor(v/g)*g,w=v-m,S=null,C=null,k=null;switch(o){case"up":S="includesVertically",k=h-w+1;break;case"left":S="includesHorizontally",k=h-w+1;break;case"down":S="includesVertically",k=d+w-1;break;case"right":S="includesHorizontally",k=d+w-1;break}return $(i,function(R){R[S](k)&&R.isFarther(C,o)&&(C=R)}),C}},{key:"recreateAfterDataPopulation",value:function(r){if(this.currentFillData){var n=this.getRangeFromChanges(r),o=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,a=function(h,d){switch(i){case"up":return h.row-d>=n.from.row;case"down":return h.row+h.rowspan-1+d<=n.to.row;case"left":return h.col-d>=n.from.column;case"right":return h.col+h.colspan-1+d<=n.to.column;default:return null}},l=0,s=null,u=1;do for(var f=0;f<o.length;f+=1){if(s=o[f],l=u*this.currentFillData.cycleLength,a(s,l))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:s.row-l,rowspan:s.rowspan,col:s.col,colspan:s.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:s.row+l,rowspan:s.rowspan,col:s.col,colspan:s.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col-l,colspan:s.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col+l,colspan:s.colspan});break}f===o.length-1&&(u+=1)}while(a(s,l));this.currentFillData=null,this.plugin.hot.render(),o.length>0&&this.plugin.ifChromeForceRepaint()}}},{key:"getRangeFromChanges",value:function(r){var n=this,o={min:null,max:null},i={min:null,max:null};return $(r,function(a){var l=a[0],s=n.plugin.hot.propToCol(a[1]);(o.min===null||l<o.min)&&(o.min=l),(o.max===null||l>o.max)&&(o.max=l),(i.min===null||s<i.min)&&(i.min=s),(i.max===null||s>i.max)&&(i.max=s)}),{from:{row:o.min,column:i.min},to:{row:o.max,column:i.max}}}},{key:"dragAreaOverlapsCollections",value:function(r,n,o){var i=this.getDragArea(r,n,o),a=Zi(i,4),l=a[0],s=a[1],u=a[2],f=a[3],c=this.plugin.hot._createCellCoords(l,s),h=this.plugin.hot._createCellCoords(u,f),d=this.plugin.hot._createCellRange(c,c,h);return!!this.mergedCellsCollection.getWithinRange(d,!0)}}]),e}();const WVe=VVe;function Md(e){"@babel/helpers - typeof";return Md=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Md(e)}function UVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,YVe(n.key),n)}}function zVe(e,t,r){return t&&WH(e.prototype,t),r&&WH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function YVe(e){var t=GVe(e,"string");return Md(t)==="symbol"?t:String(t)}function GVe(e,t){if(Md(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Md(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var KVe=function(){function e(t){UVe(this,e),this.plugin=t,this.hot=t.hot,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}return zVe(e,[{key:"snapDelta",value:function(r,n,o){var i=n.to,a=i.row+r.row,l=i.col+r.col;r.row?this.jumpOverMergedCell(r,o,a):r.col&&this.jumpOverMergedCell(r,o,l)}},{key:"jumpOverMergedCell",value:function(r,n,o){var i=r.row||r.col,a=null,l=null,s=null;r.row?(a=n.includesVertically(o),l=n.row,s=n.getLastRow()):r.col&&(a=n.includesHorizontally(o),l=n.col,s=n.getLastColumn()),i!==0&&(i>0?a&&o!==l&&(i+=s-o+1):a&&o!==s&&(i-=o-l+1),r.row?r.row=i:r.col&&(r.col=i))}},{key:"getUpdatedSelectionRange",value:function(r,n){return this.hot._createCellRange(r.highlight,r.from,this.hot._createCellCoords(r.to.row+n.row,r.to.col+n.col))}},{key:"getSelectedMergedCellClassName",value:function(r,n,o,i){var a=Math.min(o[0],o[2]),l=Math.min(o[1],o[3]),s=Math.max(o[0],o[2]),u=Math.max(o[1],o[3]);if(i!==void 0){var f=this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(r,n);if(f){var c=this.plugin.mergedCellsCollection.get(r,n);if(c){var h=c.getLastRow(),d=c.getLastColumn(),v=a<=c.row&&l<=c.col&&s>=h&&u>=d;if(v)return"".concat(this.fullySelectedMergedCellClassName,"-").concat(i);if(this.plugin.selectionCalculations.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return"".concat(this.fullySelectedMergedCellClassName,"-multiple")}}}}},{key:"isMergeCellFullySelected",value:function(r,n){var o=[];if(!n||!r)return!1;for(var i=0;i<r.rowspan;i+=1)for(var a=0;a<r.colspan;a+=1)o.push(this.hot._createCellCoords(r.row+i,r.col+a));for(var l=0;l<o.length;l+=1){for(var s=[],u=0;u<n.length;u+=1)s[u]=n[u].includes(o[l]);if(!s.includes(!0))return!1}return!0}},{key:"getSelectedMergedCellClassNameToRemove",value:function(){for(var r=[],n=0;n<=7;n+=1)r.push("".concat(this.fullySelectedMergedCellClassName,"-").concat(n));return r.push("".concat(this.fullySelectedMergedCellClassName,"-multiple")),r}}]),e}();const qVe=KVe;function XVe(e){return{key:"mergeCells",name:function(){var r=this.getSelectedLast();if(r){var n=e.mergedCellsCollection.get(r[0],r[1]);if(n.row===r[0]&&n.col===r[1]&&n.row+n.rowspan-1===r[2]&&n.col+n.colspan-1===r[3])return this.getTranslatedPhrase(vT)}return this.getTranslatedPhrase(dT)},callback:function(){e.toggleMergeOnSelection()},disabled:function(){var r=this.getSelectedLast();if(!r)return!0;var n=Mn.isSingleCell({row:r[0],col:r[1],rowspan:r[2]-r[0]+1,colspan:r[3]-r[1]+1});return n||this.selection.isSelectedByCorner()},hidden:!1}}function nf(e){"@babel/helpers - typeof";return nf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nf(e)}function ZVe(e,t){return e2e(e)||QVe(e,t)||Hz(e,t)||JVe()}function JVe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function QVe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function e2e(e){if(Array.isArray(e))return e}function t2e(e){return o2e(e)||n2e(e)||Hz(e)||r2e()}function r2e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Hz(e,t){if(e){if(typeof e=="string")return OR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return OR(e,t)}}function n2e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function o2e(e){if(Array.isArray(e))return OR(e)}function OR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function i2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,l2e(n.key),n)}}function a2e(e,t,r){return t&&UH(e.prototype,t),r&&UH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function l2e(e){var t=s2e(e,"string");return nf(t)==="symbol"?t:String(t)}function s2e(e,t){if(nf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ls(){return typeof Reflect<"u"&&Reflect.get?ls=Reflect.get.bind():ls=function(t,r,n){var o=u2e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ls.apply(this,arguments)}function u2e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Oi(e),e!==null););return e}function f2e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&RR(e,t)}function RR(e,t){return RR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},RR(e,t)}function c2e(e){var t=d2e();return function(){var n=Oi(e),o;if(t){var i=Oi(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return h2e(this,o)}}function h2e(e,t){if(t&&(nf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Lz(e)}function Lz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d2e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Oi(e){return Oi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Oi(e)}pe.getSingleton().register("beforeMergeCells");pe.getSingleton().register("afterMergeCells");pe.getSingleton().register("beforeUnmergeCells");pe.getSingleton().register("afterUnmergeCells");var pc="mergeCells",v2e=150,zH=new WeakMap,YH=pc,y2e=function(e){f2e(r,e);var t=c2e(r);function r(n){var o;return i2e(this,r),o=t.call(this,n),zH.set(Lz(o),{lastDesiredCoords:null}),o.mergedCellsCollection=null,o.autofillCalculations=null,o.selectionCalculations=null,o}return a2e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[pc]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.mergedCellsCollection=new MVe(this),this.autofillCalculations=new WVe(this),this.selectionCalculations=new qVe(this),this.addHook("afterInit",function(){return o.onAfterInit.apply(o,arguments)}),this.addHook("modifyTransformStart",function(){return o.onModifyTransformStart.apply(o,arguments)}),this.addHook("afterModifyTransformStart",function(){return o.onAfterModifyTransformStart.apply(o,arguments)}),this.addHook("modifyTransformEnd",function(){return o.onModifyTransformEnd.apply(o,arguments)}),this.addHook("modifyGetCellCoords",function(){return o.onModifyGetCellCoords.apply(o,arguments)}),this.addHook("beforeSetRangeStart",function(){return o.onBeforeSetRangeStart.apply(o,arguments)}),this.addHook("beforeSetRangeStartOnly",function(){return o.onBeforeSetRangeStart.apply(o,arguments)}),this.addHook("beforeSetRangeEnd",function(){return o.onBeforeSetRangeEnd.apply(o,arguments)}),this.addHook("afterIsMultipleSelection",function(){return o.onAfterIsMultipleSelection.apply(o,arguments)}),this.addHook("afterRenderer",function(){return o.onAfterRenderer.apply(o,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return o.addMergeActionsToContextMenu.apply(o,arguments)}),this.addHook("afterGetCellMeta",function(){return o.onAfterGetCellMeta.apply(o,arguments)}),this.addHook("afterViewportRowCalculatorOverride",function(){return o.onAfterViewportRowCalculatorOverride.apply(o,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return o.onAfterViewportColumnCalculatorOverride.apply(o,arguments)}),this.addHook("modifyAutofillRange",function(){return o.onModifyAutofillRange.apply(o,arguments)}),this.addHook("afterCreateCol",function(){return o.onAfterCreateCol.apply(o,arguments)}),this.addHook("afterRemoveCol",function(){return o.onAfterRemoveCol.apply(o,arguments)}),this.addHook("afterCreateRow",function(){return o.onAfterCreateRow.apply(o,arguments)}),this.addHook("afterRemoveRow",function(){return o.onAfterRemoveRow.apply(o,arguments)}),this.addHook("afterChange",function(){return o.onAfterChange.apply(o,arguments)}),this.addHook("beforeDrawBorders",function(){return o.onBeforeDrawAreaBorders.apply(o,arguments)}),this.addHook("afterDrawSelection",function(){return o.onAfterDrawSelection.apply(o,arguments)}),this.addHook("beforeRemoveCellClassNames",function(){return o.onBeforeRemoveCellClassNames.apply(o,arguments)}),this.addHook("beforeUndoStackChange",function(i,a){if(a==="MergeCells")return!1}),this.registerShortcuts(),ls(Oi(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),ls(Oi(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){var o=this.hot.getSettings()[pc];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(o),ls(Oi(r.prototype),"updatePlugin",this).call(this)}},{key:"ifChromeForceRepaint",value:function(){var o=this;if(z0()){var i=[],a=[];this.mergedCellsCollection.mergedCells.forEach(function(l){for(var s=l.row,u=l.rowspan,f=s+1;f<s+u;f++)a.push(f)}),a=t2e(new Set(a)),a.forEach(function(l){var s=o.hot.rowIndexMapper.getRenderableFromVisualIndex(l);o.hot.view._wt.wtOverlays.getOverlays(!0).map(function(u){return(u==null?void 0:u.name)==="master"?u:u.clone.wtTable}).forEach(function(u){var f=u.getRow(s);f&&(f.style.background=gs(f,"backgroundColor").replace(")",", 0.99)"),i.push(f))})}),this.hot._registerTimeout(function(){i.forEach(function(l){l.style.background=gs(l,"backgroundColor").replace(", 0.99)",")")})},1)}}},{key:"validateSetting",value:function(o){var i=!0;return o?(Mn.containsNegativeValues(o)?(ht(Mn.NEGATIVE_VALUES_WARNING(o)),i=!1):Mn.isOutOfBounds(o,this.hot.countRows(),this.hot.countCols())?(ht(Mn.IS_OUT_OF_BOUNDS_WARNING(o)),i=!1):Mn.isSingleCell(o)?(ht(Mn.IS_SINGLE_CELL(o)),i=!1):Mn.containsZeroSpan(o)&&(ht(Mn.ZERO_SPAN_WARNING(o)),i=!1),i):!1}},{key:"generateFromSettings",value:function(o){var i=this;if(Array.isArray(o)){var a=[];if($(o,function(l){if(i.validateSetting(l)){var s=i.hot._createCellCoords(l.row,l.col),u=i.hot._createCellCoords(l.row+l.rowspan-1,l.col+l.colspan-1),f=i.hot._createCellRange(s,s,u);i.mergeRange(f,!0,!0),_e(l.row,l.row+l.rowspan-1,function(c){_e(l.col,l.col+l.colspan-1,function(h){c===l.row&&h===l.col||a.push([c,h,null])})})}}),a.length===0)return;this.hot.setDataAtCell(a)}}},{key:"clearCollections",value:function(){this.mergedCellsCollection.clear()}},{key:"canMergeRange",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return i?!0:this.validateSetting(o)}},{key:"toggleMergeOnSelection",value:function(){var o=this.hot.getSelectedRangeLast();if(o){o.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var i=o.from,a=o.to;this.toggleMerge(o),this.hot.selectCell(i.row,i.col,a.row,a.col,!1)}}},{key:"mergeSelection",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(o){o.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var i=o.from,a=o.to;this.unmergeRange(o,!0),this.mergeRange(o),this.hot.selectCell(i.row,i.col,a.row,a.col,!1)}}},{key:"unmergeSelection",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(o){var i=o.from,a=o.to;this.unmergeRange(o,!0),this.hot.selectCell(i.row,i.col,a.row,a.col,!1)}}},{key:"mergeRange",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=o.getTopStartCorner(),u=o.getBottomEndCorner(),f={row:s.row,col:s.col,rowspan:u.row-s.row+1,colspan:u.col-s.col+1},c=[],h=null;if(!this.canMergeRange(f,a))return!1;this.hot.runHooks("beforeMergeCells",o,a),_e(0,f.rowspan-1,function(v){_e(0,f.colspan-1,function(g){var m=null;c[v]||(c[v]=[]),v===0&&g===0?m=i.hot.getSourceDataAtCell(i.hot.toPhysicalRow(f.row),i.hot.toPhysicalColumn(f.col)):i.hot.setCellMeta(f.row+v,f.col+g,"hidden",!0),c[v][g]=m})}),this.hot.setCellMeta(f.row,f.col,"spanned",!0);var d=this.mergedCellsCollection.add(f);return d?(l?h=[f.row,f.col,c]:this.hot.populateFromArray(f.row,f.col,c,void 0,void 0,this.pluginName),a||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",o,f,a),h):!0}},{key:"unmergeRange",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,l=this.mergedCellsCollection.getWithinRange(o);l&&(this.hot.runHooks("beforeUnmergeCells",o,a),$(l,function(s){i.mergedCellsCollection.remove(s.row,s.col),_e(0,s.rowspan-1,function(u){_e(0,s.colspan-1,function(f){i.hot.removeCellMeta(s.row+u,s.col+f,"hidden")})}),i.hot.removeCellMeta(s.row,s.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",o,a),this.hot.render())}},{key:"toggleMerge",value:function(o){var i=this.mergedCellsCollection.get(o.from.row,o.from.col),a=i.row===o.from.row&&i.col===o.from.col&&i.row+i.rowspan-1===o.to.row&&i.col+i.colspan-1===o.to.col;a?this.unmergeRange(o):this.mergeSelection(o)}},{key:"merge",value:function(o,i,a,l){var s=this.hot._createCellCoords(o,i),u=this.hot._createCellCoords(a,l);this.mergeRange(this.hot._createCellRange(s,s,u))}},{key:"unmerge",value:function(o,i,a,l){var s=this.hot._createCellCoords(o,i),u=this.hot._createCellCoords(a,l);this.unmergeRange(this.hot._createCellRange(s,s,u))}},{key:"onAfterInit",value:function(){this.generateFromSettings(this.hot.getSettings()[pc]),this.hot.render()}},{key:"registerShortcuts",value:function(){var o=this,i=this.hot.getShortcutManager(),a=i.getContext("grid");a.addShortcut({keys:[["Control","m"]],callback:function(){o.toggleMerge(o.hot.getSelectedRangeLast()),o.hot.render()},runOnlyIf:function(s){return!s.altKey},group:YH})}},{key:"unregisterShortcuts",value:function(){var o=this.hot.getShortcutManager(),i=o.getContext("grid");i.removeShortcutsByGroup(YH)}},{key:"onAfterIsMultipleSelection",value:function(o){if(o){for(var i=this.mergedCellsCollection.mergedCells,a=this.hot.getSelectedRangeLast(),l=0;l<i.length;l+=1)if(a.from.row===i[l].row&&a.from.col===i[l].col&&a.to.row===i[l].row+i[l].rowspan-1&&a.to.col===i[l].col+i[l].colspan-1)return!1}return o}},{key:"onModifyTransformStart",value:function(o){var i=zH.get(this),a=this.hot.getSelectedRangeLast(),l={row:o.row,col:o.col},s=null,u=this.hot._createCellCoords(a.highlight.row,a.highlight.col),f=this.mergedCellsCollection.get(u.row,u.col);if(i.lastDesiredCoords||(i.lastDesiredCoords=this.hot._createCellCoords(null,null)),f){var c=this.hot._createCellCoords(f.row,f.col),h=this.hot._createCellCoords(f.row+f.rowspan-1,f.col+f.colspan-1),d=this.hot._createCellRange(c,c,h);d.includes(i.lastDesiredCoords)||(i.lastDesiredCoords=this.hot._createCellCoords(null,null)),l.row=i.lastDesiredCoords.row?i.lastDesiredCoords.row-u.row:l.row,l.col=i.lastDesiredCoords.col?i.lastDesiredCoords.col-u.col:l.col,o.row>0?l.row=f.row+f.rowspan-1-u.row+o.row:o.row<0&&(l.row=u.row-f.row+o.row),o.col>0?l.col=f.col+f.colspan-1-u.col+o.col:o.col<0&&(l.col=u.col-f.col+o.col)}s=this.hot._createCellCoords(a.highlight.row+l.row,a.highlight.col+l.col);var v=this.mergedCellsCollection.get(s.row,s.col);if(v){var g=this.mergedCellsCollection.getFirstRenderableCoords(v.row,v.col);i.lastDesiredCoords=s,l={row:g.row-u.row,col:g.col-u.col}}l.row!==0&&(o.row=l.row),l.col!==0&&(o.col=l.col)}},{key:"onModifyTransformEnd",value:function(o){var i=this,a=this.hot.getSelectedRangeLast(),l=pr(o),s=this.selectionCalculations.getUpdatedSelectionRange(a,o),u=pr(l),f=this.mergedCellsCollection.getWithinRange(s,!0);do u=pr(l),this.selectionCalculations.getUpdatedSelectionRange(a,l),$(f,function(c){i.selectionCalculations.snapDelta(l,a,c)});while(l.row!==u.row||l.col!==u.col);o.row=l.row,o.col=l.col}},{key:"onModifyGetCellCoords",value:function(o,i){if(!(o<0||i<0)){var a=this.mergedCellsCollection.get(o,i);if(a){var l=a.row,s=a.col,u=a.colspan,f=a.rowspan;return[l,s,l+f-1,s+u-1]}}}},{key:"addMergeActionsToContextMenu",value:function(o){o.items.push({name:"---------"},XVe(this))}},{key:"onAfterRenderer",value:function(o,i,a){var l=this.mergedCellsCollection.get(i,a),s=Ve(l)?pr(l):void 0;if(Ve(s)){var u=this.hot,f=u.rowIndexMapper,c=u.columnIndexMapper,h=s.row,d=s.col,v=s.colspan,g=s.rowspan,m=this.translateMergedCellToRenderable(h,g,d,v),w=ZVe(m,2),S=w[0],C=w[1],k=f.getRenderableFromVisualIndex(i),R=c.getRenderableFromVisualIndex(a),V=S-k+1,U=C-R+1;s.row=f.getNearestNotHiddenIndex(s.row,1),s.col=c.getNearestNotHiddenIndex(s.col,1),s.rowspan=Math.min(s.rowspan,V),s.colspan=Math.min(s.colspan,U)}CR(o,s,i,a)}},{key:"onBeforeSetRangeStart",value:function(o){if(this.mergedCellsCollection.isFirstRenderableMergedCell(o.row,o.col)){var i=this.mergedCellsCollection.get(o.row,o.col),a=[i.row,i.col];o.row=a[0],o.col=a[1]}}},{key:"onBeforeSetRangeEnd",value:function(o){var i=this.hot.getSelectedRangeLast();i.highlight=this.hot._createCellCoords(i.highlight.row,i.highlight.col),i.to=o;var a=!1;if(!(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()))do{a=!1;for(var l=0;l<this.mergedCellsCollection.mergedCells.length;l+=1){var s=this.mergedCellsCollection.mergedCells[l],u=s.getRange();i.expandByRange(u)&&(o.row=i.to.row,o.col=i.to.col,a=!0)}}while(a)}},{key:"onAfterGetCellMeta",value:function(o,i,a){var l=this.mergedCellsCollection.get(o,i);l&&(l.row!==o||l.col!==i?a.copyable=!1:(a.rowspan=l.rowspan,a.colspan=l.colspan))}},{key:"onAfterViewportRowCalculatorOverride",value:function(o){var i=this.hot.countCols();this.modifyViewportRowStart(o,i),this.modifyViewportRowEnd(o,i)}},{key:"modifyViewportRowStart",value:function(o,i){for(var a=this.hot.rowIndexMapper,l=a.getVisualFromRenderableIndex(o.startRow),s=0;s<i;s+=1){var u=this.mergedCellsCollection.get(l,s);if(Ve(u)){var f=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(u.row,1));if(f<o.startRow){o.startRow=f,this.modifyViewportRowStart(o,i);return}}}}},{key:"modifyViewportRowEnd",value:function(o,i){for(var a=this.hot.rowIndexMapper,l=a.getVisualFromRenderableIndex(o.endRow),s=0;s<i;s+=1){var u=this.mergedCellsCollection.get(l,s);if(Ve(u)){var f=u.row+u.rowspan-1,c=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(f,-1));if(c>o.endRow){o.endRow=c,this.modifyViewportRowEnd(o,i);return}}}}},{key:"onAfterViewportColumnCalculatorOverride",value:function(o){var i=this.hot.countRows();this.modifyViewportColumnStart(o,i),this.modifyViewportColumnEnd(o,i)}},{key:"modifyViewportColumnStart",value:function(o,i){for(var a=this.hot.columnIndexMapper,l=a.getVisualFromRenderableIndex(o.startColumn),s=0;s<i;s+=1){var u=this.mergedCellsCollection.get(s,l);if(Ve(u)){var f=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(u.col,1));if(f<o.startColumn){o.startColumn=f,this.modifyViewportColumnStart(o,i);return}}}}},{key:"modifyViewportColumnEnd",value:function(o,i){for(var a=this.hot.columnIndexMapper,l=a.getVisualFromRenderableIndex(o.endColumn),s=0;s<i;s+=1){var u=this.mergedCellsCollection.get(s,l);if(Ve(u)){var f=u.col+u.colspan-1,c=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(f,-1));if(c>o.endColumn){o.endColumn=c,this.modifyViewportColumnEnd(o,i);return}}}}},{key:"translateMergedCellToRenderable",value:function(o,i,a,l){var s=this.hot,u=s.rowIndexMapper,f=s.columnIndexMapper,c,h;i===0?c=u.getNearestNotHiddenIndex(o,1):c=u.getNearestNotHiddenIndex(o+i-1,-1),l===0?h=f.getNearestNotHiddenIndex(a,1):h=f.getNearestNotHiddenIndex(a+l-1,-1);var d=o>=0?u.getRenderableFromVisualIndex(c):o,v=a>=0?f.getRenderableFromVisualIndex(h):a;return[d,v]}},{key:"onModifyAutofillRange",value:function(o,i){this.autofillCalculations.correctSelectionAreaSize(i);var a=this.autofillCalculations.getDirection(i,o),l=o;if(this.autofillCalculations.dragAreaOverlapsCollections(i,l,a))return l=i,l;var s=this.mergedCellsCollection.getWithinRange({from:{row:i[0],col:i[1]},to:{row:i[2],col:i[3]}});return s&&(l=this.autofillCalculations.snapDragArea(i,l,a,s)),l}},{key:"onAfterCreateCol",value:function(o,i){this.mergedCellsCollection.shiftCollections("right",o,i)}},{key:"onAfterRemoveCol",value:function(o,i){this.mergedCellsCollection.shiftCollections("left",o,i)}},{key:"onAfterCreateRow",value:function(o,i,a){a!=="auto"&&this.mergedCellsCollection.shiftCollections("down",o,i)}},{key:"onAfterRemoveRow",value:function(o,i){this.mergedCellsCollection.shiftCollections("up",o,i)}},{key:"onAfterChange",value:function(o,i){i==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(o)}},{key:"onBeforeDrawAreaBorders",value:function(o,i){if(i&&i==="area"){var a=this.hot.getSelectedRangeLast(),l=this.mergedCellsCollection.getWithinRange(a);$(l,function(s){a.getBottomEndCorner().row===s.getLastRow()&&a.getBottomEndCorner().col===s.getLastColumn()&&(o[2]=s.row,o[3]=s.col)})}}},{key:"onAfterModifyTransformStart",value:function(o,i,a){if(this.enabled){var l=this.mergedCellsCollection.get(o.row,o.col);if(l){var s=i>0,u=i<0,f=a<0,c=a>0,h=l.row+l.rowspan-1===this.hot.countRows()-1,d=l.row===0,v=l.col+l.colspan-1===this.hot.countCols()-1,g=l.col===0;(s&&h||u&&d||c&&v||f&&g)&&(o.row=l.row,o.col=l.col)}}}},{key:"onAfterDrawSelection",value:function(o,i,a,l){if(a)return this.selectionCalculations.getSelectedMergedCellClassName(o,i,a,l)}},{key:"onBeforeRemoveCellClassNames",value:function(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}],[{key:"PLUGIN_KEY",get:function(){return pc}},{key:"PLUGIN_PRIORITY",get:function(){return v2e}}]),r}(ot);function GH(e){return b2e(e)||m2e(e)||p2e(e)||g2e()}function g2e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function p2e(e,t){if(e){if(typeof e=="string")return KH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return KH(e,t)}}function KH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function m2e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function b2e(e){if(Array.isArray(e))return e}function w2e(e,t){return function(r,n){var o=GH(r),i=o.slice(1),a=GH(n),l=a.slice(1);return function s(u){var f=e[u],c=t[u],h=i[u],d=l[u],v=c.multiColumnSorting,g=v.compareFunctionFactory?v.compareFunctionFactory:wU(c.type),m=g(f,c,v)(h,d);if(m===Hn){var w=u+1;if(typeof t[w]<"u")return s(w)}return m}(0)}}var qH;function S2e(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function XH(){ht(ft(qH||(qH=S2e(["Plugins `columnSorting` and `multiColumnSorting` should not be enabled simultaneously. \n    Only `multiColumnSorting` will work."],["Plugins \\`columnSorting\\` and \\`multiColumnSorting\\` should not be enabled simultaneously. \n    Only \\`multiColumnSorting\\` will work."]))))}var jz="sort";function C2e(e,t,r){var n=[];return r===!1||e.isColumnSorted(t)&&e.getNumberOfSortedColumns()>1&&n.push("".concat(jz,"-").concat(e.getIndexOfColumnInSortQueue(t)+1)),n}function _2e(e){var t=e.className.split(" "),r=new RegExp("^".concat(jz,"-[0-9]{1,2}$"));return t.filter(function(n){return r.test(n)})}function of(e){"@babel/helpers - typeof";return of=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},of(e)}function O2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,E2e(n.key),n)}}function R2e(e,t,r){return t&&ZH(e.prototype,t),r&&ZH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function E2e(e){var t=T2e(e,"string");return of(t)==="symbol"?t:String(t)}function T2e(e,t){if(of(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(of(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Dr(){return typeof Reflect<"u"&&Reflect.get?Dr=Reflect.get.bind():Dr=function(t,r,n){var o=k2e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Dr.apply(this,arguments)}function k2e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=yr(e),e!==null););return e}function P2e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ER(e,t)}function ER(e,t){return ER=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},ER(e,t)}function $2e(e){var t=M2e();return function(){var n=yr(e),o;if(t){var i=yr(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return A2e(this,o)}}function A2e(e,t){if(t&&(of(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return I2e(e)}function I2e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function M2e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yr(e){return yr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yr(e)}var TR="multiColumnSorting",x2e=170,D2e="append",JH="columnSorting";bU(TR,w2e);var N2e=function(e){P2e(r,e);var t=$2e(r);function r(n){var o;return O2e(this,r),o=t.call(this,n),o.pluginKey=TR,o}return R2e(r,[{key:"isEnabled",value:function(){return Dr(yr(r.prototype),"isEnabled",this).call(this)}},{key:"enablePlugin",value:function(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[JH]&&XH(),Dr(yr(r.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Dr(yr(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(o){Dr(yr(r.prototype),"sort",this).call(this,o)}},{key:"clearSort",value:function(){Dr(yr(r.prototype),"clearSort",this).call(this)}},{key:"isSorted",value:function(){return Dr(yr(r.prototype),"isSorted",this).call(this)}},{key:"getSortConfig",value:function(o){return Dr(yr(r.prototype),"getSortConfig",this).call(this,o)}},{key:"setSortConfig",value:function(o){Dr(yr(r.prototype),"setSortConfig",this).call(this,o)}},{key:"getNormalizedSortConfigs",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(o)?o:[o]}},{key:"updateHeaderClasses",value:function(o){for(var i,a=arguments.length,l=new Array(a>1?a-1:0),s=1;s<a;s++)l[s-1]=arguments[s];(i=Dr(yr(r.prototype),"updateHeaderClasses",this)).call.apply(i,[this,o].concat(l)),Le(o,_2e(o)),this.enabled!==!1&&re(o,C2e.apply(void 0,l))}},{key:"onUpdateSettings",value:function(o){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[JH]&&XH(),Dr(yr(r.prototype),"onUpdateSettings",this).call(this,o)}},{key:"onAfterOnCellMouseDown",value:function(o,i){_O(i.row,i.col,o)!==!1&&this.wasClickableHeaderClicked(o,i.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(i.col),this.sort(this.getNextSortConfig(i.col,D2e))):this.sort(this.getColumnNextConfig(i.col)))}}],[{key:"PLUGIN_KEY",get:function(){return TR}},{key:"PLUGIN_PRIORITY",get:function(){return x2e}}]),r}(CU);function af(e){"@babel/helpers - typeof";return af=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},af(e)}function H2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,j2e(n.key),n)}}function L2e(e,t,r){return t&&QH(e.prototype,t),r&&QH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function j2e(e){var t=F2e(e,"string");return af(t)==="symbol"?t:String(t)}function F2e(e,t){if(af(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(af(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ig(){return typeof Reflect<"u"&&Reflect.get?Ig=Reflect.get.bind():Ig=function(t,r,n){var o=B2e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ig.apply(this,arguments)}function B2e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=lf(e),e!==null););return e}function V2e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kR(e,t)}function kR(e,t){return kR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},kR(e,t)}function W2e(e){var t=Y2e();return function(){var n=lf(e),o;if(t){var i=lf(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return U2e(this,o)}}function U2e(e,t){if(t&&(af(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return z2e(e)}function z2e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Y2e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function lf(e){return lf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},lf(e)}var G2e="multipleSelectionHandles",K2e=160,q2e=function(e){V2e(r,e);var t=W2e(r);function r(n){var o;return H2e(this,r),o=t.call(this,n),o.dragged=[],o.eventManager=null,o.lastSetCell=null,o}return L2e(r,[{key:"isEnabled",value:function(){return cn()}},{key:"enablePlugin",value:function(){this.enabled||(this.eventManager||(this.eventManager=new Tt(this)),this.registerListeners(),Ig(lf(r.prototype),"enablePlugin",this).call(this))}},{key:"registerListeners",value:function(){var o=this,i=this,a=this.hot.rootElement;function l(s){if(i.dragged.length===1)return i.dragged.splice(0,i.dragged.length),!0;var u=i.dragged.indexOf(s);if(u===-1)return!1;u===0?i.dragged=i.dragged.slice(0,1):u===1&&(i.dragged=i.dragged.slice(-1))}this.eventManager.addEventListener(a,"touchstart",function(s){var u;if(xe(s.target,"topSelectionHandle-HitArea"))return u=i.hot.getSelectedRangeLast(),i.dragged.push("top"),i.touchStartRange={width:u.getWidth(),height:u.getHeight(),direction:u.getDirection()},s.preventDefault(),!1;if(xe(s.target,"bottomSelectionHandle-HitArea"))return u=i.hot.getSelectedRangeLast(),i.dragged.push("bottom"),i.touchStartRange={width:u.getWidth(),height:u.getHeight(),direction:u.getDirection()},s.preventDefault(),!1}),this.eventManager.addEventListener(a,"touchend",function(s){if(xe(s.target,"topSelectionHandle-HitArea"))return l.call(i,"top"),i.touchStartRange=void 0,s.preventDefault(),!1;if(xe(s.target,"bottomSelectionHandle-HitArea"))return l.call(i,"bottom"),i.touchStartRange=void 0,s.preventDefault(),!1}),this.eventManager.addEventListener(a,"touchmove",function(s){var u=o.hot.rootDocument,f,c,h,d,v,g;if(i.dragged.length!==0){var m=u.elementFromPoint(s.touches[0].clientX,s.touches[0].clientY);!m||m===i.lastSetCell||((m.nodeName==="TD"||m.nodeName==="TH")&&(f=i.hot.getCoords(m),f.col===-1&&(f.col=0),c=i.hot.getSelectedRangeLast(),h=c.getWidth(),d=c.getHeight(),v=c.getDirection(),h===1&&d===1&&i.hot.selection.setRangeEnd(f),g=i.getCurrentRangeCoords(c,f,i.touchStartRange.direction,v,i.dragged[0]),g.start!==null&&i.hot.selection.setRangeStart(g.start),i.hot.selection.setRangeEnd(g.end),i.lastSetCell=m),s.preventDefault())}})}},{key:"getCurrentRangeCoords",value:function(o,i,a,l,s){var u=o.getTopStartCorner(),f=o.getBottomEndCorner(),c=o.getBottomStartCorner(),h=o.getTopEndCorner(),d={start:null,end:null};switch(a){case"NE-SW":switch(l){case"NE-SW":case"NW-SE":s==="top"?d={start:this.hot._createCellCoords(i.row,o.highlight.col),end:this.hot._createCellCoords(c.row,i.col)}:d={start:this.hot._createCellCoords(o.highlight.row,i.col),end:this.hot._createCellCoords(i.row,u.col)};break;case"SE-NW":s==="bottom"&&(d={start:this.hot._createCellCoords(f.row,i.col),end:this.hot._createCellCoords(i.row,u.col)});break}break;case"NW-SE":switch(l){case"NE-SW":s==="top"?d={start:i,end:c}:d.end=i;break;case"NW-SE":s==="top"?d={start:i,end:f}:d.end=i;break;case"SE-NW":s==="top"?d={start:i,end:u}:d.end=i;break;case"SW-NE":s==="top"?d={start:i,end:h}:d.end=i;break}break;case"SW-NE":switch(l){case"NW-SE":s==="bottom"?d={start:this.hot._createCellCoords(i.row,u.col),end:this.hot._createCellCoords(c.row,i.col)}:d={start:this.hot._createCellCoords(u.row,i.col),end:this.hot._createCellCoords(i.row,f.col)};break;case"SW-NE":s==="top"?d={start:this.hot._createCellCoords(o.highlight.row,i.col),end:this.hot._createCellCoords(i.row,f.col)}:d={start:this.hot._createCellCoords(i.row,u.col),end:this.hot._createCellCoords(u.row,i.col)};break;case"SE-NW":s==="bottom"?d={start:this.hot._createCellCoords(i.row,h.col),end:this.hot._createCellCoords(u.row,i.col)}:s==="top"&&(d={start:c,end:i});break}break;case"SE-NW":switch(l){case"NW-SE":case"NE-SW":case"SW-NE":s==="top"&&(d.end=i);break;case"SE-NW":s==="top"?d.end=i:d={start:i,end:u};break}break}return d}},{key:"isDragged",value:function(){return this.dragged.length>0}}],[{key:"PLUGIN_KEY",get:function(){return G2e}},{key:"PLUGIN_PRIORITY",get:function(){return K2e}}]),r}(ot);function PR(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.label,r=t===void 0?"":t,n=e.colspan,o=n===void 0?1:n,i=e.origColspan,a=i===void 0?1:i,l=e.collapsible,s=l===void 0?!1:l,u=e.crossHiddenColumns,f=u===void 0?[]:u,c=e.isCollapsed,h=c===void 0?!1:c,d=e.isHidden,v=d===void 0?!1:d,g=e.isRoot,m=g===void 0?!1:g,w=e.isPlaceholder,S=w===void 0?!1:w;return{label:r,colspan:o,origColspan:a,collapsible:s,isCollapsed:h,crossHiddenColumns:f,isHidden:v,isRoot:m,isPlaceholder:S}}function Fz(){return{label:"",isPlaceholder:!0}}function eL(e){return Q2e(e)||J2e(e)||Z2e(e)||X2e()}function X2e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Z2e(e,t){if(e){if(typeof e=="string")return $R(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $R(e,t)}}function J2e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Q2e(e){if(Array.isArray(e))return $R(e)}function $R(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function eWe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,r=[];if(t===0)return r;$(e,function(o){var i=[],a=0;r.push(i),$(o,function(l){var s=PR();if(Ve(l)){var u=l.label,f=l.colspan;s.label=It(u),typeof f=="number"&&f>1&&(s.colspan=f,s.origColspan=f)}else s.label=It(l);a+=s.origColspan;var c=!1;if(a>=t&&(s.colspan=s.origColspan-(a-t),s.origColspan=s.colspan,c=!0),i.push(s),s.colspan>1)for(var h=0;h<s.colspan-1;h++)i.push(Fz());return!c})});var n=Math.max.apply(Math,eL(Be(r,function(o){return o.length})));return $(r,function(o){if(o.length<n){var i=Be(new Array(n-o.length),function(){return PR()});o.splice.apply(o,[o.length,0].concat(eL(i)))}}),r}function xd(e){"@babel/helpers - typeof";return xd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xd(e)}var tWe=["row","col"];function tL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function rWe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tL(Object(r),!0).forEach(function(n){nWe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nWe(e,t,r){return t=Bz(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oWe(e,t){if(e==null)return{};var r=iWe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function iWe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function aWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Bz(n.key),n)}}function lWe(e,t,r){return t&&rL(e.prototype,t),r&&rL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Bz(e){var t=sWe(e,"string");return xd(t)==="symbol"?t:String(t)}function sWe(e,t){if(xd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function HS(e,t,r){uWe(e,t),t.set(e,r)}function uWe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nn(e,t){var r=Vz(e,t,"get");return fWe(e,r)}function fWe(e,t){return t.get?t.get.call(e):t.value}function sc(e,t,r){var n=Vz(e,t,"set");return cWe(e,n,r),r}function Vz(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function cWe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var nL=["label","collapsible"],Jn=new WeakMap,Ji=new WeakMap,LS=new WeakMap,hWe=function(){function e(){aWe(this,e),HS(this,Jn,{writable:!0,value:[]}),HS(this,Ji,{writable:!0,value:0}),HS(this,LS,{writable:!0,value:1/0})}return lWe(e,[{key:"setColumnsLimit",value:function(r){sc(this,LS,r)}},{key:"setData",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];sc(this,Jn,eWe(r,nn(this,LS))),sc(this,Ji,nn(this,Jn).length)}},{key:"getData",value:function(){return nn(this,Jn)}},{key:"mergeWith",value:function(r){var n=this;$(r,function(o){var i=o.row,a=o.col,l=oWe(o,tWe),s=n.getHeaderSettings(i,a);s!==null&&Wt(s,l,nL)})}},{key:"map",value:function(r){$(nn(this,Jn),function(n){$(n,function(o){var i=r(rWe({},o));Ve(i)&&Wt(o,i,nL)})})}},{key:"getHeaderSettings",value:function(r,n){var o;if(r>=nn(this,Ji)||r<0)return null;var i=nn(this,Jn)[r];return n>=i.length?null:(o=i[n])!==null&&o!==void 0?o:null}},{key:"getHeadersSettings",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,i=[];if(r>=nn(this,Ji)||r<0)return i;for(var a=nn(this,Jn)[r],l=0,s=n;s<a.length;s++){var u=a[s];if(u.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(l+=u.colspan,i.push(u),u.colspan>1&&(s+=u.colspan-1),l===o)break;if(l>o)throw new Error("The last column settings cannot overlap the other header layers")}return i}},{key:"getLayersCount",value:function(){return nn(this,Ji)}},{key:"getColumnsCount",value:function(){return nn(this,Ji)>0?nn(this,Jn)[0].length:0}},{key:"clear",value:function(){sc(this,Jn,[]),sc(this,Ji,0)}}]),e}();function Dd(e){"@babel/helpers - typeof";return Dd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dd(e)}function oL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function iL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?oL(Object(r),!0).forEach(function(n){Mg(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Wz(n.key),n)}}function vWe(e,t,r){return t&&aL(e.prototype,t),r&&aL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Mg(e,t,r){return t=Wz(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Wz(e){var t=yWe(e,"string");return Dd(t)==="symbol"?t:String(t)}function yWe(e,t){if(Dd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Dd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gWe(e){return wWe(e)||bWe(e)||mWe(e)||pWe()}function pWe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mWe(e,t){if(e){if(typeof e=="string")return AR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return AR(e,t)}}function bWe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function wWe(e){if(Array.isArray(e))return AR(e)}function AR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var SWe="DF-pre-order";function Uz(e,t){for(var r=e.call(t,this),n=0;n<this.childs.length;n++){if(r===!1)return!1;r=Uz.call(this.childs[n],e,t)}return r}var CWe="DF-post-order";function zz(e,t){for(var r=0;r<this.childs.length;r++){var n=zz.call(this.childs[r],e,t);if(n===!1)return!1}return e.call(t,this)}var Yz="BF";function _We(e,t){var r=[this];function n(){if(r.length!==0){var o=r.shift();r.push.apply(r,gWe(o.childs)),e.call(t,o)!==!1&&n()}}n()}var OWe=Yz,lL=new Map([[SWe,Uz],[CWe,zz],[Yz,_We]]),sL=function(){function e(t){dWe(this,e),Mg(this,"data",{}),Mg(this,"parent",null),Mg(this,"childs",[]),this.data=t}return vWe(e,[{key:"addChild",value:function(r){r.parent=this,this.childs.push(r)}},{key:"cloneTree",value:function(){for(var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this,n=new e(iL({},r.data)),o=0;o<r.childs.length;o++)n.addChild(this.cloneTree(r.childs[o]));return n}},{key:"replaceTreeWith",value:function(r){this.data=iL({},r.data),this.childs=[];for(var n=0;n<r.childs.length;n++)this.addChild(r.childs[n])}},{key:"walkDown",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:OWe;if(!lL.has(n))throw new Error('Traversal strategy "'.concat(n,'" does not exist'));lL.get(n).call(this,r,this)}},{key:"walkUp",value:function(r){var n=this,o=function i(a){var l=r.call(n,a);l!==!1&&a.parent!==null&&i(a.parent)};o(this)}}]),e}();function Nd(e){"@babel/helpers - typeof";return Nd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nd(e)}function uL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function fL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?uL(Object(r),!0).forEach(function(n){RWe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):uL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function RWe(e,t,r){return t=Gz(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function EWe(e,t){return $We(e)||PWe(e,t)||kWe(e,t)||TWe()}function TWe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kWe(e,t){if(e){if(typeof e=="string")return cL(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return cL(e,t)}}function cL(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function PWe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function $We(e){if(Array.isArray(e))return e}function AWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Gz(n.key),n)}}function IWe(e,t,r){return t&&hL(e.prototype,t),r&&hL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Gz(e){var t=MWe(e,"string");return Nd(t)==="symbol"?t:String(t)}function MWe(e,t){if(Nd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Nd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jS(e,t,r){xWe(e,t),t.set(e,r)}function xWe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hr(e,t){var r=Kz(e,t,"get");return DWe(e,r)}function DWe(e,t){return t.get?t.get.call(e):t.value}function NWe(e,t,r){var n=Kz(e,t,"set");return HWe(e,n,r),r}function Kz(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function HWe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Hl=new WeakMap,Qi=new WeakMap,Ll=new WeakMap,LWe=function(){function e(t){AWe(this,e),jS(this,Hl,{writable:!0,value:new Map}),jS(this,Qi,{writable:!0,value:new Map}),jS(this,Ll,{writable:!0,value:null}),NWe(this,Ll,t)}return IWe(e,[{key:"getRoots",value:function(){return Array.from(hr(this,Hl).values())}},{key:"getRootByColumn",value:function(r){var n;return hr(this,Qi).has(r)&&(n=hr(this,Hl).get(hr(this,Qi).get(r))),n}},{key:"getNode",value:function(r,n){var o=this.getRootByColumn(n);if(o){var i=n-hr(this,Qi).get(n),a=0,l;return o.walkDown(function(s){var u=s.data,f=u.origColspan,c=u.headerLevel;if(r===c){if(i>=a&&i<=a+f-1)return l=s,l.data.isRoot=n===l.data.columnIndex,!1;a+=f}}),l}}},{key:"rebuildTreeIndex",value:function(){var r=this,n=0;hr(this,Qi).clear(),$(hr(this,Hl),function(o){for(var i=EWe(o,2),a=i[1].data.colspan,l=n;l<n+a;l++)hr(r,Qi).set(l,n);n+=a})}},{key:"buildTree",value:function(){this.clear();for(var r=hr(this,Ll).getColumnsCount(),n=0;n<r;){var o=hr(this,Ll).getHeaderSettings(0,n),i=new sL;hr(this,Hl).set(n,i),this.buildLeaves(i,n,0,o.origColspan),n+=o.origColspan}this.rebuildTreeIndex()}},{key:"buildLeaves",value:function(r,n,o){var i=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,l=hr(this,Ll).getHeadersSettings(o,n,a);o+=1,$(l,function(s){var u=fL(fL({},s),{},{headerLevel:o-1,columnIndex:n}),f;o===1?(r.data=u,f=r):(f=new sL(u),r.addChild(f)),o<hr(i,Ll).getLayersCount()&&i.buildLeaves(f,n,o,s.origColspan),n+=s.origColspan})}},{key:"clear",value:function(){hr(this,Hl).clear(),hr(this,Qi).clear()}}]),e}();function qz(e,t){e.walkDown(function(r){var n=r.data,o=r.childs;if(!n.isHidden&&(t(n.columnIndex),o.length===0))for(var i=1;i<n.colspan;i++)t(n.columnIndex+i)})}function Up(e,t){var r=e.childs;if(r.length!==0)return r[0].data[t]}function zp(e){return Up(e,"origColspan")===e.data.origColspan}function Wk(e){var t=e.data,r=e.childs;if(!t.isCollapsed||t.isHidden||t.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var n=zp(e);if(n)return Wk(r[0]);t.isCollapsed=!1;var o=r.slice(1),i=new Set,a=0;if(o.length>0)$(o,function(c){c.replaceTreeWith(c.data.clonedTree),c.data.clonedTree=null;var h=c.data;a+=h.colspan,qz(c,function(d){i.add(d)})});else{var l=t.colspan,s=t.origColspan,u=t.columnIndex;a=s-l;for(var f=1;f<s;f++)i.add(u+f)}return e.walkUp(function(c){var h=c.data;h.colspan+=a,h.colspan>=h.origColspan?(h.colspan=h.origColspan,h.isCollapsed=!1):zp(c)&&(h.isCollapsed=Up(c,"isCollapsed"))}),{rollbackModification:function(){return Uk(e)},affectedColumns:Array.from(i),colspanCompensation:a}}function Uk(e){var t,r=e.data,n=e.childs;if(r.isCollapsed||r.isHidden||r.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var o=zp(e);if(o)return Uk(n[0]);r.isCollapsed=!0;var i=n.slice(1),a=new Set;if(i.length>0)$(i,function(h){qz(h,function(d){a.add(d)}),h.data.clonedTree=h.cloneTree(),h.walkDown(function(d){var v=d.data;v.isHidden=!0})});else for(var l=r.origColspan,s=r.columnIndex,u=1;u<l;u++){var f=s+u;a.add(f)}var c=r.colspan-((t=Up(e,"colspan"))!==null&&t!==void 0?t:1);return e.walkUp(function(h){var d=h.data;d.colspan-=c,d.colspan<=1?(d.colspan=1,d.isCollapsed=!0):zp(h)&&(d.isCollapsed=Up(h,"isCollapsed"))}),{rollbackModification:function(){return Wk(e)},affectedColumns:Array.from(a),colspanCompensation:c}}var dL;function jWe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function FWe(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(ft(dL||(dL=jWe([`The passed node is not the last node on the tree. Only for 
the last node, the hide column modification can be applied.`],[`The passed node is not the last node on the tree. Only for\\x20
the last node, the hide column modification can be applied.`]))));var r=e.data.crossHiddenColumns;if(!r.includes(t)){var n=!1;e.walkUp(function(o){var i=o.data.collapsible;if(i)return n=!0,!1}),!n&&e.walkUp(function(o){var i=o.data;i.crossHiddenColumns.push(t),i.colspan>1?i.colspan-=1:i.isHidden=!0})}}var vL;function BWe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function VWe(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(ft(vL||(vL=BWe([`The passed node is not the last node on the tree. Only for 
the last node, the show column modification can be applied.`],[`The passed node is not the last node on the tree. Only for\\x20
the last node, the show column modification can be applied.`]))));var r=e.data.crossHiddenColumns;if(r.includes(t)){var n=!1;e.walkUp(function(o){var i=o.data.collapsible;if(i)return n=!0,!1}),!n&&e.walkUp(function(o){var i=o.data;i.crossHiddenColumns.splice(i.crossHiddenColumns.indexOf(t),1),!i.isHidden&&i.colspan<i.origColspan&&(i.colspan+=1),i.isHidden=!1})}}var yL=new Map([["collapse",Uk],["expand",Wk],["hide-column",FWe],["show-column",VWe]]);function WWe(e,t,r){if(!yL.has(e))throw new Error('The node modifier action ("'.concat(e,'") does not exist.'));return yL.get(e)(t,r)}var UWe=["crossHiddenColumns"];function zWe(e,t){if(e==null)return{};var r=YWe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function YWe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function Wy(e){var t=[];return $(e,function(r){r.walkDown(function(n){for(var o=n.data,i=o.origColspan,a=o.columnIndex,l=o.headerLevel,s=o.crossHiddenColumns,u=KWe(t,l),f=!1,c=a;c<a+i;c++){var h=s.includes(c);if(h||f)u.push(Fz());else{var d=GWe(o);d.isRoot=!0,u.push(d),f=!0}}})}),t}function GWe(e){var t=PR(e);t.crossHiddenColumns;var r=zWe(t,UWe);return r}function KWe(e,t){var r;return Array.isArray(e[t])?r=e[t]:(r=[],e[t]=r),r}function Hd(e){"@babel/helpers - typeof";return Hd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hd(e)}var qWe=["row"];function gL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function pL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gL(Object(r),!0).forEach(function(n){XWe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function XWe(e,t,r){return t=Xz(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ZWe(e,t){if(e==null)return{};var r=JWe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function JWe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function QWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Xz(n.key),n)}}function eUe(e,t,r){return t&&mL(e.prototype,t),r&&mL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Xz(e){var t=tUe(e,"string");return Hd(t)==="symbol"?t:String(t)}function tUe(e,t){if(Hd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function FS(e,t,r){rUe(e,t),t.set(e,r)}function rUe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function uc(e,t,r){var n=Zz(e,t,"set");return nUe(e,n,r),r}function nUe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function Dt(e,t){var r=Zz(e,t,"get");return oUe(e,r)}function Zz(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function oUe(e,t){return t.get?t.get.call(e):t.value}var $n=new WeakMap,xr=new WeakMap,ea=new WeakMap,iUe=function(){function e(){QWe(this,e),FS(this,$n,{writable:!0,value:new hWe}),FS(this,xr,{writable:!0,value:new LWe(Dt(this,$n))}),FS(this,ea,{writable:!0,value:[[]]})}return eUe(e,[{key:"setState",value:function(r){Dt(this,$n).setData(r);var n=!1;try{Dt(this,xr).buildTree()}catch{Dt(this,xr).clear(),Dt(this,$n).clear(),n=!0}return uc(this,ea,Wy(Dt(this,xr).getRoots())),n}},{key:"setColumnsLimit",value:function(r){Dt(this,$n).setColumnsLimit(r)}},{key:"mergeStateWith",value:function(r){var n=this,o=Be(r,function(i){var a=i.row,l=ZWe(i,qWe);return pL({row:a<0?n.rowCoordsToLevel(a):a},l)});Dt(this,$n).mergeWith(o),Dt(this,xr).buildTree(),uc(this,ea,Wy(Dt(this,xr).getRoots()))}},{key:"mapState",value:function(r){Dt(this,$n).map(r),Dt(this,xr).buildTree(),uc(this,ea,Wy(Dt(this,xr).getRoots()))}},{key:"mapNodes",value:function(r){return Lt(Dt(this,xr).getRoots(),function(n,o){return o.walkDown(function(i){var a=r(i.data);a!==void 0&&n.push(a)}),n},[])}},{key:"triggerNodeModification",value:function(r,n,o){n<0&&(n=this.rowCoordsToLevel(n));var i=Dt(this,xr).getNode(n,o),a;return i&&(a=WWe(r,i,o),uc(this,ea,Wy(Dt(this,xr).getRoots()))),a}},{key:"triggerColumnModification",value:function(r,n){return this.triggerNodeModification(r,-1,n)}},{key:"rowCoordsToLevel",value:function(r){if(r>=0)return null;var n=r+Math.max(this.getLayersCount(),1);return n<0?null:n}},{key:"levelToRowCoords",value:function(r){if(r<0)return null;var n=r-Math.max(this.getLayersCount(),1);return n>=0?null:n}},{key:"getHeaderSettings",value:function(r,n){var o,i;return r<0&&(r=this.rowCoordsToLevel(r)),r===null||r>=this.getLayersCount()?null:(o=(i=Dt(this,ea)[r])===null||i===void 0?void 0:i[n])!==null&&o!==void 0?o:null}},{key:"getHeaderTreeNodeData",value:function(r,n){if(r<0&&(r=this.rowCoordsToLevel(r)),r===null||r>=this.getLayersCount())return null;var o=Dt(this,xr).getNode(r,n);return o?pL({},o.data):null}},{key:"findLeftMostColumnIndex",value:function(r,n){var o,i=(o=this.getHeaderSettings(r,n))!==null&&o!==void 0?o:{isRoot:!0},a=i.isRoot;if(a)return n;for(var l=n-1;l>=0;){var s,u=(s=this.getHeaderSettings(r,l))!==null&&s!==void 0?s:{isRoot:!0},f=u.isRoot;if(f)break;l-=1}return l}},{key:"getLayersCount",value:function(){return Dt(this,$n).getLayersCount()}},{key:"getColumnsCount",value:function(){return Dt(this,$n).getColumnsCount()}},{key:"clear",value:function(){uc(this,ea,[]),Dt(this,$n).clear(),Dt(this,xr).clear()}}]),e}();function Ld(e){"@babel/helpers - typeof";return Ld=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ld(e)}function aUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Jz(n.key),n)}}function lUe(e,t,r){return t&&bL(e.prototype,t),r&&bL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fc(e,t,r){return t=Jz(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Jz(e){var t=sUe(e,"string");return Ld(t)==="symbol"?t:String(t)}function sUe(e,t){if(Ld(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ld(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var uUe=function(){function e(t,r){aUe(this,e),fc(this,"hot",void 0),fc(this,"nestedHeaderSettingsGetter",void 0),fc(this,"layersCount",0),fc(this,"container",void 0),fc(this,"widthsMap",void 0),this.hot=t,this.nestedHeaderSettingsGetter=r,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}return lUe(e,[{key:"setLayersCount",value:function(r){return this.layersCount=r,this}},{key:"getWidth",value:function(r){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(r))}},{key:"buildWidthsMap",value:function(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);var r=this.container.querySelectorAll("tr:last-of-type th"),n=r.length;this.widthsMap.clear();for(var o=0;o<n;o++){var i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o),a=this.hot.toPhysicalColumn(i);this.widthsMap.setValueAtIndex(a,r[o].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}},{key:"_buildGhostTable",value:function(r){for(var n=this.hot,o=n.rootDocument,i=n.columnIndexMapper,a=o.createDocumentFragment(),l=o.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,u=i.getRenderableIndexesLength(),f=0;f<this.layersCount;f++){for(var c=o.createElement("tr"),h=0;h<u;h++){var d=i.getVisualFromRenderableIndex(h);d===null&&(d=h);var v=o.createElement("th"),g=this.nestedHeaderSettingsGetter(f,d);if(g&&(!g.isPlaceholder||g.isHidden)){var m=g.label;s&&(m+='<button class="changeType"></button>'),ol(v,m),v.colSpan=g.colspan,c.appendChild(v)}}l.appendChild(c)}a.appendChild(l),r.appendChild(a)}},{key:"clear",value:function(){this.widthsMap.clear(),this.container=null}}]),e}();const fUe=uUe;function sf(e){"@babel/helpers - typeof";return sf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sf(e)}var wL,SL;function CL(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function cUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _L(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Qz(n.key),n)}}function hUe(e,t,r){return t&&_L(e.prototype,t),r&&_L(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ra(){return typeof Reflect<"u"&&Reflect.get?Ra=Reflect.get.bind():Ra=function(t,r,n){var o=dUe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ra.apply(this,arguments)}function dUe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ko(e),e!==null););return e}function vUe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&IR(e,t)}function IR(e,t){return IR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},IR(e,t)}function yUe(e){var t=pUe();return function(){var n=ko(e),o;if(t){var i=ko(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return gUe(this,o)}}function gUe(e,t){if(t&&(sf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mc(e)}function mc(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pUe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ko(e){return ko=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ko(e)}function OL(e,t,r){return t=Qz(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Qz(e){var t=mUe(e,"string");return sf(t)==="symbol"?t:String(t)}function mUe(e,t){if(sf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function RL(e,t,r){bUe(e,t),t.set(e,r)}function bUe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Uy(e,t,r){var n=eY(e,t,"set");return wUe(e,n,r),r}function wUe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function kt(e,t){var r=eY(e,t,"get");return SUe(e,r)}function eY(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function SUe(e,t){return t.get?t.get.call(e):t.value}var EL="nestedHeaders",CUe=280,Ft=new WeakMap,ti=new WeakMap,_Ue=function(e){vUe(r,e);var t=yUe(r);function r(){var n;cUe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),RL(mc(n),Ft,{writable:!0,value:new iUe}),RL(mc(n),ti,{writable:!0,value:null}),OL(mc(n),"ghostTable",new fUe(n.hot,function(l,s){return n.getHeaderSettings(l,s)})),OL(mc(n),"detectedOverlappedHeaders",!1),n}return hUe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[EL]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings(),a=i.nestedHeaders;(!Array.isArray(a)||!Array.isArray(a[0]))&&ht(ft(wL||(wL=CL([`Your Nested Headers plugin configuration is invalid. The settings has to be 
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`],[`Your Nested Headers plugin configuration is invalid. The settings has to be\\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`])))),this.addHook("init",function(){return o.onInit()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("afterOnCellMouseDown",function(){return o.onAfterOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return o.onBeforeOnCellMouseOver.apply(o,arguments)}),this.addHook("afterGetColumnHeaderRenderers",function(l){return o.onAfterGetColumnHeaderRenderers(l)}),this.addHook("modifyColWidth",function(){return o.onModifyColWidth.apply(o,arguments)}),this.addHook("modifyColumnHeaderValue",function(){return o.onModifyColumnHeaderValue.apply(o,arguments)}),this.addHook("beforeHighlightingColumnHeader",function(){return o.onBeforeHighlightingColumnHeader.apply(o,arguments)}),this.addHook("beforeCopy",function(){return o.onBeforeCopy.apply(o,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return o.onAfterViewportColumnCalculatorOverride.apply(o,arguments)}),Ra(ko(r.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){var o=this;if(this.hot.view){var i=this.hot.getSettings(),a=i.nestedHeaders;kt(this,Ft).setColumnsLimit(this.hot.countCols()),Array.isArray(a)&&(this.detectedOverlappedHeaders=kt(this,Ft).setState(a)),this.detectedOverlappedHeaders&&ht(ft(SL||(SL=CL([`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration 
                        is currently not supported.`],[`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\\x20
                        is currently not supported.`])))),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach(function(l,s){var u=l===!0?"hide-column":"show-column";kt(o,Ft).triggerColumnModification(u,s)}),!kt(this,ti)&&this.enabled&&Uy(this,ti,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(function(l){l.forEach(function(s){var u=s.op,f=s.index,c=s.newValue;if(u==="replace"){var h=c===!0?"hide-column":"show-column";kt(o,Ft).triggerColumnModification(h,f)}}),o.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),Ra(ko(r.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.clearColspans(),kt(this,Ft).clear(),kt(this,ti).unsubscribe(),Uy(this,ti,null),this.ghostTable.clear(),Ra(ko(r.prototype),"disablePlugin",this).call(this)}},{key:"getStateManager",value:function(){return kt(this,Ft)}},{key:"getLayersCount",value:function(){return kt(this,Ft).getLayersCount()}},{key:"getHeaderSettings",value:function(o,i){return kt(this,Ft).getHeaderSettings(o,i)}},{key:"clearColspans",value:function(){if(this.hot.view)for(var o=this.hot.view._wt,i=o.getSetting("columnHeaders").length,a=o.wtTable.THEAD,l=o.wtOverlays.topOverlay.clone.wtTable.THEAD,s=o.wtOverlays.topInlineStartCornerOverlay?o.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,u=0;u<i;u++){var f=a.childNodes[u];if(!f)break;for(var c=l.childNodes[u],h=s?s.childNodes[u]:null,d=0,v=f.childNodes.length;d<v;d++)f.childNodes[d].removeAttribute("colspan"),Le(f.childNodes[d],"hiddenHeader"),c&&c.childNodes[d]&&(c.childNodes[d].removeAttribute("colspan"),Le(c.childNodes[d],"hiddenHeader")),s&&h&&h.childNodes[d]&&(h.childNodes[d].removeAttribute("colspan"),Le(h.childNodes[d],"hiddenHeader"))}}},{key:"headerRendererFactory",value:function(o){var i=this,a=this.hot.view._wt.getSetting("fixedColumnsStart");return function(l,s){var u,f=i.hot,c=f.columnIndexMapper,h=f.view,d=c.getVisualFromRenderableIndex(l);d===null&&(d=l),s.removeAttribute("colspan"),Le(s,"hiddenHeader");var v=(u=kt(i,Ft).getHeaderSettings(o,d))!==null&&u!==void 0?u:{label:""},g=v.colspan,m=v.isHidden,w=v.isPlaceholder;if(w||m)re(s,"hiddenHeader");else if(g>1){var S,C,k=h._wt.wtOverlays,R=(S=k.topInlineStartCornerOverlay)===null||S===void 0?void 0:S.clone.wtTable.THEAD.contains(s),V=(C=k.inlineStartOverlay)===null||C===void 0?void 0:C.clone.wtTable.THEAD.contains(s),U=R||V?Math.min(g,a-l):g;U>1&&s.setAttribute("colspan",U)}i.hot.view.appendColHeader(d,s,function(){return i.getColumnHeaderValue.apply(i,arguments)},o)}}},{key:"getColumnHeaderValue",value:function(o,i){var a,l=(a=kt(this,Ft).getHeaderSettings(i,o))!==null&&a!==void 0?a:{},s=l.isHidden,u=l.isPlaceholder;return u||s?"":this.hot.getColHeader(o,i)}},{key:"onBeforeHighlightingColumnHeader",value:function(o,i,a){var l=kt(this,Ft).getHeaderTreeNodeData(i,o);if(!l)return o;var s=a.classNames,u=a.columnCursor,f=a.selectionType,c=a.selectionWidth,h=kt(this,Ft).getHeaderSettings(i,o),d=h.isRoot,v=h.colspan;if(f===Tv){if(!d)return l.columnIndex}else f===Ym&&(v>c-u||!d)&&(s.length=0);return o}},{key:"onBeforeCopy",value:function(o,i,a){var l=a.columnHeadersCount;if(l!==0)for(var s=0;s<i.length;s++){var u=i[s],f=u.startRow,c=u.startCol,h=u.endRow,d=u.endCol,v=h-f+1,g=c-d+1;if(f>=0||g===1)break;for(var m=c;m<=d;m++)for(var w=f;w<=h;w++){var S,C=v+w,k=m-c;if(k!==0){var R=(S=kt(this,Ft).getHeaderTreeNodeData(w,m))===null||S===void 0?void 0:S.isRoot;R===!1&&(o[C][k]="")}}}}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,l){var s=this._getHeaderTreeNodeDataByCoords(i);s&&(l.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(o,i){var a=this._getHeaderTreeNodeDataByCoords(i);if(a){var l=this.hot.selection,s=l.isSelected()?l.getSelectedRange().current():null,u=[],f=a.columnIndex,c=a.origColspan,h=!l.inInSelection(i);o.shiftKey&&s?i.col<s.from.col?u.push(s.getTopEndCorner().col,f,i.row):i.col>s.from.col?u.push(s.getTopStartCorner().col,f+c-1,i.row):u.push(f,f+c-1,i.row):(Hm(o)||ki(o)&&h)&&u.push(f,f+c-1,i.row),l.selectColumns.apply(l,u)}}},{key:"onBeforeOnCellMouseOver",value:function(o,i,a,l){var s;if(this.hot.view.isMouseDown()){var u=this._getHeaderTreeNodeDataByCoords(i);if(u){var f=u.columnIndex,c=u.origColspan,h=this.hot.getSelectedRangeLast(),d=h.getTopStartCorner(),v=h.getBottomEndCorner(),g=h.from;l.column=!0,l.cell=!0;var m=[];i.col<g.col?m.push(v.col,f):i.col>g.col?m.push(d.col,f+c-1):m.push(f,f+c-1),(s=this.hot).selectColumns.apply(s,m)}}}},{key:"onAfterGetColumnHeaderRenderers",value:function(o){o.length=0;for(var i=0;i<kt(this,Ft).getLayersCount();i++)o.push(this.headerRendererFactory(i))}},{key:"onAfterViewportColumnCalculatorOverride",value:function(o){for(var i=kt(this,Ft).getLayersCount(),a=o.startColumn,l=!!i,s=0;s<i;s++){var u=kt(this,Ft).findLeftMostColumnIndex(s,o.startColumn),f=this.hot.columnIndexMapper.getRenderableFromVisualIndex(u);if(u>=0&&(l=!1),gr(f)&&f<o.startColumn){a=f;break}}o.startColumn=l?kt(this,Ft).getHeaderTreeNodeData(0,a).columnIndex:a}},{key:"onModifyColWidth",value:function(o,i){var a=this.ghostTable.getWidth(i);return o>a?o:a}},{key:"onModifyColumnHeaderValue",value:function(o,i,a){var l,s=(l=kt(this,Ft).getHeaderTreeNodeData(a,i))!==null&&l!==void 0?l:{label:""},u=s.label;return u}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(o,i){i||this.updatePlugin()}},{key:"destroy",value:function(){Uy(this,Ft,null),kt(this,ti)!==null&&(kt(this,ti).unsubscribe(),Uy(this,ti,null)),Ra(ko(r.prototype),"destroy",this).call(this)}},{key:"_getHeaderTreeNodeDataByCoords",value:function(o){if(!(o.row>=0||o.col<0))return kt(this,Ft).getHeaderTreeNodeData(o.row,o.col)}}],[{key:"PLUGIN_KEY",get:function(){return EL}},{key:"PLUGIN_PRIORITY",get:function(){return CUe}}]),r}(ot);function TL(e){return TUe(e)||EUe(e)||RUe(e)||OUe()}function OUe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function RUe(e,t){if(e){if(typeof e=="string")return MR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return MR(e,t)}}function EUe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function TUe(e){if(Array.isArray(e))return MR(e)}function MR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function uf(e){"@babel/helpers - typeof";return uf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uf(e)}function kUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$Ue(n.key),n)}}function PUe(e,t,r){return t&&kL(e.prototype,t),r&&kL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $Ue(e){var t=AUe(e,"string");return uf(t)==="symbol"?t:String(t)}function AUe(e,t){if(uf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(uf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var IUe=function(){function e(t,r){kUe(this,e),this.hot=r,this.data=null,this.plugin=t,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}}return PUe(e,[{key:"setData",value:function(r){this.data=r}},{key:"getData",value:function(){return this.data}},{key:"getRawSourceData",value:function(){var r=null;return this.plugin.disableCoreAPIModifiers(),r=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),r}},{key:"updateWithData",value:function(r){this.setData(r),this.rewriteCache()}},{key:"rewriteCache",value:function(){var r=this;this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},_e(0,this.data.length-1,function(n){r.cacheNode(r.data[n],0,null)})}},{key:"cacheNode",value:function(r,n,o){var i=this;this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(r),this.cache.rows.push(r),this.cache.nodeInfo.set(r,{parent:o,row:this.cache.rows.length-1,level:n}),this.hasChildren(r)&&$(r.__children,function(a){i.cacheNode(a,n+1,r)})}},{key:"getDataObject",value:function(r){return r==null?null:this.cache.rows[r]}},{key:"readTreeNodes",value:function(r,n,o,i){var a=this,l=!1,s=n;if(isNaN(s)&&s.end)return s;var u=r;return u||(u={__children:this.data},l=!0,s-=1),o!=null&&s===o?{result:u,end:!0}:i!=null&&u===i?{result:s,end:!0}:(s+=1,u.__children&&$(u.__children,function(f){if(a.parentReference.set(f,l?null:u),s=a.readTreeNodes(f,s,o,i),isNaN(s)&&s.end)return!1}),s)}},{key:"mockParent",value:function(){var r=this.mockNode();return r.__children=this.data,r}},{key:"mockNode",value:function(){var r={};return We(this.data[0],function(n,o){r[o]=null}),r}},{key:"getRowIndex",value:function(r){return r==null?null:this.cache.nodeInfo.get(r).row}},{key:"getRowIndexWithinParent",value:function(r){var n=null;isNaN(r)?n=r:n=this.getDataObject(r);var o=this.getRowParent(r);return o==null?this.data.indexOf(n):o.__children.indexOf(n)}},{key:"countAllRows",value:function(){var r={__children:this.data};return this.countChildren(r)}},{key:"countChildren",value:function(r){var n=this,o=0,i=r;return isNaN(i)||(i=this.getDataObject(i)),!i||!i.__children?0:($(i.__children,function(a){o+=1,a.__children&&(o+=n.countChildren(a))}),o)}},{key:"getRowParent",value:function(r){var n;return isNaN(r)?n=r:n=this.getDataObject(r),this.getRowObjectParent(n)}},{key:"getRowObjectParent",value:function(r){return!r||uf(r)!=="object"?null:this.cache.nodeInfo.get(r).parent}},{key:"getRowLevel",value:function(r){var n=null;return isNaN(r)?n=r:n=this.getDataObject(r),n?this.getRowObjectLevel(n):null}},{key:"getRowObjectLevel",value:function(r){return r==null?null:this.cache.nodeInfo.get(r).level}},{key:"hasChildren",value:function(r){var n=r;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}},{key:"isChild",value:function(r){return this.getRowParent(r)!==null}},{key:"getChild",value:function(r,n){var o;return((o=r.__children)===null||o===void 0?void 0:o[n])||null}},{key:"isRowHighestLevel",value:function(r){return!this.isChild(r)}},{key:"isParent",value:function(r){var n,o=r;return isNaN(o)||(o=this.getDataObject(o)),o&&!!o.__children&&((n=o.__children)===null||n===void 0?void 0:n.length)!==0}},{key:"addChild",value:function(r,n){var o=n;this.hot.runHooks("beforeAddChild",r,o);var i=null;r&&(i=this.getRowIndex(r)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(r)+1,1);var a=r;r||(a=this.mockParent()),a.__children||(a.__children=[]),o||(o=this.mockNode()),a.__children.push(o),this.rewriteCache();var l=this.getRowIndex(o);this.hot.rowIndexMapper.insertIndexes(l,1),this.hot.runHooks("afterCreateRow",l,1),this.hot.runHooks("afterAddChild",r,o)}},{key:"addChildAtIndex",value:function(r,n,o){var i=o,a;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",r,i,n),r){var l=this.getRowIndex(r),s=l+n+1;this.hot.runHooks("beforeCreateRow",s,1),r.__children.splice(n,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(r),"__children",r.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(s,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",s,1),a=s}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),a=this.getRowIndex(this.data[n]);i=this.getDataObject(a),this.hot.runHooks("afterAddChild",r,i,n)}},{key:"addSibling",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below",o=this.translateTrimmedRow(r),i=this.getRowParent(o),a=this.getRowIndexWithinParent(o);switch(n){case"below":this.addChildAtIndex(i,a+1,null);break;case"above":this.addChildAtIndex(i,a,null);break}}},{key:"detachFromParent",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=null,a=[];Array.isArray(r)?(_e(r[0],r[2],function(w){var S=n.translateTrimmedRow(w);a.push(n.getDataObject(S))}),_e(0,a.length-2,function(w){n.detachFromParent(a[w],!1)}),i=a[a.length-1]):i=r;var l=this.getRowIndex(i),s=this.countChildren(i),u=this.getRowIndexWithinParent(i),f=this.getRowParent(i),c=this.getRowParent(f),h=this.getRowIndex(c),d=null;if(this.hot.runHooks("beforeDetachChild",f,i),u!=null){var v=Array.from(new Array(l+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",l,s+1,v,this.plugin.pluginName),f.__children.splice(u,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",l,s+1,v,this.plugin.pluginName),c){d=h+this.countChildren(c);var g=this.getChild(c,this.countChildren(c)-1),m=this.getRowIndex(g);this.hot.runHooks("beforeCreateRow",m+1,s+1,this.plugin.pluginName),c.__children.push(i)}else d=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",d-2,s+1,this.plugin.pluginName),this.data.push(i)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",d-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",f,i,this.getRowIndex(i)),o&&this.hot.render()}},{key:"filterData",value:function(r,n,o){var i=this,a=[];$(o,function(l){a.push(i.getDataObject(l))}),$(a,function(l){var s=i.getRowIndexWithinParent(l),u=i.getRowParent(l);u===null?i.data.splice(s,1):u.__children.splice(s,1)}),this.rewriteCache()}},{key:"spliceData",value:function(r,n,o){var i=this.getDataObject(r-1),a=null,l=r;if(i&&i.__children&&i.__children.length===0?(a=i,l=0):r<this.countAllRows()&&(a=this.getRowParent(r),l=this.getRowIndexWithinParent(r)),a)if(o){var s;(s=a.__children).splice.apply(s,[l,n].concat(TL(o)))}else a.__children.splice(l,n);else if(o){var u;(u=this.data).splice.apply(u,[l,n].concat(TL(o)))}else this.data.splice(l,n);this.rewriteCache()}},{key:"syncRowWithRawSource",value:function(r){var n=r,o=null;do o=this.getRowParent(o),o!==null&&(n=o);while(o!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}},{key:"moveRow",value:function(r,n,o,i){var a=n===this.hot.countRows(),l=this.getRowParent(r),s=this.getRowIndexWithinParent(r),u=l.__children.slice(s,s+1),f=r>n,c=a?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);var h=a||o||i?c.__children.length:this.getRowIndexWithinParent(n),d=l===c;c.__children.splice(h,0,u[0]),l.__children.splice(s+(f&&d?1:0),1),this.syncRowWithRawSource(l),d||this.syncRowWithRawSource(c)}},{key:"translateTrimmedRow",value:function(r){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(r):r}},{key:"untranslateTrimmedRow",value:function(r){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(r):r}}]),e}();const MUe=IUe;function jd(e){"@babel/helpers - typeof";return jd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jd(e)}function PL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,DUe(n.key),n)}}function xUe(e,t,r){return t&&PL(e.prototype,t),r&&PL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function DUe(e){var t=NUe(e,"string");return jd(t)==="symbol"?t:String(t)}function NUe(e,t){if(jd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(jd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function HUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var LUe=xUe(function e(t,r){HUe(this,e),this.hot=r,this.plugin=t});const zk=LUe;function ff(e){"@babel/helpers - typeof";return ff=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ff(e)}function jUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $L(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,BUe(n.key),n)}}function FUe(e,t,r){return t&&$L(e.prototype,t),r&&$L(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function BUe(e){var t=VUe(e,"string");return ff(t)==="symbol"?t:String(t)}function VUe(e,t){if(ff(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ff(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function WUe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xR(e,t)}function xR(e,t){return xR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},xR(e,t)}function UUe(e){var t=GUe();return function(){var n=Yp(e),o;if(t){var i=Yp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return zUe(this,o)}}function zUe(e,t){if(t&&(ff(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return YUe(e)}function YUe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function GUe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Yp(e){return Yp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Yp(e)}var KUe=function(e){WUe(r,e);var t=UUe(r);function r(n,o){var i;return jUe(this,r),i=t.call(this,n,o),i.dataManager=i.plugin.dataManager,i.collapsingUI=i.plugin.collapsingUI,i.rowHeaderWidthCache=null,i}return FUe(r,[{key:"appendLevelIndicators",value:function(o,i){var a=this.hot.toPhysicalRow(o),l=this.dataManager.getRowLevel(a),s=this.dataManager.getDataObject(a),u=i.getElementsByTagName("DIV")[0],f=u.querySelector("span.rowHeader"),c=u.querySelectorAll('[class^="ht_nesting"]');if($(c,function(g){g&&u.removeChild(g)}),re(i,r.CSS_CLASSES.indicatorContainer),l){var h=this.hot.rootDocument,d=f.cloneNode(!0);u.innerHTML="",_e(0,l-1,function(){var g=h.createElement("SPAN");re(g,r.CSS_CLASSES.emptyIndicator),u.appendChild(g)}),u.appendChild(d)}if(this.dataManager.hasChildren(s)){var v=this.hot.rootDocument.createElement("DIV");re(i,r.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(a)?re(v,"".concat(r.CSS_CLASSES.button," ").concat(r.CSS_CLASSES.expandButton)):re(v,"".concat(r.CSS_CLASSES.button," ").concat(r.CSS_CLASSES.collapseButton)),u.appendChild(v)}}},{key:"updateRowHeaderWidth",value:function(o){var i=o;i||(i=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*i+25),this.hot.render()}}],[{key:"CSS_CLASSES",get:function(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}}]),r}(zk);const tY=KUe;function cf(e){"@babel/helpers - typeof";return cf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cf(e)}function AL(e){return JUe(e)||ZUe(e)||XUe(e)||qUe()}function qUe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function XUe(e,t){if(e){if(typeof e=="string")return DR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return DR(e,t)}}function ZUe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function JUe(e){if(Array.isArray(e))return DR(e)}function DR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function QUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function IL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tze(n.key),n)}}function eze(e,t,r){return t&&IL(e.prototype,t),r&&IL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tze(e){var t=rze(e,"string");return cf(t)==="symbol"?t:String(t)}function rze(e,t){if(cf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function nze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&NR(e,t)}function NR(e,t){return NR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},NR(e,t)}function oze(e){var t=lze();return function(){var n=Gp(e),o;if(t){var i=Gp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return ize(this,o)}}function ize(e,t){if(t&&(cf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return aze(e)}function aze(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lze(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Gp(e){return Gp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Gp(e)}var sze=function(e){nze(r,e);var t=oze(r);function r(n,o){var i;return QUe(this,r),i=t.call(this,n,o),i.dataManager=i.plugin.dataManager,i.collapsedRows=[],i.collapsedRowsStash={stash:function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;i.lastCollapsedRows=i.collapsedRows.slice(0),i.expandMultipleChildren(i.lastCollapsedRows,l)},shiftStash:function(l,s){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;s==null&&(s=1/0),$(i.lastCollapsedRows,function(f,c){f>=l&&f<s&&(i.lastCollapsedRows[c]=f+u)})},applyStash:function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;i.collapseMultipleChildren(i.lastCollapsedRows,l),i.lastCollapsedRows=void 0},trimStash:function(l,s){_e(l,l+s-1,function(u){var f=i.lastCollapsedRows.indexOf(u);f>-1&&i.lastCollapsedRows.splice(f,1)})}},i}return eze(r,[{key:"collapseChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[],u=null,f=null,c=null;return isNaN(o)?(u=o,f=this.dataManager.getRowIndex(u)):(u=this.dataManager.getDataObject(o),f=o),this.dataManager.hasChildren(u)&&$(u.__children,function(h){s.push(i.dataManager.getRowIndex(h))}),c=this.collapseRows(s,!0,!1),l&&this.trimRows(c),a&&this.renderAndAdjust(),this.collapsedRows.indexOf(f)===-1&&this.collapsedRows.push(f),c}},{key:"collapseMultipleChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[];$(o,function(u){s.push.apply(s,AL(i.collapseChildren(u,!1,!1)))}),l&&this.trimRows(s),a&&this.renderAndAdjust()}},{key:"collapseRow",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([o],i)}},{key:"collapseRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=[];return $(o,function(u){s.push(u),a&&i.collapseChildRows(u,s)}),l&&this.trimRows(s),s}},{key:"collapseChildRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(o)){var s=this.dataManager.getDataObject(o);$(s.__children,function(u){var f=i.dataManager.getRowIndex(u);a.push(f),i.collapseChildRows(f,a)})}l&&this.trimRows(a)}},{key:"expandRow",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([o],i)}},{key:"expandRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=[];return $(o,function(u){s.push(u),a&&i.expandChildRows(u,s)}),l&&this.untrimRows(s),s}},{key:"expandChildRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(o)){var s=this.dataManager.getDataObject(o);$(s.__children,function(u){if(!i.isAnyParentCollapsed(u)){var f=i.dataManager.getRowIndex(u);a.push(f),i.expandChildRows(f,a)}})}l&&this.untrimRows(a)}},{key:"expandChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[],u=null,f=null,c=null;return isNaN(o)?(u=o,f=this.dataManager.getRowIndex(o)):(u=this.dataManager.getDataObject(o),f=o),this.collapsedRows.splice(this.collapsedRows.indexOf(f),1),this.dataManager.hasChildren(u)&&$(u.__children,function(h){var d=i.dataManager.getRowIndex(h);s.push(d)}),c=this.expandRows(s,!0,!1),l&&this.untrimRows(c),a&&this.renderAndAdjust(),c}},{key:"expandMultipleChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[];$(o,function(u){s.push.apply(s,AL(i.expandChildren(u,!1,!1)))}),l&&this.untrimRows(s),a&&this.renderAndAdjust()}},{key:"collapseAll",value:function(){var o=this,i=this.dataManager.getData(),a=[];$(i,function(l){o.dataManager.hasChildren(l)&&a.push(l)}),this.collapseMultipleChildren(a),this.renderAndAdjust()}},{key:"expandAll",value:function(){var o=this,i=this.dataManager.getData(),a=[];$(i,function(l){o.dataManager.hasChildren(l)&&a.push(l)}),this.expandMultipleChildren(a),this.renderAndAdjust()}},{key:"trimRows",value:function(o){var i=this;this.hot.batchExecution(function(){$(o,function(a){i.plugin.collapsedRowsMap.setValueAtIndex(a,!0)})},!0)}},{key:"untrimRows",value:function(o){var i=this;this.hot.batchExecution(function(){$(o,function(a){i.plugin.collapsedRowsMap.setValueAtIndex(a,!1)})},!0)}},{key:"areChildrenCollapsed",value:function(o){var i=this,a=isNaN(o)?o:this.dataManager.getDataObject(o),l=!0;return a===null&&(a={__children:this.dataManager.data}),this.dataManager.hasChildren(a)&&$(a.__children,function(s){var u=i.dataManager.getRowIndex(s);if(!i.plugin.collapsedRowsMap.getValueAtIndex(u))return l=!1,!1}),l}},{key:"isAnyParentCollapsed",value:function(o){for(var i=o;i!==null;){i=this.dataManager.getRowParent(i);var a=this.dataManager.getRowIndex(i);if(this.collapsedRows.indexOf(a)>-1)return!0}return!1}},{key:"toggleState",value:function(o,i){if(!(i.col>=0)){var a=this.translateTrimmedRow(i.row);xe(o.target,tY.CSS_CLASSES.button)&&(this.areChildrenCollapsed(a)?this.expandChildren(a):this.collapseChildren(a),pn(o))}}},{key:"translateTrimmedRow",value:function(o){return this.hot.toPhysicalRow(o)}},{key:"untranslateTrimmedRow",value:function(o){return this.hot.toVisualRow(o)}},{key:"renderAndAdjust",value:function(){this.hot.render(),this.hot.view.adjustElementsSize()}}]),r}(zk);const uze=sze;function hf(e){"@babel/helpers - typeof";return hf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hf(e)}function fze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ML(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hze(n.key),n)}}function cze(e,t,r){return t&&ML(e.prototype,t),r&&ML(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hze(e){var t=dze(e,"string");return hf(t)==="symbol"?t:String(t)}function dze(e,t){if(hf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&HR(e,t)}function HR(e,t){return HR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},HR(e,t)}function yze(e){var t=pze();return function(){var n=Kp(e),o;if(t){var i=Kp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return gze(this,o)}}function gze(e,t){if(t&&(hf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rY(e)}function rY(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pze(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Kp(e){return Kp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Kp(e)}var xL=new WeakMap,mze=function(e){vze(r,e);var t=yze(r);function r(n,o){var i;return fze(this,r),i=t.call(this,n,o),xL.set(rY(i),{row_above:function(l,s){var u=s[s.length-1];i.dataManager.addSibling(u.start.row,"above")},row_below:function(l,s){var u=s[s.length-1];i.dataManager.addSibling(u.start.row,"below")}}),i.dataManager=i.plugin.dataManager,i}return cze(r,[{key:"appendOptions",value:function(o){var i=this,a=[{key:"add_child",name:function(){return this.getTranslatedPhrase(MT)},callback:function(){var s=i.dataManager.translateTrimmedRow(i.hot.getSelectedLast()[0]),u=i.dataManager.getDataObject(s);i.dataManager.addChild(u)},disabled:function(){var s=i.hot.getSelectedLast();return!s||s[0]<0||i.hot.selection.isSelectedByColumnHeader()||i.hot.countRows()>=i.hot.getSettings().maxRows}},{key:"detach_from_parent",name:function(){return this.getTranslatedPhrase(xT)},callback:function(){i.dataManager.detachFromParent(i.hot.getSelectedLast())},disabled:function(){var s=i.hot.getSelectedLast(),u=i.dataManager.translateTrimmedRow(s[0]),f=i.dataManager.getRowParent(u);return!f||!s||s[0]<0||i.hot.selection.isSelectedByColumnHeader()||i.hot.countRows()>=i.hot.getSettings().maxRows}},{name:"---------"}];return _e(0,o.items.length-1,function(l){if(l===0)return $(a,function(s,u){o.items.splice(l+u,0,s)}),!1}),this.modifyRowInsertingOptions(o)}},{key:"modifyRowInsertingOptions",value:function(o){var i=xL.get(this);return _e(0,o.items.length-1,function(a){var l=i[o.items[a].key];l!=null&&(o.items[a].callback=l)}),o}}]),r}(zk);const bze=mze;function Fd(e){"@babel/helpers - typeof";return Fd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fd(e)}var DL;function NL(e){return _ze(e)||Cze(e)||Sze(e)||wze()}function wze(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Sze(e,t){if(e){if(typeof e=="string")return LR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return LR(e,t)}}function Cze(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _ze(e){if(Array.isArray(e))return LR(e)}function LR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Oze(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Rze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Tze(n.key),n)}}function Eze(e,t,r){return t&&HL(e.prototype,t),r&&HL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Tze(e){var t=kze(e,"string");return Fd(t)==="symbol"?t:String(t)}function kze(e,t){if(Fd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Pze=function(){function e(t){Rze(this,e),this.plugin=t,this.hot=t.hot,this.dataManager=t.dataManager,this.collapsingUI=t.collapsingUI}return Eze(e,[{key:"onBeforeRowMove",value:function(r,n,o,i){var a=this,l=this.displayAPICompatibilityWarning({rows:r,finalIndex:n,dropIndex:o,movePossible:i});if(l)return!1;this.movedToCollapsed=!1;var s=o===this.hot.countRows(),u=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(o),f=!0,c=r.map(function(m){if(!f)return!1;var w=a.dataManager.translateTrimmedRow(m);return f=a.shouldAllowMoving(w,u),w}),h=c.indexOf(u)===-1;if(!f||!h)return!1;var d=this.getBaseParent(c),v=this.getTargetParent(s,u),g=d===v;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(v),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(c,u,g),this.moveRows(c,u,v),this.dataManager.rewriteCache(),this.moveCellsMeta(c,u),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",r,n,o,i,i&&this.isRowOrderChanged(r,n)),this.hot.render(),this.selectCells(r,o),!1}},{key:"displayAPICompatibilityWarning",value:function(r){var n=r.rows,o=r.finalIndex,i=r.dropIndex,a=r.movePossible,l=!1;return gt(i)&&(ht(ft(DL||(DL=Oze([`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows 
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`],[`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`])))),this.hot.runHooks("afterRowMove",n,o,i,a,!1),l=!0),l}},{key:"shouldAllowMoving",value:function(r,n){return!(this.dataManager.isParent(r)||this.dataManager.isRowHighestLevel(r)||r===n||n===0)}},{key:"getBaseParent",value:function(r){return this.dataManager.getRowParent(r[0])}},{key:"getTargetParent",value:function(r,n){var o=this.dataManager.getRowParent(r?n-1:n);return o==null&&(o=this.dataManager.getRowParent(n-1)),o}},{key:"shiftCollapsibleParentsLocations",value:function(r,n,o){o||(Math.max.apply(Math,NL(r))<=n?this.collapsingUI.collapsedRowsStash.shiftStash(r[0],n,-1*r.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,r[0],r.length))}},{key:"moveRows",value:function(r,n,o){var i=this,a=n===this.dataManager.getRowIndex(o)+this.dataManager.countChildren(o)+1;this.hot.batchRender(function(){r.forEach(function(l){i.dataManager.moveRow(l,n,i.movedToCollapsed,a)})})}},{key:"moveCellsMeta",value:function(r,n){var o=this,i,a=[],l=Math.max.apply(Math,NL(r))<n;r.forEach(function(s){a.push(o.hot.getCellMetaAtRow(s))}),this.hot.spliceCellsMeta(r[0],r.length),(i=this.hot).spliceCellsMeta.apply(i,[n-(l?a.length:0),0].concat(a))}},{key:"selectCells",value:function(r,n){var o=r.length,i=0,a=0,l=null,s=null;if(this.movedToCollapsed){var u=null;r[o-1]<n?u=this.dataManager.translateTrimmedRow(n-o):u=this.dataManager.translateTrimmedRow(n);var f=this.dataManager.getRowParent(u===null?this.hot.countSourceRows()-1:u-1),c=this.dataManager.getRowIndex(f);i=this.dataManager.untranslateTrimmedRow(c),a=i}else r[o-1]<n?(a=n-1,i=a-o+1):(i=n,a=i+o-1);l=this.hot.selection,s=this.hot.countCols()-1,l.setRangeStart(this.hot._createCellCoords(i,0)),l.setRangeEnd(this.hot._createCellCoords(a,s),!0)}},{key:"isRowOrderChanged",value:function(r,n){return r.some(function(o,i){return o-i!==n})}}]),e}();function df(e){"@babel/helpers - typeof";return df=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},df(e)}function $ze(e){return xze(e)||Mze(e)||Ize(e)||Aze()}function Aze(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ize(e,t){if(e){if(typeof e=="string")return jR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return jR(e,t)}}function Mze(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function xze(e){if(Array.isArray(e))return jR(e)}function jR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Dze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Hze(n.key),n)}}function Nze(e,t,r){return t&&LL(e.prototype,t),r&&LL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hze(e){var t=Lze(e,"string");return df(t)==="symbol"?t:String(t)}function Lze(e,t){if(df(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(df(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ea(){return typeof Reflect<"u"&&Reflect.get?Ea=Reflect.get.bind():Ea=function(t,r,n){var o=jze(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ea.apply(this,arguments)}function jze(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Po(e),e!==null););return e}function Fze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&FR(e,t)}function FR(e,t){return FR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},FR(e,t)}function Bze(e){var t=Wze();return function(){var n=Po(e),o;if(t){var i=Po(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Vze(this,o)}}function Vze(e,t){if(t&&(df(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nY(e)}function nY(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Wze(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Po(e){return Po=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Po(e)}var BS="nestedRows",Uze=300,Qn=new WeakMap,zze="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.",Yze=function(e){Fze(r,e);var t=Bze(r);function r(n){var o;return Dze(this,r),o=t.call(this,n),o.dataManager=null,o.headersUI=null,o.collapsedRowsMap=null,Qn.set(nY(o),{movedToCollapsed:!1,skipRender:null,skipCoreAPIModifiers:!1}),o}return Nze(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[BS]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Ev),this.dataManager=new MUe(this,this.hot),this.collapsingUI=new uze(this,this.hot),this.headersUI=new tY(this,this.hot),this.contextMenuUI=new bze(this,this.hot),this.rowMoveController=new Pze(this),this.addHook("afterInit",function(){return o.onAfterInit.apply(o,arguments)}),this.addHook("beforeViewRender",function(){return o.onBeforeViewRender.apply(o,arguments)}),this.addHook("modifyRowData",function(){return o.onModifyRowData.apply(o,arguments)}),this.addHook("modifySourceLength",function(){return o.onModifySourceLength.apply(o,arguments)}),this.addHook("beforeDataSplice",function(){return o.onBeforeDataSplice.apply(o,arguments)}),this.addHook("filterData",function(){return o.onFilterData.apply(o,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return o.onAfterContextMenuDefaultOptions.apply(o,arguments)}),this.addHook("afterGetRowHeader",function(){return o.onAfterGetRowHeader.apply(o,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeRemoveRow",function(){return o.onBeforeRemoveRow.apply(o,arguments)}),this.addHook("afterRemoveRow",function(){return o.onAfterRemoveRow.apply(o,arguments)}),this.addHook("beforeAddChild",function(){return o.onBeforeAddChild.apply(o,arguments)}),this.addHook("afterAddChild",function(){return o.onAfterAddChild.apply(o,arguments)}),this.addHook("beforeDetachChild",function(){return o.onBeforeDetachChild.apply(o,arguments)}),this.addHook("afterDetachChild",function(){return o.onAfterDetachChild.apply(o,arguments)}),this.addHook("modifyRowHeaderWidth",function(){return o.onModifyRowHeaderWidth.apply(o,arguments)}),this.addHook("afterCreateRow",function(){return o.onAfterCreateRow.apply(o,arguments)}),this.addHook("beforeRowMove",function(){return o.onBeforeRowMove.apply(o,arguments)}),this.addHook("beforeLoadData",function(i){return o.onBeforeLoadData(i)}),this.addHook("beforeUpdateData",function(i){return o.onBeforeLoadData(i)}),Ea(Po(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),Ea(Po(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin();var o=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(o),Ea(Po(r.prototype),"updatePlugin",this).call(this)}},{key:"onBeforeRowMove",value:function(o,i,a,l){return this.rowMoveController.onBeforeRowMove(o,i,a,l)}},{key:"disableCoreAPIModifiers",value:function(){var o=Qn.get(this);o.skipCoreAPIModifiers=!0}},{key:"enableCoreAPIModifiers",value:function(){var o=Qn.get(this);o.skipCoreAPIModifiers=!1}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a){this.collapsingUI.toggleState(o,i,a)}},{key:"onModifyRowData",value:function(o){var i=Qn.get(this);if(!i.skipCoreAPIModifiers)return this.dataManager.getDataObject(o)}},{key:"onModifySourceLength",value:function(){var o=Qn.get(this);if(!o.skipCoreAPIModifiers)return this.dataManager.countAllRows()}},{key:"onBeforeDataSplice",value:function(o,i,a){var l=Qn.get(this);return l.skipCoreAPIModifiers||this.dataManager.isRowHighestLevel(o)?!0:(this.dataManager.spliceData(o,i,a),!1)}},{key:"onFilterData",value:function(o,i,a){var l=Qn.get(this);return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(a[0],i),this.collapsingUI.collapsedRowsStash.shiftStash(a[0],null,-1*i),this.dataManager.filterData(o,i,a),l.skipRender=!0,this.dataManager.getData().slice()}},{key:"onAfterContextMenuDefaultOptions",value:function(o){return this.contextMenuUI.appendOptions(o)}},{key:"onAfterGetRowHeader",value:function(o,i){this.headersUI.appendLevelIndicators(o,i)}},{key:"onModifyRowHeaderWidth",value:function(o){return this.headersUI.rowHeaderWidthCache||o}},{key:"onAfterRemoveRow",value:function(o,i,a,l){var s=this;if(l!==this.pluginName){var u=Qn.get(this);setTimeout(function(){u.skipRender=null,s.headersUI.updateRowHeaderWidth(),s.collapsingUI.collapsedRowsStash.applyStash()},0)}}},{key:"onBeforeRemoveRow",value:function(o,i,a){var l=this,s=Array.from(a.reduce(function(u,f){if(l.dataManager.isParent(f)){var c=l.dataManager.getDataObject(f).__children;return u.add(f),Array.isArray(c)&&c.forEach(function(h){return u.add(l.dataManager.getRowIndex(h))}),u}return u.add(f)},new Set));a.length=0,a.push.apply(a,s)}},{key:"onBeforeAddChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterAddChild",value:function(o,i){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(i)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onBeforeDetachChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterDetachChild",value:function(o,i,a){this.collapsingUI.collapsedRowsStash.shiftStash(a,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onAfterCreateRow",value:function(){this.dataManager.rewriteCache()}},{key:"onAfterInit",value:function(){var o=Math.max.apply(Math,$ze(this.dataManager.cache.levels));o>0&&this.headersUI.updateRowHeaderWidth(o)}},{key:"onBeforeViewRender",value:function(o,i){var a=Qn.get(this);a.skipRender&&(i.skipRender=!0)}},{key:"destroy",value:function(){Ea(Po(r.prototype),"destroy",this).call(this)}},{key:"onBeforeLoadData",value:function(o){if(!oW(o)){_E(zze),this.hot.getSettings()[BS]=!1,this.disablePlugin();return}this.dataManager.setData(o),this.dataManager.rewriteCache()}}],[{key:"PLUGIN_KEY",get:function(){return BS}},{key:"PLUGIN_PRIORITY",get:function(){return Uze}}]),r}(ot);function Bd(e){"@babel/helpers - typeof";return Bd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bd(e)}function Gze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qze(n.key),n)}}function Kze(e,t,r){return t&&jL(e.prototype,t),r&&jL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qze(e){var t=Xze(e,"string");return Bd(t)==="symbol"?t:String(t)}function Xze(e,t){if(Bd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Zze=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;Gze(this,e),this.rootWindow=r,this.prefix=t,this.savedKeys=[],this.loadSavedKeys()}return Kze(e,[{key:"saveValue",value:function(r,n){this.rootWindow.localStorage.setItem("".concat(this.prefix,"_").concat(r),JSON.stringify(n)),this.savedKeys.indexOf(r)===-1&&(this.savedKeys.push(r),this.saveSavedKeys())}},{key:"loadValue",value:function(r,n){var o=typeof r>"u"?n:r,i=this.rootWindow.localStorage.getItem("".concat(this.prefix,"_").concat(o));return i===null?void 0:JSON.parse(i)}},{key:"reset",value:function(r){this.rootWindow.localStorage.removeItem("".concat(this.prefix,"_").concat(r))}},{key:"resetAll",value:function(){var r=this;$(this.savedKeys,function(n,o){r.rootWindow.localStorage.removeItem("".concat(r.prefix,"_").concat(r.savedKeys[o]))}),this.clearSavedKeys()}},{key:"loadSavedKeys",value:function(){var r=this.rootWindow.localStorage.getItem("".concat(this.prefix,"__persistentStateKeys")),n=typeof r=="string"?JSON.parse(r):void 0;this.savedKeys=n||[]}},{key:"saveSavedKeys",value:function(){this.rootWindow.localStorage.setItem("".concat(this.prefix,"__persistentStateKeys"),JSON.stringify(this.savedKeys))}},{key:"clearSavedKeys",value:function(){this.savedKeys.length=0,this.saveSavedKeys()}}]),e}();const Jze=Zze;function vf(e){"@babel/helpers - typeof";return vf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vf(e)}function Qze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tYe(n.key),n)}}function eYe(e,t,r){return t&&FL(e.prototype,t),r&&FL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tYe(e){var t=rYe(e,"string");return vf(t)==="symbol"?t:String(t)}function rYe(e,t){if(vf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ta(){return typeof Reflect<"u"&&Reflect.get?Ta=Reflect.get.bind():Ta=function(t,r,n){var o=nYe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ta.apply(this,arguments)}function nYe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=$o(e),e!==null););return e}function oYe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&BR(e,t)}function BR(e,t){return BR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},BR(e,t)}function iYe(e){var t=sYe();return function(){var n=$o(e),o;if(t){var i=$o(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return aYe(this,o)}}function aYe(e,t){if(t&&(vf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lYe(e)}function lYe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sYe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function $o(e){return $o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$o(e)}pe.getSingleton().register("persistentStateSave");pe.getSingleton().register("persistentStateLoad");pe.getSingleton().register("persistentStateReset");var BL="persistentState",uYe=0,fYe=function(e){oYe(r,e);var t=iYe(r);function r(n){var o;return Qze(this,r),o=t.call(this,n),o.storage=void 0,o}return eYe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[BL]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.storage||(this.storage=new Jze(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",function(i,a){return o.saveValue(i,a)}),this.addHook("persistentStateLoad",function(i,a){return o.loadValue(i,a)}),this.addHook("persistentStateReset",function(){return o.resetValue()}),Ta($o(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.storage=void 0,Ta($o(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Ta($o(r.prototype),"updatePlugin",this).call(this)}},{key:"loadValue",value:function(o,i){i.value=this.storage.loadValue(o)}},{key:"saveValue",value:function(o,i){this.storage.saveValue(o,i)}},{key:"resetValue",value:function(o){typeof o>"u"?this.storage.resetAll():this.storage.reset(o)}},{key:"destroy",value:function(){Ta($o(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return BL}},{key:"PLUGIN_PRIORITY",get:function(){return uYe}}]),r}(ot);function yf(e){"@babel/helpers - typeof";return yf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yf(e)}function cYe(e){return yYe(e)||vYe(e)||dYe(e)||hYe()}function hYe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dYe(e,t){if(e){if(typeof e=="string")return VR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return VR(e,t)}}function vYe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function yYe(e){if(Array.isArray(e))return VR(e)}function VR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function gYe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mYe(n.key),n)}}function pYe(e,t,r){return t&&VL(e.prototype,t),r&&VL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mYe(e){var t=bYe(e,"string");return yf(t)==="symbol"?t:String(t)}function bYe(e,t){if(yf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ka(){return typeof Reflect<"u"&&Reflect.get?ka=Reflect.get.bind():ka=function(t,r,n){var o=wYe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ka.apply(this,arguments)}function wYe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ao(e),e!==null););return e}function SYe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&WR(e,t)}function WR(e,t){return WR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},WR(e,t)}function CYe(e){var t=RYe();return function(){var n=Ao(e),o;if(t){var i=Ao(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _Ye(this,o)}}function _Ye(e,t){if(t&&(yf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return OYe(e)}function OYe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function RYe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ao(e){return Ao=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ao(e)}var VS="search",EYe=190,TYe="htSearchResult",kYe=function(t,r,n,o,i){t.getCellMeta(r,n).isSearchResult=i},PYe=function(t,r,n){return gt(t)||t===null||!t.toLocaleLowerCase||t.length===0||gt(r)||r===null?!1:r.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1},$Ye=function(e){SYe(r,e);var t=CYe(r);function r(n){var o;return gYe(this,r),o=t.call(this,n),o.callback=kYe,o.queryMethod=PYe,o.searchResultClass=TYe,o}return pYe(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[VS]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[VS];this.updatePluginSettings(i),this.addHook("beforeRenderer",function(){return o.onBeforeRenderer.apply(o,arguments)}),ka(Ao(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var o=this,i=function(){return o.onBeforeRenderer.apply(o,arguments)};this.hot.addHook("beforeRenderer",i),this.hot.addHookOnce("afterViewRender",function(){o.hot.removeHook("beforeRenderer",i)}),ka(Ao(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ka(Ao(r.prototype),"updatePlugin",this).call(this)}},{key:"query",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod(),s=this.hot.countRows(),u=this.hot.countCols(),f=[],c=this.hot;return _e(0,s-1,function(h){_e(0,u-1,function(d){var v=i.hot.getDataAtCell(h,d),g=i.hot.getCellMeta(h,d),m=g.search.callback||a,w=g.search.queryMethod||l,S=w(o,v,g);if(S){var C={row:h,col:d,data:v};f.push(C)}m&&m(c,h,d,v,S)})}),f}},{key:"getCallback",value:function(){return this.callback}},{key:"setCallback",value:function(o){this.callback=o}},{key:"getQueryMethod",value:function(){return this.queryMethod}},{key:"setQueryMethod",value:function(o){this.queryMethod=o}},{key:"getSearchResultClass",value:function(){return this.searchResultClass}},{key:"setSearchResultClass",value:function(o){this.searchResultClass=o}},{key:"updatePluginSettings",value:function(o){Ve(o)&&(o.searchResultClass&&this.setSearchResultClass(o.searchResultClass),o.queryMethod&&this.setQueryMethod(o.queryMethod),o.callback&&this.setCallback(o.callback))}},{key:"onBeforeRenderer",value:function(o,i,a,l,s,u){var f=u.className||[],c=[];if(typeof f=="string")c=f.split(" ");else{var h;(h=c).push.apply(h,cYe(f))}this.isEnabled()&&u.isSearchResult?c.includes(this.searchResultClass)||c.push("".concat(this.searchResultClass)):c.includes(this.searchResultClass)&&c.splice(c.indexOf(this.searchResultClass),1),u.className=c.join(" ")}},{key:"destroy",value:function(){ka(Ao(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return VS}},{key:"PLUGIN_PRIORITY",get:function(){return EYe}}]),r}(ot);function gf(e){"@babel/helpers - typeof";return gf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gf(e)}function AYe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,MYe(n.key),n)}}function IYe(e,t,r){return t&&WL(e.prototype,t),r&&WL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function MYe(e){var t=xYe(e,"string");return gf(t)==="symbol"?t:String(t)}function xYe(e,t){if(gf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ss(){return typeof Reflect<"u"&&Reflect.get?ss=Reflect.get.bind():ss=function(t,r,n){var o=DYe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ss.apply(this,arguments)}function DYe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ri(e),e!==null););return e}function NYe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&UR(e,t)}function UR(e,t){return UR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},UR(e,t)}function HYe(e){var t=FYe();return function(){var n=Ri(e),o;if(t){var i=Ri(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return LYe(this,o)}}function LYe(e,t){if(t&&(gf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jYe(e)}function jYe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function FYe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ri(e){return Ri=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ri(e)}var BYe="touchScroll",VYe=200,WYe=function(e){NYe(r,e);var t=HYe(r);function r(n){var o;return AYe(this,r),o=t.call(this,n),o.scrollbars=[],o.clones=[],o.lockedCollection=!1,o.freezeOverlays=!1,o}return IYe(r,[{key:"isEnabled",value:function(){return V0()}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterViewRender",function(){return o.onAfterViewRender()}),this.registerEvents(),ss(Ri(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.lockedCollection=!1,ss(Ri(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){ss(Ri(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var o=this;this.addHook("beforeTouchScroll",function(){return o.onBeforeTouchScroll()}),this.addHook("afterMomentumScroll",function(){return o.onAfterMomentumScroll()})}},{key:"onAfterViewRender",value:function(){if(!this.lockedCollection){var o=this.hot.view._wt.wtOverlays,i=o.topOverlay,a=o.bottomOverlay,l=o.inlineStartOverlay,s=o.topInlineStartCornerOverlay,u=o.bottomInlineStartCornerOverlay;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(i),a.clone&&this.scrollbars.push(a),this.scrollbars.push(l),s&&this.scrollbars.push(s),u&&u.clone&&this.scrollbars.push(u),this.clones=[],i.needFullRender&&this.clones.push(i.clone.wtTable.holder.parentNode),a.needFullRender&&this.clones.push(a.clone.wtTable.holder.parentNode),l.needFullRender&&this.clones.push(l.clone.wtTable.holder.parentNode),s&&this.clones.push(s.clone.wtTable.holder.parentNode),u&&u.clone&&this.clones.push(u.clone.wtTable.holder.parentNode)}}},{key:"onBeforeTouchScroll",value:function(){this.freezeOverlays=!0,$(this.clones,function(o){re(o,"hide-tween")})}},{key:"onAfterMomentumScroll",value:function(){var o=this;this.freezeOverlays=!1,$(this.clones,function(i){Le(i,"hide-tween"),re(i,"show-tween")}),this.hot._registerTimeout(function(){$(o.clones,function(i){Le(i,"show-tween")})},400),$(this.scrollbars,function(i){i.refresh(),i.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}}],[{key:"PLUGIN_KEY",get:function(){return BYe}},{key:"PLUGIN_PRIORITY",get:function(){return VYe}},{key:"SETTING_KEYS",get:function(){return!0}}]),r}(ot);function pf(e){"@babel/helpers - typeof";return pf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pf(e)}function UYe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,YYe(n.key),n)}}function zYe(e,t,r){return t&&UL(e.prototype,t),r&&UL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function YYe(e){var t=GYe(e,"string");return pf(t)==="symbol"?t:String(t)}function GYe(e,t){if(pf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Pa(){return typeof Reflect<"u"&&Reflect.get?Pa=Reflect.get.bind():Pa=function(t,r,n){var o=KYe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Pa.apply(this,arguments)}function KYe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Io(e),e!==null););return e}function qYe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zR(e,t)}function zR(e,t){return zR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},zR(e,t)}function XYe(e){var t=QYe();return function(){var n=Io(e),o;if(t){var i=Io(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return ZYe(this,o)}}function ZYe(e,t){if(t&&(pf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return JYe(e)}function JYe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function QYe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Io(e){return Io=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Io(e)}var zy="trimRows",eGe=330,tGe=function(e){qYe(r,e);var t=XYe(r);function r(n){var o;return UYe(this,r),o=t.call(this,n),o.trimmedRowsMap=null,o}return zYe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[zy]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Ev),this.trimmedRowsMap.addLocalHook("init",function(){return o.onMapInit()}),Pa(Io(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){var o=this,i=this.hot.getSettings()[zy];Array.isArray(i)&&this.hot.batchExecution(function(){o.trimmedRowsMap.clear(),$(i,function(a){o.trimmedRowsMap.setValueAtIndex(a,!0)})},!0),Pa(Io(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("trimRows"),Pa(Io(r.prototype),"disablePlugin",this).call(this)}},{key:"getTrimmedRows",value:function(){return this.trimmedRowsMap.getTrimmedIndexes()}},{key:"trimRows",value:function(o){var i=this,a=this.getTrimmedRows(),l=this.isValidConfig(o),s=a;l&&(s=Array.from(new Set(a.concat(o))));var u=this.hot.runHooks("beforeTrimRow",a,s,l);u!==!1&&(l&&this.hot.batchExecution(function(){$(o,function(f){i.trimmedRowsMap.setValueAtIndex(f,!0)})},!0),this.hot.runHooks("afterTrimRow",a,s,l,l&&s.length>a.length))}},{key:"trimRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.trimRows(i)}},{key:"untrimRows",value:function(o){var i=this.getTrimmedRows(),a=this.isValidConfig(o),l=i,s=this.trimmedRowsMap.getValues().slice(),u=o.length>0;a&&u&&($(o,function(c){s[c]=!1}),l=Lt(s,function(c,h,d){return h&&c.push(d),c},[]));var f=this.hot.runHooks("beforeUntrimRow",i,l,a&&u);f!==!1&&(a&&u&&this.trimmedRowsMap.setValues(s),this.hot.runHooks("afterUntrimRow",i,l,a&&u,a&&l.length<i.length))}},{key:"untrimRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.untrimRows(i)}},{key:"isTrimmed",value:function(o){return this.trimmedRowsMap.getValueAtIndex(o)||!1}},{key:"untrimAll",value:function(){this.untrimRows(this.getTrimmedRows())}},{key:"isValidConfig",value:function(o){var i=this.hot.countSourceRows();return o.every(function(a){return Number.isInteger(a)&&a>=0&&a<i})}},{key:"onMapInit",value:function(){var o=this,i=this.hot.getSettings()[zy];Array.isArray(i)&&this.hot.batchExecution(function(){$(i,function(a){o.trimmedRowsMap.setValueAtIndex(a,!0)})},!0)}},{key:"destroy",value:function(){Pa(Io(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return zy}},{key:"PLUGIN_PRIORITY",get:function(){return eGe}}]),r}(ot);function mf(e){"@babel/helpers - typeof";return mf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mf(e)}function oY(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rGe(n.key),n)}}function iY(e,t,r){return t&&zL(e.prototype,t),r&&zL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rGe(e){var t=nGe(e,"string");return mf(t)==="symbol"?t:String(t)}function nGe(e,t){if(mf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(mf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function aY(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&YR(e,t)}function YR(e,t){return YR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},YR(e,t)}function lY(e){var t=aGe();return function(){var n=qp(e),o;if(t){var i=qp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return oGe(this,o)}}function oGe(e,t){if(t&&(mf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return iGe(e)}function iGe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function aGe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function qp(e){return qp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},qp(e)}function lGe(e){return fGe(e)||uGe(e)||uY(e)||sGe()}function sGe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uGe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function fGe(e){if(Array.isArray(e))return GR(e)}function sY(e,t){return dGe(e)||hGe(e,t)||uY(e,t)||cGe()}function cGe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uY(e,t){if(e){if(typeof e=="string")return GR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return GR(e,t)}}function GR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function hGe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function dGe(e){if(Array.isArray(e))return e}var fY="undoRedo",vGe="undoRedo";function ye(e){var t=this;this.instance=e,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,e.addHook("afterChange",function(r,n){var o=this,i=r&&r.length;if(i){var a=r.find(function(s){var u=sY(s,4),f=u[2],c=u[3];return f!==c});if(a){var l=function(){var u=r.reduce(function(c,h){return c.push(lGe(h)),c},[]);$(u,function(c){c[1]=e.propToCol(c[1])});var f=i>1?o.getSelected():[[u[0][0],u[0][1]]];return new ye.ChangeAction(u,f)};t.done(l,n)}}}),e.addHook("afterCreateRow",function(r,n,o){t.done(function(){return new ye.CreateRowAction(r,n)},o)}),e.addHook("beforeRemoveRow",function(r,n,o,i){var a=function(){var s=e.toPhysicalRow(r),u=lr(t.instance.getSourceData(s,0,s+n-1,t.instance.countSourceCols()-1));return new ye.RemoveRowAction(s,u,e.getSettings().fixedRowsBottom,e.getSettings().fixedRowsTop,e.rowIndexMapper.getIndexesSequence())};t.done(a,i)}),e.addHook("afterCreateCol",function(r,n,o){t.done(function(){return new ye.CreateColumnAction(r,n)},o)}),e.addHook("beforeRemoveCol",function(r,n,o,i){var a=function(){var s=t.instance.getSourceDataArray(),u=(t.instance.countCols()+r)%t.instance.countCols(),f=[],c=[],h=[];_e(s.length-1,function(g){var m=[],w=s[g];_e(u,u+(n-1),function(S){m.push(w[e.toPhysicalColumn(S)])}),f.push(m)}),_e(n-1,function(g){h.push(e.toPhysicalColumn(u+g))}),Array.isArray(e.getSettings().colHeaders)&&_e(n-1,function(g){c.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+g)]||null)});var d=e.columnIndexMapper.getIndexesSequence(),v=e.rowIndexMapper.getIndexesSequence();return new ye.RemoveColumnAction(u,h,f,c,d,v,e.getSettings().fixedColumnsStart)};t.done(a,i)}),e.addHook("beforeCellAlignment",function(r,n,o,i){t.done(function(){return new ye.CellAlignmentAction(r,n,o,i)})}),e.addHook("beforeFilter",function(r){t.done(function(){return new ye.FiltersAction(r)})}),e.addHook("beforeRowMove",function(r,n){r!==!1&&t.done(function(){return new ye.RowMoveAction(r,n)})}),e.addHook("beforeMergeCells",function(r,n){n||t.done(function(){return new ye.MergeCellsAction(e,r)})}),e.addHook("afterUnmergeCells",function(r,n){n||t.done(function(){return new ye.UnmergeCellsAction(e,r)})}),e.addHook("afterInit",function(){t.init()})}ye.prototype.done=function(e,t){if(!this.ignoreNewActions){var r=t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";if(!r){var n=this.doneActions.slice(),o=this.instance.runHooks("beforeUndoStackChange",n,t);if(o!==!1){var i=e(),a=this.undoneActions.slice();this.doneActions.push(i),this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}}}};ye.prototype.undo=function(){if(this.isUndoAvailable()){var e=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",e);var t=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",e,this.doneActions.slice());var r=lr(t),n=this.instance.runHooks("beforeUndo",r);if(n===!1)return;this.ignoreNewActions=!0;var o=this,i=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",i),t.undo(this.instance,function(){o.ignoreNewActions=!1,o.undoneActions.push(t)}),this.instance.runHooks("afterRedoStackChange",i,this.undoneActions.slice()),this.instance.runHooks("afterUndo",r)}};ye.prototype.redo=function(){if(this.isRedoAvailable()){var e=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",e);var t=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",e,this.undoneActions.slice());var r=lr(t),n=this.instance.runHooks("beforeRedo",r);if(n===!1)return;this.ignoreNewActions=!0;var o=this,i=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",i),t.redo(this.instance,function(){o.ignoreNewActions=!1,o.doneActions.push(t)}),this.instance.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.instance.runHooks("afterRedo",r)}};ye.prototype.isUndoAvailable=function(){return this.doneActions.length>0};ye.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};ye.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};ye.prototype.isEnabled=function(){return this.enabled};ye.prototype.enable=function(){if(!this.isEnabled()){var e=this.instance;this.enabled=!0,pGe(e),this.registerShortcuts(),e.addHook("afterChange",cY)}};ye.prototype.disable=function(){if(this.isEnabled()){var e=this.instance;this.enabled=!1,mGe(e),this.unregisterShortcuts(),e.removeHook("afterChange",cY)}};ye.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};ye.Action=function(){};ye.Action.prototype.undo=function(){};ye.Action.prototype.redo=function(){};ye.ChangeAction=function(e,t){this.changes=e,this.selected=t,this.actionType="change"};Bo(ye.ChangeAction,ye.Action);ye.ChangeAction.prototype.undo=function(e,t){for(var r=lr(this.changes),n=e.countEmptyRows(!0),o=e.countEmptyCols(!0),i=0,a=r.length;i<a;i++)r[i].splice(3,1);e.addHookOnce("afterChange",t),e.setDataAtCell(r,null,null,"UndoRedo.undo");for(var l=0,s=r.length;l<s;l++){var u=sY(r[l],2),f=u[0],c=u[1];e.getSettings().minSpareRows&&f+1+e.getSettings().minSpareRows===e.countRows()&&n===e.getSettings().minSpareRows&&(e.alter("remove_row",parseInt(f+1,10),e.getSettings().minSpareRows),e.undoRedo.doneActions.pop()),e.getSettings().minSpareCols&&c+1+e.getSettings().minSpareCols===e.countCols()&&o===e.getSettings().minSpareCols&&(e.alter("remove_col",parseInt(c+1,10),e.getSettings().minSpareCols),e.undoRedo.doneActions.pop())}e.selectCells(this.selected,!1,!1)};ye.ChangeAction.prototype.redo=function(e,t){for(var r=lr(this.changes),n=0,o=r.length;n<o;n++)r[n].splice(2,1);e.addHookOnce("afterChange",t),e.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)};ye.CreateRowAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_row"};Bo(ye.CreateRowAction,ye.Action);ye.CreateRowAction.prototype.undo=function(e,t){var r=e.countRows(),n=e.getSettings().minSpareRows;this.index>=r&&this.index-n<r&&(this.index-=n),e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};ye.CreateRowAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};ye.RemoveRowAction=function(e,t,r,n,o){this.index=e,this.data=t,this.actionType="remove_row",this.fixedRowsBottom=r,this.fixedRowsTop=n,this.rowIndexesSequence=o};Bo(ye.RemoveRowAction,ye.Action);ye.RemoveRowAction.prototype.undo=function(e,t){var r=this,n=e.getSettings(),o=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach(function(i,a){Object.keys(i).forEach(function(l){var s=parseInt(l,10);o.push([r.index+a,isNaN(s)?l:s,i[l]])})}),e.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),e.addHookOnce("afterViewRender",t),e.setSourceDataAtCell(o,null,null,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};ye.RemoveRowAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};ye.CreateColumnAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_col"};Bo(ye.CreateColumnAction,ye.Action);ye.CreateColumnAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};ye.CreateColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};ye.RemoveColumnAction=function(e,t,r,n,o,i,a){this.index=e,this.indexes=t,this.data=r,this.amount=this.data[0].length,this.headers=n,this.columnPositions=o.slice(0),this.rowPositions=i.slice(0),this.actionType="remove_col",this.fixedColumnsStart=a};Bo(ye.RemoveColumnAction,ye.Action);ye.RemoveColumnAction.prototype.undo=function(e,t){var r=this,n=e.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;for(var o=this.indexes.slice(0).sort(),i=function(h,d,v){return v[r.indexes.indexOf(o[d])]},a=this.data.length,l=[],s=0;s<a;s++)l.push(Be(this.data[s],i));var u=Be(this.headers,i),f=[];e.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),$(e.getSourceDataArray(),function(c,h){$(o,function(d,v){c[d]=l[h][v],f.push([h,d,c[d]])})}),e.setSourceDataAtCell(f,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&$(u,function(c,h){e.getSettings().colHeaders[o[h]]=c}),e.batchExecution(function(){e.rowIndexMapper.setIndexesSequence(r.rowPositions),e.columnIndexMapper.setIndexesSequence(r.columnPositions)},!0),e.addHookOnce("afterViewRender",t),e.render()};ye.RemoveColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};ye.CellAlignmentAction=function(e,t,r,n){this.stateBefore=e,this.range=t,this.type=r,this.alignment=n};ye.CellAlignmentAction.prototype.undo=function(e,t){var r=this;$(this.range,function(n){n.forAll(function(o,i){o>=0&&i>=0&&e.setCellMeta(o,i,"className",r.stateBefore[o][i]||" htLeft")})}),e.addHookOnce("afterViewRender",t),e.render()};ye.CellAlignmentAction.prototype.redo=function(e,t){oi(this.range,this.type,this.alignment,function(r,n){return e.getCellMeta(r,n)},function(r,n,o,i){return e.setCellMeta(r,n,o,i)}),e.addHookOnce("afterViewRender",t),e.render()};ye.FiltersAction=function(e){this.conditionsStack=e,this.actionType="filter"};Bo(ye.FiltersAction,ye.Action);ye.FiltersAction.prototype.undo=function(e,t){var r=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),r.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),r.filter()};ye.FiltersAction.prototype.redo=function(e,t){var r=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),r.conditionCollection.importAllConditions(this.conditionsStack),r.filter()};var yGe=function(e){aY(r,e);var t=lY(r);function r(n,o){var i;oY(this,r),i=t.call(this),i.cellRange=o;var a=i.cellRange.getTopStartCorner(),l=i.cellRange.getBottomEndCorner();return i.rangeData=n.getData(a.row,a.col,l.row,l.col),i}return iY(r,[{key:"undo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.unmergeRange(this.cellRange,!0);var l=this.cellRange.getTopStartCorner();o.populateFromArray(l.row,l.col,this.rangeData,void 0,void 0,"MergeCells")}},{key:"redo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.mergeRange(this.cellRange)}}]),r}(ye.Action);ye.MergeCellsAction=yGe;var gGe=function(e){aY(r,e);var t=lY(r);function r(n,o){var i;return oY(this,r),i=t.call(this),i.cellRange=o,i}return iY(r,[{key:"undo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.mergeRange(this.cellRange,!0)}},{key:"redo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.unmergeRange(this.cellRange,!0),o.render()}}]),r}(ye.Action);ye.UnmergeCellsAction=gGe;ye.RowMoveAction=function(e,t){this.rows=e.slice(),this.finalIndex=t,this.actionType="row_move"};Bo(ye.RowMoveAction,ye.Action);ye.RowMoveAction.prototype.undo=function(e,t){var r=this,n=e.getPlugin("manualRowMove"),o=[].concat(this.rows),i=o.filter(function(f){return f>r.finalIndex}),a=o.filter(function(f){return f<=r.finalIndex}),l=i.sort(function(f,c){return c-f}).concat(a.sort(function(f,c){return f-c}));e.addHookOnce("afterViewRender",t);for(var s=0;s<l.length;s+=1){var u=e.toVisualRow(l[s]);n.moveRow(u,l[s])}e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};ye.RowMoveAction.prototype.redo=function(e,t){var r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",t),r.moveRows(this.rows.slice(),this.finalIndex),e.render(),e.deselectCell(),e.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)};ye.prototype.init=function(){var e=this.instance.getSettings().undo,t=typeof e>"u"||e;this.instance.undoRedo||(this.instance.undoRedo=this),t?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};ye.prototype.registerShortcuts=function(){var e=this,t=this.instance.getShortcutManager(),r=t.getContext("grid"),n=function(a){return!a.altKey},o={runOnlyIf:n,group:fY};r.addShortcuts([{keys:[["Control/Meta","z"]],callback:function(){e.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:function(){e.redo()}}],o)};ye.prototype.unregisterShortcuts=function(){var e=this.instance.getShortcutManager(),t=e.getContext("grid");t.removeShortcutsByGroup(fY)};function cY(e,t){var r=this;if(t==="loadData")return r.undoRedo.clear()}function pGe(e){e.undo=function(){return e.undoRedo.undo()},e.redo=function(){return e.undoRedo.redo()},e.isUndoAvailable=function(){return e.undoRedo.isUndoAvailable()},e.isRedoAvailable=function(){return e.undoRedo.isRedoAvailable()},e.clearUndo=function(){return e.undoRedo.clear()}}function mGe(e){delete e.undo,delete e.redo,delete e.isUndoAvailable,delete e.isRedoAvailable,delete e.clearUndo}var Dv=pe.getSingleton();Dv.add("afterUpdateSettings",function(){var e;(e=this.getPlugin("undoRedo"))===null||e===void 0||e.init()});Dv.register("beforeUndo");Dv.register("afterUndo");Dv.register("beforeRedo");Dv.register("afterRedo");ye.PLUGIN_KEY=vGe;ye.SETTING_KEYS=!0;function bGe(){et(sEe),et(MEe),et(ZEe),et(UTe),et(uke),et(CU),et(DPe),et(v$e),et(NU),et(yAe),et(VAe),et(QAe),et(KU),et(nMe),et(eLe),et(eje),et(Rje),et(Xje),et(bFe),et(lBe),et(mBe),et(aVe),et(pVe),et(y2e),et(N2e),et(q2e),et(_Ue),et(Yze),et(fYe),et($Ye),et(WYe),et(tGe),et(ye)}function hY(){SRe(),NRe(),JRe(),y0e(),bGe()}function wGe(e){var t=typeof window>"u"?!1:window.jQuery;t&&(t.fn.handsontable=function(r){var n=this.first(),o=n.data("handsontable");if(typeof r!="string"){var i=r||{};return o?o.updateSettings(i):(o=new e.Core(n[0],i),n.data("handsontable",o),o.init()),n}var a;if(o)if(typeof o[r]<"u"){for(var l,s=arguments.length,u=new Array(s>1?s-1:0),f=1;f<s;f++)u[f-1]=arguments[f];a=(l=o[r]).call.apply(l,[o].concat(u)),r==="destroy"&&n.removeData()}else throw new Error("Handsontable do not provide action: ".concat(r));return a})}var WS,US,zS,YS,GS;hY();wGe(Te);Te.__GhostTable=Ik;Te._getListenersCounter=cle;Te._getRegisteredMapsCounter=ime;Te.EventManager=Tt;var SGe=[Xee,nte,Oge,YRe,dee,mae,tae,bse,Qee,nae,Vae,dse],CGe=[vae,Wae];Te.helper={};Te.dom={};$(SGe,function(e){$(Object.getOwnPropertyNames(e),function(t){t.charAt(0)!=="_"&&(Te.helper[t]=e[t])})});$(CGe,function(e){$(Object.getOwnPropertyNames(e),function(t){t.charAt(0)!=="_"&&(Te.dom[t]=e[t])})});Te.cellTypes=(WS=Te.cellTypes)!==null&&WS!==void 0?WS:{};$(MSe(),function(e){Te.cellTypes[e]=mk(e)});Te.cellTypes.registerCellType=an;Te.cellTypes.getCellType=mk;Te.editors=(US=Te.editors)!==null&&US!==void 0?US:{};$(nle(),function(e){Te.editors["".concat(ar(e),"Editor")]=Xg(e)});Te.editors.registerEditor=Or;Te.editors.getEditor=Xg;Te.renderers=(zS=Te.renderers)!==null&&zS!==void 0?zS:{};$(fue(),function(e){var t=Jg(e);e==="base"&&(Te.renderers.cellDecorator=t),Te.renderers["".concat(ar(e),"Renderer")]=t});Te.renderers.registerRenderer=In;Te.renderers.getRenderer=Jg;Te.validators=(YS=Te.validators)!==null&&YS!==void 0?YS:{};$(due(),function(e){Te.validators["".concat(ar(e),"Validator")]=kE(e)});Te.validators.registerValidator=Gl;Te.validators.getValidator=kE;Te.plugins=(GS=Te.plugins)!==null&&GS!==void 0?GS:{};$(TE(),function(e){Te.plugins[e]=Sv(e)});Te.plugins["".concat(ar(ot.PLUGIN_KEY),"Plugin")]=ot;Te.plugins.registerPlugin=et;Te.plugins.getPlugin=Sv;var us=Symbol("unassigned"),_Ge="The Handsontable instance bound to this component was destroyed and cannot be used properly.";function Xp(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function dY(e){var t=Te.hooks.getRegistered(),r={};Object.assign(r,Te.DefaultSettings);for(var n in r)r[n]={default:us};for(var o=0;o<t.length;o++)r[t[o]]={default:us};return r.settings={default:us},e==="HotTable"&&(r.id={type:String,default:"hot-".concat(Math.random().toString(36).substring(5))}),r}function vY(e){var t={},r=e.settings;if(r!==us)for(var n in r)Xp(r,n)&&r[n]!==us&&(t[n]=r[n]);for(var o in e)Xp(e,o)&&o!=="settings"&&e[o]!==us&&(t[o]=e[o]);return t}function YL(e,t){var r=vY(e),n=e.settings?e.settings:r,o=e.settings?r:null,i={};for(var a in n)Xp(n,a)&&n[a]!==void 0&&(!(t&&a!=="data")||!GL(t[a],n[a]))&&(i[a]=n[a]);for(var l in o)Xp(o,l)&&l!=="id"&&l!=="settings"&&o[l]!==void 0&&(!(t&&l!=="data")||!GL(t[l],o[l]))&&(i[l]=o[l]);return i}function GL(e,t){return JSON.stringify(e)===JSON.stringify(t)}var OGe="12.4.0",Yk=KR({name:"HotTable",props:dY("HotTable"),provide:function(){return{columnsCache:this.columnsCache}},watch:{$props:{handler:function(t){var r=YL(t,this.hotInstance?this.hotInstance.getSettings():void 0);!this.hotInstance||r===void 0||(r.data&&(this.hotInstance.isColumnModificationAllowed()||!this.hotInstance.isColumnModificationAllowed()&&this.hotInstance.countSourceCols()===this.miscCache.currentSourceColumns)&&(this.matchHotMappersSize(),delete r.data),Object.keys(r).length?this.hotInstance.updateSettings(r):this.hotInstance.render(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols())},deep:!0,immediate:!0}},data:function(){return{__hotInstance:null,miscCache:{currentSourceColumns:null},columnSettings:null,columnsCache:new Map,get hotInstance(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(_Ge),null)},set hotInstance(t){this.__hotInstance=t}}},methods:{hotInit:function(){var t=YL(this.$props);t.columns=this.columnSettings?this.columnSettings:t.columns,this.hotInstance=bY(new Te.Core(this.$el,t)),this.hotInstance.init(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols()},matchHotMappersSize:function(){var t=this;if(this.hotInstance){var r=this.hotInstance.getSourceData(),n=[],o=[],i=this.hotInstance.rowIndexMapper.getNumberOfIndexes(),a=this.hotInstance.isColumnModificationAllowed(),l=0;if(r&&r.length!==i&&r.length<i)for(var s=r.length;s<i;s++)n.push(s);if(a){var u;if(l=this.hotInstance.columnIndexMapper.getNumberOfIndexes(),r&&r[0]&&((u=r[0])===null||u===void 0?void 0:u.length)!==l&&r[0].length<l)for(var f=r[0].length;f<l;f++)o.push(f)}this.hotInstance.batch(function(){n.length>0?t.hotInstance.rowIndexMapper.removeIndexes(n):t.hotInstance.rowIndexMapper.insertIndexes(i-1,r.length-i),a&&r.length!==0&&(o.length>0?t.hotInstance.columnIndexMapper.removeIndexes(o):t.hotInstance.columnIndexMapper.insertIndexes(l-1,r[0].length-l))})}},getColumnSettings:function(){var t=Array.from(this.columnsCache.values());return t.length?t:void 0}},mounted:function(){this.columnSettings=this.getColumnSettings(),this.hotInit()},beforeUnmount:function(){this.hotInstance&&this.hotInstance.destroy()},version:OGe}),RGe=["id"];function EGe(e,t,r,n,o,i){return ri(),jl("div",{id:e.id},[wY(e.$slots,"default")],8,RGe)}Yk.render=EGe;Yk.__file="src/HotTable.vue";function KL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function TGe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?KL(Object(r),!0).forEach(function(n){kGe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):KL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function kGe(e,t,r){return t=$Ge(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function PGe(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $Ge(e){var t=PGe(e,"string");return typeof t=="symbol"?t:String(t)}var AGe=KR({name:"HotColumn",props:dY("HotColumn"),inject:["columnsCache"],methods:{createColumnSettings:function(){var t=vY(this.$props),r=TGe({},t);t.renderer&&(r.renderer=t.renderer),t.editor&&(r.editor=t.editor),this.columnsCache.set(this,r)}},mounted:function(){this.createColumnSettings()},unmounted:function(){this.columnsCache.delete(this)},render:function(){return null}});AGe.__file="src/HotColumn.vue";const IGe=(e,t)=>RY.filter(e,t);hY();const MGe=KR({props:{table_data:{type:Array,required:!1},table_id:{type:String,required:!1},encoded:{type:String,required:!1},schema:{type:Array,required:!1,default:void 0},script:{type:String,required:!1},columns:{type:Array,required:!1,default:()=>[]},search:{type:String,required:!1,default:""}},data(){return{key:0,errors:{},noData:!1,error:{},dataBeforeChanges:[],meta:{page:1,page_size:100,total_entries:0},json:{},showModal:!1,title:"Table Data",tableName:""}},computed:{hotSettings(){return{data:this.searchResults,colHeaders:this.colHeaders,columns:this.computedColumns,manualColumnMove:[],rowHeights:30,manualColumnResize:!0,manualRowResize:!0,rowHeaders:!0,filters:!0,dropdownMenu:!1,contextMenu:!0,licenseKey:"non-commercial-and-evaluation",width:"100%",height:"auto",stretchH:"all",columnSorting:!0,customBorders:!1,stretchW:"all",autoWrapRow:!0,autoWrapCol:!0,wordWrap:!0,trimRows:!0,className:"handsontable",bindRowsWithHeaders:!0,outsideClickDeselects:!1,minSpareRows:0,minSpareCols:0,hiddenColumns:!0,hiddenRows:!0,maxSpareRows:0,maxSpareCols:0,afterChange:(e,t)=>{if(!(t==="loadData"||t==="internal"||!e)){const r=e[0][0],n=this.hotSettings.data[r],o=e[0][1],i=e[0][3],a=n.id;eP(a,{action:"update",type:"data",body:{id:a,schema:[{key:o,value:i}]}}).then(s=>{console.log("table data updated",s)})}}}},colHeaders(){return this.dataBeforeChanges===void 0||this.dataBeforeChanges.length===0?[]:Object.keys(this.dataBeforeChanges[0])},searchResults(){if(this.search==="")return this.dataBeforeChanges;{let e=IGe(this.dataBeforeChanges.map(t=>Object.keys(t).map(r=>t[r]).join("-")),this.search);return this.dataBeforeChanges.filter(t=>e.includes(Object.keys(t).map(r=>t[r]).join("-")))}},computedColumns(){return this.dataBeforeChanges===void 0||this.dataBeforeChanges.length===0?[]:Object.keys(this.dataBeforeChanges[0]).map(e=>e==="selection"?{data:e,type:"checkbox"}:e==="id"?{data:e,readOnly:!0,renderer:this.idRenderer,align:"center",verticalAlignment:"middle",startRow:0,startCol:0}:e==="inserted_at"||e==="updated_at"||e==="last_active"?{data:e,type:"date",readOnly:!0,dateFormat:"YYYY-MM-DD",correctFormat:!0,defaultDate:"1900-01-01",datePickerConfig:{firstDay:1,showWeekNumber:!0,numberOfMonths:1,disableDayFn:function(t){return t.getDay()===0}}}:e==="deleted_at"||e==="archived_at"?{data:e,type:"date",readOnly:!1,dateFormat:"YYYY-MM-DDTHH:mm:ss",correctFormat:!0,defaultDate:"1900-01-01",datePickerConfig:{firstDay:1,showWeekNumber:!0,numberOfMonths:3,disableDayFn:function(t){return t.getDay()===0}}}:e==="avatar_url"?{data:e,renderer:this.avatarRenderer}:e==="headers"||e==="response"||e==="body"||e==="query"||e==="params"||e==="permissions"?{data:e,renderer:this.customRenderer}:e==="delete"?{data:e,renderer:this.deleteRenderer,readOnly:!0}:{data:e,renderer:this.objectRenderer})},total_pages(){return this.meta.total_pages},page(){return this.meta.page},page_size(){return this.meta.page_size}},components:{HotTable:Yk,JsonModal:CY},methods:{customRenderer(e,t,r,n,o,i){Te.dom.empty(t);const a=document.createElement("button");return a.textContent="View...",a.className="bg-rock-blue-500 hover:bg-rock-blue-700 text-pickled-700 font-bold py-1 px-2 text-xs w-full rounded dark:bg-pickled-700 dark:hover:bg-pickled-600 dark:text-rock-blue-600",t.appendChild(a),a.addEventListener("click",()=>{this.openJsonModal(i,o)}),t},objectRenderer(e,t,r,n,o,i){if(typeof i=="object"){Te.dom.empty(t);const a=document.createElement("button");a.textContent="View...",a.className="bg-rock-blue-500 hover:bg-rock-blue-700 text-pickled-700 font-bold py-1 px-2 text-xs w-full rounded dark:bg-pickled-700 dark:hover:bg-pickled-600 dark:text-rock-blue-600",t.appendChild(a),a.addEventListener("click",()=>{this.openJsonModal(i,o)})}else Te.renderers.TextRenderer.apply(this,arguments);return t},idRenderer(e,t,r,n,o,i){Te.dom.empty(t);const a=document.createElement("button");return a.textContent=`${i}`,a.className="bg-surf-500 hover:bg-surf-600 text-pickled-600 font-bold py-1 px-4 w-full text-xs rounded-full dark:bg-pickled-700 dark:hover:bg-pickled-600 dark:text-rock-blue-600",t.appendChild(a),a.addEventListener("click",()=>{this.goToRecord(i)}),t},avatarRenderer(e,t,r,n,o,i){Te.dom.empty(t);const a=document.createElement("img");return i===null&&(i="https://gravatar.com/avatar/"),a.src=i,a.className="h-6 w-6 rounded-full object-cover center",t.appendChild(a),t},deleteRenderer(e,t,r,n,o,i){if(i!="base"){Te.dom.empty(t);const a=document.createElement("button");a.textContent="Delete",a.className="bg-surf-500 hover:bg-surf-600 text-pickled-600 font-bold py-1 px-4 w-full text-xs rounded-full dark:bg-pickled-700 dark:hover:bg-pickled-600 dark:text-rock-blue-600",t.appendChild(a),a.addEventListener("click",()=>{console.log(e),this.deleteTable(i)})}else{Te.dom.empty(t);const a=document.createElement("button");a.textContent="Base Table",a.setAttribute("disabled","true"),a.className="disabled bg-surf-500 text-pickled-600 font-bold py-1 px-4 w-full text-xs rounded-full dark:bg-pickled-700  dark:text-rock-blue-600",t.appendChild(a),a.addEventListener("click",()=>{})}},openJsonModal(e,t){this.json=e,this.title=t,this.showModal=!0},updateTableData(e,t){eP(e,t).then(r=>{console.log("table data updated",r)})},reorderColumns(e){const t=e,r=[0],n=1,o=this.hotSettings.manualColumnMove.splice(r[0],t.length);return this.hotSettings.manualColumnMove.splice(n,0,...o),this.hotSettings.manualColumnMove},deleteTable(e){_Y({action:"delete",type:"structure",body:{id:e}}).then(()=>{this.key+=1})},getTable(){if(!this.table_data||this.table_data.length===0){this.noData=!0,this.hotSettings.data=[];const e={id:this.table_id,encoded:this.encoded,schema:this.schema,script:this.script,page:this.meta.page,page_size:this.meta.page_size};OY(e).then(t=>{if(this.tableName=t.name,t.data&&t.data.length===0)this.setNoDataMessage();else{this.meta.page=t.meta.page_number,this.meta.page_size=t.meta.page_size,this.meta.total_entries=t.meta.total_entries,this.meta.total_pages=t.meta.total_pages,this.hotSettings.colHeaders=Object.keys(t.data[0]),this.hotSettings.columns=[...this.computedColumns];const r=t.data;this.dataBeforeChanges=[],r.forEach(n=>{const o=n;this.dataBeforeChanges.push(o)}),this.noData=!1}})}else{this.dataBeforeChanges=[],this.dataBeforeChanges=this.table_data,this.hotSettings.colHeaders=Object.keys(this.table_data[0]),this.hotSettings.columns=[...this.computedColumns];const e=this.table_data;this.dataBeforeChanges=[],e.forEach(t=>{const r=t;this.dataBeforeChanges.push(r)}),this.noData=!1}},goToRecord(e){this.$router.currentRoute.value.name==="Tables"?this.$router.push({name:"Table",params:{id:e}}):this.$router.push({name:"Record",params:{id:e}})},setNoDataMessage(){tP().$patch({message:"No data found",error:"No data found",status:404})}},mounted(){this.getTable(),tP().$subscribe(t=>{this.error=t.payload})},watch:{table_data:function(){this.key+=1},searchResults:function(){this.key+=1},page:{handler:function(e){this.meta.page=e,this.getTable()},deep:!0},page_size:{handler:function(e){this.meta.page_size=e,this.getTable()},deep:!0},total_pages:{handler:function(e){this.meta.total_pages=e,this.getTable()},deep:!0}}}),xGe={key:2,role:"status",class:"max-w-screen mx-5 mb-5 p-4 mt-10 space-y-4 border border-gray-200 divide-y divide-gray-200 rounded shadow animate-pulse dark:divide-gray-700 md:p-6 dark:border-gray-700"},DGe=EY('<div class="flex items-center justify-between"><div><div class="h-2.5 bg-gray-300 rounded-full dark:bg-gray-600 w-24 mb-2.5"></div><div class="w-32 h-2 bg-gray-200 rounded-full dark:bg-gray-700"></div></div><div class="h-2.5 bg-gray-300 rounded-full dark:bg-gray-700 w-12"></div></div><div class="flex items-center justify-between pt-4"><div><div class="h-2.5 bg-gray-300 rounded-full dark:bg-gray-600 w-24 mb-2.5"></div><div class="w-32 h-2 bg-gray-200 rounded-full dark:bg-gray-700"></div></div><div class="h-2.5 bg-gray-300 rounded-full dark:bg-gray-700 w-12"></div></div><div class="flex items-center justify-between pt-4"><div><div class="h-2.5 bg-gray-300 rounded-full dark:bg-gray-600 w-24 mb-2.5"></div><div class="w-32 h-2 bg-gray-200 rounded-full dark:bg-gray-700"></div></div><div class="h-2.5 bg-gray-300 rounded-full dark:bg-gray-700 w-12"></div></div><div class="flex items-center justify-between pt-4"><div><div class="h-2.5 bg-gray-300 rounded-full dark:bg-gray-600 w-24 mb-2.5"></div><div class="w-32 h-2 bg-gray-200 rounded-full dark:bg-gray-700"></div></div><div class="h-2.5 bg-gray-300 rounded-full dark:bg-gray-700 w-12"></div></div><div class="flex items-center justify-between pt-4"><div><div class="h-2.5 bg-gray-300 rounded-full dark:bg-gray-600 w-24 mb-2.5"></div><div class="w-32 h-2 bg-gray-200 rounded-full dark:bg-gray-700"></div></div><div class="h-2.5 bg-gray-300 rounded-full dark:bg-gray-700 w-12"></div></div><span class="sr-only">Loading...</span>',6),NGe=[DGe],HGe={key:3,class:"flex flex-col items-start ml-5 mb-5"},LGe={class:"text-sm text-gray-700 dark:text-gray-400"},jGe={class:"font-semibold text-gray-900 dark:text-white"},FGe=Yr("span",{class:"font-semibold text-gray-900 dark:text-white"}," of ",-1),BGe={class:"font-semibold text-gray-900 dark:text-white"},VGe={class:"font-semibold text-gray-900 dark:text-white"},WGe={class:"font-semibold text-gray-900 dark:text-white"},UGe={class:"flex items-center space-x-2 mt-3"},zGe={class:"text-sm text-gray-700 dark:text-gray-400"},YGe={class:"font-semibold text-gray-900 dark:text-white"},GGe={class:"text-sm text-gray-700 dark:text-gray-400"};function KGe(e,t,r,n,o,i){const a=rP("hot-table"),l=rP("JsonModal");return ri(),jl("div",null,[e.noData?ul("",!0):(ri(),nP(a,{key:e.key,ref:"hotTableComponent",id:"data-sheet","data-theme":"dark",settings:e.hotSettings,class:"hansontable m-5 table-width-less-aside"},null,8,["settings"])),e.showModal?(ri(),nP(l,{key:1,json:e.json,isActive:e.showModal,title:e.title,onClose:t[0]||(t[0]=s=>e.showModal=!1),class:"z-50 fixed inset-0 overflow-scroll"},null,8,["json","isActive","title"])):ul("",!0),e.noData?(ri(),jl("div",xGe,NGe)):ul("",!0),e.$router.currentRoute.value.name!=="Tables"?(ri(),jl("div",HGe,[Yr("span",LGe,[Ni(" Showing page "),Yr("span",jGe,xf(e.meta.page),1),FGe,Yr("span",BGe,xf(e.meta.total_pages),1),Ni(" with "),Yr("span",VGe,xf(e.meta.page_size),1),Ni(" of "),Yr("span",WGe,xf(e.meta.total_entries),1),Ni(" records ")]),Yr("div",UGe,[e.meta.page>1?(ri(),jl("button",{key:0,onClick:t[1]||(t[1]=s=>{e.meta.page-=1,e.getTable()}),class:"bg-rock-blue-500 hover:bg-rock-blue-700 text-pickled-700 font-bold py-1 px-2 text-xs rounded"}," Previous ")):ul("",!0),e.meta.page<e.meta.total_pages?(ri(),jl("button",{key:1,onClick:t[2]||(t[2]=s=>{e.meta.page+=1,e.getTable()}),class:"bg-rock-blue-500 hover:bg-rock-blue-700 text-pickled-700 font-bold py-1 px-2 text-xs rounded"}," Next ")):ul("",!0),Yr("span",zGe,[Ni(" Page "),oP(Yr("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>e.meta.page=s),type:"number",class:"w-12 h-8 text-center text-gray-900 dark:text-white bg-pickled-200 dark:bg-pickled-900"},null,512),[[iP,e.meta.page]]),Ni(" of "),Yr("span",YGe,xf(e.meta.total_pages),1)]),Yr("span",GGe,[Ni(" Records per page "),oP(Yr("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>e.meta.page_size=s),type:"number",class:"w-16 h-8 text-center text-gray-900 dark:text-white bg-pickled-200 dark:bg-pickled-900"},null,512),[[iP,e.meta.page_size]])])])])):ul("",!0)])}const JGe=SY(MGe,[["render",KGe]]);export{JGe as H};
