import{e as ic,ac as iY,ad as DL,i as NL,ae as aY,o as lY,c as sY,af as uY}from"./index-eedfe929.js";import{c as Av}from"./_commonjs-dynamic-modules-302442b1.js";var kf=function(e){return e&&e.Math===Math&&e},vt=kf(typeof globalThis=="object"&&globalThis)||kf(typeof window=="object"&&window)||kf(typeof self=="object"&&self)||kf(typeof ic=="object"&&ic)||kf(typeof ic=="object"&&ic)||function(){return this}()||Function("return this")(),Ln={},je=function(e){try{return!!e()}catch{return!0}},fY=je,Ut=!fY(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),cY=je,Nd=!cY(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),hY=Nd,Iv=Function.prototype.call,zt=hY?Iv.bind(Iv):function(){return Iv.apply(Iv,arguments)},Hd={},HL={}.propertyIsEnumerable,LL=Object.getOwnPropertyDescriptor,dY=LL&&!HL.call({1:2},1);Hd.f=dY?function(t){var r=LL(this,t);return!!r&&r.enumerable}:HL;var Ld=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}},jL=Nd,FL=Function.prototype,VS=FL.call,vY=jL&&FL.bind.bind(VS,VS),Ue=jL?vY:function(e){return function(){return VS.apply(e,arguments)}},BL=Ue,yY=BL({}.toString),gY=BL("".slice),jn=function(e){return gY(yY(e),8,-1)},pY=Ue,mY=je,bY=jn,ib=Object,wY=pY("".split),jd=mY(function(){return!ib("z").propertyIsEnumerable(0)})?function(e){return bY(e)==="String"?wY(e,""):ib(e)}:ib,pn=function(e){return e==null},SY=pn,CY=TypeError,Tr=function(e){if(SY(e))throw new CY("Can't call method on "+e);return e},_Y=jd,OY=Tr,Br=function(e){return _Y(OY(e))},ab=typeof document=="object"&&document.all,Et=typeof ab>"u"&&ab!==void 0?function(e){return typeof e=="function"||e===ab}:function(e){return typeof e=="function"},RY=Et,Nt=function(e){return typeof e=="object"?e!==null:RY(e)},lb=vt,EY=Et,TY=function(e){return EY(e)?e:void 0},Lo=function(e,t){return arguments.length<2?TY(lb[e]):lb[e]&&lb[e][t]},PY=Ue,ki=PY({}.isPrototypeOf),za=typeof navigator<"u"&&String(navigator.userAgent)||"",VL=vt,sb=za,YP=VL.process,GP=VL.Deno,KP=YP&&YP.versions||GP&&GP.version,qP=KP&&KP.v8,ln,Pg;qP&&(ln=qP.split("."),Pg=ln[0]>0&&ln[0]<4?1:+(ln[0]+ln[1]));!Pg&&sb&&(ln=sb.match(/Edge\/(\d+)/),(!ln||ln[1]>=74)&&(ln=sb.match(/Chrome\/(\d+)/),ln&&(Pg=+ln[1])));var Fd=Pg,XP=Fd,kY=je,$Y=vt,AY=$Y.String,vf=!!Object.getOwnPropertySymbols&&!kY(function(){var e=Symbol("symbol detection");return!AY(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&XP&&XP<41}),IY=vf,WL=IY&&!Symbol.sham&&typeof Symbol.iterator=="symbol",MY=Lo,xY=Et,DY=ki,NY=WL,HY=Object,Bd=NY?function(e){return typeof e=="symbol"}:function(e){var t=MY("Symbol");return xY(t)&&DY(t.prototype,HY(e))},LY=String,yf=function(e){try{return LY(e)}catch{return"Object"}},jY=Et,FY=yf,BY=TypeError,Ya=function(e){if(jY(e))return e;throw new BY(FY(e)+" is not a function")},VY=Ya,WY=pn,Ga=function(e,t){var r=e[t];return WY(r)?void 0:VY(r)},ub=zt,fb=Et,cb=Nt,UY=TypeError,UL=function(e,t){var r,n;if(t==="string"&&fb(r=e.toString)&&!cb(n=ub(r,e))||fb(r=e.valueOf)&&!cb(n=ub(r,e))||t!=="string"&&fb(r=e.toString)&&!cb(n=ub(r,e)))return n;throw new UY("Can't convert object to primitive value")},zL={exports:{}},zY=!1,ZP=vt,YY=Object.defineProperty,VR=function(e,t){try{YY(ZP,e,{value:t,configurable:!0,writable:!0})}catch{ZP[e]=t}return t},GY=vt,KY=VR,QP="__core-js_shared__",qY=GY[QP]||KY(QP,{}),WR=qY,JP=WR;(zL.exports=function(e,t){return JP[e]||(JP[e]=t!==void 0?t:{})})("versions",[]).push({version:"3.35.1",mode:"global",copyright:"© 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.35.1/LICENSE",source:"https://github.com/zloirock/core-js"});var gf=zL.exports,XY=Tr,ZY=Object,Pr=function(e){return ZY(XY(e))},QY=Ue,JY=Pr,eG=QY({}.hasOwnProperty),Mt=Object.hasOwn||function(t,r){return eG(JY(t),r)},tG=Ue,rG=0,nG=Math.random(),oG=tG(1 .toString),zp=function(e){return"Symbol("+(e===void 0?"":e)+")_"+oG(++rG+nG,36)},iG=vt,aG=gf,ek=Mt,lG=zp,sG=vf,uG=WL,jl=iG.Symbol,hb=aG("wks"),fG=uG?jl.for||jl:jl&&jl.withoutSetter||lG,wt=function(e){return ek(hb,e)||(hb[e]=sG&&ek(jl,e)?jl[e]:fG("Symbol."+e)),hb[e]},cG=zt,tk=Nt,rk=Bd,hG=Ga,dG=UL,vG=wt,yG=TypeError,gG=vG("toPrimitive"),YL=function(e,t){if(!tk(e)||rk(e))return e;var r=hG(e,gG),n;if(r){if(t===void 0&&(t="default"),n=cG(r,e,t),!tk(n)||rk(n))return n;throw new yG("Can't convert object to primitive value")}return t===void 0&&(t="number"),dG(e,t)},pG=YL,mG=Bd,Yp=function(e){var t=pG(e,"string");return mG(t)?t:t+""},bG=vt,nk=Nt,WS=bG.document,wG=nk(WS)&&nk(WS.createElement),Gp=function(e){return wG?WS.createElement(e):{}},SG=Ut,CG=je,_G=Gp,GL=!SG&&!CG(function(){return Object.defineProperty(_G("div"),"a",{get:function(){return 7}}).a!==7}),OG=Ut,RG=zt,EG=Hd,TG=Ld,PG=Br,kG=Yp,$G=Mt,AG=GL,ok=Object.getOwnPropertyDescriptor;Ln.f=OG?ok:function(t,r){if(t=PG(t),r=kG(r),AG)try{return ok(t,r)}catch{}if($G(t,r))return TG(!RG(EG.f,t,r),t[r])};var br={},IG=Ut,MG=je,KL=IG&&MG(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),xG=Nt,DG=String,NG=TypeError,Ht=function(e){if(xG(e))return e;throw new NG(DG(e)+" is not an object")},HG=Ut,LG=GL,jG=KL,Mv=Ht,ik=Yp,FG=TypeError,db=Object.defineProperty,BG=Object.getOwnPropertyDescriptor,vb="enumerable",yb="configurable",gb="writable";br.f=HG?jG?function(t,r,n){if(Mv(t),r=ik(r),Mv(n),typeof t=="function"&&r==="prototype"&&"value"in n&&gb in n&&!n[gb]){var o=BG(t,r);o&&o[gb]&&(t[r]=n.value,n={configurable:yb in n?n[yb]:o[yb],enumerable:vb in n?n[vb]:o[vb],writable:!1})}return db(t,r,n)}:db:function(t,r,n){if(Mv(t),r=ik(r),Mv(n),LG)try{return db(t,r,n)}catch{}if("get"in n||"set"in n)throw new FG("Accessors not supported");return"value"in n&&(t[r]=n.value),t};var VG=Ut,WG=br,UG=Ld,Ka=VG?function(e,t,r){return WG.f(e,t,UG(1,r))}:function(e,t,r){return e[t]=r,e},qL={exports:{}},US=Ut,zG=Mt,XL=Function.prototype,YG=US&&Object.getOwnPropertyDescriptor,UR=zG(XL,"name"),GG=UR&&(function(){}).name==="something",KG=UR&&(!US||US&&YG(XL,"name").configurable),Vd={EXISTS:UR,PROPER:GG,CONFIGURABLE:KG},qG=Ue,XG=Et,zS=WR,ZG=qG(Function.toString);XG(zS.inspectSource)||(zS.inspectSource=function(e){return ZG(e)});var ZL=zS.inspectSource,QG=vt,JG=Et,ak=QG.WeakMap,QL=JG(ak)&&/native code/.test(String(ak)),e3=gf,t3=zp,lk=e3("keys"),Kp=function(e){return lk[e]||(lk[e]=t3(e))},Wd={},r3=QL,JL=vt,n3=Nt,o3=Ka,pb=Mt,mb=WR,i3=Kp,a3=Wd,sk="Object already initialized",YS=JL.TypeError,l3=JL.WeakMap,kg,$c,$g,s3=function(e){return $g(e)?$c(e):kg(e,{})},u3=function(e){return function(t){var r;if(!n3(t)||(r=$c(t)).type!==e)throw new YS("Incompatible receiver, "+e+" required");return r}};if(r3||mb.state){var wn=mb.state||(mb.state=new l3);wn.get=wn.get,wn.has=wn.has,wn.set=wn.set,kg=function(e,t){if(wn.has(e))throw new YS(sk);return t.facade=e,wn.set(e,t),t},$c=function(e){return wn.get(e)||{}},$g=function(e){return wn.has(e)}}else{var al=i3("state");a3[al]=!0,kg=function(e,t){if(pb(e,al))throw new YS(sk);return t.facade=e,o3(e,al,t),t},$c=function(e){return pb(e,al)?e[al]:{}},$g=function(e){return pb(e,al)}}var jo={set:kg,get:$c,has:$g,enforce:s3,getterFor:u3},zR=Ue,f3=je,c3=Et,xv=Mt,GS=Ut,h3=Vd.CONFIGURABLE,d3=ZL,ej=jo,v3=ej.enforce,y3=ej.get,uk=String,Fy=Object.defineProperty,g3=zR("".slice),p3=zR("".replace),m3=zR([].join),b3=GS&&!f3(function(){return Fy(function(){},"length",{value:8}).length!==8}),w3=String(String).split("String"),S3=qL.exports=function(e,t,r){g3(uk(t),0,7)==="Symbol("&&(t="["+p3(uk(t),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!xv(e,"name")||h3&&e.name!==t)&&(GS?Fy(e,"name",{value:t,configurable:!0}):e.name=t),b3&&r&&xv(r,"arity")&&e.length!==r.arity&&Fy(e,"length",{value:r.arity});try{r&&xv(r,"constructor")&&r.constructor?GS&&Fy(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch{}var n=v3(e);return xv(n,"source")||(n.source=m3(w3,typeof t=="string"?t:"")),e};Function.prototype.toString=S3(function(){return c3(this)&&y3(this).source||d3(this)},"toString");var tj=qL.exports,C3=Et,_3=br,O3=tj,R3=VR,Xr=function(e,t,r,n){n||(n={});var o=n.enumerable,i=n.name!==void 0?n.name:t;if(C3(r)&&O3(r,i,n),n.global)o?e[t]=r:R3(t,r);else{try{n.unsafe?e[t]&&(o=!0):delete e[t]}catch{}o?e[t]=r:_3.f(e,t,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return e},qa={},E3=Math.ceil,T3=Math.floor,P3=Math.trunc||function(t){var r=+t;return(r>0?T3:E3)(r)},k3=P3,$i=function(e){var t=+e;return t!==t||t===0?0:k3(t)},$3=$i,A3=Math.max,I3=Math.min,qp=function(e,t){var r=$3(e);return r<0?A3(r+t,0):I3(r,t)},M3=$i,x3=Math.min,Xa=function(e){var t=M3(e);return t>0?x3(t,9007199254740991):0},D3=Xa,mn=function(e){return D3(e.length)},N3=Br,H3=qp,L3=mn,fk=function(e){return function(t,r,n){var o=N3(t),i=L3(o),a=H3(n,i),l;if(e&&r!==r){for(;i>a;)if(l=o[a++],l!==l)return!0}else for(;i>a;a++)if((e||a in o)&&o[a]===r)return e||a||0;return!e&&-1}},YR={includes:fk(!0),indexOf:fk(!1)},j3=Ue,bb=Mt,F3=Br,B3=YR.indexOf,V3=Wd,ck=j3([].push),rj=function(e,t){var r=F3(e),n=0,o=[],i;for(i in r)!bb(V3,i)&&bb(r,i)&&ck(o,i);for(;t.length>n;)bb(r,i=t[n++])&&(~B3(o,i)||ck(o,i));return o},GR=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],W3=rj,U3=GR,z3=U3.concat("length","prototype");qa.f=Object.getOwnPropertyNames||function(t){return W3(t,z3)};var Ud={};Ud.f=Object.getOwnPropertySymbols;var Y3=Lo,G3=Ue,K3=qa,q3=Ud,X3=Ht,Z3=G3([].concat),nj=Y3("Reflect","ownKeys")||function(t){var r=K3.f(X3(t)),n=q3.f;return n?Z3(r,n(t)):r},hk=Mt,Q3=nj,J3=Ln,eK=br,oj=function(e,t,r){for(var n=Q3(t),o=eK.f,i=J3.f,a=0;a<n.length;a++){var l=n[a];!hk(e,l)&&!(r&&hk(r,l))&&o(e,l,i(t,l))}},tK=je,rK=Et,nK=/#|\.prototype\./,zd=function(e,t){var r=iK[oK(e)];return r===lK?!0:r===aK?!1:rK(t)?tK(t):!!t},oK=zd.normalize=function(e){return String(e).replace(nK,".").toLowerCase()},iK=zd.data={},aK=zd.NATIVE="N",lK=zd.POLYFILL="P",Xp=zd,Dv=vt,sK=Ln.f,uK=Ka,fK=Xr,cK=VR,hK=oj,dK=Xp,$e=function(e,t){var r=e.target,n=e.global,o=e.stat,i,a,l,s,u,f;if(n?a=Dv:o?a=Dv[r]||cK(r,{}):a=Dv[r]&&Dv[r].prototype,a)for(l in t){if(u=t[l],e.dontCallGetSet?(f=sK(a,l),s=f&&f.value):s=a[l],i=dK(n?l:r+(o?".":"#")+l,e.forced),!i&&s!==void 0){if(typeof u==typeof s)continue;hK(u,s)}(e.sham||s&&s.sham)&&uK(u,"sham",!0),fK(a,l,u,e)}},Zp={},vK=Ue,Za=vK([].slice),yK=jn,gK=Br,ij=qa.f,pK=Za,aj=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],mK=function(e){try{return ij(e)}catch{return pK(aj)}};Zp.f=function(t){return aj&&yK(t)==="Window"?mK(t):ij(gK(t))};var bK=$e,wK=je,SK=Zp.f,CK=wK(function(){return!Object.getOwnPropertyNames(1)});bK({target:"Object",stat:!0,forced:CK},{getOwnPropertyNames:SK});var _K=wt,OK=_K("toStringTag"),lj={};lj[OK]="z";var KR=String(lj)==="[object z]",RK=KR,EK=Et,By=jn,TK=wt,PK=TK("toStringTag"),kK=Object,$K=By(function(){return arguments}())==="Arguments",AK=function(e,t){try{return e[t]}catch{}},Qp=RK?By:function(e){var t,r,n;return e===void 0?"Undefined":e===null?"Null":typeof(r=AK(t=kK(e),PK))=="string"?r:$K?By(t):(n=By(t))==="Object"&&EK(t.callee)?"Arguments":n},IK=Qp,MK=String,Yt=function(e){if(IK(e)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return MK(e)},qR={},xK=rj,DK=GR,Yd=Object.keys||function(t){return xK(t,DK)},NK=Ut,HK=KL,LK=br,jK=Ht,FK=Br,BK=Yd;qR.f=NK&&!HK?Object.defineProperties:function(t,r){jK(t);for(var n=FK(r),o=BK(r),i=o.length,a=0,l;i>a;)LK.f(t,l=o[a++],n[l]);return t};var VK=Lo,sj=VK("document","documentElement"),WK=Ht,UK=qR,dk=GR,zK=Wd,YK=sj,GK=Gp,KK=Kp,vk=">",yk="<",KS="prototype",qS="script",uj=KK("IE_PROTO"),wb=function(){},fj=function(e){return yk+qS+vk+e+yk+"/"+qS+vk},gk=function(e){e.write(fj("")),e.close();var t=e.parentWindow.Object;return e=null,t},qK=function(){var e=GK("iframe"),t="java"+qS+":",r;return e.style.display="none",YK.appendChild(e),e.src=String(t),r=e.contentWindow.document,r.open(),r.write(fj("document.F=Object")),r.close(),r.F},Nv,Vy=function(){try{Nv=new ActiveXObject("htmlfile")}catch{}Vy=typeof document<"u"?document.domain&&Nv?gk(Nv):qK():gk(Nv);for(var e=dk.length;e--;)delete Vy[KS][dk[e]];return Vy()};zK[uj]=!0;var Qa=Object.create||function(t,r){var n;return t!==null?(wb[KS]=WK(t),n=new wb,wb[KS]=null,n[uj]=t):n=Vy(),r===void 0?n:UK.f(n,r)},pk=tj,XK=br,Gd=function(e,t,r){return r.get&&pk(r.get,t,{getter:!0}),r.set&&pk(r.set,t,{setter:!0}),XK.f(e,t,r)},XR={},ZK=wt;XR.f=ZK;var QK=vt,cj=QK,mk=cj,JK=Mt,e4=XR,t4=br.f,ZR=function(e){var t=mk.Symbol||(mk.Symbol={});JK(t,e)||t4(t,e,{value:e4.f(e)})},r4=zt,n4=Lo,o4=wt,i4=Xr,hj=function(){var e=n4("Symbol"),t=e&&e.prototype,r=t&&t.valueOf,n=o4("toPrimitive");t&&!t[n]&&i4(t,n,function(o){return r4(r,this)},{arity:1})},a4=br.f,l4=Mt,s4=wt,bk=s4("toStringTag"),Kd=function(e,t,r){e&&!r&&(e=e.prototype),e&&!l4(e,bk)&&a4(e,bk,{configurable:!0,value:t})},u4=jn,f4=Ue,Jp=function(e){if(u4(e)==="Function")return f4(e)},wk=Jp,c4=Ya,h4=Nd,d4=wk(wk.bind),qd=function(e,t){return c4(e),t===void 0?e:h4?d4(e,t):function(){return e.apply(t,arguments)}},v4=jn,pf=Array.isArray||function(t){return v4(t)==="Array"},y4=Ue,g4=je,dj=Et,p4=Qp,m4=Lo,b4=ZL,vj=function(){},yj=m4("Reflect","construct"),QR=/^\s*(?:class|function)\b/,w4=y4(QR.exec),S4=!QR.test(vj),$f=function(t){if(!dj(t))return!1;try{return yj(vj,[],t),!0}catch{return!1}},gj=function(t){if(!dj(t))return!1;switch(p4(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return S4||!!w4(QR,b4(t))}catch{return!0}};gj.sham=!0;var em=!yj||g4(function(){var e;return $f($f.call)||!$f(Object)||!$f(function(){e=!0})||e})?gj:$f,Sk=pf,C4=em,_4=Nt,O4=wt,R4=O4("species"),Ck=Array,E4=function(e){var t;return Sk(e)&&(t=e.constructor,C4(t)&&(t===Ck||Sk(t.prototype))?t=void 0:_4(t)&&(t=t[R4],t===null&&(t=void 0))),t===void 0?Ck:t},T4=E4,JR=function(e,t){return new(T4(e))(t===0?0:t)},P4=qd,k4=Ue,$4=jd,A4=Pr,I4=mn,M4=JR,_k=k4([].push),Uo=function(e){var t=e===1,r=e===2,n=e===3,o=e===4,i=e===6,a=e===7,l=e===5||i;return function(s,u,f,c){for(var h=A4(s),d=$4(h),v=I4(d),g=P4(u,f),m=0,w=c||M4,S=t?w(s,v):r||a?w(s,0):void 0,C,P;v>m;m++)if((l||m in d)&&(C=d[m],P=g(C,m,h),e))if(t)S[m]=P;else if(P)switch(e){case 3:return!0;case 5:return C;case 6:return m;case 2:_k(S,C)}else switch(e){case 4:return!1;case 7:_k(S,C)}return i?-1:n||o?o:S}},Ja={forEach:Uo(0),map:Uo(1),filter:Uo(2),some:Uo(3),every:Uo(4),find:Uo(5),findIndex:Uo(6),filterReject:Uo(7)},tm=$e,Xd=vt,e0=zt,x4=Ue,is=Ut,as=vf,D4=je,er=Mt,N4=ki,XS=Ht,rm=Br,t0=Yp,H4=Yt,ZS=Ld,ls=Qa,pj=Yd,L4=qa,mj=Zp,j4=Ud,bj=Ln,wj=br,F4=qR,Sj=Hd,Sb=Xr,B4=Gd,r0=gf,V4=Kp,Cj=Wd,Ok=zp,W4=wt,U4=XR,z4=ZR,Y4=hj,G4=Kd,_j=jo,nm=Ja.forEach,Er=V4("hidden"),om="Symbol",Ac="prototype",K4=_j.set,Rk=_j.getterFor(om),Kr=Object[Ac],Ta=Xd.Symbol,ac=Ta&&Ta[Ac],q4=Xd.RangeError,X4=Xd.TypeError,Cb=Xd.QObject,Oj=bj.f,Pa=wj.f,Rj=mj.f,Z4=Sj.f,Ej=x4([].push),Mo=r0("symbols"),Zd=r0("op-symbols"),Q4=r0("wks"),QS=!Cb||!Cb[Ac]||!Cb[Ac].findChild,Tj=function(e,t,r){var n=Oj(Kr,t);n&&delete Kr[t],Pa(e,t,r),n&&e!==Kr&&Pa(Kr,t,n)},JS=is&&D4(function(){return ls(Pa({},"a",{get:function(){return Pa(this,"a",{value:7}).a}})).a!==7})?Tj:Pa,_b=function(e,t){var r=Mo[e]=ls(ac);return K4(r,{type:om,tag:e,description:t}),is||(r.description=t),r},im=function(t,r,n){t===Kr&&im(Zd,r,n),XS(t);var o=t0(r);return XS(n),er(Mo,o)?(n.enumerable?(er(t,Er)&&t[Er][o]&&(t[Er][o]=!1),n=ls(n,{enumerable:ZS(0,!1)})):(er(t,Er)||Pa(t,Er,ZS(1,ls(null))),t[Er][o]=!0),JS(t,o,n)):Pa(t,o,n)},n0=function(t,r){XS(t);var n=rm(r),o=pj(n).concat($j(n));return nm(o,function(i){(!is||e0(eC,n,i))&&im(t,i,n[i])}),t},J4=function(t,r){return r===void 0?ls(t):n0(ls(t),r)},eC=function(t){var r=t0(t),n=e0(Z4,this,r);return this===Kr&&er(Mo,r)&&!er(Zd,r)?!1:n||!er(this,r)||!er(Mo,r)||er(this,Er)&&this[Er][r]?n:!0},Pj=function(t,r){var n=rm(t),o=t0(r);if(!(n===Kr&&er(Mo,o)&&!er(Zd,o))){var i=Oj(n,o);return i&&er(Mo,o)&&!(er(n,Er)&&n[Er][o])&&(i.enumerable=!0),i}},kj=function(t){var r=Rj(rm(t)),n=[];return nm(r,function(o){!er(Mo,o)&&!er(Cj,o)&&Ej(n,o)}),n},$j=function(e){var t=e===Kr,r=Rj(t?Zd:rm(e)),n=[];return nm(r,function(o){er(Mo,o)&&(!t||er(Kr,o))&&Ej(n,Mo[o])}),n};as||(Ta=function(){if(N4(ac,this))throw new X4("Symbol is not a constructor");var t=!arguments.length||arguments[0]===void 0?void 0:H4(arguments[0]),r=Ok(t),n=function(o){var i=this===void 0?Xd:this;i===Kr&&e0(n,Zd,o),er(i,Er)&&er(i[Er],r)&&(i[Er][r]=!1);var a=ZS(1,o);try{JS(i,r,a)}catch(l){if(!(l instanceof q4))throw l;Tj(i,r,a)}};return is&&QS&&JS(Kr,r,{configurable:!0,set:n}),_b(r,t)},ac=Ta[Ac],Sb(ac,"toString",function(){return Rk(this).tag}),Sb(Ta,"withoutSetter",function(e){return _b(Ok(e),e)}),Sj.f=eC,wj.f=im,F4.f=n0,bj.f=Pj,L4.f=mj.f=kj,j4.f=$j,U4.f=function(e){return _b(W4(e),e)},is&&(B4(ac,"description",{configurable:!0,get:function(){return Rk(this).description}}),Sb(Kr,"propertyIsEnumerable",eC,{unsafe:!0})));tm({global:!0,constructor:!0,wrap:!0,forced:!as,sham:!as},{Symbol:Ta});nm(pj(Q4),function(e){z4(e)});tm({target:om,stat:!0,forced:!as},{useSetter:function(){QS=!0},useSimple:function(){QS=!1}});tm({target:"Object",stat:!0,forced:!as,sham:!is},{create:J4,defineProperty:im,defineProperties:n0,getOwnPropertyDescriptor:Pj});tm({target:"Object",stat:!0,forced:!as},{getOwnPropertyNames:kj});Y4();G4(Ta,om);Cj[Er]=!0;var e6=vf,Aj=e6&&!!Symbol.for&&!!Symbol.keyFor,t6=$e,r6=Lo,n6=Mt,o6=Yt,Ij=gf,i6=Aj,Ob=Ij("string-to-symbol-registry"),a6=Ij("symbol-to-string-registry");t6({target:"Symbol",stat:!0,forced:!i6},{for:function(e){var t=o6(e);if(n6(Ob,t))return Ob[t];var r=r6("Symbol")(t);return Ob[t]=r,a6[r]=t,r}});var l6=$e,s6=Mt,u6=Bd,f6=yf,c6=gf,h6=Aj,Ek=c6("symbol-to-string-registry");l6({target:"Symbol",stat:!0,forced:!h6},{keyFor:function(t){if(!u6(t))throw new TypeError(f6(t)+" is not a symbol");if(s6(Ek,t))return Ek[t]}});var d6=Nd,Mj=Function.prototype,Tk=Mj.apply,Pk=Mj.call,mf=typeof Reflect=="object"&&Reflect.apply||(d6?Pk.bind(Tk):function(){return Pk.apply(Tk,arguments)}),v6=Ue,kk=pf,y6=Et,$k=jn,g6=Yt,Ak=v6([].push),p6=function(e){if(y6(e))return e;if(kk(e)){for(var t=e.length,r=[],n=0;n<t;n++){var o=e[n];typeof o=="string"?Ak(r,o):(typeof o=="number"||$k(o)==="Number"||$k(o)==="String")&&Ak(r,g6(o))}var i=r.length,a=!0;return function(l,s){if(a)return a=!1,s;if(kk(this))return s;for(var u=0;u<i;u++)if(r[u]===l)return s}}},m6=$e,xj=Lo,Dj=mf,b6=zt,Qd=Ue,Nj=je,Ik=Et,Mk=Bd,Hj=Za,w6=p6,S6=vf,C6=String,si=xj("JSON","stringify"),Hv=Qd(/./.exec),xk=Qd("".charAt),_6=Qd("".charCodeAt),O6=Qd("".replace),R6=Qd(1 .toString),E6=/[\uD800-\uDFFF]/g,Dk=/^[\uD800-\uDBFF]$/,Nk=/^[\uDC00-\uDFFF]$/,Hk=!S6||Nj(function(){var e=xj("Symbol")("stringify detection");return si([e])!=="[null]"||si({a:e})!=="{}"||si(Object(e))!=="{}"}),Lk=Nj(function(){return si("\uDF06\uD834")!=='"\\udf06\\ud834"'||si("\uDEAD")!=='"\\udead"'}),T6=function(e,t){var r=Hj(arguments),n=w6(t);if(!(!Ik(n)&&(e===void 0||Mk(e))))return r[1]=function(o,i){if(Ik(n)&&(i=b6(n,this,C6(o),i)),!Mk(i))return i},Dj(si,null,r)},P6=function(e,t,r){var n=xk(r,t-1),o=xk(r,t+1);return Hv(Dk,e)&&!Hv(Nk,o)||Hv(Nk,e)&&!Hv(Dk,n)?"\\u"+R6(_6(e,0),16):e};si&&m6({target:"JSON",stat:!0,arity:3,forced:Hk||Lk},{stringify:function(t,r,n){var o=Hj(arguments),i=Dj(Hk?T6:si,null,o);return Lk&&typeof i=="string"?O6(i,E6,P6):i}});var k6=$e,$6=vf,A6=je,Lj=Ud,I6=Pr,M6=!$6||A6(function(){Lj.f(1)});k6({target:"Object",stat:!0,forced:M6},{getOwnPropertySymbols:function(t){var r=Lj.f;return r?r(I6(t)):[]}});var x6=$e,D6=Ut,N6=vt,Lv=Ue,H6=Mt,L6=Et,j6=ki,F6=Yt,B6=Gd,V6=oj,Jn=N6.Symbol,xi=Jn&&Jn.prototype;if(D6&&L6(Jn)&&(!("description"in xi)||Jn().description!==void 0)){var jk={},jv=function(){var t=arguments.length<1||arguments[0]===void 0?void 0:F6(arguments[0]),r=j6(xi,this)?new Jn(t):t===void 0?Jn():Jn(t);return t===""&&(jk[r]=!0),r};V6(jv,Jn),jv.prototype=xi,xi.constructor=jv;var W6=String(Jn("description detection"))==="Symbol(description detection)",U6=Lv(xi.valueOf),z6=Lv(xi.toString),Y6=/^Symbol\((.*)\)[^)]+$/,G6=Lv("".replace),K6=Lv("".slice);B6(xi,"description",{configurable:!0,get:function(){var t=U6(this);if(H6(jk,t))return"";var r=z6(t),n=W6?K6(r,7,-1):G6(r,Y6,"$1");return n===""?void 0:n}}),x6({global:!0,constructor:!0,forced:!0},{Symbol:jv})}var q6=ZR;q6("iterator");var X6=Ut,Z6=Vd.EXISTS,jj=Ue,Q6=Gd,Fj=Function.prototype,J6=jj(Fj.toString),Bj=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,e8=jj(Bj.exec),t8="name";X6&&!Z6&&Q6(Fj,t8,{configurable:!0,get:function(){try{return e8(Bj,J6(this))[1]}catch{return""}}});var r8=je,o0=!r8(function(){return Object.isExtensible(Object.preventExtensions({}))}),Vj={exports:{}},n8=je,o8=n8(function(){if(typeof ArrayBuffer=="function"){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}),i8=je,a8=Nt,l8=jn,Fk=o8,Wy=Object.isExtensible,s8=i8(function(){Wy(1)}),u8=s8||Fk?function(t){return!a8(t)||Fk&&l8(t)==="ArrayBuffer"?!1:Wy?Wy(t):!0}:Wy,f8=$e,c8=Ue,h8=Wd,d8=Nt,i0=Mt,v8=br.f,Bk=qa,y8=Zp,a0=u8,g8=zp,p8=o0,Wj=!1,xo=g8("meta"),m8=0,l0=function(e){v8(e,xo,{value:{objectID:"O"+m8++,weakData:{}}})},b8=function(e,t){if(!d8(e))return typeof e=="symbol"?e:(typeof e=="string"?"S":"P")+e;if(!i0(e,xo)){if(!a0(e))return"F";if(!t)return"E";l0(e)}return e[xo].objectID},w8=function(e,t){if(!i0(e,xo)){if(!a0(e))return!0;if(!t)return!1;l0(e)}return e[xo].weakData},S8=function(e){return p8&&Wj&&a0(e)&&!i0(e,xo)&&l0(e),e},C8=function(){_8.enable=function(){},Wj=!0;var e=Bk.f,t=c8([].splice),r={};r[xo]=1,e(r).length&&(Bk.f=function(n){for(var o=e(n),i=0,a=o.length;i<a;i++)if(o[i]===xo){t(o,i,1);break}return o},f8({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:y8.f}))},_8=Vj.exports={enable:C8,fastKey:b8,getWeakData:w8,onFreeze:S8};h8[xo]=!0;var Jd=Vj.exports,O8=$e,R8=o0,E8=je,T8=Nt,P8=Jd.onFreeze,tC=Object.freeze,k8=E8(function(){tC(1)});O8({target:"Object",stat:!0,forced:k8,sham:!R8},{freeze:function(t){return tC&&T8(t)?tC(P8(t)):t}});var $8=wt,A8=Qa,I8=br.f,rC=$8("unscopables"),nC=Array.prototype;nC[rC]===void 0&&I8(nC,rC,{configurable:!0,value:A8(null)});var ev=function(e){nC[rC][e]=!0},tv={},M8=je,Uj=!M8(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),x8=Mt,D8=Et,N8=Pr,H8=Kp,L8=Uj,Vk=H8("IE_PROTO"),oC=Object,j8=oC.prototype,rv=L8?oC.getPrototypeOf:function(e){var t=N8(e);if(x8(t,Vk))return t[Vk];var r=t.constructor;return D8(r)&&t instanceof r?r.prototype:t instanceof oC?j8:null},F8=je,B8=Et,V8=Nt,Wk=rv,W8=Xr,U8=wt,iC=U8("iterator"),zj=!1,Aa,Rb,Eb;[].keys&&(Eb=[].keys(),"next"in Eb?(Rb=Wk(Wk(Eb)),Rb!==Object.prototype&&(Aa=Rb)):zj=!0);var z8=!V8(Aa)||F8(function(){var e={};return Aa[iC].call(e)!==e});z8&&(Aa={});B8(Aa[iC])||W8(Aa,iC,function(){return this});var Yj={IteratorPrototype:Aa,BUGGY_SAFARI_ITERATORS:zj},Y8=Yj.IteratorPrototype,G8=Qa,K8=Ld,q8=Kd,X8=tv,Z8=function(){return this},Q8=function(e,t,r,n){var o=t+" Iterator";return e.prototype=G8(Y8,{next:K8(+!n,r)}),q8(e,o,!1),X8[o]=Z8,e},J8=Ue,e5=Ya,t5=function(e,t,r){try{return J8(e5(Object.getOwnPropertyDescriptor(e,t)[r]))}catch{}},r5=Nt,n5=function(e){return r5(e)||e===null},o5=n5,i5=String,a5=TypeError,l5=function(e){if(o5(e))return e;throw new a5("Can't set "+i5(e)+" as a prototype")},s5=t5,u5=Ht,f5=l5,s0=Object.setPrototypeOf||("__proto__"in{}?function(){var e=!1,t={},r;try{r=s5(Object.prototype,"__proto__","set"),r(t,[]),e=t instanceof Array}catch{}return function(o,i){return u5(o),f5(i),e?r(o,i):o.__proto__=i,o}}():void 0),c5=$e,h5=zt,Gj=Vd,d5=Et,v5=Q8,Uk=rv,zk=s0,y5=Kd,g5=Ka,Tb=Xr,p5=wt,m5=tv,Kj=Yj,b5=Gj.PROPER,w5=Gj.CONFIGURABLE,Yk=Kj.IteratorPrototype,Fv=Kj.BUGGY_SAFARI_ITERATORS,Af=p5("iterator"),Gk="keys",If="values",Kk="entries",S5=function(){return this},u0=function(e,t,r,n,o,i,a){v5(r,t,n);var l=function(w){if(w===o&&h)return h;if(!Fv&&w&&w in f)return f[w];switch(w){case Gk:return function(){return new r(this,w)};case If:return function(){return new r(this,w)};case Kk:return function(){return new r(this,w)}}return function(){return new r(this)}},s=t+" Iterator",u=!1,f=e.prototype,c=f[Af]||f["@@iterator"]||o&&f[o],h=!Fv&&c||l(o),d=t==="Array"&&f.entries||c,v,g,m;if(d&&(v=Uk(d.call(new e)),v!==Object.prototype&&v.next&&(Uk(v)!==Yk&&(zk?zk(v,Yk):d5(v[Af])||Tb(v,Af,S5)),y5(v,s,!0))),b5&&o===If&&c&&c.name!==If&&(w5?g5(f,"name",If):(u=!0,h=function(){return h5(c,this)})),o)if(g={values:l(If),keys:i?h:l(Gk),entries:l(Kk)},a)for(m in g)(Fv||u||!(m in f))&&Tb(f,m,g[m]);else c5({target:t,proto:!0,forced:Fv||u},g);return f[Af]!==h&&Tb(f,Af,h,{name:o}),m5[t]=h,g},f0=function(e,t){return{value:e,done:t}},C5=Br,c0=ev,qk=tv,qj=jo,_5=br.f,O5=u0,Bv=f0,R5=Ut,Xj="Array Iterator",E5=qj.set,T5=qj.getterFor(Xj),P5=O5(Array,"Array",function(e,t){E5(this,{type:Xj,target:C5(e),index:0,kind:t})},function(){var e=T5(this),t=e.target,r=e.index++;if(!t||r>=t.length)return e.target=void 0,Bv(void 0,!0);switch(e.kind){case"keys":return Bv(r,!1);case"values":return Bv(t[r],!1)}return Bv([r,t[r]],!1)},"values"),Xk=qk.Arguments=qk.Array;c0("keys");c0("values");c0("entries");if(R5&&Xk.name!=="values")try{_5(Xk,"name",{value:"values"})}catch{}var k5=KR,$5=Qp,A5=k5?{}.toString:function(){return"[object "+$5(this)+"]"},I5=KR,M5=Xr,x5=A5;I5||M5(Object.prototype,"toString",x5,{unsafe:!0});var D5=wt,N5=tv,H5=D5("iterator"),L5=Array.prototype,Zj=function(e){return e!==void 0&&(N5.Array===e||L5[H5]===e)},j5=Qp,Zk=Ga,F5=pn,B5=tv,V5=wt,W5=V5("iterator"),h0=function(e){if(!F5(e))return Zk(e,W5)||Zk(e,"@@iterator")||B5[j5(e)]},U5=zt,z5=Ya,Y5=Ht,G5=yf,K5=h0,q5=TypeError,Qj=function(e,t){var r=arguments.length<2?K5(e):t;if(z5(r))return Y5(U5(r,e));throw new q5(G5(e)+" is not iterable")},X5=zt,Qk=Ht,Z5=Ga,Jj=function(e,t,r){var n,o;Qk(e);try{if(n=Z5(e,"return"),!n){if(t==="throw")throw r;return r}n=X5(n,e)}catch(i){o=!0,n=i}if(t==="throw")throw r;if(o)throw n;return Qk(n),r},Q5=qd,J5=zt,e7=Ht,t7=yf,r7=Zj,n7=mn,Jk=ki,o7=Qj,i7=h0,e$=Jj,a7=TypeError,Uy=function(e,t){this.stopped=e,this.result=t},t$=Uy.prototype,d0=function(e,t,r){var n=r&&r.that,o=!!(r&&r.AS_ENTRIES),i=!!(r&&r.IS_RECORD),a=!!(r&&r.IS_ITERATOR),l=!!(r&&r.INTERRUPTED),s=Q5(t,n),u,f,c,h,d,v,g,m=function(S){return u&&e$(u,"normal",S),new Uy(!0,S)},w=function(S){return o?(e7(S),l?s(S[0],S[1],m):s(S[0],S[1])):l?s(S,m):s(S)};if(i)u=e.iterator;else if(a)u=e;else{if(f=i7(e),!f)throw new a7(t7(e)+" is not iterable");if(r7(f)){for(c=0,h=n7(e);h>c;c++)if(d=w(e[c]),d&&Jk(t$,d))return d;return new Uy(!1)}u=o7(e,f)}for(v=i?e.next:u.next;!(g=J5(v,u)).done;){try{d=w(g.value)}catch(S){e$(u,"throw",S)}if(typeof d=="object"&&d&&Jk(t$,d))return d}return new Uy(!1)},l7=ki,s7=TypeError,v0=function(e,t){if(l7(t,e))return e;throw new s7("Incorrect invocation")},u7=wt,eF=u7("iterator"),tF=!1;try{var f7=0,r$={next:function(){return{done:!!f7++}},return:function(){tF=!0}};r$[eF]=function(){return this},Array.from(r$,function(){throw 2})}catch{}var rF=function(e,t){try{if(!t&&!tF)return!1}catch{return!1}var r=!1;try{var n={};n[eF]=function(){return{next:function(){return{done:r=!0}}}},e(n)}catch{}return r},c7=Et,h7=Nt,n$=s0,y0=function(e,t,r){var n,o;return n$&&c7(n=t.constructor)&&n!==r&&h7(o=n.prototype)&&o!==r.prototype&&n$(e,o),e},d7=$e,v7=vt,y7=Ue,o$=Xp,g7=Xr,p7=Jd,m7=d0,b7=v0,w7=Et,S7=pn,Pb=Nt,kb=je,C7=rF,_7=Kd,O7=y0,am=function(e,t,r){var n=e.indexOf("Map")!==-1,o=e.indexOf("Weak")!==-1,i=n?"set":"add",a=v7[e],l=a&&a.prototype,s=a,u={},f=function(w){var S=y7(l[w]);g7(l,w,w==="add"?function(P){return S(this,P===0?0:P),this}:w==="delete"?function(C){return o&&!Pb(C)?!1:S(this,C===0?0:C)}:w==="get"?function(P){return o&&!Pb(P)?void 0:S(this,P===0?0:P)}:w==="has"?function(P){return o&&!Pb(P)?!1:S(this,P===0?0:P)}:function(P,R){return S(this,P===0?0:P,R),this})},c=o$(e,!w7(a)||!(o||l.forEach&&!kb(function(){new a().entries().next()})));if(c)s=r.getConstructor(t,e,n,i),p7.enable();else if(o$(e,!0)){var h=new s,d=h[i](o?{}:-0,1)!==h,v=kb(function(){h.has(1)}),g=C7(function(w){new a(w)}),m=!o&&kb(function(){for(var w=new a,S=5;S--;)w[i](S,S);return!w.has(-0)});g||(s=t(function(w,S){b7(w,l);var C=O7(new a,w,s);return S7(S)||m7(S,C[i],{that:C,AS_ENTRIES:n}),C}),s.prototype=l,l.constructor=s),(v||m)&&(f("delete"),f("has"),n&&f("get")),(m||d)&&f(i),o&&l.clear&&delete l.clear}return u[e]=s,d7({global:!0,constructor:!0,forced:s!==a},u),_7(s,e),o||r.setStrong(s,e,n),s},R7=Xr,g0=function(e,t,r){for(var n in t)R7(e,n,t[n],r);return e},E7=Lo,T7=Gd,P7=wt,k7=Ut,i$=P7("species"),nF=function(e){var t=E7(e);k7&&t&&!t[i$]&&T7(t,i$,{configurable:!0,get:function(){return this}})},a$=Qa,$7=Gd,l$=g0,A7=qd,I7=v0,M7=pn,x7=d0,D7=u0,Vv=f0,N7=nF,Mf=Ut,s$=Jd.fastKey,oF=jo,u$=oF.set,$b=oF.getterFor,iF={getConstructor:function(e,t,r,n){var o=e(function(u,f){I7(u,i),u$(u,{type:t,index:a$(null),first:void 0,last:void 0,size:0}),Mf||(u.size=0),M7(f)||x7(f,u[n],{that:u,AS_ENTRIES:r})}),i=o.prototype,a=$b(t),l=function(u,f,c){var h=a(u),d=s(u,f),v,g;return d?d.value=c:(h.last=d={index:g=s$(f,!0),key:f,value:c,previous:v=h.last,next:void 0,removed:!1},h.first||(h.first=d),v&&(v.next=d),Mf?h.size++:u.size++,g!=="F"&&(h.index[g]=d)),u},s=function(u,f){var c=a(u),h=s$(f),d;if(h!=="F")return c.index[h];for(d=c.first;d;d=d.next)if(d.key===f)return d};return l$(i,{clear:function(){for(var f=this,c=a(f),h=c.first;h;)h.removed=!0,h.previous&&(h.previous=h.previous.next=void 0),h=h.next;c.first=c.last=void 0,c.index=a$(null),Mf?c.size=0:f.size=0},delete:function(u){var f=this,c=a(f),h=s(f,u);if(h){var d=h.next,v=h.previous;delete c.index[h.index],h.removed=!0,v&&(v.next=d),d&&(d.previous=v),c.first===h&&(c.first=d),c.last===h&&(c.last=v),Mf?c.size--:f.size--}return!!h},forEach:function(f){for(var c=a(this),h=A7(f,arguments.length>1?arguments[1]:void 0),d;d=d?d.next:c.first;)for(h(d.value,d.key,this);d&&d.removed;)d=d.previous},has:function(f){return!!s(this,f)}}),l$(i,r?{get:function(f){var c=s(this,f);return c&&c.value},set:function(f,c){return l(this,f===0?0:f,c)}}:{add:function(f){return l(this,f=f===0?0:f,f)}}),Mf&&$7(i,"size",{configurable:!0,get:function(){return a(this).size}}),o},setStrong:function(e,t,r){var n=t+" Iterator",o=$b(t),i=$b(n);D7(e,t,function(a,l){u$(this,{type:n,target:a,state:o(a),kind:l,last:void 0})},function(){for(var a=i(this),l=a.kind,s=a.last;s&&s.removed;)s=s.previous;return!a.target||!(a.last=s=s?s.next:a.state.first)?(a.target=void 0,Vv(void 0,!0)):Vv(l==="keys"?s.key:l==="values"?s.value:[s.key,s.value],!1)},r?"entries":"values",!r,!0),N7(t)}},H7=am,L7=iF;H7("Set",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},L7);var p0=Ue,j7=$i,F7=Yt,B7=Tr,V7=p0("".charAt),f$=p0("".charCodeAt),W7=p0("".slice),c$=function(e){return function(t,r){var n=F7(B7(t)),o=j7(r),i=n.length,a,l;return o<0||o>=i?e?"":void 0:(a=f$(n,o),a<55296||a>56319||o+1===i||(l=f$(n,o+1))<56320||l>57343?e?V7(n,o):a:e?W7(n,o,o+2):(a-55296<<10)+(l-56320)+65536)}},m0={codeAt:c$(!1),charAt:c$(!0)},U7=m0.charAt,z7=Yt,aF=jo,Y7=u0,h$=f0,lF="String Iterator",G7=aF.set,K7=aF.getterFor(lF);Y7(String,"String",function(e){G7(this,{type:lF,string:z7(e),index:0})},function(){var t=K7(this),r=t.string,n=t.index,o;return n>=r.length?h$(void 0,!0):(o=U7(r,n),t.index+=o.length,h$(o,!1))});var sF={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},q7=Gp,Ab=q7("span").classList,d$=Ab&&Ab.constructor&&Ab.constructor.prototype,uF=d$===Object.prototype?void 0:d$,v$=vt,fF=sF,X7=uF,lc=P5,y$=Ka,Z7=Kd,Q7=wt,Ib=Q7("iterator"),Mb=lc.values,cF=function(e,t){if(e){if(e[Ib]!==Mb)try{y$(e,Ib,Mb)}catch{e[Ib]=Mb}if(Z7(e,t,!0),fF[t]){for(var r in lc)if(e[r]!==lc[r])try{y$(e,r,lc[r])}catch{e[r]=lc[r]}}}};for(var xb in fF)cF(v$[xb]&&v$[xb].prototype,xb);cF(X7,"DOMTokenList");var J7=$e,e9=YR.includes,t9=je,r9=ev,n9=t9(function(){return!Array(1).includes()});J7({target:"Array",proto:!0,forced:n9},{includes:function(t){return e9(this,t,arguments.length>1?arguments[1]:void 0)}});r9("includes");var g$=yf,o9=TypeError,hF=function(e,t){if(!delete e[t])throw new o9("Cannot delete property "+g$(t)+" of "+g$(e))},p$=Za,i9=Math.floor,aC=function(e,t){var r=e.length;if(r<8)for(var n=1,o,i;n<r;){for(i=n,o=e[n];i&&t(e[i-1],o)>0;)e[i]=e[--i];i!==n++&&(e[i]=o)}else for(var a=i9(r/2),l=aC(p$(e,0,a),t),s=aC(p$(e,a),t),u=l.length,f=s.length,c=0,h=0;c<u||h<f;)e[c+h]=c<u&&h<f?t(l[c],s[h])<=0?l[c++]:s[h++]:c<u?l[c++]:s[h++];return e},a9=aC,l9=je,bf=function(e,t){var r=[][e];return!!r&&l9(function(){r.call(null,t||function(){return 1},1)})},s9=za,m$=s9.match(/firefox\/(\d+)/i),u9=!!m$&&+m$[1],f9=za,c9=/MSIE|Trident/.test(f9),h9=za,b$=h9.match(/AppleWebKit\/(\d+)\./),d9=!!b$&&+b$[1],v9=$e,dF=Ue,y9=Ya,g9=Pr,w$=mn,p9=hF,S$=Yt,b0=je,m9=a9,b9=bf,C$=u9,w9=c9,_$=Fd,O$=d9,ii=[],R$=dF(ii.sort),S9=dF(ii.push),C9=b0(function(){ii.sort(void 0)}),_9=b0(function(){ii.sort(null)}),O9=b9("sort"),vF=!b0(function(){if(_$)return _$<70;if(!(C$&&C$>3)){if(w9)return!0;if(O$)return O$<603;var e="",t,r,n,o;for(t=65;t<76;t++){switch(r=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(o=0;o<47;o++)ii.push({k:r+o,v:n})}for(ii.sort(function(i,a){return a.v-i.v}),o=0;o<ii.length;o++)r=ii[o].k.charAt(0),e.charAt(e.length-1)!==r&&(e+=r);return e!=="DGBEFHACIJK"}}),R9=C9||!_9||!O9||!vF,E9=function(e){return function(t,r){return r===void 0?-1:t===void 0?1:e!==void 0?+e(t,r)||0:S$(t)>S$(r)?1:-1}};v9({target:"Array",proto:!0,forced:R9},{sort:function(t){t!==void 0&&y9(t);var r=g9(this);if(vF)return t===void 0?R$(r):R$(r,t);var n=[],o=w$(r),i,a;for(a=0;a<o;a++)a in r&&S9(n,r[a]);for(m9(n,E9(t)),i=w$(n),a=0;a<i;)r[a]=n[a++];for(;a<o;)p9(r,a++);return r}});var T9=Ut,P9=pf,k9=TypeError,$9=Object.getOwnPropertyDescriptor,A9=T9&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}(),I9=A9?function(e,t){if(P9(e)&&!$9(e,"length").writable)throw new k9("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t},M9=TypeError,x9=9007199254740991,yF=function(e){if(e>x9)throw M9("Maximum allowed index exceeded");return e},D9=Yp,N9=br,H9=Ld,nv=function(e,t,r){var n=D9(t);n in e?N9.f(e,n,H9(0,r)):e[n]=r},L9=je,j9=wt,F9=Fd,B9=j9("species"),ov=function(e){return F9>=51||!L9(function(){var t=[],r=t.constructor={};return r[B9]=function(){return{foo:1}},t[e](Boolean).foo!==1})},V9=$e,W9=Pr,U9=qp,z9=$i,Y9=mn,G9=I9,K9=yF,q9=JR,X9=nv,Db=hF,Z9=ov,Q9=Z9("splice"),J9=Math.max,eq=Math.min;V9({target:"Array",proto:!0,forced:!Q9},{splice:function(t,r){var n=W9(this),o=Y9(n),i=U9(t,o),a=arguments.length,l,s,u,f,c,h;for(a===0?l=s=0:a===1?(l=0,s=o-i):(l=a-2,s=eq(J9(z9(r),0),o-i)),K9(o+l-s),u=q9(n,s),f=0;f<s;f++)c=i+f,c in n&&X9(u,f,n[c]);if(u.length=s,l<s){for(f=i;f<o-s;f++)c=f+s,h=f+l,c in n?n[h]=n[c]:Db(n,h);for(f=o;f>o-s+l;f--)Db(n,f-1)}else if(l>s)for(f=o-s;f>i;f--)c=f+s-1,h=f+l-1,c in n?n[h]=n[c]:Db(n,h);for(f=0;f<l;f++)n[f+i]=arguments[f+2];return G9(n,o-s+l),u}});var tq=Nt,rq=Math.floor,nq=Number.isInteger||function(t){return!tq(t)&&isFinite(t)&&rq(t)===t},oq=$e,iq=nq;oq({target:"Number",stat:!0},{isInteger:iq});var aq=Ue,gF=aq(1 .valueOf),pF=`	
\v\f\r                　\u2028\u2029\uFEFF`,lq=Ue,sq=Tr,uq=Yt,lC=pF,E$=lq("".replace),fq=RegExp("^["+lC+"]+"),cq=RegExp("(^|[^"+lC+"])["+lC+"]+$"),Nb=function(e){return function(t){var r=uq(sq(t));return e&1&&(r=E$(r,fq,"")),e&2&&(r=E$(r,cq,"$1")),r}},mF={start:Nb(1),end:Nb(2),trim:Nb(3)},hq=$e,bF=zY,dq=Ut,wF=vt,SF=cj,CF=Ue,vq=Xp,T$=Mt,yq=y0,gq=ki,pq=Bd,_F=YL,mq=je,bq=qa.f,wq=Ln.f,Sq=br.f,Cq=gF,_q=mF.trim,lm="Number",Ul=wF[lm];SF[lm];var w0=Ul.prototype,Oq=wF.TypeError,Rq=CF("".slice),Wv=CF("".charCodeAt),Eq=function(e){var t=_F(e,"number");return typeof t=="bigint"?t:Tq(t)},Tq=function(e){var t=_F(e,"number"),r,n,o,i,a,l,s,u;if(pq(t))throw new Oq("Cannot convert a Symbol value to a number");if(typeof t=="string"&&t.length>2){if(t=_q(t),r=Wv(t,0),r===43||r===45){if(n=Wv(t,2),n===88||n===120)return NaN}else if(r===48){switch(Wv(t,1)){case 66:case 98:o=2,i=49;break;case 79:case 111:o=8,i=55;break;default:return+t}for(a=Rq(t,2),l=a.length,s=0;s<l;s++)if(u=Wv(a,s),u<48||u>i)return NaN;return parseInt(a,o)}}return+t},S0=vq(lm,!Ul(" 0o1")||!Ul("0b1")||Ul("+0x1")),Pq=function(e){return gq(w0,e)&&mq(function(){Cq(e)})},sm=function(t){var r=arguments.length<1?0:Ul(Eq(t));return Pq(this)?yq(Object(r),this,sm):r};sm.prototype=w0;S0&&!bF&&(w0.constructor=sm);hq({global:!0,constructor:!0,wrap:!0,forced:S0},{Number:sm});var kq=function(e,t){for(var r=dq?bq(t):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),n=0,o;r.length>n;n++)T$(t,o=r[n])&&!T$(e,o)&&Sq(e,o,wq(t,o))};(S0||bF)&&kq(SF[lm],Ul);var $q=$e,P$=pf,Aq=em,Iq=Nt,k$=qp,Mq=mn,xq=Br,Dq=nv,Nq=wt,Hq=ov,Lq=Za,jq=Hq("slice"),Fq=Nq("species"),Hb=Array,Bq=Math.max;$q({target:"Array",proto:!0,forced:!jq},{slice:function(t,r){var n=xq(this),o=Mq(n),i=k$(t,o),a=k$(r===void 0?o:r,o),l,s,u;if(P$(n)&&(l=n.constructor,Aq(l)&&(l===Hb||P$(l.prototype))?l=void 0:Iq(l)&&(l=l[Fq],l===null&&(l=void 0)),l===Hb||l===void 0))return Lq(n,i,a);for(s=new(l===void 0?Hb:l)(Bq(a-i,0)),u=0;i<a;i++,u++)i in n&&Dq(s,u,n[i]);return s.length=u,s}});var Vq=$e,Wq=je,Uq=pf,zq=Nt,Yq=Pr,Gq=mn,$$=yF,A$=nv,Kq=JR,qq=ov,Xq=wt,Zq=Fd,OF=Xq("isConcatSpreadable"),Qq=Zq>=51||!Wq(function(){var e=[];return e[OF]=!1,e.concat()[0]!==e}),Jq=function(e){if(!zq(e))return!1;var t=e[OF];return t!==void 0?!!t:Uq(e)},eX=!Qq||!qq("concat");Vq({target:"Array",proto:!0,arity:1,forced:eX},{concat:function(t){var r=Yq(this),n=Kq(r,0),o=0,i,a,l,s,u;for(i=-1,l=arguments.length;i<l;i++)if(u=i===-1?r:arguments[i],Jq(u))for(s=Gq(u),$$(o+s),a=0;a<s;a++,o++)a in u&&A$(n,o,u[a]);else $$(o+1),A$(n,o++,u);return n.length=o,n}});var tX=Pr,I$=qp,rX=mn,nX=function(t){for(var r=tX(this),n=rX(r),o=arguments.length,i=I$(o>1?arguments[1]:void 0,n),a=o>2?arguments[2]:void 0,l=a===void 0?n:I$(a,n);l>i;)r[i++]=t;return r},oX=$e,iX=nX,aX=ev;oX({target:"Array",proto:!0},{fill:iX});aX("fill");var lX=$e,sX=Ja.map,uX=ov,fX=uX("map");lX({target:"Array",proto:!0,forced:!fX},{map:function(t){return sX(this,t,arguments.length>1?arguments[1]:void 0)}});var cX=Ht,RF=function(){var e=cX(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},C0=je,hX=vt,_0=hX.RegExp,O0=C0(function(){var e=_0("a","y");return e.lastIndex=2,e.exec("abcd")!==null}),dX=O0||C0(function(){return!_0("a","y").sticky}),vX=O0||C0(function(){var e=_0("^r","gy");return e.lastIndex=2,e.exec("str")!==null}),R0={BROKEN_CARET:vX,MISSED_STICKY:dX,UNSUPPORTED_Y:O0},yX=je,gX=vt,pX=gX.RegExp,EF=yX(function(){var e=pX(".","s");return!(e.dotAll&&e.test(`
`)&&e.flags==="s")}),mX=je,bX=vt,wX=bX.RegExp,TF=mX(function(){var e=wX("(?<a>b)","g");return e.exec("b").groups.a!=="b"||"b".replace(e,"$<a>c")!=="bc"}),Fl=zt,um=Ue,SX=Yt,CX=RF,_X=R0,OX=gf,RX=Qa,EX=jo.get,TX=EF,PX=TF,kX=OX("native-string-replace",String.prototype.replace),Ag=RegExp.prototype.exec,sC=Ag,$X=um("".charAt),AX=um("".indexOf),IX=um("".replace),Lb=um("".slice),uC=function(){var e=/a/,t=/b*/g;return Fl(Ag,e,"a"),Fl(Ag,t,"a"),e.lastIndex!==0||t.lastIndex!==0}(),PF=_X.BROKEN_CARET,fC=/()??/.exec("")[1]!==void 0,MX=uC||fC||PF||TX||PX;MX&&(sC=function(t){var r=this,n=EX(r),o=SX(t),i=n.raw,a,l,s,u,f,c,h;if(i)return i.lastIndex=r.lastIndex,a=Fl(sC,i,o),r.lastIndex=i.lastIndex,a;var d=n.groups,v=PF&&r.sticky,g=Fl(CX,r),m=r.source,w=0,S=o;if(v&&(g=IX(g,"y",""),AX(g,"g")===-1&&(g+="g"),S=Lb(o,r.lastIndex),r.lastIndex>0&&(!r.multiline||r.multiline&&$X(o,r.lastIndex-1)!==`
`)&&(m="(?: "+m+")",S=" "+S,w++),l=new RegExp("^(?:"+m+")",g)),fC&&(l=new RegExp("^"+m+"$(?!\\s)",g)),uC&&(s=r.lastIndex),u=Fl(Ag,v?l:r,S),v?u?(u.input=Lb(u.input,w),u[0]=Lb(u[0],w),u.index=r.lastIndex,r.lastIndex+=u[0].length):r.lastIndex=0:uC&&u&&(r.lastIndex=r.global?u.index+u[0].length:s),fC&&u&&u.length>1&&Fl(kX,u[0],l,function(){for(f=1;f<arguments.length-2;f++)arguments[f]===void 0&&(u[f]=void 0)}),u&&d)for(u.groups=c=RX(null),f=0;f<d.length;f++)h=d[f],c[h[0]]=u[h[1]];return u});var E0=sC,xX=$e,M$=E0;xX({target:"RegExp",proto:!0,forced:/./.exec!==M$},{exec:M$});var x$=zt,D$=Xr,DX=E0,N$=je,kF=wt,NX=Ka,HX=kF("species"),jb=RegExp.prototype,fm=function(e,t,r,n){var o=kF(e),i=!N$(function(){var u={};return u[o]=function(){return 7},""[e](u)!==7}),a=i&&!N$(function(){var u=!1,f=/a/;return e==="split"&&(f={},f.constructor={},f.constructor[HX]=function(){return f},f.flags="",f[o]=/./[o]),f.exec=function(){return u=!0,null},f[o](""),!u});if(!i||!a||r){var l=/./[o],s=t(o,""[e],function(u,f,c,h,d){var v=f.exec;return v===DX||v===jb.exec?i&&!d?{done:!0,value:x$(l,f,c,h)}:{done:!0,value:x$(u,c,f,h)}:{done:!1}});D$(String.prototype,e,s[0]),D$(jb,o,s[1])}n&&NX(jb[o],"sham",!0)},LX=m0.charAt,T0=function(e,t,r){return t+(r?LX(e,t).length:1)},P0=Ue,jX=Pr,FX=Math.floor,Fb=P0("".charAt),BX=P0("".replace),Bb=P0("".slice),VX=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,WX=/\$([$&'`]|\d{1,2})/g,UX=function(e,t,r,n,o,i){var a=r+e.length,l=n.length,s=WX;return o!==void 0&&(o=jX(o),s=VX),BX(i,s,function(u,f){var c;switch(Fb(f,0)){case"$":return"$";case"&":return e;case"`":return Bb(t,0,r);case"'":return Bb(t,a);case"<":c=o[Bb(f,1,-1)];break;default:var h=+f;if(h===0)return u;if(h>l){var d=FX(h/10);return d===0?u:d<=l?n[d-1]===void 0?Fb(f,1):n[d-1]+Fb(f,1):u}c=n[h-1]}return c===void 0?"":c})},H$=zt,zX=Ht,YX=Et,GX=jn,KX=E0,qX=TypeError,cm=function(e,t){var r=e.exec;if(YX(r)){var n=H$(r,e,t);return n!==null&&zX(n),n}if(GX(e)==="RegExp")return H$(KX,e,t);throw new qX("RegExp#exec called on incompatible receiver")},XX=mf,L$=zt,hm=Ue,ZX=fm,QX=je,JX=Ht,eZ=Et,tZ=pn,rZ=$i,nZ=Xa,ll=Yt,oZ=Tr,iZ=T0,aZ=Ga,lZ=UX,sZ=cm,uZ=wt,cC=uZ("replace"),fZ=Math.max,cZ=Math.min,hZ=hm([].concat),Vb=hm([].push),j$=hm("".indexOf),F$=hm("".slice),dZ=function(e){return e===void 0?e:String(e)},vZ=function(){return"a".replace(/./,"$0")==="$0"}(),B$=function(){return/./[cC]?/./[cC]("a","$0")==="":!1}(),yZ=!QX(function(){var e=/./;return e.exec=function(){var t=[];return t.groups={a:"7"},t},"".replace(e,"$<a>")!=="7"});ZX("replace",function(e,t,r){var n=B$?"$":"$0";return[function(i,a){var l=oZ(this),s=tZ(i)?void 0:aZ(i,cC);return s?L$(s,i,l,a):L$(t,ll(l),i,a)},function(o,i){var a=JX(this),l=ll(o);if(typeof i=="string"&&j$(i,n)===-1&&j$(i,"$<")===-1){var s=r(t,a,l,i);if(s.done)return s.value}var u=eZ(i);u||(i=ll(i));var f=a.global,c;f&&(c=a.unicode,a.lastIndex=0);for(var h=[],d;d=sZ(a,l),!(d===null||(Vb(h,d),!f));){var v=ll(d[0]);v===""&&(a.lastIndex=iZ(l,nZ(a.lastIndex),c))}for(var g="",m=0,w=0;w<h.length;w++){d=h[w];for(var S=ll(d[0]),C=fZ(cZ(rZ(d.index),l.length),0),P=[],R,V=1;V<d.length;V++)Vb(P,dZ(d[V]));var U=d.groups;if(u){var X=hZ([S],P,C,l);U!==void 0&&Vb(X,U),R=ll(XX(i,void 0,X))}else R=lZ(S,l,C,P,U,i);C>=m&&(g+=F$(l,m,C)+R,m=C+S.length)}return g+F$(l,m)}]},!yZ||!vZ||B$);var gZ=Ht,pZ=Jj,mZ=function(e,t,r,n){try{return n?t(gZ(r)[0],r[1]):t(r)}catch(o){pZ(e,"throw",o)}},bZ=qd,wZ=zt,SZ=Pr,CZ=mZ,_Z=Zj,OZ=em,RZ=mn,V$=nv,EZ=Qj,TZ=h0,W$=Array,PZ=function(t){var r=SZ(t),n=OZ(this),o=arguments.length,i=o>1?arguments[1]:void 0,a=i!==void 0;a&&(i=bZ(i,o>2?arguments[2]:void 0));var l=TZ(r),s=0,u,f,c,h,d,v;if(l&&!(this===W$&&_Z(l)))for(h=EZ(r,l),d=h.next,f=n?new this:[];!(c=wZ(d,h)).done;s++)v=a?CZ(h,i,[c.value,s],!0):c.value,V$(f,s,v);else for(u=RZ(r),f=n?new this(u):W$(u);u>s;s++)v=a?i(r[s],s):r[s],V$(f,s,v);return f.length=s,f},kZ=$e,$Z=PZ,AZ=rF,IZ=!AZ(function(e){Array.from(e)});kZ({target:"Array",stat:!0,forced:IZ},{from:$Z});var MZ=$e,xZ=Jp,DZ=YR.indexOf,NZ=bf,hC=xZ([].indexOf),$F=!!hC&&1/hC([1],1,-0)<0,HZ=$F||!NZ("indexOf");MZ({target:"Array",proto:!0,forced:HZ},{indexOf:function(t){var r=arguments.length>1?arguments[1]:void 0;return $F?hC(this,t,r)||0:DZ(this,t,r)}});var LZ=$e,jZ=Ue,FZ=pf,BZ=jZ([].reverse),U$=[1,2];LZ({target:"Array",proto:!0,forced:String(U$)===String(U$.reverse())},{reverse:function(){return FZ(this)&&(this.length=this.length),BZ(this)}});var VZ=Ja.forEach,WZ=bf,UZ=WZ("forEach"),zZ=UZ?[].forEach:function(t){return VZ(this,t,arguments.length>1?arguments[1]:void 0)},z$=vt,Y$=sF,YZ=uF,Wb=zZ,GZ=Ka,AF=function(e){if(e&&e.forEach!==Wb)try{GZ(e,"forEach",Wb)}catch{e.forEach=Wb}};for(var Ub in Y$)Y$[Ub]&&AF(z$[Ub]&&z$[Ub].prototype);AF(YZ);var KZ=typeof Bun=="function"&&Bun&&typeof Bun.version=="string",qZ=TypeError,IF=function(e,t){if(e<t)throw new qZ("Not enough arguments");return e},MF=vt,XZ=mf,ZZ=Et,QZ=KZ,JZ=za,eQ=Za,tQ=IF,rQ=MF.Function,nQ=/MSIE .\./.test(JZ)||QZ&&function(){var e=MF.Bun.version.split(".");return e.length<3||e[0]==="0"&&(e[1]<3||e[1]==="3"&&e[2]==="0")}(),k0=function(e,t){var r=t?2:1;return nQ?function(n,o){var i=tQ(arguments.length,1)>r,a=ZZ(n)?n:rQ(n),l=i?eQ(arguments,r):[],s=i?function(){XZ(a,this,l)}:a;return t?e(s,o):e(s)}:e},oQ=$e,xF=vt,iQ=k0,G$=iQ(xF.setInterval,!0);oQ({global:!0,bind:!0,forced:xF.setInterval!==G$},{setInterval:G$});var aQ=$e,DF=vt,lQ=k0,K$=lQ(DF.setTimeout,!0);aQ({global:!0,bind:!0,forced:DF.setTimeout!==K$},{setTimeout:K$});var sQ=za,uQ=/(?:ipad|iphone|ipod).*applewebkit/i.test(sQ),fQ=vt,cQ=jn,NF=cQ(fQ.process)==="process",Lr=vt,hQ=mf,dQ=qd,q$=Et,vQ=Mt,HF=je,X$=sj,yQ=Za,Z$=Gp,gQ=IF,pQ=uQ,mQ=NF,dC=Lr.setImmediate,vC=Lr.clearImmediate,bQ=Lr.process,zb=Lr.Dispatch,wQ=Lr.Function,Q$=Lr.MessageChannel,SQ=Lr.String,Yb=0,dc={},J$="onreadystatechange",Ic,Di,Gb,Kb;HF(function(){Ic=Lr.location});var $0=function(e){if(vQ(dc,e)){var t=dc[e];delete dc[e],t()}},qb=function(e){return function(){$0(e)}},e1=function(e){$0(e.data)},t1=function(e){Lr.postMessage(SQ(e),Ic.protocol+"//"+Ic.host)};(!dC||!vC)&&(dC=function(t){gQ(arguments.length,1);var r=q$(t)?t:wQ(t),n=yQ(arguments,1);return dc[++Yb]=function(){hQ(r,void 0,n)},Di(Yb),Yb},vC=function(t){delete dc[t]},mQ?Di=function(e){bQ.nextTick(qb(e))}:zb&&zb.now?Di=function(e){zb.now(qb(e))}:Q$&&!pQ?(Gb=new Q$,Kb=Gb.port2,Gb.port1.onmessage=e1,Di=dQ(Kb.postMessage,Kb)):Lr.addEventListener&&q$(Lr.postMessage)&&!Lr.importScripts&&Ic&&Ic.protocol!=="file:"&&!HF(t1)?(Di=t1,Lr.addEventListener("message",e1,!1)):J$ in Z$("script")?Di=function(e){X$.appendChild(Z$("script"))[J$]=function(){X$.removeChild(this),$0(e)}}:Di=function(e){setTimeout(qb(e),0)});var LF={set:dC,clear:vC},CQ=$e,_Q=vt,r1=LF.clear;CQ({global:!0,bind:!0,enumerable:!0,forced:_Q.clearImmediate!==r1},{clearImmediate:r1});var OQ=$e,jF=vt,n1=LF.set,RQ=k0,o1=jF.setImmediate?RQ(n1,!1):n1;OQ({global:!0,bind:!0,enumerable:!0,forced:jF.setImmediate!==o1},{setImmediate:o1});var EQ=am,TQ=iF;EQ("Map",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},TQ);var PQ=$e,kQ=je,$Q=Pr,FF=rv,AQ=Uj,IQ=kQ(function(){FF(1)});PQ({target:"Object",stat:!0,forced:IQ,sham:!AQ},{getPrototypeOf:function(t){return FF($Q(t))}});var MQ=Nt,xQ=jn,DQ=wt,NQ=DQ("match"),BF=function(e){var t;return MQ(e)&&((t=e[NQ])!==void 0?!!t:xQ(e)==="RegExp")},HQ=BF,LQ=TypeError,A0=function(e){if(HQ(e))throw new LQ("The method doesn't accept regular expressions");return e},jQ=wt,FQ=jQ("match"),I0=function(e){var t=/./;try{"/./"[e](t)}catch{try{return t[FQ]=!1,"/./"[e](t)}catch{}}return!1},BQ=$e,VQ=Ue,WQ=A0,UQ=Tr,i1=Yt,zQ=I0,YQ=VQ("".indexOf);BQ({target:"String",proto:!0,forced:!zQ("includes")},{includes:function(t){return!!~YQ(i1(UQ(this)),i1(WQ(t)),arguments.length>1?arguments[1]:void 0)}});var GQ=$e,KQ=Ja.filter,qQ=ov,XQ=qQ("filter");GQ({target:"Array",proto:!0,forced:!XQ},{filter:function(t){return KQ(this,t,arguments.length>1?arguments[1]:void 0)}});var ZQ=zt,QQ=Mt,JQ=ki,eJ=RF,a1=RegExp.prototype,VF=function(e){var t=e.flags;return t===void 0&&!("flags"in a1)&&!QQ(e,"flags")&&JQ(a1,e)?ZQ(eJ,e):t},tJ=br.f,rJ=function(e,t,r){r in e||tJ(e,r,{configurable:!0,get:function(){return t[r]},set:function(n){t[r]=n}})},nJ=Ut,M0=vt,iv=Ue,oJ=Xp,iJ=y0,aJ=Ka,lJ=Qa,sJ=qa.f,l1=ki,uJ=BF,s1=Yt,fJ=VF,WF=R0,cJ=rJ,hJ=Xr,dJ=je,vJ=Mt,yJ=jo.enforce,gJ=nF,pJ=wt,UF=EF,zF=TF,mJ=pJ("match"),ui=M0.RegExp,Dl=ui.prototype,bJ=M0.SyntaxError,wJ=iv(Dl.exec),Ig=iv("".charAt),u1=iv("".replace),f1=iv("".indexOf),SJ=iv("".slice),CJ=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,ka=/a/g,Xb=/a/g,_J=new ui(ka)!==ka,YF=WF.MISSED_STICKY,OJ=WF.UNSUPPORTED_Y,RJ=nJ&&(!_J||YF||UF||zF||dJ(function(){return Xb[mJ]=!1,ui(ka)!==ka||ui(Xb)===Xb||String(ui(ka,"i"))!=="/a/i"})),EJ=function(e){for(var t=e.length,r=0,n="",o=!1,i;r<=t;r++){if(i=Ig(e,r),i==="\\"){n+=i+Ig(e,++r);continue}!o&&i==="."?n+="[\\s\\S]":(i==="["?o=!0:i==="]"&&(o=!1),n+=i)}return n},TJ=function(e){for(var t=e.length,r=0,n="",o=[],i=lJ(null),a=!1,l=!1,s=0,u="",f;r<=t;r++){if(f=Ig(e,r),f==="\\")f+=Ig(e,++r);else if(f==="]")a=!1;else if(!a)switch(!0){case f==="[":a=!0;break;case f==="(":wJ(CJ,SJ(e,r+1))&&(r+=2,l=!0),n+=f,s++;continue;case(f===">"&&l):if(u===""||vJ(i,u))throw new bJ("Invalid capture group name");i[u]=!0,o[o.length]=[u,s],l=!1,u="";continue}l?u+=f:n+=f}return[n,o]};if(oJ("RegExp",RJ)){for(var Ni=function(t,r){var n=l1(Dl,this),o=uJ(t),i=r===void 0,a=[],l=t,s,u,f,c,h,d;if(!n&&o&&i&&t.constructor===Ni)return t;if((o||l1(Dl,t))&&(t=t.source,i&&(r=fJ(l))),t=t===void 0?"":s1(t),r=r===void 0?"":s1(r),l=t,UF&&"dotAll"in ka&&(u=!!r&&f1(r,"s")>-1,u&&(r=u1(r,/s/g,""))),s=r,YF&&"sticky"in ka&&(f=!!r&&f1(r,"y")>-1,f&&OJ&&(r=u1(r,/y/g,""))),zF&&(c=TJ(t),t=c[0],a=c[1]),h=iJ(ui(t,r),n?this:Dl,Ni),(u||f||a.length)&&(d=yJ(h),u&&(d.dotAll=!0,d.raw=Ni(EJ(t),s)),f&&(d.sticky=!0),a.length&&(d.groups=a)),t!==l)try{aJ(h,"source",l===""?"(?:)":l)}catch{}return h},c1=sJ(ui),h1=0;c1.length>h1;)cJ(Ni,ui,c1[h1++]);Dl.constructor=Ni,Ni.prototype=Dl,hJ(M0,"RegExp",Ni,{constructor:!0})}gJ("RegExp");var PJ=Vd.PROPER,kJ=Xr,$J=Ht,d1=Yt,AJ=je,IJ=VF,x0="toString",GF=RegExp.prototype,KF=GF[x0],MJ=AJ(function(){return KF.call({source:"a",flags:"b"})!=="/a/b"}),xJ=PJ&&KF.name!==x0;(MJ||xJ)&&kJ(GF,x0,function(){var t=$J(this),r=d1(t.source),n=d1(IJ(t));return"/"+r+"/"+n},{unsafe:!0});var DJ=$e,NJ=Ue,HJ=jd,LJ=Br,jJ=bf,FJ=NJ([].join),BJ=HJ!==Object,VJ=BJ||!jJ("join",",");DJ({target:"Array",proto:!0,forced:VJ},{join:function(t){return FJ(LJ(this),t===void 0?",":t)}});var WJ=Vd.PROPER,UJ=je,v1=pF,y1="​᠎",zJ=function(e){return UJ(function(){return!!v1[e]()||y1[e]()!==y1||WJ&&v1[e].name!==e})},YJ=$e,GJ=mF.trim,KJ=zJ;YJ({target:"String",proto:!0,forced:KJ("trim")},{trim:function(){return GJ(this)}});function yC(e){"@babel/helpers - typeof";return yC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yC(e)}function dm(e){return window.requestAnimationFrame(e)}function qF(){return!!document.documentElement.classList}function XF(){return!!document.createTextNode("test").textContent}function ZF(){return!!window.getComputedStyle}function Mc(e){window.cancelAnimationFrame(e)}function D0(){return"ontouchstart"in window}var gC;function qJ(){var e=document.createElement("TABLE");e.style.borderSpacing="0",e.style.borderWidth="0",e.style.padding="0";var t=document.createElement("TBODY");e.appendChild(t),t.appendChild(document.createElement("TR")),t.firstChild.appendChild(document.createElement("TD")),t.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var r=document.createElement("CAPTION");r.innerHTML="c<br>c<br>c<br>c",r.style.padding="0",r.style.margin="0",e.insertBefore(r,t),document.body.appendChild(e),gC=e.offsetHeight<2*e.lastChild.offsetHeight,document.body.removeChild(e)}function N0(){return gC===void 0&&qJ(),gC}var sl;function QF(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return sl||((typeof Intl>"u"?"undefined":yC(Intl))==="object"?sl=new Intl.Collator(e,t).compare:typeof String.prototype.localeCompare=="function"?sl=function(n,o){return"".concat(n).localeCompare(o)}:sl=function(n,o){return n===o?0:n>o?-1:1},sl)}var xf;function JF(){if(xf!==void 0)return xf;try{var e={get passive(){xf=!0}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch{xf=!1}return xf}const XJ=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:Mc,getComparisonFunction:QF,hasCaptionProblem:N0,isClassListSupported:qF,isGetComputedStyleSupported:ZF,isPassiveEventSupported:JF,isTextContentSupported:XF,isTouchSupported:D0,requestAnimationFrame:dm},Symbol.toStringTag,{value:"Module"}));var ZJ=ZR,QJ=hj;ZJ("toPrimitive");QJ();var JJ=Ht,eee=UL,tee=TypeError,ree=function(e){if(JJ(this),e==="string"||e==="default")e="string";else if(e!=="number")throw new tee("Incorrect hint");return eee(this,e)},nee=Mt,oee=Xr,iee=ree,aee=wt,g1=aee("toPrimitive"),p1=Date.prototype;nee(p1,g1)||oee(p1,g1,iee);var lee=em,see=yf,uee=TypeError,eB=function(e){if(lee(e))return e;throw new uee(see(e)+" is not a constructor")},m1=Ht,fee=eB,cee=pn,hee=wt,dee=hee("species"),vee=function(e,t){var r=m1(e).constructor,n;return r===void 0||cee(n=m1(r)[dee])?t:fee(n)},Zb=zt,tB=Ue,yee=fm,gee=Ht,pee=pn,mee=Tr,bee=vee,wee=T0,See=Xa,b1=Yt,Cee=Ga,w1=cm,_ee=R0,Oee=je,ul=_ee.UNSUPPORTED_Y,Ree=4294967295,Eee=Math.min,Qb=tB([].push),Jb=tB("".slice),Tee=!Oee(function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return r.length!==2||r[0]!=="a"||r[1]!=="b"}),S1="abbc".split(/(b)*/)[1]==="c"||"test".split(/(?:)/,-1).length!==4||"ab".split(/(?:ab)*/).length!==2||".".split(/(.?)(.?)/).length!==4||".".split(/()()/).length>1||"".split(/.?/).length;yee("split",function(e,t,r){var n="0".split(void 0,0).length?function(o,i){return o===void 0&&i===0?[]:Zb(t,this,o,i)}:t;return[function(i,a){var l=mee(this),s=pee(i)?void 0:Cee(i,e);return s?Zb(s,i,l,a):Zb(n,b1(l),i,a)},function(o,i){var a=gee(this),l=b1(o);if(!S1){var s=r(n,a,l,i,n!==t);if(s.done)return s.value}var u=bee(a,RegExp),f=a.unicode,c=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(ul?"g":"y"),h=new u(ul?"^(?:"+a.source+")":a,c),d=i===void 0?Ree:i>>>0;if(d===0)return[];if(l.length===0)return w1(h,l)===null?[l]:[];for(var v=0,g=0,m=[];g<l.length;){h.lastIndex=ul?0:g;var w=w1(h,ul?Jb(l,g):l),S;if(w===null||(S=Eee(See(h.lastIndex+(ul?g:0)),l.length))===v)g=wee(l,g,f);else{if(Qb(m,Jb(l,v,g)),m.length===d)return m;for(var C=1;C<=w.length-1;C++)if(Qb(m,w[C]),m.length===d)return m;g=v=S}}return Qb(m,Jb(l,v)),m}]},S1||!Tee,ul);function rB(e){for(var t=e.length,r=0;r<t;)e[r]=[e[r]],r+=1}function pC(e,t){for(var r=t.length,n=0;n<r;)e.push(t[n]),n+=1}function vc(e){var t=[];if(!e||e.length===0||!e[0]||e[0].length===0)return t;for(var r=e.length,n=e[0].length,o=0;o<r;o++)for(var i=0;i<n;i++)t[i]||(t[i]=[]),t[i][o]=e[o][i];return t}function Lt(e,t,r,n){var o=-1,i=e,a=r;Array.isArray(e)||(i=Array.from(e));var l=i.length;for(n&&l&&(o+=1,a=i[o]),o+=1;o<l;)a=t(a,i[o],o,i),o+=1;return a}function jr(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var o=n.length,i=[],a=-1;r<o;){var l=n[r];t(l,r,n)&&(a+=1,i[a]=l),r+=1}return i}function Be(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var o=n.length,i=[],a=-1;r<o;){var l=n[r];a+=1,i[a]=t(l,r,n),r+=1}return i}function $(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var o=n.length;r<o&&t(n[r],r,n)!==!1;)r+=1;return e}function nB(e){return Lt(e,function(t,r){return t+r},0)}function Pee(e){return Lt(e,function(t,r){return t>r?t:r},Array.isArray(e)?e[0]:void 0)}function kee(e){return Lt(e,function(t,r){return t<r?t:r},Array.isArray(e)?e[0]:void 0)}function $ee(e){return e.length?nB(e)/e.length:0}function oB(e){return Lt(e,function(t,r){return t.concat(Array.isArray(r)?oB(r):r)},[])}function H0(e){var t=[];return $(e,function(r){t.indexOf(r)===-1&&t.push(r)}),t}function mC(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),o=n[0],i=n.slice(1),a=o;return $(i,function(l){a=a.filter(function(s){return!l.includes(s)})}),a}function Aee(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),o=n[0],i=n.slice(1),a=o;return $(i,function(l){a=a.filter(function(s){return l.includes(s)})}),a}function Iee(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),o=n[0],i=n.slice(1),a=new Set(o);return $(i,function(l){$(l,function(s){a.has(s)||a.add(s)})}),Array.from(a)}function bC(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return e.split(t)}const Mee=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:$ee,arrayEach:$,arrayFilter:jr,arrayFlatten:oB,arrayMap:Be,arrayMax:Pee,arrayMin:kee,arrayReduce:Lt,arraySum:nB,arrayUnique:H0,extendArray:pC,getDifferenceOfArrays:mC,getIntersectionOfArrays:Aee,getUnionOfArrays:Iee,pivot:vc,stringToArray:bC,to2dArray:rB},Symbol.toStringTag,{value:"Module"}));function C1(e,t,r){return t=xee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xee(e){var t=Dee(e,"string");return Do(t)==="symbol"?t:String(t)}function Dee(e,t){if(Do(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Do(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Do(e){"@babel/helpers - typeof";return Do=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Do(e)}function ss(e){var t;return Array.isArray(e)?t=e.length?new Array(e.length).fill(null):[]:(t={},We(e,function(r,n){n!=="__children"&&(r&&Do(r)==="object"&&!Array.isArray(r)?t[n]=ss(r):Array.isArray(r)?r.length&&Do(r[0])==="object"&&!Array.isArray(r[0])?t[n]=[ss(r[0])]:t[n]=[]:t[n]=null)})),t}function Fo(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e,e}function Wt(e,t,r){var n=Array.isArray(r);return We(t,function(o,i){(n===!1||r.includes(i))&&(e[i]=o)}),e}function av(e,t){We(t,function(r,n){t[n]&&Do(t[n])==="object"?(e[n]||(Array.isArray(t[n])?e[n]=[]:Object.prototype.toString.call(t[n])==="[object Date]"?e[n]=t[n]:e[n]={}),av(e[n],t[n])):e[n]=t[n]})}function lr(e){return Do(e)==="object"?JSON.parse(JSON.stringify(e)):e}function pr(e){var t={};return We(e,function(r,n){t[n]=r}),t}function pt(e){e.MIXINS||(e.MIXINS=[]);for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return $(r,function(o){e.MIXINS.push(o.MIXIN_NAME),We(o,function(i,a){if(e.prototype[a]!==void 0)throw new Error("Mixin conflict. Property '".concat(a,"' already exist and cannot be overwritten."));if(typeof i=="function")e.prototype[a]=i;else{var l=function(f,c){var h="_".concat(f),d=function(g){var m=g;return(Array.isArray(m)||Ve(m))&&(m=lr(m)),m};return function(){return this[h]===void 0&&(this[h]=d(c)),this[h]}},s=function(f){var c="_".concat(f);return function(h){this[c]=h}};Object.defineProperty(e.prototype,a,{get:l(a,i),set:s(a),configurable:!0})}})}),e}function vm(e,t){return JSON.stringify(e)===JSON.stringify(t)}function Ve(e){return Object.prototype.toString.call(e)==="[object Object]"}function Fn(e,t,r,n){n.value=r,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(e,t,n)}function We(e,t){for(var r in e)if((!e.hasOwnProperty||e.hasOwnProperty&&Object.prototype.hasOwnProperty.call(e,r))&&t(e[r],r,e)===!1)break;return e}function iB(e,t){var r=t.split("."),n=e;return We(r,function(o){if(n=n[o],n===void 0)return n=void 0,!1}),n}function zy(e,t,r){var n=t.split("."),o=e;n.forEach(function(i,a){a!==n.length-1?(At(o,i)||(o[i]={}),o=o[i]):o[i]=r})}function ym(e){if(!Ve(e))return 0;var t=function r(n){var o=0;return Ve(n)?We(n,function(i,a){a!=="__children"&&(o+=r(i))}):o+=1,o};return t(e)}function Ia(e){var t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value",n="_".concat(r),o=(t={_touched:!1},C1(t,n,e),C1(t,"isTouched",function(){return this._touched}),t);return Object.defineProperty(o,r,{get:function(){return this[n]},set:function(a){this._touched=!0,this[n]=a},enumerable:!0,configurable:!0}),o}function At(e,t){return Object.prototype.hasOwnProperty.call(e,t)}const Nee=Object.freeze(Object.defineProperty({__proto__:null,clone:pr,createObjectPropListener:Ia,deepClone:lr,deepExtend:av,deepObjectSize:ym,defineGetter:Fn,duckSchema:ss,extend:Wt,getProperty:iB,hasOwnProperty:At,inherit:Fo,isObject:Ve,isObjectEqual:vm,mixin:pt,objectEach:We,setProperty:zy},Symbol.toStringTag,{value:"Module"}));var Rr=function(t){var r={value:!1};return r.test=function(n,o){r.value=t(n,o)},r},Fr={chrome:Rr(function(e,t){return/Chrome/.test(e)&&/Google/.test(t)}),chromeWebKit:Rr(function(e){return/CriOS/.test(e)}),edge:Rr(function(e){return/Edge/.test(e)}),edgeWebKit:Rr(function(e){return/EdgiOS/.test(e)}),firefox:Rr(function(e){return/Firefox/.test(e)}),firefoxWebKit:Rr(function(e){return/FxiOS/.test(e)}),ie:Rr(function(e){return/Trident/.test(e)}),ie9:Rr(function(){return!!document.documentMode}),mobile:Rr(function(e){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)}),safari:Rr(function(e,t){return/Safari/.test(e)&&/Apple Computer/.test(t)})},wf={mac:Rr(function(e){return/^Mac/.test(e)}),win:Rr(function(e){return/^Win/.test(e)}),linux:Rr(function(e){return/^Linux/.test(e)}),ios:Rr(function(e){return/iPhone|iPad|iPod/i.test(e)})};function aB(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.userAgent,r=t===void 0?navigator.userAgent:t,n=e.vendor,o=n===void 0?navigator.vendor:n;We(Fr,function(i){var a=i.test;return void a(r,o)})}function lB(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.platform,r=t===void 0?navigator.platform:t;We(wf,function(n){var o=n.test;return void o(r)})}aB();lB();function L0(){return Fr.chrome.value}function sB(){return Fr.chromeWebKit.value}function Yy(){return Fr.firefox.value}function uB(){return Fr.firefoxWebKit.value}function fB(){return Fr.safari.value}function cB(){return Fr.edge.value}function Hee(){return Fr.edgeWebKit.value}function hB(){return Fr.ie.value}function dB(){return Fr.ie9.value}function Lee(){return Fr.ie.value||Fr.edge.value}function fn(){return Fr.mobile.value}function j0(){return wf.ios.value}function F0(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator,t=e.maxTouchPoints;return t>2&&wf.mac.value}function wC(){return wf.win.value}function Mg(){return wf.mac.value}function jee(){return wf.linux.value}const Fee=Object.freeze(Object.defineProperty({__proto__:null,isChrome:L0,isChromeWebKit:sB,isEdge:cB,isEdgeWebKit:Hee,isFirefox:Yy,isFirefoxWebKit:uB,isIE:hB,isIE9:dB,isIOS:j0,isIpadOS:F0,isLinuxOS:jee,isMSBrowser:Lee,isMacOS:Mg,isMobileBrowser:fn,isSafari:fB,isWindowsOS:wC,setBrowserMeta:aB,setPlatformMeta:lB},Symbol.toStringTag,{value:"Module"}));/*! @license DOMPurify 2.4.7 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.7/LICENSE */function ni(e){"@babel/helpers - typeof";return ni=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ni(e)}function SC(e,t){return SC=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},SC(e,t)}function Bee(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Gy(e,t,r){return Bee()?Gy=Reflect.construct:Gy=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&SC(u,a.prototype),u},Gy.apply(null,arguments)}function nn(e){return Vee(e)||Wee(e)||Uee(e)||zee()}function Vee(e){if(Array.isArray(e))return CC(e)}function Wee(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Uee(e,t){if(e){if(typeof e=="string")return CC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return CC(e,t)}}function CC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function zee(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Yee=Object.hasOwnProperty,_1=Object.setPrototypeOf,Gee=Object.isFrozen,Kee=Object.getPrototypeOf,qee=Object.getOwnPropertyDescriptor,mr=Object.freeze,hn=Object.seal,Xee=Object.create,vB=typeof Reflect<"u"&&Reflect,xg=vB.apply,_C=vB.construct;xg||(xg=function(t,r,n){return t.apply(r,n)});mr||(mr=function(t){return t});hn||(hn=function(t){return t});_C||(_C=function(t,r){return Gy(t,nn(r))});var Zee=qr(Array.prototype.forEach),O1=qr(Array.prototype.pop),Df=qr(Array.prototype.push),Ky=qr(String.prototype.toLowerCase),ew=qr(String.prototype.toString),Qee=qr(String.prototype.match),en=qr(String.prototype.replace),Jee=qr(String.prototype.indexOf),ete=qr(String.prototype.trim),fr=qr(RegExp.prototype.test),tw=tte(TypeError);function qr(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return xg(e,t,n)}}function tte(e){return function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return _C(e,r)}}function Ke(e,t,r){var n;r=(n=r)!==null&&n!==void 0?n:Ky,_1&&_1(e,null);for(var o=t.length;o--;){var i=t[o];if(typeof i=="string"){var a=r(i);a!==i&&(Gee(t)||(t[o]=a),i=a)}e[i]=!0}return e}function Hi(e){var t=Xee(null),r;for(r in e)xg(Yee,e,[r])===!0&&(t[r]=e[r]);return t}function Uv(e,t){for(;e!==null;){var r=qee(e,t);if(r){if(r.get)return qr(r.get);if(typeof r.value=="function")return qr(r.value)}e=Kee(e)}function n(o){return console.warn("fallback value for",o),null}return n}var R1=mr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),rw=mr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),nw=mr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),rte=mr(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),ow=mr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),nte=mr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),E1=mr(["#text"]),T1=mr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),iw=mr(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),P1=mr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),zv=mr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),ote=hn(/\{\{[\w\W]*|[\w\W]*\}\}/gm),ite=hn(/<%[\w\W]*|[\w\W]*%>/gm),ate=hn(/\${[\w\W]*}/gm),lte=hn(/^data-[\-\w.\u00B7-\uFFFF]/),ste=hn(/^aria-[\-\w]+$/),ute=hn(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),fte=hn(/^(?:\w+script|data):/i),cte=hn(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),hte=hn(/^html$/i),dte=function(){return typeof window>"u"?null:window},vte=function(t,r){if(ni(t)!=="object"||typeof t.createPolicy!="function")return null;var n=null,o="data-tt-policy-suffix";r.currentScript&&r.currentScript.hasAttribute(o)&&(n=r.currentScript.getAttribute(o));var i="dompurify"+(n?"#"+n:"");try{return t.createPolicy(i,{createHTML:function(l){return l},createScriptURL:function(l){return l}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}};function yB(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:dte(),t=function(N){return yB(N)};if(t.version="2.4.7",t.removed=[],!e||!e.document||e.document.nodeType!==9)return t.isSupported=!1,t;var r=e.document,n=e.document,o=e.DocumentFragment,i=e.HTMLTemplateElement,a=e.Node,l=e.Element,s=e.NodeFilter,u=e.NamedNodeMap,f=u===void 0?e.NamedNodeMap||e.MozNamedAttrMap:u,c=e.HTMLFormElement,h=e.DOMParser,d=e.trustedTypes,v=l.prototype,g=Uv(v,"cloneNode"),m=Uv(v,"nextSibling"),w=Uv(v,"childNodes"),S=Uv(v,"parentNode");if(typeof i=="function"){var C=n.createElement("template");C.content&&C.content.ownerDocument&&(n=C.content.ownerDocument)}var P=vte(d,r),R=P?P.createHTML(""):"",V=n,U=V.implementation,X=V.createNodeIterator,Y=V.createDocumentFragment,q=V.getElementsByTagName,Z=r.importNode,ie={};try{ie=Hi(n).documentMode?n.documentMode:{}}catch{}var Q={};t.isSupported=typeof S=="function"&&U&&U.createHTMLDocument!==void 0&&ie!==9;var le=ote,Se=ite,me=ate,Ce=lte,k=ste,y=fte,p=cte,b=ute,_=null,T=Ke({},[].concat(nn(R1),nn(rw),nn(nw),nn(ow),nn(E1))),I=null,F=Ke({},[].concat(nn(T1),nn(iw),nn(P1),nn(zv))),W=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),G=null,J=null,ee=!0,se=!0,Re=!1,ce=!0,de=!1,K=!1,Me=!1,Ge=!1,Pe=!1,Ae=!1,ke=!1,O=!0,E=!1,A="user-content-",H=!0,M=!1,j={},x=null,D=Ke({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),B=null,L=Ke({},["audio","video","img","source","image","track"]),z=null,ae=Ke({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ge="http://www.w3.org/1998/Math/MathML",Oe="http://www.w3.org/2000/svg",De="http://www.w3.org/1999/xhtml",qe=De,ct=!1,Ne=null,He=Ke({},[ge,Oe,De],ew),rt,it=["application/xhtml+xml","text/html"],Je="text/html",Xe,Qe=null,jt=n.createElement("form"),yt=function(N){return N instanceof RegExp||N instanceof Function},st=function(N){Qe&&Qe===N||((!N||ni(N)!=="object")&&(N={}),N=Hi(N),rt=it.indexOf(N.PARSER_MEDIA_TYPE)===-1?rt=Je:rt=N.PARSER_MEDIA_TYPE,Xe=rt==="application/xhtml+xml"?ew:Ky,_="ALLOWED_TAGS"in N?Ke({},N.ALLOWED_TAGS,Xe):T,I="ALLOWED_ATTR"in N?Ke({},N.ALLOWED_ATTR,Xe):F,Ne="ALLOWED_NAMESPACES"in N?Ke({},N.ALLOWED_NAMESPACES,ew):He,z="ADD_URI_SAFE_ATTR"in N?Ke(Hi(ae),N.ADD_URI_SAFE_ATTR,Xe):ae,B="ADD_DATA_URI_TAGS"in N?Ke(Hi(L),N.ADD_DATA_URI_TAGS,Xe):L,x="FORBID_CONTENTS"in N?Ke({},N.FORBID_CONTENTS,Xe):D,G="FORBID_TAGS"in N?Ke({},N.FORBID_TAGS,Xe):{},J="FORBID_ATTR"in N?Ke({},N.FORBID_ATTR,Xe):{},j="USE_PROFILES"in N?N.USE_PROFILES:!1,ee=N.ALLOW_ARIA_ATTR!==!1,se=N.ALLOW_DATA_ATTR!==!1,Re=N.ALLOW_UNKNOWN_PROTOCOLS||!1,ce=N.ALLOW_SELF_CLOSE_IN_ATTR!==!1,de=N.SAFE_FOR_TEMPLATES||!1,K=N.WHOLE_DOCUMENT||!1,Pe=N.RETURN_DOM||!1,Ae=N.RETURN_DOM_FRAGMENT||!1,ke=N.RETURN_TRUSTED_TYPE||!1,Ge=N.FORCE_BODY||!1,O=N.SANITIZE_DOM!==!1,E=N.SANITIZE_NAMED_PROPS||!1,H=N.KEEP_CONTENT!==!1,M=N.IN_PLACE||!1,b=N.ALLOWED_URI_REGEXP||b,qe=N.NAMESPACE||De,W=N.CUSTOM_ELEMENT_HANDLING||{},N.CUSTOM_ELEMENT_HANDLING&&yt(N.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(W.tagNameCheck=N.CUSTOM_ELEMENT_HANDLING.tagNameCheck),N.CUSTOM_ELEMENT_HANDLING&&yt(N.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(W.attributeNameCheck=N.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),N.CUSTOM_ELEMENT_HANDLING&&typeof N.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(W.allowCustomizedBuiltInElements=N.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),de&&(se=!1),Ae&&(Pe=!0),j&&(_=Ke({},nn(E1)),I=[],j.html===!0&&(Ke(_,R1),Ke(I,T1)),j.svg===!0&&(Ke(_,rw),Ke(I,iw),Ke(I,zv)),j.svgFilters===!0&&(Ke(_,nw),Ke(I,iw),Ke(I,zv)),j.mathMl===!0&&(Ke(_,ow),Ke(I,P1),Ke(I,zv))),N.ADD_TAGS&&(_===T&&(_=Hi(_)),Ke(_,N.ADD_TAGS,Xe)),N.ADD_ATTR&&(I===F&&(I=Hi(I)),Ke(I,N.ADD_ATTR,Xe)),N.ADD_URI_SAFE_ATTR&&Ke(z,N.ADD_URI_SAFE_ATTR,Xe),N.FORBID_CONTENTS&&(x===D&&(x=Hi(x)),Ke(x,N.FORBID_CONTENTS,Xe)),H&&(_["#text"]=!0),K&&Ke(_,["html","head","body"]),_.table&&(Ke(_,["tbody"]),delete G.tbody),mr&&mr(N),Qe=N)},nt=Ke({},["mi","mo","mn","ms","mtext"]),Mi=Ke({},["foreignobject","desc","title","annotation-xml"]),Wo=Ke({},["title","style","font","a","script"]),il=Ke({},rw);Ke(il,nw),Ke(il,rte);var rb=Ke({},ow);Ke(rb,nte);var rY=function(N){var oe=S(N);(!oe||!oe.tagName)&&(oe={namespaceURI:qe,tagName:"template"});var he=Ky(N.tagName),ut=Ky(oe.tagName);return Ne[N.namespaceURI]?N.namespaceURI===Oe?oe.namespaceURI===De?he==="svg":oe.namespaceURI===ge?he==="svg"&&(ut==="annotation-xml"||nt[ut]):!!il[he]:N.namespaceURI===ge?oe.namespaceURI===De?he==="math":oe.namespaceURI===Oe?he==="math"&&Mi[ut]:!!rb[he]:N.namespaceURI===De?oe.namespaceURI===Oe&&!Mi[ut]||oe.namespaceURI===ge&&!nt[ut]?!1:!rb[he]&&(Wo[he]||!il[he]):!!(rt==="application/xhtml+xml"&&Ne[N.namespaceURI]):!1},Wn=function(N){Df(t.removed,{element:N});try{N.parentNode.removeChild(N)}catch{try{N.outerHTML=R}catch{N.remove()}}},nb=function(N,oe){try{Df(t.removed,{attribute:oe.getAttributeNode(N),from:oe})}catch{Df(t.removed,{attribute:null,from:oe})}if(oe.removeAttribute(N),N==="is"&&!I[N])if(Pe||Ae)try{Wn(oe)}catch{}else try{oe.setAttribute(N,"")}catch{}},jP=function(N){var oe,he;if(Ge)N="<remove></remove>"+N;else{var ut=Qee(N,/^[\r\n\t ]+/);he=ut&&ut[0]}rt==="application/xhtml+xml"&&qe===De&&(N='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+N+"</body></html>");var Sr=P?P.createHTML(N):N;if(qe===De)try{oe=new h().parseFromString(Sr,rt)}catch{}if(!oe||!oe.documentElement){oe=U.createDocument(qe,"template",null);try{oe.documentElement.innerHTML=ct?R:Sr}catch{}}var rr=oe.body||oe.documentElement;return N&&he&&rr.insertBefore(n.createTextNode(he),rr.childNodes[0]||null),qe===De?q.call(oe,K?"html":"body")[0]:K?oe.documentElement:rr},FP=function(N){return X.call(N.ownerDocument||N,N,s.SHOW_ELEMENT|s.SHOW_COMMENT|s.SHOW_TEXT,null,!1)},nY=function(N){return N instanceof c&&(typeof N.nodeName!="string"||typeof N.textContent!="string"||typeof N.removeChild!="function"||!(N.attributes instanceof f)||typeof N.removeAttribute!="function"||typeof N.setAttribute!="function"||typeof N.namespaceURI!="string"||typeof N.insertBefore!="function"||typeof N.hasChildNodes!="function")},Pf=function(N){return ni(a)==="object"?N instanceof a:N&&ni(N)==="object"&&typeof N.nodeType=="number"&&typeof N.nodeName=="string"},Un=function(N,oe,he){Q[N]&&Zee(Q[N],function(ut){ut.call(t,oe,he,Qe)})},BP=function(N){var oe;if(Un("beforeSanitizeElements",N,null),nY(N)||fr(/[\u0080-\uFFFF]/,N.nodeName))return Wn(N),!0;var he=Xe(N.nodeName);if(Un("uponSanitizeElement",N,{tagName:he,allowedTags:_}),N.hasChildNodes()&&!Pf(N.firstElementChild)&&(!Pf(N.content)||!Pf(N.content.firstElementChild))&&fr(/<[/\w]/g,N.innerHTML)&&fr(/<[/\w]/g,N.textContent)||he==="select"&&fr(/<template/i,N.innerHTML))return Wn(N),!0;if(!_[he]||G[he]){if(!G[he]&&WP(he)&&(W.tagNameCheck instanceof RegExp&&fr(W.tagNameCheck,he)||W.tagNameCheck instanceof Function&&W.tagNameCheck(he)))return!1;if(H&&!x[he]){var ut=S(N)||N.parentNode,Sr=w(N)||N.childNodes;if(Sr&&ut)for(var rr=Sr.length,tr=rr-1;tr>=0;--tr)ut.insertBefore(g(Sr[tr],!0),m(N))}return Wn(N),!0}return N instanceof l&&!rY(N)||(he==="noscript"||he==="noembed"||he==="noframes")&&fr(/<\/no(script|embed|frames)/i,N.innerHTML)?(Wn(N),!0):(de&&N.nodeType===3&&(oe=N.textContent,oe=en(oe,le," "),oe=en(oe,Se," "),oe=en(oe,me," "),N.textContent!==oe&&(Df(t.removed,{element:N.cloneNode()}),N.textContent=oe)),Un("afterSanitizeElements",N,null),!1)},VP=function(N,oe,he){if(O&&(oe==="id"||oe==="name")&&(he in n||he in jt))return!1;if(!(se&&!J[oe]&&fr(Ce,oe))){if(!(ee&&fr(k,oe))){if(!I[oe]||J[oe]){if(!(WP(N)&&(W.tagNameCheck instanceof RegExp&&fr(W.tagNameCheck,N)||W.tagNameCheck instanceof Function&&W.tagNameCheck(N))&&(W.attributeNameCheck instanceof RegExp&&fr(W.attributeNameCheck,oe)||W.attributeNameCheck instanceof Function&&W.attributeNameCheck(oe))||oe==="is"&&W.allowCustomizedBuiltInElements&&(W.tagNameCheck instanceof RegExp&&fr(W.tagNameCheck,he)||W.tagNameCheck instanceof Function&&W.tagNameCheck(he))))return!1}else if(!z[oe]){if(!fr(b,en(he,p,""))){if(!((oe==="src"||oe==="xlink:href"||oe==="href")&&N!=="script"&&Jee(he,"data:")===0&&B[N])){if(!(Re&&!fr(y,en(he,p,"")))){if(he)return!1}}}}}}return!0},WP=function(N){return N.indexOf("-")>0},UP=function(N){var oe,he,ut,Sr;Un("beforeSanitizeAttributes",N,null);var rr=N.attributes;if(rr){var tr={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:I};for(Sr=rr.length;Sr--;){oe=rr[Sr];var $v=oe,Zt=$v.name,ob=$v.namespaceURI;if(he=Zt==="value"?oe.value:ete(oe.value),ut=Xe(Zt),tr.attrName=ut,tr.attrValue=he,tr.keepAttr=!0,tr.forceKeepAttr=void 0,Un("uponSanitizeAttribute",N,tr),he=tr.attrValue,!tr.forceKeepAttr&&(nb(Zt,N),!!tr.keepAttr)){if(!ce&&fr(/\/>/i,he)){nb(Zt,N);continue}de&&(he=en(he,le," "),he=en(he,Se," "),he=en(he,me," "));var zP=Xe(N.nodeName);if(VP(zP,ut,he)){if(E&&(ut==="id"||ut==="name")&&(nb(Zt,N),he=A+he),P&&ni(d)==="object"&&typeof d.getAttributeType=="function"&&!ob)switch(d.getAttributeType(zP,ut)){case"TrustedHTML":{he=P.createHTML(he);break}case"TrustedScriptURL":{he=P.createScriptURL(he);break}}try{ob?N.setAttributeNS(ob,Zt,he):N.setAttribute(Zt,he),O1(t.removed)}catch{}}}}Un("afterSanitizeAttributes",N,null)}},oY=function Ee(N){var oe,he=FP(N);for(Un("beforeSanitizeShadowDOM",N,null);oe=he.nextNode();)Un("uponSanitizeShadowNode",oe,null),!BP(oe)&&(oe.content instanceof o&&Ee(oe.content),UP(oe));Un("afterSanitizeShadowDOM",N,null)};return t.sanitize=function(Ee){var N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},oe,he,ut,Sr,rr;if(ct=!Ee,ct&&(Ee="<!-->"),typeof Ee!="string"&&!Pf(Ee))if(typeof Ee.toString=="function"){if(Ee=Ee.toString(),typeof Ee!="string")throw tw("dirty is not a string, aborting")}else throw tw("toString is not a function");if(!t.isSupported){if(ni(e.toStaticHTML)==="object"||typeof e.toStaticHTML=="function"){if(typeof Ee=="string")return e.toStaticHTML(Ee);if(Pf(Ee))return e.toStaticHTML(Ee.outerHTML)}return Ee}if(Me||st(N),t.removed=[],typeof Ee=="string"&&(M=!1),M){if(Ee.nodeName){var tr=Xe(Ee.nodeName);if(!_[tr]||G[tr])throw tw("root node is forbidden and cannot be sanitized in-place")}}else if(Ee instanceof a)oe=jP("<!---->"),he=oe.ownerDocument.importNode(Ee,!0),he.nodeType===1&&he.nodeName==="BODY"||he.nodeName==="HTML"?oe=he:oe.appendChild(he);else{if(!Pe&&!de&&!K&&Ee.indexOf("<")===-1)return P&&ke?P.createHTML(Ee):Ee;if(oe=jP(Ee),!oe)return Pe?null:ke?R:""}oe&&Ge&&Wn(oe.firstChild);for(var $v=FP(M?Ee:oe);ut=$v.nextNode();)ut.nodeType===3&&ut===Sr||BP(ut)||(ut.content instanceof o&&oY(ut.content),UP(ut),Sr=ut);if(Sr=null,M)return Ee;if(Pe){if(Ae)for(rr=Y.call(oe.ownerDocument);oe.firstChild;)rr.appendChild(oe.firstChild);else rr=oe;return(I.shadowroot||I.shadowrootmod)&&(rr=Z.call(r,rr,!0)),rr}var Zt=K?oe.outerHTML:oe.innerHTML;return K&&_["!doctype"]&&oe.ownerDocument&&oe.ownerDocument.doctype&&oe.ownerDocument.doctype.name&&fr(hte,oe.ownerDocument.doctype.name)&&(Zt="<!DOCTYPE "+oe.ownerDocument.doctype.name+`>
`+Zt),de&&(Zt=en(Zt,le," "),Zt=en(Zt,Se," "),Zt=en(Zt,me," ")),P&&ke?P.createHTML(Zt):Zt},t.setConfig=function(Ee){st(Ee),Me=!0},t.clearConfig=function(){Qe=null,Me=!1},t.isValidAttribute=function(Ee,N,oe){Qe||st({});var he=Xe(Ee),ut=Xe(N);return VP(he,ut,oe)},t.addHook=function(Ee,N){typeof N=="function"&&(Q[Ee]=Q[Ee]||[],Df(Q[Ee],N))},t.removeHook=function(Ee){if(Q[Ee])return O1(Q[Ee])},t.removeHooks=function(Ee){Q[Ee]&&(Q[Ee]=[])},t.removeAllHooks=function(){Q={}},t}var yte=yB(),gte=$e,pte=m0.codeAt;gte({target:"String",proto:!0},{codePointAt:function(t){return pte(this,t)}});var mte=$i,bte=Yt,wte=Tr,Ste=RangeError,B0=function(t){var r=bte(wte(this)),n="",o=mte(t);if(o<0||o===1/0)throw new Ste("Wrong number of repetitions");for(;o>0;(o>>>=1)&&(r+=r))o&1&&(n+=r);return n},gB=Ue,Cte=Xa,k1=Yt,_te=B0,Ote=Tr,Rte=gB(_te),Ete=gB("".slice),Tte=Math.ceil,$1=function(e){return function(t,r,n){var o=k1(Ote(t)),i=Cte(r),a=o.length,l=n===void 0?" ":k1(n),s,u;return i<=a||l===""?o:(s=i-a,u=Rte(l,Tte(s/l.length)),u.length>s&&(u=Ete(u,0,s)),e?o+u:u+o)}},Pte={start:$1(!1),end:$1(!0)},kte=za,$te=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(kte),Ate=$e,Ite=Pte.start,Mte=$te;Ate({target:"String",proto:!0,forced:Mte},{padStart:function(t){return Ite(this,t,arguments.length>1?arguments[1]:void 0)}});//! moment.js
//! version : 2.29.4
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var pB;function te(){return pB.apply(null,arguments)}function xte(e){pB=e}function dn(e){return e instanceof Array||Object.prototype.toString.call(e)==="[object Array]"}function $a(e){return e!=null&&Object.prototype.toString.call(e)==="[object Object]"}function at(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function V0(e){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(e).length===0;var t;for(t in e)if(at(e,t))return!1;return!0}function _r(e){return e===void 0}function No(e){return typeof e=="number"||Object.prototype.toString.call(e)==="[object Number]"}function lv(e){return e instanceof Date||Object.prototype.toString.call(e)==="[object Date]"}function mB(e,t){var r=[],n,o=e.length;for(n=0;n<o;++n)r.push(t(e[n],n));return r}function ai(e,t){for(var r in t)at(t,r)&&(e[r]=t[r]);return at(t,"toString")&&(e.toString=t.toString),at(t,"valueOf")&&(e.valueOf=t.valueOf),e}function Bn(e,t,r,n){return VB(e,t,r,n,!0).utc()}function Dte(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function ze(e){return e._pf==null&&(e._pf=Dte()),e._pf}var OC;Array.prototype.some?OC=Array.prototype.some:OC=function(e){var t=Object(this),r=t.length>>>0,n;for(n=0;n<r;n++)if(n in t&&e.call(this,t[n],n,t))return!0;return!1};function W0(e){if(e._isValid==null){var t=ze(e),r=OC.call(t.parsedDateParts,function(o){return o!=null}),n=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidEra&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&r);if(e._strict&&(n=n&&t.charsLeftOver===0&&t.unusedTokens.length===0&&t.bigHour===void 0),Object.isFrozen==null||!Object.isFrozen(e))e._isValid=n;else return n}return e._isValid}function gm(e){var t=Bn(NaN);return e!=null?ai(ze(t),e):ze(t).userInvalidated=!0,t}var A1=te.momentProperties=[],aw=!1;function U0(e,t){var r,n,o,i=A1.length;if(_r(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),_r(t._i)||(e._i=t._i),_r(t._f)||(e._f=t._f),_r(t._l)||(e._l=t._l),_r(t._strict)||(e._strict=t._strict),_r(t._tzm)||(e._tzm=t._tzm),_r(t._isUTC)||(e._isUTC=t._isUTC),_r(t._offset)||(e._offset=t._offset),_r(t._pf)||(e._pf=ze(t)),_r(t._locale)||(e._locale=t._locale),i>0)for(r=0;r<i;r++)n=A1[r],o=t[n],_r(o)||(e[n]=o);return e}function sv(e){U0(this,e),this._d=new Date(e._d!=null?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),aw===!1&&(aw=!0,te.updateOffset(this),aw=!1)}function vn(e){return e instanceof sv||e!=null&&e._isAMomentObject!=null}function bB(e){te.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+e)}function Zr(e,t){var r=!0;return ai(function(){if(te.deprecationHandler!=null&&te.deprecationHandler(null,e),r){var n=[],o,i,a,l=arguments.length;for(i=0;i<l;i++){if(o="",typeof arguments[i]=="object"){o+=`
[`+i+"] ";for(a in arguments[0])at(arguments[0],a)&&(o+=a+": "+arguments[0][a]+", ");o=o.slice(0,-2)}else o=arguments[i];n.push(o)}bB(e+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),r=!1}return t.apply(this,arguments)},t)}var I1={};function wB(e,t){te.deprecationHandler!=null&&te.deprecationHandler(e,t),I1[e]||(bB(t),I1[e]=!0)}te.suppressDeprecationWarnings=!1;te.deprecationHandler=null;function Vn(e){return typeof Function<"u"&&e instanceof Function||Object.prototype.toString.call(e)==="[object Function]"}function Nte(e){var t,r;for(r in e)at(e,r)&&(t=e[r],Vn(t)?this[r]=t:this["_"+r]=t);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function RC(e,t){var r=ai({},e),n;for(n in t)at(t,n)&&($a(e[n])&&$a(t[n])?(r[n]={},ai(r[n],e[n]),ai(r[n],t[n])):t[n]!=null?r[n]=t[n]:delete r[n]);for(n in e)at(e,n)&&!at(t,n)&&$a(e[n])&&(r[n]=ai({},r[n]));return r}function z0(e){e!=null&&this.set(e)}var EC;Object.keys?EC=Object.keys:EC=function(e){var t,r=[];for(t in e)at(e,t)&&r.push(t);return r};var Hte={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function Lte(e,t,r){var n=this._calendar[e]||this._calendar.sameElse;return Vn(n)?n.call(t,r):n}function Hn(e,t,r){var n=""+Math.abs(e),o=t-n.length,i=e>=0;return(i?r?"+":"":"-")+Math.pow(10,Math.max(0,o)).toString().substr(1)+n}var Y0=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Yv=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,lw={},zl={};function Te(e,t,r,n){var o=n;typeof n=="string"&&(o=function(){return this[n]()}),e&&(zl[e]=o),t&&(zl[t[0]]=function(){return Hn(o.apply(this,arguments),t[1],t[2])}),r&&(zl[r]=function(){return this.localeData().ordinal(o.apply(this,arguments),e)})}function jte(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function Fte(e){var t=e.match(Y0),r,n;for(r=0,n=t.length;r<n;r++)zl[t[r]]?t[r]=zl[t[r]]:t[r]=jte(t[r]);return function(o){var i="",a;for(a=0;a<n;a++)i+=Vn(t[a])?t[a].call(o,e):t[a];return i}}function qy(e,t){return e.isValid()?(t=SB(t,e.localeData()),lw[t]=lw[t]||Fte(t),lw[t](e)):e.localeData().invalidDate()}function SB(e,t){var r=5;function n(o){return t.longDateFormat(o)||o}for(Yv.lastIndex=0;r>=0&&Yv.test(e);)e=e.replace(Yv,n),Yv.lastIndex=0,r-=1;return e}var Bte={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function Vte(e){var t=this._longDateFormat[e],r=this._longDateFormat[e.toUpperCase()];return t||!r?t:(this._longDateFormat[e]=r.match(Y0).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[e])}var Wte="Invalid date";function Ute(){return this._invalidDate}var zte="%d",Yte=/\d{1,2}/;function Gte(e){return this._ordinal.replace("%d",e)}var Kte={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function qte(e,t,r,n){var o=this._relativeTime[r];return Vn(o)?o(e,t,r,n):o.replace(/%d/i,e)}function Xte(e,t){var r=this._relativeTime[e>0?"future":"past"];return Vn(r)?r(t):r.replace(/%s/i,t)}var yc={};function sr(e,t){var r=e.toLowerCase();yc[r]=yc[r+"s"]=yc[t]=e}function Qr(e){return typeof e=="string"?yc[e]||yc[e.toLowerCase()]:void 0}function G0(e){var t={},r,n;for(n in e)at(e,n)&&(r=Qr(n),r&&(t[r]=e[n]));return t}var CB={};function ur(e,t){CB[e]=t}function Zte(e){var t=[],r;for(r in e)at(e,r)&&t.push({unit:r,priority:CB[r]});return t.sort(function(n,o){return n.priority-o.priority}),t}function pm(e){return e%4===0&&e%100!==0||e%400===0}function Gr(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function Ze(e){var t=+e,r=0;return t!==0&&isFinite(t)&&(r=Gr(t)),r}function Sf(e,t){return function(r){return r!=null?(_B(this,e,r),te.updateOffset(this,t),this):Dg(this,e)}}function Dg(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function _B(e,t,r){e.isValid()&&!isNaN(r)&&(t==="FullYear"&&pm(e.year())&&e.month()===1&&e.date()===29?(r=Ze(r),e._d["set"+(e._isUTC?"UTC":"")+t](r,e.month(),_m(r,e.month()))):e._d["set"+(e._isUTC?"UTC":"")+t](r))}function Qte(e){return e=Qr(e),Vn(this[e])?this[e]():this}function Jte(e,t){if(typeof e=="object"){e=G0(e);var r=Zte(e),n,o=r.length;for(n=0;n<o;n++)this[r[n].unit](e[r[n].unit])}else if(e=Qr(e),Vn(this[e]))return this[e](t);return this}var OB=/\d/,Vr=/\d\d/,RB=/\d{3}/,K0=/\d{4}/,mm=/[+-]?\d{6}/,_t=/\d\d?/,EB=/\d\d\d\d?/,TB=/\d\d\d\d\d\d?/,bm=/\d{1,3}/,q0=/\d{1,4}/,wm=/[+-]?\d{1,6}/,Cf=/\d+/,Sm=/[+-]?\d+/,ere=/Z|[+-]\d\d:?\d\d/gi,Cm=/Z|[+-]\d\d(?::?\d\d)?/gi,tre=/[+-]?\d+(\.\d{1,3})?/,uv=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Ng;Ng={};function we(e,t,r){Ng[e]=Vn(t)?t:function(n,o){return n&&r?r:t}}function rre(e,t){return at(Ng,e)?Ng[e](t._strict,t._locale):new RegExp(nre(e))}function nre(e){return Hr(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(t,r,n,o,i){return r||n||o||i}))}function Hr(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var TC={};function mt(e,t){var r,n=t,o;for(typeof e=="string"&&(e=[e]),No(t)&&(n=function(i,a){a[t]=Ze(i)}),o=e.length,r=0;r<o;r++)TC[e[r]]=n}function fv(e,t){mt(e,function(r,n,o,i){o._w=o._w||{},t(r,o._w,o,i)})}function ore(e,t,r){t!=null&&at(TC,e)&&TC[e](t,r._a,r,e)}var ir=0,oo=1,xn=2,qt=3,cn=4,io=5,ea=6,ire=7,are=8;function lre(e,t){return(e%t+t)%t}var Bt;Array.prototype.indexOf?Bt=Array.prototype.indexOf:Bt=function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1};function _m(e,t){if(isNaN(e)||isNaN(t))return NaN;var r=lre(t,12);return e+=(t-r)/12,r===1?pm(e)?29:28:31-r%7%2}Te("M",["MM",2],"Mo",function(){return this.month()+1});Te("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)});Te("MMMM",0,0,function(e){return this.localeData().months(this,e)});sr("month","M");ur("month",8);we("M",_t);we("MM",_t,Vr);we("MMM",function(e,t){return t.monthsShortRegex(e)});we("MMMM",function(e,t){return t.monthsRegex(e)});mt(["M","MM"],function(e,t){t[oo]=Ze(e)-1});mt(["MMM","MMMM"],function(e,t,r,n){var o=r._locale.monthsParse(e,n,r._strict);o!=null?t[oo]=o:ze(r).invalidMonth=e});var sre="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),PB="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),kB=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,ure=uv,fre=uv;function cre(e,t){return e?dn(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||kB).test(t)?"format":"standalone"][e.month()]:dn(this._months)?this._months:this._months.standalone}function hre(e,t){return e?dn(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[kB.test(t)?"format":"standalone"][e.month()]:dn(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function dre(e,t,r){var n,o,i,a=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)i=Bn([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(i,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(i,"").toLocaleLowerCase();return r?t==="MMM"?(o=Bt.call(this._shortMonthsParse,a),o!==-1?o:null):(o=Bt.call(this._longMonthsParse,a),o!==-1?o:null):t==="MMM"?(o=Bt.call(this._shortMonthsParse,a),o!==-1?o:(o=Bt.call(this._longMonthsParse,a),o!==-1?o:null)):(o=Bt.call(this._longMonthsParse,a),o!==-1?o:(o=Bt.call(this._shortMonthsParse,a),o!==-1?o:null))}function vre(e,t,r){var n,o,i;if(this._monthsParseExact)return dre.call(this,e,t,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(o=Bn([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(o,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(o,"").replace(".","")+"$","i")),!r&&!this._monthsParse[n]&&(i="^"+this.months(o,"")+"|^"+this.monthsShort(o,""),this._monthsParse[n]=new RegExp(i.replace(".",""),"i")),r&&t==="MMMM"&&this._longMonthsParse[n].test(e))return n;if(r&&t==="MMM"&&this._shortMonthsParse[n].test(e))return n;if(!r&&this._monthsParse[n].test(e))return n}}function $B(e,t){var r;if(!e.isValid())return e;if(typeof t=="string"){if(/^\d+$/.test(t))t=Ze(t);else if(t=e.localeData().monthsParse(t),!No(t))return e}return r=Math.min(e.date(),_m(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,r),e}function AB(e){return e!=null?($B(this,e),te.updateOffset(this,!0),this):Dg(this,"Month")}function yre(){return _m(this.year(),this.month())}function gre(e){return this._monthsParseExact?(at(this,"_monthsRegex")||IB.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(at(this,"_monthsShortRegex")||(this._monthsShortRegex=ure),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function pre(e){return this._monthsParseExact?(at(this,"_monthsRegex")||IB.call(this),e?this._monthsStrictRegex:this._monthsRegex):(at(this,"_monthsRegex")||(this._monthsRegex=fre),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function IB(){function e(a,l){return l.length-a.length}var t=[],r=[],n=[],o,i;for(o=0;o<12;o++)i=Bn([2e3,o]),t.push(this.monthsShort(i,"")),r.push(this.months(i,"")),n.push(this.months(i,"")),n.push(this.monthsShort(i,""));for(t.sort(e),r.sort(e),n.sort(e),o=0;o<12;o++)t[o]=Hr(t[o]),r[o]=Hr(r[o]);for(o=0;o<24;o++)n[o]=Hr(n[o]);this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+t.join("|")+")","i")}Te("Y",0,0,function(){var e=this.year();return e<=9999?Hn(e,4):"+"+e});Te(0,["YY",2],0,function(){return this.year()%100});Te(0,["YYYY",4],0,"year");Te(0,["YYYYY",5],0,"year");Te(0,["YYYYYY",6,!0],0,"year");sr("year","y");ur("year",1);we("Y",Sm);we("YY",_t,Vr);we("YYYY",q0,K0);we("YYYYY",wm,mm);we("YYYYYY",wm,mm);mt(["YYYYY","YYYYYY"],ir);mt("YYYY",function(e,t){t[ir]=e.length===2?te.parseTwoDigitYear(e):Ze(e)});mt("YY",function(e,t){t[ir]=te.parseTwoDigitYear(e)});mt("Y",function(e,t){t[ir]=parseInt(e,10)});function gc(e){return pm(e)?366:365}te.parseTwoDigitYear=function(e){return Ze(e)+(Ze(e)>68?1900:2e3)};var MB=Sf("FullYear",!0);function mre(){return pm(this.year())}function bre(e,t,r,n,o,i,a){var l;return e<100&&e>=0?(l=new Date(e+400,t,r,n,o,i,a),isFinite(l.getFullYear())&&l.setFullYear(e)):l=new Date(e,t,r,n,o,i,a),l}function xc(e){var t,r;return e<100&&e>=0?(r=Array.prototype.slice.call(arguments),r[0]=e+400,t=new Date(Date.UTC.apply(null,r)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)):t=new Date(Date.UTC.apply(null,arguments)),t}function Hg(e,t,r){var n=7+t-r,o=(7+xc(e,0,n).getUTCDay()-t)%7;return-o+n-1}function xB(e,t,r,n,o){var i=(7+r-n)%7,a=Hg(e,n,o),l=1+7*(t-1)+i+a,s,u;return l<=0?(s=e-1,u=gc(s)+l):l>gc(e)?(s=e+1,u=l-gc(e)):(s=e,u=l),{year:s,dayOfYear:u}}function Dc(e,t,r){var n=Hg(e.year(),t,r),o=Math.floor((e.dayOfYear()-n-1)/7)+1,i,a;return o<1?(a=e.year()-1,i=o+Io(a,t,r)):o>Io(e.year(),t,r)?(i=o-Io(e.year(),t,r),a=e.year()+1):(a=e.year(),i=o),{week:i,year:a}}function Io(e,t,r){var n=Hg(e,t,r),o=Hg(e+1,t,r);return(gc(e)-n+o)/7}Te("w",["ww",2],"wo","week");Te("W",["WW",2],"Wo","isoWeek");sr("week","w");sr("isoWeek","W");ur("week",5);ur("isoWeek",5);we("w",_t);we("ww",_t,Vr);we("W",_t);we("WW",_t,Vr);fv(["w","ww","W","WW"],function(e,t,r,n){t[n.substr(0,1)]=Ze(e)});function wre(e){return Dc(e,this._week.dow,this._week.doy).week}var Sre={dow:0,doy:6};function Cre(){return this._week.dow}function _re(){return this._week.doy}function Ore(e){var t=this.localeData().week(this);return e==null?t:this.add((e-t)*7,"d")}function Rre(e){var t=Dc(this,1,4).week;return e==null?t:this.add((e-t)*7,"d")}Te("d",0,"do","day");Te("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)});Te("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)});Te("dddd",0,0,function(e){return this.localeData().weekdays(this,e)});Te("e",0,0,"weekday");Te("E",0,0,"isoWeekday");sr("day","d");sr("weekday","e");sr("isoWeekday","E");ur("day",11);ur("weekday",11);ur("isoWeekday",11);we("d",_t);we("e",_t);we("E",_t);we("dd",function(e,t){return t.weekdaysMinRegex(e)});we("ddd",function(e,t){return t.weekdaysShortRegex(e)});we("dddd",function(e,t){return t.weekdaysRegex(e)});fv(["dd","ddd","dddd"],function(e,t,r,n){var o=r._locale.weekdaysParse(e,n,r._strict);o!=null?t.d=o:ze(r).invalidWeekday=e});fv(["d","e","E"],function(e,t,r,n){t[n]=Ze(e)});function Ere(e,t){return typeof e!="string"?e:isNaN(e)?(e=t.weekdaysParse(e),typeof e=="number"?e:null):parseInt(e,10)}function Tre(e,t){return typeof e=="string"?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function X0(e,t){return e.slice(t,7).concat(e.slice(0,t))}var Pre="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),DB="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),kre="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),$re=uv,Are=uv,Ire=uv;function Mre(e,t){var r=dn(this._weekdays)?this._weekdays:this._weekdays[e&&e!==!0&&this._weekdays.isFormat.test(t)?"format":"standalone"];return e===!0?X0(r,this._week.dow):e?r[e.day()]:r}function xre(e){return e===!0?X0(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function Dre(e){return e===!0?X0(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function Nre(e,t,r){var n,o,i,a=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)i=Bn([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(i,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(i,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(i,"").toLocaleLowerCase();return r?t==="dddd"?(o=Bt.call(this._weekdaysParse,a),o!==-1?o:null):t==="ddd"?(o=Bt.call(this._shortWeekdaysParse,a),o!==-1?o:null):(o=Bt.call(this._minWeekdaysParse,a),o!==-1?o:null):t==="dddd"?(o=Bt.call(this._weekdaysParse,a),o!==-1||(o=Bt.call(this._shortWeekdaysParse,a),o!==-1)?o:(o=Bt.call(this._minWeekdaysParse,a),o!==-1?o:null)):t==="ddd"?(o=Bt.call(this._shortWeekdaysParse,a),o!==-1||(o=Bt.call(this._weekdaysParse,a),o!==-1)?o:(o=Bt.call(this._minWeekdaysParse,a),o!==-1?o:null)):(o=Bt.call(this._minWeekdaysParse,a),o!==-1||(o=Bt.call(this._weekdaysParse,a),o!==-1)?o:(o=Bt.call(this._shortWeekdaysParse,a),o!==-1?o:null))}function Hre(e,t,r){var n,o,i;if(this._weekdaysParseExact)return Nre.call(this,e,t,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(o=Bn([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(o,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(o,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(o,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(i="^"+this.weekdays(o,"")+"|^"+this.weekdaysShort(o,"")+"|^"+this.weekdaysMin(o,""),this._weekdaysParse[n]=new RegExp(i.replace(".",""),"i")),r&&t==="dddd"&&this._fullWeekdaysParse[n].test(e))return n;if(r&&t==="ddd"&&this._shortWeekdaysParse[n].test(e))return n;if(r&&t==="dd"&&this._minWeekdaysParse[n].test(e))return n;if(!r&&this._weekdaysParse[n].test(e))return n}}function Lre(e){if(!this.isValid())return e!=null?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return e!=null?(e=Ere(e,this.localeData()),this.add(e-t,"d")):t}function jre(e){if(!this.isValid())return e!=null?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return e==null?t:this.add(e-t,"d")}function Fre(e){if(!this.isValid())return e!=null?this:NaN;if(e!=null){var t=Tre(e,this.localeData());return this.day(this.day()%7?t:t-7)}else return this.day()||7}function Bre(e){return this._weekdaysParseExact?(at(this,"_weekdaysRegex")||Z0.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(at(this,"_weekdaysRegex")||(this._weekdaysRegex=$re),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function Vre(e){return this._weekdaysParseExact?(at(this,"_weekdaysRegex")||Z0.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(at(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Are),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function Wre(e){return this._weekdaysParseExact?(at(this,"_weekdaysRegex")||Z0.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(at(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Ire),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function Z0(){function e(f,c){return c.length-f.length}var t=[],r=[],n=[],o=[],i,a,l,s,u;for(i=0;i<7;i++)a=Bn([2e3,1]).day(i),l=Hr(this.weekdaysMin(a,"")),s=Hr(this.weekdaysShort(a,"")),u=Hr(this.weekdays(a,"")),t.push(l),r.push(s),n.push(u),o.push(l),o.push(s),o.push(u);t.sort(e),r.sort(e),n.sort(e),o.sort(e),this._weekdaysRegex=new RegExp("^("+o.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+t.join("|")+")","i")}function Q0(){return this.hours()%12||12}function Ure(){return this.hours()||24}Te("H",["HH",2],0,"hour");Te("h",["hh",2],0,Q0);Te("k",["kk",2],0,Ure);Te("hmm",0,0,function(){return""+Q0.apply(this)+Hn(this.minutes(),2)});Te("hmmss",0,0,function(){return""+Q0.apply(this)+Hn(this.minutes(),2)+Hn(this.seconds(),2)});Te("Hmm",0,0,function(){return""+this.hours()+Hn(this.minutes(),2)});Te("Hmmss",0,0,function(){return""+this.hours()+Hn(this.minutes(),2)+Hn(this.seconds(),2)});function NB(e,t){Te(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}NB("a",!0);NB("A",!1);sr("hour","h");ur("hour",13);function HB(e,t){return t._meridiemParse}we("a",HB);we("A",HB);we("H",_t);we("h",_t);we("k",_t);we("HH",_t,Vr);we("hh",_t,Vr);we("kk",_t,Vr);we("hmm",EB);we("hmmss",TB);we("Hmm",EB);we("Hmmss",TB);mt(["H","HH"],qt);mt(["k","kk"],function(e,t,r){var n=Ze(e);t[qt]=n===24?0:n});mt(["a","A"],function(e,t,r){r._isPm=r._locale.isPM(e),r._meridiem=e});mt(["h","hh"],function(e,t,r){t[qt]=Ze(e),ze(r).bigHour=!0});mt("hmm",function(e,t,r){var n=e.length-2;t[qt]=Ze(e.substr(0,n)),t[cn]=Ze(e.substr(n)),ze(r).bigHour=!0});mt("hmmss",function(e,t,r){var n=e.length-4,o=e.length-2;t[qt]=Ze(e.substr(0,n)),t[cn]=Ze(e.substr(n,2)),t[io]=Ze(e.substr(o)),ze(r).bigHour=!0});mt("Hmm",function(e,t,r){var n=e.length-2;t[qt]=Ze(e.substr(0,n)),t[cn]=Ze(e.substr(n))});mt("Hmmss",function(e,t,r){var n=e.length-4,o=e.length-2;t[qt]=Ze(e.substr(0,n)),t[cn]=Ze(e.substr(n,2)),t[io]=Ze(e.substr(o))});function zre(e){return(e+"").toLowerCase().charAt(0)==="p"}var Yre=/[ap]\.?m?\.?/i,Gre=Sf("Hours",!0);function Kre(e,t,r){return e>11?r?"pm":"PM":r?"am":"AM"}var LB={calendar:Hte,longDateFormat:Bte,invalidDate:Wte,ordinal:zte,dayOfMonthOrdinalParse:Yte,relativeTime:Kte,months:sre,monthsShort:PB,week:Sre,weekdays:Pre,weekdaysMin:kre,weekdaysShort:DB,meridiemParse:Yre},Ot={},Nf={},Nc;function qre(e,t){var r,n=Math.min(e.length,t.length);for(r=0;r<n;r+=1)if(e[r]!==t[r])return r;return n}function M1(e){return e&&e.toLowerCase().replace("_","-")}function Xre(e){for(var t=0,r,n,o,i;t<e.length;){for(i=M1(e[t]).split("-"),r=i.length,n=M1(e[t+1]),n=n?n.split("-"):null;r>0;){if(o=Om(i.slice(0,r).join("-")),o)return o;if(n&&n.length>=r&&qre(i,n)>=r-1)break;r--}t++}return Nc}function Zre(e){return e.match("^[^/\\\\]*$")!=null}function Om(e){var t=null,r;if(Ot[e]===void 0&&typeof module<"u"&&module&&module.exports&&Zre(e))try{t=Nc._abbr,r=require,r("./locale/"+e),fi(t)}catch{Ot[e]=null}return Ot[e]}function fi(e,t){var r;return e&&(_r(t)?r=Bo(e):r=J0(e,t),r?Nc=r:typeof console<"u"&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),Nc._abbr}function J0(e,t){if(t!==null){var r,n=LB;if(t.abbr=e,Ot[e]!=null)wB("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=Ot[e]._config;else if(t.parentLocale!=null)if(Ot[t.parentLocale]!=null)n=Ot[t.parentLocale]._config;else if(r=Om(t.parentLocale),r!=null)n=r._config;else return Nf[t.parentLocale]||(Nf[t.parentLocale]=[]),Nf[t.parentLocale].push({name:e,config:t}),null;return Ot[e]=new z0(RC(n,t)),Nf[e]&&Nf[e].forEach(function(o){J0(o.name,o.config)}),fi(e),Ot[e]}else return delete Ot[e],null}function Qre(e,t){if(t!=null){var r,n,o=LB;Ot[e]!=null&&Ot[e].parentLocale!=null?Ot[e].set(RC(Ot[e]._config,t)):(n=Om(e),n!=null&&(o=n._config),t=RC(o,t),n==null&&(t.abbr=e),r=new z0(t),r.parentLocale=Ot[e],Ot[e]=r),fi(e)}else Ot[e]!=null&&(Ot[e].parentLocale!=null?(Ot[e]=Ot[e].parentLocale,e===fi()&&fi(e)):Ot[e]!=null&&delete Ot[e]);return Ot[e]}function Bo(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return Nc;if(!dn(e)){if(t=Om(e),t)return t;e=[e]}return Xre(e)}function Jre(){return EC(Ot)}function eE(e){var t,r=e._a;return r&&ze(e).overflow===-2&&(t=r[oo]<0||r[oo]>11?oo:r[xn]<1||r[xn]>_m(r[ir],r[oo])?xn:r[qt]<0||r[qt]>24||r[qt]===24&&(r[cn]!==0||r[io]!==0||r[ea]!==0)?qt:r[cn]<0||r[cn]>59?cn:r[io]<0||r[io]>59?io:r[ea]<0||r[ea]>999?ea:-1,ze(e)._overflowDayOfYear&&(t<ir||t>xn)&&(t=xn),ze(e)._overflowWeeks&&t===-1&&(t=ire),ze(e)._overflowWeekday&&t===-1&&(t=are),ze(e).overflow=t),e}var ene=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,tne=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,rne=/Z|[+-]\d\d(?::?\d\d)?/,Gv=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],sw=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],nne=/^\/?Date\((-?\d+)/i,one=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,ine={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function jB(e){var t,r,n=e._i,o=ene.exec(n)||tne.exec(n),i,a,l,s,u=Gv.length,f=sw.length;if(o){for(ze(e).iso=!0,t=0,r=u;t<r;t++)if(Gv[t][1].exec(o[1])){a=Gv[t][0],i=Gv[t][2]!==!1;break}if(a==null){e._isValid=!1;return}if(o[3]){for(t=0,r=f;t<r;t++)if(sw[t][1].exec(o[3])){l=(o[2]||" ")+sw[t][0];break}if(l==null){e._isValid=!1;return}}if(!i&&l!=null){e._isValid=!1;return}if(o[4])if(rne.exec(o[4]))s="Z";else{e._isValid=!1;return}e._f=a+(l||"")+(s||""),rE(e)}else e._isValid=!1}function ane(e,t,r,n,o,i){var a=[lne(e),PB.indexOf(t),parseInt(r,10),parseInt(n,10),parseInt(o,10)];return i&&a.push(parseInt(i,10)),a}function lne(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function sne(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function une(e,t,r){if(e){var n=DB.indexOf(e),o=new Date(t[0],t[1],t[2]).getDay();if(n!==o)return ze(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function fne(e,t,r){if(e)return ine[e];if(t)return 0;var n=parseInt(r,10),o=n%100,i=(n-o)/100;return i*60+o}function FB(e){var t=one.exec(sne(e._i)),r;if(t){if(r=ane(t[4],t[3],t[2],t[5],t[6],t[7]),!une(t[1],r,e))return;e._a=r,e._tzm=fne(t[8],t[9],t[10]),e._d=xc.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),ze(e).rfc2822=!0}else e._isValid=!1}function cne(e){var t=nne.exec(e._i);if(t!==null){e._d=new Date(+t[1]);return}if(jB(e),e._isValid===!1)delete e._isValid;else return;if(FB(e),e._isValid===!1)delete e._isValid;else return;e._strict?e._isValid=!1:te.createFromInputFallback(e)}te.createFromInputFallback=Zr("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))});function Nl(e,t,r){return e??t??r}function hne(e){var t=new Date(te.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function tE(e){var t,r,n=[],o,i,a;if(!e._d){for(o=hne(e),e._w&&e._a[xn]==null&&e._a[oo]==null&&dne(e),e._dayOfYear!=null&&(a=Nl(e._a[ir],o[ir]),(e._dayOfYear>gc(a)||e._dayOfYear===0)&&(ze(e)._overflowDayOfYear=!0),r=xc(a,0,e._dayOfYear),e._a[oo]=r.getUTCMonth(),e._a[xn]=r.getUTCDate()),t=0;t<3&&e._a[t]==null;++t)e._a[t]=n[t]=o[t];for(;t<7;t++)e._a[t]=n[t]=e._a[t]==null?t===2?1:0:e._a[t];e._a[qt]===24&&e._a[cn]===0&&e._a[io]===0&&e._a[ea]===0&&(e._nextDay=!0,e._a[qt]=0),e._d=(e._useUTC?xc:bre).apply(null,n),i=e._useUTC?e._d.getUTCDay():e._d.getDay(),e._tzm!=null&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[qt]=24),e._w&&typeof e._w.d<"u"&&e._w.d!==i&&(ze(e).weekdayMismatch=!0)}}function dne(e){var t,r,n,o,i,a,l,s,u;t=e._w,t.GG!=null||t.W!=null||t.E!=null?(i=1,a=4,r=Nl(t.GG,e._a[ir],Dc(Ct(),1,4).year),n=Nl(t.W,1),o=Nl(t.E,1),(o<1||o>7)&&(s=!0)):(i=e._locale._week.dow,a=e._locale._week.doy,u=Dc(Ct(),i,a),r=Nl(t.gg,e._a[ir],u.year),n=Nl(t.w,u.week),t.d!=null?(o=t.d,(o<0||o>6)&&(s=!0)):t.e!=null?(o=t.e+i,(t.e<0||t.e>6)&&(s=!0)):o=i),n<1||n>Io(r,i,a)?ze(e)._overflowWeeks=!0:s!=null?ze(e)._overflowWeekday=!0:(l=xB(r,n,o,i,a),e._a[ir]=l.year,e._dayOfYear=l.dayOfYear)}te.ISO_8601=function(){};te.RFC_2822=function(){};function rE(e){if(e._f===te.ISO_8601){jB(e);return}if(e._f===te.RFC_2822){FB(e);return}e._a=[],ze(e).empty=!0;var t=""+e._i,r,n,o,i,a,l=t.length,s=0,u,f;for(o=SB(e._f,e._locale).match(Y0)||[],f=o.length,r=0;r<f;r++)i=o[r],n=(t.match(rre(i,e))||[])[0],n&&(a=t.substr(0,t.indexOf(n)),a.length>0&&ze(e).unusedInput.push(a),t=t.slice(t.indexOf(n)+n.length),s+=n.length),zl[i]?(n?ze(e).empty=!1:ze(e).unusedTokens.push(i),ore(i,n,e)):e._strict&&!n&&ze(e).unusedTokens.push(i);ze(e).charsLeftOver=l-s,t.length>0&&ze(e).unusedInput.push(t),e._a[qt]<=12&&ze(e).bigHour===!0&&e._a[qt]>0&&(ze(e).bigHour=void 0),ze(e).parsedDateParts=e._a.slice(0),ze(e).meridiem=e._meridiem,e._a[qt]=vne(e._locale,e._a[qt],e._meridiem),u=ze(e).era,u!==null&&(e._a[ir]=e._locale.erasConvertYear(u,e._a[ir])),tE(e),eE(e)}function vne(e,t,r){var n;return r==null?t:e.meridiemHour!=null?e.meridiemHour(t,r):(e.isPM!=null&&(n=e.isPM(r),n&&t<12&&(t+=12),!n&&t===12&&(t=0)),t)}function yne(e){var t,r,n,o,i,a,l=!1,s=e._f.length;if(s===0){ze(e).invalidFormat=!0,e._d=new Date(NaN);return}for(o=0;o<s;o++)i=0,a=!1,t=U0({},e),e._useUTC!=null&&(t._useUTC=e._useUTC),t._f=e._f[o],rE(t),W0(t)&&(a=!0),i+=ze(t).charsLeftOver,i+=ze(t).unusedTokens.length*10,ze(t).score=i,l?i<n&&(n=i,r=t):(n==null||i<n||a)&&(n=i,r=t,a&&(l=!0));ai(e,r||t)}function gne(e){if(!e._d){var t=G0(e._i),r=t.day===void 0?t.date:t.day;e._a=mB([t.year,t.month,r,t.hour,t.minute,t.second,t.millisecond],function(n){return n&&parseInt(n,10)}),tE(e)}}function pne(e){var t=new sv(eE(BB(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function BB(e){var t=e._i,r=e._f;return e._locale=e._locale||Bo(e._l),t===null||r===void 0&&t===""?gm({nullInput:!0}):(typeof t=="string"&&(e._i=t=e._locale.preparse(t)),vn(t)?new sv(eE(t)):(lv(t)?e._d=t:dn(r)?yne(e):r?rE(e):mne(e),W0(e)||(e._d=null),e))}function mne(e){var t=e._i;_r(t)?e._d=new Date(te.now()):lv(t)?e._d=new Date(t.valueOf()):typeof t=="string"?cne(e):dn(t)?(e._a=mB(t.slice(0),function(r){return parseInt(r,10)}),tE(e)):$a(t)?gne(e):No(t)?e._d=new Date(t):te.createFromInputFallback(e)}function VB(e,t,r,n,o){var i={};return(t===!0||t===!1)&&(n=t,t=void 0),(r===!0||r===!1)&&(n=r,r=void 0),($a(e)&&V0(e)||dn(e)&&e.length===0)&&(e=void 0),i._isAMomentObject=!0,i._useUTC=i._isUTC=o,i._l=r,i._i=e,i._f=t,i._strict=n,pne(i)}function Ct(e,t,r,n){return VB(e,t,r,n,!1)}var bne=Zr("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Ct.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:gm()}),wne=Zr("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Ct.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:gm()});function WB(e,t){var r,n;if(t.length===1&&dn(t[0])&&(t=t[0]),!t.length)return Ct();for(r=t[0],n=1;n<t.length;++n)(!t[n].isValid()||t[n][e](r))&&(r=t[n]);return r}function Sne(){var e=[].slice.call(arguments,0);return WB("isBefore",e)}function Cne(){var e=[].slice.call(arguments,0);return WB("isAfter",e)}var _ne=function(){return Date.now?Date.now():+new Date},Hf=["year","quarter","month","week","day","hour","minute","second","millisecond"];function One(e){var t,r=!1,n,o=Hf.length;for(t in e)if(at(e,t)&&!(Bt.call(Hf,t)!==-1&&(e[t]==null||!isNaN(e[t]))))return!1;for(n=0;n<o;++n)if(e[Hf[n]]){if(r)return!1;parseFloat(e[Hf[n]])!==Ze(e[Hf[n]])&&(r=!0)}return!0}function Rne(){return this._isValid}function Ene(){return bn(NaN)}function Rm(e){var t=G0(e),r=t.year||0,n=t.quarter||0,o=t.month||0,i=t.week||t.isoWeek||0,a=t.day||0,l=t.hour||0,s=t.minute||0,u=t.second||0,f=t.millisecond||0;this._isValid=One(t),this._milliseconds=+f+u*1e3+s*6e4+l*1e3*60*60,this._days=+a+i*7,this._months=+o+n*3+r*12,this._data={},this._locale=Bo(),this._bubble()}function Xy(e){return e instanceof Rm}function PC(e){return e<0?Math.round(-1*e)*-1:Math.round(e)}function Tne(e,t,r){var n=Math.min(e.length,t.length),o=Math.abs(e.length-t.length),i=0,a;for(a=0;a<n;a++)(r&&e[a]!==t[a]||!r&&Ze(e[a])!==Ze(t[a]))&&i++;return i+o}function UB(e,t){Te(e,0,0,function(){var r=this.utcOffset(),n="+";return r<0&&(r=-r,n="-"),n+Hn(~~(r/60),2)+t+Hn(~~r%60,2)})}UB("Z",":");UB("ZZ","");we("Z",Cm);we("ZZ",Cm);mt(["Z","ZZ"],function(e,t,r){r._useUTC=!0,r._tzm=nE(Cm,e)});var Pne=/([\+\-]|\d\d)/gi;function nE(e,t){var r=(t||"").match(e),n,o,i;return r===null?null:(n=r[r.length-1]||[],o=(n+"").match(Pne)||["-",0,0],i=+(o[1]*60)+Ze(o[2]),i===0?0:o[0]==="+"?i:-i)}function oE(e,t){var r,n;return t._isUTC?(r=t.clone(),n=(vn(e)||lv(e)?e.valueOf():Ct(e).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+n),te.updateOffset(r,!1),r):Ct(e).local()}function kC(e){return-Math.round(e._d.getTimezoneOffset())}te.updateOffset=function(){};function kne(e,t,r){var n=this._offset||0,o;if(!this.isValid())return e!=null?this:NaN;if(e!=null){if(typeof e=="string"){if(e=nE(Cm,e),e===null)return this}else Math.abs(e)<16&&!r&&(e=e*60);return!this._isUTC&&t&&(o=kC(this)),this._offset=e,this._isUTC=!0,o!=null&&this.add(o,"m"),n!==e&&(!t||this._changeInProgress?GB(this,bn(e-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,te.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:kC(this)}function $ne(e,t){return e!=null?(typeof e!="string"&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function Ane(e){return this.utcOffset(0,e)}function Ine(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(kC(this),"m")),this}function Mne(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var e=nE(ere,this._i);e!=null?this.utcOffset(e):this.utcOffset(0,!0)}return this}function xne(e){return this.isValid()?(e=e?Ct(e).utcOffset():0,(this.utcOffset()-e)%60===0):!1}function Dne(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Nne(){if(!_r(this._isDSTShifted))return this._isDSTShifted;var e={},t;return U0(e,this),e=BB(e),e._a?(t=e._isUTC?Bn(e._a):Ct(e._a),this._isDSTShifted=this.isValid()&&Tne(e._a,t.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function Hne(){return this.isValid()?!this._isUTC:!1}function Lne(){return this.isValid()?this._isUTC:!1}function zB(){return this.isValid()?this._isUTC&&this._offset===0:!1}var jne=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,Fne=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function bn(e,t){var r=e,n=null,o,i,a;return Xy(e)?r={ms:e._milliseconds,d:e._days,M:e._months}:No(e)||!isNaN(+e)?(r={},t?r[t]=+e:r.milliseconds=+e):(n=jne.exec(e))?(o=n[1]==="-"?-1:1,r={y:0,d:Ze(n[xn])*o,h:Ze(n[qt])*o,m:Ze(n[cn])*o,s:Ze(n[io])*o,ms:Ze(PC(n[ea]*1e3))*o}):(n=Fne.exec(e))?(o=n[1]==="-"?-1:1,r={y:Li(n[2],o),M:Li(n[3],o),w:Li(n[4],o),d:Li(n[5],o),h:Li(n[6],o),m:Li(n[7],o),s:Li(n[8],o)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(a=Bne(Ct(r.from),Ct(r.to)),r={},r.ms=a.milliseconds,r.M=a.months),i=new Rm(r),Xy(e)&&at(e,"_locale")&&(i._locale=e._locale),Xy(e)&&at(e,"_isValid")&&(i._isValid=e._isValid),i}bn.fn=Rm.prototype;bn.invalid=Ene;function Li(e,t){var r=e&&parseFloat(e.replace(",","."));return(isNaN(r)?0:r)*t}function x1(e,t){var r={};return r.months=t.month()-e.month()+(t.year()-e.year())*12,e.clone().add(r.months,"M").isAfter(t)&&--r.months,r.milliseconds=+t-+e.clone().add(r.months,"M"),r}function Bne(e,t){var r;return e.isValid()&&t.isValid()?(t=oE(t,e),e.isBefore(t)?r=x1(e,t):(r=x1(t,e),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function YB(e,t){return function(r,n){var o,i;return n!==null&&!isNaN(+n)&&(wB(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),i=r,r=n,n=i),o=bn(r,n),GB(this,o,e),this}}function GB(e,t,r,n){var o=t._milliseconds,i=PC(t._days),a=PC(t._months);e.isValid()&&(n=n??!0,a&&$B(e,Dg(e,"Month")+a*r),i&&_B(e,"Date",Dg(e,"Date")+i*r),o&&e._d.setTime(e._d.valueOf()+o*r),n&&te.updateOffset(e,i||a))}var Vne=YB(1,"add"),Wne=YB(-1,"subtract");function KB(e){return typeof e=="string"||e instanceof String}function Une(e){return vn(e)||lv(e)||KB(e)||No(e)||Yne(e)||zne(e)||e===null||e===void 0}function zne(e){var t=$a(e)&&!V0(e),r=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],o,i,a=n.length;for(o=0;o<a;o+=1)i=n[o],r=r||at(e,i);return t&&r}function Yne(e){var t=dn(e),r=!1;return t&&(r=e.filter(function(n){return!No(n)&&KB(e)}).length===0),t&&r}function Gne(e){var t=$a(e)&&!V0(e),r=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],o,i;for(o=0;o<n.length;o+=1)i=n[o],r=r||at(e,i);return t&&r}function Kne(e,t){var r=e.diff(t,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function qne(e,t){arguments.length===1&&(arguments[0]?Une(arguments[0])?(e=arguments[0],t=void 0):Gne(arguments[0])&&(t=arguments[0],e=void 0):(e=void 0,t=void 0));var r=e||Ct(),n=oE(r,this).startOf("day"),o=te.calendarFormat(this,n)||"sameElse",i=t&&(Vn(t[o])?t[o].call(this,r):t[o]);return this.format(i||this.localeData().calendar(o,this,Ct(r)))}function Xne(){return new sv(this)}function Zne(e,t){var r=vn(e)?e:Ct(e);return this.isValid()&&r.isValid()?(t=Qr(t)||"millisecond",t==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(t).valueOf()):!1}function Qne(e,t){var r=vn(e)?e:Ct(e);return this.isValid()&&r.isValid()?(t=Qr(t)||"millisecond",t==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(t).valueOf()<r.valueOf()):!1}function Jne(e,t,r,n){var o=vn(e)?e:Ct(e),i=vn(t)?t:Ct(t);return this.isValid()&&o.isValid()&&i.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(o,r):!this.isBefore(o,r))&&(n[1]===")"?this.isBefore(i,r):!this.isAfter(i,r))):!1}function eoe(e,t){var r=vn(e)?e:Ct(e),n;return this.isValid()&&r.isValid()?(t=Qr(t)||"millisecond",t==="millisecond"?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf())):!1}function toe(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function roe(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function noe(e,t,r){var n,o,i;if(!this.isValid())return NaN;if(n=oE(e,this),!n.isValid())return NaN;switch(o=(n.utcOffset()-this.utcOffset())*6e4,t=Qr(t),t){case"year":i=Zy(this,n)/12;break;case"month":i=Zy(this,n);break;case"quarter":i=Zy(this,n)/3;break;case"second":i=(this-n)/1e3;break;case"minute":i=(this-n)/6e4;break;case"hour":i=(this-n)/36e5;break;case"day":i=(this-n-o)/864e5;break;case"week":i=(this-n-o)/6048e5;break;default:i=this-n}return r?i:Gr(i)}function Zy(e,t){if(e.date()<t.date())return-Zy(t,e);var r=(t.year()-e.year())*12+(t.month()-e.month()),n=e.clone().add(r,"months"),o,i;return t-n<0?(o=e.clone().add(r-1,"months"),i=(t-n)/(n-o)):(o=e.clone().add(r+1,"months"),i=(t-n)/(o-n)),-(r+i)||0}te.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";te.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function ooe(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function ioe(e){if(!this.isValid())return null;var t=e!==!0,r=t?this.clone().utc():this;return r.year()<0||r.year()>9999?qy(r,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Vn(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",qy(r,"Z")):qy(r,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function aoe(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="",r,n,o,i;return this.isLocal()||(e=this.utcOffset()===0?"moment.utc":"moment.parseZone",t="Z"),r="["+e+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",o="-MM-DD[T]HH:mm:ss.SSS",i=t+'[")]',this.format(r+n+o+i)}function loe(e){e||(e=this.isUtc()?te.defaultFormatUtc:te.defaultFormat);var t=qy(this,e);return this.localeData().postformat(t)}function soe(e,t){return this.isValid()&&(vn(e)&&e.isValid()||Ct(e).isValid())?bn({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function uoe(e){return this.from(Ct(),e)}function foe(e,t){return this.isValid()&&(vn(e)&&e.isValid()||Ct(e).isValid())?bn({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function coe(e){return this.to(Ct(),e)}function qB(e){var t;return e===void 0?this._locale._abbr:(t=Bo(e),t!=null&&(this._locale=t),this)}var XB=Zr("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return e===void 0?this.localeData():this.locale(e)});function ZB(){return this._locale}var Lg=1e3,Yl=60*Lg,jg=60*Yl,QB=(365*400+97)*24*jg;function Gl(e,t){return(e%t+t)%t}function JB(e,t,r){return e<100&&e>=0?new Date(e+400,t,r)-QB:new Date(e,t,r).valueOf()}function eV(e,t,r){return e<100&&e>=0?Date.UTC(e+400,t,r)-QB:Date.UTC(e,t,r)}function hoe(e){var t,r;if(e=Qr(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?eV:JB,e){case"year":t=r(this.year(),0,1);break;case"quarter":t=r(this.year(),this.month()-this.month()%3,1);break;case"month":t=r(this.year(),this.month(),1);break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=r(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=Gl(t+(this._isUTC?0:this.utcOffset()*Yl),jg);break;case"minute":t=this._d.valueOf(),t-=Gl(t,Yl);break;case"second":t=this._d.valueOf(),t-=Gl(t,Lg);break}return this._d.setTime(t),te.updateOffset(this,!0),this}function doe(e){var t,r;if(e=Qr(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?eV:JB,e){case"year":t=r(this.year()+1,0,1)-1;break;case"quarter":t=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=r(this.year(),this.month()+1,1)-1;break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=jg-Gl(t+(this._isUTC?0:this.utcOffset()*Yl),jg)-1;break;case"minute":t=this._d.valueOf(),t+=Yl-Gl(t,Yl)-1;break;case"second":t=this._d.valueOf(),t+=Lg-Gl(t,Lg)-1;break}return this._d.setTime(t),te.updateOffset(this,!0),this}function voe(){return this._d.valueOf()-(this._offset||0)*6e4}function yoe(){return Math.floor(this.valueOf()/1e3)}function goe(){return new Date(this.valueOf())}function poe(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function moe(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function boe(){return this.isValid()?this.toISOString():null}function woe(){return W0(this)}function Soe(){return ai({},ze(this))}function Coe(){return ze(this).overflow}function _oe(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Te("N",0,0,"eraAbbr");Te("NN",0,0,"eraAbbr");Te("NNN",0,0,"eraAbbr");Te("NNNN",0,0,"eraName");Te("NNNNN",0,0,"eraNarrow");Te("y",["y",1],"yo","eraYear");Te("y",["yy",2],0,"eraYear");Te("y",["yyy",3],0,"eraYear");Te("y",["yyyy",4],0,"eraYear");we("N",iE);we("NN",iE);we("NNN",iE);we("NNNN",xoe);we("NNNNN",Doe);mt(["N","NN","NNN","NNNN","NNNNN"],function(e,t,r,n){var o=r._locale.erasParse(e,n,r._strict);o?ze(r).era=o:ze(r).invalidEra=e});we("y",Cf);we("yy",Cf);we("yyy",Cf);we("yyyy",Cf);we("yo",Noe);mt(["y","yy","yyy","yyyy"],ir);mt(["yo"],function(e,t,r,n){var o;r._locale._eraYearOrdinalRegex&&(o=e.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?t[ir]=r._locale.eraYearOrdinalParse(e,o):t[ir]=parseInt(e,10)});function Ooe(e,t){var r,n,o,i=this._eras||Bo("en")._eras;for(r=0,n=i.length;r<n;++r){switch(typeof i[r].since){case"string":o=te(i[r].since).startOf("day"),i[r].since=o.valueOf();break}switch(typeof i[r].until){case"undefined":i[r].until=1/0;break;case"string":o=te(i[r].until).startOf("day").valueOf(),i[r].until=o.valueOf();break}}return i}function Roe(e,t,r){var n,o,i=this.eras(),a,l,s;for(e=e.toUpperCase(),n=0,o=i.length;n<o;++n)if(a=i[n].name.toUpperCase(),l=i[n].abbr.toUpperCase(),s=i[n].narrow.toUpperCase(),r)switch(t){case"N":case"NN":case"NNN":if(l===e)return i[n];break;case"NNNN":if(a===e)return i[n];break;case"NNNNN":if(s===e)return i[n];break}else if([a,l,s].indexOf(e)>=0)return i[n]}function Eoe(e,t){var r=e.since<=e.until?1:-1;return t===void 0?te(e.since).year():te(e.since).year()+(t-e.offset)*r}function Toe(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].name;return""}function Poe(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].narrow;return""}function koe(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].abbr;return""}function $oe(){var e,t,r,n,o=this.localeData().eras();for(e=0,t=o.length;e<t;++e)if(r=o[e].since<=o[e].until?1:-1,n=this.clone().startOf("day").valueOf(),o[e].since<=n&&n<=o[e].until||o[e].until<=n&&n<=o[e].since)return(this.year()-te(o[e].since).year())*r+o[e].offset;return this.year()}function Aoe(e){return at(this,"_erasNameRegex")||aE.call(this),e?this._erasNameRegex:this._erasRegex}function Ioe(e){return at(this,"_erasAbbrRegex")||aE.call(this),e?this._erasAbbrRegex:this._erasRegex}function Moe(e){return at(this,"_erasNarrowRegex")||aE.call(this),e?this._erasNarrowRegex:this._erasRegex}function iE(e,t){return t.erasAbbrRegex(e)}function xoe(e,t){return t.erasNameRegex(e)}function Doe(e,t){return t.erasNarrowRegex(e)}function Noe(e,t){return t._eraYearOrdinalRegex||Cf}function aE(){var e=[],t=[],r=[],n=[],o,i,a=this.eras();for(o=0,i=a.length;o<i;++o)t.push(Hr(a[o].name)),e.push(Hr(a[o].abbr)),r.push(Hr(a[o].narrow)),n.push(Hr(a[o].name)),n.push(Hr(a[o].abbr)),n.push(Hr(a[o].narrow));this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+t.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+e.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}Te(0,["gg",2],0,function(){return this.weekYear()%100});Te(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Em(e,t){Te(0,[e,e.length],0,t)}Em("gggg","weekYear");Em("ggggg","weekYear");Em("GGGG","isoWeekYear");Em("GGGGG","isoWeekYear");sr("weekYear","gg");sr("isoWeekYear","GG");ur("weekYear",1);ur("isoWeekYear",1);we("G",Sm);we("g",Sm);we("GG",_t,Vr);we("gg",_t,Vr);we("GGGG",q0,K0);we("gggg",q0,K0);we("GGGGG",wm,mm);we("ggggg",wm,mm);fv(["gggg","ggggg","GGGG","GGGGG"],function(e,t,r,n){t[n.substr(0,2)]=Ze(e)});fv(["gg","GG"],function(e,t,r,n){t[n]=te.parseTwoDigitYear(e)});function Hoe(e){return tV.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function Loe(e){return tV.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function joe(){return Io(this.year(),1,4)}function Foe(){return Io(this.isoWeekYear(),1,4)}function Boe(){var e=this.localeData()._week;return Io(this.year(),e.dow,e.doy)}function Voe(){var e=this.localeData()._week;return Io(this.weekYear(),e.dow,e.doy)}function tV(e,t,r,n,o){var i;return e==null?Dc(this,n,o).year:(i=Io(e,n,o),t>i&&(t=i),Woe.call(this,e,t,r,n,o))}function Woe(e,t,r,n,o){var i=xB(e,t,r,n,o),a=xc(i.year,0,i.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}Te("Q",0,"Qo","quarter");sr("quarter","Q");ur("quarter",7);we("Q",OB);mt("Q",function(e,t){t[oo]=(Ze(e)-1)*3});function Uoe(e){return e==null?Math.ceil((this.month()+1)/3):this.month((e-1)*3+this.month()%3)}Te("D",["DD",2],"Do","date");sr("date","D");ur("date",9);we("D",_t);we("DD",_t,Vr);we("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient});mt(["D","DD"],xn);mt("Do",function(e,t){t[xn]=Ze(e.match(_t)[0])});var rV=Sf("Date",!0);Te("DDD",["DDDD",3],"DDDo","dayOfYear");sr("dayOfYear","DDD");ur("dayOfYear",4);we("DDD",bm);we("DDDD",RB);mt(["DDD","DDDD"],function(e,t,r){r._dayOfYear=Ze(e)});function zoe(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return e==null?t:this.add(e-t,"d")}Te("m",["mm",2],0,"minute");sr("minute","m");ur("minute",14);we("m",_t);we("mm",_t,Vr);mt(["m","mm"],cn);var Yoe=Sf("Minutes",!1);Te("s",["ss",2],0,"second");sr("second","s");ur("second",15);we("s",_t);we("ss",_t,Vr);mt(["s","ss"],io);var Goe=Sf("Seconds",!1);Te("S",0,0,function(){return~~(this.millisecond()/100)});Te(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Te(0,["SSS",3],0,"millisecond");Te(0,["SSSS",4],0,function(){return this.millisecond()*10});Te(0,["SSSSS",5],0,function(){return this.millisecond()*100});Te(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Te(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Te(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Te(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});sr("millisecond","ms");ur("millisecond",16);we("S",bm,OB);we("SS",bm,Vr);we("SSS",bm,RB);var li,nV;for(li="SSSS";li.length<=9;li+="S")we(li,Cf);function Koe(e,t){t[ea]=Ze(("0."+e)*1e3)}for(li="S";li.length<=9;li+="S")mt(li,Koe);nV=Sf("Milliseconds",!1);Te("z",0,0,"zoneAbbr");Te("zz",0,0,"zoneName");function qoe(){return this._isUTC?"UTC":""}function Xoe(){return this._isUTC?"Coordinated Universal Time":""}var ne=sv.prototype;ne.add=Vne;ne.calendar=qne;ne.clone=Xne;ne.diff=noe;ne.endOf=doe;ne.format=loe;ne.from=soe;ne.fromNow=uoe;ne.to=foe;ne.toNow=coe;ne.get=Qte;ne.invalidAt=Coe;ne.isAfter=Zne;ne.isBefore=Qne;ne.isBetween=Jne;ne.isSame=eoe;ne.isSameOrAfter=toe;ne.isSameOrBefore=roe;ne.isValid=woe;ne.lang=XB;ne.locale=qB;ne.localeData=ZB;ne.max=wne;ne.min=bne;ne.parsingFlags=Soe;ne.set=Jte;ne.startOf=hoe;ne.subtract=Wne;ne.toArray=poe;ne.toObject=moe;ne.toDate=goe;ne.toISOString=ioe;ne.inspect=aoe;typeof Symbol<"u"&&Symbol.for!=null&&(ne[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});ne.toJSON=boe;ne.toString=ooe;ne.unix=yoe;ne.valueOf=voe;ne.creationData=_oe;ne.eraName=Toe;ne.eraNarrow=Poe;ne.eraAbbr=koe;ne.eraYear=$oe;ne.year=MB;ne.isLeapYear=mre;ne.weekYear=Hoe;ne.isoWeekYear=Loe;ne.quarter=ne.quarters=Uoe;ne.month=AB;ne.daysInMonth=yre;ne.week=ne.weeks=Ore;ne.isoWeek=ne.isoWeeks=Rre;ne.weeksInYear=Boe;ne.weeksInWeekYear=Voe;ne.isoWeeksInYear=joe;ne.isoWeeksInISOWeekYear=Foe;ne.date=rV;ne.day=ne.days=Lre;ne.weekday=jre;ne.isoWeekday=Fre;ne.dayOfYear=zoe;ne.hour=ne.hours=Gre;ne.minute=ne.minutes=Yoe;ne.second=ne.seconds=Goe;ne.millisecond=ne.milliseconds=nV;ne.utcOffset=kne;ne.utc=Ane;ne.local=Ine;ne.parseZone=Mne;ne.hasAlignedHourOffset=xne;ne.isDST=Dne;ne.isLocal=Hne;ne.isUtcOffset=Lne;ne.isUtc=zB;ne.isUTC=zB;ne.zoneAbbr=qoe;ne.zoneName=Xoe;ne.dates=Zr("dates accessor is deprecated. Use date instead.",rV);ne.months=Zr("months accessor is deprecated. Use month instead",AB);ne.years=Zr("years accessor is deprecated. Use year instead",MB);ne.zone=Zr("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",$ne);ne.isDSTShifted=Zr("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",Nne);function Zoe(e){return Ct(e*1e3)}function Qoe(){return Ct.apply(null,arguments).parseZone()}function oV(e){return e}var lt=z0.prototype;lt.calendar=Lte;lt.longDateFormat=Vte;lt.invalidDate=Ute;lt.ordinal=Gte;lt.preparse=oV;lt.postformat=oV;lt.relativeTime=qte;lt.pastFuture=Xte;lt.set=Nte;lt.eras=Ooe;lt.erasParse=Roe;lt.erasConvertYear=Eoe;lt.erasAbbrRegex=Ioe;lt.erasNameRegex=Aoe;lt.erasNarrowRegex=Moe;lt.months=cre;lt.monthsShort=hre;lt.monthsParse=vre;lt.monthsRegex=pre;lt.monthsShortRegex=gre;lt.week=wre;lt.firstDayOfYear=_re;lt.firstDayOfWeek=Cre;lt.weekdays=Mre;lt.weekdaysMin=Dre;lt.weekdaysShort=xre;lt.weekdaysParse=Hre;lt.weekdaysRegex=Bre;lt.weekdaysShortRegex=Vre;lt.weekdaysMinRegex=Wre;lt.isPM=zre;lt.meridiem=Kre;function Fg(e,t,r,n){var o=Bo(),i=Bn().set(n,t);return o[r](i,e)}function iV(e,t,r){if(No(e)&&(t=e,e=void 0),e=e||"",t!=null)return Fg(e,t,r,"month");var n,o=[];for(n=0;n<12;n++)o[n]=Fg(e,n,r,"month");return o}function lE(e,t,r,n){typeof e=="boolean"?(No(t)&&(r=t,t=void 0),t=t||""):(t=e,r=t,e=!1,No(t)&&(r=t,t=void 0),t=t||"");var o=Bo(),i=e?o._week.dow:0,a,l=[];if(r!=null)return Fg(t,(r+i)%7,n,"day");for(a=0;a<7;a++)l[a]=Fg(t,(a+i)%7,n,"day");return l}function Joe(e,t){return iV(e,t,"months")}function eie(e,t){return iV(e,t,"monthsShort")}function tie(e,t,r){return lE(e,t,r,"weekdays")}function rie(e,t,r){return lE(e,t,r,"weekdaysShort")}function nie(e,t,r){return lE(e,t,r,"weekdaysMin")}fi("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,r=Ze(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return e+r}});te.lang=Zr("moment.lang is deprecated. Use moment.locale instead.",fi);te.langData=Zr("moment.langData is deprecated. Use moment.localeData instead.",Bo);var zn=Math.abs;function oie(){var e=this._data;return this._milliseconds=zn(this._milliseconds),this._days=zn(this._days),this._months=zn(this._months),e.milliseconds=zn(e.milliseconds),e.seconds=zn(e.seconds),e.minutes=zn(e.minutes),e.hours=zn(e.hours),e.months=zn(e.months),e.years=zn(e.years),this}function aV(e,t,r,n){var o=bn(t,r);return e._milliseconds+=n*o._milliseconds,e._days+=n*o._days,e._months+=n*o._months,e._bubble()}function iie(e,t){return aV(this,e,t,1)}function aie(e,t){return aV(this,e,t,-1)}function D1(e){return e<0?Math.floor(e):Math.ceil(e)}function lie(){var e=this._milliseconds,t=this._days,r=this._months,n=this._data,o,i,a,l,s;return e>=0&&t>=0&&r>=0||e<=0&&t<=0&&r<=0||(e+=D1($C(r)+t)*864e5,t=0,r=0),n.milliseconds=e%1e3,o=Gr(e/1e3),n.seconds=o%60,i=Gr(o/60),n.minutes=i%60,a=Gr(i/60),n.hours=a%24,t+=Gr(a/24),s=Gr(lV(t)),r+=s,t-=D1($C(s)),l=Gr(r/12),r%=12,n.days=t,n.months=r,n.years=l,this}function lV(e){return e*4800/146097}function $C(e){return e*146097/4800}function sie(e){if(!this.isValid())return NaN;var t,r,n=this._milliseconds;if(e=Qr(e),e==="month"||e==="quarter"||e==="year")switch(t=this._days+n/864e5,r=this._months+lV(t),e){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(t=this._days+Math.round($C(this._months)),e){case"week":return t/7+n/6048e5;case"day":return t+n/864e5;case"hour":return t*24+n/36e5;case"minute":return t*1440+n/6e4;case"second":return t*86400+n/1e3;case"millisecond":return Math.floor(t*864e5)+n;default:throw new Error("Unknown unit "+e)}}function uie(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+Ze(this._months/12)*31536e6:NaN}function Vo(e){return function(){return this.as(e)}}var fie=Vo("ms"),cie=Vo("s"),hie=Vo("m"),die=Vo("h"),vie=Vo("d"),yie=Vo("w"),gie=Vo("M"),pie=Vo("Q"),mie=Vo("y");function bie(){return bn(this)}function wie(e){return e=Qr(e),this.isValid()?this[e+"s"]():NaN}function el(e){return function(){return this.isValid()?this._data[e]:NaN}}var Sie=el("milliseconds"),Cie=el("seconds"),_ie=el("minutes"),Oie=el("hours"),Rie=el("days"),Eie=el("months"),Tie=el("years");function Pie(){return Gr(this.days()/7)}var eo=Math.round,Bl={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function kie(e,t,r,n,o){return o.relativeTime(t||1,!!r,e,n)}function $ie(e,t,r,n){var o=bn(e).abs(),i=eo(o.as("s")),a=eo(o.as("m")),l=eo(o.as("h")),s=eo(o.as("d")),u=eo(o.as("M")),f=eo(o.as("w")),c=eo(o.as("y")),h=i<=r.ss&&["s",i]||i<r.s&&["ss",i]||a<=1&&["m"]||a<r.m&&["mm",a]||l<=1&&["h"]||l<r.h&&["hh",l]||s<=1&&["d"]||s<r.d&&["dd",s];return r.w!=null&&(h=h||f<=1&&["w"]||f<r.w&&["ww",f]),h=h||u<=1&&["M"]||u<r.M&&["MM",u]||c<=1&&["y"]||["yy",c],h[2]=t,h[3]=+e>0,h[4]=n,kie.apply(null,h)}function Aie(e){return e===void 0?eo:typeof e=="function"?(eo=e,!0):!1}function Iie(e,t){return Bl[e]===void 0?!1:t===void 0?Bl[e]:(Bl[e]=t,e==="s"&&(Bl.ss=t-1),!0)}function Mie(e,t){if(!this.isValid())return this.localeData().invalidDate();var r=!1,n=Bl,o,i;return typeof e=="object"&&(t=e,e=!1),typeof e=="boolean"&&(r=e),typeof t=="object"&&(n=Object.assign({},Bl,t),t.s!=null&&t.ss==null&&(n.ss=t.s-1)),o=this.localeData(),i=$ie(this,!r,n,o),r&&(i=o.pastFuture(+this,i)),o.postformat(i)}var uw=Math.abs;function fl(e){return(e>0)-(e<0)||+e}function Tm(){if(!this.isValid())return this.localeData().invalidDate();var e=uw(this._milliseconds)/1e3,t=uw(this._days),r=uw(this._months),n,o,i,a,l=this.asSeconds(),s,u,f,c;return l?(n=Gr(e/60),o=Gr(n/60),e%=60,n%=60,i=Gr(r/12),r%=12,a=e?e.toFixed(3).replace(/\.?0+$/,""):"",s=l<0?"-":"",u=fl(this._months)!==fl(l)?"-":"",f=fl(this._days)!==fl(l)?"-":"",c=fl(this._milliseconds)!==fl(l)?"-":"",s+"P"+(i?u+i+"Y":"")+(r?u+r+"M":"")+(t?f+t+"D":"")+(o||n||e?"T":"")+(o?c+o+"H":"")+(n?c+n+"M":"")+(e?c+a+"S":"")):"P0D"}var tt=Rm.prototype;tt.isValid=Rne;tt.abs=oie;tt.add=iie;tt.subtract=aie;tt.as=sie;tt.asMilliseconds=fie;tt.asSeconds=cie;tt.asMinutes=hie;tt.asHours=die;tt.asDays=vie;tt.asWeeks=yie;tt.asMonths=gie;tt.asQuarters=pie;tt.asYears=mie;tt.valueOf=uie;tt._bubble=lie;tt.clone=bie;tt.get=wie;tt.milliseconds=Sie;tt.seconds=Cie;tt.minutes=_ie;tt.hours=Oie;tt.days=Rie;tt.weeks=Pie;tt.months=Eie;tt.years=Tie;tt.humanize=Mie;tt.toISOString=Tm;tt.toString=Tm;tt.toJSON=Tm;tt.locale=qB;tt.localeData=ZB;tt.toIsoString=Zr("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Tm);tt.lang=XB;Te("X",0,0,"unix");Te("x",0,0,"valueOf");we("x",Sm);we("X",tre);mt("X",function(e,t,r){r._d=new Date(parseFloat(e)*1e3)});mt("x",function(e,t,r){r._d=new Date(Ze(e))});//! moment.js
te.version="2.29.4";xte(Ct);te.fn=ne;te.min=Sne;te.max=Cne;te.now=_ne;te.utc=Bn;te.unix=Zoe;te.months=Joe;te.isDate=lv;te.locale=fi;te.invalid=gm;te.duration=bn;te.isMoment=vn;te.weekdays=tie;te.parseZone=Qoe;te.localeData=Bo;te.isDuration=Xy;te.monthsShort=eie;te.weekdaysMin=nie;te.defineLocale=J0;te.updateLocale=Qre;te.locales=Jre;te.weekdaysShort=rie;te.normalizeUnits=Qr;te.relativeTimeRounding=Aie;te.relativeTimeThreshold=Iie;te.calendarFormat=Kne;te.prototype=ne;te.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const xie=Object.freeze(Object.defineProperty({__proto__:null,default:te},Symbol.toStringTag,{value:"Module"}));function ft(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o=Lt(e,function(i,a,l){var s=a.replace(/\r?\n\s*/g,""),u=r[l]?r[l]:"";return i+s+u},"");return o.trim()}var N1,H1,L1,j1,F1,B1;function Kl(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function AC(e){"@babel/helpers - typeof";return AC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},AC(e)}function It(e){var t;switch(AC(e)){case"string":case"number":t="".concat(e);break;case"object":t=e===null?"":e.toString();break;case"undefined":t="";break;default:t=e.toString();break}return t}function ve(e){return typeof e<"u"}function gt(e){return typeof e>"u"}function Kt(e){return e===null||e===""||gt(e)}function sV(e){return Object.prototype.toString.call(e)==="[object RegExp]"}var sc="length",pc=function(t){return parseInt(t,16)},V1=function(t){return parseInt(t,10)},Bg=function(t,r,n){return t.substr(r,n)},mc=function(t){return t.codePointAt(0)-65},IC=function(t){return"".concat(t).replace(/\-/g,"")},Die=function(t){return pc(Bg(IC(t),pc("12"),mc("F")))/(pc(Bg(IC(t),mc("B"),~~![][sc]))||9)},Nie=function(){return typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)},W1=!1,U1={invalid:function(){return ft(N1||(N1=Kl([`
    The license key for Handsontable is invalid. 
    If you need any help, contact us at support@handsontable.com.`],[`
    The license key for Handsontable is invalid.\\x20
    If you need any help, contact us at support@handsontable.com.`])))},expired:function(t){var r=t.keyValidityDate,n=t.hotVersion;return ft(H1||(H1=Kl([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior 
    to `,". If you need any help, contact us at sales@handsontable.com."],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior\\x20
    to `,". If you need any help, contact us at sales@handsontable.com."])),r,n,r)},missing:function(){return ft(L1||(L1=Kl([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact 
    us at support@handsontable.com.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\\x20
    us at support@handsontable.com.`])))},non_commercial:function(){return""}},z1={invalid:function(){return ft(j1||(j1=Kl([`
    The license key for Handsontable is invalid. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to 
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is invalid.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},expired:function(t){var r=t.keyValidityDate,n=t.hotVersion;return ft(F1||(F1=Kl([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your 
    license key or downgrade to a version released prior to `,`. If you need any 
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\\x20
    license key or downgrade to a version released prior to `,`. If you need any\\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`])),r,n,r)},missing:function(){return ft(B1||(B1=Kl([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in 
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},non_commercial:function(){return""}};function uV(e,t){var r=!Kt(e),n=typeof e=="string"&&e.toLowerCase()==="non-commercial-and-evaluation",o="12.4.0",i,a="invalid",l="invalid";e=IC(e||"");var s=Hie(e);if(r||n||s)if(s){var u=te("23/05/2023","DD/MM/YYYY"),f=Math.floor(u.toDate().getTime()/864e5),c=Die(e);i=te((c+1)*864e5,"x").format("MMMM DD, YYYY"),f>c?(a="expired",l="expired"):(a="valid",l="valid")}else n?(a="non_commercial",l="valid"):(a="invalid",l="invalid");else a="missing",l="missing";if(Nie()&&(a="valid",l="valid"),!W1&&a!=="valid"){var h=U1[a]({keyValidityDate:i,hotVersion:o});h&&console[a==="non_commercial"?"info":"warn"](U1[a]({keyValidityDate:i,hotVersion:o})),W1=!0}if(l!=="valid"&&t.parentNode){var d=z1[l]({keyValidityDate:i,hotVersion:o});if(d){var v=document.createElement("div");v.className="hot-display-license-info",v.innerHTML=z1[l]({keyValidityDate:i,hotVersion:o}),t.parentNode.insertBefore(v,t.nextSibling)}}}function Hie(e){var t=[][sc],r=t;if(e[sc]!==mc("Z"))return!1;for(var n="",o="B<H4P+".split(""),i=mc(o.shift());i;i=mc(o.shift()||"A"))--i<""[sc]?r=r|(V1("".concat(V1(pc(n)+(pc(Bg(e,Math.abs(i),2))+[]).padStart(2,"0"))))%97||2)>>1:n=Bg(e,i,i?o[sc]===1?9:8:6);return r===t}const Lie=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:uV,isDefined:ve,isEmpty:Kt,isRegExp:sV,isUndefined:gt,stringify:It},Symbol.toStringTag,{value:"Module"}));function ar(e){return e[0].toUpperCase()+e.substr(1)}function jie(){for(var e=[],t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];for(var o=r.length;o;){o-=1;var i=It(r[o]).toLowerCase();e.indexOf(i)===-1&&e.push(i)}return e.length===1}function sE(){function e(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return e()+e()+e()+e()}function uE(e){return/^([0-9][0-9]?%$)|(^100%$)/.test(e)}function fE(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return"".concat(e).replace(/(?:\\)?\[([^[\]]+)]/g,function(r,n){return r.charAt(0)==="\\"?r.substr(1,r.length-1):t[n]===void 0?"":t[n]})}function MC(e){return Pm("".concat(e),{ALLOWED_TAGS:[]})}function Pm(e,t){return yte.sanitize(e,t)}const Fie=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:jie,isPercentValue:uE,randomString:sE,sanitize:Pm,stripTags:MC,substitute:fE,toUpperCaseFirst:ar},Symbol.toStringTag,{value:"Module"}));function Y1(e){return Uie(e)||Wie(e)||Vie(e)||Bie()}function Bie(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Vie(e,t){if(e){if(typeof e=="string")return xC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xC(e,t)}}function Wie(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Uie(e){if(Array.isArray(e))return xC(e)}function xC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function fV(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=null,o=e;o!==null;){if(r===t){n=o;break}o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:(r+=1,o=o.parentNode)}return n}function cV(e){return Object.getPrototypeOf(e.parent)&&e.frameElement}function Hc(e){return cV(e)&&e.parent}function zie(e){return!!Object.getPrototypeOf(e.parent)}function ci(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,n=Node,o=n.ELEMENT_NODE,i=n.DOCUMENT_FRAGMENT_NODE,a=e;a!=null&&a!==r;){var l=a,s=l.nodeType,u=l.nodeName;if(s===o&&(t.includes(u)||t.includes(a)))return a;var f=a,c=f.host;c&&s===i?a=c:a=a.parentNode}return null}function uc(e,t,r){for(var n=[],o=e;o&&(o=ci(o,t,r),!(!o||r&&!r.contains(o)));)n.push(o),o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:o=o.parentNode;var i=n.length;return i?n[i-1]:null}function hi(e,t){var r=e.parentNode,n=[];for(typeof t=="string"?e.defaultView?n=Array.prototype.slice.call(e.querySelectorAll(t),0):n=Array.prototype.slice.call(e.ownerDocument.querySelectorAll(t),0):n.push(t);r!==null;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function hV(e){var t=0,r=e;if(r.previousSibling)for(;r=r.previousSibling;)t+=1;return t}function ti(e,t,r){var n=r.parentElement.querySelector(".ht_clone_".concat(e));return n?n.contains(t):null}var DC,NC,HC;function Kv(e){return!e||!e.length?[]:e.filter(function(t){return!!t})}if(qF()){var G1=function(t){var r=t.createElement("div");return r.classList.add("test","test2"),r.classList.contains("test2")};DC=function(t,r){return t.classList===void 0||typeof r!="string"||r===""?!1:t.classList.contains(r)},NC=function(t,r){var n=t.ownerDocument,o=r;if(typeof o=="string"&&(o=o.split(" ")),o=Kv(o),o.length>0)if(G1(n)){var i;(i=t.classList).add.apply(i,Y1(o))}else for(var a=0;o[a];)t.classList.add(o[a]),a+=1},HC=function(t,r){var n=t.ownerDocument,o=r;if(typeof o=="string"&&(o=o.split(" ")),o=Kv(o),o.length>0)if(G1(n)){var i;(i=t.classList).remove.apply(i,Y1(o))}else for(var a=0;o[a];)t.classList.remove(o[a]),a+=1}}else{var fw=function(t){return new RegExp("(\\s|^)".concat(t,"(\\s|$)"))};DC=function(t,r){return t.className!==void 0&&fw(r).test(t.className)},NC=function(t,r){var n=t.className,o=r;if(typeof o=="string"&&(o=o.split(" ")),o=Kv(o),n==="")n=o.join(" ");else for(var i=0;i<o.length;i++)o[i]&&!fw(o[i]).test(n)&&(n+=" ".concat(o[i]));t.className=n},HC=function(t,r){var n=0,o=t.className,i=r;for(typeof i=="string"&&(i=i.split(" ")),i=Kv(i);i[n];)o=o.replace(fw(i[n])," ").trim(),n+=1;t.className!==o&&(t.className=o)}}function xe(e,t){return DC(e,t)}function re(e,t){NC(e,t)}function Le(e,t){HC(e,t)}function cE(e){if(e.nodeType===3)e.parentNode.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1)for(var t=e.childNodes,r=t.length-1;r>=0;r--)cE(t[r])}function yn(e){for(var t;t=e.lastChild;)e.removeChild(t)}var dV=/(<(.*)>|&(.*);)/;function tl(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;dV.test(t)?e.innerHTML=r?Pm(t):t:Oi(e,t)}function Oi(e,t){var r=e.firstChild;r&&r.nodeType===3&&r.nextSibling===null?XF?r.textContent=t:r.data=t:(yn(e),e.appendChild(e.ownerDocument.createTextNode(t)))}function us(e){for(var t=e.ownerDocument.documentElement,r=e;r!==t;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return us(r.host.impl);if(r.host)return us(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(r.style&&r.style.display==="none")return!1;r=r.parentNode}return!0}function Vt(e){var t=e.ownerDocument,r=t.defaultView,n=t.documentElement,o=e,i,a,l,s;if(N0()&&o.firstChild&&o.firstChild.nodeName==="CAPTION")return s=o.getBoundingClientRect(),{top:s.top+(r.pageYOffset||n.scrollTop)-(n.clientTop||0),left:s.left+(r.pageXOffset||n.scrollLeft)-(n.clientLeft||0)};for(i=o.offsetLeft,a=o.offsetTop,l=o;(o=o.offsetParent)&&o!==t.body;)i+=o.offsetLeft,a+=o.offsetTop,l=o;return l&&l.style.position==="fixed"&&(i+=r.pageXOffset||n.scrollLeft,a+=r.pageYOffset||n.scrollTop),{left:i,top:a}}function fs(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.scrollY;return t===void 0&&(t=e.document.documentElement.scrollTop),t}function Ma(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.scrollX;return t===void 0&&(t=e.document.documentElement.scrollLeft),t}function Lc(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e===t?fs(t):e.scrollTop}function Vg(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e===t?Ma(t):e.scrollLeft}function jc(e){var t=e.ownerDocument,r=t?t.defaultView:void 0;t||(t=e.document?e.document:e,r=t.defaultView);for(var n=["auto","scroll"],o=ZF(),i=e.parentNode;i&&i.style&&t.body!==i;){var a=i.style,l=a.overflow,s=a.overflowX,u=a.overflowY;if([l,s,u].includes("scroll"))return i;if(o){var f=r.getComputedStyle(i);if(l=f.overflow,s=f.overflowX,u=f.overflowY,n.includes(l)||n.includes(s)||n.includes(u))return i}if(i.clientHeight<=i.scrollHeight+1&&(n.includes(u)||n.includes(l))||i.clientWidth<=i.scrollWidth+1&&(n.includes(s)||n.includes(l)))return i;i=i.parentNode}return r}function xa(e){for(var t=e.ownerDocument,r=t.defaultView,n=e.parentNode;n&&n.style&&t.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;var o=Ri(n,r),i=["scroll","hidden","auto"],a=o.getPropertyValue("overflow"),l=o.getPropertyValue("overflow-y"),s=o.getPropertyValue("overflow-x");if(i.includes(a)||i.includes(l)||i.includes(s))return n;n=n.parentNode}return r}function cs(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(e){if(e===r)return t==="width"?"".concat(r.innerWidth,"px"):t==="height"?"".concat(r.innerHeight,"px"):void 0}else return;var n=e.style[t];if(n!==""&&n!==void 0)return n;var o=Ri(e,r);if(o[t]!==""&&o[t]!==void 0)return o[t]}function Yie(e,t){var r=t.selectorText,n=!1;return t.type===CSSRule.STYLE_RULE&&r&&(e.msMatchesSelector?n=e.msMatchesSelector(r):e.matches&&(n=e.matches(r))),n}function Ri(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e.currentStyle||t.getComputedStyle(e)}function dt(e){return e.offsetWidth}function Rt(e){return N0()&&e.firstChild&&e.firstChild.nodeName==="CAPTION"?e.offsetHeight+e.firstChild.offsetHeight:e.offsetHeight}function ao(e){return e.clientHeight||e.innerHeight}function bc(e){return e.clientWidth||e.innerWidth}function Gie(e,t,r){e.addEventListener(t,r,!1)}function Kie(e,t,r){e.removeEventListener(t,r,!1)}function hE(e){var t=e.ownerDocument;if(e.selectionStart)return e.selectionStart;if(t.selection){e.focus();var r=t.selection.createRange();if(r===null)return 0;var n=e.createTextRange(),o=n.duplicate();return n.moveToBookmark(r.getBookmark()),o.setEndPoint("EndToStart",n),o.text.length}return 0}function vV(e){var t=e.ownerDocument;if(e.selectionEnd)return e.selectionEnd;if(t.selection){var r=t.selection.createRange();if(r===null)return 0;var n=e.createTextRange();return n.text.indexOf(r.text)+r.text.length}return 0}function yV(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.document,r="";return e.getSelection?r=e.getSelection().toString():t.selection&&t.selection.type!=="Control"&&(r=t.selection.createRange().text),r}function LC(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.document;e.getSelection?e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges():t.selection&&t.selection.empty()}function cv(e,t,r){if(r===void 0&&(r=t),e.setSelectionRange){e.focus();try{e.setSelectionRange(t,r)}catch{var n=e.parentNode,o=n.style.display;n.style.display="block",e.setSelectionRange(t,r),n.style.display=o}}}var cw;function qie(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,t=e.createElement("div");t.style.height="200px",t.style.width="100%";var r=e.createElement("div");r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(t),(e.body||e.documentElement).appendChild(r);var n=t.offsetWidth;r.style.overflow="scroll";var o=t.offsetWidth;return n===o&&(o=r.clientWidth),(e.body||e.documentElement).removeChild(r),n-o}function Xt(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return cw===void 0&&(cw=qie(e)),cw}function gV(e){return e.offsetWidth!==e.clientWidth}function pV(e){return e.offsetHeight!==e.clientHeight}function km(e,t,r){dB()?(e.style.top=r,e.style.left=t):fB()?e.style["-webkit-transform"]="translate3d(".concat(t,",").concat(r,",0)"):e.style.transform="translate3d(".concat(t,",").concat(r,",0)")}function Xie(e){var t;return e.style.transform&&(t=e.style.transform)!==""?["transform",t]:e.style["-webkit-transform"]&&(t=e.style["-webkit-transform"])!==""?["-webkit-transform",t]:-1}function hv(e){e.style.transform&&e.style.transform!==""?e.style.transform="":e.style["-webkit-transform"]&&e.style["-webkit-transform"]!==""&&(e.style["-webkit-transform"]="")}function Fc(e){var t=["INPUT","SELECT","TEXTAREA"];return e&&(t.indexOf(e.nodeName)>-1||e.contentEditable==="true")}function $m(e){return Fc(e)&&e.hasAttribute("data-hot-input")===!1}function mV(e){var t=e.ownerDocument.activeElement;$m(t)||e.select()}function dE(e){return!e.parentNode}function bV(e,t){var r=new IntersectionObserver(function(n,o){n.forEach(function(i){i.isIntersecting&&e.offsetParent!==null&&(t(),o.unobserve(e))})},{root:e.ownerDocument.body});r.observe(e)}const Zie=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:dV,addClass:re,addEvent:Gie,clearTextSelection:LC,closest:ci,closestDown:uc,empty:yn,fastInnerHTML:tl,fastInnerText:Oi,getCaretPosition:hE,getComputedStyle:Ri,getCssTransform:Xie,getFrameElement:cV,getParent:fV,getParentWindow:Hc,getScrollLeft:Vg,getScrollTop:Lc,getScrollableElement:jc,getScrollbarWidth:Xt,getSelectionEndPosition:vV,getSelectionText:yV,getStyle:cs,getTrimmingContainer:xa,getWindowScrollLeft:Ma,getWindowScrollTop:fs,hasAccessToParentWindow:zie,hasClass:xe,hasHorizontalScrollbar:pV,hasVerticalScrollbar:gV,index:hV,innerHeight:ao,innerWidth:bc,isChildOf:hi,isDetached:dE,isInput:Fc,isOutsideInput:$m,isVisible:us,matchesCSSRules:Yie,observeVisibilityChangeOnce:bV,offset:Vt,outerHeight:Rt,outerWidth:dt,overlayContainsElement:ti,removeClass:Le,removeEvent:Kie,removeTextNodes:cE,resetCssTransform:hv,selectElementIfAllowed:mV,setCaretPosition:cv,setOverlayPosition:km},Symbol.toStringTag,{value:"Module"}));function bt(e){return typeof e=="function"}function wV(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=0,n={lastCallThrottled:!0},o=null;function i(){for(var a=this,l=arguments.length,s=new Array(l),u=0;u<l;u++)s[u]=arguments[u];var f=Date.now(),c=!1;n.lastCallThrottled=!0,r||(r=f,c=!0);var h=t-(f-r);return c?(n.lastCallThrottled=!1,e.apply(this,s)):(o&&clearTimeout(o),o=setTimeout(function(){n.lastCallThrottled=!1,e.apply(a,s),r=0,o=void 0},h)),n}return i}function Qie(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,n=wV(e,t),o=r;function i(){o=r}function a(){for(var l=arguments.length,s=new Array(l),u=0;u<l;u++)s[u]=arguments[u];return o?(o-=1,e.apply(this,s)):n.apply(this,s)}return a.clearHits=i,a}function vE(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=null,n;function o(){for(var i=this,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return r&&clearTimeout(r),r=setTimeout(function(){n=e.apply(i,l)},t),n}return o}function Jie(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t[0],o=t.slice(1);return function(){for(var a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return Lt(o,function(u,f){return f(u)},n.apply(this,l))}}function yE(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return function(){for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];return e.apply(this,r.concat(a))}}function SV(e){var t=e.length;function r(n){return function(){for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];var s=n.concat(a),u;return s.length>=t?u=e.apply(this,s):u=r(s),u}}return r([])}function eae(e){var t=e.length;function r(n){return function(){for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];var s=n.concat(a.reverse()),u;return s.length>=t?u=e.apply(this,s):u=r(s),u}}return r([])}function Wg(e,t,r,n,o,i,a,l){return ve(l)?e.call(t,r,n,o,i,a,l):ve(a)?e.call(t,r,n,o,i,a):ve(i)?e.call(t,r,n,o,i):ve(o)?e.call(t,r,n,o):ve(n)?e.call(t,r,n):ve(r)?e.call(t,r):e.call(t)}const tae=Object.freeze(Object.defineProperty({__proto__:null,curry:SV,curryRight:eae,debounce:vE,fastCall:Wg,isFunction:bt,partial:yE,pipe:Jie,throttle:wV,throttleAfterHits:Qie},Symbol.toStringTag,{value:"Module"}));function ht(){if(ve(console)){var e;(e=console).warn.apply(e,arguments)}}function gE(){if(ve(console)){var e;(e=console).error.apply(e,arguments)}}var rae=Ue,K1=g0,qv=Jd.getWeakData,nae=v0,oae=Ht,iae=pn,hw=Nt,aae=d0,CV=Ja,q1=Mt,_V=jo,lae=_V.set,sae=_V.getterFor,uae=CV.find,fae=CV.findIndex,cae=rae([].splice),hae=0,Xv=function(e){return e.frozen||(e.frozen=new OV)},OV=function(){this.entries=[]},dw=function(e,t){return uae(e.entries,function(r){return r[0]===t})};OV.prototype={get:function(e){var t=dw(this,e);if(t)return t[1]},has:function(e){return!!dw(this,e)},set:function(e,t){var r=dw(this,e);r?r[1]=t:this.entries.push([e,t])},delete:function(e){var t=fae(this.entries,function(r){return r[0]===e});return~t&&cae(this.entries,t,1),!!~t}};var RV={getConstructor:function(e,t,r,n){var o=e(function(s,u){nae(s,i),lae(s,{type:t,id:hae++,frozen:void 0}),iae(u)||aae(u,s[n],{that:s,AS_ENTRIES:r})}),i=o.prototype,a=sae(t),l=function(s,u,f){var c=a(s),h=qv(oae(u),!0);return h===!0?Xv(c).set(u,f):h[c.id]=f,s};return K1(i,{delete:function(s){var u=a(this);if(!hw(s))return!1;var f=qv(s);return f===!0?Xv(u).delete(s):f&&q1(f,u.id)&&delete f[u.id]},has:function(u){var f=a(this);if(!hw(u))return!1;var c=qv(u);return c===!0?Xv(f).has(u):c&&q1(c,f.id)}}),K1(i,r?{get:function(u){var f=a(this);if(hw(u)){var c=qv(u);return c===!0?Xv(f).get(u):c?c[f.id]:void 0}},set:function(u,f){return l(this,u,f)}}:{add:function(u){return l(this,u,!0)}}),o}},dae=o0,X1=vt,Qy=Ue,Z1=g0,vae=Jd,yae=am,EV=RV,Zv=Nt,Qv=jo.enforce,gae=je,pae=QL,dv=Object,mae=Array.isArray,Jv=dv.isExtensible,TV=dv.isFrozen,bae=dv.isSealed,PV=dv.freeze,wae=dv.seal,Sae=!X1.ActiveXObject&&"ActiveXObject"in X1,Lf,kV=function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},$V=yae("WeakMap",kV,EV),Hl=$V.prototype,Jy=Qy(Hl.set),Cae=function(){return dae&&gae(function(){var e=PV([]);return Jy(new $V,e,1),!TV(e)})};if(pae)if(Sae){Lf=EV.getConstructor(kV,"WeakMap",!0),vae.enable();var Q1=Qy(Hl.delete),ey=Qy(Hl.has),J1=Qy(Hl.get);Z1(Hl,{delete:function(e){if(Zv(e)&&!Jv(e)){var t=Qv(this);return t.frozen||(t.frozen=new Lf),Q1(this,e)||t.frozen.delete(e)}return Q1(this,e)},has:function(t){if(Zv(t)&&!Jv(t)){var r=Qv(this);return r.frozen||(r.frozen=new Lf),ey(this,t)||r.frozen.has(t)}return ey(this,t)},get:function(t){if(Zv(t)&&!Jv(t)){var r=Qv(this);return r.frozen||(r.frozen=new Lf),ey(this,t)?J1(this,t):r.frozen.get(t)}return J1(this,t)},set:function(t,r){if(Zv(t)&&!Jv(t)){var n=Qv(this);n.frozen||(n.frozen=new Lf),ey(this,t)?Jy(this,t,r):n.frozen.set(t,r)}else Jy(this,t,r);return this}})}else Cae()&&Z1(Hl,{set:function(t,r){var n;return mae(t)&&(TV(t)?n=PV:bae(t)&&(n=wae)),Jy(this,t,r),n&&n(t),this}});var be={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Yy()?182:174,AUDIO_MUTE:Yy()?181:173,AUDIO_UP:Yy()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},_ae=[be.ALT,be.ARROW_DOWN,be.ARROW_LEFT,be.ARROW_RIGHT,be.ARROW_UP,be.AUDIO_DOWN,be.AUDIO_MUTE,be.AUDIO_UP,be.BACKSPACE,be.CAPS_LOCK,be.DELETE,be.END,be.ENTER,be.ESCAPE,be.F1,be.F2,be.F3,be.F4,be.F5,be.F6,be.F7,be.F8,be.F9,be.F10,be.F11,be.F12,be.F13,be.F14,be.F15,be.F16,be.F17,be.F18,be.F19,be.HOME,be.INSERT,be.MEDIA_NEXT,be.MEDIA_PLAY_PAUSE,be.MEDIA_PREV,be.MEDIA_STOP,be.NULL,be.NUM_LOCK,be.PAGE_DOWN,be.PAGE_UP,be.PAUSE,be.SCROLL_LOCK,be.SHIFT,be.TAB];function AV(e){return e===32||e>=48&&e<=57||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222||e>=226||e>=65&&e<=90}function pE(e){return _ae.includes(e)}function Oae(e){var t=[];return Mg()?t.push(be.COMMAND_LEFT,be.COMMAND_RIGHT,be.COMMAND_FIREFOX):t.push(be.CONTROL),t.includes(e)}function IV(e){return[be.CONTROL,be.COMMAND_LEFT,be.COMMAND_RIGHT,be.COMMAND_FIREFOX].includes(e)}function hs(e,t){var r=t.split("|"),n=!1;return $(r,function(o){if(e===be[o])return n=!0,!1}),n}const Rae=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:be,isCtrlKey:Oae,isCtrlMetaKey:IV,isFunctionKey:pE,isKey:hs,isPrintableChar:AV},Symbol.toStringTag,{value:"Module"}));function gn(e){e.isImmediatePropagationEnabled=!1,e.cancelBubble=!0}function Qi(e){return e.isImmediatePropagationEnabled===!1}function Ei(e){return e.button===2}function Am(e){return e.button===0}const Eae=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:Qi,isLeftClick:Am,isRightClick:Ei,stopImmediatePropagation:gn},Symbol.toStringTag,{value:"Module"}));function Bc(e){"@babel/helpers - typeof";return Bc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bc(e)}var eA;function Tae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kae(n.key),n)}}function Pae(e,t,r){return t&&tA(e.prototype,t),r&&tA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kae(e){var t=$ae(e,"string");return Bc(t)==="symbol"?t:String(t)}function $ae(e,t){if(Bc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Aae(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var cl=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","beforeAutofillInsidePopulate","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],Iae=ft(eA||(eA=Aae([`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion]. 
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to 
  learn about the migration path.`],[`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\\x20
  learn about the migration path.`]))),vw=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),yw=new Map([["beforeAutofillInsidePopulate",'The plugin hook "beforeAutofillInsidePopulate" is deprecated and will be removed in the next major release.']]),MV=function(){function e(){Tae(this,e),this.globalBucket=this.createEmptyBucket()}return Pae(e,[{key:"createEmptyBucket",value:function(){var r=Object.create(null);return $(cl,function(n){return r[n]=[]}),r}},{key:"getBucket",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return r?(r.pluginHookBucket||(r.pluginHookBucket=this.createEmptyBucket()),r.pluginHookBucket):this.globalBucket}},{key:"add",value:function(r,n){var o=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(n))$(n,function(s){return o.add(r,s,i)});else{vw.has(r)&&ht(fE(Iae,{hookName:r,removedInVersion:vw.get(r)})),yw.has(r)&&ht(yw.get(r));var a=this.getBucket(i);if(typeof a[r]>"u"&&(this.register(r),a[r]=[]),n.skip=!1,a[r].indexOf(n)===-1){var l=!1;n.initialHook&&$(a[r],function(s,u){if(s.initialHook)return a[r][u]=n,l=!0,!1}),l||a[r].push(n)}}return this}},{key:"once",value:function(r,n){var o=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(n)?$(n,function(a){return o.once(r,a,i)}):(n.runOnce=!0,this.add(r,n,i))}},{key:"remove",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=this.getBucket(o);return typeof i[r]<"u"&&i[r].indexOf(n)>=0?(n.skip=!0,!0):!1}},{key:"has",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,o=this.getBucket(n);return!!(o[r]!==void 0&&o[r].length)}},{key:"run",value:function(r,n,o,i,a,l,s,u){{var f=this.globalBucket[n],c=f?f.length:0,h=0;if(c)for(;h<c;){if(!f[h]||f[h].skip){h+=1;continue}var d=Wg(f[h],r,o,i,a,l,s,u);d!==void 0&&(o=d),f[h]&&f[h].runOnce&&this.remove(n,f[h]),h+=1}}{var v=this.getBucket(r)[n],g=v?v.length:0,m=0;if(g)for(;m<g;){if(!v[m]||v[m].skip){m+=1;continue}var w=Wg(v[m],r,o,i,a,l,s,u);w!==void 0&&(o=w),v[m]&&v[m].runOnce&&this.remove(n,v[m],r),m+=1}}return o}},{key:"destroy",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;We(this.getBucket(r),function(n,o,i){return i[o].length=0})}},{key:"register",value:function(r){this.isRegistered(r)||cl.push(r)}},{key:"deregister",value:function(r){this.isRegistered(r)&&cl.splice(cl.indexOf(r),1)}},{key:"isDeprecated",value:function(r){return yw.has(r)||vw.has(r)}},{key:"isRegistered",value:function(r){return cl.indexOf(r)>=0}},{key:"getRegistered",value:function(){return cl}}],[{key:"getSingleton",value:function(){return xae()}}]),e}(),Mae=new MV;function xae(){return Mae}const pe=MV;function rA(e){return Lae(e)||Hae(e)||Nae(e)||Dae()}function Dae(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Nae(e,t){if(e){if(typeof e=="string")return jC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return jC(e,t)}}function Hae(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Lae(e){if(Array.isArray(e))return jC(e)}function jC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var gw=new Map;function Jr(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";gw.has(e)||gw.set(e,new Map);var t=gw.get(e);function r(l,s){t.set(l,s)}function n(l){return t.get(l)}function o(l){return t.has(l)}function i(){return rA(t.keys())}function a(){return rA(t.values())}return{register:r,getItem:n,hasItem:o,getNames:i,getValues:a}}var FC=new WeakMap,vv=Jr("editors"),jae=vv.register,xV=vv.getItem,DV=vv.hasItem,Fae=vv.getNames;vv.getValues;function Bae(e){var t={},r=e;this.getConstructor=function(){return e},this.getInstance=function(n){return n.guid in t||(t[n.guid]=new r(n)),t[n.guid]},pe.getSingleton().add("afterDestroy",function(){t[this.guid]=null})}function NV(e,t){var r;if(typeof e=="function")FC.get(e)||Or(null,e),r=FC.get(e);else if(typeof e=="string")r=xV(e);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error('No editor registered under name "'.concat(e,'"'));return r.getInstance(t)}function Ug(e){if(typeof e=="function")return e;if(!DV(e))throw Error('No registered editor found under "'.concat(e,'" name'));return xV(e).getConstructor()}function Or(e,t){e&&typeof e!="string"&&(t=e,e=t.EDITOR_TYPE);var r=new Bae(t);typeof e=="string"&&jae(e,r),FC.set(t,r)}function Vc(e){"@babel/helpers - typeof";return Vc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vc(e)}function Vae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Uae(n.key),n)}}function Wae(e,t,r){return t&&nA(e.prototype,t),r&&nA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Uae(e){var t=zae(e,"string");return Vc(t)==="symbol"?t:String(t)}function zae(e,t){if(Vc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var eg=0,Yae=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Vae(this,e),this.context=t||this,this.context.eventListeners||(this.context.eventListeners=[])}return Wae(e,[{key:"addEventListener",value:function(r,n,o){var i=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function l(s){o.call(this,Gae(s))}return typeof a!="boolean"&&!JF()&&(a=!1),this.context.eventListeners.push({element:r,event:n,callback:o,callbackProxy:l,options:a,eventManager:this}),r.addEventListener(n,l,a),eg+=1,function(){i.removeEventListener(r,n,o)}}},{key:"removeEventListener",value:function(r,n,o){for(var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a=this.context.eventListeners.length,l;a;)if(a-=1,l=this.context.eventListeners[a],l.event===n&&l.element===r){if(o&&o!==l.callback||i&&l.eventManager!==this)continue;this.context.eventListeners.splice(a,1),l.element.removeEventListener(l.event,l.callbackProxy,l.options),eg-=1}}},{key:"clearEvents",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.context)for(var n=this.context.eventListeners.length;n;){n-=1;var o=this.context.eventListeners[n];r&&o.eventManager!==this||(this.context.eventListeners.splice(n,1),o.element.removeEventListener(o.event,o.callbackProxy,o.options),eg-=1)}}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents(),this.context=null}},{key:"destroyWithOwnEventsOnly",value:function(){this.clearEvents(!0),this.context=null}},{key:"fireEvent",value:function(r,n){var o=r.document,i=r;o||(o=r.ownerDocument?r.ownerDocument:r,i=o.defaultView);var a={bubbles:!0,cancelable:n!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0},l;o.createEvent?(l=o.createEvent("MouseEvents"),l.initMouseEvent(n,a.bubbles,a.cancelable,a.view,a.detail,a.screenX,a.screenY,a.clientX,a.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,a.button,o.body.parentNode)):l=o.createEventObject(),r.dispatchEvent?r.dispatchEvent(l):r.fireEvent("on".concat(n),l)}}]),e}();function Gae(e){var t=e.stopImmediatePropagation;return e.stopImmediatePropagation=function(){t.apply(this),gn(this)},e}const Tt=Yae;function Kae(){return eg}function Wc(e){"@babel/helpers - typeof";return Wc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wc(e)}function qae(e,t){return Jae(e)||Qae(e,t)||Zae(e,t)||Xae()}function Xae(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Zae(e,t){if(e){if(typeof e=="string")return oA(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return oA(e,t)}}function oA(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Qae(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Jae(e){if(Array.isArray(e))return e}function ele(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rle(n.key),n)}}function tle(e,t,r){return t&&iA(e.prototype,t),r&&iA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rle(e){var t=nle(e,"string");return Wc(t)==="symbol"?t:String(t)}function nle(e,t){if(Wc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Im="editorManager.navigation",wc="editorManager.handlingEditor",BC=function(){function e(t,r,n){var o=this;ele(this,e),this.instance=t,this.tableMeta=r,this.selection=n,this.eventManager=new Tt(t),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0;var i=this.instance.getShortcutManager();i.addContext("editor"),this.registerShortcuts(),this.instance.addHook("afterDocumentKeyDown",function(a){return o.onAfterDocumentKeyDown(a)}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",function(a){!o.destroyed&&o.instance.isListening()&&o.openEditor("",a)}),this.instance.view._wt.update("onCellDblClick",function(a,l,s){return o.onCellDblClick(a,l,s)})}return tle(e,[{key:"registerShortcuts",value:function(){var r=this,n=this.instance.getShortcutManager(),o=n.getContext("grid"),i=n.getContext("editor"),a={group:wc};i.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:function(s,u){r.closeEditorAndSaveChanges(n.isCtrlPressed()),r.moveSelectionAfterEnter(u.includes("shift"))}},{keys:[["Escape"],["Escape","Control/Meta"]],callback:function(){r.closeEditorAndRestoreOriginalValue(n.isCtrlPressed()),r.activeEditor.focus()}}],a),o.addShortcuts([{keys:[["F2"]],callback:function(s){r.openEditor(null,s,!0)}},{keys:[["Backspace"],["Delete"]],callback:function(){r.instance.emptySelectedCells(),r.prepareEditor()}},{keys:[["Enter"],["Enter","Shift"]],callback:function(s,u){r.instance.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter():r.openEditor(null,s,!0):r.moveSelectionAfterEnter(u.includes("shift")),gn(s)}}],a)}},{key:"lockEditor",value:function(){this.lock=!0}},{key:"unlockEditor",value:function(){this.lock=!1}},{key:"destroyEditor",value:function(r){this.lock||this.closeEditor(r)}},{key:"getActiveEditor",value:function(){return this.activeEditor}},{key:"prepareEditor",value:function(){var r=this;if(!this.lock){if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,function(g){g&&r.prepareEditor()});return}var n=this.instance.getSelectedRangeLast().highlight,o=n.row,i=n.col,a=this.instance.runHooks("modifyGetCellCoords",o,i),l=o,s=i;if(Array.isArray(a)){var u=qae(a,2);l=u[0],s=u[1]}this.cellProperties=this.instance.getCellMeta(l,s);var f=this.instance.rootDocument.activeElement;if(f&&$m(f)&&f.blur(),!this.isCellEditable()){this.clearActiveEditor();return}var c=this.instance.getCell(o,i,!0);if(c){var h=this.instance.getCellEditor(this.cellProperties),d=this.instance.colToProp(s),v=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(l),s);this.activeEditor=NV(h,this.instance),this.activeEditor.prepare(o,i,d,c,v,this.cellProperties)}}}},{key:"isEditorOpened",value:function(){return this.activeEditor&&this.activeEditor.isOpened()}},{key:"openEditor",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}if(!this.activeEditor){var i=this.instance.getSelectedRangeLast().highlight,a=i.row,l=i.col,s=this.instance.rowIndexMapper.getRenderableFromVisualIndex(a),u=this.instance.columnIndexMapper.getRenderableFromVisualIndex(l);this.instance.view.scrollViewport(this.instance._createCellCoords(s,u)),this.instance.view.render(),this.prepareEditor()}this.activeEditor&&(o&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(r,n))}},{key:"closeEditor",value:function(r,n,o){this.activeEditor?this.activeEditor.finishEditing(r,n,o):o&&o(!1)}},{key:"closeEditorAndSaveChanges",value:function(r){this.closeEditor(!1,r)}},{key:"closeEditorAndRestoreOriginalValue",value:function(r){this.closeEditor(!0,r)}},{key:"clearActiveEditor",value:function(){this.activeEditor=void 0}},{key:"isCellEditable",value:function(){var r=this.instance.getCellEditor(this.cellProperties),n=this.instance.getSelectedRangeLast().highlight,o=n.row,i=n.col,a=this.instance,l=a.rowIndexMapper,s=a.columnIndexMapper,u=l.isHidden(this.instance.toPhysicalRow(o))||s.isHidden(this.instance.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!r||u)}},{key:"moveSelectionAfterEnter",value:function(r){var n=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;r?this.selection.transformStart(-n.row,-n.col):this.selection.transformStart(n.row,n.col,!0)}},{key:"onAfterDocumentKeyDown",value:function(r){var n=this;if(this.instance.isListening()){var o=r.keyCode;if(this.selection.isSelected()){var i=(r.ctrlKey||r.metaKey)&&!r.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!pE(o)&&!IV(o)&&!i&&!this.isEditorOpened()){var a=this.instance.getShortcutManager(),l=a.getContext("editor"),s={runOnlyIf:function(){return ve(n.instance.getSelected())},group:Im};l.addShortcuts([{keys:[["ArrowUp"]],callback:function(){n.instance.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){n.instance.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){n.instance.selection.transformStart(0,-1*n.instance.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){n.instance.selection.transformStart(0,n.instance.getDirectionFactor())}}],s),this.openEditor("",r)}}}}},{key:"onCellDblClick",value:function(r,n,o){o.nodeName==="TD"&&this.openEditor(null,r,!0)}},{key:"destroy",value:function(){this.destroyed=!0,this.eventManager.destroy()}}]),e}(),aA=new WeakMap;BC.getInstance=function(e,t,r){var n=aA.get(e);return n||(n=new BC(e,t,r),aA.set(e,n)),n};const ole=BC;var ile=$e,ale=Pr,HV=Yd,lle=je,sle=lle(function(){HV(1)});ile({target:"Object",stat:!0,forced:sle},{keys:function(t){return HV(ale(t))}});var ule=$e,fle=B0;ule({target:"String",proto:!0},{repeat:fle});var cle=zt,hle=fm,dle=Ht,vle=pn,yle=Xa,pw=Yt,gle=Tr,ple=Ga,mle=T0,lA=cm;hle("match",function(e,t,r){return[function(o){var i=gle(this),a=vle(o)?void 0:ple(o,e);return a?cle(a,o,i):new RegExp(o)[e](pw(i))},function(n){var o=dle(this),i=pw(n),a=r(t,o,i);if(a.done)return a.value;if(!o.global)return lA(o,i);var l=o.unicode;o.lastIndex=0;for(var s=[],u=0,f;(f=lA(o,i))!==null;){var c=pw(f[0]);s[u]=c,c===""&&(o.lastIndex=mle(i,yle(o.lastIndex),l)),u++}return u===0?null:s}]});var ble=mf,wle=Br,Sle=$i,Cle=mn,_le=bf,Ole=Math.min,VC=[].lastIndexOf,LV=!!VC&&1/[1].lastIndexOf(1,-0)<0,Rle=_le("lastIndexOf"),Ele=LV||!Rle,Tle=Ele?function(t){if(LV)return ble(VC,this,arguments)||0;var r=wle(this),n=Cle(r),o=n-1;for(arguments.length>1&&(o=Ole(o,Sle(arguments[1]))),o<0&&(o=n+o);o>=0;o--)if(o in r&&r[o]===t)return o||0;return-1}:VC,Ple=$e,sA=Tle;Ple({target:"Array",proto:!0,forced:sA!==[].lastIndexOf},{lastIndexOf:sA});var kle=Ya,$le=Pr,Ale=jd,Ile=mn,Mle=TypeError,uA=function(e){return function(t,r,n,o){var i=$le(t),a=Ale(i),l=Ile(i);kle(r);var s=e?l-1:0,u=e?-1:1;if(n<2)for(;;){if(s in a){o=a[s],s+=u;break}if(s+=u,e?s<0:l<=s)throw new Mle("Reduce of empty array with no initial value")}for(;e?s>=0:l>s;s+=u)s in a&&(o=r(o,a[s],s,i));return o}},xle={left:uA(!1),right:uA(!0)},Dle=$e,Nle=xle.left,Hle=bf,fA=Fd,Lle=NF,jle=!Lle&&fA>79&&fA<83,Fle=jle||!Hle("reduce");Dle({target:"Array",proto:!0,forced:Fle},{reduce:function(t){var r=arguments.length;return Nle(this,t,r,r>1?arguments[1]:void 0)}});var Ble=$e,Vle=Ja.findIndex,Wle=ev,WC="findIndex",jV=!0;WC in[]&&Array(1)[WC](function(){jV=!1});Ble({target:"Array",proto:!0,forced:jV},{findIndex:function(t){return Vle(this,t,arguments.length>1?arguments[1]:void 0)}});Wle(WC);function mw(e){return Gle(e)||Yle(e)||zle(e)||Ule()}function Ule(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zle(e,t){if(e){if(typeof e=="string")return UC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return UC(e,t)}}function Yle(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Gle(e){if(Array.isArray(e))return UC(e)}function UC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var FV={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},Kle=new RegExp(Object.keys(FV).map(function(e){return"(".concat(e,")")}).join("|"),"gi");function qle(e){return(e&&e.nodeName||"")==="TABLE"}function zC(e){for(var t=e.hasColHeaders(),r=e.hasRowHeaders(),n=[t?-1:0,r?-1:0,e.countRows()-1,e.countCols()-1],o=e.getData.apply(e,n),i=o.length,a=i>0?o[0].length:0,l=["<table>","</table>"],s=t?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],f=r?1:0,c=t?1:0,h=0;h<i;h+=1){for(var d=t&&h===0,v=[],g=0;g<a;g+=1){var m=!d&&r&&g===0,w="";if(d)w="<th>".concat(e.getColHeader(g-f),"</th>");else if(m)w="<th>".concat(e.getRowHeader(h-c),"</th>");else{var S=o[h][g],C=e.getCellMeta(h-c,g-f),P=C.hidden,R=C.rowspan,V=C.colspan;if(!P){var U=[];if(R&&U.push('rowspan="'.concat(R,'"')),V&&U.push('colspan="'.concat(V,'"')),Kt(S))w="<td ".concat(U.join(" "),"></td>");else{var X=S.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");w="<td ".concat(U.join(" "),">").concat(X,"</td>")}}}v.push(w)}var Y=["<tr>"].concat(v,["</tr>"]).join("");d?s.splice(1,0,Y):u.splice(-1,0,Y)}return l.splice(1,0,s.join(""),u.join("")),l.join("")}function YC(e){for(var t=e.length,r=["<table>"],n=0;n<t;n+=1){var o=e[n],i=o.length,a=[];n===0&&r.push("<tbody>");for(var l=0;l<i;l+=1){var s=o[l],u=Kt(s)?"":s.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,function(f){return'<span style="mso-spacerun: yes">'.concat("&nbsp;".repeat(f.length-1)," </span>")}).replace(/\t/gi,"&#9;");a.push("<td>".concat(u,"</td>"))}r.push.apply(r,["<tr>"].concat(a,["</tr>"])),n+1===t&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function BV(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document,r={},n=t.createDocumentFragment(),o=t.createElement("div");n.appendChild(o);var i=e;if(typeof i=="string"){var a=i.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,function(_){var T=_.match(/<td\b[^>]*?>/g)[0],I=_.substring(T.length,_.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,""),F="</td>";return"".concat(T).concat(I).concat(F)});o.insertAdjacentHTML("afterbegin","".concat(a)),i=o.querySelector("table")}if(!(!i||!qle(i))){var l=o.querySelector('meta[name$="enerator"]'),s=i.querySelector("tbody th")!==null,u=i.querySelector("tr"),f=u?Array.from(u.cells).reduce(function(_,T){return _+T.colSpan},0)-(s?1:0):0,c=i.tFoot&&Array.from(i.tFoot.rows)||[],h=[],d=!1,v=0,g=0;if(i.tHead){var m=Array.from(i.tHead.rows).filter(function(_){var T=_.querySelector("td")!==null;return T&&h.push(_),!T});v=m.length,d=v>0,v>1?r.nestedHeaders=Array.from(m).reduce(function(_,T){var I=Array.from(T.cells).reduce(function(F,W,G){if(s&&G===0)return F;var J=W.colSpan,ee=W.innerHTML,se=J>1?{label:ee,colspan:J}:ee;return F.push(se),F},[]);return _.push(I),_},[]):d&&(r.colHeaders=Array.from(m[0].children).reduce(function(_,T,I){return s&&I===0||_.push(T.innerHTML),_},[]))}h.length&&(r.fixedRowsTop=h.length),c.length&&(r.fixedRowsBottom=c.length);var w=[].concat(h,mw(Array.from(i.tBodies).reduce(function(_,T){return _.push.apply(_,mw(Array.from(T.rows))),_},[])),mw(c));g=w.length;for(var S=new Array(g),C=0;C<g;C++)S[C]=new Array(f);for(var P=[],R=[],V=0;V<g;V++)for(var U=w[V],X=Array.from(U.cells),Y=X.length,q=0;q<Y;q++){var Z=X[q],ie=Z.nodeName,Q=Z.innerHTML,le=Z.rowSpan,Se=Z.colSpan,me=S[V].findIndex(function(_){return _===void 0});if(ie==="TD"){if(le>1||Se>1){for(var Ce=V;Ce<V+le;Ce++)if(Ce<g)for(var k=me;k<me+Se;k++)S[Ce][k]=null;var y=Z.getAttribute("style"),p=y&&y.includes("mso-ignore:colspan");p||P.push({col:me,row:V,rowspan:le,colspan:Se})}var b="";l&&/excel/gi.test(l.content)?b=Q.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):b=Q.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),S[V][me]=b.replace(Kle,function(_){return FV[_]})}else R.push(Q)}return P.length&&(r.mergeCells=P),R.length&&(r.rowHeaders=R),S.length&&(r.data=S),r}}const Xle=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:YC,htmlToGridSettings:BV,instanceToHTML:zC},Symbol.toStringTag,{value:"Module"}));function Zle(e){return tse(e)||ese(e)||Jle(e)||Qle()}function Qle(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Jle(e,t){if(e){if(typeof e=="string")return GC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return GC(e,t)}}function ese(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function tse(e){if(Array.isArray(e))return GC(e)}function GC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function KC(e){"@babel/helpers - typeof";return KC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},KC(e)}function gr(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=KC(e);if(r==="number")return!isNaN(e)&&isFinite(e);if(r==="string"){if(e.length===0)return!1;if(e.length===1)return/\d/.test(e);var n=Array.from(new Set(["."].concat(Zle(t)))).map(function(o){return"\\".concat(o)}).join("|");return new RegExp("^[+-]?\\s*(((".concat(n,")?\\d+((").concat(n,")\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$"),"i").test(e.trim())}else if(r==="object")return!!e&&typeof e.valueOf()=="number"&&!(e instanceof Date);return!1}function VV(e){return gr(e,[","])}function _e(e,t,r){var n=-1;for(typeof t=="function"?(r=t,t=e):n=e-1;++n<=t&&r(n)!==!1;);}function zg(e,t,r){var n=e+1;for(typeof t=="function"&&(r=t,t=0);--n>=t&&r(n)!==!1;);}function mE(e,t){return t=parseInt(t.toString().replace("%",""),10),t=isNaN(t)?0:t,parseInt(e*t/100,10)}const rse=Object.freeze(Object.defineProperty({__proto__:null,isNumeric:gr,isNumericLike:VV,rangeEach:_e,rangeEachReverse:zg,valueAccordingPercent:mE},Symbol.toStringTag,{value:"Module"}));function nse(e){return ase(e)||ise(e)||WV(e)||ose()}function ose(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ise(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ase(e){if(Array.isArray(e))return qC(e)}function lse(e,t){return fse(e)||use(e,t)||WV(e,t)||sse()}function sse(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function WV(e,t){if(e){if(typeof e=="string")return qC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qC(e,t)}}function qC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function use(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function fse(e){if(Array.isArray(e))return e}var XC="asc",cse="desc",cA=new Map([[XC,[-1,1]],[cse,[1,-1]]]),hse=function(t){return"The priority '".concat(t,"' is already declared in a map.")},dse=function(t){return"The priority '".concat(t,"' is not a number.")};function vse(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorPriorityExists,r=e.errorPriorityNaN,n=new Map;t=bt(t)?t:hse,r=bt(r)?r:dse;function o(a,l){if(!gr(a))throw new Error(r(a));if(n.has(a))throw new Error(t(a));n.set(a,l)}function i(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:XC,l=cA.get(a)||cA.get(XC),s=lse(l,2),u=s[0],f=s[1];return nse(n).sort(function(c,h){return c[0]<h[0]?u:f}).map(function(c){return c[1]})}return{addItem:o,getItems:i}}var yse=$e,gse=Ja.find,pse=ev,ZC="find",UV=!0;ZC in[]&&Array(1)[ZC](function(){UV=!1});yse({target:"Array",proto:!0,forced:UV},{find:function(t){return gse(this,t,arguments.length>1?arguments[1]:void 0)}});pse(ZC);function mse(e){return Sse(e)||wse(e)||zV(e)||bse()}function bse(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wse(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Sse(e){if(Array.isArray(e))return QC(e)}function hA(e,t){return Ose(e)||_se(e,t)||zV(e,t)||Cse()}function Cse(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zV(e,t){if(e){if(typeof e=="string")return QC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return QC(e,t)}}function QC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _se(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Ose(e){if(Array.isArray(e))return e}var Rse=function(t){return"The id '".concat(t,"' is already declared in a map.")};function Mm(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorIdExists,r=new Map;t=bt(t)?t:Rse;function n(f,c){if(u(f))throw new Error(t(f));r.set(f,c)}function o(f){return r.delete(f)}function i(){r.clear()}function a(f){var c=s().find(function(v){var g=hA(v,2),m=g[0],w=g[1];return f===w?m:!1})||[null],h=hA(c,1),d=h[0];return d}function l(f){return r.get(f)}function s(){return mse(r)}function u(f){return r.has(f)}return{addItem:n,clear:i,getId:a,getItem:l,getItems:s,hasItem:u,removeItem:o}}function Ese(e){return $se(e)||kse(e)||Pse(e)||Tse()}function Tse(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Pse(e,t){if(e){if(typeof e=="string")return JC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return JC(e,t)}}function kse(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function $se(e){if(Array.isArray(e))return JC(e)}function JC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Ase=function(t){return"'".concat(t,"' value is already declared in a unique set.")};function Ise(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorItemExists,r=new Set;t=bt(t)?t:Ase;function n(a){if(r.has(a))throw new Error(t(a));r.add(a)}function o(){return Ese(r)}function i(){r.clear()}return{addItem:n,clear:i,getItems:o}}function Mse(e,t){return Nse(e)||Dse(e,t)||YV(e,t)||xse()}function xse(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Dse(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Nse(e){if(Array.isArray(e))return e}function dA(e){return jse(e)||Lse(e)||YV(e)||Hse()}function Hse(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function YV(e,t){if(e){if(typeof e=="string")return e_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return e_(e,t)}}function Lse(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function jse(e){if(Array.isArray(e))return e_(e)}function e_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var bE=function(t){return'There is already registered "'.concat(t,'" plugin.')},Fse=function(t){return'There is already registered plugin on priority "'.concat(t,'".')},Bse=function(t){return'The priority "'.concat(t,'" is not a number.')},GV=vse({errorPriorityExists:Fse,errorPriorityNaN:Bse}),KV=Ise({errorItemExists:bE}),t_=Mm({errorIdExists:bE});function wE(){return[].concat(dA(GV.getItems()),dA(KV.getItems()))}function yv(e){var t=ar(e);return t_.getItem(t)}function Vse(e){return!!yv(e)}function et(e,t,r){var n=Use(e,t,r),o=Mse(n,3);e=o[0],t=o[1],r=o[2],yv(e)===void 0&&Wse(e,t,r)}function Wse(e,t,r){var n=ar(e);if(t_.hasItem(n))throw new Error(bE(n));r===void 0?KV.addItem(n):GV.addItem(r,n),t_.addItem(n,t)}function Use(e,t,r){return typeof e=="function"&&(t=e,e=t.PLUGIN_KEY,r=t.PLUGIN_PRIORITY),[e,t,r]}var gv=Jr("renderers"),zse=gv.register,Yse=gv.getItem,qV=gv.hasItem,Gse=gv.getNames;gv.getValues;function Yg(e){if(typeof e=="function")return e;if(!qV(e))throw Error('No registered renderer found under "'.concat(e,'" name'));return Yse(e)}function An(e,t){typeof e!="string"&&(t=e,e=t.RENDERER_TYPE),zse(e,t)}var pv=Jr("validators"),Kse=pv.register,qse=pv.getItem,XV=pv.hasItem,Xse=pv.getNames;pv.getValues;function SE(e){if(typeof e=="function")return e;if(!XV(e))throw Error('No registered validator found under "'.concat(e,'" name'));return qse(e)}function Vl(e,t){typeof e!="string"&&(t=e,e=t.VALIDATOR_TYPE),Kse(e,t)}var Ji=1,or=2;function Uc(e){"@babel/helpers - typeof";return Uc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uc(e)}function Zse(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Jse(n.key),n)}}function Qse(e,t,r){return t&&vA(e.prototype,t),r&&vA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jse(e){var t=eue(e,"string");return Uc(t)==="symbol"?t:String(t)}function eue(e,t){if(Uc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Uc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hl=new WeakMap,tue=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.viewportSize,n=t.scrollOffset,o=t.totalItems,i=t.itemSizeFn,a=t.overrideFn,l=t.calculationType,s=t.stretchMode,u=t.stretchingItemWidthFn,f=u===void 0?function(h){return h}:u,c=t.inlineStartOffset;Zse(this,e),hl.set(this,{viewportWidth:r,scrollOffset:n,totalColumns:o,columnWidthFn:i,overrideFn:a,calculationType:l,stretchingColumnWidthFn:f,inlineStartOffset:c}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=s,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}return Qse(e,[{key:"calculate",value:function(){for(var r=0,n=!0,o=[],i,a=0,l=0,s=hl.get(this),u=s.calculationType,f=s.overrideFn,c=s.scrollOffset,h=Math.max(s.scrollOffset,0),d=s.totalColumns,v=s.viewportWidth,g=h>0?v+1:v,m=0;m<d;m++)if(i=this._getColumnWidth(m),r<=h&&u!==or&&(this.startColumn=m,a=i),r>=h&&r+(u===or?i:0)<=h+g&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=m,a=i),this.endColumn=m),o.push(r),r+=i,l=i,u!==or&&(this.endColumn=m),r>=h+v){n=!1;break}var w=c+v-g,S=u===or?0:l,C=u===or?a:0;if(w<-1*s.inlineStartOffset||c>o.at(-1)+S||-1*s.scrollOffset-s.viewportWidth>-1*C?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===d-1&&n)for(this.startColumn=this.endColumn;this.startColumn>0;){var P=o[this.endColumn]+i-o[this.startColumn-1];if((P<=v||u!==or)&&(this.startColumn-=1),P>v)break}u===Ji&&this.startColumn!==null&&f&&f(this),this.startPosition=o[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),d<this.endColumn&&(this.endColumn=d-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(r){if(this.stretch!=="none"){var n=r;this.totalTargetWidth=n;for(var o=hl.get(this),i=o.totalColumns,a=0,l=0;l<i;l++){var s=this._getColumnWidth(l),u=o.stretchingColumnWidthFn(void 0,l);typeof u=="number"?n-=u:a+=s}var f=n-a;if(this.stretch==="all"&&f>0)this.stretchAllRatio=n/a,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(this.stretch==="last"&&n!==1/0){var c=this._getColumnWidth(i-1),h=f+c;this.stretchLastWidth=h>=0?h:c}}}},{key:"getStretchedColumnWidth",value:function(r,n){var o=null;return this.stretch==="all"&&this.stretchAllRatio!==0?o=this._getStretchedAllColumnWidth(r,n):this.stretch==="last"&&this.stretchLastWidth!==0&&(o=this._getStretchedLastColumnWidth(r)),o}},{key:"_getStretchedAllColumnWidth",value:function(r,n){var o=0,i=hl.get(this),a=i.totalColumns;if(!this.stretchAllColumnsWidth[r]){var l=Math.round(n*this.stretchAllRatio),s=i.stretchingColumnWidthFn(l,r);s===void 0?this.stretchAllColumnsWidth[r]=l:this.stretchAllColumnsWidth[r]=isNaN(s)?this._getColumnWidth(r):s}if(this.stretchAllColumnsWidth.length===a&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var u=0;u<this.stretchAllColumnsWidth.length;u++)o+=this.stretchAllColumnsWidth[u];o!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-o)}return this.stretchAllColumnsWidth[r]}},{key:"_getStretchedLastColumnWidth",value:function(r){var n=hl.get(this),o=n.totalColumns;return r===o-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(r){var n=hl.get(this).columnWidthFn(r);return isNaN(n)&&(n=e.DEFAULT_WIDTH),n}}],[{key:"DEFAULT_WIDTH",get:function(){return 50}}]),e}();const CE=tue;function zc(e){"@babel/helpers - typeof";return zc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zc(e)}function rue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oue(n.key),n)}}function nue(e,t,r){return t&&yA(e.prototype,t),r&&yA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function oue(e){var t=iue(e,"string");return zc(t)==="symbol"?t:String(t)}function iue(e,t){if(zc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var gA=new WeakMap,aue=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.viewportSize,n=t.scrollOffset,o=t.totalItems,i=t.itemSizeFn,a=t.overrideFn,l=t.calculationType,s=t.scrollbarHeight;rue(this,e),gA.set(this,{viewportHeight:r,scrollOffset:n,totalRows:o,rowHeightFn:i,overrideFn:a,calculationType:l,horizontalScrollbarHeight:s}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.calculate()}return nue(e,[{key:"calculate",value:function(){for(var r=gA.get(this),n=r.calculationType,o=r.overrideFn,i=r.rowHeightFn,a=r.scrollOffset,l=Math.max(r.scrollOffset,0),s=r.totalRows,u=r.viewportHeight,f=r.horizontalScrollbarHeight||0,c=0,h=!0,d=[],v,g=0,m=0,w=0;w<s;w++)if(v=i(w),isNaN(v)&&(v=e.DEFAULT_HEIGHT),c<=l&&n!==or&&(this.startRow=w,g=v),c>=l&&c+(n===or?v:0)<=l+u-f&&(this.startRow===null&&(this.startRow=w,g=v),this.endRow=w),d.push(c),c+=v,m=v,n!==or&&(this.endRow=w),c>=l+u-f){h=!1;break}var S=a+u-f,C=n===or?g:0,P=n===or?0:m;if(S<C||a>d.at(-1)+P?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===s-1&&h)for(this.startRow=this.endRow;this.startRow>0;){var R=d[this.endRow]+v-d[this.startRow-1];if((R<=u-f||n!==or)&&(this.startRow-=1),R>=u-f)break}n===Ji&&this.startRow!==null&&o&&o(this),this.startPosition=d[this.startRow],this.startPosition===void 0&&(this.startPosition=null),s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}],[{key:"DEFAULT_HEIGHT",get:function(){return 23}}]),e}();const ZV=aue;function Yc(e){"@babel/helpers - typeof";return Yc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yc(e)}function lue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,QV(n.key),n)}}function sue(e,t,r){return t&&pA(e.prototype,t),r&&pA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uue(e,t,r){fue(e,t),t.set(e,r)}function fue(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mA(e,t,r){return t=QV(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function QV(e){var t=cue(e,"string");return Yc(t)==="symbol"?t:String(t)}function cue(e,t){if(Yc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Yc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jf(e,t){var r=JV(e,t,"get");return hue(e,r)}function hue(e,t){return t.get?t.get.call(e):t.value}function due(e,t,r){var n=JV(e,t,"set");return vue(e,n,r),r}function JV(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function vue(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var ji=new WeakMap,yue=function(){function e(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;lue(this,e),mA(this,"row",null),mA(this,"col",null),uue(this,ji,{writable:!0,value:!1}),due(this,ji,n),typeof t<"u"&&typeof r<"u"&&(this.row=t,this.col=r)}return sue(e,[{key:"isValid",value:function(r){return!(this.row<0||this.col<0||this.row>=r.getSetting("totalRows")||this.col>=r.getSetting("totalColumns"))}},{key:"isEqual",value:function(r){return r===this?!0:this.row===r.row&&this.col===r.col}},{key:"isSouthEastOf",value:function(r){return this.row>=r.row&&(jf(this,ji)?this.col<=r.col:this.col>=r.col)}},{key:"isNorthWestOf",value:function(r){return this.row<=r.row&&(jf(this,ji)?this.col>=r.col:this.col<=r.col)}},{key:"isSouthWestOf",value:function(r){return this.row>=r.row&&(jf(this,ji)?this.col>=r.col:this.col<=r.col)}},{key:"isNorthEastOf",value:function(r){return this.row<=r.row&&(jf(this,ji)?this.col<=r.col:this.col>=r.col)}},{key:"normalize",value:function(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}},{key:"clone",value:function(){return new e(this.row,this.col,jf(this,ji))}},{key:"toObject",value:function(){return{row:this.row,col:this.col}}}]),e}();const Gg=yue;function Gc(e){"@babel/helpers - typeof";return Gc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gc(e)}function gue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eW(n.key),n)}}function pue(e,t,r){return t&&bA(e.prototype,t),r&&bA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mue(e,t,r){bue(e,t),t.set(e,r)}function bue(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bw(e,t,r){return t=eW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eW(e){var t=wue(e,"string");return Gc(t)==="symbol"?t:String(t)}function wue(e,t){if(Gc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Sn(e,t){var r=tW(e,t,"get");return Sue(e,r)}function Sue(e,t){return t.get?t.get.call(e):t.value}function Cue(e,t,r){var n=tW(e,t,"set");return _ue(e,n,r),r}function tW(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function _ue(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Wr=new WeakMap,Oue=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;gue(this,e),bw(this,"highlight",null),bw(this,"from",null),bw(this,"to",null),mue(this,Wr,{writable:!0,value:!1}),this.highlight=t.clone().normalize(),this.from=r.clone(),this.to=n.clone(),Cue(this,Wr,o)}return pue(e,[{key:"setHighlight",value:function(r){return this.highlight=r.clone().normalize(),this}},{key:"setFrom",value:function(r){return this.from=r.clone(),this}},{key:"setTo",value:function(r){return this.to=r.clone(),this}},{key:"isValid",value:function(r){return this.from.isValid(r)&&this.to.isValid(r)}},{key:"isSingle",value:function(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}},{key:"getOuterHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getOuterWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"getHeight",value:function(){if(this.from.row<0&&this.to.row<0)return 0;var r=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(r,n)-Math.min(r,n)+1}},{key:"getWidth",value:function(){if(this.from.col<0&&this.to.col<0)return 0;var r=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(r,n)-Math.min(r,n)+1}},{key:"getCellsCount",value:function(){return this.getWidth()*this.getHeight()}},{key:"includes",value:function(r){var n=r.row,o=r.col,i=this.getOuterTopStartCorner(),a=this.getOuterBottomEndCorner();return i.row<=n&&a.row>=n&&i.col<=o&&a.col>=o}},{key:"includesRange",value:function(r){return this.includes(r.getOuterTopStartCorner())&&this.includes(r.getOuterBottomEndCorner())}},{key:"isEqual",value:function(r){return Math.min(this.from.row,this.to.row)===Math.min(r.from.row,r.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(r.from.row,r.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(r.from.col,r.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(r.from.col,r.to.col)}},{key:"overlaps",value:function(r){return r.isSouthEastOf(this.getOuterTopLeftCorner())&&r.isNorthWestOf(this.getOuterBottomRightCorner())}},{key:"isSouthEastOf",value:function(r){return this.getOuterTopLeftCorner().isSouthEastOf(r)||this.getOuterBottomRightCorner().isSouthEastOf(r)}},{key:"isNorthWestOf",value:function(r){return this.getOuterTopLeftCorner().isNorthWestOf(r)||this.getOuterBottomRightCorner().isNorthWestOf(r)}},{key:"isOverlappingHorizontally",value:function(r){return this.getOuterTopRightCorner().col>=r.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=r.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=r.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=r.getOuterTopLeftCorner().col}},{key:"isOverlappingVertically",value:function(r){return this.getOuterBottomRightCorner().row>=r.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=r.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=r.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=r.getOuterTopRightCorner().row}},{key:"expand",value:function(r){var n=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return r.row<n.row||r.col<n.col||r.row>o.row||r.col>o.col?(this.from=this._createCellCoords(Math.min(n.row,r.row),Math.min(n.col,r.col)),this.to=this._createCellCoords(Math.max(o.row,r.row),Math.max(o.col,r.col)),!0):!1}},{key:"expandByRange",value:function(r){if(this.includesRange(r)||!this.overlaps(r))return!1;var n=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner(),i=this.getDirection(),a=r.getOuterTopStartCorner(),l=r.getOuterBottomEndCorner(),s=Math.min(n.row,a.row),u=Math.min(n.col,a.col),f=Math.max(o.row,l.row),c=Math.max(o.col,l.col),h=this._createCellCoords(s,u),d=this._createCellCoords(f,c);return this.from=h,this.to=d,this.setDirection(i),this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}},{key:"getDirection",value:function(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}},{key:"setDirection",value:function(r){switch(r){case"NW-SE":var n=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];this.from=n[0],this.to=n[1];break;case"NE-SW":var o=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];this.from=o[0],this.to=o[1];break;case"SE-NW":var i=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];this.from=i[0],this.to=i[1];break;case"SW-NE":var a=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];this.from=a[0],this.to=a[1];break}}},{key:"getVerticalDirection",value:function(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}},{key:"getHorizontalDirection",value:function(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}},{key:"flipDirectionVertically",value:function(){var r=this.getDirection();switch(r){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}},{key:"flipDirectionHorizontally",value:function(){var r=this.getDirection();switch(r){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}},{key:"getTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getTopLeftCorner",value:function(){return Sn(this,Wr)?this.getTopEndCorner():this.getTopStartCorner()}},{key:"getBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getBottomRightCorner",value:function(){return Sn(this,Wr)?this.getBottomStartCorner():this.getBottomEndCorner()}},{key:"getTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getTopRightCorner",value:function(){return Sn(this,Wr)?this.getTopStartCorner():this.getTopEndCorner()}},{key:"getBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getBottomLeftCorner",value:function(){return Sn(this,Wr)?this.getBottomEndCorner():this.getBottomStartCorner()}},{key:"getOuterTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterTopLeftCorner",value:function(){return Sn(this,Wr)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}},{key:"getOuterBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterBottomRightCorner",value:function(){return Sn(this,Wr)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}},{key:"getOuterTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterTopRightCorner",value:function(){return Sn(this,Wr)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}},{key:"getOuterBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterBottomLeftCorner",value:function(){return Sn(this,Wr)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}},{key:"isCorner",value:function(r,n){return n&&n.includes(r)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(n.from.row,n.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(n.from.row,n.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(n.to.row,n.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(n.to.row,n.to.col)))?!0:r.isEqual(this.getOuterTopLeftCorner())||r.isEqual(this.getOuterTopRightCorner())||r.isEqual(this.getOuterBottomLeftCorner())||r.isEqual(this.getOuterBottomRightCorner())}},{key:"getOppositeCorner",value:function(r,n){if(!(r instanceof Gg))return!1;if(n){var o=n.from,i=n.to;if(n.includes(r)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(o.row,o.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(o.row,i.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(i.row,o.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(i.row,i.col)))return this.getOuterTopStartCorner()}}if(r.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(r.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(r.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(r.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}},{key:"getBordersSharedWith",value:function(r){if(!this.includesRange(r))return[];var n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},o={top:Math.min(r.from.row,r.to.row),bottom:Math.max(r.from.row,r.to.row),left:Math.min(r.from.col,r.to.col),right:Math.max(r.from.col,r.to.col)},i=[];return n.top===o.top&&i.push("top"),n.right===o.right&&i.push("right"),n.bottom===o.bottom&&i.push("bottom"),n.left===o.left&&i.push("left"),i}},{key:"getInner",value:function(){for(var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),o=[],i=r.row;i<=n.row;i++)for(var a=r.col;a<=n.col;a++)!(this.from.row===i&&this.from.col===a)&&!(this.to.row===i&&this.to.col===a)&&o.push(this._createCellCoords(i,a));return o}},{key:"getAll",value:function(){for(var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),o=[],i=r.row;i<=n.row;i++)for(var a=r.col;a<=n.col;a++)r.row===i&&r.col===a?o.push(r):n.row===i&&n.col===a?o.push(n):o.push(this._createCellCoords(i,a));return o}},{key:"forAll",value:function(r){for(var n=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner(),i=n.row;i<=o.row;i++)for(var a=n.col;a<=o.col;a++){var l=r(i,a);if(l===!1)return}}},{key:"clone",value:function(){return new e(this.highlight,this.from,this.to,Sn(this,Wr))}},{key:"toObject",value:function(){return{from:this.from.toObject(),to:this.to.toObject()}}},{key:"_createCellCoords",value:function(r,n){return new Gg(r,n,Sn(this,Wr))}}]),e}();const _E=Oue;var Rue=$e,Eue=s0;Rue({target:"Object",stat:!0},{setPrototypeOf:Eue});var rW=Ue,Tue=Ya,Pue=Nt,kue=Mt,wA=Za,$ue=Nd,nW=Function,Aue=rW([].concat),Iue=rW([].join),ww={},Mue=function(e,t,r){if(!kue(ww,t)){for(var n=[],o=0;o<t;o++)n[o]="a["+o+"]";ww[t]=nW("C,a","return new C("+Iue(n,",")+")")}return ww[t](e,r)},xue=$ue?nW.bind:function(t){var r=Tue(this),n=r.prototype,o=wA(arguments,1),i=function(){var l=Aue(o,wA(arguments));return this instanceof i?Mue(r,l.length,l):r.apply(t,l)};return Pue(n)&&(i.prototype=n),i},Due=$e,Nue=Lo,Sw=mf,Hue=xue,SA=eB,Lue=Ht,CA=Nt,jue=Qa,oW=je,OE=Nue("Reflect","construct"),Fue=Object.prototype,Bue=[].push,iW=oW(function(){function e(){}return!(OE(function(){},[],e)instanceof e)}),aW=!oW(function(){OE(function(){})}),_A=iW||aW;Due({target:"Reflect",stat:!0,forced:_A,sham:_A},{construct:function(t,r){SA(t),Lue(r);var n=arguments.length<3?t:SA(arguments[2]);if(aW&&!iW)return OE(t,r,n);if(t===n){switch(r.length){case 0:return new t;case 1:return new t(r[0]);case 2:return new t(r[0],r[1]);case 3:return new t(r[0],r[1],r[2]);case 4:return new t(r[0],r[1],r[2],r[3])}var o=[null];return Sw(Bue,o,r),new(Sw(Hue,t,o))}var i=n.prototype,a=jue(CA(i)?i:Fue),l=Sw(t,a,r);return CA(l)?l:a}});function Kc(e){"@babel/helpers - typeof";return Kc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kc(e)}function Vue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Uue(n.key),n)}}function Wue(e,t,r){return t&&OA(e.prototype,t),r&&OA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Uue(e){var t=zue(e,"string");return Kc(t)==="symbol"?t:String(t)}function zue(e,t){if(Kc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Kc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var dl=new WeakMap,Yue=function(){function e(t,r,n,o,i,a){var l=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;Vue(this,e),this.wtSettings=n,this.domBindings=r,this.wtTable=i,this.selections=a,this.parent=l,this.eventManager=o,this.facadeGetter=t,dl.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}return Wue(e,[{key:"registerEvents",value:function(){var r=this;this.eventManager.addEventListener(this.wtTable.holder,"contextmenu",function(i){return r.onContextMenu(i)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseover",function(i){return r.onMouseOver(i)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseout",function(i){return r.onMouseOut(i)});var n=function(){r.eventManager.addEventListener(r.wtTable.holder,"touchstart",function(a){return r.onTouchStart(a)}),r.eventManager.addEventListener(r.wtTable.holder,"touchend",function(a){return r.onTouchEnd(a)}),r.momentumScrolling||(r.momentumScrolling={}),r.eventManager.addEventListener(r.wtTable.holder,"scroll",function(){clearTimeout(r.momentumScrolling._timeout),r.momentumScrolling.ongoing||r.wtSettings.getSetting("onBeforeTouchScroll"),r.momentumScrolling.ongoing=!0,r.momentumScrolling._timeout=setTimeout(function(){r.touchApplied||(r.momentumScrolling.ongoing=!1,r.wtSettings.getSetting("onAfterMomentumScroll"))},200)})},o=function(){r.eventManager.addEventListener(r.wtTable.holder,"mouseup",function(a){return r.onMouseUp(a)}),r.eventManager.addEventListener(r.wtTable.holder,"mousedown",function(a){return r.onMouseDown(a)})};fn()?n():(D0()&&n(),o())}},{key:"selectedCellWasTouched",value:function(r){var n=dl.get(this),o=this.parentCell(r),i=o.coords;if(n.selectedCellBeforeTouchEnd&&i){var a=[i.row,n.selectedCellBeforeTouchEnd.from.row],l=a[0],s=a[1],u=[i.col,n.selectedCellBeforeTouchEnd.from.col],f=u[0],c=u[1];return l===s&&f===c}return!1}},{key:"parentCell",value:function(r){var n={},o=this.wtTable.TABLE,i=uc(r,["TD","TH"],o);return i?(n.coords=this.wtTable.getCoords(i),n.TD=i):xe(r,"wtBorder")&&xe(r,"current")?(n.coords=this.selections.getCell().cellRange.highlight,n.TD=this.wtTable.getCell(n.coords)):xe(r,"wtBorder")&&xe(r,"area")&&this.selections.createOrGetArea().cellRange&&(n.coords=this.selections.createOrGetArea().cellRange.to,n.TD=this.wtTable.getCell(n.coords)),n}},{key:"onMouseDown",value:function(r){var n=dl.get(this),o=this.domBindings.rootDocument.activeElement,i=yE(fV,r.target),a=r.target;if(!(a===o||i(0)===o||i(1)===o)){var l=this.parentCell(a);xe(a,"corner")?this.wtSettings.getSetting("onCellCornerMouseDown",r,a):l.TD&&this.wtSettings.has("onCellMouseDown")&&this.callListener("onCellMouseDown",r,l.coords,l.TD),(r.button===0||this.touchApplied)&&l.TD&&(n.dblClickOrigin[0]=l.TD,clearTimeout(n.dblClickTimeout[0]),n.dblClickTimeout[0]=setTimeout(function(){n.dblClickOrigin[0]=null},1e3))}}},{key:"onContextMenu",value:function(r){if(this.wtSettings.has("onCellContextMenu")){var n=this.parentCell(r.target);n.TD&&this.callListener("onCellContextMenu",r,n.coords,n.TD)}}},{key:"onMouseOver",value:function(r){if(this.wtSettings.has("onCellMouseOver")){var n=this.wtTable.TABLE,o=uc(r.target,["TD","TH"],n),i=this.parent||this;o&&o!==i.lastMouseOver&&hi(o,n)&&(i.lastMouseOver=o,this.callListener("onCellMouseOver",r,this.wtTable.getCoords(o),o))}}},{key:"onMouseOut",value:function(r){if(this.wtSettings.has("onCellMouseOut")){var n=this.wtTable.TABLE,o=uc(r.target,["TD","TH"],n),i=uc(r.relatedTarget,["TD","TH"],n),a=this.parent||this;o&&o!==i&&hi(o,n)&&(this.callListener("onCellMouseOut",r,this.wtTable.getCoords(o),o),i===null&&(a.lastMouseOver=null))}}},{key:"onMouseUp",value:function(r){var n=dl.get(this),o=this.parentCell(r.target);o.TD&&this.wtSettings.has("onCellMouseUp")&&this.callListener("onCellMouseUp",r,o.coords,o.TD),!(r.button!==0&&!this.touchApplied)&&(o.TD===n.dblClickOrigin[0]&&o.TD===n.dblClickOrigin[1]?(xe(r.target,"corner")?this.callListener("onCellCornerDblClick",r,o.coords,o.TD):this.callListener("onCellDblClick",r,o.coords,o.TD),n.dblClickOrigin[0]=null,n.dblClickOrigin[1]=null):o.TD===n.dblClickOrigin[0]&&(n.dblClickOrigin[1]=o.TD,clearTimeout(n.dblClickTimeout[1]),n.dblClickTimeout[1]=setTimeout(function(){n.dblClickOrigin[1]=null},500)))}},{key:"onTouchStart",value:function(r){var n=dl.get(this);n.selectedCellBeforeTouchEnd=this.selections.getCell().cellRange,this.touchApplied=!0,this.onMouseDown(r)}},{key:"onTouchEnd",value:function(r){var n,o=r.target,i=(n=this.parentCell(o))===null||n===void 0?void 0:n.coords,a=ve(i)&&i.row>=0&&i.col>=0,l=r.cancelable&&a&&this.wtSettings.getSetting("isDataViewInstance");if(l){var s=["A","BUTTON","INPUT"];j0()&&(sB()||uB())&&this.selectedCellWasTouched(o)&&!s.includes(o.tagName)?r.preventDefault():this.selectedCellWasTouched(o)||r.preventDefault()}this.onMouseUp(r),this.touchApplied=!1}},{key:"callListener",value:function(r,n,o,i){var a=this.wtSettings.getSettingPure(r);a&&a(n,o,i,this.facadeGetter())}},{key:"destroy",value:function(){var r=dl.get(this);clearTimeout(r.dblClickTimeout[0]),clearTimeout(r.dblClickTimeout[1]),this.eventManager.destroy()}}]),e}();const lW=Yue;function qc(e){"@babel/helpers - typeof";return qc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qc(e)}function Gue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,que(n.key),n)}}function Kue(e,t,r){return t&&RA(e.prototype,t),r&&RA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function que(e){var t=Xue(e,"string");return qc(t)==="symbol"?t:String(t)}function Xue(e,t){if(qc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Zue=function(){function e(t,r,n){Gue(this,e),this.offset=t,this.total=r,this.countTH=n}return Kue(e,[{key:"offsetted",value:function(r){return r+this.offset}},{key:"unOffsetted",value:function(r){return r-this.offset}},{key:"renderedToSource",value:function(r){return this.offsetted(r)}},{key:"sourceToRendered",value:function(r){return this.unOffsetted(r)}},{key:"offsettedTH",value:function(r){return r-this.countTH}},{key:"unOffsettedTH",value:function(r){return r+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(r){return this.renderedToSource(this.offsettedTH(r))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(r){return this.unOffsettedTH(this.sourceToRendered(r))}}]),e}();const Que=Zue;function Xc(e){"@babel/helpers - typeof";return Xc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xc(e)}function Jue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tfe(n.key),n)}}function efe(e,t,r){return t&&EA(e.prototype,t),r&&EA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tfe(e){var t=rfe(e,"string");return Xc(t)==="symbol"?t:String(t)}function rfe(e,t){if(Xc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var nfe=function(){function e(t,r,n){Jue(this,e),this.offset=t,this.total=r,this.countTH=n}return efe(e,[{key:"offsetted",value:function(r){return r+this.offset}},{key:"unOffsetted",value:function(r){return r-this.offset}},{key:"renderedToSource",value:function(r){return this.offsetted(r)}},{key:"sourceToRendered",value:function(r){return this.unOffsetted(r)}},{key:"offsettedTH",value:function(r){return r-this.countTH}},{key:"unOffsettedTH",value:function(r){return r+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(r){return this.renderedToSource(this.offsettedTH(r))}},{key:"sourceRowToVisibleColHeadedRow",value:function(r){return this.unOffsettedTH(this.sourceToRendered(r))}}]),e}();const ofe=nfe;var ife=0,Kg=1,qg=2;function Zc(e){"@babel/helpers - typeof";return Zc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zc(e)}function afe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sfe(n.key),n)}}function lfe(e,t,r){return t&&TA(e.prototype,t),r&&TA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sfe(e){var t=ufe(e,"string");return Zc(t)==="symbol"?t:String(t)}function ufe(e,t){if(Zc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var PA=function(){function e(){afe(this,e),this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}return lfe(e,[{key:"setSize",value:function(r){this.currentSize=this.nextSize,this.nextSize=r}},{key:"setOffset",value:function(r){this.currentOffset=this.nextOffset,this.nextOffset=r}}]),e}();function Qc(e){"@babel/helpers - typeof";return Qc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qc(e)}function ffe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hfe(n.key),n)}}function cfe(e,t,r){return t&&kA(e.prototype,t),r&&kA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hfe(e){var t=dfe(e,"string");return Qc(t)==="symbol"?t:String(t)}function dfe(e,t){if(Qc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var vfe=function(){function e(){ffe(this,e),this.size=new PA,this.workingSpace=ife,this.sharedSize=null}return cfe(e,[{key:"setSize",value:function(r){this.size.setSize(r)}},{key:"setOffset",value:function(r){this.size.setOffset(r)}},{key:"getViewSize",value:function(){return this.size}},{key:"isShared",value:function(){return this.sharedSize instanceof PA}},{key:"isPlaceOn",value:function(r){return this.workingSpace===r}},{key:"append",value:function(r){this.workingSpace=Kg,r.workingSpace=qg,this.sharedSize=r.getViewSize()}},{key:"prepend",value:function(r){this.workingSpace=qg,r.workingSpace=Kg,this.sharedSize=r.getViewSize()}}]),e}();function Jc(e){"@babel/helpers - typeof";return Jc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jc(e)}function yfe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $A(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pfe(n.key),n)}}function gfe(e,t,r){return t&&$A(e.prototype,t),r&&$A(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pfe(e){var t=mfe(e,"string");return Jc(t)==="symbol"?t:String(t)}function mfe(e,t){if(Jc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Jc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var sW=function(){function e(t,r,n){yfe(this,e),this.rootNode=t,this.nodesPool=r,this.sizeSet=new vfe,this.childNodeType=n.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}return gfe(e,[{key:"setSize",value:function(r){return this.sizeSet.setSize(r),this}},{key:"setOffset",value:function(r){return this.sizeSet.setOffset(r),this}},{key:"isSharedViewSet",value:function(){return this.sizeSet.isShared()}},{key:"getNode",value:function(r){return r<this.collectedNodes.length?this.collectedNodes[r]:null}},{key:"getCurrentNode",value:function(){var r=this.collectedNodes.length;return r>0?this.collectedNodes[r-1]:null}},{key:"getRenderedChildCount",value:function(){var r=this.rootNode,n=this.sizeSet,o=0;if(this.isSharedViewSet())for(var i=r.firstElementChild;i;){if(i.tagName===this.childNodeType)o+=1;else if(n.isPlaceOn(Kg))break;i=i.nextElementSibling}else o=r.childElementCount;return o}},{key:"start",value:function(){this.collectedNodes.length=0,this.visualIndex=0;for(var r=this.rootNode,n=this.sizeSet,o=this.isSharedViewSet(),i=n.getViewSize(),a=i.nextSize,l=this.getRenderedChildCount();l<a;){var s=this.nodesPool();!o||o&&n.isPlaceOn(qg)?r.appendChild(s):r.insertBefore(s,r.firstChild),l+=1}for(var u=o&&n.isPlaceOn(Kg);l>a;)r.removeChild(u?r.firstChild:r.lastChild),l-=1}},{key:"render",value:function(){var r=this.rootNode,n=this.sizeSet,o=this.visualIndex;this.isSharedViewSet()&&n.isPlaceOn(qg)&&(o+=n.sharedSize.nextSize);var i=r.childNodes[o];if(i.tagName!==this.childNodeType){var a=this.nodesPool();r.replaceChild(a,i),i=a}this.collectedNodes.push(i),this.visualIndex+=1}},{key:"end",value:function(){}}]),e}();function ds(e){"@babel/helpers - typeof";return ds=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ds(e)}function bfe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Sfe(n.key),n)}}function wfe(e,t,r){return t&&AA(e.prototype,t),r&&AA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Sfe(e){var t=Cfe(e,"string");return ds(t)==="symbol"?t:String(t)}function Cfe(e,t){if(ds(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ds(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _fe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&r_(e,t)}function r_(e,t){return r_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},r_(e,t)}function Ofe(e){var t=Tfe();return function(){var n=Xg(e),o;if(t){var i=Xg(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Rfe(this,o)}}function Rfe(e,t){if(t&&(ds(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Efe(e)}function Efe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Tfe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Xg(e){return Xg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Xg(e)}var uW=function(e){_fe(r,e);var t=Ofe(r);function r(){return bfe(this,r),t.apply(this,arguments)}return wfe(r,[{key:"prependView",value:function(o){return this.sizeSet.prepend(o.sizeSet),o.sizeSet.append(this.sizeSet),this}},{key:"appendView",value:function(o){return this.sizeSet.append(o.sizeSet),o.sizeSet.prepend(this.sizeSet),this}}]),r}(sW);function eh(e){"@babel/helpers - typeof";return eh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eh(e)}function Pfe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function IA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$fe(n.key),n)}}function kfe(e,t,r){return t&&IA(e.prototype,t),r&&IA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $fe(e){var t=Afe(e,"string");return eh(t)==="symbol"?t:String(t)}function Afe(e,t){if(eh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(eh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ife=function(){function e(t){Pfe(this,e),this.nodeType=t.toUpperCase()}return kfe(e,[{key:"setRootDocument",value:function(r){this.rootDocument=r}},{key:"obtain",value:function(){return this.rootDocument.createElement(this.nodeType)}}]),e}();function th(e){"@babel/helpers - typeof";return th=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},th(e)}function Mfe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Dfe(n.key),n)}}function xfe(e,t,r){return t&&MA(e.prototype,t),r&&MA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Dfe(e){var t=Nfe(e,"string");return th(t)==="symbol"?t:String(t)}function Nfe(e,t){if(th(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(th(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mv=function(){function e(t,r){Mfe(this,e),this.nodesPool=typeof t=="string"?new Ife(t):null,this.nodeType=t,this.rootNode=r,this.table=null,this.renderedNodes=0}return xfe(e,[{key:"setTable",value:function(r){this.nodesPool&&this.nodesPool.setRootDocument(r.rootDocument),this.table=r}},{key:"adjust",value:function(){}},{key:"render",value:function(){}}]),e}();function vs(e){"@babel/helpers - typeof";return vs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vs(e)}function Hfe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jfe(n.key),n)}}function Lfe(e,t,r){return t&&xA(e.prototype,t),r&&xA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jfe(e){var t=Ffe(e,"string");return vs(t)==="symbol"?t:String(t)}function Ffe(e,t){if(vs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Bfe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&n_(e,t)}function n_(e,t){return n_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},n_(e,t)}function Vfe(e){var t=zfe();return function(){var n=Zg(e),o;if(t){var i=Zg(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Wfe(this,o)}}function Wfe(e,t){if(t&&(vs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ufe(e)}function Ufe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zfe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Zg(e){return Zg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Zg(e)}var Yfe=function(e){Bfe(r,e);var t=Vfe(r);function r(){var n;return Hfe(this,r),n=t.call(this,"TH"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return Lfe(r,[{key:"obtainOrderView",value:function(o){var i=this,a;return this.orderViews.has(o)?a=this.orderViews.get(o):(a=new uW(o,function(l){return i.nodesPool.obtain(i.sourceRowIndex,l)},this.nodeType),this.orderViews.set(o,a)),a}},{key:"render",value:function(){for(var o=this.table,i=o.rowsToRender,a=o.rowHeaderFunctions,l=o.rowHeadersCount,s=o.rows,u=o.cells,f=0;f<i;f++){var c=this.table.renderedRowToSource(f),h=s.getRenderedNode(f);this.sourceRowIndex=c;var d=this.obtainOrderView(h),v=u.obtainOrderView(h);d.appendView(v).setSize(l).setOffset(this.table.renderedColumnToSource(0)).start();for(var g=0;g<l;g++){d.render();var m=d.getCurrentNode();m.className="",m.removeAttribute("style"),a[g](c,m,g)}d.end()}}}]),r}(mv);function ys(e){"@babel/helpers - typeof";return ys=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ys(e)}function Gfe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qfe(n.key),n)}}function Kfe(e,t,r){return t&&DA(e.prototype,t),r&&DA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qfe(e){var t=Xfe(e,"string");return ys(t)==="symbol"?t:String(t)}function Xfe(e,t){if(ys(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ys(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Zfe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&o_(e,t)}function o_(e,t){return o_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},o_(e,t)}function Qfe(e){var t=tce();return function(){var n=Qg(e),o;if(t){var i=Qg(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Jfe(this,o)}}function Jfe(e,t){if(t&&(ys(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ece(e)}function ece(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tce(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Qg(e){return Qg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Qg(e)}var rce=function(e){Zfe(r,e);var t=Qfe(r);function r(n){return Gfe(this,r),t.call(this,null,n)}return Kfe(r,[{key:"adjust",value:function(){var o=this.table,i=o.columnHeadersCount,a=o.rowHeadersCount,l=this.rootNode.firstChild;if(i){for(var s=this.table.columnsToRender,u=s+a,f=0,c=i;f<c;f++){for(l=this.rootNode.childNodes[f],l||(l=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(l)),this.renderedNodes=l.childNodes.length;this.renderedNodes<u;)l.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>u;)l.removeChild(l.lastChild),this.renderedNodes-=1}var h=this.rootNode.childNodes.length;if(h>i)for(var d=i;d<h;d++)this.rootNode.removeChild(this.rootNode.lastChild)}else l&&yn(l)}},{key:"render",value:function(){for(var o=this.table.columnHeadersCount,i=0;i<o;i+=1)for(var a=this.table,l=a.columnHeaderFunctions,s=a.columnsToRender,u=a.rowHeadersCount,f=this.rootNode.childNodes[i],c=-1*u;c<s;c+=1){var h=this.table.renderedColumnToSource(c),d=f.childNodes[c+u];d.className="",d.removeAttribute("style"),l[i](h,d,i)}}}]),r}(mv);function gs(e){"@babel/helpers - typeof";return gs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gs(e)}function nce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ice(n.key),n)}}function oce(e,t,r){return t&&NA(e.prototype,t),r&&NA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ice(e){var t=ace(e,"string");return gs(t)==="symbol"?t:String(t)}function ace(e,t){if(gs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lce(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i_(e,t)}function i_(e,t){return i_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},i_(e,t)}function sce(e){var t=cce();return function(){var n=Jg(e),o;if(t){var i=Jg(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return uce(this,o)}}function uce(e,t){if(t&&(gs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fce(e)}function fce(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cce(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Jg(e){return Jg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Jg(e)}var hce=function(e){lce(r,e);var t=sce(r);function r(n){return nce(this,r),t.call(this,null,n)}return oce(r,[{key:"adjust",value:function(){for(var o=this.table,i=o.columnsToRender,a=o.rowHeadersCount,l=i+a;this.renderedNodes<l;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>l;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}},{key:"render",value:function(){this.adjust();for(var o=this.table,i=o.columnsToRender,a=o.rowHeadersCount,l=0;l<a;l++){var s=this.table.renderedColumnToSource(l),u=this.table.columnUtils.getHeaderWidth(s);this.rootNode.childNodes[l].style.width="".concat(u,"px")}for(var f=0;f<i;f++){var c=this.table.renderedColumnToSource(f),h=this.table.columnUtils.getStretchedColumnWidth(c);this.rootNode.childNodes[f+a].style.width="".concat(h,"px")}var d=this.rootNode.firstChild;d&&re(d,"rowHeader")}}]),r}(mv);function ps(e){"@babel/helpers - typeof";return ps=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ps(e)}var HA;function dce(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function vce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gce(n.key),n)}}function yce(e,t,r){return t&&LA(e.prototype,t),r&&LA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gce(e){var t=pce(e,"string");return ps(t)==="symbol"?t:String(t)}function pce(e,t){if(ps(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ps(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function mce(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a_(e,t)}function a_(e,t){return a_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},a_(e,t)}function bce(e){var t=Cce();return function(){var n=ep(e),o;if(t){var i=ep(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return wce(this,o)}}function wce(e,t){if(t&&(ps(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Sce(e)}function Sce(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Cce(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ep(e){return ep=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ep(e)}var jA=!1,_ce=function(e){mce(r,e);var t=bce(r);function r(n){var o;return vce(this,r),o=t.call(this,"TR",n),o.orderView=new sW(n,function(i){return o.nodesPool.obtain(i)},o.nodeType),o}return yce(r,[{key:"getRenderedNode",value:function(o){return this.orderView.getNode(o)}},{key:"render",value:function(){var o=this.table.rowsToRender;!jA&&o>1e3&&(jA=!0,ht(ft(HA||(HA=dce([`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting 
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`],[`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`]))))),this.orderView.setSize(o).setOffset(this.table.renderedRowToSource(0)).start();for(var i=0;i<o;i++)this.orderView.render();this.orderView.end()}}]),r}(mv);function ms(e){"@babel/helpers - typeof";return ms=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ms(e)}function Oce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ece(n.key),n)}}function Rce(e,t,r){return t&&FA(e.prototype,t),r&&FA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ece(e){var t=Tce(e,"string");return ms(t)==="symbol"?t:String(t)}function Tce(e,t){if(ms(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ms(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Pce(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l_(e,t)}function l_(e,t){return l_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},l_(e,t)}function kce(e){var t=Ice();return function(){var n=tp(e),o;if(t){var i=tp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return $ce(this,o)}}function $ce(e,t){if(t&&(ms(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ace(e)}function Ace(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ice(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function tp(e){return tp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},tp(e)}var Mce=function(e){Pce(r,e);var t=kce(r);function r(){var n;return Oce(this,r),n=t.call(this,"TD"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return Rce(r,[{key:"obtainOrderView",value:function(o){var i=this,a;return this.orderViews.has(o)?a=this.orderViews.get(o):(a=new uW(o,function(l){return i.nodesPool.obtain(i.sourceRowIndex,l)},this.nodeType),this.orderViews.set(o,a)),a}},{key:"render",value:function(){for(var o=this.table,i=o.rowsToRender,a=o.columnsToRender,l=o.rows,s=o.rowHeaders,u=0;u<i;u++){var f=this.table.renderedRowToSource(u),c=l.getRenderedNode(u);this.sourceRowIndex=f;var h=this.obtainOrderView(c),d=s.obtainOrderView(c);h.prependView(d).setSize(a).setOffset(this.table.renderedColumnToSource(0)).start();for(var v=0;v<a;v++){h.render();var g=h.getCurrentNode(),m=this.table.renderedColumnToSource(v);xe(g,"hide")||(g.className=""),g.removeAttribute("style"),g.removeAttribute("dir"),this.table.cellRenderer(f,m,g)}h.end()}}}]),r}(mv);function rh(e){"@babel/helpers - typeof";return rh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rh(e)}function xce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Nce(n.key),n)}}function Dce(e,t,r){return t&&BA(e.prototype,t),r&&BA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Nce(e){var t=Hce(e,"string");return rh(t)==="symbol"?t:String(t)}function Hce(e,t){if(rh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Lce=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.cellRenderer;xce(this,e),this.rootNode=t,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=n}return Dce(e,[{key:"setAxisUtils",value:function(r,n){this.rowUtils=r,this.columnUtils=n}},{key:"setViewportSize",value:function(r,n){this.rowsToRender=r,this.columnsToRender=n}},{key:"setFilters",value:function(r,n){this.rowFilter=r,this.columnFilter=n}},{key:"setHeaderContentRenderers",value:function(r,n){this.rowHeaderFunctions=r,this.rowHeadersCount=r.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}},{key:"setRenderers",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=r.rowHeaders,o=r.columnHeaders,i=r.colGroup,a=r.rows,l=r.cells;n.setTable(this),o.setTable(this),i.setTable(this),a.setTable(this),l.setTable(this),this.rowHeaders=n,this.columnHeaders=o,this.colGroup=i,this.rows=a,this.cells=l}},{key:"renderedRowToSource",value:function(r){return this.rowFilter.renderedToSource(r)}},{key:"renderedColumnToSource",value:function(r){return this.columnFilter.renderedToSource(r)}},{key:"render",value:function(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();for(var r=this.rowsToRender,n=this.rows,o=0;o<r;o++){var i=n.getRenderedNode(o);if(i.firstChild){var a=this.renderedRowToSource(o),l=this.rowUtils.getHeight(a);l?i.firstChild.style.height="".concat(l-1,"px"):i.firstChild.style.height=""}}}}]),e}();function nh(e){"@babel/helpers - typeof";return nh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nh(e)}function jce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Bce(n.key),n)}}function Fce(e,t,r){return t&&VA(e.prototype,t),r&&VA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Bce(e){var t=Vce(e,"string");return nh(t)==="symbol"?t:String(t)}function Vce(e,t){if(nh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Wce=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.TABLE,n=t.THEAD,o=t.COLGROUP,i=t.TBODY,a=t.rowUtils,l=t.columnUtils,s=t.cellRenderer;jce(this,e),this.renderer=new Lce(r,{cellRenderer:s}),this.renderer.setRenderers({rowHeaders:new Yfe,columnHeaders:new rce(n),colGroup:new hce(o),rows:new _ce(i),cells:new Mce}),this.renderer.setAxisUtils(a,l)}return Fce(e,[{key:"setFilters",value:function(r,n){return this.renderer.setFilters(r,n),this}},{key:"setViewportSize",value:function(r,n){return this.renderer.setViewportSize(r,n),this}},{key:"setHeaderContentRenderers",value:function(r,n){return this.renderer.setHeaderContentRenderers(r,n),this}},{key:"adjust",value:function(){this.renderer.adjust()}},{key:"render",value:function(){this.renderer.render()}}]),e}();function oh(e){"@babel/helpers - typeof";return oh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oh(e)}function Uce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Yce(n.key),n)}}function zce(e,t,r){return t&&WA(e.prototype,t),r&&WA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Yce(e){var t=Gce(e,"string");return oh(t)==="symbol"?t:String(t)}function Gce(e,t){if(oh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(oh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Kce=function(){function e(t,r){Uce(this,e),this.dataAccessObject=t,this.wtSettings=r,this.headerWidths=new Map}return zce(e,[{key:"getWidth",value:function(r){return this.wtSettings.getSetting("columnWidth",r)||this.wtSettings.getSetting("defaultColumnWidth")}},{key:"getStretchedColumnWidth",value:function(r){var n=this.dataAccessObject.wtViewport.columnsRenderCalculator,o=this.getWidth(r);if(n){var i=n.getStretchedColumnWidth(r,o);i&&(o=i)}return o}},{key:"getHeaderHeight",value:function(r){var n=this.wtSettings.getSetting("defaultRowHeight"),o=this.dataAccessObject.wtViewport.oversizedColumnHeaders[r];return o!==void 0&&(n=n?Math.max(n,o):o),n}},{key:"getHeaderWidth",value:function(r){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(r))}},{key:"calculateWidths",value:function(){var r=this.wtSettings,n=this.dataAccessObject,o=n.wtTable,i=n.wtViewport,a=n.cloneSource,l=a?a.wtTable.holder:o.holder,s=l.offsetHeight<l.scrollHeight?Xt():0,u=r.getSetting("rowHeaderWidth");if(i.columnsRenderCalculator.refreshStretching(i.getViewportWidth()-s),u=r.getSetting("onModifyRowHeaderWidth",u),u!=null)for(var f=r.getSetting("rowHeaders").length,c=r.getSetting("defaultColumnWidth"),h=0;h<f;h++){var d=Array.isArray(u)?u[h]:u;d=d??c,this.headerWidths.set(h,d)}}}]),e}();function ih(e){"@babel/helpers - typeof";return ih=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ih(e)}function qce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Zce(n.key),n)}}function Xce(e,t,r){return t&&UA(e.prototype,t),r&&UA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Zce(e){var t=Qce(e,"string");return ih(t)==="symbol"?t:String(t)}function Qce(e,t){if(ih(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ih(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Jce=function(){function e(t,r){qce(this,e),this.dataAccessObject=t,this.wtSettings=r}return Xce(e,[{key:"getHeight",value:function(r){var n=this.wtSettings.getSetting("rowHeight",r),o=this.dataAccessObject.wtViewport.oversizedRows[r];return o!==void 0&&(n=n===void 0?o:Math.max(n,o)),n}}]),e}();function ah(e){"@babel/helpers - typeof";return ah=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ah(e)}function ehe(e){return nhe(e)||rhe(e)||fW(e)||the()}function the(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rhe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function nhe(e){if(Array.isArray(e))return s_(e)}function ohe(e,t){return lhe(e)||ahe(e,t)||fW(e,t)||ihe()}function ihe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fW(e,t){if(e){if(typeof e=="string")return s_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s_(e,t)}}function s_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ahe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function lhe(e){if(Array.isArray(e))return e}function she(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cW(n.key),n)}}function uhe(e,t,r){return t&&zA(e.prototype,t),r&&zA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Cn(e,t,r){return t=cW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cW(e){var t=fhe(e,"string");return ah(t)==="symbol"?t:String(t)}function fhe(e,t){if(ah(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ah(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var che=function(){function e(t,r,n,o,i){var a=this;she(this,e),Cn(this,"wtSettings",null),Cn(this,"domBindings",void 0),Cn(this,"TBODY",null),Cn(this,"THEAD",null),Cn(this,"COLGROUP",null),Cn(this,"hasTableHeight",!0),Cn(this,"hasTableWidth",!0),Cn(this,"isTableVisible",!1),Cn(this,"tableOffset",0),Cn(this,"holderOffset",0),this.domBindings=n,this.isMaster=i==="master",this.name=i,this.dataAccessObject=t,this.facadeGetter=r,this.wtSettings=o,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,cE(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;var l=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",function(){return a._modifyRowHeaderWidth(l)}),this.rowUtils=new Jce(this.dataAccessObject,this.wtSettings),this.columnUtils=new Kce(this.dataAccessObject,this.wtSettings),this.tableRenderer=new Wce({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}return uhe(e,[{key:"is",value:function(r){return this.name===r}},{key:"fixTableDomTree",value:function(){var r=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=r.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=r.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=r.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}},{key:"createSpreader",value:function(r){var n=r.parentNode,o;return(!n||n.nodeType!==Node.ELEMENT_NODE||!xe(n,"wtHolder"))&&(o=this.domBindings.rootDocument.createElement("div"),o.className="wtSpreader",n&&n.insertBefore(o,r),o.appendChild(r)),o.style.position="relative",o}},{key:"createHider",value:function(r){var n=r.parentNode,o;return(!n||n.nodeType!==Node.ELEMENT_NODE||!xe(n,"wtHolder"))&&(o=this.domBindings.rootDocument.createElement("div"),o.className="wtHider",n&&n.insertBefore(o,r),o.appendChild(r)),o}},{key:"createHolder",value:function(r){var n=r.parentNode,o;return(!n||n.nodeType!==Node.ELEMENT_NODE||!xe(n,"wtHolder"))&&(o=this.domBindings.rootDocument.createElement("div"),o.style.position="relative",o.className="wtHolder",n&&n.insertBefore(o,r),this.isMaster&&(o.parentNode.className+="ht_master handsontable",o.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr")),o.appendChild(r)),o}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wtSettings,o=this.dataAccessObject,i=o.wtOverlays,a=o.wtViewport,l=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),u=n.getSetting("rowHeaders"),f=u.length,c=n.getSetting("columnHeaders"),h=c.length,d=!1,v=r;if(this.isMaster&&(this.holderOffset=Vt(this.holder),v=a.createRenderCalculators(v),f&&!n.getSetting("fixedColumnsStart"))){var g=i.inlineStartOverlay.getScrollPosition(),m=this.correctHeaderWidth;this.correctHeaderWidth=g!==0,m!==this.correctHeaderWidth&&(v=!1)}if(this.isMaster&&(d=i.updateStateOfRendering()),v)this.isMaster&&a.createVisibleCalculators(),i&&i.refresh(!0);else{this.isMaster?this.tableOffset=Vt(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;var w=l>0?this.getFirstRenderedRow():0,S=s>0?this.getFirstRenderedColumn():0;this.rowFilter=new ofe(w,l,h),this.columnFilter=new Que(S,s,f);var C=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();var P={};this.wtSettings.getSetting("beforeDraw",!0,P),C=P.skipRender!==!0}if(C){this.tableRenderer.setHeaderContentRenderers(u,c),(this.is(Dn)||this.is(di))&&this.tableRenderer.setHeaderContentRenderers(u,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();var R;if(this.isMaster&&(R=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Dn))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();var V=dt(this.hider),U=dt(this.TABLE);V!==0&&U!==V&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),R!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(Dn)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}var X=!1;return this.isMaster&&(X=i.topOverlay.resetFixedPosition(),i.bottomOverlay.clone&&(X=i.bottomOverlay.resetFixedPosition()||X),X=i.inlineStartOverlay.resetFixedPosition()||X,i.topInlineStartCornerOverlay&&i.topInlineStartCornerOverlay.resetFixedPosition(),i.bottomInlineStartCornerOverlay&&i.bottomInlineStartCornerOverlay.clone&&i.bottomInlineStartCornerOverlay.resetFixedPosition()),X?(i.refreshAll(),i.adjustElementsSize()):this.refreshSelections(v),d&&i.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}},{key:"markIfOversizedColumnHeader",value:function(r){for(var n=this.columnFilter.renderedToSource(r),o=this.wtSettings.getSetting("columnHeaders").length,i=this.wtSettings.getSetting("defaultRowHeight"),a,l,s,u=this.wtSettings.getSetting("columnHeaderHeight")||[];o;)o-=1,a=this.getColumnHeaderHeight(o),l=this.getColumnHeader(n,o),l&&(s=ao(l),(!a&&i<s||a<s)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=s),Array.isArray(u)?u[o]!==null&&u[o]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=u[o]):isNaN(u)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=u),this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]<(u[o]||u)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=u[o]||u))}},{key:"adjustColumnHeaderHeights",value:function(){for(var r=this.wtSettings,n=this.THEAD.childNodes,o=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=r.getSetting("columnHeaders"),a=0,l=i.length;a<l;a++)if(o[a]){if(!n[a]||n[a].childNodes.length===0)return;n[a].childNodes[0].style.height="".concat(o[a],"px")}}},{key:"resetOversizedRows",value:function(){var r=this.wtSettings,n=this.dataAccessObject.wtViewport;if(!(!this.isMaster&&!this.is(Dn))&&!r.getSetting("externalRowCalculator"))for(var o=this.getRenderedRowsCount(),i=0;i<o;i++){var a=this.rowFilter.renderedToSource(i);n.oversizedRows&&n.oversizedRows[a]&&(n.oversizedRows[a]=void 0)}}},{key:"removeClassFromCells",value:function(r){for(var n=this.TABLE.querySelectorAll(".".concat(r)),o=0,i=n.length;o<i;o++)Le(n[o],r)}},{key:"refreshSelections",value:function(r){var n=this.wtSettings,o=this.dataAccessObject.selections;if(o){var i=Array.from(o),a=i.length;if(r){for(var l=[],s=0;s<a;s++){for(var u=i[s].settings,f=u.highlightHeaderClassName,c=u.highlightRowClassName,h=u.highlightColumnClassName,d=i[s].classNames,v=d.length,g=0;g<v;g++)l.includes(d[g])||l.push(d[g]);f&&!l.includes(f)&&l.push(f),c&&!l.includes(c)&&l.push(c),h&&!l.includes(h)&&l.push(h)}var m=n.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(m))for(var w=0;w<m.length;w++)l.push(m[w]);for(var S=l.length,C=0;C<S;C++)this.removeClassFromCells(l[C])}for(var P=0;P<a;P++)i[P].draw(this.facadeGetter(),r)}}},{key:"getCell",value:function(r){var n=r.row,o=r.col,i=this.wtSettings.getSetting("onModifyGetCellCoords",n,o);if(i&&Array.isArray(i)){var a=ohe(i,2);n=a[0],o=a[1]}if(this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(o))return-3;if(this.isColumnAfterRenderedColumns(o))return-4;var l=this.getRow(n);if(!l&&n>=0)throw new Error("TR was expected to be rendered but is not");var s=l.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(o)];if(!s&&o>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}},{key:"getRow",value:function(r){var n=null,o=null;if(r<0){var i;n=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(r),o=this.THEAD}else{var a;n=(a=this.rowFilter)===null||a===void 0?void 0:a.sourceToRendered(r),o=this.TBODY}return n!==void 0&&o!==void 0?o.childNodes.length<n+1?!1:o.childNodes[n]:!1}},{key:"getColumnHeader",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=this.THEAD.childNodes[n];return o==null?void 0:o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)]}},{key:"getColumnHeaders",value:function(r){var n=[],o=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r);return this.THEAD.childNodes.forEach(function(i){var a=i.childNodes[o];a&&n.push(a)}),n}},{key:"getRowHeader",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)!==0){var o=this.wtSettings.getSetting("rowHeaders").length;if(!(n>=o)){var i=this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)];return i==null?void 0:i.childNodes[n]}}}},{key:"getRowHeaders",value:function(r){if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)===0)return[];for(var n=[],o=this.wtSettings.getSetting("rowHeaders").length,i=0;i<o;i++){var a=this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)],l=a==null?void 0:a.childNodes[i];l&&n.push(l)}return n}},{key:"getCoords",value:function(r){var n=r;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=ci(n,["TD","TH"])),n===null)return null;var o=n.parentNode,i=o.parentNode,a=hV(o),l=n.cellIndex;if(ti(Ha,n,this.wtRootElement)||ti(Da,n,this.wtRootElement))i.nodeName==="THEAD"&&(a-=i.childNodes.length);else if(ti(di,n,this.wtRootElement)||ti(Dn,n,this.wtRootElement)){var s=this.wtSettings.getSetting("totalRows");a=s-i.childNodes.length+a}else i===this.THEAD?a=this.rowFilter.visibleColHeadedRowToSourceRow(a):a=this.rowFilter.renderedToSource(a);return ti(Ha,n,this.wtRootElement)||ti(Na,n,this.wtRootElement)||ti(di,n,this.wtRootElement)?l=this.columnFilter.offsettedTH(l):l=this.columnFilter.visibleRowHeadedColumnToSourceColumn(l),this.wot.createCellCoords(a,l)}},{key:"markOversizedRows",value:function(){if(!this.wtSettings.getSetting("externalRowCalculator")){var r=this.TBODY.childNodes.length,n=r*this.wtSettings.getSetting("defaultRowHeight"),o=ao(this.TBODY)-1,i,a,l,s,u;if(!(n===o&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;r;)r-=1,l=this.rowFilter.renderedToSource(r),i=this.getRowHeight(l),s=this.getTrForRow(l),u=s.querySelector("th"),u?a=ao(u):a=ao(s)-1,(!i&&this.wtSettings.getSetting("defaultRowHeight")<a||i<a)&&(a+=1,this.dataAccessObject.wtViewport.oversizedRows[l]=a)}}},{key:"getTrForRow",value:function(r){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)]}},{key:"isColumnHeaderRendered",value:function(r){if(r>=0)return!1;var n=this.wtSettings.getSetting("rowHeaders"),o=n.length;return Math.abs(r)<=o}},{key:"isRowHeaderRendered",value:function(r){if(r>=0)return!1;var n=this.wtSettings.getSetting("columnHeaders"),o=n.length;return Math.abs(r)<=o}},{key:"isRowBeforeRenderedRows",value:function(r){var n=this.getFirstRenderedRow();return r<0&&n<=0?!this.isRowHeaderRendered(r):r<n}},{key:"isRowAfterRenderedRows",value:function(r){return r>this.getLastRenderedRow()}},{key:"isColumnBeforeRenderedColumns",value:function(r){var n=this.getFirstRenderedColumn();return r<0&&n<=0?!this.isColumnHeaderRendered(r):r<n}},{key:"isColumnAfterRenderedColumns",value:function(r){return this.columnFilter&&r>this.getLastRenderedColumn()}},{key:"isColumnAfterViewport",value:function(r){return this.columnFilter&&r>this.getLastVisibleColumn()}},{key:"isRowAfterViewport",value:function(r){return this.rowFilter&&r>this.getLastVisibleRow()}},{key:"isColumnBeforeViewport",value:function(r){return this.columnFilter&&this.columnFilter.sourceToRendered(r)<0&&r>=0}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"allRowsInViewport",value:function(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}},{key:"allColumnsInViewport",value:function(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}},{key:"getRowHeight",value:function(r){return this.rowUtils.getHeight(r)}},{key:"getColumnHeaderHeight",value:function(r){return this.columnUtils.getHeaderHeight(r)}},{key:"getColumnWidth",value:function(r){return this.columnUtils.getWidth(r)}},{key:"getStretchedColumnWidth",value:function(r){return this.columnUtils.getStretchedColumnWidth(r)}},{key:"hasDefinedSize",value:function(){return this.hasTableHeight&&this.hasTableWidth}},{key:"getWidth",value:function(){return dt(this.TABLE)}},{key:"getHeight",value:function(){return Rt(this.TABLE)}},{key:"getTotalWidth",value:function(){var r=dt(this.hider);return r!==0?r:this.getWidth()}},{key:"getTotalHeight",value:function(){var r=Rt(this.hider);return r!==0?r:this.getHeight()}},{key:"isVisible",value:function(){return us(this.TABLE)}},{key:"_modifyRowHeaderWidth",value:function(r){var n=bt(r)?r():null;return Array.isArray(n)?(n=ehe(n),n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}},{key:"_correctRowHeaderWidth",value:function(r){var n=r;return typeof r!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}]),e}();const _f=che;var hhe="stickyRowsBottom",hW={getFirstRenderedRow:function(){var t=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsBottom"),n=t-r;return t===0||r===0?-1:n<0?0:n},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Fn(hW,"MIXIN_NAME",hhe,{writable:!1,enumerable:!1});const dW=hW;var dhe="stickyColumnsStart",vW={getFirstRenderedColumn:function(){var t=this.wtSettings.getSetting("totalColumns");return t===0?-1:0},getFirstVisibleColumn:function(){return this.getFirstRenderedColumn()},getLastRenderedColumn:function(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn:function(){return this.getLastRenderedColumn()},getRenderedColumnsCount:function(){var t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount:function(){return this.getRenderedColumnsCount()}};Fn(vW,"MIXIN_NAME",dhe,{writable:!1,enumerable:!1});const RE=vW;function bs(e){"@babel/helpers - typeof";return bs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bs(e)}function YA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,yhe(n.key),n)}}function vhe(e,t,r){return t&&YA(e.prototype,t),r&&YA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function yhe(e){var t=ghe(e,"string");return bs(t)==="symbol"?t:String(t)}function ghe(e,t){if(bs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function phe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mhe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u_(e,t)}function u_(e,t){return u_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},u_(e,t)}function bhe(e){var t=Che();return function(){var n=rp(e),o;if(t){var i=rp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return whe(this,o)}}function whe(e,t){if(t&&(bs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return She(e)}function She(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Che(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function rp(e){return rp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},rp(e)}var EE=function(e){mhe(r,e);var t=bhe(r);function r(n,o,i,a){return phe(this,r),t.call(this,n,o,i,a,di)}return vhe(r)}(_f);pt(EE,dW);pt(EE,RE);const _he=EE;var Da="top",Dn="bottom",Na="inline_start",Ha="top_inline_start_corner",di="bottom_inline_start_corner",Ohe=[Da,Dn,Na,Ha,di],Rhe=new Map([[Da,"ht_clone_".concat(Da)],[Dn,"ht_clone_".concat(Dn)],[Na,"ht_clone_".concat(Na," ht_clone_left")],[Ha,"ht_clone_".concat(Ha," ht_clone_top_left_corner")],[di,"ht_clone_".concat(di," ht_clone_bottom_left_corner")]]);function lh(e){"@babel/helpers - typeof";return lh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lh(e)}function Ehe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,yW(n.key),n)}}function The(e,t,r){return t&&GA(e.prototype,t),r&&GA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Cw(e,t,r){return t=yW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yW(e){var t=Phe(e,"string");return lh(t)==="symbol"?t:String(t)}function Phe(e,t){if(lh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var khe=function(){function e(t){Ehe(this,e),Cw(this,"dataAccessObject",void 0),Cw(this,"lastScrolledColumnPos",-1),Cw(this,"lastScrolledRowPos",-1),this.dataAccessObject=t}return The(e,[{key:"scrollViewport",value:function(r,n,o,i,a){var l=this.scrollViewportHorizontally(r.col,o,a),s=this.scrollViewportVertically(r.row,n,i);return l||s}},{key:"scrollViewportHorizontally",value:function(r,n,o){var i=this.dataAccessObject,a=i.drawn,l=i.totalColumns;if(!a||!Number.isInteger(r)||r<0||r>l)return!1;var s=this.getFirstVisibleColumn(),u=this.getLastVisibleColumn(),f=n===void 0&&o===void 0,c=this.dataAccessObject,h=c.fixedColumnsStart,d=c.inlineStartOverlay;if(f&&r<h)return!1;var v=!1;return s===-1?v=d.scrollTo(r,f?r>this.lastScrolledColumnPos:n):(f&&(r<s||r>u)||!f)&&(v=d.scrollTo(r,f?r>u:n)),v&&(this.lastScrolledColumnPos=r),v}},{key:"scrollViewportVertically",value:function(r,n,o){var i=this.dataAccessObject,a=i.drawn,l=i.totalRows;if(!a||!Number.isInteger(r)||r<0||r>l)return!1;var s=this.getFirstVisibleRow(),u=this.getLastVisibleRow(),f=n===void 0&&o===void 0,c=this.dataAccessObject,h=c.fixedRowsBottom,d=c.fixedRowsTop,v=c.topOverlay;if(f&&(r<d||r>l-h-1))return!1;var g=!1;return s===-1?g=v.scrollTo(r,f?r>this.lastScrolledRowPos:o):(f&&(r<s||r>u)||!f)&&(g=v.scrollTo(r,f?r>u:o)),g&&(this.lastScrolledRowPos=r),g}},{key:"getFirstVisibleRow",value:function(){var r=this.dataAccessObject,n=r.topOverlay,o=r.wtTable,i=r.wtViewport,a=r.totalRows,l=r.fixedRowsTop,s=r.rootWindow,u=o.getFirstVisibleRow();if(n.mainTableScrollableElement===s){var f=Vt(o.wtRootElement),c=ao(o.hider),h=ao(s),d=Lc(s,s);if(f.top+c-h<=d){var v=i.getColumnHeaderHeight();v+=n.sumCellSizes(0,l);for(var g=a;g>0;g--)if(v+=n.sumCellSizes(g-1,g),f.top+c-v<=d){u=g;break}}}return u}},{key:"getLastVisibleRow",value:function(){var r=this.dataAccessObject,n=r.topOverlay,o=r.wtTable,i=r.wtViewport,a=r.totalRows,l=r.rootWindow,s=o.getLastVisibleRow();if(n.mainTableScrollableElement===l){var u=Vt(o.wtRootElement),f=Lc(l,l);if(u.top>f){for(var c=ao(l),h=i.getColumnHeaderHeight(),d=1;d<=a;d++)if(h+=n.sumCellSizes(d-1,d),u.top+h-f>=c){s=d-2;break}}}return s}},{key:"getFirstVisibleColumn",value:function(){var r=this.dataAccessObject,n=r.inlineStartOverlay,o=r.wtTable,i=r.wtViewport,a=r.totalColumns,l=r.rootWindow,s=o.getFirstVisibleColumn();if(n.mainTableScrollableElement===l){var u=Vt(o.wtRootElement),f=bc(o.hider),c=bc(l),h=Math.abs(Vg(l,l));if(u.left+f-c<=h){for(var d=i.getRowHeaderWidth(),v=a;v>0;v--)if(d+=n.sumCellSizes(v-1,v),u.left+f-d<=h){s=v;break}}}return s}},{key:"getLastVisibleColumn",value:function(){var r=this.dataAccessObject,n=r.wtSettings,o=r.inlineStartOverlay,i=r.wtTable,a=r.wtViewport,l=r.totalColumns,s=r.rootWindow,u=i.getLastVisibleColumn();if(o.mainTableScrollableElement===s){var f=n.getSetting("rtlMode"),c=null;if(f){var h=i.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document,v=d.documentElement.offsetWidth;c=Math.abs(h.right-v)}else{var g=Vt(i.wtRootElement);c=g.left}var m=Math.abs(Vg(s,s));if(c>m){for(var w=bc(s),S=a.getRowHeaderWidth(),C=1;C<=l;C++)if(S+=o.sumCellSizes(C-1,C),c+S-m>=w){u=C-2;break}}}return u}}]),e}();const $he=khe;function sh(e){"@babel/helpers - typeof";return sh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sh(e)}function Ahe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gW(n.key),n)}}function Ihe(e,t,r){return t&&KA(e.prototype,t),r&&KA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tn(e,t,r){return t=gW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gW(e){var t=Mhe(e,"string");return sh(t)==="symbol"?t:String(t)}function Mhe(e,t){if(sh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TE=function(){function e(t,r){Ahe(this,e),tn(this,"wtTable",void 0),tn(this,"wtScroll",void 0),tn(this,"wtViewport",void 0),tn(this,"wtOverlays",void 0),tn(this,"selections",void 0),tn(this,"wtEvent",void 0),tn(this,"guid","wt_".concat(sE())),tn(this,"drawInterrupted",!1),tn(this,"drawn",!1),tn(this,"domBindings",void 0),tn(this,"wtSettings",void 0),this.domBindings={rootTable:t,rootDocument:t.ownerDocument,rootWindow:t.ownerDocument.defaultView},this.wtSettings=r,this.wtScroll=new $he(this.createScrollDao())}return Ihe(e,[{key:"eventManager",get:function(){return new Tt(this)}},{key:"findOriginalHeaders",value:function(){var r=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var n=0,o=this.wtTable.THEAD.childNodes[0].childNodes.length;n<o;n++)r.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(i,a){Oi(a,r[i])}])}}},{key:"createCellCoords",value:function(r,n){return new Gg(r,n,this.wtSettings.getSetting("rtlMode"))}},{key:"createCellRange",value:function(r,n,o){return new _E(r,n,o,this.wtSettings.getSetting("rtlMode"))}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!r&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(r),this}},{key:"getCell",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!n)return this.wtTable.getCell(r);var o=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),a=this.wtSettings.getSetting("fixedRowsBottom"),l=this.wtSettings.getSetting("fixedColumnsStart");if(r.row<i&&r.col<l)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(r);if(r.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(r);if(r.col<l&&r.row>=o-a){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(r)}else{if(r.col<l)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(r);if(r.row<o&&r.row>=o-a&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(r)}return this.wtTable.getCell(r)}},{key:"scrollViewport",value:function(r,n,o,i,a){return r.col<0||r.row<0?!1:this.wtScroll.scrollViewport(r,n,o,i,a)}},{key:"scrollViewportHorizontally",value:function(r,n,o){return r<0?!1:this.wtScroll.scrollViewportHorizontally(r,n,o)}},{key:"scrollViewportVertically",value:function(r,n,o){return r<0?!1:this.wtScroll.scrollViewportVertically(r,n,o)}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"destroy",value:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}},{key:"createScrollDao",value:function(){var r=this;return{get drawn(){return r.drawn},get topOverlay(){return r.wtOverlays.topOverlay},get inlineStartOverlay(){return r.wtOverlays.inlineStartOverlay},get wtTable(){return r.wtTable},get wtViewport(){return r.wtViewport},get wtSettings(){return r.wtSettings},get rootWindow(){return r.domBindings.rootWindow},get totalRows(){return r.wtSettings.getSetting("totalRows")},get totalColumns(){return r.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return r.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return r.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return r.wtSettings.getSetting("fixedColumnsStart")}}}},{key:"getTableDao",value:function(){var r=this;return{get wot(){return r},get parentTableOffset(){return r.cloneSource.wtTable.tableOffset},get cloneSource(){return r.cloneSource},get workspaceWidth(){return r.wtViewport.getWorkspaceWidth()},get wtViewport(){return r.wtViewport},get wtOverlays(){return r.wtOverlays},get selections(){return r.selections},get drawn(){return r.drawn},set drawn(n){r.drawn=n},get wtTable(){return r.wtTable},get startColumnRendered(){return r.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return r.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return r.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return r.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return r.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return r.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return r.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return r.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return r.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return r.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return r.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return r.wtViewport.rowsVisibleCalculator.count}}}}]),e}();function ws(e){"@babel/helpers - typeof";return ws=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ws(e)}function qA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pW(n.key),n)}}function xhe(e,t,r){return t&&qA(e.prototype,t),r&&qA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Dhe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Nhe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f_(e,t)}function f_(e,t){return f_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},f_(e,t)}function Hhe(e){var t=jhe();return function(){var n=np(e),o;if(t){var i=np(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Lhe(this,o)}}function Lhe(e,t){if(t&&(ws(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tg(e)}function tg(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jhe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function np(e){return np=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},np(e)}function XA(e,t,r){return t=pW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pW(e){var t=Fhe(e,"string");return ws(t)==="symbol"?t:String(t)}function Fhe(e,t){if(ws(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ws(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Bhe=function(e){Nhe(r,e);var t=Hhe(r);function r(n,o,i){var a;Dhe(this,r),a=t.call(this,n,o),XA(tg(a),"cloneSource",void 0),XA(tg(a),"cloneOverlay",void 0);var l=a.wtSettings.getSetting("facade",tg(a));return a.cloneSource=i.source,a.cloneOverlay=i.overlay,a.wtTable=a.cloneOverlay.createTable(a.getTableDao(),l,a.domBindings,a.wtSettings),a.wtViewport=i.viewport,a.selections=i.selections,a.wtEvent=new lW(l,a.domBindings,a.wtSettings,a.eventManager,a.wtTable,a.selections,i.event),a.findOriginalHeaders(),a}return xhe(r)}(TE);function uh(e){"@babel/helpers - typeof";return uh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uh(e)}function Vhe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mW(n.key),n)}}function Whe(e,t,r){return t&&ZA(e.prototype,t),r&&ZA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Uhe(e,t,r){return t=mW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mW(e){var t=zhe(e,"string");return uh(t)==="symbol"?t:String(t)}function zhe(e,t){if(uh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(uh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bv=function(){function e(t,r,n,o,i){Vhe(this,e),Uhe(this,"wtSettings",null),Fn(this,"wot",t,{writable:!1}),this.domBindings=i,this.facadeGetter=r,this.wtSettings=o;var a=this.wot.wtTable,l=a.TABLE,s=a.hider,u=a.spreader,f=a.holder,c=a.wtRootElement;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=l,this.hider=s,this.spreader=u,this.holder=f,this.wtRootElement=c,this.trimmingContainer=xa(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}return Whe(e,[{key:"updateStateOfRendering",value:function(){var r=this.needFullRender;this.needFullRender=this.shouldBeRendered();var n=r!==this.needFullRender;return n&&!this.needFullRender&&this.reset(),n}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateTrimmingContainer",value:function(){this.trimmingContainer=xa(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function(){var r=this.wot.wtTable,n=this.domBindings.rootWindow;n.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=jc(r.TABLE)}},{key:"getRelativeCellPosition",value:function(r,n,o){if(this.clone.wtTable.holder.contains(r)===!1){ht("The provided element is not a child of the ".concat(this.type," overlay"));return}var i=this.mainTableScrollableElement===this.domBindings.rootWindow,a=o<this.wtSettings.getSetting("fixedColumnsStart"),l=n<this.wtSettings.getSetting("fixedRowsTop"),s=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),u=this.clone.wtTable.spreader,f={start:this.getRelativeStartPosition(u),top:u.offsetTop},c={start:this.getRelativeStartPosition(r),top:r.offsetTop},h=null;return i?h=this.getRelativeCellPositionWithinWindow(l,a,c,f):h=this.getRelativeCellPositionWithinHolder(l,s,a,c,f),h}},{key:"getRelativeStartPosition",value:function(r){return this.isRtl()?r.offsetParent.offsetWidth-r.offsetLeft-r.offsetWidth:r.offsetLeft}},{key:"getRelativeCellPositionWithinWindow",value:function(r,n,o,i){var a=this.wot.wtTable.wtRootElement.getBoundingClientRect(),l=0,s=0;if(!n)l=i.start;else{var u=a.left;this.isRtl()&&(u=this.domBindings.rootWindow.innerWidth-(a.left+a.width+Xt())),l=u<=0?-1*u:0}if(r){var f=this.clone.wtTable.TABLE.getBoundingClientRect();s=f.top-a.top}else s=i.top;return{start:o.start+l,top:o.top+s}}},{key:"getRelativeCellPositionWithinHolder",value:function(r,n,o,i,a){var l={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()},s=0,u=0;if(o||(s=l.horizontal-a.start),n){var f=this.wot.wtTable.wtRootElement.getBoundingClientRect(),c=this.clone.wtTable.TABLE.getBoundingClientRect();u=c.top*-1+f.top}else r||(u=l.vertical-a.top);return{start:i.start-s,top:i.top-u}}},{key:"makeClone",value:function(){if(Ohe.indexOf(this.type)===-1)throw new Error('Clone type "'.concat(this.type,'" is not supported.'));var r=this.wot.wtTable,n=this.domBindings,o=n.rootDocument,i=n.rootWindow,a=o.createElement("DIV"),l=o.createElement("TABLE"),s=r.wtRootElement.parentNode;a.className="".concat(Rhe.get(this.type)," handsontable"),a.setAttribute("dir",this.isRtl()?"rtl":"ltr"),a.style.position="absolute",a.style.top=0,a.style.overflow="visible",this.isRtl()?a.style.right=0:a.style.left=0,l.className=r.TABLE.className,a.appendChild(l),s.appendChild(a);var u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===Da||u==="vertical"&&this.type===Na?this.mainTableScrollableElement=i:i.getComputedStyle(s).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=r.holder:this.mainTableScrollableElement=jc(r.TABLE),new Bhe(l,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selections:this.wot.selections})}},{key:"refresh",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.shouldBeRendered();this.clone&&(this.needFullRender||n)&&this.clone.draw(r),this.needFullRender=n}},{key:"reset",value:function(){if(this.clone){var r=this.clone.wtTable.holder,n=this.clone.wtTable.hider,o=r.style,i=n.style,a=r.parentNode.style;$([o,i,a],function(l){l.width="",l.height=""})}}},{key:"isRtl",value:function(){return this.wtSettings.getSetting("rtlMode")}},{key:"destroy",value:function(){this.clone.eventManager.destroy()}}]),e}();function Ss(e){"@babel/helpers - typeof";return Ss=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ss(e)}function rg(e,t,r){return bW()?rg=Reflect.construct.bind():rg=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&op(u,a.prototype),u},rg.apply(null,arguments)}function Yhe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Khe(n.key),n)}}function Ghe(e,t,r){return t&&QA(e.prototype,t),r&&QA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Khe(e){var t=qhe(e,"string");return Ss(t)==="symbol"?t:String(t)}function qhe(e,t){if(Ss(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ss(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Xhe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&op(e,t)}function op(e,t){return op=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},op(e,t)}function Zhe(e){var t=bW();return function(){var n=ip(e),o;if(t){var i=ip(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Qhe(this,o)}}function Qhe(e,t){if(t&&(Ss(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Jhe(e)}function Jhe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bW(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ip(e){return ip=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ip(e)}var ede=function(e){Xhe(r,e);var t=Zhe(r);function r(n,o,i,a,l,s){var u;return Yhe(this,r),u=t.call(this,n,o,di,i,a),u.bottomOverlay=l,u.inlineStartOverlay=s,u}return Ghe(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return rg(_he,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var o=this.wot;if(this.updateTrimmingContainer(),!o.wtTable.holder.parentNode)return!1;var i=this.clone.wtTable.holder.parentNode;if(i.style.top="",this.trimmingContainer===this.domBindings.rootWindow){var a=this.inlineStartOverlay.getOverlayOffset(),l=this.bottomOverlay.getOverlayOffset();i.style[this.isRtl()?"right":"left"]="".concat(a,"px"),i.style.bottom="".concat(l,"px")}else hv(i),this.repositionOverlay();var s=Rt(this.clone.wtTable.TABLE),u=dt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(s=0),i.style.height="".concat(s,"px"),i.style.width="".concat(u,"px"),!1}},{key:"repositionOverlay",value:function(){var o=this.wot,i=o.wtTable,a=o.wtViewport,l=this.domBindings.rootDocument,s=this.clone.wtTable.holder.parentNode,u=0;a.hasVerticalScroll()||(u+=a.getWorkspaceHeight()-i.getTotalHeight()),a.hasVerticalScroll()&&a.hasHorizontalScroll()&&(u+=Xt(l)),s.style.bottom="".concat(u,"px")}}]),r}(bv),tde="calculatedColumns",wW={getFirstRenderedColumn:function(){var t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn:function(){var t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getLastRenderedColumn:function(){var t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn:function(){var t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getRenderedColumnsCount:function(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount:function(){return this.dataAccessObject.countColumnsVisible}};Fn(wW,"MIXIN_NAME",tde,{writable:!1,enumerable:!1});const PE=wW;function Cs(e){"@babel/helpers - typeof";return Cs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cs(e)}function JA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nde(n.key),n)}}function rde(e,t,r){return t&&JA(e.prototype,t),r&&JA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nde(e){var t=ode(e,"string");return Cs(t)==="symbol"?t:String(t)}function ode(e,t){if(Cs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ide(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ade(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c_(e,t)}function c_(e,t){return c_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},c_(e,t)}function lde(e){var t=fde();return function(){var n=ap(e),o;if(t){var i=ap(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return sde(this,o)}}function sde(e,t){if(t&&(Cs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ude(e)}function ude(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fde(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ap(e){return ap=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ap(e)}var kE=function(e){ade(r,e);var t=lde(r);function r(n,o,i,a){return ide(this,r),t.call(this,n,o,i,a,Dn)}return rde(r)}(_f);pt(kE,dW);pt(kE,PE);const cde=kE;function _s(e){"@babel/helpers - typeof";return _s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_s(e)}function ng(e,t,r){return CW()?ng=Reflect.construct.bind():ng=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&lp(u,a.prototype),u},ng.apply(null,arguments)}function hde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_W(n.key),n)}}function dde(e,t,r){return t&&eI(e.prototype,t),r&&eI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vde(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lp(e,t)}function lp(e,t){return lp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},lp(e,t)}function yde(e){var t=CW();return function(){var n=sp(e),o;if(t){var i=sp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return gde(this,o)}}function gde(e,t){if(t&&(_s(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return SW(e)}function SW(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function CW(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function sp(e){return sp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},sp(e)}function pde(e,t,r){return t=_W(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _W(e){var t=mde(e,"string");return _s(t)==="symbol"?t:String(t)}function mde(e,t){if(_s(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_s(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bde=function(e){vde(r,e);var t=yde(r);function r(n,o,i,a){var l;return hde(this,r),l=t.call(this,n,o,Dn,i,a),pde(SW(l),"cachedFixedRowsBottom",-1),l.cachedFixedRowsBottom=l.wtSettings.getSetting("fixedRowsBottom"),l}return dde(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return ng(cde,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var o=this.domBindings.rootWindow,i=this.clone.wtTable.holder.parentNode;i.style.top="";var a=0,l=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===o&&(!l||l!=="vertical")?(a=this.getOverlayOffset(),i.style.bottom="".concat(a,"px")):(a=this.getScrollPosition(),this.repositionOverlay());var s=this.adjustHeaderBordersPosition(a);return this.adjustElementsSize(),s}},{key:"repositionOverlay",value:function(){var o=this.wot,i=o.wtTable,a=o.wtViewport,l=this.domBindings.rootDocument,s=this.clone.wtTable.holder.parentNode,u=0;a.hasVerticalScroll()||(u+=a.getWorkspaceHeight()-i.getTotalHeight()),a.hasVerticalScroll()&&a.hasHorizontalScroll()&&(u+=Xt(l)),s.style.bottom="".concat(u,"px")}},{key:"setScrollPosition",value:function(o){var i=this.domBindings.rootWindow,a=!1;return this.mainTableScrollableElement===i?(i.scrollTo(Ma(i),o),a=!0):this.mainTableScrollableElement.scrollTop!==o&&(this.mainTableScrollableElement.scrollTop=o,a=!0),a}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(o,i){for(var a=this.wot,l=a.wtTable,s=a.wtSettings,u=s.getSetting("defaultRowHeight"),f=o,c=0;f<i;){var h=l.getRowHeight(f);c+=h===void 0?u:h,f+=1}return c}},{key:"adjustElementsSize",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||o)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var o=this.wot,i=o.wtTable,a=o.wtViewport,l=this.domBindings,s=l.rootDocument,u=l.rootWindow,f=Xt(s),c=this.clone.wtTable.holder.parentNode,h=c.style,d=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==u||d==="horizontal"){var v=a.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(v-=f),v=Math.min(v,i.wtRootElement.scrollWidth),h.width="".concat(v,"px")}else h.width="";this.clone.wtTable.holder.style.width=h.width;var g=Rt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(g=0),h.height="".concat(g,"px")}},{key:"adjustRootChildrenSize",value:function(){var o=this.clone.wtTable.holder;this.clone.wtTable.hider.style.width=this.hider.style.width,o.style.width=o.parentNode.style.width,o.style.height=o.parentNode.style.height}},{key:"applyToDOM",value:function(){var o=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(o===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var o=this.isRtl()?"right":"left",i=this.clone.wtTable.spreader;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?i.style[o]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):i.style[o]=""}},{key:"scrollTo",value:function(o,i){var a=this.getTableParentOffset(),l=this.wot.cloneSource?this.wot.cloneSource:this.wot,s=l.wtTable.holder,u=0;i&&s.offsetHeight!==s.clientHeight&&(u=Xt(this.domBindings.rootDocument)),i?(a+=this.sumCellSizes(0,o+1),a-=this.wot.wtViewport.getViewportHeight(),a+=1):a+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),o),a+=u,this.setScrollPosition(a)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return Lc(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var o=this.domBindings.rootWindow,i=this.wtSettings.getSetting("preventOverflow"),a=0;if(this.trimmingContainer===o&&(!i||i!=="vertical")){var l=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),u=l-s,f=this.domBindings.rootDocument.documentElement.clientHeight;a=Math.max(this.getTableParentOffset()-this.getScrollPosition()-f+l,0),a>u&&(a=0)}return a}},{key:"adjustHeaderBordersPosition",value:function(o){var i=this.wtSettings.getSetting("fixedRowsBottom"),a=this.cachedFixedRowsBottom!==i,l=this.wtSettings.getSetting("columnHeaders"),s=!1;if((a||i===0)&&l.length>0){var u=this.wot.wtTable.holder.parentNode,f=xe(u,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),o||this.wtSettings.getSetting("totalRows")===0?(re(u,"innerBorderBottom"),s=!f):(Le(u,"innerBorderBottom"),s=f)}return s}}]),r}(bv),wde="calculatedRows",OW={getFirstRenderedRow:function(){var t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow:function(){var t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getLastRenderedRow:function(){var t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow:function(){var t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getRenderedRowsCount:function(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount:function(){return this.dataAccessObject.countRowsVisible}};Fn(OW,"MIXIN_NAME",wde,{writable:!1,enumerable:!1});const RW=OW;function Os(e){"@babel/helpers - typeof";return Os=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Os(e)}function tI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Cde(n.key),n)}}function Sde(e,t,r){return t&&tI(e.prototype,t),r&&tI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Cde(e){var t=_de(e,"string");return Os(t)==="symbol"?t:String(t)}function _de(e,t){if(Os(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Os(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ode(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Rde(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h_(e,t)}function h_(e,t){return h_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},h_(e,t)}function Ede(e){var t=kde();return function(){var n=up(e),o;if(t){var i=up(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Tde(this,o)}}function Tde(e,t){if(t&&(Os(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Pde(e)}function Pde(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kde(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function up(e){return up=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},up(e)}var $E=function(e){Rde(r,e);var t=Ede(r);function r(n,o,i,a){return Ode(this,r),t.call(this,n,o,i,a,Na)}return Sde(r)}(_f);pt($E,RW);pt($E,RE);const $de=$E;function Rs(e){"@babel/helpers - typeof";return Rs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rs(e)}function og(e,t,r){return EW()?og=Reflect.construct.bind():og=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&fp(u,a.prototype),u},og.apply(null,arguments)}function Ade(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Mde(n.key),n)}}function Ide(e,t,r){return t&&rI(e.prototype,t),r&&rI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Mde(e){var t=xde(e,"string");return Rs(t)==="symbol"?t:String(t)}function xde(e,t){if(Rs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Dde(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fp(e,t)}function fp(e,t){return fp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},fp(e,t)}function Nde(e){var t=EW();return function(){var n=cp(e),o;if(t){var i=cp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Hde(this,o)}}function Hde(e,t){if(t&&(Rs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Lde(e)}function Lde(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function EW(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function cp(e){return cp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},cp(e)}var jde=function(e){Dde(r,e);var t=Nde(r);function r(n,o,i,a){return Ade(this,r),t.call(this,n,o,Na,i,a)}return Ide(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return og($de,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var o=this.wot.wtTable;if(!this.needFullRender||!o.holder.parentNode)return!1;var i=this.domBindings.rootWindow,a=this.clone.wtTable.holder.parentNode,l=this.wtSettings.getSetting("preventOverflow"),s=0;this.trimmingContainer===i&&(!l||l!=="horizontal")?(s=this.getOverlayOffset()*(this.isRtl()?-1:1),km(a,"".concat(s,"px"),"0px")):(s=this.getScrollPosition(),hv(a));var u=this.adjustHeaderBordersPosition(s);return this.adjustElementsSize(),u}},{key:"setScrollPosition",value:function(o){var i=this.domBindings.rootWindow,a=!1;return this.isRtl()&&(o=-o),this.mainTableScrollableElement===i&&i.scrollX!==o?(i.scrollTo(o,fs(i)),a=!0):this.mainTableScrollableElement.scrollLeft!==o&&(this.mainTableScrollableElement.scrollLeft=o,a=!0),a}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(o,i){for(var a=this.wtSettings.getSetting("defaultColumnWidth"),l=o,s=0;l<i;)s+=this.wot.wtTable.getStretchedColumnWidth(l)||a,l+=1;return s}},{key:"adjustElementsSize",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||o)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var o=this.wot.wtTable,i=this.domBindings,a=i.rootDocument,l=i.rootWindow,s=Xt(a),u=this.clone.wtTable.holder.parentNode,f=u.style,c=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==l||c==="vertical"){var h=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(h-=s),h=Math.min(h,o.wtRootElement.scrollHeight),f.height="".concat(h,"px")}else f.height="";this.clone.wtTable.holder.style.height=f.height;var d=dt(this.clone.wtTable.TABLE);f.width="".concat(d,"px")}},{key:"adjustRootChildrenSize",value:function(){var o,i=this.clone.wtTable.holder,a=this.wot.selections,l=this.facadeGetter(),s=Math.abs((o=a==null?void 0:a.getCell().getBorder(l).cornerCenterPointOffset)!==null&&o!==void 0?o:0);this.clone.wtTable.hider.style.height=this.hider.style.height,i.style.height=i.parentNode.style.height,i.style.width="".concat(parseInt(i.parentNode.style.width,10)+s,"px")}},{key:"applyToDOM",value:function(){var o=this.wtSettings.getSetting("totalColumns"),i=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[i]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px");else if(o===0)this.spreader.style[i]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.top=""}},{key:"scrollTo",value:function(o,i){var a=this.getTableParentOffset(),l=this.wot.cloneSource?this.wot.cloneSource:this.wot,s=l.wtTable.holder,u=0;if(i){var f=this.wot.wtTable.getColumnWidth(o),c=this.wot.wtViewport.getViewportWidth();f>c&&(i=!1)}return i&&s.offsetWidth!==s.clientWidth&&(u=Xt(this.domBindings.rootDocument)),i?(a+=this.sumCellSizes(0,o+1),a-=this.wot.wtViewport.getViewportWidth()):a+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),o),a+=u,this.setScrollPosition(a)}},{key:"getTableParentOffset",value:function(){var o=this.wtSettings.getSetting("preventOverflow"),i=0;return!o&&this.trimmingContainer===this.domBindings.rootWindow&&(i=this.wot.wtTable.holderOffset.left),i}},{key:"getScrollPosition",value:function(){return Math.abs(Vg(this.mainTableScrollableElement,this.domBindings.rootWindow))}},{key:"getOverlayOffset",value:function(){var o=this.domBindings.rootWindow,i=this.wtSettings.getSetting("preventOverflow"),a=0;if(this.trimmingContainer===o&&(!i||i!=="horizontal")){this.isRtl()?a=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):a=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);var l=this.wot.wtTable.getTotalWidth(),s=this.clone.wtTable.getTotalWidth(),u=l-s;a>u&&(a=0)}return a}},{key:"adjustHeaderBordersPosition",value:function(o){var i=this.wot.wtTable.holder.parentNode,a=this.wtSettings.getSetting("rowHeaders"),l=this.wtSettings.getSetting("fixedColumnsStart"),s=this.wtSettings.getSetting("totalRows");s?Le(i,"emptyRows"):re(i,"emptyRows");var u=!1;if(l&&!a.length)re(i,"innerBorderLeft innerBorderInlineStart");else if(!l&&a.length){var f=xe(i,"innerBorderInlineStart");o?(re(i,"innerBorderLeft innerBorderInlineStart"),u=!f):(Le(i,"innerBorderLeft innerBorderInlineStart"),u=f)}return u}}]),r}(bv),Fde="stickyRowsTop",TW={getFirstRenderedRow:function(){var t=this.wtSettings.getSetting("totalRows");return t===0?-1:0},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.getRenderedRowsCount()-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Fn(TW,"MIXIN_NAME",Fde,{writable:!1,enumerable:!1});const PW=TW;function Es(e){"@babel/helpers - typeof";return Es=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Es(e)}function nI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Vde(n.key),n)}}function Bde(e,t,r){return t&&nI(e.prototype,t),r&&nI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vde(e){var t=Wde(e,"string");return Es(t)==="symbol"?t:String(t)}function Wde(e,t){if(Es(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Es(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ude(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zde(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d_(e,t)}function d_(e,t){return d_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},d_(e,t)}function Yde(e){var t=qde();return function(){var n=hp(e),o;if(t){var i=hp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Gde(this,o)}}function Gde(e,t){if(t&&(Es(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Kde(e)}function Kde(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qde(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function hp(e){return hp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},hp(e)}var AE=function(e){zde(r,e);var t=Yde(r);function r(n,o,i,a){return Ude(this,r),t.call(this,n,o,i,a,Ha)}return Bde(r)}(_f);pt(AE,PW);pt(AE,RE);const Xde=AE;function Ts(e){"@babel/helpers - typeof";return Ts=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ts(e)}function ig(e,t,r){return kW()?ig=Reflect.construct.bind():ig=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&dp(u,a.prototype),u},ig.apply(null,arguments)}function Zde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$W(n.key),n)}}function Qde(e,t,r){return t&&oI(e.prototype,t),r&&oI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jde(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dp(e,t)}function dp(e,t){return dp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},dp(e,t)}function eve(e){var t=kW();return function(){var n=vp(e),o;if(t){var i=vp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return tve(this,o)}}function tve(e,t){if(t&&(Ts(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return v_(e)}function v_(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kW(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vp(e){return vp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vp(e)}function iI(e,t,r){return t=$W(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $W(e){var t=rve(e,"string");return Ts(t)==="symbol"?t:String(t)}function rve(e,t){if(Ts(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ts(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var nve=function(e){Jde(r,e);var t=eve(r);function r(n,o,i,a,l,s){var u;return Zde(this,r),u=t.call(this,n,o,Ha,i,a),iI(v_(u),"topOverlay",void 0),iI(v_(u),"inlineStartOverlay",void 0),u.topOverlay=l,u.inlineStartOverlay=s,u}return Qde(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return ig(Xde,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;var o=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){var i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),a=this.topOverlay.getOverlayOffset();km(o,"".concat(i,"px"),"".concat(a,"px"))}else hv(o);var l=Rt(this.clone.wtTable.TABLE),s=dt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(l=0),o.style.height="".concat(l,"px"),o.style.width="".concat(s,"px"),!1}}]),r}(bv);function Ps(e){"@babel/helpers - typeof";return Ps=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ps(e)}function aI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ive(n.key),n)}}function ove(e,t,r){return t&&aI(e.prototype,t),r&&aI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ive(e){var t=ave(e,"string");return Ps(t)==="symbol"?t:String(t)}function ave(e,t){if(Ps(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ps(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sve(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y_(e,t)}function y_(e,t){return y_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},y_(e,t)}function uve(e){var t=hve();return function(){var n=yp(e),o;if(t){var i=yp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return fve(this,o)}}function fve(e,t){if(t&&(Ps(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cve(e)}function cve(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hve(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yp(e){return yp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yp(e)}var IE=function(e){sve(r,e);var t=uve(r);function r(n,o,i,a){return lve(this,r),t.call(this,n,o,i,a,Da)}return ove(r)}(_f);pt(IE,PW);pt(IE,PE);const dve=IE;function ks(e){"@babel/helpers - typeof";return ks=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ks(e)}function ag(e,t,r){return IW()?ag=Reflect.construct.bind():ag=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&gp(u,a.prototype),u},ag.apply(null,arguments)}function vve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,MW(n.key),n)}}function yve(e,t,r){return t&&lI(e.prototype,t),r&&lI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gve(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gp(e,t)}function gp(e,t){return gp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},gp(e,t)}function pve(e){var t=IW();return function(){var n=pp(e),o;if(t){var i=pp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return mve(this,o)}}function mve(e,t){if(t&&(ks(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return AW(e)}function AW(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function IW(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function pp(e){return pp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},pp(e)}function bve(e,t,r){return t=MW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function MW(e){var t=wve(e,"string");return ks(t)==="symbol"?t:String(t)}function wve(e,t){if(ks(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ks(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Sve=function(e){gve(r,e);var t=pve(r);function r(n,o,i,a){var l;return vve(this,r),l=t.call(this,n,o,Da,i,a),bve(AW(l),"cachedFixedRowsTop",-1),l.cachedFixedRowsTop=l.wtSettings.getSetting("fixedRowsTop"),l}return yve(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return ag(dve,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var o=this.clone.wtTable.holder.parentNode,i=this.domBindings.rootWindow,a=this.wtSettings.getSetting("preventOverflow"),l=0,s=!1;if(this.trimmingContainer===i&&(!a||a!=="vertical")){var u=this.wot.wtTable,f=u.hider.getBoundingClientRect(),c=Math.ceil(f.bottom),h=o.offsetHeight;s=c===h,l=this.getOverlayOffset(),km(o,"0px","".concat(l,"px"))}else l=this.getScrollPosition(),hv(o);var d=this.adjustHeaderBordersPosition(l,s);return this.adjustElementsSize(),d}},{key:"setScrollPosition",value:function(o){var i=this.domBindings.rootWindow,a=!1;return this.mainTableScrollableElement===i&&i.scrollY!==o?(i.scrollTo(Ma(i),o),a=!0):this.mainTableScrollableElement.scrollTop!==o&&(this.mainTableScrollableElement.scrollTop=o,a=!0),a}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(o,i){for(var a=this.wtSettings.getSetting("defaultRowHeight"),l=o,s=0;l<i;){var u=this.wot.wtTable.getRowHeight(l);s+=u===void 0?a:u,l+=1}return s}},{key:"adjustElementsSize",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||o)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var o=this.wot.wtTable,i=this.domBindings,a=i.rootDocument,l=i.rootWindow,s=Xt(a),u=this.clone.wtTable.holder.parentNode,f=u.style,c=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==l||c==="horizontal"){var h=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(h-=s),h=Math.min(h,o.wtRootElement.scrollWidth),f.width="".concat(h,"px")}else f.width="";this.clone.wtTable.holder.style.width=f.width;var d=Rt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(d=0),f.height="".concat(d,"px")}},{key:"adjustRootChildrenSize",value:function(){var o,i=this.clone.wtTable.holder,a=this.wot.selections,l=this.facadeGetter(),s=Math.abs((o=a==null?void 0:a.getCell().getBorder(l).cornerCenterPointOffset)!==null&&o!==void 0?o:0);this.clone.wtTable.hider.style.width=this.hider.style.width,i.style.width=i.parentNode.style.width,i.style.height="".concat(parseInt(i.parentNode.style.height,10)+s,"px")}},{key:"applyToDOM",value:function(){var o=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(o===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var o=this.isRtl()?"right":"left",i=this.clone.wtTable.spreader;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?i.style[o]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):i.style[o]=""}},{key:"scrollTo",value:function(o,i){var a=this.wot,l=this.wtSettings,s=a.cloneSource?a.cloneSource:a,u=s.wtTable.holder,f=this.getTableParentOffset(),c=0;if(i){var h=this.wot.wtTable.getRowHeight(o),d=this.wot.wtViewport.getViewportHeight();h>d&&(i=!1)}if(i&&u.offsetHeight!==u.clientHeight&&(c=Xt(this.domBindings.rootDocument)),i){var v=l.getSetting("fixedRowsBottom"),g=l.getSetting("totalRows");f+=this.sumCellSizes(0,o+1),f-=a.wtViewport.getViewportHeight()-this.sumCellSizes(g-v,g),f+=1}else f+=this.sumCellSizes(l.getSetting("fixedRowsTop"),o);return f+=c,this.setScrollPosition(f)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return Lc(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var o=this.domBindings.rootWindow,i=this.wtSettings.getSetting("preventOverflow"),a=0;if(this.trimmingContainer===o&&(!i||i!=="vertical")){var l=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),u=l-s;a=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),a>u&&(a=0)}return a}},{key:"adjustHeaderBordersPosition",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=this.wot.wtTable.holder.parentNode,l=this.wtSettings.getSetting("totalColumns");l?Le(a,"emptyColumns"):re(a,"emptyColumns");var s=!1;if(!i){var u=this.wtSettings.getSetting("fixedRowsTop"),f=this.cachedFixedRowsTop!==u,c=this.wtSettings.getSetting("columnHeaders");if((f||u===0)&&c.length>0){var h=xe(a,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),o||this.wtSettings.getSetting("totalRows")===0?(re(a,"innerBorderTop"),s=!h):(Le(a,"innerBorderTop"),s=h)}}return s}}]),r}(bv);function fh(e){"@babel/helpers - typeof";return fh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fh(e)}function oi(e,t,r){return Cve()?oi=Reflect.construct.bind():oi=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&g_(u,a.prototype),u},oi.apply(null,arguments)}function Cve(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function g_(e,t){return g_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},g_(e,t)}function _ve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xW(n.key),n)}}function Ove(e,t,r){return t&&sI(e.prototype,t),r&&sI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Yn(e,t,r){return t=xW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xW(e){var t=Rve(e,"string");return fh(t)==="symbol"?t:String(t)}function Rve(e,t){if(fh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Eve=function(){function e(t,r,n,o,i,a){var l=this;_ve(this,e),Yn(this,"wot",null),Yn(this,"topOverlay",null),Yn(this,"bottomOverlay",null),Yn(this,"inlineStartOverlay",null),Yn(this,"topInlineStartCornerOverlay",null),Yn(this,"bottomInlineStartCornerOverlay",null),Yn(this,"browserLineHeight",void 0),Yn(this,"wtSettings",null),Yn(this,"resizeObserver",new ResizeObserver(function(h){dm(function(){!Array.isArray(h)||!h.length||l.wtSettings.getSetting("onContainerElementResize")})})),this.wot=t,this.wtSettings=o,this.domBindings=n,this.facadeGetter=r,this.wtTable=a;var s=this.domBindings,u=s.rootDocument,f=s.rootWindow;this.instance=this.wot,this.eventManager=i,this.scrollbarSize=Xt(u);var c=f.getComputedStyle(a.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=c?a.holder:jc(a.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=f.scrollX,this.lastScrollY=f.scrollY}return Ove(e,[{key:"getOverlays",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return r&&n.push(this.wtTable),n}},{key:"initBrowserLineHeight",value:function(){var r=this.domBindings,n=r.rootWindow,o=r.rootDocument,i=n.getComputedStyle(o.body),a=parseInt(i.lineHeight,10),l=parseInt(i.fontSize,10)*1.2;this.browserLineHeight=a||l}},{key:"initOverlays",value:function(){var r=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=oi(Sve,r),this.bottomOverlay=oi(bde,r),this.inlineStartOverlay=oi(jde,r),this.topInlineStartCornerOverlay=oi(nve,r.concat([this.topOverlay,this.inlineStartOverlay])),this.bottomInlineStartCornerOverlay=oi(ede,r.concat([this.bottomOverlay,this.inlineStartOverlay]))}},{key:"updateStateOfRendering",value:function(){var r=this.topOverlay.updateStateOfRendering();return r=this.bottomOverlay.updateStateOfRendering()||r,r=this.inlineStartOverlay.updateStateOfRendering()||r,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(r=this.topInlineStartCornerOverlay.updateStateOfRendering()||r),this.bottomOverlay.needFullRender&&(r=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||r)),r}},{key:"refreshAll",value:function(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}},{key:"registerListeners",value:function(){var r=this,n=this.domBindings,o=n.rootDocument,i=n.rootWindow,a=this.topOverlay.mainTableScrollableElement,l=this.inlineStartOverlay.mainTableScrollableElement;this.eventManager.addEventListener(o.documentElement,"keydown",function(v){return r.onKeyDown(v)}),this.eventManager.addEventListener(o.documentElement,"keyup",function(){return r.onKeyUp()}),this.eventManager.addEventListener(o,"visibilitychange",function(){return r.onKeyUp()}),this.eventManager.addEventListener(a,"scroll",function(v){return r.onTableScroll(v)},{passive:!0}),a!==l&&this.eventManager.addEventListener(l,"scroll",function(v){return r.onTableScroll(v)},{passive:!0});var s=i.devicePixelRatio&&i.devicePixelRatio>1,u=this.scrollableElement===i,f=this.wtSettings.getSetting("preventWheel"),c={passive:u};(f||s||!L0())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",function(v){return r.onCloneWheel(v,f)},c);var h=[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];h.forEach(function(v){if(v&&v.needFullRender){var g=v.clone.wtTable.holder;r.eventManager.addEventListener(g,"wheel",function(m){return r.onCloneWheel(m,f)},c)}});var d;this.eventManager.addEventListener(i,"resize",function(){clearTimeout(d),d=setTimeout(function(){r.wtSettings.getSetting("onWindowResize")},200)}),u||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}},{key:"deregisterListeners",value:function(){this.eventManager.clearEvents(!0)}},{key:"onTableScroll",value:function(r){var n=this.domBindings.rootWindow,o=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,a=r.target;this.keyPressed&&(i!==n&&a!==n&&!r.target.contains(i)||o!==n&&a!==n&&!r.target.contains(o))||this.syncScrollPositions(r)}},{key:"onCloneWheel",value:function(r,n){var o=this.domBindings.rootWindow,i=this.inlineStartOverlay.mainTableScrollableElement,a=this.topOverlay.mainTableScrollableElement,l=r.target,s=a!==o&&l!==o&&!l.contains(a),u=i!==o&&l!==o&&!l.contains(i);if(!(this.keyPressed&&(s||u))){var f=this.translateMouseWheelToScroll(r);(n||this.scrollableElement!==o&&f)&&r.preventDefault()}}},{key:"onKeyDown",value:function(r){this.keyPressed=hs(r.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(r){var n=isNaN(r.deltaY)?-1*r.wheelDeltaY:r.deltaY,o=isNaN(r.deltaX)?-1*r.wheelDeltaX:r.deltaX;r.deltaMode===1&&(o+=o*this.browserLineHeight,n+=n*this.browserLineHeight);var i=this.scrollVertically(n),a=this.scrollHorizontally(o);return i||a}},{key:"scrollVertically",value:function(r){var n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=r,n!==this.scrollableElement.scrollTop}},{key:"scrollHorizontally",value:function(r){var n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=r,n!==this.scrollableElement.scrollLeft}},{key:"syncScrollPositions",value:function(){if(!this.destroyed){var r=this.domBindings.rootWindow,n=this.topOverlay.clone.wtTable.holder,o=this.inlineStartOverlay.clone.wtTable.holder,i=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop],a=i[0],l=i[1];if(this.horizontalScrolling=n.scrollLeft!==a||this.lastScrollX!==r.scrollX,this.verticalScrolling=o.scrollTop!==l||this.lastScrollY!==r.scrollY,this.lastScrollX=r.scrollX,this.lastScrollY=r.scrollY,this.horizontalScrolling){n.scrollLeft=a;var s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;s&&(s.scrollLeft=a)}this.verticalScrolling&&(o.scrollTop=l),this.refreshAll()}}},{key:"syncScrollWithMaster",value:function(){var r=this.topOverlay.mainTableScrollableElement,n=r.scrollLeft,o=r.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=o)}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();var r=this.wtTable,n=this.domBindings.rootWindow;n.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=r.holder:this.scrollableElement=jc(r.TABLE),this.registerListeners()}},{key:"destroy",value:function(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}},{key:"refresh",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.updateLastSpreaderSize();n&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(r),this.inlineStartOverlay.refresh(r),this.topOverlay.refresh(r),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(r),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(r)}},{key:"updateLastSpreaderSize",value:function(){var r=this.wtTable.spreader,n=r.clientWidth,o=r.clientHeight,i=n!==this.spreaderLastSize.width||o!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=o),i}},{key:"adjustElementsSize",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wot.wtViewport,o=this.wtTable,i=this.wtSettings.getSetting("totalColumns"),a=this.wtSettings.getSetting("totalRows"),l=n.getRowHeaderWidth(),s=n.getColumnHeaderHeight(),u=o.hider.style;if(u.width="".concat(l+this.inlineStartOverlay.sumCellSizes(0,i),"px"),u.height="".concat(s+this.topOverlay.sumCellSizes(0,a)+1,"px"),this.scrollbarSize>0){var f=o.wtRootElement,c=f.scrollHeight,h=f.scrollWidth,d=o.holder,v=d.scrollHeight,g=d.scrollWidth;this.hasScrollbarRight=c<v,this.hasScrollbarBottom=h<g,this.hasScrollbarRight&&o.hider.scrollWidth+this.scrollbarSize>h?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&o.hider.scrollHeight+this.scrollbarSize>c&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(r),this.inlineStartOverlay.adjustElementsSize(r),this.bottomOverlay.adjustElementsSize(r)}},{key:"applyToDOM",value:function(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}},{key:"getParentOverlay",value:function(r){if(!r)return null;var n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],o=null;return $(n,function(i){i&&i.clone&&i.clone.wtTable.TABLE.contains(r)&&(o=i.clone)}),o}},{key:"syncOverlayTableClassNames",value:function(){var r=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];$(n,function(o){o&&(o.clone.wtTable.TABLE.className=r.className)})}}]),e}();const Tve=Eve;function ch(e){"@babel/helpers - typeof";return ch=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ch(e)}function Pve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,DW(n.key),n)}}function kve(e,t,r){return t&&uI(e.prototype,t),r&&uI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fI(e,t,r){return t=DW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function DW(e){var t=$ve(e,"string");return ch(t)==="symbol"?t:String(t)}function $ve(e,t){if(ch(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ch(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ave=function(){function e(t){var r=this;Pve(this,e),fI(this,"settings",{}),fI(this,"defaults",Object.freeze(this.getDefaults())),We(this.defaults,function(n,o){if(t[o]!==void 0)r.settings[o]=t[o];else{if(n===void 0)throw new Error('A required setting "'.concat(o,'" was not provided'));r.settings[o]=n}})}return kve(e,[{key:"getDefaults",value:function(){var r=this;return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:function(){return r.getSetting("fixedColumnsStart")>0||r.getSetting("rowHeaders").length>0},shouldRenderTopOverlay:function(){return r.getSetting("fixedRowsTop")>0||r.getSetting("columnHeaders").length>0},shouldRenderBottomOverlay:function(){return r.getSetting("fixedRowsBottom")>0},minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(o,i,a){var l=r.getSetting("data",o,i);Oi(a,l??"")},columnWidth:function(){},rowHeight:function(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(o){return o},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:function(o){return o},onBeforeHighlightingColumnHeader:function(o){return o},onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1}}},{key:"update",value:function(r,n){var o=this;return n===void 0?We(r,function(i,a){o.settings[a]=i}):this.settings[r]=n,this}},{key:"getSetting",value:function(r,n,o,i,a){return typeof this.settings[r]=="function"?this.settings[r](n,o,i,a):n!==void 0&&Array.isArray(this.settings[r])?this.settings[r][n]:this.settings[r]}},{key:"getSettingPure",value:function(r){return this.settings[r]}},{key:"has",value:function(r){return!!this.settings[r]}}]),e}();function $s(e){"@babel/helpers - typeof";return $s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$s(e)}function Ive(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xve(n.key),n)}}function Mve(e,t,r){return t&&cI(e.prototype,t),r&&cI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xve(e){var t=Dve(e,"string");return $s(t)==="symbol"?t:String(t)}function Dve(e,t){if($s(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($s(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Nve(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p_(e,t)}function p_(e,t){return p_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},p_(e,t)}function Hve(e){var t=Fve();return function(){var n=mp(e),o;if(t){var i=mp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Lve(this,o)}}function Lve(e,t){if(t&&($s(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jve(e)}function jve(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Fve(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mp(e){return mp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},mp(e)}var ME=function(e){Nve(r,e);var t=Hve(r);function r(n,o,i,a){return Ive(this,r),t.call(this,n,o,i,a,"master")}return Mve(r,[{key:"alignOverlaysWithTrimmingContainer",value:function(){var o=xa(this.wtRootElement),i=this.domBindings.rootWindow;if(o===i){var a=this.wtSettings.getSetting("preventOverflow");a||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{var l=o.parentElement,s=cs(o,"height",i),u=cs(o,"overflow",i),f=this.holder.style,c=o.scrollWidth,h=o.scrollHeight,d=o.getBoundingClientRect(),v=d.width,g=d.height,m=["auto","hidden","scroll"];if(l&&m.includes(u)){var w=o.cloneNode(!1);w.style.overflow="auto",w.style.position="absolute",o.nextElementSibling?l.insertBefore(w,o.nextElementSibling):l.appendChild(w);var S=parseInt(Ri(w,i).height,10);l.removeChild(w),S===0&&(g=0)}g=Math.min(g,h),f.height=s==="auto"?"auto":"".concat(g,"px"),v=Math.min(v,c),f.width="".concat(v,"px"),f.overflow="",this.hasTableHeight=f.height==="auto"?!0:g>0,this.hasTableWidth=v>0}this.isTableVisible=us(this.TABLE)}},{key:"markOversizedColumnHeaders",value:function(){var o=this.wtSettings,i=this.dataAccessObject.wtViewport,a="master",l=o.getSetting("columnHeaders"),s=l.length;if(s&&!i.hasOversizedColumnHeadersMarked[a]){for(var u=o.getSetting("rowHeaders"),f=u.length,c=this.getRenderedColumnsCount(),h=0;h<s;h++)for(var d=-1*f;d<c;d++)this.markIfOversizedColumnHeader(d);i.hasOversizedColumnHeadersMarked[a]=!0}}}]),r}(_f);pt(ME,RW);pt(ME,PE);const Bve=ME;function hh(e){"@babel/helpers - typeof";return hh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hh(e)}function Vve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Uve(n.key),n)}}function Wve(e,t,r){return t&&hI(e.prototype,t),r&&hI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Uve(e){var t=zve(e,"string");return hh(t)==="symbol"?t:String(t)}function zve(e,t){if(hh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Yve=function(){function e(t,r,n,o,i){var a=this;Vve(this,e),this.dataAccessObject=t,this.wot=t.wot,this.instance=this.wot,this.domBindings=r,this.wtSettings=n,this.wtTable=i,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=o,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",function(){a.clientHeight=a.getWorkspaceHeight()})}return Wve(e,[{key:"getWorkspaceHeight",value:function(){var r=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer,o=0;if(n===this.domBindings.rootWindow)o=r.documentElement.clientHeight;else{var i=Rt(n);o=i>0&&n.clientHeight>0?n.clientHeight:1/0}return o}},{key:"getWorkspaceWidth",value:function(){var r=this.wtSettings,n=this.domBindings,o=n.rootDocument,i=n.rootWindow,a=this.dataAccessObject.inlineStartOverlayTrimmingContainer,l=o.documentElement.offsetWidth,s=r.getSetting("totalColumns"),u=r.getSetting("preventOverflow"),f=r.getSetting("rtlMode"),c=this.wtTable.TABLE.getBoundingClientRect(),h=f?c.right-l:c.left,d=l-h,v,g;if(u)return dt(this.wtTable.wtRootElement);if(r.getSetting("freezeOverlays")?v=Math.min(d,l):v=Math.min(this.getContainerFillWidth(),d,l),a===i&&s>0&&this.sumColumnWidths(0,s-1)>v)return o.documentElement.clientWidth;if(a!==i&&(g=cs(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",i),g==="scroll"||g==="hidden"||g==="auto"))return Math.max(v,a.clientWidth);var m=r.getSetting("stretchH");return m==="none"||!m?Math.max(v,dt(this.wtTable.TABLE)):v}},{key:"hasVerticalScroll",value:function(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(r,n){for(var o=0,i=r;i<n;)o+=this.wtTable.getColumnWidth(i),i+=1;return o}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var r=this.wtTable.holder,n=this.domBindings.rootDocument.createElement("div");n.style.width="100%",n.style.height="1px",r.appendChild(n);var o=n.offsetWidth;return this.containerWidth=o,r.removeChild(n),o}},{key:"getWorkspaceOffset",value:function(){return Vt(this.wtTable.TABLE)}},{key:"getColumnHeaderHeight",value:function(){var r=this.wtSettings.getSetting("columnHeaders");return r.length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Rt(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var r=this.getWorkspaceHeight();if(r===1/0)return r;var n=this.getColumnHeaderHeight();return n>0&&(r-=n),r}},{key:"getRowHeaderWidth",value:function(){var r=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(r){this.rowHeaderWidth=0;for(var o=0,i=n.length;o<i;o++)this.rowHeaderWidth+=r[o]||r}if(isNaN(this.rowHeaderWidth))if(n.length){var a=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var l=0,s=n.length;l<s;l++)a?(this.rowHeaderWidth+=dt(a),a=a.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var r=this.getWorkspaceWidth();if(r===1/0)return r;var n=this.getRowHeaderWidth();return n>0?r-n:r}},{key:"createRowsCalculator",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ji,n=this.wtSettings,o=this.wtTable,i,a,l;this.rowHeaderWidth=NaN,n.getSetting("renderAllRows")&&r===Ji?i=1/0:i=this.getViewportHeight();var s=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset,u=n.getSetting("fixedRowsTop"),f=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return u&&s>=0&&(l=this.dataAccessObject.topOverlay.sumCellSizes(0,u),s+=l,i-=l),f&&this.dataAccessObject.bottomOverlay.clone&&(l=this.dataAccessObject.bottomOverlay.sumCellSizes(c-f,c),i-=l),o.holder.clientHeight===o.holder.offsetHeight?a=0:a=Xt(this.domBindings.rootDocument),new ZV({viewportSize:i,scrollOffset:s,totalItems:n.getSetting("totalRows"),itemSizeFn:function(d){return o.getRowHeight(d)},overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),calculationType:r,scrollbarHeight:a})}},{key:"createColumnsCalculator",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ji,n=this.wtSettings,o=this.wtTable,i=this.getViewportWidth(),a=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;var l=n.getSetting("fixedColumnsStart");if(l&&a>=0){var s=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,l);a+=s,i-=s}return o.holder.clientWidth!==o.holder.offsetWidth&&(i-=Xt(this.domBindings.rootDocument)),new CE({viewportSize:i,scrollOffset:a,totalItems:n.getSetting("totalColumns"),itemSizeFn:function(f){return o.getColumnWidth(f)},overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),calculationType:r,stretchMode:n.getSetting("stretchH"),stretchingItemWidthFn:function(f,c){return n.getSetting("onBeforeStretchingColumnWidth",f,c)},inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}},{key:"createRenderCalculators",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=r;if(n){var o=this.createRowsCalculator(or),i=this.createColumnsCalculator(or);this.areAllProposedVisibleRowsAlreadyRendered(o)&&this.areAllProposedVisibleColumnsAlreadyRendered(i)||(n=!1)}return n||(this.rowsRenderCalculator=this.createRowsCalculator(Ji),this.columnsRenderCalculator=this.createColumnsCalculator(Ji)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,n}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(or),this.columnsVisibleCalculator=this.createColumnsCalculator(or)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(r){if(!this.rowsVisibleCalculator)return!1;var n=r.startRow,o=r.endRow,i=r.isVisibleInTrimmingContainer;if(n===null&&o===null)return!i;var a=this.rowsRenderCalculator,l=a.startRow,s=a.endRow;return n<l||n===l&&n>0?!1:!(o>s||o===s&&o<this.wtSettings.getSetting("totalRows")-1)}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(r){if(!this.columnsVisibleCalculator)return!1;var n=r.startColumn,o=r.endColumn,i=r.isVisibleInTrimmingContainer;if(n===null&&o===null)return!i;var a=this.columnsRenderCalculator,l=a.startColumn,s=a.endColumn;return n<l||n===l&&n>0?!1:!(o>s||o===s&&o<this.wtSettings.getSetting("totalColumns")-1)}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){We(this.hasOversizedColumnHeadersMarked,function(r,n,o){o[n]=void 0})}}]),e}();const Gve=Yve;function As(e){"@babel/helpers - typeof";return As=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},As(e)}function Kve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Xve(n.key),n)}}function qve(e,t,r){return t&&dI(e.prototype,t),r&&dI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Xve(e){var t=Zve(e,"string");return As(t)==="symbol"?t:String(t)}function Zve(e,t){if(As(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(As(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Qve(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m_(e,t)}function m_(e,t){return m_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},m_(e,t)}function Jve(e){var t=tye();return function(){var n=bp(e),o;if(t){var i=bp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return eye(this,o)}}function eye(e,t){if(t&&(As(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return b_(e)}function b_(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tye(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bp(e){return bp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bp(e)}var rye=function(e){Qve(r,e);var t=Jve(r);function r(n,o){var i;Kve(this,r),i=t.call(this,n,new Ave(o));var a=i.wtSettings.getSetting("facade",b_(i));return i.wtTable=new Bve(i.getTableDao(),a,i.domBindings,i.wtSettings),i.wtViewport=new Gve(i.getViewportDao(),i.domBindings,i.wtSettings,i.eventManager,i.wtTable),i.selections=i.wtSettings.getSetting("selections"),i.wtEvent=new lW(a,i.domBindings,i.wtSettings,i.eventManager,i.wtTable,i.selections),i.wtOverlays=new Tve(b_(i),a,i.domBindings,i.wtSettings,i.eventManager,i.wtTable),i.exportSettingsAsClassNames(),i.findOriginalHeaders(),i}return qve(r,[{key:"exportSettingsAsClassNames",value:function(){var o=this,i={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},a=[],l=[];We(i,function(s,u){o.wtSettings.getSetting(u).length&&l.push(s),a.push(s)}),Le(this.wtTable.wtRootElement.parentNode,a),re(this.wtTable.wtRootElement.parentNode,l)}},{key:"getViewportDao",value:function(){var o=this;return{get wot(){return o},get topOverlayTrimmingContainer(){return o.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return o.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return o.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return o.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return o.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return o.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return o.wtOverlays.topOverlay},get inlineStartOverlay(){return o.wtOverlays.inlineStartOverlay},get bottomOverlay(){return o.wtOverlays.bottomOverlay}}}}]),r}(TE);function dh(e){"@babel/helpers - typeof";return dh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dh(e)}function nye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,iye(n.key),n)}}function oye(e,t,r){return t&&vI(e.prototype,t),r&&vI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function iye(e){var t=aye(e,"string");return dh(t)==="symbol"?t:String(t)}function aye(e,t){if(dh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(dh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lye=function(){function e(t){nye(this,e),t instanceof TE?this._wot=t:this._initFromSettings(t)}return oye(e,[{key:"_initFromSettings",value:function(r){r.facade=function(n){var o=new e(n);return function(){return o}},this._wot=new rye(r.table,r)}},{key:"guid",get:function(){return this._wot.guid}},{key:"rootDocument",get:function(){return this._wot.domBindings.rootDocument}},{key:"rootWindow",get:function(){return this._wot.domBindings.rootWindow}},{key:"wtSettings",get:function(){return this._wot.wtSettings}},{key:"cloneSource",get:function(){return this._wot.cloneSource}},{key:"cloneOverlay",get:function(){return this._wot.cloneOverlay}},{key:"selections",get:function(){return this._wot.selections}},{key:"wtViewport",get:function(){return this._wot.wtViewport}},{key:"wtOverlays",get:function(){return this._wot.wtOverlays}},{key:"wtTable",get:function(){return this._wot.wtTable}},{key:"wtEvent",get:function(){return this._wot.wtEvent}},{key:"wtScroll",get:function(){return this._wot.wtScroll}},{key:"drawn",get:function(){return this._wot.drawn},set:function(r){this._wot.drawn=r}},{key:"drawInterrupted",get:function(){return this._wot.drawInterrupted},set:function(r){this._wot.drawInterrupted=r}},{key:"lastMouseOver",get:function(){return this._wot.lastMouseOver},set:function(r){this._wot.lastMouseOver=r}},{key:"momentumScrolling",get:function(){return this._wot.momentumScrolling},set:function(r){this._wot.momentumScrolling=r}},{key:"touchApplied",get:function(){return this._wot.touchApplied},set:function(r){this._wot.touchApplied=r}},{key:"domBindings",get:function(){return this._wot.domBindings}},{key:"eventListeners",get:function(){return this._wot.eventListeners},set:function(r){this._wot.eventListeners=r}},{key:"eventManager",get:function(){return this._wot.eventManager}},{key:"createCellCoords",value:function(r,n){return this._wot.createCellCoords(r,n)}},{key:"createCellRange",value:function(r,n,o){return this._wot.createCellRange(r,n,o)}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(r),this}},{key:"getCell",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(r,n)}},{key:"scrollViewport",value:function(r,n,o,i,a){return this._wot.scrollViewport(r,n,o,i,a)}},{key:"scrollViewportHorizontally",value:function(r,n,o){return this._wot.scrollViewportHorizontally(r,n,o)}},{key:"scrollViewportVertically",value:function(r,n,o){return this._wot.scrollViewportVertically(r,n,o)}},{key:"getViewport",value:function(){return this._wot.getViewport()}},{key:"getOverlayName",value:function(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}},{key:"exportSettingsAsClassNames",value:function(){return this._wot.exportSettingsAsClassNames()}},{key:"update",value:function(r,n){return this._wot.wtSettings.update(r,n),this}},{key:"getSetting",value:function(r,n,o,i,a){return this._wot.wtSettings.getSetting(r,n,o,i,a)}},{key:"hasSetting",value:function(r){return this._wot.wtSettings.hasSetting(r)}},{key:"destroy",value:function(){this._wot.destroy()}}]),e}(),NW=Ut,sye=je,HW=Ue,uye=rv,fye=Yd,cye=Br,hye=Hd.f,LW=HW(hye),dye=HW([].push),vye=NW&&sye(function(){var e=Object.create(null);return e[2]=2,!LW(e,2)}),yI=function(e){return function(t){for(var r=cye(t),n=fye(r),o=vye&&uye(r)===null,i=n.length,a=0,l=[],s;i>a;)s=n[a++],(!NW||(o?s in r:LW(r,s)))&&dye(l,e?[s,r[s]]:r[s]);return l}},yye={entries:yI(!0),values:yI(!1)},gye=$e,pye=yye.values;gye({target:"Object",stat:!0},{values:function(t){return pye(t)}});function vh(e){"@babel/helpers - typeof";return vh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vh(e)}function _w(e,t){return Sye(e)||wye(e,t)||bye(e,t)||mye()}function mye(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bye(e,t){if(e){if(typeof e=="string")return gI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return gI(e,t)}}function gI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function wye(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Sye(e){if(Array.isArray(e))return e}function Cye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Oye(n.key),n)}}function _ye(e,t,r){return t&&pI(e.prototype,t),r&&pI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Oye(e){var t=Rye(e,"string");return vh(t)==="symbol"?t:String(t)}function Rye(e,t){if(vh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Eye=function(){function e(t,r){Cye(this,e),r&&(this.eventManager=t.eventManager,this.instance=t,this.wot=t,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}return _ye(e,[{key:"registerListeners",value:function(){var r=this,n=this.wot.rootDocument.body;this.eventManager.addEventListener(n,"mousedown",function(){return r.onMouseDown()}),this.eventManager.addEventListener(n,"mouseup",function(){return r.onMouseUp()});for(var o=function(s){var u=r.main.childNodes[s];r.eventManager.addEventListener(u,"mouseenter",function(f){return r.onMouseEnter(f,r.main.childNodes[s])})},i=0,a=this.main.childNodes.length;i<a;i++)o(i)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(r,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;r.preventDefault(),gn(r);var o=this,i=this.wot.rootDocument.body,a=n.getBoundingClientRect();n.style.display="none";function l(u){if(u.clientY<Math.floor(a.top)||u.clientY>Math.ceil(a.top+a.height)||u.clientX<Math.floor(a.left)||u.clientX>Math.ceil(a.left+a.width))return!0}function s(u){l(u)&&(o.eventManager.removeEventListener(i,"mousemove",s),n.style.display="block")}this.eventManager.addEventListener(i,"mousemove",s)}},{key:"createBorders",value:function(r){var n=this.wot.rootDocument;this.main=n.createElement("div");var o=["top","start","bottom","end","corner"],i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(var a=0;a<5;a++){var l=o[a],s=n.createElement("div");s.className="wtBorder ".concat(this.settings.className||""),this.settings[l]&&this.settings[l].hide&&(s.className+=" hidden"),i=s.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:r.border.color,i.height=this.settings[l]&&this.settings[l].width?"".concat(this.settings[l].width,"px"):"".concat(r.border.width,"px"),i.width=this.settings[l]&&this.settings[l].width?"".concat(this.settings[l].width,"px"):"".concat(r.border.width,"px"),this.main.appendChild(s)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),fn()&&this.createMultipleSelectorHandles(),this.disappear();var u=this.wot.wtTable,f=u.bordersHolder;f||(f=n.createElement("div"),f.className="htBorders",u.bordersHolder=f,u.spreader.appendChild(f)),f.appendChild(this.main)}},{key:"createMultipleSelectorHandles",value:function(){var r=this,n=this.wot.rootDocument;this.selectionHandles={top:n.createElement("DIV"),topHitArea:n.createElement("DIV"),bottom:n.createElement("DIV"),bottomHitArea:n.createElement("DIV")};var o=10,i=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};var a={position:"absolute",height:"".concat(i,"px"),width:"".concat(i,"px"),"border-radius":"".concat(parseInt(i/1.5,10),"px")};We(a,function(s,u){r.selectionHandles.styles.bottomHitArea[u]=s,r.selectionHandles.styles.topHitArea[u]=s});var l={position:"absolute",height:"".concat(o,"px"),width:"".concat(o,"px"),"border-radius":"".concat(parseInt(o/1.5,10),"px"),background:"#F5F5FF",border:"1px solid #4285c8"};We(l,function(s,u){r.selectionHandles.styles.bottom[u]=s,r.selectionHandles.styles.top[u]=s}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}},{key:"isPartRange",value:function(r,n){var o=this.wot.selections.createOrGetArea();return!!(o.cellRange&&(r!==o.cellRange.to.row||n!==o.cellRange.to.col))}},{key:"updateMultipleSelectionHandlesPosition",value:function(r,n,o,i,a,l){var s=this.wot.wtSettings.getSetting("rtlMode"),u=s?"right":"left",f=this.selectionHandles.styles,c=f.top,h=f.topHitArea,d=f.bottom,v=f.bottomHitArea,g=parseInt(c.borderWidth,10),m=parseInt(c.width,10),w=parseInt(h.width,10),S=this.wot.wtTable.getWidth(),C=this.wot.wtTable.getHeight();c.top="".concat(parseInt(o-m-1,10),"px"),c[u]="".concat(parseInt(i-m-1,10),"px"),h.top="".concat(parseInt(o-w/4*3,10),"px"),h[u]="".concat(parseInt(i-w/4*3,10),"px");var P=Math.min(parseInt(i+a,10),S-m-g*2),R=Math.min(parseInt(i+a-w/4,10),S-w-g*2);d[u]="".concat(P,"px"),v[u]="".concat(R,"px");var V=Math.min(parseInt(o+l,10),C-m-g*2),U=Math.min(parseInt(o+l-w/4,10),C-w-g*2);d.top="".concat(V,"px"),v.top="".concat(U,"px"),this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(c.display="block",h.display="block",this.isPartRange(r,n)?(d.display="none",v.display="none"):(d.display="block",v.display="block")):(c.display="none",d.display="none",h.display="none",v.display="none"),r===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(c.zIndex="9999",h.zIndex="9999"):(c.zIndex="",h.zIndex="")}},{key:"appear",value:function(r){if(!this.disabled){for(var n=this.wot,o=n.wtTable,i=n.rootDocument,a=n.rootWindow,l,s,u,f,c,h,d=o.getRenderedRowsCount(),v=0;v<d;v+=1){var g=o.rowFilter.renderedToSource(v);if(g>=r[0]&&g<=r[2]){l=g,c=r[0];break}}for(var m=d-1;m>=0;m-=1){var w=o.rowFilter.renderedToSource(m);if(w>=r[0]&&w<=r[2]){s=w;break}}for(var S=o.getRenderedColumnsCount(),C=0;C<S;C+=1){var P=o.columnFilter.renderedToSource(C);if(P>=r[1]&&P<=r[3]){u=P,h=r[1];break}}for(var R=S-1;R>=0;R-=1){var V=o.columnFilter.renderedToSource(R);if(V>=r[1]&&V<=r[3]){f=V;break}}if(l===void 0||u===void 0){this.disappear();return}var U=o.getCell(this.wot.createCellCoords(l,u)),X=l!==s||u!==f,Y=X?o.getCell(this.wot.createCellCoords(s,f)):U,q=Vt(U),Z=X?Vt(Y):q,ie=Vt(o.TABLE),Q=dt(o.TABLE),le=q.top,Se=q.left,me=this.wot.wtSettings.getSetting("rtlMode"),Ce=0,k=0;if(me){var y=dt(U),p=a.innerWidth-ie.left-Q;k=Se+y-Z.left,Ce=a.innerWidth-Se-y-p-1}else k=Z.left+dt(Y)-Se,Ce=Se-ie.left-1;if(this.isEntireColumnSelected(l,s)){var b=this.getDimensionsFromHeader("columns",u,f,c,ie),_=null;if(b){var T=_w(b,3);_=T[0],Ce=T[1],k=T[2]}_&&(U=_)}var I=le-ie.top-1,F=Z.top+Rt(Y)-le;if(this.isEntireRowSelected(u,f)){var W=this.getDimensionsFromHeader("rows",l,s,h,ie),G=null;if(W){var J=_w(W,3);G=J[0],I=J[1],F=J[2]}G&&(U=G)}var ee=Ri(U,a);parseInt(ee.borderTopWidth,10)>0&&(I+=1,F=F>0?F-1:0),parseInt(ee[me?"borderRightWidth":"borderLeftWidth"],10)>0&&(Ce+=1,k=k>0?k-1:0);var se=me?"right":"left";this.topStyle.top="".concat(I,"px"),this.topStyle[se]="".concat(Ce,"px"),this.topStyle.width="".concat(k,"px"),this.topStyle.display="block",this.startStyle.top="".concat(I,"px"),this.startStyle[se]="".concat(Ce,"px"),this.startStyle.height="".concat(F,"px"),this.startStyle.display="block";var Re=Math.floor(this.settings.border.width/2);this.bottomStyle.top="".concat(I+F-Re,"px"),this.bottomStyle[se]="".concat(Ce,"px"),this.bottomStyle.width="".concat(k,"px"),this.bottomStyle.display="block",this.endStyle.top="".concat(I,"px"),this.endStyle[se]="".concat(Ce+k-Re,"px"),this.endStyle.height="".concat(F+1,"px"),this.endStyle.display="block";var ce=this.settings.border.cornerVisible;ce=typeof ce=="function"?ce(this.settings.layerLevel):ce;var de=this.wot.getSetting("onModifyGetCellCoords",s,f),K=s,Me=f;if(de&&Array.isArray(de)){var Ge=_w(de,4);K=Ge[2],Me=Ge[3]}if(fn()||!ce||this.isPartRange(K,Me))this.cornerStyle.display="none";else{this.cornerStyle.top="".concat(I+F+this.cornerCenterPointOffset-1,"px"),this.cornerStyle[se]="".concat(Ce+k+this.cornerCenterPointOffset-1,"px"),this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";var Pe=xa(o.TABLE),Ae=Pe===a;Ae&&(Pe=i.documentElement);var ke=parseInt(this.cornerDefaultStyle.width,10)/2,O=parseInt(this.cornerDefaultStyle.height,10)/2;if(f===this.wot.getSetting("totalColumns")-1){var E=Ae?Y.getBoundingClientRect().left:Y.offsetLeft,A=!1,H=0;me?(H=E-parseInt(this.cornerDefaultStyle.width,10)/2,A=H<0):(H=E+dt(Y)+parseInt(this.cornerDefaultStyle.width,10)/2,A=H>=bc(Pe)),A&&(this.cornerStyle[se]="".concat(Math.floor(Ce+k+this.cornerCenterPointOffset-ke),"px"),this.cornerStyle[me?"borderLeftWidth":"borderRightWidth"]=0)}if(s===this.wot.getSetting("totalRows")-1){var M=Ae?Y.getBoundingClientRect().top:Y.offsetTop,j=M+Rt(Y)+parseInt(this.cornerDefaultStyle.height,10)/2,x=j>=ao(Pe);x&&(this.cornerStyle.top="".concat(Math.floor(I+F+this.cornerCenterPointOffset-O),"px"),this.cornerStyle.borderBottomWidth=0)}this.cornerStyle.display="block"}fn()&&this.updateMultipleSelectionHandlesPosition(s,f,I,Ce,k,F)}}},{key:"isEntireColumnSelected",value:function(r,n){return r===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}},{key:"isEntireRowSelected",value:function(r,n){return r===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}},{key:"getDimensionsFromHeader",value:function(r,n,o,i,a){var l=this.wot.wtTable,s=l.wtRootElement.parentNode,u=null,f=null,c=null,h=null,d=null,v=null,g=null,m=null;switch(r){case"rows":u=function(){return l.getRowHeader.apply(l,arguments)},f=function(){return Rt.apply(void 0,arguments)},c="ht__selection--rows",v="top";break;case"columns":u=function(){return l.getColumnHeader.apply(l,arguments)},f=function(){return dt.apply(void 0,arguments)},c="ht__selection--columns",v="left";break}if(s.classList.contains(c)){var w=this.wot.getSetting("columnHeaders").length;if(g=u(n,w-i),m=u(o,w-i),!g||!m)return!1;var S=Vt(g),C=Vt(m);return g&&m&&(h=S[v]-a[v]-1,d=C[v]+f(m)-S[v]),[g,h,d]}return!1}},{key:"changeBorderStyle",value:function(r,n){var o=this[r].style,i=n[r];!i||i.hide?re(this[r],"hidden"):(xe(this[r],"hidden")&&Le(this[r],"hidden"),o.backgroundColor=i.color,(r==="top"||r==="bottom")&&(o.height="".concat(i.width,"px")),(r==="start"||r==="end")&&(o.width="".concat(i.width,"px")))}},{key:"changeBorderToDefaultStyle",value:function(r){var n={width:1,color:"#000"},o=this[r].style;o.backgroundColor=n.color,o.width="".concat(n.width,"px"),o.height="".concat(n.width,"px")}},{key:"toggleHiddenClass",value:function(r,n){this.changeBorderToDefaultStyle(r),n?re(this[r],"hidden"):Le(this[r],"hidden")}},{key:"disappear",value:function(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",fn()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}},{key:"destroy",value:function(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}]),e}();const Tye=Eye;function Pye(e,t){return Iye(e)||Aye(e,t)||$ye(e,t)||kye()}function kye(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $ye(e,t){if(e){if(typeof e=="string")return mI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mI(e,t)}}function mI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Aye(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Iye(e){if(Array.isArray(e))return e}function Is(e){"@babel/helpers - typeof";return Is=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Is(e)}function Mye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Dye(n.key),n)}}function xye(e,t,r){return t&&bI(e.prototype,t),r&&bI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Dye(e){var t=Nye(e,"string");return Is(t)==="symbol"?t:String(t)}function Nye(e,t){if(Is(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Is(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Hye=function(){function e(t,r){Mye(this,e),this.settings=t,this.cellRange=r||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}return xye(e,[{key:"getBorder",value:function(r){return this.instanceBorders[r.guid]||(this.instanceBorders[r.guid]=new Tye(r,this.settings)),this.instanceBorders[r.guid]}},{key:"isEmpty",value:function(){return this.cellRange===null}},{key:"add",value:function(r){return this.isEmpty()?this.cellRange=this.settings.createCellRange(r):this.cellRange.expand(r),this}},{key:"replace",value:function(r,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(r))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(r))return this.cellRange.to=n,!0}return!1}},{key:"clear",value:function(){return this.cellRange=null,this}},{key:"getCorners",value:function(){var r=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[r.row,r.col,n.row,n.col]}},{key:"addClassAtCoords",value:function(r,n,o,i){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,l=r.wtTable.getCell(this.settings.createCellCoords(n,o));if(Is(l)==="object"){var s=i;a&&(s=this.classNameGenerator(l),this.classNames.includes(s)||this.classNames.push(s)),re(l,s)}return this}},{key:"linearClassNameGenerator",value:function(r,n){return function o(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;if(n===0||a===0)return r;var l=a>=0?a:n,s=r;l-=1;var u=l===0?r:"".concat(r,"-").concat(l);if(xe(i,u)){var f=l+1;s="".concat(r,"-").concat(f)}else s=o(i,l);return s}}},{key:"draw",value:function(r){if(this.isEmpty()){this.settings.border&&this.getBorder(r).disappear();return}var n=r.wtTable.getRenderedRowsCount(),o=r.wtTable.getRenderedColumnsCount(),i=this.getCorners(),a=Pye(i,4),l=a[0],s=a[1],u=a[2],f=a[3],c=this.settings,h=c.highlightHeaderClassName,d=c.highlightColumnClassName,v=c.highlightRowClassName,g=c.highlightOnlyClosestHeader,m=c.selectionType,w=m===void 0||["active-header","header"].includes(m);if(w&&s!==null&&f!==null)for(var S=0,C=0;C<o;C+=1){var P=r.wtTable.columnFilter.renderedToSource(C);if(P>=s&&P<=f){var R=r.wtTable.getColumnHeaders(P),V=R.length-1;g&&R.length>1&&(R=[R[V]]);for(var U=0;U<R.length;U+=1){var X=[],Y=R[U];h&&X.push(h),d&&X.push(d),U=g?V:U;var q=r.getSetting("onBeforeHighlightingColumnHeader",P,U,{selectionType:m,columnCursor:S,selectionWidth:f-s+1,classNames:X});q!==P&&(Y=r.wtTable.getColumnHeader(q,U)),re(Y,X)}S+=1}}if(l!==null&&u!==null)for(var Z=0,ie=0;ie<n;ie+=1){var Q=r.wtTable.rowFilter.renderedToSource(ie);if(w&&Q>=l&&Q<=u){var le=r.wtTable.getRowHeaders(Q),Se=le.length-1;g&&le.length>1&&(le=[le[Se]]);for(var me=0;me<le.length;me+=1){var Ce=[],k=le[me];h&&Ce.push(h),v&&Ce.push(v),me=g?Se:me;var y=r.getSetting("onBeforeHighlightingRowHeader",Q,me,{selectionType:m,rowCursor:Z,selectionHeight:u-l+1,classNames:Ce});y!==Q&&(k=r.wtTable.getRowHeader(y,me)),re(k,Ce)}Z+=1}if(s!==null&&f!==null)for(var p=0;p<o;p+=1){var b=r.wtTable.columnFilter.renderedToSource(p);Q>=l&&Q<=u&&b>=s&&b<=f?this.settings.className&&this.addClassAtCoords(r,Q,b,this.settings.className,this.settings.markIntersections):Q>=l&&Q<=u?v&&this.addClassAtCoords(r,Q,b,v):b>=s&&b<=f&&d&&this.addClassAtCoords(r,Q,b,d);var _=r.getSetting("onAfterDrawSelection",Q,b,this.settings.layerLevel);typeof _=="string"&&this.addClassAtCoords(r,Q,b,_)}}r.getSetting("onBeforeDrawBorders",i,this.settings.className),this.settings.border&&this.getBorder(r).appear(i)}},{key:"destroy",value:function(){Object.values(this.instanceBorders).forEach(function(r){return r.destroy()})}}]),e}();const Lye=Hye;function wI(e){var t=e.isShiftKey,r=e.isLeftClick,n=e.isRightClick,o=e.coords,i=e.selection,a=e.controller,l=e.cellCoordsFactory,s=i.isSelected()?i.getSelectedRange().current():null,u=i.isSelectedByCorner(),f=i.isSelectedByRowHeader();if(t&&s)o.row>=0&&o.col>=0&&!a.cell?i.setRangeEnd(o):(u||f)&&o.row>=0&&o.col>=0&&!a.cell?i.setRangeEnd(l(o.row,o.col)):u&&o.row<0&&!a.column?i.setRangeEnd(l(s.to.row,o.col)):f&&o.col<0&&!a.row?i.setRangeEnd(l(o.row,s.to.col)):(!u&&!f&&o.col<0||u&&o.col<0)&&!a.row?i.selectRows(Math.max(s.from.row,0),o.row,o.col):(!u&&!f&&o.row<0||f&&o.row<0)&&!a.column&&i.selectColumns(Math.max(s.from.col,0),o.col,o.row);else{var c=!i.inInSelection(o),h=r||n&&c;o.row<0&&o.col>=0&&!a.column?h&&i.selectColumns(o.col,o.col,o.row):o.col<0&&o.row>=0&&!a.row?h&&i.selectRows(o.row,o.row,o.col):o.col>=0&&o.row>=0&&!a.cell?h&&i.setRangeStart(o):o.col<0&&o.row<0&&i.selectAll(!0,!0)}}function jye(e){var t=e.isLeftClick,r=e.coords,n=e.selection,o=e.controller,i=e.cellCoordsFactory;if(t){var a=n.isSelectedByRowHeader(),l=n.isSelectedByColumnHeader(),s=n.tableProps.countCols(),u=n.tableProps.countRows();l&&!o.column?n.setRangeEnd(i(u-1,r.col)):a&&!o.row?n.setRangeEnd(i(r.row,s-1)):o.cell||n.setRangeEnd(r)}}var Fye=new Map([["mousedown",wI],["mouseover",jye],["touchstart",wI]]);function SI(e,t){var r=t.coords,n=t.selection,o=t.controller,i=t.cellCoordsFactory;Fye.get(e.type)({coords:r,selection:n,controller:o,cellCoordsFactory:i,isShiftKey:e.shiftKey,isLeftClick:Am(e)||e.type==="touchstart",isRightClick:Ei(e)})}var jW=new WeakMap,xE=Symbol("rootInstance");function Bye(e){jW.set(e,!0)}function Vye(e){return e===xE}function w_(e){return jW.has(e)}function yh(e){"@babel/helpers - typeof";return yh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yh(e)}function Ff(e,t){return zye(e)||Uye(e,t)||FW(e,t)||Wye()}function Wye(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Uye(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function zye(e){if(Array.isArray(e))return e}function CI(e){return Kye(e)||Gye(e)||FW(e)||Yye()}function Yye(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function FW(e,t){if(e){if(typeof e=="string")return S_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return S_(e,t)}}function Gye(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Kye(e){if(Array.isArray(e))return S_(e)}function S_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function qye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _I(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,BW(n.key),n)}}function Xye(e,t,r){return t&&_I(e.prototype,t),r&&_I(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function OI(e,t,r){Zye(e,t),t.set(e,r)}function Zye(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zo(e,t,r){return t=BW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function BW(e){var t=Qye(e,"string");return yh(t)==="symbol"?t:String(t)}function Qye(e,t){if(yh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function RI(e,t){var r=VW(e,t,"get");return Jye(e,r)}function Jye(e,t){return t.get?t.get.call(e):t.value}function EI(e,t,r){var n=VW(e,t,"set");return ege(e,n,r),r}function VW(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function ege(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Fi=new WeakMap,Ow=new WeakMap,Rw=new WeakMap,tge=function(){function e(t){qye(this,e),zo(this,"instance",void 0),zo(this,"eventManager",void 0),zo(this,"settings",void 0),zo(this,"THEAD",void 0),zo(this,"TBODY",void 0),zo(this,"_wt",void 0),zo(this,"activeWt",void 0),OI(this,Ow,{writable:!0,value:0}),OI(this,Rw,{writable:!0,value:0}),zo(this,"postponedAdjustElementsSize",!1),this.instance=t,this.eventManager=new Tt(this.instance),this.settings=this.instance.getSettings(),Fi.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}return Xye(e,[{key:"render",value:function(){this.instance.isRenderSuspended()||(this.instance.runHooks("beforeRender",this.instance.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.instance.forceFullRender),this.instance.runHooks("afterRender",this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}},{key:"adjustElementsSize",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(r)}},{key:"getCellAtCoords",value:function(r,n){var o=this._wt.getCell(r,n);return o<0?null:o}},{key:"scrollViewport",value:function(r,n,o,i,a){return this._wt.scrollViewport(r,n,o,i,a)}},{key:"scrollViewportHorizontally",value:function(r,n,o){return this._wt.scrollViewportHorizontally(r,n,o)}},{key:"scrollViewportVertically",value:function(r,n,o){return this._wt.scrollViewportVertically(r,n,o)}},{key:"createElements",value:function(){var r=Fi.get(this),n=this.instance,o=n.rootElement,i=n.rootDocument,a=o.getAttribute("style");a&&o.setAttribute("data-originalstyle",a),re(o,"handsontable"),r.table=i.createElement("TABLE"),re(r.table,"htCore"),this.instance.getSettings().tableClassName&&re(r.table,this.instance.getSettings().tableClassName),this.THEAD=i.createElement("THEAD"),r.table.appendChild(this.THEAD),this.TBODY=i.createElement("TBODY"),r.table.appendChild(this.TBODY),this.instance.table=r.table,this.instance.container.insertBefore(r.table,this.instance.container.firstChild)}},{key:"registerEvents",value:function(){var r=this,n=Fi.get(this),o=this.instance,i=o.rootElement,a=o.rootDocument,l=o.selection,s=a.documentElement;this.eventManager.addEventListener(i,"mousedown",function(u){if(n.selectionMouseDown=!0,!r.isTextSelectionAllowed(u.target)){var f=r.instance.rootWindow;LC(f),u.preventDefault(),f.focus()}}),this.eventManager.addEventListener(i,"mouseup",function(){n.selectionMouseDown=!1}),this.eventManager.addEventListener(i,"mousemove",function(u){n.selectionMouseDown&&!r.isTextSelectionAllowed(u.target)&&(r.settings.fragmentSelection&&LC(r.instance.rootWindow),u.preventDefault())}),this.eventManager.addEventListener(s,"keyup",function(u){l.isInProgress()&&!u.shiftKey&&l.finish()}),this.eventManager.addEventListener(s,"mouseup",function(u){l.isInProgress()&&Am(u)&&l.finish(),n.mouseDown=!1,($m(a.activeElement)||!l.isSelected()&&!l.isSelectedByAnyHeader()&&!i.contains(u.target)&&!Ei(u))&&r.instance.unlisten()}),this.eventManager.addEventListener(s,"contextmenu",function(u){l.isInProgress()&&Ei(u)&&(l.finish(),n.mouseDown=!1)}),this.eventManager.addEventListener(s,"touchend",function(){l.isInProgress()&&l.finish(),n.mouseDown=!1}),this.eventManager.addEventListener(s,"mousedown",function(u){var f=u.target,c=u.x||u.clientX,h=u.y||u.clientY,d=u.target;if(!(n.mouseDown||!i||!r.instance.view)){var v=r.instance.view._wt.wtTable.holder;if(d===v){var g=Xt(a);if(a.elementFromPoint(c+g,h)!==v||a.elementFromPoint(c,h+g)!==v)return}else for(;d!==s;){if(d===null){if(u.isTargetWebComponent)break;return}if(d===i)return;d=d.parentNode}var m=typeof r.settings.outsideClickDeselects=="function"?r.settings.outsideClickDeselects(f):r.settings.outsideClickDeselects;m?r.instance.deselectCell():r.instance.destroyEditor(!1,!1)}}),this.eventManager.addEventListener(n.table,"selectstart",function(u){r.settings.fragmentSelection||Fc(u.target)||u.preventDefault()})}},{key:"translateFromRenderableToVisualCoords",value:function(r){var n,o=r.row,i=r.col;return(n=this.instance)._createCellCoords.apply(n,CI(this.translateFromRenderableToVisualIndex(o,i)))}},{key:"translateFromRenderableToVisualIndex",value:function(r,n){var o=r>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(r):r,i=n>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(n):n;return o===null&&(o=r),i===null&&(i=n),[o,i]}},{key:"countRenderableIndexes",value:function(r,n){var o=Math.min(r.getNotTrimmedIndexesLength(),n),i=r.getNearestNotHiddenIndex(o-1,-1);return i===null?0:r.getRenderableFromVisualIndex(i)+1}},{key:"countRenderableColumns",value:function(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}},{key:"countRenderableRows",value:function(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}},{key:"countNotHiddenRowIndexes",value:function(r,n){return this.countNotHiddenIndexes(r,n,this.instance.rowIndexMapper,this.countRenderableRows())}},{key:"countNotHiddenColumnIndexes",value:function(r,n){return this.countNotHiddenIndexes(r,n,this.instance.columnIndexMapper,this.countRenderableColumns())}},{key:"countNotHiddenIndexes",value:function(r,n,o,i){if(isNaN(r)||r<0)return 0;var a=o.getNearestNotHiddenIndex(r,n),l=o.getRenderableFromVisualIndex(a);if(!Number.isInteger(l))return 0;var s=0;return n<0?s=l+1:n>0&&(s=i-l),s}},{key:"countNotHiddenFixedColumnsStart",value:function(){var r=this.instance.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),r)-1;return this.countNotHiddenColumnIndexes(n,-1)}},{key:"countNotHiddenFixedRowsTop",value:function(){var r=this.instance.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),r)-1;return this.countNotHiddenRowIndexes(n,-1)}},{key:"countNotHiddenFixedRowsBottom",value:function(){var r=this.instance.countRows(),n=Math.max(r-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}},{key:"isMainTableNotFullyCoveredByOverlays",value:function(){var r=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.instance.countRenderedRows()>r&&this.instance.countRenderedCols()>n}},{key:"initializeWalkontable",value:function(){var r=this,n=Fi.get(this),o={rtlMode:this.instance.isRtl(),externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:n.table,isDataViewInstance:function(){return w_(r.instance)},preventOverflow:function(){return r.settings.preventOverflow},preventWheel:function(){return r.settings.preventWheel},stretchH:function(){return r.settings.stretchH},data:function(f,c){var h;return(h=r.instance).getDataAtCell.apply(h,CI(r.translateFromRenderableToVisualIndex(f,c)))},totalRows:function(){return r.countRenderableRows()},totalColumns:function(){return r.countRenderableColumns()},fixedColumnsStart:function(){return r.countNotHiddenFixedColumnsStart()},fixedRowsTop:function(){return r.countNotHiddenFixedRowsTop()},fixedRowsBottom:function(){return r.countNotHiddenFixedRowsBottom()},shouldRenderInlineStartOverlay:function(){return r.settings.fixedColumnsStart>0||o.rowHeaders().length>0},shouldRenderTopOverlay:function(){return r.settings.fixedRowsTop>0||o.columnHeaders().length>0},shouldRenderBottomOverlay:function(){return r.settings.fixedRowsBottom>0},minSpareRows:function(){return r.settings.minSpareRows},renderAllRows:this.settings.renderAllRows,rowHeaders:function(){var f=[];return r.instance.hasRowHeaders()&&f.push(function(c,h){var d=c>=0?r.instance.rowIndexMapper.getVisualFromRenderableIndex(c):c;r.appendRowHeader(d,h)}),r.instance.runHooks("afterGetRowHeaderRenderers",f),EI(r,Rw,f.length),f},columnHeaders:function(){var f=[];return r.instance.hasColHeaders()&&f.push(function(c,h){var d=c>=0?r.instance.columnIndexMapper.getVisualFromRenderableIndex(c):c;r.appendColHeader(d,h)}),r.instance.runHooks("afterGetColumnHeaderRenderers",f),EI(r,Ow,f.length),f},columnWidth:function(f){var c=r.instance.columnIndexMapper.getVisualFromRenderableIndex(f);return r.instance.getColWidth(c===null?f:c)},rowHeight:function(f){var c=r.instance.rowIndexMapper.getVisualFromRenderableIndex(f);return r.instance.getRowHeight(c===null?f:c)},cellRenderer:function(f,c,h){var d=r.translateFromRenderableToVisualIndex(f,c),v=Ff(d,2),g=v[0],m=v[1],w=r.instance.runHooks("modifyGetCellCoords",g,m),S=g,C=m;if(Array.isArray(w)){var P=Ff(w,2);S=P[0],C=P[1]}var R=r.instance.getCellMeta(S,C),V=r.instance.colToProp(C),U=r.instance.getDataAtRowProp(S,V);r.instance.hasHook("beforeValueRender")&&(U=r.instance.runHooks("beforeValueRender",U,R)),r.instance.runHooks("beforeRenderer",h,g,m,V,U,R),r.instance.getCellRenderer(R)(r.instance,h,g,m,V,U,R),r.instance.runHooks("afterRenderer",h,g,m,V,U,R)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:function(){return r.settings.fragmentSelection},onWindowResize:function(){r.instance&&!r.instance.isDestroyed&&r.instance.refreshDimensions()},onContainerElementResize:function(){r.instance&&!r.instance.isDestroyed&&r.instance.refreshDimensions()},onCellMouseDown:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c),g={row:!1,column:!1,cell:!1};r.instance.listen(),r.activeWt=d,n.mouseDown=!0,r.instance.runHooks("beforeOnCellMouseDown",f,v,h,g),!Qi(f)&&(SI(f,{coords:v,selection:r.instance.selection,controller:g,cellCoordsFactory:function(w,S){return r.instance._createCellCoords(w,S)}}),r.instance.runHooks("afterOnCellMouseDown",f,v,h),r.activeWt=r._wt)},onCellContextMenu:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c);r.activeWt=d,n.mouseDown=!1,r.instance.selection.isInProgress()&&r.instance.selection.finish(),r.instance.runHooks("beforeOnCellContextMenu",f,v,h),!Qi(f)&&(r.instance.runHooks("afterOnCellContextMenu",f,v,h),r.activeWt=r._wt)},onCellMouseOut:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c);r.activeWt=d,r.instance.runHooks("beforeOnCellMouseOut",f,v,h),!Qi(f)&&(r.instance.runHooks("afterOnCellMouseOut",f,v,h),r.activeWt=r._wt)},onCellMouseOver:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c),g={row:!1,column:!1,cell:!1};r.activeWt=d,r.instance.runHooks("beforeOnCellMouseOver",f,v,h,g),!Qi(f)&&(n.mouseDown&&SI(f,{coords:v,selection:r.instance.selection,controller:g,cellCoordsFactory:function(w,S){return r.instance._createCellCoords(w,S)}}),r.instance.runHooks("afterOnCellMouseOver",f,v,h),r.activeWt=r._wt)},onCellMouseUp:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c);r.activeWt=d,r.instance.runHooks("beforeOnCellMouseUp",f,v,h),!(Qi(f)||r.instance.isDestroyed)&&(r.instance.runHooks("afterOnCellMouseUp",f,v,h),r.activeWt=r._wt)},onCellCornerMouseDown:function(f){f.preventDefault(),r.instance.runHooks("afterOnCellCornerMouseDown",f)},onCellCornerDblClick:function(f){f.preventDefault(),r.instance.runHooks("afterOnCellCornerDblClick",f)},beforeDraw:function(f,c){return r.beforeRender(f,c)},onDraw:function(f){return r.afterRender(f)},onScrollVertically:function(){return r.instance.runHooks("afterScrollVertically")},onScrollHorizontally:function(){return r.instance.runHooks("afterScrollHorizontally")},onBeforeRemoveCellClassNames:function(){return r.instance.runHooks("beforeRemoveCellClassNames")},onBeforeHighlightingRowHeader:function(f,c,h){var d=r.instance.rowIndexMapper,v=d.getVisualFromRenderableIndex(f),g=r.instance.runHooks("beforeHighlightingRowHeader",v,c,h);return d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(g,1))},onBeforeHighlightingColumnHeader:function(f,c,h){var d=r.instance.columnIndexMapper,v=d.getVisualFromRenderableIndex(f),g=r.instance.runHooks("beforeHighlightingColumnHeader",v,c,h);return d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(g,1))},onAfterDrawSelection:function(f,c,h){var d,v=r.translateFromRenderableToVisualIndex(f,c),g=Ff(v,2),m=g[0],w=g[1],S=r.instance.selection.getSelectedRange(),C=S.size();if(C>0){var P=(h??0)+1-C,R=S.peekByIndex(P);d=[R.from.row,R.from.col,R.to.row,R.to.col]}return r.instance.runHooks("afterDrawSelection",m,w,d,h)},onBeforeDrawBorders:function(f,c){var h=Ff(f,4),d=h[0],v=h[1],g=h[2],m=h[3],w=[r.instance.rowIndexMapper.getVisualFromRenderableIndex(d),r.instance.columnIndexMapper.getVisualFromRenderableIndex(v),r.instance.rowIndexMapper.getVisualFromRenderableIndex(g),r.instance.columnIndexMapper.getVisualFromRenderableIndex(m)];return r.instance.runHooks("beforeDrawBorders",w,c)},onBeforeTouchScroll:function(){return r.instance.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){return r.instance.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(f,c){var h=r.instance.columnIndexMapper.getVisualFromRenderableIndex(c);return r.instance.runHooks("beforeStretchingColumnWidth",f,h)},onModifyRowHeaderWidth:function(f){return r.instance.runHooks("modifyRowHeaderWidth",f)},onModifyGetCellCoords:function(f,c,h){var d=r.instance.rowIndexMapper,v=r.instance.columnIndexMapper,g=c>=0?v.getVisualFromRenderableIndex(c):c,m=f>=0?d.getVisualFromRenderableIndex(f):f,w=r.instance.runHooks("modifyGetCellCoords",m,g,h);if(Array.isArray(w)){var S=Ff(w,4),C=S[0],P=S[1],R=S[2],V=S[3];return[C>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(C,1)):C,P>=0?v.getRenderableFromVisualIndex(v.getNearestNotHiddenIndex(P,1)):P,R>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(R,-1)):R,V>=0?v.getRenderableFromVisualIndex(v.getNearestNotHiddenIndex(V,-1)):V]}},viewportRowCalculatorOverride:function(f){var c=r.settings.viewportRowRenderingOffset;if(c==="auto"&&r.settings.fixedRowsTop&&(c=10),c>0||c==="auto"){var h=r.countRenderableRows(),d=f.startRow,v=f.endRow;if(typeof c=="number")f.startRow=Math.max(d-c,0),f.endRow=Math.min(v+c,h-1);else if(c==="auto"){var g=Math.ceil(v/h*12);f.startRow=Math.max(d-g,0),f.endRow=Math.min(v+g,h-1)}}r.instance.runHooks("afterViewportRowCalculatorOverride",f)},viewportColumnCalculatorOverride:function(f){var c=r.settings.viewportColumnRenderingOffset;if(c==="auto"&&r.settings.fixedColumnsStart&&(c=10),c>0||c==="auto"){var h=r.countRenderableColumns(),d=f.startColumn,v=f.endColumn;if(typeof c=="number"&&(f.startColumn=Math.max(d-c,0),f.endColumn=Math.min(v+c,h-1)),c==="auto"){var g=Math.ceil(v/h*6);f.startColumn=Math.max(d-g,0),f.endColumn=Math.min(v+g,h-1)}}r.instance.runHooks("afterViewportColumnCalculatorOverride",f)},rowHeaderWidth:function(){return r.settings.rowHeaderWidth},columnHeaderHeight:function(){var f=r.instance.runHooks("modifyColumnHeaderHeight");return r.settings.columnHeaderHeight||f}};this.instance.runHooks("beforeInitWalkontable",o),this._wt=new lye(o),this.activeWt=this._wt;var i=this._wt.wtTable.spreader,a=this.instance.rootElement.getBoundingClientRect(),l=a.width,s=a.height;this.setLastSize(l,s),this.eventManager.addEventListener(i,"mousedown",function(u){u.target===i&&u.which===3&&u.stopPropagation()}),this.eventManager.addEventListener(i,"contextmenu",function(u){u.target===i&&u.which===3&&u.stopPropagation()}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",function(){r.settings.observeDOMVisibility&&r._wt.drawInterrupted&&(r.instance.forceFullRender=!0,r.render())})}},{key:"isTextSelectionAllowed",value:function(r){if(Fc(r))return!0;var n=hi(r,this.instance.view._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}},{key:"isMouseDown",value:function(){return Fi.get(this).mouseDown}},{key:"isSelectedOnlyCell",value:function(){var r,n;return(r=(n=this.instance.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())!==null&&r!==void 0?r:!1}},{key:"isCellEdited",value:function(){var r=this.instance.getActiveEditor();return r&&r.isOpened()}},{key:"beforeRender",value:function(r,n){r&&this.instance.runHooks("beforeViewRender",this.instance.forceFullRender,n)}},{key:"afterRender",value:function(r){r&&this.instance.runHooks("afterViewRender",this.instance.forceFullRender)}},{key:"appendRowHeader",value:function(r,n){if(n.firstChild){var o=n.firstChild;if(!xe(o,"relative")){yn(n),this.appendRowHeader(r,n);return}this.updateCellHeader(o.querySelector(".rowHeader"),r,this.instance.getRowHeader)}else{var i=this.instance,a=i.rootDocument,l=i.getRowHeader,s=a.createElement("div"),u=a.createElement("span");s.className="relative",u.className="rowHeader",this.updateCellHeader(u,r,l),s.appendChild(u),n.appendChild(s)}this.instance.runHooks("afterGetRowHeader",r,n)}},{key:"appendColHeader",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.instance.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(n.firstChild){var a=n.firstChild;xe(a,"relative")?this.updateCellHeader(a.querySelector(".colHeader"),r,o,i):(yn(n),this.appendColHeader(r,n,o,i))}else{var l=this.instance.rootDocument,s=l.createElement("div"),u=l.createElement("span");s.className="relative",u.className="colHeader",this.updateCellHeader(u,r,o,i),s.appendChild(u),n.appendChild(s)}this.instance.runHooks("afterGetColHeader",r,n,i)}},{key:"updateCellHeader",value:function(r,n,o){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,a=n,l=this._wt.wtOverlays.getParentOverlay(r)||this._wt;r.parentNode&&(xe(r,"colHeader")?a=l.wtTable.columnFilter.sourceToRendered(n):xe(r,"rowHeader")&&(a=l.wtTable.rowFilter.sourceToRendered(n))),a>-1?tl(r,o(n,i)):(Oi(r,String.fromCharCode(160)),re(r,"cornerHeader"))}},{key:"maximumVisibleElementWidth",value:function(r){var n=this._wt.wtViewport.getWorkspaceWidth(),o=n-r;return o>0?o:0}},{key:"maximumVisibleElementHeight",value:function(r){var n=this._wt.wtViewport.getWorkspaceHeight(),o=n-r;return o>0?o:0}},{key:"setLastSize",value:function(r,n){var o=Fi.get(this),i=[r,n];o.lastWidth=i[0],o.lastHeight=i[1]}},{key:"getLastSize",value:function(){var r=Fi.get(this);return{width:r.lastWidth,height:r.lastHeight}}},{key:"getFirstFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleRow())}},{key:"getLastFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleRow())}},{key:"getFirstFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleColumn())}},{key:"getLastFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleColumn())}},{key:"getColumnHeadersCount",value:function(){return RI(this,Ow)}},{key:"getRowHeadersCount",value:function(){return RI(this,Rw)}},{key:"destroy",value:function(){this._wt.destroy(),this.eventManager.destroy()}}]),e}();const rge=tge;function C_(e){"@babel/helpers - typeof";return C_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},C_(e)}var WW="ABCDEFGHIJKLMNOPQRSTUVWXYZ",__=WW.length;function xm(e){for(var t=e+1,r="",n;t>0;)n=(t-1)%__,r=String.fromCharCode(65+n)+r,t=parseInt((t-n)/__,10);return r}function nge(e){var t=0;if(e)for(var r=0,n=e.length-1;r<e.length;r+=1,n-=1)t+=Math.pow(__,n)*(WW.indexOf(e[r])+1);return t-=1,t}function oge(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4,r=[],n,o;for(n=0;n<e;n++){var i=[];for(o=0;o<t;o++)i.push(xm(o)+(n+1));r.push(i)}return r}function ige(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4,r=[],n,o;for(n=0;n<e;n++){var i={};for(o=0;o<t;o++)i["prop".concat(o)]=xm(o)+(n+1);r.push(i)}return r}function age(e,t){for(var r=[],n,o=0;o<e;o++){n=[];for(var i=0;i<t;i++)n.push("");r.push(n)}return r}function O_(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=e,n=[];return(!Array.isArray(e)||!Array.isArray(e[0]))&&(r=[e]),r.forEach(function(o,i){Array.isArray(o)?o.forEach(function(a,l){n.push([i+t,l,a])}):Object.keys(o).forEach(function(a){n.push([i+t,a,o[a]])})}),n}function DE(e){var t=0;return Array.isArray(e)&&(e[0]&&Array.isArray(e[0])?t=e[0].length:e[0]&&Ve(e[0])&&(t=ym(e[0]))),t}function UW(e){return!!(Array.isArray(e)&&e.length&&e.every(function(t){return Array.isArray(t)}))}function zW(e){return!!(Array.isArray(e)&&e.length&&e.every(function(t){return C_(t)==="object"&&!Array.isArray(t)&&t!==null}))}const lge=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:DE,createEmptySpreadsheetData:age,createSpreadsheetData:oge,createSpreadsheetObjectData:ige,dataRowToChangesArray:O_,isArrayOfArrays:UW,isArrayOfObjects:zW,spreadsheetColumnIndex:nge,spreadsheetColumnLabel:xm},Symbol.toStringTag,{value:"Module"}));function gh(e){"@babel/helpers - typeof";return gh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gh(e)}function sge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fge(n.key),n)}}function uge(e,t,r){return t&&TI(e.prototype,t),r&&TI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fge(e){var t=cge(e,"string");return gh(t)==="symbol"?t:String(t)}function cge(e,t){if(gh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hge=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];sge(this,e),this.hot=t,this.data=r,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}}return uge(e,[{key:"modifyRowData",value:function(r){var n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",r)),n!==void 0&&!Number.isInteger(n)?n:this.data[r]}},{key:"getData",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,r)}},{key:"setData",value:function(r){this.data=r}},{key:"getAtColumn",value:function(r){var n=this,o=[];return $(this.data,function(i,a){var l=n.getAtCell(a,r);o.push(l)}),o}},{key:"getAtRow",value:function(r,n,o){var i=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,l=n===void 0&&o===void 0,s=null,u=null;if(s=this.modifyRowData(r),Array.isArray(s))u=[],l?s.forEach(function(h,d){u[d]=i.getAtPhysicalCell(r,d,s)}):_e(n,o,function(h){u[h-n]=i.getAtPhysicalCell(r,h,s)});else if(Ve(s)||bt(s))if(a?u=[]:u={},!l||a){var f=0,c=this.countFirstRowKeys()-1;_e(f,c,function(h){var d=i.colToProp(h);if(h>=(n||f)&&h<=(o||c)&&!Number.isInteger(d)){var v=i.getAtPhysicalCell(r,d,s);a?u.push(v):zy(u,d,v)}})}else We(s,function(h,d){zy(u,d,i.getAtPhysicalCell(r,d,s))});return u}},{key:"setAtCell",value:function(r,n,o){if(!(r>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){var i=Ia(o);this.hot.runHooks("modifySourceData",r,n,i,"set"),i.isTouched()&&(o=i.value)}Number.isInteger(n)?this.data[r][n]=o:zy(this.data[r],n,o)}}},{key:"getAtPhysicalCell",value:function(r,n,o){var i=null;if(o&&(typeof n=="string"?i=iB(o,n):typeof n=="function"?i=n(o):i=o[n]),this.hot.hasHook("modifySourceData")){var a=Ia(i);this.hot.runHooks("modifySourceData",r,n,a,"get"),a.isTouched()&&(i=a.value)}return i}},{key:"getAtCell",value:function(r,n){var o=this.modifyRowData(r);return this.getAtPhysicalCell(r,this.colToProp(n),o)}},{key:"getByRange",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=!1,l=null,s=null,u=null,f=null;n===null||o===null?(a=!0,l=0,u=this.countRows()-1):(l=Math.min(n.row,o.row),s=Math.min(n.col,o.col),u=Math.max(n.row,o.row),f=Math.max(n.col,o.col));var c=[];return _e(l,u,function(h){c.push(a?r.getAtRow(h,void 0,void 0,i):r.getAtRow(h,s,f,i))}),c}},{key:"countRows",value:function(){if(this.hot.hasHook("modifySourceLength")){var r=this.hot.runHooks("modifySourceLength");if(Number.isInteger(r))return r}return this.data.length}},{key:"countFirstRowKeys",value:function(){return DE(this.data)}},{key:"destroy",value:function(){this.data=null,this.hot=null}}]),e}();const dge=hge;var PI=Mt,vge=function(e){return e!==void 0&&(PI(e,"value")||PI(e,"writable"))},yge=$e,gge=zt,pge=Nt,mge=Ht,bge=vge,wge=Ln,Sge=rv;function YW(e,t){var r=arguments.length<3?e:arguments[2],n,o;if(mge(e)===r)return e[t];if(n=wge.f(e,t),n)return bge(n)?n.value:n.get===void 0?void 0:gge(n.get,r);if(pge(o=Sge(e)))return YW(o,t,r)}yge({target:"Reflect",stat:!0},{get:YW});var Cge=$e,_ge=je,Oge=Br,GW=Ln.f,KW=Ut,Rge=!KW||_ge(function(){GW(1)});Cge({target:"Object",stat:!0,forced:Rge,sham:!KW},{getOwnPropertyDescriptor:function(t,r){return GW(Oge(t),r)}});var Ege="localHooks",qW={_localHooks:Object.create(null),addLocalHook:function(t,r){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(r),this},runLocalHooks:function(t,r,n,o,i,a,l){if(this._localHooks[t])for(var s=this._localHooks[t].length,u=0;u<s;u++)Wg(this._localHooks[t][u],this,r,n,o,i,a,l)},clearLocalHooks:function(){return this._localHooks={},this}};Fn(qW,"MIXIN_NAME",Ege,{writable:!1,enumerable:!1});const kr=qW;function ph(e){"@babel/helpers - typeof";return ph=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ph(e)}function Tge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kge(n.key),n)}}function Pge(e,t,r){return t&&kI(e.prototype,t),r&&kI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kge(e){var t=$ge(e,"string");return ph(t)==="symbol"?t:String(t)}function $ge(e,t){if(ph(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ph(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rl=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Tge(this,e),this.indexedValues=[],this.initValueOrFn=t}return Pge(e,[{key:"getValues",value:function(){return this.indexedValues}},{key:"getValueAtIndex",value:function(r){var n=this.indexedValues;if(r<n.length)return n[r]}},{key:"setValues",value:function(r){this.indexedValues=r.slice(),this.runLocalHooks("change")}},{key:"setValueAtIndex",value:function(r,n){return r<this.indexedValues.length?(this.indexedValues[r]=n,this.runLocalHooks("change"),!0):!1}},{key:"clear",value:function(){this.setDefaultValues()}},{key:"getLength",value:function(){return this.getValues().length}},{key:"setDefaultValues",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,bt(this.initValueOrFn)?_e(n-1,function(o){return r.indexedValues.push(r.initValueOrFn(o))}):_e(n-1,function(){return r.indexedValues.push(r.initValueOrFn)}),this.runLocalHooks("change")}},{key:"init",value:function(r){return this.setDefaultValues(r),this.runLocalHooks("init"),this}},{key:"insert",value:function(){this.runLocalHooks("change")}},{key:"remove",value:function(){this.runLocalHooks("change")}},{key:"destroy",value:function(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}]),e}();pt(rl,kr);function Ew(e){return xge(e)||Mge(e)||Ige(e)||Age()}function Age(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ige(e,t){if(e){if(typeof e=="string")return R_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return R_(e,t)}}function Mge(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function xge(e){if(Array.isArray(e))return R_(e)}function R_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function NE(e,t,r,n){var o=r.length?r[0]:void 0;return[].concat(Ew(e.slice(0,o)),Ew(r.map(function(i,a){return bt(n)?n(i,a):n})),Ew(o===void 0?[]:e.slice(o)))}function HE(e,t){return jr(e,function(r,n){return t.includes(n)===!1})}function Ms(e){"@babel/helpers - typeof";return Ms=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ms(e)}function Dge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $I(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Hge(n.key),n)}}function Nge(e,t,r){return t&&$I(e.prototype,t),r&&$I(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hge(e){var t=Lge(e,"string");return Ms(t)==="symbol"?t:String(t)}function Lge(e,t){if(Ms(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ms(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Sc(){return typeof Reflect<"u"&&Reflect.get?Sc=Reflect.get.bind():Sc=function(t,r,n){var o=jge(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Sc.apply(this,arguments)}function jge(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=La(e),e!==null););return e}function Fge(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&E_(e,t)}function E_(e,t){return E_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},E_(e,t)}function Bge(e){var t=Uge();return function(){var n=La(e),o;if(t){var i=La(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Vge(this,o)}}function Vge(e,t){if(t&&(Ms(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Wge(e)}function Wge(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Uge(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function La(e){return La=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},La(e)}var Ai=function(e){Fge(r,e);var t=Bge(r);function r(){return Dge(this,r),t.apply(this,arguments)}return Nge(r,[{key:"insert",value:function(o,i){this.indexedValues=NE(this.indexedValues,o,i,this.initValueOrFn),Sc(La(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){this.indexedValues=HE(this.indexedValues,o),Sc(La(r.prototype),"remove",this).call(this,o)}}]),r}(rl);function xs(e){"@babel/helpers - typeof";return xs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xs(e)}function zge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Gge(n.key),n)}}function Yge(e,t,r){return t&&AI(e.prototype,t),r&&AI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Gge(e){var t=Kge(e,"string");return xs(t)==="symbol"?t:String(t)}function Kge(e,t){if(xs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qge(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&T_(e,t)}function T_(e,t){return T_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},T_(e,t)}function Xge(e){var t=Jge();return function(){var n=wp(e),o;if(t){var i=wp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Zge(this,o)}}function Zge(e,t){if(t&&(xs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Qge(e)}function Qge(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Jge(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wp(e){return wp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wp(e)}var Dm=function(e){qge(r,e);var t=Xge(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return zge(this,r),t.call(this,n)}return Yge(r,[{key:"getHiddenIndexes",value:function(){return Lt(this.getValues(),function(o,i,a){return i&&o.push(a),o},[])}}]),r}(Ai);function Tw(e){return npe(e)||rpe(e)||tpe(e)||epe()}function epe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tpe(e,t){if(e){if(typeof e=="string")return P_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return P_(e,t)}}function rpe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function npe(e){if(Array.isArray(e))return P_(e)}function P_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function LE(e,t,r){return[].concat(Tw(e.slice(0,t)),Tw(r),Tw(e.slice(t)))}function mh(e,t){return jr(e,function(r){return t.includes(r)===!1})}function jE(e,t){return Be(e,function(r){return r-t.filter(function(n){return n<r}).length})}function FE(e,t){var r=t[0],n=t.length;return Be(e,function(o){return o>=r?o+n:o})}function Ds(e){"@babel/helpers - typeof";return Ds=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ds(e)}function ope(e){return spe(e)||lpe(e)||ape(e)||ipe()}function ipe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ape(e,t){if(e){if(typeof e=="string")return k_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return k_(e,t)}}function lpe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function spe(e){if(Array.isArray(e))return k_(e)}function k_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function upe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function II(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ZW(n.key),n)}}function fpe(e,t,r){return t&&II(e.prototype,t),r&&II(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ro(){return typeof Reflect<"u"&&Reflect.get?ro=Reflect.get.bind():ro=function(t,r,n){var o=cpe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ro.apply(this,arguments)}function cpe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=sn(e),e!==null););return e}function hpe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$_(e,t)}function $_(e,t){return $_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},$_(e,t)}function dpe(e){var t=ype();return function(){var n=sn(e),o;if(t){var i=sn(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return vpe(this,o)}}function vpe(e,t){if(t&&(Ds(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return XW(e)}function XW(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ype(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function sn(e){return sn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},sn(e)}function gpe(e,t,r){return t=ZW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ZW(e){var t=ppe(e,"string");return Ds(t)==="symbol"?t:String(t)}function ppe(e,t){if(Ds(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ds(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Nm=function(e){hpe(r,e);var t=dpe(r);function r(){var n;upe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),gpe(XW(n),"orderOfIndexes",[]),n}return fpe(r,[{key:"getValues",value:function(){var o=this;return this.orderOfIndexes.map(function(i){return o.indexedValues[i]})}},{key:"setValues",value:function(o){this.orderOfIndexes=ope(Array(o.length).keys()),ro(sn(r.prototype),"setValues",this).call(this,o)}},{key:"setValueAtIndex",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return o<this.indexedValues.length?(this.indexedValues[o]=i,this.orderOfIndexes.includes(o)===!1&&this.orderOfIndexes.splice(a,0,o),this.runLocalHooks("change"),!0):!1}},{key:"clearValue",value:function(o){this.orderOfIndexes=mh(this.orderOfIndexes,[o]),bt(this.initValueOrFn)?ro(sn(r.prototype),"setValueAtIndex",this).call(this,o,this.initValueOrFn(o)):ro(sn(r.prototype),"setValueAtIndex",this).call(this,o,this.initValueOrFn)}},{key:"getLength",value:function(){return this.orderOfIndexes.length}},{key:"setDefaultValues",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,ro(sn(r.prototype),"setDefaultValues",this).call(this,o)}},{key:"insert",value:function(o,i){this.indexedValues=NE(this.indexedValues,o,i,this.initValueOrFn),this.orderOfIndexes=FE(this.orderOfIndexes,i),ro(sn(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){this.indexedValues=HE(this.indexedValues,o),this.orderOfIndexes=mh(this.orderOfIndexes,o),this.orderOfIndexes=jE(this.orderOfIndexes,o),ro(sn(r.prototype),"remove",this).call(this,o)}},{key:"getEntries",value:function(){var o=this;return this.orderOfIndexes.map(function(i){return[i,o.getValueAtIndex(i)]})}}]),r}(rl);function Ns(e){"@babel/helpers - typeof";return Ns=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ns(e)}function mpe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wpe(n.key),n)}}function bpe(e,t,r){return t&&MI(e.prototype,t),r&&MI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wpe(e){var t=Spe(e,"string");return Ns(t)==="symbol"?t:String(t)}function Spe(e,t){if(Ns(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ns(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Cpe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&A_(e,t)}function A_(e,t){return A_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},A_(e,t)}function _pe(e){var t=Epe();return function(){var n=Sp(e),o;if(t){var i=Sp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Ope(this,o)}}function Ope(e,t){if(t&&(Ns(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Rpe(e)}function Rpe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Epe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Sp(e){return Sp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Sp(e)}var wv=function(e){Cpe(r,e);var t=_pe(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return mpe(this,r),t.call(this,n)}return bpe(r,[{key:"getTrimmedIndexes",value:function(){return Lt(this.getValues(),function(o,i,a){return i&&o.push(a),o},[])}}]),r}(Ai),xI=new Map([["indexesSequence",{getListWithInsertedItems:LE,getListWithRemovedItems:mh}],["physicallyIndexed",{getListWithInsertedItems:NE,getListWithRemovedItems:HE}]]),QW=function(t){if(xI.has(t)===!1)throw new Error("Alter strategy with ID '".concat(t,"' does not exist."));return xI.get(t)};function Hs(e){"@babel/helpers - typeof";return Hs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hs(e)}function Tpe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kpe(n.key),n)}}function Ppe(e,t,r){return t&&DI(e.prototype,t),r&&DI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kpe(e){var t=$pe(e,"string");return Hs(t)==="symbol"?t:String(t)}function $pe(e,t){if(Hs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Cc(){return typeof Reflect<"u"&&Reflect.get?Cc=Reflect.get.bind():Cc=function(t,r,n){var o=Ape(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Cc.apply(this,arguments)}function Ape(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ja(e),e!==null););return e}function Ipe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&I_(e,t)}function I_(e,t){return I_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},I_(e,t)}function Mpe(e){var t=Npe();return function(){var n=ja(e),o;if(t){var i=ja(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return xpe(this,o)}}function xpe(e,t){if(t&&(Hs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Dpe(e)}function Dpe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Npe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ja(e){return ja=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ja(e)}var JW=function(e){Ipe(r,e);var t=Mpe(r);function r(){return Tpe(this,r),t.call(this,function(n){return n})}return Ppe(r,[{key:"insert",value:function(o,i){var a=FE(this.indexedValues,i);this.indexedValues=LE(a,o,i),Cc(ja(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){var i=mh(this.indexedValues,o);this.indexedValues=jE(i,o),Cc(ja(r.prototype),"remove",this).call(this,o)}}]),r}(rl),NI=new Map([["hiding",Dm],["index",rl],["linkedPhysicalIndexToValue",Nm],["physicalIndexToValue",Ai],["trimming",wv]]);function Hpe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!NI.has(e))throw new Error('The provided map type ("'.concat(e,'") does not exist.'));return new(NI.get(e))(t)}function bh(e){"@babel/helpers - typeof";return bh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bh(e)}function Lpe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Fpe(n.key),n)}}function jpe(e,t,r){return t&&HI(e.prototype,t),r&&HI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Fpe(e){var t=Bpe(e,"string");return bh(t)==="symbol"?t:String(t)}function Bpe(e,t){if(bh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var M_=0,BE=function(){function e(){Lpe(this,e),this.collection=new Map}return jpe(e,[{key:"register",value:function(r,n){var o=this;this.collection.has(r)===!1&&(this.collection.set(r,n),n.addLocalHook("change",function(){return o.runLocalHooks("change",n)}),M_+=1)}},{key:"unregister",value:function(r){var n=this.collection.get(r);ve(n)&&(n.destroy(),this.collection.delete(r),this.runLocalHooks("change",n),M_-=1)}},{key:"unregisterAll",value:function(){var r=this;this.collection.forEach(function(n,o){return r.unregister(o)}),this.collection.clear()}},{key:"get",value:function(r){return gt(r)?Array.from(this.collection.values()):this.collection.get(r)}},{key:"getLength",value:function(){return this.collection.size}},{key:"removeFromEvery",value:function(r){this.collection.forEach(function(n){n.remove(r)})}},{key:"insertToEvery",value:function(r,n){this.collection.forEach(function(o){o.insert(r,n)})}},{key:"initEvery",value:function(r){this.collection.forEach(function(n){n.init(r)})}}]),e}();pt(BE,kr);function Vpe(){return M_}function Ls(e){"@babel/helpers - typeof";return Ls=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ls(e)}function Wpe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zpe(n.key),n)}}function Upe(e,t,r){return t&&LI(e.prototype,t),r&&LI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zpe(e){var t=Ype(e,"string");return Ls(t)==="symbol"?t:String(t)}function Ype(e,t){if(Ls(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ls(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gpe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&x_(e,t)}function x_(e,t){return x_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},x_(e,t)}function Kpe(e){var t=Zpe();return function(){var n=Cp(e),o;if(t){var i=Cp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return qpe(this,o)}}function qpe(e,t){if(t&&(Ls(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Xpe(e)}function Xpe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zpe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Cp(e){return Cp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Cp(e)}var jI=function(e){Gpe(r,e);var t=Kpe(r);function r(n,o){var i;return Wpe(this,r),i=t.call(this),i.mergedValuesCache=[],i.aggregationFunction=n,i.fallbackValue=o,i}return Upe(r,[{key:"getMergedValues",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(o===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];for(var i=Be(this.get(),function(c){return c.getValues()}),a=[],l=ve(i[0])&&i[0].length||0,s=0;s<l;s+=1){for(var u=[],f=0;f<this.getLength();f+=1)u.push(i[f][s]);a.push(u)}return Be(a,this.aggregationFunction)}},{key:"getMergedValueAtIndex",value:function(o,i){var a=this.getMergedValues(i)[o];return ve(a)?a:this.fallbackValue}},{key:"updateCache",value:function(){this.mergedValuesCache=this.getMergedValues(!1)}}]),r}(BE);function wh(e){"@babel/helpers - typeof";return wh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wh(e)}function Qpe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eme(n.key),n)}}function Jpe(e,t,r){return t&&FI(e.prototype,t),r&&FI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function eme(e){var t=tme(e,"string");return wh(t)==="symbol"?t:String(t)}function tme(e,t){if(wh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rme(e,t,r){nme(e,t),t.set(e,r)}function nme(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ome(e,t,r){var n=e2(e,t,"set");return ime(e,n,r),r}function ime(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function ame(e,t){var r=e2(e,t,"get");return lme(e,r)}function e2(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function lme(e,t){return t.get?t.get.call(e):t.value}var Pw=new WeakMap,t2=function(){function e(){Qpe(this,e),rme(this,Pw,{writable:!0,value:[]})}return Jpe(e,[{key:"subscribe",value:function(r){return this.addLocalHook("change",r),this._write(ame(this,Pw)),this}},{key:"unsubscribe",value:function(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}},{key:"_write",value:function(r){return r.length>0&&this.runLocalHooks("change",r),this}},{key:"_writeInitialChanges",value:function(r){ome(this,Pw,r)}}]),e}();pt(t2,kr);function BI(e,t){for(var r=[],n=0,o=0;n<e.length&&o<t.length;n++,o++)e[n]!==t[o]&&r.push({op:"replace",index:o,oldValue:e[n],newValue:t[o]});for(;n<t.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:t[n]});for(;o<e.length;o++)r.push({op:"remove",index:o,oldValue:e[o],newValue:void 0});return r}function Sh(e){"@babel/helpers - typeof";return Sh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sh(e)}function sme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fme(n.key),n)}}function ume(e,t,r){return t&&VI(e.prototype,t),r&&VI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fme(e){var t=cme(e,"string");return Sh(t)==="symbol"?t:String(t)}function cme(e,t){if(Sh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Bf(e,t,r){hme(e,t),t.set(e,r)}function hme(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ur(e,t){var r=r2(e,t,"get");return dme(e,r)}function dme(e,t){return t.get?t.get.call(e):t.value}function ty(e,t,r){var n=r2(e,t,"set");return vme(e,n,r),r}function r2(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function vme(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var ry=new WeakMap,Vf=new WeakMap,ny=new WeakMap,oy=new WeakMap,iy=new WeakMap,yme=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.initialIndexValue;sme(this,e),Bf(this,ry,{writable:!0,value:new Set}),Bf(this,Vf,{writable:!0,value:[]}),Bf(this,ny,{writable:!0,value:[]}),Bf(this,oy,{writable:!0,value:!1}),Bf(this,iy,{writable:!0,value:!1}),ty(this,iy,r??!1)}return ume(e,[{key:"createObserver",value:function(){var r=this,n=new t2;return Ur(this,ry).add(n),n.addLocalHook("unsubscribe",function(){Ur(r,ry).delete(n)}),n._writeInitialChanges(BI(Ur(this,Vf),Ur(this,ny))),n}},{key:"emit",value:function(r){var n=Ur(this,ny);(!Ur(this,oy)||Ur(this,Vf).length!==r.length)&&(r.length===0?r=new Array(n.length).fill(Ur(this,iy)):ty(this,Vf,new Array(r.length).fill(Ur(this,iy))),Ur(this,oy)||(ty(this,oy,!0),n=Ur(this,Vf)));var o=BI(n,r);Ur(this,ry).forEach(function(i){return i._write(o)}),ty(this,ny,r)}}]),e}();function Ch(e){"@babel/helpers - typeof";return Ch=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ch(e)}var WI;function kw(e){return bme(e)||mme(e)||pme(e)||gme()}function gme(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pme(e,t){if(e){if(typeof e=="string")return D_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return D_(e,t)}}function mme(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function bme(e){if(Array.isArray(e))return D_(e)}function D_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function wme(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Sme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_me(n.key),n)}}function Cme(e,t,r){return t&&UI(e.prototype,t),r&&UI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _me(e){var t=Ome(e,"string");return Ch(t)==="symbol"?t:String(t)}function Ome(e,t){if(Ch(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ch(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var zI=new Set(["getFirstNotHiddenIndex"]),N_=function(){function e(){var t=this;Sme(this,e),this.indexesSequence=new JW,this.trimmingMapsCollection=new jI(function(r){return r.some(function(n){return n===!0})},!1),this.hidingMapsCollection=new jI(function(r){return r.some(function(n){return n===!0})},!1),this.variousMapsCollection=new BE,this.hidingChangesObservable=new yme({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.indexesChangeSource=void 0,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",function(){t.indexesSequenceChanged=!0,t.updateCache(),t.runLocalHooks("indexesSequenceChange",t.indexesChangeSource),t.runLocalHooks("change",t.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",function(r){t.trimmedIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",r,t.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",function(r){t.hiddenIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",r,t.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",function(r){t.runLocalHooks("change",r,t.variousMapsCollection)})}return Cme(e,[{key:"suspendOperations",value:function(){this.isBatched=!0}},{key:"resumeOperations",value:function(){this.isBatched=!1,this.updateCache()}},{key:"createChangesObserver",value:function(r){if(r!=="hiding")throw new Error('Unsupported index map type "'.concat(r,'".'));return this.hidingChangesObservable.createObserver()}},{key:"createAndRegisterIndexMap",value:function(r,n,o){return this.registerMap(r,Hpe(n,o))}},{key:"registerMap",value:function(r,n){if(this.trimmingMapsCollection.get(r)||this.hidingMapsCollection.get(r)||this.variousMapsCollection.get(r))throw Error('Map with name "'.concat(r,'" has been already registered.'));n instanceof wv?this.trimmingMapsCollection.register(r,n):n instanceof Dm?this.hidingMapsCollection.register(r,n):this.variousMapsCollection.register(r,n);var o=this.getNumberOfIndexes();return o>0&&n.init(o),n}},{key:"unregisterMap",value:function(r){this.trimmingMapsCollection.unregister(r),this.hidingMapsCollection.unregister(r),this.variousMapsCollection.unregister(r)}},{key:"unregisterAll",value:function(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}},{key:"getPhysicalFromVisualIndex",value:function(r){var n=this.notTrimmedIndexesCache[r];return ve(n)?n:null}},{key:"getPhysicalFromRenderableIndex",value:function(r){var n=this.renderablePhysicalIndexesCache[r];return ve(n)?n:null}},{key:"getVisualFromPhysicalIndex",value:function(r){var n=this.fromPhysicalToVisualIndexesCache.get(r);return ve(n)?n:null}},{key:"getVisualFromRenderableIndex",value:function(r){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(r))}},{key:"getRenderableFromVisualIndex",value:function(r){var n=this.fromVisualToRenderableIndexesCache.get(r);return ve(n)?n:null}},{key:"getFirstNotHiddenIndex",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:r-n;zI.has("getFirstNotHiddenIndex")&&(zI.delete("getFirstNotHiddenIndex"),ht(ft(WI||(WI=wme([`The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next 
                        major release. Please use "getNearestNotHiddenIndex" instead.`],[`The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next\\x20
                        major release. Please use "getNearestNotHiddenIndex" instead.`])))));var a=this.getPhysicalFromVisualIndex(r);return a===null?o===!0&&i!==r-n?this.getFirstNotHiddenIndex(i,-n,!1,i):null:this.isHidden(a)===!1?r:this.getFirstNotHiddenIndex(r+n,n,o,i)}},{key:"getNearestNotHiddenIndex",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.getPhysicalFromVisualIndex(r);if(i===null)return null;if(this.fromVisualToRenderableIndexesCache.has(r))return r;var a=Array.from(this.fromVisualToRenderableIndexesCache.keys()),l=-1;return n>0?l=a.findIndex(function(s){return s>r}):l=a.reverse().findIndex(function(s){return s<r}),l===-1?o?this.getNearestNotHiddenIndex(r,-n,!1):null:a[l]}},{key:"initToLength",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=kw(new Array(r).keys()),this.notHiddenIndexesCache=kw(new Array(r).keys()),this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(r),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(r),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(r),this.variousMapsCollection.initEvery(r),this.resumeOperations(),this.runLocalHooks("init")}},{key:"fitToLength",value:function(r){var n=this.getNumberOfIndexes();if(r<n){var o=kw(Array(this.getNumberOfIndexes()-r).keys()).map(function(i){return i+r});this.removeIndexes(o)}else this.insertIndexes(n,r-n)}},{key:"getIndexesSequence",value:function(){return this.indexesSequence.getValues()}},{key:"setIndexesSequence",value:function(r){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(r),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}},{key:"getNotTrimmedIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.notTrimmedIndexesCache;var o=this.getIndexesSequence();return o.filter(function(i){return r.isTrimmed(i)===!1})}},{key:"getNotTrimmedIndexesLength",value:function(){return this.getNotTrimmedIndexes().length}},{key:"getNotHiddenIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.notHiddenIndexesCache;var o=this.getIndexesSequence();return o.filter(function(i){return r.isHidden(i)===!1})}},{key:"getNotHiddenIndexesLength",value:function(){return this.getNotHiddenIndexes().length}},{key:"getRenderableIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.renderablePhysicalIndexesCache;var o=this.getNotTrimmedIndexes();return o.filter(function(i){return r.isHidden(i)===!1})}},{key:"getRenderableIndexesLength",value:function(){return this.getRenderableIndexes().length}},{key:"getNumberOfIndexes",value:function(){return this.getIndexesSequence().length}},{key:"moveIndexes",value:function(r,n){var o=this;typeof r=="number"&&(r=[r]);var i=Be(r,function(c){return o.getPhysicalFromVisualIndex(c)}),a=this.getNotTrimmedIndexesLength(),l=r.length,s=mh(this.getIndexesSequence(),i),u=a-l;if(n+l<a){var f=s.filter(function(c){return o.isTrimmed(c)===!1})[n];u=s.indexOf(f)}this.indexesChangeSource="move",this.setIndexesSequence(LE(s,u,i)),this.indexesChangeSource=void 0}},{key:"isTrimmed",value:function(r){return this.trimmingMapsCollection.getMergedValueAtIndex(r)}},{key:"isHidden",value:function(r){return this.hidingMapsCollection.getMergedValueAtIndex(r)}},{key:"insertIndexes",value:function(r,n){var o=this.getNotTrimmedIndexes()[r],i=ve(o)?o:this.getNumberOfIndexes(),a=this.getIndexesSequence().includes(o)?this.getIndexesSequence().indexOf(o):this.getNumberOfIndexes(),l=Be(new Array(n).fill(i),function(s,u){return s+u});this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(a,l),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(a,l),this.hidingMapsCollection.insertToEvery(a,l),this.variousMapsCollection.insertToEvery(a,l),this.resumeOperations()}},{key:"removeIndexes",value:function(r){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(r),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(r),this.hidingMapsCollection.removeFromEvery(r),this.variousMapsCollection.removeFromEvery(r),this.resumeOperations()}},{key:"updateCache",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(r===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}},{key:"cacheFromPhysicalToVisualIndexes",value:function(){var r=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(var n=0;n<r;n+=1){var o=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(o,n)}}},{key:"cacheFromVisualToRenderableIndexes",value:function(){var r=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(var n=0;n<r;n+=1){var o=this.getPhysicalFromRenderableIndex(n),i=this.getVisualFromPhysicalIndex(o);this.fromVisualToRenderableIndexesCache.set(i,n)}}}]),e}();pt(N_,kr);var YI;function Rme(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Eme(e,t){return We(t,function(r,n){gt(e[n])&&(e[n]=r)}),e}function n2(e){var t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/,r=t.exec(e);return r?"".concat(r[1].toLowerCase(),"-").concat(r[2].toUpperCase()):e}function o2(e){ve(e)&&gE(ft(YI||(YI=Rme(['Language with code "',`" was not found. You should register particular language 
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`],['Language with code "',`" was not found. You should register particular language\\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`])),e))}function Tme(e,t){var r=Array.isArray(e)&&Number.isInteger(t);return r?e[t]:e}var i2=Jr("phraseFormatters"),Pme=i2.register,kme=i2.getValues;function $me(e,t){Pme(e,t)}function Ame(){return kme()}$me("pluralize",Tme);var a2="ContextMenu:items",Fe=a2,VE="".concat(Fe,".noItems"),WE="".concat(Fe,".insertRowAbove"),UE="".concat(Fe,".insertRowBelow"),zE="".concat(Fe,".insertColumnOnTheLeft"),YE="".concat(Fe,".insertColumnOnTheRight"),GE="".concat(Fe,".removeRow"),KE="".concat(Fe,".removeColumn"),qE="".concat(Fe,".undo"),XE="".concat(Fe,".redo"),ZE="".concat(Fe,".readOnly"),QE="".concat(Fe,".clearColumn"),JE="".concat(Fe,".copy"),eT="".concat(Fe,".copyWithHeaders"),tT="".concat(Fe,".copyWithGroupHeaders"),rT="".concat(Fe,".copyHeadersOnly"),nT="".concat(Fe,".cut"),oT="".concat(Fe,".freezeColumn"),iT="".concat(Fe,".unfreezeColumn"),aT="".concat(Fe,".mergeCells"),lT="".concat(Fe,".unmergeCells"),sT="".concat(Fe,".addComment"),uT="".concat(Fe,".editComment"),fT="".concat(Fe,".removeComment"),cT="".concat(Fe,".readOnlyComment"),hT="".concat(Fe,".align"),dT="".concat(Fe,".align.left"),vT="".concat(Fe,".align.center"),yT="".concat(Fe,".align.right"),gT="".concat(Fe,".align.justify"),pT="".concat(Fe,".align.top"),mT="".concat(Fe,".align.middle"),bT="".concat(Fe,".align.bottom"),wT="".concat(Fe,".borders"),ST="".concat(Fe,".borders.top"),CT="".concat(Fe,".borders.right"),_T="".concat(Fe,".borders.bottom"),OT="".concat(Fe,".borders.left"),RT="".concat(Fe,".borders.remove"),ET="".concat(Fe,".nestedHeaders.insertChildRow"),TT="".concat(Fe,".nestedHeaders.detachFromParent"),PT="".concat(Fe,".hideColumn"),kT="".concat(Fe,".showColumn"),$T="".concat(Fe,".hideRow"),AT="".concat(Fe,".showRow"),wr="Filters:",xt="".concat(wr,"conditions"),Hm="".concat(xt,".none"),IT="".concat(xt,".isEmpty"),MT="".concat(xt,".isNotEmpty"),xT="".concat(xt,".isEqualTo"),DT="".concat(xt,".isNotEqualTo"),NT="".concat(xt,".beginsWith"),HT="".concat(xt,".endsWith"),LT="".concat(xt,".contains"),jT="".concat(xt,".doesNotContain"),Ime="".concat(xt,".byValue"),FT="".concat(xt,".greaterThan"),BT="".concat(xt,".greaterThanOrEqualTo"),VT="".concat(xt,".lessThan"),WT="".concat(xt,".lessThanOrEqualTo"),UT="".concat(xt,".isBetween"),zT="".concat(xt,".isNotBetween"),YT="".concat(xt,".after"),GT="".concat(xt,".before"),KT="".concat(xt,".today"),qT="".concat(xt,".tomorrow"),XT="".concat(xt,".yesterday"),ZT="".concat(wr,"labels.filterByCondition"),QT="".concat(wr,"labels.filterByValue"),JT="".concat(wr,"labels.conjunction"),Lm="".concat(wr,"labels.disjunction"),_p="".concat(wr,"values.blankCells"),eP="".concat(wr,"buttons.selectAll"),tP="".concat(wr,"buttons.clear"),rP="".concat(wr,"buttons.ok"),nP="".concat(wr,"buttons.cancel"),oP="".concat(wr,"buttons.placeholder.search"),iP="".concat(wr,"buttons.placeholder.value"),aP="".concat(wr,"buttons.placeholder.secondValue");const Mme=Object.freeze(Object.defineProperty({__proto__:null,CONTEXTMENU_ITEMS_ADD_COMMENT:sT,CONTEXTMENU_ITEMS_ALIGNMENT:hT,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:bT,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:vT,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:gT,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:dT,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:mT,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:yT,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:pT,CONTEXTMENU_ITEMS_BORDERS:wT,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:_T,CONTEXTMENU_ITEMS_BORDERS_LEFT:OT,CONTEXTMENU_ITEMS_BORDERS_RIGHT:CT,CONTEXTMENU_ITEMS_BORDERS_TOP:ST,CONTEXTMENU_ITEMS_CLEAR_COLUMN:QE,CONTEXTMENU_ITEMS_COPY:JE,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:rT,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:tT,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:eT,CONTEXTMENU_ITEMS_CUT:nT,CONTEXTMENU_ITEMS_EDIT_COMMENT:uT,CONTEXTMENU_ITEMS_FREEZE_COLUMN:oT,CONTEXTMENU_ITEMS_HIDE_COLUMN:PT,CONTEXTMENU_ITEMS_HIDE_ROW:$T,CONTEXTMENU_ITEMS_INSERT_LEFT:zE,CONTEXTMENU_ITEMS_INSERT_RIGHT:YE,CONTEXTMENU_ITEMS_MERGE_CELLS:aT,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:TT,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:ET,CONTEXTMENU_ITEMS_NO_ITEMS:VE,CONTEXTMENU_ITEMS_READ_ONLY:ZE,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:cT,CONTEXTMENU_ITEMS_REDO:XE,CONTEXTMENU_ITEMS_REMOVE_BORDERS:RT,CONTEXTMENU_ITEMS_REMOVE_COLUMN:KE,CONTEXTMENU_ITEMS_REMOVE_COMMENT:fT,CONTEXTMENU_ITEMS_REMOVE_ROW:GE,CONTEXTMENU_ITEMS_ROW_ABOVE:WE,CONTEXTMENU_ITEMS_ROW_BELOW:UE,CONTEXTMENU_ITEMS_SHOW_COLUMN:kT,CONTEXTMENU_ITEMS_SHOW_ROW:AT,CONTEXTMENU_ITEMS_UNDO:qE,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:iT,CONTEXTMENU_ITEMS_UNMERGE_CELLS:lT,CONTEXT_MENU_ITEMS_NAMESPACE:a2,FILTERS_BUTTONS_CANCEL:nP,FILTERS_BUTTONS_CLEAR:tP,FILTERS_BUTTONS_OK:rP,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:oP,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:aP,FILTERS_BUTTONS_PLACEHOLDER_VALUE:iP,FILTERS_BUTTONS_SELECT_ALL:eP,FILTERS_CONDITIONS_AFTER:YT,FILTERS_CONDITIONS_BEFORE:GT,FILTERS_CONDITIONS_BEGINS_WITH:NT,FILTERS_CONDITIONS_BETWEEN:UT,FILTERS_CONDITIONS_BY_VALUE:Ime,FILTERS_CONDITIONS_CONTAINS:LT,FILTERS_CONDITIONS_EMPTY:IT,FILTERS_CONDITIONS_ENDS_WITH:HT,FILTERS_CONDITIONS_EQUAL:xT,FILTERS_CONDITIONS_GREATER_THAN:FT,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:BT,FILTERS_CONDITIONS_LESS_THAN:VT,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:WT,FILTERS_CONDITIONS_NAMESPACE:xt,FILTERS_CONDITIONS_NONE:Hm,FILTERS_CONDITIONS_NOT_BETWEEN:zT,FILTERS_CONDITIONS_NOT_CONTAIN:jT,FILTERS_CONDITIONS_NOT_EMPTY:MT,FILTERS_CONDITIONS_NOT_EQUAL:DT,FILTERS_CONDITIONS_TODAY:KT,FILTERS_CONDITIONS_TOMORROW:qT,FILTERS_CONDITIONS_YESTERDAY:XT,FILTERS_DIVS_FILTER_BY_CONDITION:ZT,FILTERS_DIVS_FILTER_BY_VALUE:QT,FILTERS_LABELS_CONJUNCTION:JT,FILTERS_LABELS_DISJUNCTION:Lm,FILTERS_NAMESPACE:wr,FILTERS_VALUES_BLANK_CELLS:_p},Symbol.toStringTag,{value:"Module"}));function _h(e){"@babel/helpers - typeof";return _h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_h(e)}var ue;function fe(e,t,r){return t=xme(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xme(e){var t=Dme(e,"string");return _h(t)==="symbol"?t:String(t)}function Dme(e,t){if(_h(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_h(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Nme=(ue={languageCode:"en-US"},fe(ue,VE,"No available options"),fe(ue,WE,"Insert row above"),fe(ue,UE,"Insert row below"),fe(ue,zE,"Insert column left"),fe(ue,YE,"Insert column right"),fe(ue,GE,["Remove row","Remove rows"]),fe(ue,KE,["Remove column","Remove columns"]),fe(ue,qE,"Undo"),fe(ue,XE,"Redo"),fe(ue,ZE,"Read only"),fe(ue,QE,"Clear column"),fe(ue,hT,"Alignment"),fe(ue,dT,"Left"),fe(ue,vT,"Center"),fe(ue,yT,"Right"),fe(ue,gT,"Justify"),fe(ue,pT,"Top"),fe(ue,mT,"Middle"),fe(ue,bT,"Bottom"),fe(ue,oT,"Freeze column"),fe(ue,iT,"Unfreeze column"),fe(ue,wT,"Borders"),fe(ue,ST,"Top"),fe(ue,CT,"Right"),fe(ue,_T,"Bottom"),fe(ue,OT,"Left"),fe(ue,RT,"Remove border(s)"),fe(ue,sT,"Add comment"),fe(ue,uT,"Edit comment"),fe(ue,fT,"Delete comment"),fe(ue,cT,"Read-only comment"),fe(ue,aT,"Merge cells"),fe(ue,lT,"Unmerge cells"),fe(ue,JE,"Copy"),fe(ue,eT,["Copy with header","Copy with headers"]),fe(ue,tT,["Copy with group header","Copy with group headers"]),fe(ue,rT,["Copy header only","Copy headers only"]),fe(ue,nT,"Cut"),fe(ue,ET,"Insert child row"),fe(ue,TT,"Detach from parent"),fe(ue,PT,["Hide column","Hide columns"]),fe(ue,kT,["Show column","Show columns"]),fe(ue,$T,["Hide row","Hide rows"]),fe(ue,AT,["Show row","Show rows"]),fe(ue,Hm,"None"),fe(ue,IT,"Is empty"),fe(ue,MT,"Is not empty"),fe(ue,xT,"Is equal to"),fe(ue,DT,"Is not equal to"),fe(ue,NT,"Begins with"),fe(ue,HT,"Ends with"),fe(ue,LT,"Contains"),fe(ue,jT,"Does not contain"),fe(ue,FT,"Greater than"),fe(ue,BT,"Greater than or equal to"),fe(ue,VT,"Less than"),fe(ue,WT,"Less than or equal to"),fe(ue,UT,"Is between"),fe(ue,zT,"Is not between"),fe(ue,YT,"After"),fe(ue,GT,"Before"),fe(ue,KT,"Today"),fe(ue,qT,"Tomorrow"),fe(ue,XT,"Yesterday"),fe(ue,_p,"Blank cells"),fe(ue,ZT,"Filter by condition"),fe(ue,QT,"Filter by value"),fe(ue,JT,"And"),fe(ue,Lm,"Or"),fe(ue,eP,"Select all"),fe(ue,tP,"Clear"),fe(ue,rP,"OK"),fe(ue,nP,"Cancel"),fe(ue,oP,"Search"),fe(ue,iP,"Value"),fe(ue,aP,"Second value"),ue);const l2=Nme;var H_=l2.languageCode,jm=Jr("languagesDictionaries"),Hme=jm.register,s2=jm.getItem,Lme=jm.hasItem,jme=jm.getValues;u2(l2);function u2(e,t){var r=e,n=t;return Ve(e)&&(n=e,r=n.languageCode),Fme(r,n),Hme(r,lr(n)),lr(n)}function Fme(e,t){e!==H_&&Eme(t,s2(H_))}function f2(e){return lP(e)?lr(s2(e)):null}function lP(e){return Lme(e)}function Bme(){return jme()}function c2(e,t,r){var n=f2(e);if(n===null)return null;var o=n[t];if(gt(o))return null;var i=Vme(o,r);return Array.isArray(i)?i[0]:i}function Vme(e,t){var r=e;return $(Ame(),function(n){r=n(e,t)}),r}function Wme(e){var t=n2(e);return lP(t)||(t=H_,o2(e)),t}var Ume=$e,zme=Ut,Yme=nj,Gme=Br,Kme=Ln,qme=nv;Ume({target:"Object",stat:!0,sham:!zme},{getOwnPropertyDescriptors:function(t){for(var r=Gme(t),n=Kme.f,o=Yme(r),i={},a=0,l,s;o.length>a;)s=n(r,l=o[a++]),s!==void 0&&qme(i,l,s);return i}});var Fm="active-header",Bm="area",Oh="cell",sP="fill",Sv="header",uP="custom-selection";function js(e){"@babel/helpers - typeof";return js=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},js(e)}function Xme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,d2(n.key),n)}}function Zme(e,t,r){return t&&GI(e.prototype,t),r&&GI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lg(){return typeof Reflect<"u"&&Reflect.get?lg=Reflect.get.bind():lg=function(t,r,n){var o=Qme(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},lg.apply(this,arguments)}function Qme(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Fs(e),e!==null););return e}function Jme(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&L_(e,t)}function L_(e,t){return L_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},L_(e,t)}function ebe(e){var t=rbe();return function(){var n=Fs(e),o;if(t){var i=Fs(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return tbe(this,o)}}function tbe(e,t){if(t&&(js(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return h2(e)}function h2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rbe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Fs(e){return Fs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Fs(e)}function nbe(e,t,r){return t=d2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function d2(e){var t=obe(e,"string");return js(t)==="symbol"?t:String(t)}function obe(e,t){if(js(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(js(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ibe=function(e){Jme(r,e);var t=ebe(r);function r(n,o){var i;return Xme(this,r),i=t.call(this,n,null),nbe(h2(i),"visualCellRange",null),i.visualCellRange=o||null,i.commit(),i}return Zme(r,[{key:"add",value:function(o){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(o):this.visualCellRange.expand(o),this}},{key:"clear",value:function(){return this.visualCellRange=null,lg(Fs(r.prototype),"clear",this).call(this)}},{key:"trimToVisibleCellsRangeOnly",value:function(o){var i=o.from,a=o.to,l=this.getNearestNotHiddenCoords(i,1),s=this.getNearestNotHiddenCoords(a,-1);if(l===null||s===null)return null;if(l.row>s.row||l.col>s.col){var u=this.settings.type==="header"||this.settings.type==="active-header";if(!u)return null;l=i,s=a}return this.settings.createCellRange(l,l,s)}},{key:"getNearestNotHiddenCoords",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:i,l=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper(),o.row,i);if(l===null)return null;var s=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper(),o.col,a);return s===null?null:this.settings.createCellCoords(l,s)}},{key:"getNearestNotHiddenIndex",value:function(o,i,a){if(i<0)return i;var l=o.getNearestNotHiddenIndex(i,a),s=this.settings.type==="header"||this.settings.type==="active-header";return s&&l===null?-1:l}},{key:"commit",value:function(){if(this.visualCellRange===null)return this;var o=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return o===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(o.from,o.to),this}},{key:"syncWith",value:function(o){var i=o.getVerticalDirection()==="N-S"?1:-1,a=o.getHorizontalDirection()==="W-E"?1:-1,l=this.getNearestNotHiddenCoords(o.from.clone().normalize(),i,a);if(l!==null&&o.overlaps(l)){if(this.cellRange===null){var s=this.settings.visualToRenderableCoords(l);this.cellRange=this.settings.createCellRange(s)}return o.setHighlight(l),this}return o.setHighlight(o.from),this}},{key:"getCorners",value:function(){var o=this.cellRange,i=o.from,a=o.to,l=i.row===null||a.row===null,s=i.col===null||a.col===null,u=this.settings.createCellCoords(l?null:Math.min(i.row,a.row),s?null:Math.min(i.col,a.col)),f=this.settings.createCellCoords(l?null:Math.max(i.row,a.row),s?null:Math.max(i.col,a.col));return[u.row,u.col,f.row,f.col]}},{key:"getVisualCorners",value:function(){var o=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),i=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[o.row,o.col,i.row,i.col]}},{key:"createRenderableCellRange",value:function(o,i){var a=this.settings.visualToRenderableCoords(o),l=this.settings.visualToRenderableCoords(i);return this.settings.createCellRange(a,a,l)}}]),r}(Lye);const Of=ibe;function Rh(e){"@babel/helpers - typeof";return Rh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rh(e)}var abe=["activeHeaderClassName"];function KI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function qI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?KI(Object(r),!0).forEach(function(n){lbe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):KI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function lbe(e,t,r){return t=sbe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sbe(e){var t=ube(e,"string");return Rh(t)==="symbol"?t:String(t)}function ube(e,t){if(Rh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fbe(e,t){if(e==null)return{};var r=cbe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function cbe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function hbe(e){var t=e.activeHeaderClassName,r=fbe(e,abe),n=new Of(qI(qI({highlightHeaderClassName:t},r),{},{selectionType:Fm}));return n}function Eh(e){"@babel/helpers - typeof";return Eh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Eh(e)}var dbe=["layerLevel","areaCornerVisible"];function XI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function ZI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?XI(Object(r),!0).forEach(function(n){vbe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):XI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function vbe(e,t,r){return t=ybe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ybe(e){var t=gbe(e,"string");return Eh(t)==="symbol"?t:String(t)}function gbe(e,t){if(Eh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Eh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pbe(e,t){if(e==null)return{};var r=mbe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function mbe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function bbe(e){var t=e.layerLevel,r=e.areaCornerVisible,n=pbe(e,dbe),o=new Of(ZI(ZI({className:"area",markIntersections:!0,layerLevel:Math.min(t,7),border:{width:1,color:"#4b89ff",cornerVisible:r}},n),{},{selectionType:Bm}));return o}function Th(e){"@babel/helpers - typeof";return Th=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Th(e)}var wbe=["cellCornerVisible"];function QI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function JI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?QI(Object(r),!0).forEach(function(n){Sbe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):QI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Sbe(e,t,r){return t=Cbe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Cbe(e){var t=_be(e,"string");return Th(t)==="symbol"?t:String(t)}function _be(e,t){if(Th(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Th(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Obe(e,t){if(e==null)return{};var r=Rbe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Rbe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function Ebe(e){var t=e.cellCornerVisible,r=Obe(e,wbe),n=new Of(JI(JI({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:t}},r),{},{selectionType:Oh}));return n}function Ph(e){"@babel/helpers - typeof";return Ph=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ph(e)}var Tbe=["border","visualCellRange"];function eM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function $w(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eM(Object(r),!0).forEach(function(n){Pbe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Pbe(e,t,r){return t=kbe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kbe(e){var t=$be(e,"string");return Ph(t)==="symbol"?t:String(t)}function $be(e,t){if(Ph(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ph(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Abe(e,t){if(e==null)return{};var r=Ibe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Ibe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function Mbe(e){var t=e.border,r=e.visualCellRange,n=Abe(e,Tbe),o=new Of($w($w($w({},t),n),{},{selectionType:uP}),r);return o}var tM=Ut,xbe=Ue,Dbe=zt,Nbe=je,Aw=Yd,Hbe=Ud,Lbe=Hd,jbe=Pr,Fbe=jd,vl=Object.assign,rM=Object.defineProperty,Bbe=xbe([].concat),Vbe=!vl||Nbe(function(){if(tM&&vl({b:1},vl(rM({},"a",{enumerable:!0,get:function(){rM(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var e={},t={},r=Symbol("assign detection"),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(o){t[o]=o}),vl({},e)[r]!==7||Aw(vl({},t)).join("")!==n})?function(t,r){for(var n=jbe(t),o=arguments.length,i=1,a=Hbe.f,l=Lbe.f;o>i;)for(var s=Fbe(arguments[i++]),u=a?Bbe(Aw(s),a(s)):Aw(s),f=u.length,c=0,h;f>c;)h=u[c++],(!tM||Dbe(l,s,h))&&(n[h]=s[h]);return n}:vl,Wbe=$e,nM=Vbe;Wbe({target:"Object",stat:!0,arity:2,forced:Object.assign!==nM},{assign:nM});function kh(e){"@babel/helpers - typeof";return kh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kh(e)}function oM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function iM(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?oM(Object(r),!0).forEach(function(n){Ube(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ube(e,t,r){return t=zbe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zbe(e){var t=Ybe(e,"string");return kh(t)==="symbol"?t:String(t)}function Ybe(e,t){if(kh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(kh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gbe(e){if(e==null)throw new TypeError("Cannot destructure "+e)}function Kbe(e){var t=Object.assign({},(Gbe(e),e)),r=new Of(iM(iM({className:"fill",border:{width:1,color:"#ff0000"}},t),{},{selectionType:sP}));return r}function $h(e){"@babel/helpers - typeof";return $h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$h(e)}var qbe=["headerClassName","rowClassName","columnClassName"];function aM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function lM(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aM(Object(r),!0).forEach(function(n){Xbe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Xbe(e,t,r){return t=Zbe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Zbe(e){var t=Qbe(e,"string");return $h(t)==="symbol"?t:String(t)}function Qbe(e,t){if($h(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($h(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Jbe(e,t){if(e==null)return{};var r=ewe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function ewe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function twe(e){var t=e.headerClassName,r=e.rowClassName,n=e.columnClassName,o=Jbe(e,qbe),i=new Of(lM(lM({className:"highlight",highlightHeaderClassName:t,highlightRowClassName:r,highlightColumnClassName:n},o),{},{highlightOnlyClosestHeader:!0,selectionType:Sv}));return i}function Ah(e){"@babel/helpers - typeof";return Ah=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ah(e)}function sM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function rwe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?sM(Object(r),!0).forEach(function(n){nwe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nwe(e,t,r){return t=owe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function owe(e){var t=iwe(e,"string");return Ah(t)==="symbol"?t:String(t)}function iwe(e,t){if(Ah(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ah(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var v2=Jr("highlight/types"),Rf=v2.register,awe=v2.getItem;Rf(Fm,hbe);Rf(Bm,bbe);Rf(Oh,Ebe);Rf(uP,Mbe);Rf(sP,Kbe);Rf(Sv,twe);function yl(e,t){return awe(e)(rwe({type:e},t))}function Ih(e){"@babel/helpers - typeof";return Ih=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ih(e)}function Yo(e){return fwe(e)||uwe(e)||swe(e)||lwe()}function lwe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function swe(e,t){if(e){if(typeof e=="string")return j_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return j_(e,t)}}function uwe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function fwe(e){if(Array.isArray(e))return j_(e)}function j_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function uM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Wf(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?uM(Object(r),!0).forEach(function(n){cwe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):uM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function cwe(e,t,r){return t=y2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hwe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,y2(n.key),n)}}function dwe(e,t,r){return t&&fM(e.prototype,t),r&&fM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function y2(e){var t=vwe(e,"string");return Ih(t)==="symbol"?t:String(t)}function vwe(e,t){if(Ih(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ih(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ywe=function(e){function t(r){hwe(this,t),this.options=r,this.layerLevel=0,this.cell=yl(Oh,r),this.fill=yl(sP,r),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}return dwe(t,[{key:"isEnabledFor",value:function(n,o){var i=n;n===Oh&&(i="current");var a=this.options.disabledCellSelection(o.row,o.col);return typeof a=="string"&&(a=[a]),a===!1||Array.isArray(a)&&!a.includes(i)}},{key:"useLayerLevel",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=n,this}},{key:"getCell",value:function(){return this.cell}},{key:"getFill",value:function(){return this.fill}},{key:"createOrGetArea",value:function(){var n=this.layerLevel,o;return this.areas.has(n)?o=this.areas.get(n):(o=yl(Bm,Wf({layerLevel:n},this.options)),this.areas.set(n,o)),o}},{key:"getAreas",value:function(){return Yo(this.areas.values())}},{key:"createOrGetHeader",value:function(){var n=this.layerLevel,o;return this.headers.has(n)?o=this.headers.get(n):(o=yl(Sv,Wf({},this.options)),this.headers.set(n,o)),o}},{key:"getHeaders",value:function(){return Yo(this.headers.values())}},{key:"createOrGetActiveHeader",value:function(){var n=this.layerLevel,o;return this.activeHeaders.has(n)?o=this.activeHeaders.get(n):(o=yl(Fm,Wf({},this.options)),this.activeHeaders.set(n,o)),o}},{key:"getActiveHeaders",value:function(){return Yo(this.activeHeaders.values())}},{key:"getCustomSelections",value:function(){return Yo(this.customSelections.values())}},{key:"addCustomSelection",value:function(n){this.customSelections.push(yl(uP,Wf(Wf({},this.options),n)))}},{key:"clear",value:function(){this.cell.clear(),this.fill.clear(),$(this.areas.values(),function(n){return void n.clear()}),$(this.headers.values(),function(n){return void n.clear()}),$(this.activeHeaders.values(),function(n){return void n.clear()})}},{key:e,value:function(){return[this.cell,this.fill].concat(Yo(this.areas.values()),Yo(this.headers.values()),Yo(this.activeHeaders.values()),Yo(this.customSelections))[Symbol.iterator]()}}]),t}(Symbol.iterator);const gwe=ywe;function Mh(e){"@babel/helpers - typeof";return Mh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mh(e)}function pwe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bwe(n.key),n)}}function mwe(e,t,r){return t&&cM(e.prototype,t),r&&cM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bwe(e){var t=wwe(e,"string");return Mh(t)==="symbol"?t:String(t)}function wwe(e,t){if(Mh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Mh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Swe=function(e){function t(r){pwe(this,t),this.ranges=[],this.createCellRange=r}return mwe(t,[{key:"isEmpty",value:function(){return this.size()===0}},{key:"set",value:function(n){return this.clear(),this.ranges.push(this.createCellRange(n)),this}},{key:"add",value:function(n){return this.ranges.push(this.createCellRange(n)),this}},{key:"pop",value:function(){return this.ranges.pop(),this}},{key:"current",value:function(){return this.peekByIndex(0)}},{key:"previous",value:function(){return this.peekByIndex(-1)}},{key:"includes",value:function(n){return this.ranges.some(function(o){return o.includes(n)})}},{key:"clear",value:function(){return this.ranges.length=0,this}},{key:"size",value:function(){return this.ranges.length}},{key:"peekByIndex",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,o=this.size()+n-1,i;return o>=0&&(i=this.ranges[o]),i}},{key:e,value:function(){return this.ranges[Symbol.iterator]()}}]),t}(Symbol.iterator);const Cwe=Swe;function xh(e){"@babel/helpers - typeof";return xh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xh(e)}function _we(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Rwe(n.key),n)}}function Owe(e,t,r){return t&&hM(e.prototype,t),r&&hM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Rwe(e){var t=Ewe(e,"string");return xh(t)==="symbol"?t:String(t)}function Ewe(e,t){if(xh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var g2=function(){function e(t,r){_we(this,e),this.range=t,this.options=r}return Owe(e,[{key:"transformStart",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.options.createCellCoords(r,n),a=this.range.current().highlight,l=this.options.visualToRenderableCoords(a),s=l.row,u=l.col,f=a,c=0,h=0;if(this.runLocalHooks("beforeTransformStart",i),s!==null&&u!==null){var d=this.options.countRows(),v=this.options.countCols(),g=this.options.fixedRowsBottom(),m=this.options.minSpareRows(),w=this.options.minSpareCols(),S=this.options.autoWrapRow(),C=this.options.autoWrapCol();s+r>d-1?o&&m>0&&!(g&&s>=d-g-1)?(this.runLocalHooks("insertRowRequire",d),d=this.options.countRows()):C&&(i.row=1-d,i.col=u+i.col===v-1?1-v:1):C&&s+i.row<0&&u+i.col>=0&&(i.row=d-1,i.col=u+i.col===0?v-1:-1),u+i.col>v-1?o&&w>0?(this.runLocalHooks("insertColRequire",v),v=this.options.countCols()):S&&(i.row=s+i.row===d-1?1-d:1,i.col=1-v):S&&u+i.col<0&&s+i.row>=0&&(i.row=s+i.row===0?d-1:-1,i.col=v-1);var P=this.options.createCellCoords(s+i.row,u+i.col);c=0,h=0,P.row<0?(c=-1,P.row=0):P.row>0&&P.row>=d&&(c=1,P.row=d-1),P.col<0?(h=-1,P.col=0):P.col>0&&P.col>=v&&(h=1,P.col=v-1),f=this.options.renderableToVisualCoords(P)}return this.runLocalHooks("afterTransformStart",f,c,h),f}},{key:"transformEnd",value:function(r,n){var o=this.options.createCellCoords(r,n),i=this.range.current(),a=i.to,l=0,s=0;this.runLocalHooks("beforeTransformEnd",o);var u=this.options.visualToRenderableCoords(i.highlight),f=u.row,c=u.col;if(f!==null&&c!==null){var h=this.options.countRows(),d=this.options.countCols(),v=this.options.visualToRenderableCoords(i.to),g=v.row,m=v.col,w=this.options.createCellCoords(g+o.row,m+o.col);l=0,s=0,w.row<0?(l=-1,w.row=0):w.row>0&&w.row>=h&&(l=1,w.row=h-1),w.col<0?(s=-1,w.col=0):w.col>0&&w.col>=d&&(s=1,w.col=d-1),a=this.options.renderableToVisualCoords(w)}return this.runLocalHooks("afterTransformEnd",a,l,s),a}}]),e}();pt(g2,kr);const Twe=g2;function p2(e,t){return Awe(e)||$we(e,t)||kwe(e,t)||Pwe()}function Pwe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kwe(e,t){if(e){if(typeof e=="string")return dM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dM(e,t)}}function dM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function $we(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Awe(e){if(Array.isArray(e))return e}function F_(e){"@babel/helpers - typeof";return F_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},F_(e)}var Vm=0,Wm=1,m2=2,fP=3,Iwe=[fP,m2],Mwe=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],Iw=Symbol("root"),vM=Symbol("child");function Bs(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Iw;if(t!==Iw&&t!==vM)throw new Error("The second argument is used internally only and cannot be overwritten.");var r=Array.isArray(e),n=t===Iw,o=Vm;if(r){var i=e[0];if(e.length===0)o=Wm;else if(n&&i instanceof _E)o=fP;else if(n&&Array.isArray(i))o=Bs(i,vM);else if(e.length>=2&&e.length<=4){var a=!e.some(function(l,s){return!Mwe[s].includes(F_(l))});a&&(o=m2)}}return o}function Dh(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.keepDirection,n=r===void 0?!1:r,o=t.propToCol;if(!Iwe.includes(e))throw new Error("Unsupported selection ranges schema type was provided.");return function(i){var a=e===fP,l=a?i.from.row:i[0],s=a?i.from.col:i[1],u=a?i.to.row:i[2],f=a?i.to.col:i[3];if(typeof o=="function"&&(typeof s=="string"&&(s=o(s)),typeof f=="string"&&(f=o(f))),gt(u)&&(u=l),gt(f)&&(f=s),!n){var c=l,h=s,d=u,v=f;l=Math.min(c,d),s=Math.min(h,v),u=Math.max(c,d),f=Math.max(h,v)}return[l,s,u,f]}}function xwe(e){var t=Bs(e);if(t===Vm||t===Wm)return[];var r=Dh(t),n=new Set;$(e,function(a){var l=r(a),s=p2(l,4),u=s[1],f=s[3],c=Math.max(u,0),h=f-c+1;$(Array.from(new Array(h),function(d,v){return c+v}),function(d){n.has(d)||n.add(d)})});var o=Array.from(n).sort(function(a,l){return a-l}),i=Lt(o,function(a,l,s,u){return s!==0&&l===u[s-1]+1?a[a.length-1][1]+=1:a.push([l,1]),a},[]);return i}function Dwe(e){var t=Bs(e);if(t===Vm||t===Wm)return[];var r=Dh(t),n=new Set;$(e,function(a){var l=r(a),s=p2(l,3),u=s[0],f=s[2],c=Math.max(u,0),h=f-c+1;$(Array.from(new Array(h),function(d,v){return c+v}),function(d){n.has(d)||n.add(d)})});var o=Array.from(n).sort(function(a,l){return a-l}),i=Lt(o,function(a,l,s,u){return s!==0&&l===u[s-1]+1?a[a.length-1][1]+=1:a.push([l,1]),a},[]);return i}function Go(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;return typeof e=="number"&&e>=0&&e<t}function Nh(e){"@babel/helpers - typeof";return Nh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nh(e)}var yM;function gM(e,t){return jwe(e)||Lwe(e,t)||Hwe(e,t)||Nwe()}function Nwe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Hwe(e,t){if(e){if(typeof e=="string")return pM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pM(e,t)}}function pM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Lwe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function jwe(e){if(Array.isArray(e))return e}function Fwe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Bwe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Wwe(n.key),n)}}function Vwe(e,t,r){return t&&mM(e.prototype,t),r&&mM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Wwe(e){var t=Uwe(e,"string");return Nh(t)==="symbol"?t:String(t)}function Uwe(e,t){if(Nh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Nh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var b2=function(){function e(t,r){var n=this;Bwe(this,e),this.settings=t,this.tableProps=r,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new Cwe(function(o,i,a){return n.tableProps.createCellRange(o,i,a)}),this.highlight=new gwe({headerClassName:t.currentHeaderClassName,activeHeaderClassName:t.activeHeaderClassName,rowClassName:t.currentRowClassName,columnClassName:t.currentColClassName,disabledCellSelection:function(i,a){return n.tableProps.isDisabledCellSelection(i,a)},cellCornerVisible:function(){return n.isCellCornerVisible.apply(n,arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible.apply(n,arguments)},visualToRenderableCoords:function(i){return n.tableProps.visualToRenderableCoords(i)},renderableToVisualCoords:function(i){return n.tableProps.renderableToVisualCoords(i)},createCellCoords:function(i,a){return n.tableProps.createCellCoords(i,a)},createCellRange:function(i,a,l){return n.tableProps.createCellRange(i,a,l)},rowIndexMapper:function(){return n.tableProps.rowIndexMapper()},columnIndexMapper:function(){return n.tableProps.columnIndexMapper()}}),this.transformation=new Twe(this.selectedRange,{countRows:function(){return n.tableProps.countRowsTranslated()},countCols:function(){return n.tableProps.countColsTranslated()},visualToRenderableCoords:function(i){return n.tableProps.visualToRenderableCoords(i)},renderableToVisualCoords:function(i){return n.tableProps.renderableToVisualCoords(i)},createCellCoords:function(i,a){return n.tableProps.createCellCoords(i,a)},fixedRowsBottom:function(){return t.fixedRowsBottom},minSpareRows:function(){return t.minSpareRows},minSpareCols:function(){return t.minSpareCols},autoWrapRow:function(){return t.autoWrapRow},autoWrapCol:function(){return t.autoWrapCol}}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["beforeModifyTransformStart"].concat(i))}),this.transformation.addLocalHook("afterTransformStart",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["afterModifyTransformStart"].concat(i))}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["beforeModifyTransformEnd"].concat(i))}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["afterModifyTransformEnd"].concat(i))}),this.transformation.addLocalHook("insertRowRequire",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["insertRowRequire"].concat(i))}),this.transformation.addLocalHook("insertColRequire",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["insertColRequire"].concat(i))})}return Vwe(e,[{key:"getSelectedRange",value:function(){return this.selectedRange}},{key:"begin",value:function(){this.inProgress=!0}},{key:"finish",value:function(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}},{key:"isInProgress",value:function(){return this.inProgress}},{key:"setRangeStart",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.settings.selectionMode==="multiple",a=gt(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,l=r.row<0,s=r.col<0,u=l&&s,f=r.clone();this.selectedByCorner=u,this.runLocalHooks("beforeSetRangeStart".concat(o?"Only":""),f),(!i||i&&!a&&gt(n))&&this.selectedRange.clear(),this.selectedRange.add(f),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!u&&s&&this.selectedByRowHeader.add(this.getLayerLevel()),!u&&l&&this.selectedByColumnHeader.add(this.getLayerLevel()),o||this.setRangeEnd(r)}},{key:"setRangeStartOnly",value:function(r,n){this.setRangeStart(r,n,!0)}},{key:"setRangeEnd",value:function(r){if(!this.selectedRange.isEmpty()){var n=r.clone();this.runLocalHooks("beforeSetRangeEnd",n),this.begin();var o=this.selectedRange.current();this.settings.selectionMode!=="single"&&o.setTo(this.tableProps.createCellCoords(n.row,n.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(Oh,o.highlight)&&this.highlight.getCell().add(this.selectedRange.current().highlight).commit().syncWith(o);var i=this.getLayerLevel();i<this.highlight.layerLevel&&($(this.highlight.getAreas(),function(g){return void g.clear()}),$(this.highlight.getHeaders(),function(g){return void g.clear()}),$(this.highlight.getActiveHeaders(),function(g){return void g.clear()})),this.highlight.useLayerLevel(i);var a=this.highlight.createOrGetArea(),l=this.highlight.createOrGetHeader(),s=this.highlight.createOrGetActiveHeader();if(a.clear(),l.clear(),s.clear(),this.highlight.isEnabledFor(Bm,o.highlight)&&(this.isMultiple()||i>=1)&&(a.add(o.from).add(o.to).commit(),i===1)){var u=this.selectedRange.previous();this.highlight.useLayerLevel(i-1).createOrGetArea().add(u.from).commit().syncWith(u),this.highlight.useLayerLevel(i)}if(this.highlight.isEnabledFor(Sv,o.highlight)){var f=this.tableProps.countRowsTranslated()===0,c=this.tableProps.countColsTranslated()===0,h=o;if((f||c)&&(h=o.clone()),f&&(h.from.row=-1),c&&(h.from.col=-1),this.settings.selectionMode==="single"?(this.isSelectedByAnyHeader()&&h.from.normalize(),l.add(h.from).commit()):l.add(h.from).add(h.to).commit(),this.isEntireRowSelected()){var d=this.tableProps.countCols()===o.getWidth();d&&s.add(this.tableProps.createCellCoords(o.from.row,-1)).add(this.tableProps.createCellCoords(o.to.row,-1)).commit()}if(this.isEntireColumnSelected()){var v=this.tableProps.countRows()===o.getHeight();v&&s.add(this.tableProps.createCellCoords(-1,o.from.col)).add(this.tableProps.createCellCoords(-1,o.to.col)).commit()}}this.runLocalHooks("afterSetRangeEnd",r)}}},{key:"isMultiple",value:function(){var r=Ia(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",r),r.value}},{key:"transformStart",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.setRangeStart(this.transformation.transformStart(r,n,o))}},{key:"transformEnd",value:function(r,n){this.setRangeEnd(this.transformation.transformEnd(r,n))}},{key:"getLayerLevel",value:function(){return this.selectedRange.size()-1}},{key:"isSelected",value:function(){return!this.selectedRange.isEmpty()}},{key:"isSelectedByRowHeader",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(r)&&this.isEntireRowSelected(r)}},{key:"isEntireRowSelected",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return r===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(r)}},{key:"isSelectedByColumnHeader",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&this.isEntireColumnSelected(r)}},{key:"isEntireColumnSelected",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return r===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(r)}},{key:"isSelectedByAnyHeader",value:function(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}},{key:"isSelectedByCorner",value:function(){return this.selectedByCorner}},{key:"inInSelection",value:function(r){return this.selectedRange.includes(r)}},{key:"isCellCornerVisible",value:function(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}},{key:"isAreaCornerVisible",value:function(r){return Number.isInteger(r)&&r!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}},{key:"clear",value:function(){this.selectedRange.clear(),this.highlight.clear()}},{key:"deselect",value:function(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}},{key:"selectAll",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=this.tableProps.countRows(),i=this.tableProps.countCols();if(!(!r&&!n&&(o===0||i===0))){var a=this.tableProps.createCellCoords(n?-1:0,r?-1:0),l=this.tableProps.createCellCoords(o-1,i-1);this.clear(),this.setRangeStartOnly(a),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(l),this.finish()}}},{key:"selectCells",value:function(r){var n=this,o=Bs(r);if(o===Wm)return!1;if(o===Vm)throw new Error(ft(yM||(yM=Fwe([`Unsupported format of the selection ranges was passed. To select cells pass 
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, 
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`],[`Unsupported format of the selection ranges was passed. To select cells pass\\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`]))));var i=Dh(o,{propToCol:function(f){return n.tableProps.propToCol(f)},keepDirection:!0}),a=this.tableProps.countRows(),l=this.tableProps.countCols(),s=!r.some(function(u){var f=i(u),c=gM(f,4),h=c[0],d=c[1],v=c[2],g=c[3],m=Go(h,a)&&Go(d,l)&&Go(v,a)&&Go(g,l);return!m});return s&&(this.clear(),$(r,function(u){var f=i(u),c=gM(f,4),h=c[0],d=c[1],v=c[2],g=c[3];n.setRangeStartOnly(n.tableProps.createCellCoords(h,d),!1),n.setRangeEnd(n.tableProps.createCellCoords(v,g)),n.finish()})),s}},{key:"selectColumns",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,i=typeof r=="string"?this.tableProps.propToCol(r):r,a=typeof n=="string"?this.tableProps.propToCol(n):n,l=this.tableProps.countCols(),s=this.tableProps.countRows(),u=Go(i,l)&&Go(a,l);return u&&(this.setRangeStartOnly(this.tableProps.createCellCoords(o,i)),this.setRangeEnd(this.tableProps.createCellCoords(s-1,a)),this.finish()),u}},{key:"selectRows",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,i=this.tableProps.countRows(),a=this.tableProps.countCols(),l=Go(r,i)&&Go(n,i);return l&&(this.setRangeStartOnly(this.tableProps.createCellCoords(r,o)),this.setRangeEnd(this.tableProps.createCellCoords(n,a-1)),this.finish()),l}},{key:"refresh",value:function(){var r=this.highlight.getCustomSelections();if(r.forEach(function(u){u.commit()}),!!this.isSelected()){var n=this.highlight.getCell(),o=this.getLayerLevel();n.commit().syncWith(this.selectedRange.current());for(var i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);var a=this.highlight.createOrGetArea(),l=this.highlight.createOrGetHeader(),s=this.highlight.createOrGetActiveHeader();a.commit(),l.commit(),s.commit()}this.highlight.useLayerLevel(o)}}}]),e}();pt(b2,kr);const zwe=b2;var Ywe=$e,Gwe=Jp,Kwe=Ln.f,qwe=Xa,bM=Yt,Xwe=A0,Zwe=Tr,Qwe=I0,Jwe=Gwe("".slice),eSe=Math.min,w2=Qwe("startsWith"),tSe=!w2&&!!function(){var e=Kwe(String.prototype,"startsWith");return e&&!e.writable}();Ywe({target:"String",proto:!0,forced:!tSe&&!w2},{startsWith:function(t){var r=bM(Zwe(this));Xwe(t);var n=qwe(eSe(arguments.length>1?arguments[1]:void 0,r.length)),o=bM(t);return Jwe(r,n,n+o.length)===o}});var wM=/^(\r\n|\n\r|\r|\n)/,rSe=/^[^\t\r\n]+/,SM=/^\t/;function nSe(e){var t=[[""]];if(e.length===0)return t;for(var r=0,n=0,o;e.length>0&&o!==e.length;)if(o=e.length,e.match(SM))e=e.replace(SM,""),r+=1,t[n][r]="";else if(e.match(wM))e=e.replace(wM,""),r=0,n+=1,t[n]=[""];else{var i="";if(e.startsWith('"')){for(var a=0,l=!0;l;){var s=e.slice(0,1);s==='"'&&(a+=1),i+=s,e=e.slice(1),(e.length===0||e.match(/^[\t\r\n]/)&&a%2===0)&&(l=!1)}i=i.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,function(f){return new Array(Math.floor(f.length/2)).fill('"').join("")})}else{var u=e.match(rSe);i=u?u[0]:"",e=e.slice(i.length)}t[n][r]=i}return t}function _c(e){var t,r,n,o,i="",a;for(t=0,r=e.length;t<r;t+=1){for(o=e[t].length,n=0;n<o;n+=1)n>0&&(i+="	"),a=e[t][n],typeof a=="string"?a.indexOf(`
`)>-1?i+='"'.concat(a.replace(/"/g,'""'),'"'):i+=a:a==null?i+="":i+=a;t!==r-1&&(i+=`
`)}return i}function Mw(e){return lSe(e)||aSe(e)||iSe(e)||oSe()}function oSe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iSe(e,t){if(e){if(typeof e=="string")return B_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return B_(e,t)}}function aSe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function lSe(e){if(Array.isArray(e))return B_(e)}function B_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Vs(e){"@babel/helpers - typeof";return Vs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vs(e)}function sSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fSe(n.key),n)}}function uSe(e,t,r){return t&&CM(e.prototype,t),r&&CM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fSe(e){var t=cSe(e,"string");return Vs(t)==="symbol"?t:String(t)}function cSe(e,t){if(Vs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hSe=function(){function e(t,r,n){sSe(this,e),this.instance=t,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=r,this.duckSchema=this.createDuckSchema(),this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}return uSe(e,[{key:"createMap",value:function(){var r=this.getSchema();if(typeof r>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");var n=this.tableMeta.columns,o;if(this.colToPropCache=[],this.propToColCache=new Map,n){var i=0,a=0,l=!1;if(typeof n=="function"){var s=ym(r);i=s>0?s:this.countFirstRowKeys(),l=!0}else{var u=this.tableMeta.maxCols;i=Math.min(u,n.length)}for(o=0;o<i;o++){var f=l?n(o):n[o];if(Ve(f)){if(typeof f.data<"u"){var c=l?a:o;this.colToPropCache[c]=f.data,this.propToColCache.set(f.data,c)}a+=1}}}else this.recursiveDuckColumns(r)}},{key:"countFirstRowKeys",value:function(){return DE(this.dataSource)}},{key:"recursiveDuckColumns",value:function(r,n,o){var i=this,a=n,l=o,s;return typeof a>"u"&&(a=0,l=""),Vs(r)==="object"&&!Array.isArray(r)&&We(r,function(u,f){u===null?(s=l+f,i.colToPropCache.push(s),i.propToColCache.set(s,a),a+=1):a=i.recursiveDuckColumns(u,a,"".concat(f,"."))}),a}},{key:"colToProp",value:function(r){if(Number.isInteger(r)===!1)return r;var n=this.instance.toPhysicalColumn(r);return n===null?r:this.colToPropCache&&ve(this.colToPropCache[n])?this.colToPropCache[n]:n}},{key:"propToCol",value:function(r){var n=this.propToColCache.get(r);if(ve(n))return this.instance.toVisualColumn(n);var o=this.instance.toVisualColumn(r);return o===null?r:o}},{key:"getSchema",value:function(){var r=this.tableMeta.dataSchema;return r?typeof r=="function"?r():r:this.duckSchema}},{key:"createDuckSchema",value:function(){return this.dataSource&&this.dataSource[0]?ss(this.dataSource[0]):{}}},{key:"refreshDuckSchema",value:function(){this.duckSchema=this.createDuckSchema()}},{key:"createRow",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=i.source,l=i.mode,s=l===void 0?"above":l,u=this.instance.countSourceRows(),f=u,c=0,h=r;(typeof h!="number"||h>=u)&&(h=u),h<this.instance.countRows()&&(f=this.instance.toPhysicalRow(h));var d=this.instance.runHooks("beforeCreateRow",h,o,a);if(d===!1||f===null)return{delta:0};for(var v=this.tableMeta.maxRows,g=this.getSchema().length,m=[],w=function(){var P=null;n.instance.dataType==="array"?n.tableMeta.dataSchema?P=lr(n.getSchema()):(P=[],_e(g-1,function(){return P.push(null)})):n.instance.dataType==="function"?P=n.tableMeta.dataSchema(h+c):(P={},av(P,n.getSchema())),m.push(P),c+=1};c<o&&u+c<v;)w();this.instance.rowIndexMapper.insertIndexes(h,c),s==="below"&&(f=Math.min(f+1,u)),this.spliceData(f,0,m);var S=this.instance.toVisualRow(f);return this.instance.countSourceRows()===m.length&&this.instance.columnIndexMapper.initToLength(this.instance.getInitialColumnCount()),c>0&&(r==null?this.metaManager.createRow(null,c):a!=="auto"&&this.metaManager.createRow(f,o)),this.instance.runHooks("afterCreateRow",S,c,a),this.instance.forceFullRender=!0,{delta:c,startPhysicalIndex:f}}},{key:"createCol",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=o.source,a=o.mode,l=a===void 0?"start":a;if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var s=this.dataSource,u=this.tableMeta.maxCols,f=this.instance.countSourceCols(),c=r;(typeof c!="number"||c>=f)&&(c=f);var h=this.instance.runHooks("beforeCreateCol",c,n,i);if(h===!1)return{delta:0};var d=f;c<this.instance.countCols()&&(d=this.instance.toPhysicalColumn(c));var v=this.instance.countSourceRows(),g=this.instance.countCols(),m=0,w=d;l==="end"&&(w=Math.min(w+1,f));for(var S=w;m<n&&g<u;){if(typeof c!="number"||c>=g)if(v>0)for(var C=0;C<v;C+=1)typeof s[C]>"u"&&(s[C]=[]),s[C].push(null);else s.push([null]);else for(var P=0;P<v;P++)s[P].splice(w,0,null);m+=1,w+=1,g+=1}this.instance.columnIndexMapper.insertIndexes(c,m),m>0&&(r==null?this.metaManager.createColumn(null,m):i!=="auto"&&this.metaManager.createColumn(S,n));var R=this.instance.toVisualColumn(S);return this.instance.runHooks("afterCreateCol",R,m,i),this.instance.forceFullRender=!0,this.refreshDuckSchema(),{delta:m,startPhysicalIndex:S}}},{key:"removeRow",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0,a=Number.isInteger(r)?r:-o,l=this.visualRowsToPhysical(a,o),s=this.instance.countSourceRows();a=(s+a)%s;var u=this.instance.runHooks("beforeRemoveRow",a,l.length,l,i);if(u===!1)return!1;var f=l.length;if(this.filterData(a,f,l),a<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(l);var c=ve(this.tableMeta.columns)||ve(this.tableMeta.dataSchema);this.instance.rowIndexMapper.getNotTrimmedIndexesLength()===0&&c===!1&&this.instance.columnIndexMapper.setIndexesSequence([])}var h=l.slice(0).sort(function(d,v){return v-d});return h.forEach(function(d){n.metaManager.removeRow(d,1)}),this.instance.runHooks("afterRemoveRow",a,f,l,i),this.instance.forceFullRender=!0,!0}},{key:"removeCol",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2?arguments[2]:void 0;if(this.instance.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");var i=typeof r!="number"?-n:r;i=(this.instance.countCols()+i)%this.instance.countCols();var a=this.visualColumnsToPhysical(i,n),l=a.slice(0).sort(function(S,C){return C-S}),s=this.instance.runHooks("beforeRemoveCol",i,n,a,o);if(s===!1)return!1;for(var u=!0,f=l.length,c=this.dataSource,h=0;h<f;h++)u&&a[0]!==a[h]-h&&(u=!1);if(u)for(var d=0,v=this.instance.countSourceRows();d<v;d++)c[d].splice(a[0],n),d===0&&this.metaManager.removeColumn(a[0],n);else for(var g=0,m=this.instance.countSourceRows();g<m;g++)for(var w=0;w<f;w++)c[g].splice(l[w],1),g===0&&this.metaManager.removeColumn(l[w],1);return i<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(a),this.instance.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",i,n,a,o),this.instance.forceFullRender=!0,this.refreshDuckSchema(),!0}},{key:"spliceCol",value:function(r,n,o){for(var i=this.instance.getDataAtCol(r),a=i.slice(n,n+o),l=i.slice(n+o),s=arguments.length,u=new Array(s>3?s-3:0),f=3;f<s;f++)u[f-3]=arguments[f];pC(u,l);for(var c=0;c<o;)u.push(null),c+=1;return rB(u),this.instance.populateFromArray(n,r,u,null,null,"spliceCol"),a}},{key:"spliceRow",value:function(r,n,o){for(var i=this.instance.getSourceDataAtRow(r),a=i.slice(n,n+o),l=i.slice(n+o),s=arguments.length,u=new Array(s>3?s-3:0),f=3;f<s;f++)u[f-3]=arguments[f];pC(u,l);for(var c=0;c<o;)u.push(null),c+=1;return this.instance.populateFromArray(r,n,[u],null,null,"spliceRow"),a}},{key:"spliceData",value:function(r,n,o){var i=this,a=this.instance.runHooks("beforeDataSplice",r,n,o);if(a!==!1){var l=[].concat(Mw(this.dataSource.slice(0,r)),Mw(o),Mw(this.dataSource.slice(r)));this.dataSource.length=0,l.forEach(function(s){return i.dataSource.push(s)})}}},{key:"filterData",value:function(r,n,o){var i=this.instance.runHooks("filterData",r,n,o);Array.isArray(i)===!1&&(i=this.dataSource.filter(function(a,l){return o.indexOf(l)===-1})),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}},{key:"get",value:function(r,n){var o=this.instance.toPhysicalRow(r),i=this.dataSource[o],a=this.instance.runHooks("modifyRowData",o);i=isNaN(a)?a:i;var l=null;if(i&&i.hasOwnProperty&&At(i,n))l=i[n];else if(typeof n=="string"&&n.indexOf(".")>-1){var s=n.split("."),u=i;if(!u)return null;for(var f=0,c=s.length;f<c;f++)if(u=u[s[f]],typeof u>"u")return null;l=u}else typeof n=="function"&&(l=n(this.dataSource.slice(o,o+1)[0]));if(this.instance.hasHook("modifyData")){var h=Ia(l);this.instance.runHooks("modifyData",o,this.propToCol(n),h,"get"),h.isTouched()&&(l=h.value)}return l}},{key:"getCopyable",value:function(r,n){return this.instance.getCellMeta(r,this.propToCol(n)).copyable?this.get(r,n):""}},{key:"set",value:function(r,n,o){var i=this.instance.toPhysicalRow(r),a=o,l=this.dataSource[i],s=this.instance.runHooks("modifyRowData",i);if(l=isNaN(s)?s:l,this.instance.hasHook("modifyData")){var u=Ia(a);this.instance.runHooks("modifyData",i,this.propToCol(n),u,"set"),u.isTouched()&&(a=u.value)}if(l&&l.hasOwnProperty&&At(l,n))l[n]=a;else if(typeof n=="string"&&n.indexOf(".")>-1){var f=n.split("."),c=l,h=0,d;for(h=0,d=f.length-1;h<d;h++)typeof c[f[h]]>"u"&&(c[f[h]]={}),c=c[f[h]];c[f[h]]=a}else typeof n=="function"?n(this.dataSource.slice(i,i+1)[0],a):l[n]=a}},{key:"visualRowsToPhysical",value:function(r,n){for(var o=this.instance.countSourceRows(),i=[],a=(o+r)%o,l=n,s;a<o&&l;)s=this.instance.toPhysicalRow(a),i.push(s),l-=1,a+=1;return i}},{key:"visualColumnsToPhysical",value:function(r,n){for(var o=this.instance.countCols(),i=[],a=(o+r)%o,l=n;a<o&&l;){var s=this.instance.toPhysicalColumn(a);i.push(s),l-=1,a+=1}return i}},{key:"clear",value:function(){for(var r=0;r<this.instance.countSourceRows();r++)for(var n=0;n<this.instance.countCols();n++)this.set(r,this.colToProp(n),"")}},{key:"getLength",value:function(){var r=this.tableMeta.maxRows,n;r<0||r===0?n=0:n=r||1/0;var o=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(o,n)}},{key:"getAll",value:function(){var r={row:0,col:0},n={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return r.row-n.row===0&&!this.instance.countSourceRows()?[]:this.getRange(r,n,e.DESTINATION_RENDERER)}},{key:"countCachedColumns",value:function(){return this.colToPropCache.length}},{key:"getRange",value:function(r,n,o){var i=[],a,l,s,u=this.tableMeta.maxRows,f=this.tableMeta.maxCols;if(u===0||f===0)return[];var c=o===e.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(u-1,0),Math.max(r.row,n.row)),d=Math.min(Math.max(f-1,0),Math.max(r.col,n.col));for(a=Math.min(r.row,n.row);a<=h;a++){s=[];var v=a>=0?this.instance.toPhysicalRow(a):a;for(l=Math.min(r.col,n.col);l<=d&&v!==null;l++)s.push(c.call(this,a,this.colToProp(l)));v!==null&&i.push(s)}return i}},{key:"getText",value:function(r,n){return _c(this.getRange(r,n,e.DESTINATION_RENDERER))}},{key:"getCopyableText",value:function(r,n){return _c(this.getRange(r,n,e.DESTINATION_CLIPBOARD_GENERATOR))}},{key:"destroy",value:function(){this.instance=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}],[{key:"DESTINATION_RENDERER",get:function(){return 1}},{key:"DESTINATION_CLIPBOARD_GENERATOR",get:function(){return 2}}]),e}();const dSe=hSe;var Cv=Jr("cellTypes"),vSe=Cv.register,ySe=Cv.getItem,S2=Cv.hasItem,gSe=Cv.getNames;Cv.getValues;function cP(e){if(!S2(e))throw Error('You declared cell type "'.concat(e,`" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`));return ySe(e)}function on(e,t){typeof e!="string"&&(t=e,e=t.CELL_TYPE);var r=t,n=r.editor,o=r.renderer,i=r.validator;n&&Or(e,n),o&&An(e,o),i&&Vl(e,i),vSe(e,t)}function pSe(e,t){var r;return e==="CELL_TYPE"?!1:((r=t._automaticallyAssignedMetaProps)===null||r===void 0?void 0:r.has(e))||!At(t,e)}function Um(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,n=typeof t.type=="string"?cP(t.type):t.type;if(e._automaticallyAssignedMetaProps&&We(t,function(i,a){return void e._automaticallyAssignedMetaProps.delete(a)}),!!Ve(n)){r===e&&!e._automaticallyAssignedMetaProps&&(e._automaticallyAssignedMetaProps=new Set);var o={};We(n,function(i,a){if(pSe(a,r)){var l;o[a]=i,(l=e._automaticallyAssignedMetaProps)===null||l===void 0||l.add(a)}}),Wt(e,o)}}function mSe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}Fo(r,e);for(var n=0;n<t.length;n++)r.prototype[t[n]]=void 0;return r}function sg(e){return Number.isInteger(e)&&e>=0}function ug(e,t){if(!e())throw new Error("Assertion failed: ".concat(t))}function ay(e){return e==null}function V_(e){"@babel/helpers - typeof";return V_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},V_(e)}const C2=function(){return{_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",isEmptyCol:function(t){var r,n,o;for(r=0,n=this.countRows();r<n;r++)if(o=this.getDataAtCell(r,t),Kt(o)===!1)return!1;return!0},isEmptyRow:function(t){var r,n,o,i;for(r=0,n=this.countCols();r<n;r++)if(o=this.getDataAtCell(t,r),Kt(o)===!1)return V_(o)==="object"?(i=this.getCellMeta(t,r),vm(this.getSchema()[i.prop],o)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0}};function Hh(e){"@babel/helpers - typeof";return Hh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hh(e)}function _M(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function OM(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_M(Object(r),!0).forEach(function(n){bSe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_M(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function bSe(e,t,r){return t=O2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function RM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,O2(n.key),n)}}function _2(e,t,r){return t&&RM(e.prototype,t),r&&RM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function O2(e){var t=wSe(e,"string");return Hh(t)==="symbol"?t:String(t)}function wSe(e,t){if(Hh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function R2(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SSe(){return _2(function e(){R2(this,e)})}var CSe=function(){function e(t){R2(this,e),this.metaCtor=SSe(),this.meta=this.metaCtor.prototype,Wt(this.meta,C2()),this.meta.instance=t}return _2(e,[{key:"getMetaConstructor",value:function(){return this.metaCtor}},{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(r){var n;Wt(this.meta,r),Um(this.meta,OM(OM({},r),{},{type:(n=r.type)!==null&&n!==void 0?n:this.meta.type}),r)}}]),e}();function Lh(e){"@babel/helpers - typeof";return Lh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lh(e)}function _Se(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,RSe(n.key),n)}}function OSe(e,t,r){return t&&EM(e.prototype,t),r&&EM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function RSe(e){var t=ESe(e,"string");return Lh(t)==="symbol"?t:String(t)}function ESe(e,t){if(Lh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Lh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TSe=function(){function e(t){_Se(this,e);var r=t.getMetaConstructor();this.meta=new r}return OSe(e,[{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(r){Wt(this.meta,r),Um(this.meta,r,r)}}]),e}();function jh(e){"@babel/helpers - typeof";return jh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jh(e)}function TM(e){return ASe(e)||$Se(e)||kSe(e)||PSe()}function PSe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kSe(e,t){if(e){if(typeof e=="string")return W_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return W_(e,t)}}function $Se(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ASe(e){if(Array.isArray(e))return W_(e)}function W_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ISe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xSe(n.key),n)}}function MSe(e,t,r){return t&&PM(e.prototype,t),r&&PM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xSe(e){var t=DSe(e,"string");return jh(t)==="symbol"?t:String(t)}function DSe(e,t){if(jh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(jh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var U_=function(e){function t(r){ISe(this,t),this.valueFactory=r,this.data=[],this.index=[],this.holes=new Set}return MSe(t,[{key:"obtain",value:function(n){ug(function(){return sg(n)},"Expecting an unsigned number.");var o=this._getStorageIndexByKey(n),i;if(o>=0)i=this.data[o],i===void 0&&(i=this.valueFactory(n),this.data[o]=i);else if(i=this.valueFactory(n),this.holes.size>0){var a=this.holes.values().next().value;this.holes.delete(a),this.data[a]=i,this.index[n]=a}else this.data.push(i),this.index[n]=this.data.length-1;return i}},{key:"insert",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;ug(function(){return sg(n)||ay(n)},"Expecting an unsigned number or null/undefined argument.");for(var i=[],a=this.data.length,l=0;l<o;l++)i.push(a+l),this.data.push(void 0);var s=ay(n)?this.index.length:n;this.index=[].concat(TM(this.index.slice(0,s)),i,TM(this.index.slice(s)))}},{key:"remove",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;ug(function(){return sg(n)||ay(n)},"Expecting an unsigned number or null/undefined argument.");for(var i=this.index.splice(ay(n)?this.index.length-o:n,o),a=0;a<i.length;a++){var l=i[a];typeof l=="number"&&this.holes.add(l)}}},{key:"size",value:function(){return this.data.length-this.holes.size}},{key:"values",value:function(){var n=this;return jr(this.data,function(o,i){return!n.holes.has(i)})[Symbol.iterator]()}},{key:"entries",value:function(){for(var n=[],o=0;o<this.data.length;o++){var i=this._getKeyByStorageIndex(o);i!==-1&&n.push([i,this.data[o]])}var a=0;return{next:function(){if(a<n.length){var s=n[a];return a+=1,{value:s,done:!1}}return{done:!0}}}}},{key:"clear",value:function(){this.data=[],this.index=[],this.holes.clear()}},{key:"_getStorageIndexByKey",value:function(n){return this.index.length>n?this.index[n]:-1}},{key:"_getKeyByStorageIndex",value:function(n){return this.index.indexOf(n)}},{key:e,value:function(){return this.entries()}}]),t}(Symbol.iterator);function Fh(e){"@babel/helpers - typeof";return Fh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fh(e)}function NSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,LSe(n.key),n)}}function HSe(e,t,r){return t&&kM(e.prototype,t),r&&kM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function LSe(e){var t=jSe(e,"string");return Fh(t)==="symbol"?t:String(t)}function jSe(e,t){if(Fh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var FSe=["data","width"],BSe=function(){function e(t){var r=this;NSe(this,e),this.globalMeta=t,this.metas=new U_(function(){return r._createMeta()})}return HSe(e,[{key:"updateMeta",value:function(r,n){var o=this.getMeta(r);Wt(o,n),Um(o,n)}},{key:"createColumn",value:function(r,n){this.metas.insert(r,n)}},{key:"removeColumn",value:function(r,n){this.metas.remove(r,n)}},{key:"getMeta",value:function(r){return this.metas.obtain(r)}},{key:"getMetaConstructor",value:function(r){return this.metas.obtain(r).constructor}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createMeta",value:function(){return mSe(this.globalMeta.getMetaConstructor(),FSe).prototype}}]),e}();function Bh(e){"@babel/helpers - typeof";return Bh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bh(e)}function VSe(e){return YSe(e)||zSe(e)||USe(e)||WSe()}function WSe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function USe(e,t){if(e){if(typeof e=="string")return z_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return z_(e,t)}}function zSe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function YSe(e){if(Array.isArray(e))return z_(e)}function z_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function GSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $M(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qSe(n.key),n)}}function KSe(e,t,r){return t&&$M(e.prototype,t),r&&$M(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qSe(e){var t=XSe(e,"string");return Bh(t)==="symbol"?t:String(t)}function XSe(e,t){if(Bh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ZSe=function(){function e(t){var r=this;GSe(this,e),this.columnMeta=t,this.metas=new U_(function(){return r._createRow()})}return KSe(e,[{key:"updateMeta",value:function(r,n,o){var i=this.getMeta(r,n);Wt(i,o),Um(i,o)}},{key:"createRow",value:function(r,n){this.metas.insert(r,n)}},{key:"createColumn",value:function(r,n){for(var o=0;o<this.metas.size();o++)this.metas.obtain(o).insert(r,n)}},{key:"removeRow",value:function(r,n){this.metas.remove(r,n)}},{key:"removeColumn",value:function(r,n){for(var o=0;o<this.metas.size();o++)this.metas.obtain(o).remove(r,n)}},{key:"getMeta",value:function(r,n,o){var i=this.metas.obtain(r).obtain(n);return o===void 0?i:i[o]}},{key:"setMeta",value:function(r,n,o,i){var a,l=this.metas.obtain(r).obtain(n);(a=l._automaticallyAssignedMetaProps)===null||a===void 0||a.delete(o),l[o]=i}},{key:"removeMeta",value:function(r,n,o){var i=this.metas.obtain(r).obtain(n);delete i[o]}},{key:"getMetas",value:function(){for(var r=[],n=Array.from(this.metas.values()),o=0;o<n.length;o++)r.push.apply(r,VSe(n[o].values()));return r}},{key:"getMetasAtRow",value:function(r){ug(function(){return sg(r)},"Expecting an unsigned number.");var n=new Map(this.metas);return n.has(r)?Array.from(n.get(r).values()):[]}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createRow",value:function(){var r=this;return new U_(function(n){return r._createMeta(n)})}},{key:"_createMeta",value:function(r){var n=this.columnMeta.getMetaConstructor(r);return new n}}]),e}();function Vh(e){"@babel/helpers - typeof";return Vh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vh(e)}function QSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eCe(n.key),n)}}function JSe(e,t,r){return t&&AM(e.prototype,t),r&&AM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function eCe(e){var t=tCe(e,"string");return Vh(t)==="symbol"?t:String(t)}function tCe(e,t){if(Vh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var E2=function(){function e(t){var r=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];QSe(this,e),this.hot=t,this.globalMeta=new CSe(t),this.tableMeta=new TSe(this.globalMeta),this.columnMeta=new BSe(this.globalMeta),this.cellMeta=new ZSe(this.columnMeta),o.forEach(function(i){return new i(r)}),this.globalMeta.updateMeta(n)}return JSe(e,[{key:"getGlobalMeta",value:function(){return this.globalMeta.getMeta()}},{key:"updateGlobalMeta",value:function(r){this.globalMeta.updateMeta(r)}},{key:"getTableMeta",value:function(){return this.tableMeta.getMeta()}},{key:"updateTableMeta",value:function(r){this.tableMeta.updateMeta(r)}},{key:"getColumnMeta",value:function(r){return this.columnMeta.getMeta(r)}},{key:"updateColumnMeta",value:function(r,n){this.columnMeta.updateMeta(r,n)}},{key:"getCellMeta",value:function(r,n,o){var i=o.visualRow,a=o.visualColumn,l=this.cellMeta.getMeta(r,n);return l.visualRow=i,l.visualCol=a,l.row=r,l.col=n,this.runLocalHooks("afterGetCellMeta",l),l}},{key:"getCellMetaKeyValue",value:function(r,n,o){if(typeof o!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(r,n,o)}},{key:"setCellMeta",value:function(r,n,o,i){this.cellMeta.setMeta(r,n,o,i)}},{key:"updateCellMeta",value:function(r,n,o){this.cellMeta.updateMeta(r,n,o)}},{key:"removeCellMeta",value:function(r,n,o){this.cellMeta.removeMeta(r,n,o)}},{key:"getCellsMeta",value:function(){return this.cellMeta.getMetas()}},{key:"getCellsMetaAtRow",value:function(r){return this.cellMeta.getMetasAtRow(r)}},{key:"createRow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(r,n)}},{key:"removeRow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(r,n)}},{key:"createColumn",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(r,n),this.columnMeta.createColumn(r,n)}},{key:"removeColumn",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(r,n),this.columnMeta.removeColumn(r,n)}},{key:"clearCellsCache",value:function(){this.cellMeta.clearCache()}},{key:"clearCache",value:function(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}]),e}();pt(E2,kr);function Op(e){"@babel/helpers - typeof";return Op=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Op(e)}function IM(e,t,r,n){var o=n.hotInstance,i=n.dataMap,a=n.dataSource,l=n.internalSource,s=n.source,u=n.metaManager,f=n.firstRun,c=ar(l),h=o.getSettings();Array.isArray(h.dataSchema)?o.dataType="array":bt(h.dataSchema)?o.dataType="function":o.dataType="object",i&&i.destroy(),e=o.runHooks("before".concat(c),e,f,s);var d=new dSe(o,e,u);if(t(d),Op(e)==="object"&&e!==null)e.push&&e.splice||(e=[e]);else if(e===null){var v=d.getSchema();e=[];var g,m=0,w=0;for(m=0,w=h.startRows;m<w;m++)if((o.dataType==="object"||o.dataType==="function")&&h.dataSchema)g=lr(v),e.push(g);else if(o.dataType==="array")g=lr(v[0]),e.push(g);else{g=[];for(var S=0,C=h.startCols;S<C;S++)g.push(null);e.push(g)}}else throw new Error("".concat(l," only accepts array of objects or array of arrays (").concat(Op(e)," given)"));Array.isArray(e[0])&&(o.dataType="array"),h.data=e,d.dataSource=e,a.data=e,a.dataType=o.dataType,a.colToProp=d.colToProp.bind(d),a.propToCol=d.propToCol.bind(d),a.countCachedColumns=d.countCachedColumns.bind(d),r(d),o.runHooks("after".concat(c),e,f,s),f||(o.runHooks("afterChange",null,l),o.render())}function Wh(e){"@babel/helpers - typeof";return Wh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wh(e)}function rCe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oCe(n.key),n)}}function nCe(e,t,r){return t&&MM(e.prototype,t),r&&MM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function oCe(e){var t=iCe(e,"string");return Wh(t)==="symbol"?t:String(t)}function iCe(e,t){if(Wh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var aCe=function(){function e(t){var r=this;rCe(this,e),this.metaManager=t,this.metaSyncMemo=new Map,t.addLocalHook("afterGetCellMeta",function(n){return r.extendCellMeta(n)}),pe.getSingleton().add("beforeRender",function(n){n&&r.metaSyncMemo.clear()},this.metaManager.hot)}return nCe(e,[{key:"extendCellMeta",value:function(r){var n,o=r.row,i=r.col;if(!((n=this.metaSyncMemo.get(o))!==null&&n!==void 0&&n.has(i))){var a=r.visualRow,l=r.visualCol,s=this.metaManager.hot,u=s.colToProp(l);r.prop=u,s.runHooks("beforeGetCellMeta",a,l,r);var f=At(r,"type")?r.type:null,c=bt(r.cells)?r.cells(o,i,u):null;if(f)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:f}else c={type:f};c&&this.metaManager.updateCellMeta(o,i,c),s.runHooks("afterGetCellMeta",a,l,r),this.metaSyncMemo.has(o)||this.metaSyncMemo.set(o,new Set),this.metaSyncMemo.get(o).add(i)}}}]),e}();function Uh(e){"@babel/helpers - typeof";return Uh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uh(e)}function lCe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uCe(n.key),n)}}function sCe(e,t,r){return t&&xM(e.prototype,t),r&&xM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uCe(e){var t=fCe(e,"string");return Uh(t)==="symbol"?t:String(t)}function fCe(e,t){if(Uh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Uh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cCe=function(){function e(t){lCe(this,e),this.metaManager=t,this.usageTracker=new Set,this.propDescriptors=new Map([["fixedColumnsLeft",{target:"fixedColumnsStart",onChange:function(n){var o=this.metaManager.hot.isRtl();if(o&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange:function(n,o,i){if(!i)throw new Error("The `".concat(n,"` option can not be updated after the Handsontable is initialized."))}}]]),this.extendMetaProps()}return sCe(e,[{key:"extendMetaProps",value:function(){var r=this;this.propDescriptors.forEach(function(n,o){var i=n.target,a=n.onChange,l=a===void 0?function(){}:a,s=typeof i=="string",u=s?i:o,f="_".concat(u);r.metaManager.globalMeta.meta[f]=r.metaManager.globalMeta.meta[u],r.installPropWatcher(o,f,l),s&&r.installPropWatcher(i,f,l)})}},{key:"installPropWatcher",value:function(r,n,o){var i=this;Object.defineProperty(this.metaManager.globalMeta.meta,r,{get:function(){return this[n]},set:function(l){var s=!i.usageTracker.has(r);i.usageTracker.add(r),o.call(i,r,l,s),this[n]=l},enumerable:!0,configurable:!0})}}]),e}(),DM=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),ly=function(t){return t.map(function(r){var n=r.toLowerCase();return DM.has(n)?DM.get(n):n}).sort().join("+")},hCe=function(t){return t.split("+")},NM=function(t){return t.toLowerCase()},HM;function dCe(e){return gCe(e)||yCe(e)||T2(e)||vCe()}function vCe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yCe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function gCe(e){if(Array.isArray(e))return Y_(e)}function pCe(e,t){return wCe(e)||bCe(e,t)||T2(e,t)||mCe()}function mCe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function T2(e,t){if(e){if(typeof e=="string")return Y_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Y_(e,t)}}function Y_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function bCe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function wCe(e){if(Array.isArray(e))return e}function SCe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var CCe=function(t){var r=Mm({errorIdExists:function(f){return'The "'.concat(f,'" shortcut is already registered in the "').concat(t,'" context.')}}),n=function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=f.keys,h=f.callback,d=f.group,v=f.runOnlyIf,g=v===void 0?function(){return!0}:v,m=f.captureCtrl,w=m===void 0?!1:m,S=f.preventDefault,C=S===void 0?!0:S,P=f.stopPropagation,R=P===void 0?!1:P,V=f.relativeToGroup,U=f.position;if(gt(d))throw new Error("You need to define the shortcut's group.");if(bt(h)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(c)===!1)throw new Error(ft(HM||(HM=SCe([`Pass the shortcut's keys as an array of arrays, 
      using the KeyboardEvent.key properties: 
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`],[`Pass the shortcut\\'s keys as an array of arrays,\\x20
      using the KeyboardEvent.key properties:\\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`]))));var X={callback:h,group:d,runOnlyIf:g,captureCtrl:w,preventDefault:C,stopPropagation:R};if(ve(V)){var Y=[V,U];X.relativeToGroup=Y[0],X.position=Y[1]}c.forEach(function(q){var Z=ly(q),ie=r.hasItem(Z);if(ie){var Q=r.getItem(Z),le=Q.findIndex(function(Se){return Se.group===V});le!==-1?U==="before"?le-=1:le+=1:le=Q.length,Q.splice(le,0,X)}else r.addItem(Z,[X])})},o=function(f){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};f.forEach(function(h){We(c,function(d,v){Object.prototype.hasOwnProperty.call(h,v)===!1&&(h[v]=c[v])}),n(h)})},i=function(f){var c=ly(f);r.removeItem(c)},a=function(f){var c=r.getItems();c.forEach(function(h){var d=pCe(h,2),v=d[0],g=d[1],m=g.filter(function(w){return w.group!==f});m.length===0?i(hCe(v)):(g.length=0,g.push.apply(g,dCe(m)))})},l=function(f){var c=ly(f),h=r.getItem(c);return ve(h)?h.slice():[]},s=function(f){var c=ly(f);return r.hasItem(c)};return{addShortcut:n,addShortcuts:o,getShortcuts:l,hasShortcut:s,removeShortcutsByKeys:i,removeShortcutsByGroup:a}};function _Ce(){var e=new Set;return{press:function(r){e.add(r)},release:function(r){e.delete(r)},releaseAll:function(){e.clear()},isPressed:function(r){return e.has(r)}}}var OCe=["meta","alt","shift","control"],Uf=_Ce();function RCe(e,t,r,n,o){var i=function(d){return OCe.includes(d)},a=function(d){var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,g=[];return d.altKey&&g.push("alt"),v&&(d.ctrlKey||d.metaKey)?g.push("control/meta"):(d.ctrlKey&&g.push("control"),d.metaKey&&g.push("meta")),d.shiftKey&&g.push("shift"),g},l=function(d){if(t(d)!==!1){var v=r(d);if(!(d.keyCode===229||v===!1||Qi(d))){var g=NM(d.key),m=[];i(g)?Uf.press(g):m=a(d);var w=[g].concat(m),S=o(d,w);!S&&(Mg()&&m.includes("meta")||!Mg()&&m.includes("control"))&&o(d,[g].concat(a(d,!0))),n(d)}}},s=function(d){if(t(d)!==!1){var v=NM(d.key);i(v)!==!1&&Uf.release(v)}},u=function(){Uf.releaseAll()},f=function(){for(var d=e;d;)d.document.documentElement.addEventListener("keydown",l),d.document.documentElement.addEventListener("keyup",s),d.document.documentElement.addEventListener("blur",u),d=Hc(d)},c=function(){for(var d=e;d;)d.document.documentElement.removeEventListener("keydown",l),d.document.documentElement.removeEventListener("keyup",s),d.document.documentElement.removeEventListener("blur",u),d=Hc(d)};return{mount:f,unmount:c,isPressed:function(d){return Uf.isPressed(d)},releasePressedKeys:function(){return Uf.releaseAll()}}}var ECe=function(t){var r=t.ownerWindow,n=t.handleEvent,o=t.beforeKeyDown,i=t.afterKeyDown,a=Mm({errorIdExists:function(g){return'The "'.concat(g,'" context name is already registered.')}}),l="grid",s=function(g){var m=CCe(g);return a.addItem(g,m),m},u=function(){return l},f=function(g){return a.getItem(g)},c=function(g){l=g},h=!1,d=RCe(r,n,o,i,function(v,g){var m=f(u()),w=!1;if(!m.hasShortcut(g))return w;for(var S=m.getShortcuts(g),C=0;C<S.length;C++){var P=S[C],R=P.callback,V=P.runOnlyIf,U=P.preventDefault,X=P.stopPropagation,Y=P.captureCtrl;if(V(v)!==!1&&(h=Y,w=R(v,g)===!1,h=!1,U&&v.preventDefault(),X&&v.stopPropagation(),w))break}return w});return d.mount(),{addContext:s,getActiveContextName:u,getContext:f,setActiveContextName:c,isCtrlPressed:function(){return!h&&(d.isPressed("control")||d.isPressed("meta"))},releasePressedKeys:function(){return d.releasePressedKeys()},destroy:function(){return d.unmount()}}},LM,jM;function Cr(e){"@babel/helpers - typeof";return Cr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cr(e)}function FM(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function _n(e,t){return kCe(e)||PCe(e,t)||P2(e,t)||TCe()}function TCe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PCe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function kCe(e){if(Array.isArray(e))return e}function gl(e){return ICe(e)||ACe(e)||P2(e)||$Ce()}function $Ce(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function P2(e,t){if(e){if(typeof e=="string")return G_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return G_(e,t)}}function ACe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ICe(e){if(Array.isArray(e))return G_(e)}function G_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var MCe="gridDefault",xw=null,sy=new Set;function hP(e,t){var r,n=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,a=this,l=new Tt(a),s,u,f,c,h=!0;Vye(o)&&Bye(this),this.rootElement=e,this.rootDocument=e.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;var d=(r=t==null?void 0:t.layoutDirection)!==null&&r!==void 0?r:"inherit",v=["rtl","ltr"].includes(d)?d:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",v),this.isRtl=function(){return v==="rtl"},this.isLtr=function(){return!a.isRtl()},this.getDirectionFactor=function(){return a.isLtr()?1:-1},t.language=Wme(t.language);var g=new E2(a,t,[aCe,cCe]),m=g.getTableMeta(),w=g.getGlobalMeta(),S=Mm();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,e.insertBefore(this.container,e.firstChild),w_(this)&&uV(t.licenseKey,e),this.guid="ht_".concat(sE()),this.columnIndexMapper=new N_,this.rowIndexMapper=new N_,this.columnIndexMapper.addLocalHook("indexesSequenceChange",function(y){a.runHooks("afterColumnSequenceChange",y)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",function(y){a.runHooks("afterRowSequenceChange",y)}),u=new dge(a),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);var C=function(p){var b=p.row,_=p.col;return a._createCellCoords(b>=0?a.rowIndexMapper.getRenderableFromVisualIndex(b):b,_>=0?a.columnIndexMapper.getRenderableFromVisualIndex(_):_)},P=function(p){var b=p.row,_=p.col;return a._createCellCoords(b>=0?a.rowIndexMapper.getVisualFromRenderableIndex(b):b,_>=0?a.columnIndexMapper.getVisualFromRenderableIndex(_):_)},R=new zwe(m,{rowIndexMapper:function(){return a.rowIndexMapper},columnIndexMapper:function(){return a.columnIndexMapper},countCols:function(){return a.countCols()},countRows:function(){return a.countRows()},propToCol:function(p){return s.propToCol(p)},isEditorOpened:function(){return a.getActiveEditor()?a.getActiveEditor().isOpened():!1},countColsTranslated:function(){return n.view.countRenderableColumns()},countRowsTranslated:function(){return n.view.countRenderableRows()},getShortcutManager:function(){return a.getShortcutManager()},createCellCoords:function(p,b){return a._createCellCoords(p,b)},createCellRange:function(p,b,_){return a._createCellRange(p,b,_)},visualToRenderableCoords:C,renderableToVisualCoords:P,isDisabledCellSelection:function(p,b){return a.getCellMeta(p,b).disableVisualSelection}});this.selection=R;var V=function(p){var b=p.hiddenIndexesChanged;b&&n.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",V),this.rowIndexMapper.addLocalHook("cacheUpdated",V),this.selection.addLocalHook("beforeSetRangeStart",function(y){n.runHooks("beforeSetRangeStart",y)}),this.selection.addLocalHook("beforeSetRangeStartOnly",function(y){n.runHooks("beforeSetRangeStartOnly",y)}),this.selection.addLocalHook("beforeSetRangeEnd",function(y){n.runHooks("beforeSetRangeEnd",y),y.row<0&&(y.row=n.view._wt.wtTable.getFirstVisibleRow()),y.col<0&&(y.col=n.view._wt.wtTable.getFirstVisibleColumn())}),this.selection.addLocalHook("afterSetRangeEnd",function(y){var p=Ia(!1),b=n.selection.getSelectedRange(),_=b.current(),T=_.from,I=_.to,F=b.size()-1;n.runHooks("afterSelection",T.row,T.col,I.row,I.col,p,F),n.runHooks("afterSelectionByProp",T.row,a.colToProp(T.col),I.row,a.colToProp(I.col),p,F);var W=n.selection.isSelectedByAnyHeader(),G=n.selection.selectedRange.current(),J=!0;i&&(J=!1),p.isTouched()&&(J=!p.value);var ee=n.selection.isSelectedByRowHeader(),se=n.selection.isSelectedByColumnHeader();J!==!1&&(W?ee?n.view.scrollViewportVertically(a.rowIndexMapper.getRenderableFromVisualIndex(y.row)):se&&n.view.scrollViewportHorizontally(a.columnIndexMapper.getRenderableFromVisualIndex(y.col)):G&&!n.selection.isMultiple()?n.view.scrollViewport(C(G.from)):n.view.scrollViewport(C(y))),ee&&se?re(n.rootElement,["ht__selection--rows","ht__selection--columns"]):ee?(Le(n.rootElement,"ht__selection--columns"),re(n.rootElement,"ht__selection--rows")):se?(Le(n.rootElement,"ht__selection--rows"),re(n.rootElement,"ht__selection--columns")):Le(n.rootElement,["ht__selection--rows","ht__selection--columns"]),n._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",function(y){var p=y.length-1,b=y[p],_=b.from,T=b.to;n.runHooks("afterSelectionEnd",_.row,_.col,T.row,T.col,p),n.runHooks("afterSelectionEndByProp",_.row,a.colToProp(_.col),T.row,a.colToProp(T.col),p)}),this.selection.addLocalHook("afterIsMultipleSelection",function(y){var p=n.runHooks("afterIsMultipleSelection",y.value);y.value&&(y.value=p)}),this.selection.addLocalHook("beforeModifyTransformStart",function(y){n.runHooks("modifyTransformStart",y)}),this.selection.addLocalHook("afterModifyTransformStart",function(y,p,b){n.runHooks("afterModifyTransformStart",y,p,b)}),this.selection.addLocalHook("beforeModifyTransformEnd",function(y){n.runHooks("modifyTransformEnd",y)}),this.selection.addLocalHook("afterModifyTransformEnd",function(y,p,b){n.runHooks("afterModifyTransformEnd",y,p,b)}),this.selection.addLocalHook("afterDeselect",function(){c.destroyEditor(),n._refreshBorders(),Le(n.rootElement,["ht__selection--rows","ht__selection--columns"]),n.runHooks("afterDeselect")}),this.selection.addLocalHook("insertRowRequire",function(y){n.alter("insert_row_above",y,1,"auto")}),this.selection.addLocalHook("insertColRequire",function(y){n.alter("insert_col_start",y,1,"auto")}),f={alter:function(p,b){var _,T,I=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,F=arguments.length>3?arguments[3]:void 0,W=arguments.length>4?arguments[4]:void 0,G=function(Ne){if(Ne.length===0)return[];var He=gl(Ne);He.sort(function(it,Je){var Xe=_n(it,1),Qe=Xe[0],jt=_n(Je,1),yt=jt[0];return Qe===yt?0:Qe>yt?1:-1});var rt=Lt(He,function(it,Je){var Xe=_n(Je,2),Qe=Xe[0],jt=Xe[1],yt=it[it.length-1],st=_n(yt,2),nt=st[0],Mi=st[1],Wo=nt+Mi;if(Qe<=Wo){var il=Math.max(jt-(Wo-Qe),0);yt[1]+=il}else it.push([Qe,jt]);return it},[He[0]]);return rt};switch(p){case"insert_row":sy.has(p)||(sy.add(p),ht(ft(LM||(LM=FM(["The `","` action of the `alter()` method is deprecated and will be removed \n                              in the next major release of Handsontable. Use the `insert_row_above` action instead."],["The \\`","\\` action of the \\`alter()\\` method is deprecated and will be removed\\x20\n                              in the next major release of Handsontable. Use the \\`insert_row_above\\` action instead."])),p)));case"insert_row_below":case"insert_row_above":var J=a.countSourceRows();if(m.maxRows===J)return;var ee=p==="insert_row_below"?"below":"above";b=(_=b)!==null&&_!==void 0?_:p==="insert_row"||ee==="below"?J:0;var se=s.createRow(b,I,{source:F,mode:ee}),Re=se.delta,ce=se.startPhysicalIndex;if(Re){var de=R.selectedRange.current(),K=de==null?void 0:de.from,Me=K==null?void 0:K.row,Ge=a.toVisualRow(ce);if(R.isSelectedByCorner())a.selectAll();else if(ve(Me)&&Me>=Ge){var Pe=de.to,Ae=Pe.row,ke=Pe.col,O=K.col;R.isSelectedByRowHeader()&&(O=-1),R.getSelectedRange().pop(),R.setRangeStartOnly(a._createCellCoords(Me+Re,O),!0),R.setRangeEnd(a._createCellCoords(Ae+Re,ke))}else a._refreshBorders()}break;case"insert_col":sy.has(p)||(sy.add(p),ht(ft(jM||(jM=FM(["The `","` action of the `alter()` method is deprecated and will be removed \n                              in the next major release of Handsontable. Use the `insert_col_start` action instead."],["The \\`","\\` action of the \\`alter()\\` method is deprecated and will be removed\\x20\n                              in the next major release of Handsontable. Use the \\`insert_col_start\\` action instead."])),p)));case"insert_col_start":case"insert_col_end":var E=p==="insert_col_end"?"end":"start";b=(T=b)!==null&&T!==void 0?T:p==="insert_col"||E==="end"?a.countSourceCols():0;var A=s.createCol(b,I,{source:F,mode:E}),H=A.delta,M=A.startPhysicalIndex;if(H){if(Array.isArray(m.colHeaders)){var j=[a.toVisualColumn(M),0];j.length+=H,Array.prototype.splice.apply(m.colHeaders,j)}var x=R.selectedRange.current(),D=x==null?void 0:x.from,B=D==null?void 0:D.col,L=a.toVisualColumn(M);if(R.isSelectedByCorner())a.selectAll();else if(ve(B)&&B>=L){var z=x.to,ae=z.row,ge=z.col,Oe=D.row;R.isSelectedByColumnHeader()&&(Oe=-1),R.getSelectedRange().pop(),R.setRangeStartOnly(a._createCellCoords(Oe,B+H),!0),R.setRangeEnd(a._createCellCoords(ae,ge+H))}else a._refreshBorders()}break;case"remove_row":var De=function(Ne){var He=0;$(Ne,function(rt){var it=_n(rt,2),Je=it[0],Xe=it[1],Qe=Kt(Je)?a.countRows()-1:Math.max(Je-He,0);Number.isInteger(Je)&&(Je=Math.max(Je-He,0));var jt=s.removeRow(Je,Xe,F);if(jt){var yt=a.countRows(),st=m.fixedRowsTop;st>=Qe+1&&(m.fixedRowsTop-=Math.min(Xe,st-Qe));var nt=m.fixedRowsBottom;nt&&Qe>=yt-nt&&(m.fixedRowsBottom-=Math.min(Xe,nt)),He+=Xe}})};Array.isArray(b)?De(G(b)):De([[b,I]]),f.adjustRowsAndCols(),a._refreshBorders();break;case"remove_col":var qe=function(Ne){var He=0;$(Ne,function(rt){var it=_n(rt,2),Je=it[0],Xe=it[1],Qe=Kt(Je)?a.countCols()-1:Math.max(Je-He,0),jt=a.toPhysicalColumn(Qe);Number.isInteger(Je)&&(Je=Math.max(Je-He,0));var yt=s.removeCol(Je,Xe,F);if(yt){var st=m.fixedColumnsStart;st>=Qe+1&&(m.fixedColumnsStart-=Math.min(Xe,st-Qe)),Array.isArray(m.colHeaders)&&(typeof jt>"u"&&(jt=-1),m.colHeaders.splice(jt,Xe)),He+=Xe}})};Array.isArray(b)?qe(G(b)):qe([[b,I]]),f.adjustRowsAndCols(),a._refreshBorders();break;default:throw new Error('There is no such action "'.concat(p,'"'))}W||f.adjustRowsAndCols()},adjustRowsAndCols:function(){var p=m.minRows,b=m.minSpareRows,_=m.minCols,T=m.minSpareCols;if(a.countRows()===0&&a.countCols()===0&&R.deselect(),p){var I=a.countRows();I<p&&s.createRow(I,p-I,{source:"auto"})}if(b){var F=a.countEmptyRows(!0);if(F<b){var W=b-F,G=Math.min(W,m.maxRows-a.countSourceRows());s.createRow(a.countRows(),G,{source:"auto"})}}{var J;(_||T)&&(J=a.countEmptyCols(!0));var ee=a.countCols();if(_&&!m.columns&&ee<_){var se=_-ee;J+=se,s.createCol(ee,se,{source:"auto"})}if(T&&!m.columns&&a.dataType==="array"&&J<T){ee=a.countCols();var Re=T-J,ce=Math.min(Re,m.maxCols-ee);s.createCol(ee,ce,{source:"auto"})}}if(R.isSelected()){var de=a.countRows(),K=a.countCols();$(R.selectedRange,function(Me){var Ge=!1,Pe=Me.from.row,Ae=Me.from.col,ke=Me.to.row,O=Me.to.col;Pe>de-1?(Pe=de-1,Ge=!0,ke>Pe&&(ke=Pe)):ke>de-1&&(ke=de-1,Ge=!0,Pe>ke&&(Pe=ke)),Ae>K-1?(Ae=K-1,Ge=!0,O>Ae&&(O=Ae)):O>K-1&&(O=K-1,Ge=!0,Ae>O&&(Ae=O)),Ge&&a.selectCell(Pe,Ae,ke,O)})}a.view&&a.view.adjustElementsSize()},populateFromArray:function(p,b,_,T,I,F,W){var G,J,ee,se,Re=[],ce={},de=[],K=p.row,Me=p.col;if(J=b.length,J===0)return!1;var Ge=0,Pe=0;switch(Ve(_)&&(Ge=_.col-Me+1,Pe=_.row-K+1),I){case"shift_down":var Ae=vc(b),ke=Ae.length,O=Math.max(ke,Ge),E=a.getData().slice(K),A=vc(E).slice(Me,Me+O);for(ee=0;ee<O;ee+=1)if(ee<ke){for(G=0,J=Ae[ee].length;G<Pe-J;G+=1)Ae[ee].push(Ae[ee][G%J]);ee<A.length?de.push(Ae[ee].concat(A[ee])):de.push(Ae[ee].concat(new Array(E.length).fill(null)))}else de.push(Ae[ee%ke].concat(A[ee]));a.populateFromArray(K,Me,vc(de));break;case"shift_right":var H=b.length,M=Math.max(H,Pe),j=a.getData().slice(K).map(function(st){return st.slice(Me)});for(G=0;G<M;G+=1)if(G<H){for(ee=0,se=b[G].length;ee<Ge-se;ee+=1)b[G].push(b[G][ee%se]);if(G<j.length)for(var x=0;x<j[G].length;x+=1)b[G].push(j[G][x]);else{var D;(D=b[G]).push.apply(D,gl(new Array(j[0].length).fill(null)))}}else b.push(b[G%J].slice(0,M).concat(j[G]));a.populateFromArray(K,Me,b);break;case"overwrite":default:ce.row=p.row,ce.col=p.col;var B={row:_&&p?_.row-p.row+1:1,col:_&&p?_.col-p.col+1:1},L=0,z=0,ae=!0,ge,Oe=function(nt){var Mi=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,Wo=b[nt%b.length];return Mi!==null?Wo[Mi%Wo.length]:Wo},De=b.length,qe=_?_.row-p.row+1:0;for(_?J=qe:J=Math.max(De,qe),G=0;G<J&&!(_&&ce.row>_.row&&qe>De||!m.allowInsertRow&&ce.row>a.countRows()-1||ce.row>=m.maxRows);G++){var ct=G-L,Ne=Oe(ct).length,He=_?_.col-p.col+1:0;if(_?se=He:se=Math.max(Ne,He),ce.col=p.col,ge=a.getCellMeta(ce.row,ce.col),(T==="CopyPaste.paste"||T==="Autofill.fill")&&ge.skipRowOnPaste){L+=1,ce.row+=1,J+=1;continue}for(z=0,ee=0;ee<se&&!(_&&ce.col>_.col&&He>Ne||!m.allowInsertColumn&&ce.col>a.countCols()-1||ce.col>=m.maxCols);ee++){if(ge=a.getCellMeta(ce.row,ce.col),(T==="CopyPaste.paste"||T==="Autofill.fill")&&ge.skipColumnOnPaste){z+=1,ce.col+=1,se+=1;continue}if(ge.readOnly&&T!=="UndoRedo.undo"){ce.col+=1;continue}var rt=ee-z,it=Oe(ct,rt),Je=a.getDataAtCell(ce.row,ce.col),Xe={row:ct,col:rt};if(T==="Autofill.fill"){var Qe=a.runHooks("beforeAutofillInsidePopulate",Xe,F,b,W,{},B);Qe&&(it=gt(Qe.value)?it:Qe.value)}if(it!==null&&Cr(it)==="object")if(Array.isArray(it)&&Je===null&&(Je=[]),Je===null||Cr(Je)!=="object")ae=!1;else{var jt=ss(Array.isArray(Je)?Je:Je[0]||Je),yt=ss(Array.isArray(it)?it:it[0]||it);vm(jt,yt)||Array.isArray(jt)&&Array.isArray(yt)?it=lr(it):ae=!1}else Je!==null&&Cr(Je)==="object"&&(ae=!1);ae&&Re.push([ce.row,ce.col,it]),ae=!0,ce.col+=1}ce.row+=1}a.setDataAtCell(Re,null,null,T||"populateFromArray");break}}};function U(y){var p=n2(y);lP(p)?(a.runHooks("beforeLanguageChange",p),w.language=p,a.runHooks("afterLanguageChange",p)):o2(y)}function X(y,p){var b=y==="className"?a.rootElement:a.table;if(h)re(b,p);else{var _=[],T=[];w[y]&&(_=Array.isArray(w[y])?w[y]:bC(w[y])),p&&(T=Array.isArray(p)?p:bC(p));var I=mC(_,T),F=mC(T,_);I.length&&Le(b,I),F.length&&re(b,F)}w[y]=p}this.init=function(){u.setData(m.data),a.runHooks("beforeInit"),(fn()||F0())&&re(a.rootElement,"mobile"),this.updateSettings(m,!0),this.view=new rge(this),c=ole.getInstance(a,m,R),a.runHooks("init"),this.forceFullRender=!0,this.view.render(),h&&a.rootElement.offsetParent===null&&bV(a.rootElement,function(){a.view._wt.wtOverlays.updateLastSpreaderSize(),a.render(),a.view.adjustElementsSize()}),Cr(h)==="object"&&(a.runHooks("afterChange",h[0],h[1]),h=!1),a.runHooks("afterInit")};function Y(){var y=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue+=1,y=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){this.validatorsInQueue===0&&y===!1&&(y=!0,this.onQueueEmpty(this.valid))}}}function q(y){var p=y.replace(",",".");return isNaN(parseFloat(p))===!1?parseFloat(p):y}function Z(y,p,b){if(y.length){var _=a.getActiveEditor(),T=a.runHooks("beforeChange",y,p||"edit"),I=!0;if(T===!1){_&&_.cancelChanges();return}var F=new Y;F.onQueueEmpty=function(de){_&&I&&_.cancelChanges(),b(de)};for(var W=y.length-1;W>=0;W--)if(y[W]===null)y.splice(W,1);else{var G=_n(y[W],4),J=G[0],ee=G[1],se=G[3],Re=s.propToCol(ee),ce=a.getCellMeta(J,Re);ce.type==="numeric"&&typeof se=="string"&&VV(se)&&(y[W][3]=q(se)),a.getCellValidator(ce)&&(F.addValidatorToQueue(),a.validateCell(y[W][3],ce,function(de,K){return function(Me){if(typeof Me!="boolean")throw new Error("Validation error: result is not boolean");if(Me===!1&&K.allowInvalid===!1){I=!1,y.splice(de,1),K.valid=!0;var Ge=a.getCell(K.visualRow,K.visualCol);Ge!==null&&Le(Ge,m.invalidCellClassName)}F.removeValidatorFormQueue()}}(W,ce),p))}F.checkIfQueueIsEmpty()}}function ie(y,p){var b=y.length-1;if(!(b<0)){for(;b>=0;b--){var _=!1;if(y[b]===null){y.splice(b,1);continue}if(!((y[b][2]===null||y[b][2]===void 0)&&(y[b][3]===null||y[b][3]===void 0))){if(m.allowInsertRow)for(;y[b][0]>a.countRows()-1;){var T=s.createRow(void 0,void 0,{source:p}),I=T.delta;if(I===0){_=!0;break}}if(a.dataType==="array"&&(!m.columns||m.columns.length===0)&&m.allowInsertColumn)for(;s.propToCol(y[b][1])>a.countCols()-1;){var F=s.createCol(void 0,void 0,{source:p}),W=F.delta;if(W===0){_=!0;break}}_||s.set(y[b][0],y[b][1],y[b][3])}}a.forceFullRender=!0,f.adjustRowsAndCols(),a.runHooks("beforeChangeRender",y,p),c.lockEditor(),a._refreshBorders(null),c.unlockEditor(),a.view.adjustElementsSize(),a.runHooks("afterChange",y,p||"edit");var G=a.getActiveEditor();G&&ve(G.refreshValue)&&G.refreshValue()}}this._createCellCoords=function(y,p){return a.view._wt.createCellCoords(y,p)},this._createCellRange=function(y,p,b){return a.view._wt.createCellRange(y,p,b)},this.validateCell=function(y,p,b,_){var T=a.getCellValidator(p);function I(F){var W=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!W||p.hidden===!0){b(F);return}var G=p.visualCol,J=p.visualRow,ee=a.getCell(J,G,!0);if(ee&&ee.nodeName!=="TH"){var se=a.rowIndexMapper.getRenderableFromVisualIndex(J),Re=a.columnIndexMapper.getRenderableFromVisualIndex(G);a.view._wt.getSetting("cellRenderer",se,Re,ee)}b(F)}sV(T)&&(T=function(F){return function(W,G){G(F.test(W))}}(T)),bt(T)?(y=a.runHooks("beforeValidate",y,p.visualRow,p.prop,_),a._registerImmediate(function(){T.call(p,y,function(F){a&&(F=a.runHooks("afterValidate",F,y,p.visualRow,p.prop,_),p.valid=F,I(F),a.runHooks("postAfterValidate",F,y,p.visualRow,p.prop,_))})})):a._registerImmediate(function(){p.valid=!0,I(p.valid,!1)})};function Q(y,p,b){return Array.isArray(y)?y:[[y,p,b]]}this.setDataAtCell=function(y,p,b,_){var T=Q(y,p,b),I=[],F=_,W,G,J;for(W=0,G=T.length;W<G;W++){if(Cr(T[W])!=="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof T[W][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");T[W][1]>=this.countCols()?J=T[W][1]:J=s.colToProp(T[W][1]),I.push([T[W][0],J,u.getAtCell(this.toPhysicalRow(T[W][0]),T[W][1]),T[W][2]])}!F&&Cr(y)==="object"&&(F=p),a.runHooks("afterSetDataAtCell",I,F),Z(I,F,function(){ie(I,F)})},this.setDataAtRowProp=function(y,p,b,_){var T=Q(y,p,b),I=[],F=_,W,G;for(W=0,G=T.length;W<G;W++)I.push([T[W][0],T[W][1],u.getAtCell(this.toPhysicalRow(T[W][0]),T[W][1]),T[W][2]]);!F&&Cr(y)==="object"&&(F=p),a.runHooks("afterSetDataAtRowProp",I,F),Z(I,F,function(){ie(I,F)})},this.listen=function(){a&&!a.isListening()&&(xw=a.guid,a.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(xw=null,a.runHooks("afterUnlisten"))},this.isListening=function(){return xw===a.guid},this.destroyEditor=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;a._refreshBorders(y,p)},this.populateFromArray=function(y,p,b,_,T,I,F,W,G){if(!(Cr(b)==="object"&&Cr(b[0])==="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");var J=typeof _=="number"?a._createCellCoords(_,T):null;return f.populateFromArray(a._createCellCoords(y,p),b,J,I,F,W,G)},this.spliceCol=function(y,p,b){for(var _,T=arguments.length,I=new Array(T>3?T-3:0),F=3;F<T;F++)I[F-3]=arguments[F];return(_=s).spliceCol.apply(_,[y,p,b].concat(I))},this.spliceRow=function(y,p,b){for(var _,T=arguments.length,I=new Array(T>3?T-3:0),F=3;F<T;F++)I[F-3]=arguments[F];return(_=s).spliceRow.apply(_,[y,p,b].concat(I))},this.getSelected=function(){if(R.isSelected())return Be(R.getSelectedRange(),function(y){var p=y.from,b=y.to;return[p.row,p.col,b.row,b.col]})},this.getSelectedLast=function(){var y=this.getSelected(),p;return y&&y.length>0&&(p=y[y.length-1]),p},this.getSelectedRange=function(){if(R.isSelected())return Array.from(R.getSelectedRange())},this.getSelectedRangeLast=function(){var y=this.getSelectedRange(),p;return y&&y.length>0&&(p=y[y.length-1]),p},this.emptySelectedCells=function(y){var p=this;if(!(!R.isSelected()||this.countRows()===0||this.countCols()===0)){var b=[];$(R.getSelectedRange(),function(_){var T=_.getTopStartCorner(),I=_.getBottomEndCorner();_e(T.row,I.row,function(F){_e(T.col,I.col,function(W){p.getCellMeta(F,W).readOnly||b.push([F,W,null])})})}),b.length>0&&this.setDataAtCell(b,y)}},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){var y=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(y,0),!this.isRenderSuspended()&&y===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(c.lockEditor(),this._refreshBorders(null),c.unlockEditor()))},this.batchRender=function(y){this.suspendRender();var p=y();return this.resumeRender(),p},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(p,0),(!this.isExecutionSuspended()&&p===this.executionSuspendedCounter||y)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(y){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();var b=y();return this.resumeExecution(p),b},this.batch=function(y){this.suspendRender(),this.suspendExecution();var p=y();return this.resumeExecution(),this.resumeRender(),p},this.refreshDimensions=function(){if(a.view){var y=a.view.getLastSize(),p=y.width,b=y.height,_=a.rootElement.getBoundingClientRect(),T=_.width,I=_.height,F=T!==p||I!==b,W=a.runHooks("beforeRefreshDimensions",{width:p,height:b},{width:T,height:I},F)===!1;W||((F||a.view._wt.wtOverlays.scrollableElement===a.rootWindow)&&(a.view.setLastSize(T,I),a.render()),a.runHooks("afterRefreshDimensions",{width:p,height:b},{width:T,height:I},F))}},this.updateData=function(y,p){var b=this;IM(y,function(_){s=_},function(_){s=_,a.columnIndexMapper.fitToLength(b.getInitialColumnCount()),a.rowIndexMapper.fitToLength(b.countSourceRows()),f.adjustRowsAndCols()},{hotInstance:a,dataMap:s,dataSource:u,internalSource:"updateData",source:p,metaManager:g,firstRun:h})},this.loadData=function(y,p){IM(y,function(b){s=b},function(){g.clearCellsCache(),a.initIndexMappers(),f.adjustRowsAndCols(),h&&(h=[null,"loadData"])},{hotInstance:a,dataMap:s,dataSource:u,internalSource:"loadData",source:p,metaManager:g,firstRun:h})},this.getInitialColumnCount=function(){var y=m.columns,p=0;if(Array.isArray(y))p=y.length;else if(bt(y))if(a.dataType==="array")for(var b=this.countSourceCols(),_=0;_<b;_+=1)y(_)&&(p+=1);else(a.dataType==="object"||a.dataType==="function")&&(p=s.colToPropCache.length);else if(ve(m.dataSchema)){var T=s.getSchema();p=Array.isArray(T)?T.length:ym(T)}else p=this.countSourceCols();return p},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(y,p,b,_){return gt(y)?s.getAll():s.getRange(a._createCellCoords(y,p),a._createCellCoords(b,_),s.DESTINATION_RENDERER)},this.getCopyableText=function(y,p,b,_){return s.getCopyableText(a._createCellCoords(y,p),a._createCellCoords(b,_))},this.getCopyableData=function(y,p){return s.getCopyable(y,s.colToProp(p))},this.getSchema=function(){return s.getSchema()},this.updateSettings=function(y){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,b=(h?a.loadData:a.updateData).bind(this),_=!1,T,I;if(ve(y.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(ve(y.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(ve(y.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(T in y)T==="data"||(T==="language"?U(y.language):T==="className"?X("className",y.className):T==="tableClassName"&&a.table?(X("tableClassName",y.tableClassName),a.view._wt.wtOverlays.syncOverlayTableClassNames()):pe.getSingleton().isRegistered(T)||pe.getSingleton().isDeprecated(T)?(bt(y[T])||Array.isArray(y[T]))&&(y[T].initialHook=!0,a.addHook(T,y[T])):!p&&At(y,T)&&(w[T]=y[T]));y.data===void 0&&m.data===void 0?b(null,"updateSettings"):y.data!==void 0?b(y.data,"updateSettings"):y.columns!==void 0&&(s.createMap(),a.initIndexMappers());var F=a.countCols(),W=m.columns;if(W&&bt(W)&&(_=!0),(y.cell!==void 0||y.cells!==void 0||y.columns!==void 0)&&g.clearCache(),F>0)for(T=0,I=0;T<F;T++){if(W){var G=_?W(T):W[I];G&&g.updateColumnMeta(I,G)}I+=1}ve(y.cell)&&We(y.cell,function(de){a.setCellMetaObject(de.row,de.col,de)}),a.runHooks("afterCellMetaReset");var J=a.rootElement.style.height;J!==""&&(J=parseInt(a.rootElement.style.height,10));var ee=y.height;if(bt(ee)&&(ee=ee()),p){var se=a.rootElement.getAttribute("style");se&&a.rootElement.setAttribute("data-initialstyle",a.rootElement.getAttribute("style"))}if(ee===null){var Re=a.rootElement.getAttribute("data-initialstyle");Re&&(Re.indexOf("height")>-1||Re.indexOf("overflow")>-1)?a.rootElement.setAttribute("style",Re):(a.rootElement.style.height="",a.rootElement.style.overflow="")}else ee!==void 0&&(a.rootElement.style.height=isNaN(ee)?"".concat(ee):"".concat(ee,"px"),a.rootElement.style.overflow="hidden");if(typeof y.width<"u"){var ce=y.width;bt(ce)&&(ce=ce()),a.rootElement.style.width=isNaN(ce)?"".concat(ce):"".concat(ce,"px")}p||(a.view&&(a.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),a.view._wt.exportSettingsAsClassNames()),a.runHooks("afterUpdateSettings",y)),f.adjustRowsAndCols(),a.view&&!h&&(a.forceFullRender=!0,c.lockEditor(),a._refreshBorders(null),a.view._wt.wtOverlays.adjustElementsSize(),c.unlockEditor()),!p&&a.view&&(J===""||ee===""||ee===void 0)&&J!==ee&&a.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var y=a.getSelectedLast();if(m.getValue){if(bt(m.getValue))return m.getValue.call(a);if(y)return a.getData()[y[0][0]][m.getValue]}else if(y)return a.getDataAtCell(y[0],y[1])},this.getSettings=function(){return m},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(y,p,b,_,T){f.alter(y,p,b,_,T)},this.getCell=function(y,p){var b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,_=p,T=y;if(p>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(p)))return null;_=this.columnIndexMapper.getRenderableFromVisualIndex(p)}if(y>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(y)))return null;T=this.rowIndexMapper.getRenderableFromVisualIndex(y)}return T===null||_===null?null:a.view.getCellAtCoords(a._createCellCoords(T,_),b)},this.getCoords=function(y){var p=this.view._wt.wtTable.getCoords(y);if(p===null)return null;var b=p.row,_=p.col,T=b,I=_;return b>=0&&(T=this.rowIndexMapper.getVisualFromRenderableIndex(b)),_>=0&&(I=this.columnIndexMapper.getVisualFromRenderableIndex(_)),a._createCellCoords(T,I)},this.colToProp=function(y){return s.colToProp(y)},this.propToCol=function(y){return s.propToCol(y)},this.toVisualRow=function(y){return n.rowIndexMapper.getVisualFromPhysicalIndex(y)},this.toVisualColumn=function(y){return n.columnIndexMapper.getVisualFromPhysicalIndex(y)},this.toPhysicalRow=function(y){return n.rowIndexMapper.getPhysicalFromVisualIndex(y)},this.toPhysicalColumn=function(y){return n.columnIndexMapper.getPhysicalFromVisualIndex(y)},this.getDataAtCell=function(y,p){return s.get(y,s.colToProp(p))},this.getDataAtRowProp=function(y,p){return s.get(y,p)},this.getDataAtCol=function(y){for(var p=[],b=s.getRange(a._createCellCoords(0,y),a._createCellCoords(m.data.length-1,y),s.DESTINATION_RENDERER),_=0;_<b.length;_+=1)for(var T=0;T<b[_].length;T+=1)p.push(b[_][T]);return p},this.getDataAtProp=function(y){for(var p=[],b=s.getRange(a._createCellCoords(0,s.propToCol(y)),a._createCellCoords(m.data.length-1,s.propToCol(y)),s.DESTINATION_RENDERER),_=0;_<b.length;_+=1)for(var T=0;T<b[_].length;T+=1)p.push(b[_][T]);return p},this.getSourceData=function(y,p,b,_){var T;return y===void 0?T=u.getData():T=u.getByRange(a._createCellCoords(y,p),a._createCellCoords(b,_)),T},this.getSourceDataArray=function(y,p,b,_){var T;return y===void 0?T=u.getData(!0):T=u.getByRange(a._createCellCoords(y,p),a._createCellCoords(b,_),!0),T},this.getSourceDataAtCol=function(y){return u.getAtColumn(y)},this.setSourceDataAtCell=function(y,p,b,_){var T=Q(y,p,b),I=this.hasHook("afterSetSourceDataAtCell"),F=[];I&&$(T,function(G){var J=_n(G,3),ee=J[0],se=J[1],Re=J[2];F.push([ee,se,u.getAtCell(ee,se),Re])}),$(T,function(G){var J=_n(G,3),ee=J[0],se=J[1],Re=J[2];u.setAtCell(ee,se,Re)}),I&&this.runHooks("afterSetSourceDataAtCell",F,_),this.render();var W=a.getActiveEditor();W&&ve(W.refreshValue)&&W.refreshValue()},this.getSourceDataAtRow=function(y){return u.getAtRow(y)},this.getSourceDataAtCell=function(y,p){return u.getAtCell(y,p)},this.getDataAtRow=function(y){var p=s.getRange(a._createCellCoords(y,0),a._createCellCoords(y,this.countCols()-1),s.DESTINATION_RENDERER);return p[0]||[]},this.getDataType=function(y,p,b,_){var T=this,I=y===void 0?[0,0,this.countRows(),this.countCols()]:[y,p,b,_],F=I[0],W=I[1],G=I[2],J=I[3],ee=null,se=null;G===void 0&&(G=F),J===void 0&&(J=W);var Re="mixed";return _e(Math.max(Math.min(F,G),0),Math.max(F,G),function(ce){var de=!0;return _e(Math.max(Math.min(W,J),0),Math.max(W,J),function(K){var Me=T.getCellMeta(ce,K);return se=Me.type,ee?de=ee===se:ee=se,de}),Re=de?se:"mixed",de}),Re},this.removeCellMeta=function(y,p,b){var _=[this.toPhysicalRow(y),this.toPhysicalColumn(p)],T=_[0],I=_[1],F=g.getCellMetaKeyValue(T,I,b),W=a.runHooks("beforeRemoveCellMeta",y,p,b,F);W!==!1&&(g.removeCellMeta(T,I,b),a.runHooks("afterRemoveCellMeta",y,p,b,F)),F=null},this.spliceCellsMeta=function(y){for(var p=this,b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,_=arguments.length,T=new Array(_>2?_-2:0),I=2;I<_;I++)T[I-2]=arguments[I];if(T.length>0&&!Array.isArray(T[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");b>0&&g.removeRow(this.toPhysicalRow(y),b),T.length>0&&$(T.reverse(),function(F){g.createRow(p.toPhysicalRow(y)),$(F,function(W,G){return p.setCellMetaObject(y,G,W)})}),a.render()},this.setCellMetaObject=function(y,p,b){var _=this;Cr(b)==="object"&&We(b,function(T,I){_.setCellMeta(y,p,I,T)})},this.setCellMeta=function(y,p,b,_){var T=a.runHooks("beforeSetCellMeta",y,p,b,_);if(T!==!1){var I=y,F=p;y<this.countRows()&&(I=this.toPhysicalRow(y)),p<this.countCols()&&(F=this.toPhysicalColumn(p)),g.setCellMeta(I,F,b,_),a.runHooks("afterSetCellMeta",y,p,b,_)}},this.getCellsMeta=function(){return g.getCellsMeta()},this.getCellMeta=function(y,p){var b=this.toPhysicalRow(y),_=this.toPhysicalColumn(p);return b===null&&(b=y),_===null&&(_=p),g.getCellMeta(b,_,{visualRow:y,visualColumn:p})},this.getCellMetaAtRow=function(y){return g.getCellsMetaAtRow(y)},this.isColumnModificationAllowed=function(){return!(a.dataType==="object"||m.columns)},this.getCellRenderer=function(y,p){var b=typeof y=="number"?a.getCellMeta(y,p).renderer:y.renderer;return typeof b=="string"?Yg(b):gt(b)?Yg("text"):b},this.getCellEditor=function(y,p){var b=typeof y=="number"?a.getCellMeta(y,p).editor:y.editor;return typeof b=="string"?Ug(b):gt(b)?Ug("text"):b},this.getCellValidator=function(y,p){var b=typeof y=="number"?a.getCellMeta(y,p).validator:y.validator;return typeof b=="string"?SE(b):b},this.validateCells=function(y){this._validateCells(y)},this.validateRows=function(y,p){if(!Array.isArray(y))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(p,y)},this.validateColumns=function(y,p){if(!Array.isArray(y))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(p,void 0,y)},this._validateCells=function(y,p,b){var _=new Y;y&&(_.onQueueEmpty=y);for(var T=a.countRows()-1;T>=0;){if(p!==void 0&&p.indexOf(T)===-1){T-=1;continue}for(var I=a.countCols()-1;I>=0;){if(b!==void 0&&b.indexOf(I)===-1){I-=1;continue}_.addValidatorToQueue(),a.validateCell(a.getDataAtCell(T,I),a.getCellMeta(T,I),function(F){if(typeof F!="boolean")throw new Error("Validation error: result is not boolean");F===!1&&(_.valid=!1),_.removeValidatorFormQueue()},"validateCells"),I-=1}T-=1}_.checkIfQueueIsEmpty()},this.getRowHeader=function(y){var p=m.rowHeaders,b=y;return b!==void 0&&(b=a.runHooks("modifyRowHeader",b)),b===void 0?(p=[],_e(a.countRows()-1,function(_){p.push(a.getRowHeader(_))})):Array.isArray(p)&&p[b]!==void 0?p=p[b]:bt(p)?p=p(b):p&&typeof p!="string"&&typeof p!="number"&&(p=b+1),p},this.hasRowHeaders=function(){return!!m.rowHeaders},this.hasColHeaders=function(){if(m.colHeaders!==void 0&&m.colHeaders!==null)return!!m.colHeaders;for(var y=0,p=a.countCols();y<p;y++)if(a.getColHeader(y))return!0;return!1},this.getColHeader=function(y){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,b=a.runHooks("modifyColHeader",y);if(b===void 0){for(var _=[],T=a.countCols(),I=0;I<T;I++)_.push(a.getColHeader(I));return _}var F=m.colHeaders,W=function(se){for(var Re=[],ce=a.countCols(),de=0;de<ce;de++)bt(m.columns)&&m.columns(de)&&Re.push(de);return Re[se]},G=a.toPhysicalColumn(b),J=W(G);return m.colHeaders===!1?F=null:m.columns&&bt(m.columns)&&m.columns(J)&&m.columns(J).title?F=m.columns(J).title:m.columns&&m.columns[G]&&m.columns[G].title?F=m.columns[G].title:Array.isArray(m.colHeaders)&&m.colHeaders[G]!==void 0?F=m.colHeaders[G]:bt(m.colHeaders)?F=m.colHeaders(G):m.colHeaders&&typeof m.colHeaders!="string"&&typeof m.colHeaders!="number"&&(F=xm(b)),F=a.runHooks("modifyColumnHeaderValue",F,y,p),F},this._getColWidthFromSettings=function(y){var p;if(y>=0){var b=a.getCellMeta(0,y);p=b.width}if((p===void 0||p===m.width)&&(p=m.colWidths),p!=null){switch(Cr(p)){case"object":p=p[y];break;case"function":p=p(y);break}typeof p=="string"&&(p=parseInt(p,10))}return p},this.getColWidth=function(y){var p=a._getColWidthFromSettings(y);return p=a.runHooks("modifyColWidth",p,y),p===void 0&&(p=CE.DEFAULT_WIDTH),p},this._getRowHeightFromSettings=function(y){var p=m.rowHeights;if(p!=null){switch(Cr(p)){case"object":p=p[y];break;case"function":p=p(y);break}typeof p=="string"&&(p=parseInt(p,10))}return p},this.getRowHeight=function(y){var p=a._getRowHeightFromSettings(y);return p=a.runHooks("modifyRowHeight",p,y),p},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return s.getLength()},this.countCols=function(){var y=m.maxCols,p=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(y,p)},this.countRenderedRows=function(){return a.view._wt.drawn?a.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return a.view._wt.drawn?a.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return a.view._wt.drawn?a.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return a.view._wt.drawn?a.view._wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=0;return zg(a.countRows()-1,function(b){if(a.isEmptyRow(b))p+=1;else if(y===!0)return!1}),p},this.countEmptyCols=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=0;return zg(a.countCols()-1,function(b){if(a.isEmptyCol(b))p+=1;else if(y===!0)return!1}),p},this.isEmptyRow=function(y){return m.isEmptyRow.call(a,y)},this.isEmptyCol=function(y){return m.isEmptyCol.call(a,y)},this.selectCell=function(y,p,b,_){var T=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,I=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return gt(y)||gt(p)?!1:this.selectCells([[y,p,b,_]],T,I)},this.selectCells=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;p===!1&&(i=!0);var _=R.selectCells(y);return _&&b&&a.listen(),i=!1,_},this.selectColumns=function(y){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:y;return R.selectColumns(y,p)},this.selectRows=function(y){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:y;return R.selectRows(y,p)},this.deselectCell=function(){R.deselect()},this.selectAll=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,p=y&&this.hasRowHeaders(),b=y&&this.hasColHeaders();i=!0,R.selectAll(p,b),i=!1};var le=function(p,b){return p.getNearestNotHiddenIndex(b,1,!0)};this.scrollViewportTo=function(y,p){var b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,_=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,T=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,I=!b,F=!_,W=y,G=p;if(T){var J=Number.isInteger(y),ee=Number.isInteger(p),se=J?le(this.rowIndexMapper,y):void 0,Re=ee?le(this.columnIndexMapper,p):void 0;if(se===null||Re===null)return!1;W=J?a.rowIndexMapper.getRenderableFromVisualIndex(se):void 0,G=ee?a.columnIndexMapper.getRenderableFromVisualIndex(Re):void 0}var ce=Number.isInteger(W),de=Number.isInteger(G);return ce&&de?a.view.scrollViewport(a._createCellCoords(W,G),I,_,b,F):ce&&de===!1?a.view.scrollViewportVertically(W,I,b):de&&ce===!1?a.view.scrollViewportHorizontally(G,_,F):!1},this.destroy=function(){if(a._clearTimeouts(),a._clearImmediates(),a.view&&a.view.destroy(),u&&u.destroy(),u=null,this.getShortcutManager().destroy(),g.clearCache(),w_(a)){var y=this.rootDocument.querySelector(".hot-display-license-info");y&&y.parentNode.removeChild(y)}yn(a.rootElement),l.destroy(),c&&c.destroy(),a.batchExecution(function(){a.rowIndexMapper.unregisterAll(),a.columnIndexMapper.unregisterAll(),S.getItems().forEach(function(p){var b=_n(p,2),_=b[1];_.destroy()}),S.clear(),a.runHooks("afterDestroy")},!0),pe.getSingleton().destroy(a),We(a,function(p,b,_){bt(p)?_[b]=Se(b):b!=="guid"&&(_[b]=null)}),a.isDestroyed=!0,s&&s.destroy(),s=null,f=null,R=null,c=null,a=null};function Se(y){return function(){throw new Error('The "'.concat(y,'" method cannot be called because this Handsontable instance has been destroyed'))}}this.getActiveEditor=function(){return c.getActiveEditor()},this.getPlugin=function(y){var p=ar(y);return p==="UndoRedo"?this.undoRedo:S.getItem(p)},this.getPluginName=function(y){return y===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:S.getId(y)},this.getInstance=function(){return a},this.addHook=function(y,p){pe.getSingleton().add(y,p,a)},this.hasHook=function(y){return pe.getSingleton().has(y,a)||pe.getSingleton().has(y)},this.addHookOnce=function(y,p){pe.getSingleton().once(y,p,a)},this.removeHook=function(y,p){pe.getSingleton().remove(y,p,a)},this.runHooks=function(y,p,b,_,T,I,F){return pe.getSingleton().run(a,y,p,b,_,T,I,F)},this.getTranslatedPhrase=function(y,p){return c2(m.language,y,p)},this.toHTML=function(){return zC(n)},this.toTableElement=function(){var y=n.rootDocument.createElement("div");return y.insertAdjacentHTML("afterbegin",zC(n)),y.firstElementChild},this.timeouts=[],this._registerTimeout=function(y){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,b=y;typeof b=="function"&&(b=setTimeout(b,p)),this.timeouts.push(b)},this._clearTimeouts=function(){$(this.timeouts,function(y){clearTimeout(y)})},this.immediates=[],this._registerImmediate=function(y){this.immediates.push(setImmediate(y))},this._clearImmediates=function(){$(this.immediates,function(y){clearImmediate(y)})},this._refreshBorders=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;c.destroyEditor(y),a.view.render(),p&&R.isSelected()&&c.prepareEditor()},this.isRtl=function(){return a.rootWindow.getComputedStyle(a.rootElement).direction==="rtl"},this.isLtr=function(){return!a.isRtl()},this.getDirectionFactor=function(){return a.isLtr()?1:-1};var me=ECe({handleEvent:function(p){var b=a.isListening(),_=(p==null?void 0:p.key)!==void 0;return b&&_},beforeKeyDown:function(p){return n.runHooks("beforeKeyDown",p)},afterKeyDown:function(p){n.isDestroyed||a.runHooks("afterDocumentKeyDown",p)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",function(y){y.ctrlKey===!1&&y.metaKey===!1&&me.releasePressedKeys()}),this.getShortcutManager=function(){return me};var Ce=me.addContext("grid"),k={runOnlyIf:function(){return ve(a.getSelected())&&a.countRenderedRows()>0&&a.countRenderedCols()>0},group:MCe};me.setActiveContextName("grid"),Ce.addShortcuts([{keys:[["Control/Meta","A"]],callback:function(){a.selectAll()}},{keys:[["Control/Meta","Enter"]],callback:function(){for(var p=a.getSelectedRange(),b=p[p.length-1].highlight,_=b.row,T=b.col,I=a.getDataAtCell(_,T),F=new Map,W=0;W<p.length;W++)p[W].forAll(function(G,J){if(G>=0&&J>=0&&(G!==_||J!==T)){var ee=a.getCellMeta(G,J),se=ee.readOnly;se||F.set("".concat(G,"x").concat(J),[G,J,I])}});a.setDataAtCell(Array.from(F.values()))},runOnlyIf:function(){return a.getSelectedRangeLast().getCellsCount()>1}},{keys:[["ArrowUp"]],callback:function(){R.transformStart(-1,0)}},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:function(){R.setRangeStart(a._createCellCoords(a.rowIndexMapper.getNearestNotHiddenIndex(0,1),a.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowUp","Shift"]],callback:function(){R.transformEnd(-1,0)}},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var p=a.getSelectedRangeLast(),b=p.from,_=p.to,T=a.rowIndexMapper.getNearestNotHiddenIndex(0,1);R.setRangeStart(b.clone()),R.setRangeEnd(a._createCellCoords(T,_.col))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByColumnHeader())}},{keys:[["ArrowDown"]],callback:function(){R.transformStart(1,0)}},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:function(){R.setRangeStart(a._createCellCoords(a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-1,-1),a.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowDown","Shift"]],callback:function(){R.transformEnd(1,0)}},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var p=a.getSelectedRangeLast(),b=p.from,_=p.to,T=a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-1,-1);R.setRangeStart(b.clone()),R.setRangeEnd(a._createCellCoords(T,_.col))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByColumnHeader())}},{keys:[["ArrowLeft"]],callback:function(){R.transformStart(0,-1*a.getDirectionFactor())}},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:function(){var p,b=a.getSelectedRangeLast().highlight.row,_=(p=a.columnIndexMapper).getNearestNotHiddenIndex.apply(p,gl(a.isRtl()?[a.countCols()-1,-1]:[0,1]));R.setRangeStart(a._createCellCoords(b,_))}},{keys:[["ArrowLeft","Shift"]],callback:function(){R.transformEnd(0,-1*a.getDirectionFactor())}},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var p,b=a.getSelectedRangeLast(),_=b.from,T=b.to,I=(p=a.columnIndexMapper).getNearestNotHiddenIndex.apply(p,gl(a.isRtl()?[a.countCols()-1,-1]:[0,1]));R.setRangeStart(_.clone()),R.setRangeEnd(a._createCellCoords(T.row,I))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByRowHeader())}},{keys:[["ArrowRight"]],callback:function(){R.transformStart(0,a.getDirectionFactor())}},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:function(){var p,b=a.getSelectedRangeLast().highlight.row,_=(p=a.columnIndexMapper).getNearestNotHiddenIndex.apply(p,gl(a.isRtl()?[0,1]:[a.countCols()-1,-1]));R.setRangeStart(a._createCellCoords(b,_))}},{keys:[["ArrowRight","Shift"]],callback:function(){R.transformEnd(0,a.getDirectionFactor())}},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var p,b=a.getSelectedRangeLast(),_=b.from,T=b.to,I=(p=a.columnIndexMapper).getNearestNotHiddenIndex.apply(p,gl(a.isRtl()?[0,1]:[a.countCols()-1,-1]));R.setRangeStart(_.clone()),R.setRangeEnd(a._createCellCoords(T.row,I))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByRowHeader())}},{keys:[["Home"]],captureCtrl:!0,callback:function(){var p=parseInt(a.getSettings().fixedColumnsStart,10),b=a.getSelectedRangeLast().highlight.row,_=a.columnIndexMapper.getNearestNotHiddenIndex(p,1);R.setRangeStart(a._createCellCoords(b,_))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["Home","Shift"]],callback:function(){R.setRangeEnd(a._createCellCoords(R.selectedRange.current().from.row,a.columnIndexMapper.getNearestNotHiddenIndex(0,1)))}},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:function(){var p=parseInt(a.getSettings().fixedRowsTop,10),b=parseInt(a.getSettings().fixedColumnsStart,10),_=a.rowIndexMapper.getNearestNotHiddenIndex(p,1),T=a.columnIndexMapper.getNearestNotHiddenIndex(b,1);R.setRangeStart(a._createCellCoords(_,T))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End"]],captureCtrl:!0,callback:function(){R.setRangeStart(a._createCellCoords(a.getSelectedRangeLast().highlight.row,a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1)))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End","Shift"]],callback:function(){R.setRangeEnd(a._createCellCoords(R.selectedRange.current().from.row,a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1)))}},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:function(){var p=parseInt(a.getSettings().fixedRowsBottom,10),b=a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-p-1,-1),_=a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1);R.setRangeStart(a._createCellCoords(b,_))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["PageUp"]],callback:function(){R.transformStart(-a.countVisibleRows(),0)}},{keys:[["PageUp","Shift"]],callback:function(){var p=a.getSelectedRangeLast(),b=p.to,_=Math.max(b.row-a.countVisibleRows(),0),T=a.rowIndexMapper.getNearestNotHiddenIndex(_,1);if(T!==null){var I=a._createCellCoords(T,b.col),F=b.row-a.view.getFirstFullyVisibleRow(),W=Math.max(I.row-F,0);R.setRangeEnd(I),a.scrollViewportTo(W)}}},{keys:[["PageDown"]],callback:function(){R.transformStart(a.countVisibleRows(),0)}},{keys:[["PageDown","Shift"]],callback:function(){var p=a.getSelectedRangeLast(),b=p.to,_=Math.min(b.row+a.countVisibleRows(),a.countRows()-1),T=a.rowIndexMapper.getNearestNotHiddenIndex(_,-1);if(T!==null){var I=a._createCellCoords(T,b.col),F=b.row-a.view.getFirstFullyVisibleRow(),W=Math.min(I.row-F,a.countRows()-1);R.setRangeEnd(I),a.scrollViewportTo(W)}}},{keys:[["Tab"]],callback:function(p){var b=typeof m.tabMoves=="function"?m.tabMoves(p):m.tabMoves;R.transformStart(b.row,b.col,!0)}},{keys:[["Shift","Tab"]],callback:function(p){var b=typeof m.tabMoves=="function"?m.tabMoves(p):m.tabMoves;R.transformStart(-b.row,-b.col)}}],k),wE().forEach(function(y){var p=yv(y);S.addItem(y,new p(n))}),pe.getSingleton().run(a,"construct")}var xCe="hooksRefRegisterer",k2={_hooksStorage:Object.create(null),addHook:function(t,r){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,r),this._hooksStorage[t].push(r),this},removeHooksByKey:function(t){var r=this;$(this._hooksStorage[t]||[],function(n){r.hot.removeHook(t,n)})},clearHooks:function(){var t=this;We(this._hooksStorage,function(r,n){return t.removeHooksByKey(n)}),this._hooksStorage={}}};Fn(k2,"MIXIN_NAME",xCe,{writable:!1,enumerable:!1});const DCe=k2;function Ws(e){"@babel/helpers - typeof";return Ws=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ws(e)}function NCe(e,t){return FCe(e)||jCe(e,t)||LCe(e,t)||HCe()}function HCe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LCe(e,t){if(e){if(typeof e=="string")return BM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return BM(e,t)}}function BM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function jCe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function FCe(e){if(Array.isArray(e))return e}function BCe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&K_(e,t)}function K_(e,t){return K_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},K_(e,t)}function VCe(e){var t=zCe();return function(){var n=Rp(e),o;if(t){var i=Rp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return WCe(this,o)}}function WCe(e,t){if(t&&(Ws(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return UCe(e)}function UCe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zCe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Rp(e){return Rp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Rp(e)}function VM(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,YCe(n.key),n)}}function UM(e,t,r){return t&&WM(e.prototype,t),r&&WM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function YCe(e){var t=GCe(e,"string");return Ws(t)==="symbol"?t:String(t)}function GCe(e,t){if(Ws(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ws(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var KCe="base",Qt=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),q_="baseEditor",Ef=function(){function e(t){VM(this,e),this.hot=t,this.instance=t,this.state=Qt.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}return UM(e,[{key:"_fireCallbacks",value:function(r){this._closeCallback&&(this._closeCallback(r),this._closeCallback=null)}},{key:"init",value:function(){}},{key:"getValue",value:function(){throw Error("Editor getValue() method unimplemented")}},{key:"setValue",value:function(){throw Error("Editor setValue() method unimplemented")}},{key:"open",value:function(){throw Error("Editor open() method unimplemented")}},{key:"close",value:function(){throw Error("Editor close() method unimplemented")}},{key:"prepare",value:function(r,n,o,i,a,l){this.TD=i,this.row=r,this.col=n,this.prop=o,this.originalValue=a,this.cellProperties=l,this.state=Qt.VIRGIN}},{key:"extend",value:function(){return function(r){BCe(o,r);var n=VCe(o);function o(){return VM(this,o),n.apply(this,arguments)}return UM(o)}(this.constructor)}},{key:"saveValue",value:function(r,n){var o=this,i,a,l,s;if(n){var u=this.hot.getSelectedLast();i=Math.max(Math.min(u[0],u[2]),0),a=Math.max(Math.min(u[1],u[3]),0),l=Math.max(u[0],u[2]),s=Math.max(u[1],u[3])}else{var f=[this.row,this.col,null,null];i=f[0],a=f[1],l=f[2],s=f[3]}var c=this.hot.runHooks("modifyGetCellCoords",i,a);if(Array.isArray(c)){var h=NCe(c,2);i=h[0],a=h[1]}var d=this.hot.getShortcutManager(),v=d.getContext("editor"),g={runOnlyIf:function(){return ve(o.hot.getSelected())},group:q_};this.isInFullEditMode()&&v.addShortcuts([{keys:[["ArrowUp"]],callback:function(){o.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){o.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){o.hot.selection.transformStart(0,-1*o.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){o.hot.selection.transformStart(0,o.hot.getDirectionFactor())}}],g),this.hot.populateFromArray(i,a,r,l,s,"edit")}},{key:"beginEditing",value:function(r,n){if(this.state===Qt.VIRGIN){var o=this.hot,i=o.rowIndexMapper.getRenderableFromVisualIndex(this.row),a=o.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(o.view.scrollViewport(o._createCellCoords(i,a)),this.state=Qt.EDITING,this.isInFullEditMode()){var l=typeof r=="string"?r:It(this.originalValue);this.setValue(l)}this.open(n),this._opened=!0,this.focus(),o.view.render(),o.runHooks("afterBeginEditing",this.row,this.col)}}},{key:"finishEditing",value:function(r,n,o){var i=this,a;if(o){var l=this._closeCallback;this._closeCallback=function(c){l&&l(c),o(c),i.hot.view.render()}}if(!this.isWaiting()){var s=this.hot.getShortcutManager(),u=s.getContext("editor");if(u.removeShortcutsByGroup(q_),u.removeShortcutsByGroup(Im),this.state===Qt.VIRGIN){this.hot._registerTimeout(function(){i._fireCallbacks(!0)});return}if(this.state===Qt.EDITING){if(r){this.cancelChanges(),this.hot.view.render();return}var f=this.getValue();this.cellProperties.trimWhitespace?a=[[typeof f=="string"?String.prototype.trim.call(f||""):f]]:a=[[f]],this.state=Qt.WAITING,this.saveValue(a,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",function(c){i.state=Qt.FINISHED,i.discardEditor(c)}):(this.state=Qt.FINISHED,this.discardEditor(!0))}}}},{key:"cancelChanges",value:function(){this.state=Qt.FINISHED,this.discardEditor()}},{key:"discardEditor",value:function(r){if(this.state===Qt.FINISHED)if(r===!1&&this.cellProperties.allowInvalid!==!0)this.hot.selectCell(this.row,this.col),this.focus(),this.state=Qt.EDITING,this._fireCallbacks(!1);else{this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Qt.VIRGIN,this._fireCallbacks(!0);var n=this.hot.getShortcutManager();n.setActiveContextName("grid")}}},{key:"enableFullEditMode",value:function(){this._fullEditMode=!0}},{key:"isInFullEditMode",value:function(){return this._fullEditMode}},{key:"isOpened",value:function(){return this._opened}},{key:"isWaiting",value:function(){return this.state===Qt.WAITING}},{key:"getEditedCellRect",value:function(){var r,n=this.getEditedCell();if(n){var o=this.hot.view._wt,i=o.wtOverlays,a=o.wtViewport,l=this.hot.rootWindow,s=Vt(n),u=dt(n),f=Vt(this.hot.rootElement),c=dt(this.hot.rootElement),h=i.topOverlay.holder,d=i.inlineStartOverlay.holder,v=h!==l?h.scrollTop:0,g=d!==l?d.scrollLeft:0,m=l.innerWidth-f.left-c,w=(r=i.getParentOverlay(n))!==null&&r!==void 0?r:this.hot.view._wt,S=w.wtTable,C=S.name,P=["master","inline_start"].includes(C)?v:0,R=["master","top","bottom"].includes(C)?g:0,V=s.top===f.top?0:1,U=s.top-f.top-V-P,X=0;this.hot.isRtl()?X=l.innerWidth-s.left-u-m-1+R:X=s.left-f.left-1-R,["top","top_inline_start_corner"].includes(C)&&(U+=i.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(C)&&(X+=Math.abs(i.inlineStartOverlay.getOverlayOffset()));var Y=this.hot.hasColHeaders(),q=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),Z=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),ie=this.hot.rowIndexMapper.getRenderableIndexesLength(),Q=ie-this.hot.view._wt.getSetting("fixedRowsBottom");(Y&&q<=0||q===Q)&&(U+=1),Z<=0&&(X+=1);var le=a.rowsRenderCalculator.startPosition,Se=a.columnsRenderCalculator.startPosition,me=Math.abs(i.inlineStartOverlay.getScrollPosition()),Ce=i.topOverlay.getScrollPosition(),k=Xt(this.hot.rootDocument),y=n.offsetTop+le-Ce,p=0;if(this.hot.isRtl()){var b=n.offsetLeft;b>=0?p=S.getWidth()-n.offsetLeft:p=Math.abs(b),p+=Se-me-u}else p=n.offsetLeft+Se-me;var _=Ri(this.TD,this.hot.rootWindow),T=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",I=parseInt(_[T],10)>0?0:1,F=parseInt(_.borderTopWidth,10)>0?0:1,W=dt(n)+I,G=Rt(n)+F,J=gV(h)?k:0,ee=pV(d)?k:0,se=this.hot.view.maximumVisibleElementWidth(p)-J+I,Re=Math.max(this.hot.view.maximumVisibleElementHeight(y)-ee+F,23);return{top:U,start:X,height:G,maxHeight:Re,width:W,maxWidth:se}}}},{key:"getEditedCellsLayerClass",value:function(){var r=this.checkEditorSection();switch(r){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}},{key:"getEditedCell",value:function(){return this.hot.getCell(this.row,this.col,!0)}},{key:"checkEditorSection",value:function(){var r=this.hot.countRows(),n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=r-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}],[{key:"EDITOR_TYPE",get:function(){return KCe}}]),e}();pt(Ef,DCe);function qCe(){var e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},t,r=document.body,n=document.createTextNode(""),o=document.createElement("SPAN"),i=function(d,v,g){d.addEventListener(v,g,!1)},a=function(d,v,g){d.removeEventListener(v,g,!1)},l=function(d){var v,g;d?/^[a-zA-Z \.,\\\/\|0-9]$/.test(d)||(d="."):d="",n.textContent!==void 0?n.textContent=t.value+d:n.data=t.value+d,o.style.position="absolute",o.style.fontSize=c(t).fontSize,o.style.fontFamily=c(t).fontFamily,o.style.whiteSpace="pre",r.appendChild(o),v=o.clientWidth+2,r.removeChild(o),t.style.height=e.minHeight+"px",e.minWidth>v?t.style.width=e.minWidth+"px":v>e.maxWidth?t.style.width=e.maxWidth+"px":t.style.width=v+"px",g=t.scrollHeight?t.scrollHeight-1:0,e.minHeight>g?t.style.height=e.minHeight+"px":e.maxHeight<g?(t.style.height=e.maxHeight+"px",t.style.overflowY="visible"):t.style.height=g+"px"},s=function(){window.setTimeout(l,0)},u=function(d){if(d&&d.minHeight)if(d.minHeight=="inherit")e.minHeight=t.clientHeight;else{var v=parseInt(d.minHeight);isNaN(v)||(e.minHeight=v)}if(d&&d.maxHeight)if(d.maxHeight=="inherit")e.maxHeight=t.clientHeight;else{var g=parseInt(d.maxHeight);isNaN(g)||(e.maxHeight=g)}if(d&&d.minWidth)if(d.minWidth=="inherit")e.minWidth=t.clientWidth;else{var m=parseInt(d.minWidth);isNaN(m)||(e.minWidth=m)}if(d&&d.maxWidth)if(d.maxWidth=="inherit")e.maxWidth=t.clientWidth;else{var w=parseInt(d.maxWidth);isNaN(w)||(e.maxWidth=w)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(n))},f=function(d,v,g){t=d,u(v),t.nodeName=="TEXTAREA"&&(t.style.resize="none",t.style.overflowY="",t.style.height=e.minHeight+"px",t.style.minWidth=e.minWidth+"px",t.style.maxWidth=e.maxWidth+"px",t.style.overflowY="hidden"),g&&(i(t,"change",l),i(t,"cut",s),i(t,"paste",s),i(t,"drop",s),i(t,"keydown",s),i(t,"focus",l),i(t,"compositionstart",s),i(t,"compositionupdate",s),i(t,"compositionend",s)),l()};function c(h){return h.currentStyle||document.defaultView.getComputedStyle(h)}return{init:function(d,v,g){f(d,v,g)},unObserve:function(){a(t,"change",l),a(t,"cut",s),a(t,"paste",s),a(t,"drop",s),a(t,"keydown",s),a(t,"focus",l),a(t,"compositionstart",s),a(t,"compositionupdate",s),a(t,"compositionend",s)},resize:l}}function zM(e,t){for(var r=hE(t),n=t.value.split(`
`),o=r,i=0,a=0;a<n.length;a++){var l=n[a];a!==0&&(i+=n[a-1].length+1);var s=i+l.length;if(e==="home"?o=i:e==="end"&&(o=s),r<=s)break}cv(t,o)}function Us(e){"@babel/helpers - typeof";return Us=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Us(e)}function YM(e,t){return JCe(e)||QCe(e,t)||ZCe(e,t)||XCe()}function XCe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ZCe(e,t){if(e){if(typeof e=="string")return GM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return GM(e,t)}}function GM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function QCe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function JCe(e){if(Array.isArray(e))return e}function e_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,r_e(n.key),n)}}function t_e(e,t,r){return t&&KM(e.prototype,t),r&&KM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function r_e(e){var t=n_e(e,"string");return Us(t)==="symbol"?t:String(t)}function n_e(e,t){if(Us(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Us(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Oc(){return typeof Reflect<"u"&&Reflect.get?Oc=Reflect.get.bind():Oc=function(t,r,n){var o=o_e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Oc.apply(this,arguments)}function o_e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Fa(e),e!==null););return e}function i_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&X_(e,t)}function X_(e,t){return X_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},X_(e,t)}function a_e(e){var t=s_e();return function(){var n=Fa(e),o;if(t){var i=Fa(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return l_e(this,o)}}function l_e(e,t){if(t&&(Us(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $2(e)}function $2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s_e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Fa(e){return Fa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Fa(e)}var u_e="ht_editor_visible",uy="ht_editor_hidden",qM="textEditor",f_e="text",nl=function(e){i_e(r,e);var t=a_e(r);function r(n){var o;return e_e(this,r),o=t.call(this,n),o.eventManager=new Tt($2(o)),o.autoResize=qCe(),o.TEXTAREA=void 0,o.textareaStyle=void 0,o.TEXTAREA_PARENT=void 0,o.textareaParentStyle=void 0,o.layerClass=void 0,o.createElements(),o.bindEvents(),o.hot.addHookOnce("afterDestroy",function(){return o.destroy()}),o}return t_e(r,[{key:"getValue",value:function(){return this.TEXTAREA.value}},{key:"setValue",value:function(o){this.TEXTAREA.value=o}},{key:"open",value:function(){var o=this;this.refreshDimensions(),this.showEditableElement();var i=this.hot.getShortcutManager();i.setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",function(a){return o.onAfterDocumentKeyDown(a)}),this.registerShortcuts()}},{key:"close",value:function(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}},{key:"prepare",value:function(o,i,a,l,s,u){var f=this.state;if(Oc(Fa(r.prototype),"prepare",this).call(this,o,i,a,l,s,u),!u.readOnly){this.refreshDimensions(!0);var c=u.allowInvalid,h=u.fragmentSelection;c&&(this.TEXTAREA.value=""),f!==Qt.FINISHED&&this.hideEditableElement();var d=!h;d&&!fn()&&this.focus()}}},{key:"beginEditing",value:function(o,i){this.state===Qt.VIRGIN&&(this.TEXTAREA.value="",Oc(Fa(r.prototype),"beginEditing",this).call(this,o,i))}},{key:"focus",value:function(){this.TEXTAREA.select(),cv(this.TEXTAREA,this.TEXTAREA.value.length)}},{key:"createElements",value:function(){var o=this.hot.rootDocument;this.TEXTAREA=o.createElement("TEXTAREA"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.tabIndex=-1,re(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=o.createElement("DIV"),re(this.TEXTAREA_PARENT,"handsontableInputHolder"),xe(this.TEXTAREA_PARENT,this.layerClass)&&Le(this.TEXTAREA_PARENT,this.layerClass),re(this.TEXTAREA_PARENT,uy),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}},{key:"hideEditableElement",value:function(){(hB()||cB())&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Le(this.TEXTAREA_PARENT,this.layerClass),re(this.TEXTAREA_PARENT,uy)}},{key:"showEditableElement",value:function(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";var o=this.TEXTAREA_PARENT.childNodes,i=!1;_e(o.length-1,function(a){var l=o[a];if(xe(l,"handsontableEditor"))return i=!0,!1}),xe(this.TEXTAREA_PARENT,uy)&&Le(this.TEXTAREA_PARENT,uy),i?(this.layerClass=u_e,re(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),re(this.TEXTAREA_PARENT,this.layerClass))}},{key:"refreshValue",value:function(){var o=this.hot.toPhysicalRow(this.row),i=this.hot.getSourceDataAtCell(o,this.col);this.originalValue=i,this.setValue(i),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(this.state!==Qt.EDITING&&!o)){if(this.TD=this.getEditedCell(),!this.TD){o||this.close();return}var i=this.getEditedCellRect(),a=i.top,l=i.start,s=i.width,u=i.maxWidth,f=i.height,c=i.maxHeight;this.textareaParentStyle.top="".concat(a,"px"),this.textareaParentStyle[this.hot.isRtl()?"right":"left"]="".concat(l,"px"),this.showEditableElement();var h=Ri(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=h.fontSize,this.TEXTAREA.style.fontFamily=h.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;var d=Ri(this.TEXTAREA),v=parseInt(d.paddingLeft,10)+parseInt(d.paddingRight,10),g=parseInt(d.paddingTop,10)+parseInt(d.paddingBottom,10),m=s-v,w=f-g,S=u-v,C=c-g;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(m,S),minHeight:Math.min(w,C),maxWidth:S,maxHeight:C},!0)}}},{key:"bindEvents",value:function(){var o=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(i){return i.stopPropagation()}),this.eventManager.addEventListener(this.TEXTAREA,"paste",function(i){return i.stopPropagation()}),j0()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",function(){return o.finishEditing(!1)}),this.addHook("afterScrollHorizontally",function(){return o.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return o.refreshDimensions()}),this.addHook("afterColumnResize",function(){o.refreshDimensions(),o.focus()}),this.addHook("afterRowResize",function(){o.refreshDimensions(),o.focus()})}},{key:"allowKeyEventPropagation",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.clearHooks()}},{key:"registerShortcuts",value:function(){var o=this,i=this.hot.getShortcutManager(),a=i.getContext("editor"),l={runOnlyIf:function(){return ve(o.hot.getSelected())},group:qM},s=function(){o.hot.rootDocument.execCommand("insertText",!1,`
`)};a.addShortcuts([{keys:[["Tab"]],callback:function(f){var c=o.hot.getSettings(),h=typeof c.tabMoves=="function"?c.tabMoves(f):c.tabMoves;o.hot.selection.transformStart(h.row,h.col,!0)}},{keys:[["Shift","Tab"]],callback:function(f){var c=o.hot.getSettings(),h=typeof c.tabMoves=="function"?c.tabMoves(f):c.tabMoves;o.hot.selection.transformStart(-h.row,-h.col)}},{keys:[["Control","Enter"]],callback:function(){return s(),!1},runOnlyIf:function(f){return!o.hot.selection.isMultiple()&&!f.altKey},relativeToGroup:wc,position:"before"},{keys:[["Meta","Enter"]],callback:function(){return s(),!1},runOnlyIf:function(){return!o.hot.selection.isMultiple()},relativeToGroup:wc,position:"before"},{keys:[["Alt","Enter"]],callback:function(){return s(),!1},relativeToGroup:wc,position:"before"},{keys:[["PageUp"]],callback:function(){o.hot.selection.transformStart(-o.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:function(){o.hot.selection.transformStart(o.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:function(f,c){var h=YM(c,1),d=h[0];zM(d,o.TEXTAREA)}},{keys:[["End"]],callback:function(f,c){var h=YM(c,1),d=h[0];zM(d,o.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:function(){o.hot._registerTimeout(function(){o.autoResize.resize()},10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:function(){o.hot._registerTimeout(function(){o.autoResize.resize()},10)}}],l)}},{key:"unregisterShortcuts",value:function(){var o=this.hot.getShortcutManager(),i=o.getContext("editor");i.removeShortcutsByGroup(Im),i.removeShortcutsByGroup(qM),i.removeShortcutsByGroup(q_)}},{key:"onAfterDocumentKeyDown",value:function(o){var i=[be.ARROW_UP,be.ARROW_RIGHT,be.ARROW_DOWN,be.ARROW_LEFT];i.indexOf(o.keyCode)===-1&&this.autoResize.resize(String.fromCharCode(o.keyCode))}}],[{key:"EDITOR_TYPE",get:function(){return f_e}}]),r}(Ef),c_e="base";function _v(e,t,r,n,o,i,a){var l=[],s=[];a.className&&re(t,a.className),a.readOnly&&l.push(a.readOnlyCellClassName),a.valid===!1&&a.invalidCellClassName?l.push(a.invalidCellClassName):s.push(a.invalidCellClassName),a.wordWrap===!1&&a.noWordWrapClassName&&l.push(a.noWordWrapClassName),!i&&a.placeholder&&l.push(a.placeholderCellClassName),Le(t,s),re(t,l)}_v.RENDERER_TYPE=c_e;var h_e="text";function Ii(e,t,r,n,o,i,a){_v.apply(this,[e,t,r,n,o,i,a]);var l=i;if(!l&&a.placeholder&&(l=a.placeholder),l=It(l),a.trimWhitespace&&(l=l.trim()),a.rendererTemplate){yn(t);var s=e.rootDocument.createElement("TEMPLATE");s.setAttribute("bind","{{}}"),s.innerHTML=a.rendererTemplate,HTMLTemplateElement.decorate(s),s.model=e.getSourceDataAtRow(r),t.appendChild(s)}else Oi(t,l)}Ii.RENDERER_TYPE=h_e;var d_e="text",A2={CELL_TYPE:d_e,editor:nl,renderer:Ii};on(A2);Ie.editors={BaseEditor:Ef};function Ie(e,t){var r=new hP(e,t||{},xE);return r.init(),r}Ie.Core=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new hP(e,t,xE)};Ie.DefaultSettings=C2();Ie.hooks=pe.getSingleton();Ie.CellCoords=Gg;Ie.CellRange=_E;Ie.packageName="handsontable";Ie.buildDate="23/05/2023 09:21:52";Ie.version="12.4.0";Ie.languages={dictionaryKeys:Mme,getLanguageDictionary:f2,getLanguagesDictionaries:Bme,registerLanguageDictionary:u2,getTranslatedPhrase:c2};function zs(e){"@babel/helpers - typeof";return zs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zs(e)}function v_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,g_e(n.key),n)}}function y_e(e,t,r){return t&&XM(e.prototype,t),r&&XM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function g_e(e){var t=p_e(e,"string");return zs(t)==="symbol"?t:String(t)}function p_e(e,t){if(zs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function an(){return typeof Reflect<"u"&&Reflect.get?an=Reflect.get.bind():an=function(t,r,n){var o=m_e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},an.apply(this,arguments)}function m_e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Nr(e),e!==null););return e}function b_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Z_(e,t)}function Z_(e,t){return Z_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Z_(e,t)}function w_e(e){var t=__e();return function(){var n=Nr(e),o;if(t){var i=Nr(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return S_e(this,o)}}function S_e(e,t){if(t&&(zs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return C_e(e)}function C_e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function __e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Nr(e){return Nr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Nr(e)}var ZM="handsontableEditor",O_e="handsontable",dP=function(e){b_e(r,e);var t=w_e(r);function r(){return v_e(this,r),t.apply(this,arguments)}return y_e(r,[{key:"open",value:function(){an(Nr(r.prototype),"open",this).call(this),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),cv(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}},{key:"close",value:function(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),an(Nr(r.prototype),"close",this).call(this)}},{key:"prepare",value:function(o,i,a,l,s,u){an(Nr(r.prototype),"prepare",this).call(this,o,i,a,l,s,u);var f=this,c={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,afterOnCellMouseDown:function(d,v){var g=this.getSourceData(v.row,v.col);g!==void 0&&f.setValue(g),f.instance.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&Wt(c,u.handsontable),this.htOptions=c}},{key:"beginEditing",value:function(o,i){var a=this.hot.getSettings().onBeginEditing;a&&a()===!1||an(Nr(r.prototype),"beginEditing",this).call(this,o,i)}},{key:"createElements",value:function(){an(Nr(r.prototype),"createElements",this).call(this);var o=this.hot.rootDocument.createElement("DIV");o.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(o),this.htContainer=o,this.assignHooks()}},{key:"finishEditing",value:function(o,i,a){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){var l=this.htEditor.getInstance().getValue();l!==void 0&&this.setValue(l)}an(Nr(r.prototype),"finishEditing",this).call(this,o,i,a)}},{key:"assignHooks",value:function(){var o=this;this.hot.addHook("afterDestroy",function(){o.htEditor&&o.htEditor.destroy()})}},{key:"registerShortcuts",value:function(){var o=this,i=this.hot.getShortcutManager(),a=i.getContext("editor");an(Nr(r.prototype),"registerShortcuts",this).call(this);var l={group:ZM,relativeToGroup:Im,position:"before"},s=function(f,c){var h=o.htEditor.getInstance();if(f!==void 0&&(f<0||h.flipped&&f>h.countRows()-1?h.deselectCell():h.selectCell(f,0),h.getData().length))return c.preventDefault(),gn(c),o.hot.listen(),o.TEXTAREA.focus(),!1};a.addShortcuts([{keys:[["ArrowUp"]],callback:function(f){var c=o.htEditor.getInstance(),h,d;return!c.getSelectedLast()&&c.flipped?h=c.countRows()-1:c.getSelectedLast()&&(c.flipped?(d=c.getSelectedLast()[0],h=Math.max(0,d-1)):(d=c.getSelectedLast()[0],h=d-1)),s(h,f)},preventDefault:!1},{keys:[["ArrowDown"]],callback:function(f){var c=o.htEditor.getInstance(),h,d;if(!c.getSelectedLast()&&!c.flipped)h=0;else if(c.getSelectedLast()){if(c.flipped)h=c.getSelectedLast()[0]+1;else if(!c.flipped){var v=c.countRows()-1;d=c.getSelectedLast()[0],h=Math.min(v,d+1)}}return s(h,f)},preventDefault:!1}],l)}},{key:"unregisterShortcuts",value:function(){an(Nr(r.prototype),"unregisterShortcuts",this).call(this);var o=this.hot.getShortcutManager(),i=o.getContext("editor");i.removeShortcutsByGroup(ZM)}}],[{key:"EDITOR_TYPE",get:function(){return O_e}}]),r}(nl);function Ys(e){"@babel/helpers - typeof";return Ys=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ys(e)}function R_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,I2(n.key),n)}}function E_e(e,t,r){return t&&QM(e.prototype,t),r&&QM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ta(){return typeof Reflect<"u"&&Reflect.get?ta=Reflect.get.bind():ta=function(t,r,n){var o=T_e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ta.apply(this,arguments)}function T_e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=lo(e),e!==null););return e}function P_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Q_(e,t)}function Q_(e,t){return Q_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Q_(e,t)}function k_e(e){var t=A_e();return function(){var n=lo(e),o;if(t){var i=lo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return $_e(this,o)}}function $_e(e,t){if(t&&(Ys(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return J_(e)}function J_(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function A_e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function lo(e){return lo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},lo(e)}function I_e(e,t,r){return t=I2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function I2(e){var t=M_e(e,"string");return Ys(t)==="symbol"?t:String(t)}function M_e(e,t){if(Ys(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ys(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Dw=new WeakMap,x_e="autocomplete",vP=function(e){P_e(r,e);var t=k_e(r);function r(n){var o;return R_e(this,r),o=t.call(this,n),I_e(J_(o),"sortByRelevance",function(i,a,l){var s=[],u=[],f=i.length,c=a.length,h,d,v,g;if(f===0){for(v=0;v<c;v++)u.push(v);return u}for(v=0;v<c;v++){if(d=MC(It(a[v])),l)g=d.indexOf(i);else{var m=this.cellProperties.locale;g=d.toLocaleLowerCase(m).indexOf(i.toLocaleLowerCase(m))}g!==-1&&(h=d.length-g-f,s.push({baseIndex:v,index:g,charsLeft:h,value:d}))}for(s.sort(function(w,S){if(S.index===-1)return-1;if(w.index===-1)return 1;if(w.index<S.index)return-1;if(S.index<w.index)return 1;if(w.index===S.index){if(w.charsLeft<S.charsLeft)return-1;if(w.charsLeft>S.charsLeft)return 1}return 0}),v=0,c=s.length;v<c;v++)u.push(s[v].baseIndex);return u}),o.query=null,o.strippedChoices=[],o.rawChoices=[],Dw.set(J_(o),{skipOne:!1,isMacOS:o.hot.rootWindow.navigator.platform.indexOf("Mac")>-1}),o}return E_e(r,[{key:"getValue",value:function(){var o=this,i=this.rawChoices.find(function(a){var l=o.stripValueIfNeeded(a);return l===o.TEXTAREA.value});return ve(i)?i:this.TEXTAREA.value}},{key:"createElements",value:function(){ta(lo(r.prototype),"createElements",this).call(this),re(this.htContainer,"autocompleteEditor"),re(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll")}},{key:"open",value:function(){var o=this,i=Dw.get(this);ta(lo(r.prototype),"open",this).call(this);var a=this.htEditor.getInstance(),l=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown;this.showEditableElement(),this.focus();var s=Xt();s===0&&i.isMacOS&&(s+=15),this.addHook("beforeKeyDown",function(u){return o.onBeforeKeyDown(u)}),a.updateSettings({colWidths:l?[dt(this.TEXTAREA)-2]:void 0,width:l?dt(this.TEXTAREA)+s:void 0,renderer:function(f,c,h,d,v,g,m){Ii(f,c,h,d,v,g,m);var w=o.cellProperties,S=w.filteringCaseSensitive,C=w.allowHtml,P=w.locale,R=o.query,V=It(g),U,X;V&&!C&&(U=S===!0?V.indexOf(R):V.toLocaleLowerCase(P).indexOf(R.toLocaleLowerCase(P)),U!==-1&&(X=V.substr(U,R.length),V=V.replace(X,"<strong>".concat(X,"</strong>")))),c.innerHTML=V},autoColumnSize:!0}),i.skipOne&&(i.skipOne=!1),this.hot._registerTimeout(function(){o.queryChoices(o.TEXTAREA.value)})}},{key:"close",value:function(){this.removeHooksByKey("beforeKeyDown"),ta(lo(r.prototype),"close",this).call(this)}},{key:"discardEditor",value:function(o){ta(lo(r.prototype),"discardEditor",this).call(this,o),this.hot.view.render()}},{key:"queryChoices",value:function(o){var i=this,a=this.cellProperties.source;this.query=o,typeof a=="function"?a.call(this.cellProperties,o,function(l){i.rawChoices=l,i.updateChoicesList(i.stripValuesIfNeeded(l))}):Array.isArray(a)?(this.rawChoices=a,this.updateChoicesList(this.stripValuesIfNeeded(a))):this.updateChoicesList([])}},{key:"updateChoicesList",value:function(o){var i=hE(this.TEXTAREA),a=vV(this.TEXTAREA),l=this.cellProperties.sortByRelevance,s=this.cellProperties.filter,u=null,f=null,c=o;l&&(u=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),c,this.cellProperties.filteringCaseSensitive));var h=Array.isArray(u)?u.length:0;if(s===!1)h&&(f=u[0]);else{for(var d=[],v=0,g=c.length;v<g&&!(l&&h<=v);v++)h?d.push(c[u[v]]):d.push(c[v]);f=0,c=d}this.strippedChoices=c,this.htEditor.loadData(vc([c])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(f),this.hot.listen(),cv(this.TEXTAREA,i,i===a?void 0:a)}},{key:"flipDropdownIfNeeded",value:function(){var o=xa(this.hot.view._wt.wtTable.TABLE),i=o===this.hot.rootWindow,a=this.cellProperties.preventOverflow;if(i||!i&&(a||a==="horizontal"))return!1;var l=Vt(this.TEXTAREA),s=Rt(this.TEXTAREA),u=this.getDropdownHeight(),f=o.scrollTop,c=Rt(this.hot.view._wt.wtTable.THEAD),h=Vt(o),d=l.top-h.top-c+f,v=o.scrollHeight-d-c-s,g=u>v&&d>v;return g?this.flipDropdown(u):this.unflipDropdown(),this.limitDropdownIfNeeded(g?d:v,u),g}},{key:"limitDropdownIfNeeded",value:function(o,i){if(i>o){var a=0,l=0,s=0,u=null;do s=this.htEditor.getRowHeight(l)||this.htEditor.view._wt.getSetting("defaultRowHeight"),a+=s,l+=1;while(a<o);u=a-s,this.htEditor.flipped&&(this.htEditor.rootElement.style.top="".concat(parseInt(this.htEditor.rootElement.style.top,10)+i-u,"px")),this.setDropdownHeight(a-s)}}},{key:"flipDropdown",value:function(o){var i=this.htEditor.rootElement.style;i.position="absolute",i.top="".concat(-o,"px"),this.htEditor.flipped=!0}},{key:"unflipDropdown",value:function(){var o=this.htEditor.rootElement.style;o.position="absolute",o.top="",this.htEditor.flipped=void 0}},{key:"updateDropdownHeight",value:function(){var o=this.htEditor.getColWidth(0)+Xt(this.hot.rootDocument)+2,i=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:i?void 0:o}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}},{key:"setDropdownHeight",value:function(o){this.htEditor.updateSettings({height:o})}},{key:"highlightBestMatchingChoice",value:function(o){typeof o=="number"?this.htEditor.selectCell(o,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}},{key:"getDropdownHeight",value:function(){var o=this.htEditor.getInstance().getRowHeight(0)||23,i=this.cellProperties.visibleRows;return this.strippedChoices.length>=i?i*o:this.strippedChoices.length*o+8}},{key:"stripValueIfNeeded",value:function(o){return this.stripValuesIfNeeded([o])[0]}},{key:"stripValuesIfNeeded",value:function(o){var i=this.cellProperties.allowHtml,a=Be(o,function(s){return It(s)}),l=Be(a,function(s){return i?s:MC(s)});return l}},{key:"allowKeyEventPropagation",value:function(o){var i=this.htEditor.getSelectedRangeLast(),a={row:i?i.from.row:-1},l=!1;return o===be.ARROW_DOWN&&a.row>0&&a.row<this.htEditor.countRows()-1&&(l=!0),o===be.ARROW_UP&&a.row>-1&&(l=!0),l}},{key:"onBeforeKeyDown",value:function(o){var i=this,a=Dw.get(this);if(a.skipOne=!1,AV(o.keyCode)||o.keyCode===be.BACKSPACE||o.keyCode===be.DELETE||o.keyCode===be.INSERT){var l=10;if(o.keyCode===be.C&&(o.ctrlKey||o.metaKey))return;this.isOpened()||(l+=10),this.htEditor&&this.hot._registerTimeout(function(){i.queryChoices(i.TEXTAREA.value),a.skipOne=!0},l)}}}],[{key:"EDITOR_TYPE",get:function(){return x_e}}]),r}(dP);function Gs(e){"@babel/helpers - typeof";return Gs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gs(e)}function D_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,H_e(n.key),n)}}function N_e(e,t,r){return t&&JM(e.prototype,t),r&&JM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function H_e(e){var t=L_e(e,"string");return Gs(t)==="symbol"?t:String(t)}function L_e(e,t){if(Gs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function j_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&eO(e,t)}function eO(e,t){return eO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},eO(e,t)}function F_e(e){var t=W_e();return function(){var n=Ep(e),o;if(t){var i=Ep(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return B_e(this,o)}}function B_e(e,t){if(t&&(Gs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return V_e(e)}function V_e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function W_e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ep(e){return Ep=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ep(e)}var U_e="checkbox",M2=function(e){j_e(r,e);var t=F_e(r);function r(){return D_e(this,r),t.apply(this,arguments)}return N_e(r,[{key:"beginEditing",value:function(o,i){if(i&&i.type==="mouseup"){var a=this.TD.querySelector('input[type="checkbox"]');xe(a,"htBadValue")||a.click()}}},{key:"finishEditing",value:function(){}},{key:"init",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"focus",value:function(){}}],[{key:"EDITOR_TYPE",get:function(){return U_e}}]),r}(Ef),x2={exports:{}};const z_e=iY(xie);/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */(function(e,t){(function(r,n){var o;{try{o=z_e}catch{}e.exports=n(o)}})(ic,function(r){var n=typeof r=="function",o=!!window.addEventListener,i=window.document,a=window.setTimeout,l=function(k,y,p,b){o?k.addEventListener(y,p,!!b):k.attachEvent("on"+y,p)},s=function(k,y,p,b){o?k.removeEventListener(y,p,!!b):k.detachEvent("on"+y,p)},u=function(k){return k.trim?k.trim():k.replace(/^\s+|\s+$/g,"")},f=function(k,y){return(" "+k.className+" ").indexOf(" "+y+" ")!==-1},c=function(k,y){f(k,y)||(k.className=k.className===""?y:k.className+" "+y)},h=function(k,y){k.className=u((" "+k.className+" ").replace(" "+y+" "," "))},d=function(k){return/Array/.test(Object.prototype.toString.call(k))},v=function(k){return/Date/.test(Object.prototype.toString.call(k))&&!isNaN(k.getTime())},g=function(k){var y=k.getDay();return y===0||y===6},m=function(k){return k%4===0&&k%100!==0||k%400===0},w=function(k,y){return[31,m(k)?29:28,31,30,31,30,31,31,30,31,30,31][y]},S=function(k){v(k)&&k.setHours(0,0,0,0)},C=function(k,y){return k.getTime()===y.getTime()},P=function(k,y,p){var b,_;for(b in y)_=k[b]!==void 0,_&&typeof y[b]=="object"&&y[b]!==null&&y[b].nodeName===void 0?v(y[b])?p&&(k[b]=new Date(y[b].getTime())):d(y[b])?p&&(k[b]=y[b].slice(0)):k[b]=P({},y[b],p):(p||!_)&&(k[b]=y[b]);return k},R=function(k,y,p){var b;i.createEvent?(b=i.createEvent("HTMLEvents"),b.initEvent(y,!0,!1),b=P(b,p),k.dispatchEvent(b)):i.createEventObject&&(b=i.createEventObject(),b=P(b,p),k.fireEvent("on"+y,b))},V=function(k){return k.month<0&&(k.year-=Math.ceil(Math.abs(k.month)/12),k.month+=12),k.month>11&&(k.year+=Math.floor(Math.abs(k.month)/12),k.month-=12),k},U={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},X=function(k,y,p){for(y+=k.firstDay;y>=7;)y-=7;return p?k.i18n.weekdaysShort[y]:k.i18n.weekdays[y]},Y=function(k){var y=[],p="false";if(k.isEmpty)if(k.showDaysInNextAndPreviousMonths)y.push("is-outside-current-month"),k.enableSelectionDaysInNextAndPreviousMonths||y.push("is-selection-disabled");else return'<td class="is-empty"></td>';return k.isDisabled&&y.push("is-disabled"),k.isToday&&y.push("is-today"),k.isSelected&&(y.push("is-selected"),p="true"),k.hasEvent&&y.push("has-event"),k.isInRange&&y.push("is-inrange"),k.isStartRange&&y.push("is-startrange"),k.isEndRange&&y.push("is-endrange"),'<td data-day="'+k.day+'" class="'+y.join(" ")+'" aria-selected="'+p+'"><button class="pika-button pika-day" type="button" data-pika-year="'+k.year+'" data-pika-month="'+k.month+'" data-pika-day="'+k.day+'">'+k.day+"</button></td>"},q=function(k,y){k.setHours(0,0,0,0);var p=k.getDate(),b=k.getDay(),_=y,T=_-1,I=7,F=function(se){return(se+I-1)%I};k.setDate(p+T-F(b));var W=new Date(k.getFullYear(),0,_),G=24*60*60*1e3,J=(k.getTime()-W.getTime())/G,ee=1+Math.round((J-T+F(W.getDay()))/I);return ee},Z=function(k,y,p,b){var _=new Date(p,y,k),T=n?r(_).isoWeek():q(_,b);return'<td class="pika-week">'+T+"</td>"},ie=function(k,y,p,b){return'<tr class="pika-row'+(p?" pick-whole-week":"")+(b?" is-selected":"")+'">'+(y?k.reverse():k).join("")+"</tr>"},Q=function(k){return"<tbody>"+k.join("")+"</tbody>"},le=function(k){var y,p=[];for(k.showWeekNumber&&p.push("<th></th>"),y=0;y<7;y++)p.push('<th scope="col"><abbr title="'+X(k,y)+'">'+X(k,y,!0)+"</abbr></th>");return"<thead><tr>"+(k.isRTL?p.reverse():p).join("")+"</tr></thead>"},Se=function(k,y,p,b,_,T){var I,F,W,G=k._o,J=p===G.minYear,ee=p===G.maxYear,se='<div id="'+T+'" class="pika-title" role="heading" aria-live="assertive">',Re,ce,de=!0,K=!0;for(W=[],I=0;I<12;I++)W.push('<option value="'+(p===_?I-y:12+I-y)+'"'+(I===b?' selected="selected"':"")+(J&&I<G.minMonth||ee&&I>G.maxMonth?' disabled="disabled"':"")+">"+G.i18n.months[I]+"</option>");for(Re='<div class="pika-label">'+G.i18n.months[b]+'<select class="pika-select pika-select-month" tabindex="-1">'+W.join("")+"</select></div>",d(G.yearRange)?(I=G.yearRange[0],F=G.yearRange[1]+1):(I=p-G.yearRange,F=1+p+G.yearRange),W=[];I<F&&I<=G.maxYear;I++)I>=G.minYear&&W.push('<option value="'+I+'"'+(I===p?' selected="selected"':"")+">"+I+"</option>");return ce='<div class="pika-label">'+p+G.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+W.join("")+"</select></div>",G.showMonthAfterYear?se+=ce+Re:se+=Re+ce,J&&(b===0||G.minMonth>=b)&&(de=!1),ee&&(b===11||G.maxMonth<=b)&&(K=!1),y===0&&(se+='<button class="pika-prev'+(de?"":" is-disabled")+'" type="button">'+G.i18n.previousMonth+"</button>"),y===k._o.numberOfMonths-1&&(se+='<button class="pika-next'+(K?"":" is-disabled")+'" type="button">'+G.i18n.nextMonth+"</button>"),se+="</div>"},me=function(k,y,p){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+p+'">'+le(k)+Q(y)+"</table>"},Ce=function(k){var y=this,p=y.config(k);y._onMouseDown=function(_){if(y._v){_=_||window.event;var T=_.target||_.srcElement;if(T)if(f(T,"is-disabled")||(f(T,"pika-button")&&!f(T,"is-empty")&&!f(T.parentNode,"is-disabled")?(y.setDate(new Date(T.getAttribute("data-pika-year"),T.getAttribute("data-pika-month"),T.getAttribute("data-pika-day"))),p.bound&&a(function(){y.hide(),p.blurFieldOnSelect&&p.field&&p.field.blur()},100)):f(T,"pika-prev")?y.prevMonth():f(T,"pika-next")&&y.nextMonth()),f(T,"pika-select"))y._c=!0;else if(_.preventDefault)_.preventDefault();else return _.returnValue=!1,!1}},y._onChange=function(_){_=_||window.event;var T=_.target||_.srcElement;T&&(f(T,"pika-select-month")?y.gotoMonth(T.value):f(T,"pika-select-year")&&y.gotoYear(T.value))},y._onKeyChange=function(_){if(_=_||window.event,y.isVisible())switch(_.keyCode){case 13:case 27:p.field&&p.field.blur();break;case 37:y.adjustDate("subtract",1);break;case 38:y.adjustDate("subtract",7);break;case 39:y.adjustDate("add",1);break;case 40:y.adjustDate("add",7);break;case 8:case 46:y.setDate(null);break}},y._parseFieldValue=function(){if(p.parse)return p.parse(p.field.value,p.format);if(n){var _=r(p.field.value,p.format,p.formatStrict);return _&&_.isValid()?_.toDate():null}else return new Date(Date.parse(p.field.value))},y._onInputChange=function(_){var T;_.firedBy!==y&&(T=y._parseFieldValue(),v(T)&&y.setDate(T),y._v||y.show())},y._onInputFocus=function(){y.show()},y._onInputClick=function(){y.show()},y._onInputBlur=function(){var _=i.activeElement;do if(f(_,"pika-single"))return;while(_=_.parentNode);y._c||(y._b=a(function(){y.hide()},50)),y._c=!1},y._onClick=function(_){_=_||window.event;var T=_.target||_.srcElement,I=T;if(T){!o&&f(T,"pika-select")&&(T.onchange||(T.setAttribute("onchange","return;"),l(T,"change",y._onChange)));do if(f(I,"pika-single")||I===p.trigger)return;while(I=I.parentNode);y._v&&T!==p.trigger&&I!==p.trigger&&y.hide()}},y.el=i.createElement("div"),y.el.className="pika-single"+(p.isRTL?" is-rtl":"")+(p.theme?" "+p.theme:""),l(y.el,"mousedown",y._onMouseDown,!0),l(y.el,"touchend",y._onMouseDown,!0),l(y.el,"change",y._onChange),p.keyboardInput&&l(i,"keydown",y._onKeyChange),p.field&&(p.container?p.container.appendChild(y.el):p.bound?i.body.appendChild(y.el):p.field.parentNode.insertBefore(y.el,p.field.nextSibling),l(p.field,"change",y._onInputChange),p.defaultDate||(p.defaultDate=y._parseFieldValue(),p.setDefaultDate=!0));var b=p.defaultDate;v(b)?p.setDefaultDate?y.setDate(b,!0):y.gotoDate(b):y.gotoDate(new Date),p.bound?(this.hide(),y.el.className+=" is-bound",l(p.trigger,"click",y._onInputClick),l(p.trigger,"focus",y._onInputFocus),l(p.trigger,"blur",y._onInputBlur)):this.show()};return Ce.prototype={config:function(k){this._o||(this._o=P({},U,!0));var y=P(this._o,k,!0);y.isRTL=!!y.isRTL,y.field=y.field&&y.field.nodeName?y.field:null,y.theme=typeof y.theme=="string"&&y.theme?y.theme:null,y.bound=!!(y.bound!==void 0?y.field&&y.bound:y.field),y.trigger=y.trigger&&y.trigger.nodeName?y.trigger:y.field,y.disableWeekends=!!y.disableWeekends,y.disableDayFn=typeof y.disableDayFn=="function"?y.disableDayFn:null;var p=parseInt(y.numberOfMonths,10)||1;if(y.numberOfMonths=p>4?4:p,v(y.minDate)||(y.minDate=!1),v(y.maxDate)||(y.maxDate=!1),y.minDate&&y.maxDate&&y.maxDate<y.minDate&&(y.maxDate=y.minDate=!1),y.minDate&&this.setMinDate(y.minDate),y.maxDate&&this.setMaxDate(y.maxDate),d(y.yearRange)){var b=new Date().getFullYear()-10;y.yearRange[0]=parseInt(y.yearRange[0],10)||b,y.yearRange[1]=parseInt(y.yearRange[1],10)||b}else y.yearRange=Math.abs(parseInt(y.yearRange,10))||U.yearRange,y.yearRange>100&&(y.yearRange=100);return y},toString:function(k){return k=k||this._o.format,v(this._d)?this._o.toString?this._o.toString(this._d,k):n?r(this._d).format(k):this._d.toDateString():""},getMoment:function(){return n?r(this._d):null},setMoment:function(k,y){n&&r.isMoment(k)&&this.setDate(k.toDate(),y)},getDate:function(){return v(this._d)?new Date(this._d.getTime()):null},setDate:function(k,y){if(!k)return this._d=null,this._o.field&&(this._o.field.value="",R(this._o.field,"change",{firedBy:this})),this.draw();if(typeof k=="string"&&(k=new Date(Date.parse(k))),!!v(k)){var p=this._o.minDate,b=this._o.maxDate;v(p)&&k<p?k=p:v(b)&&k>b&&(k=b),this._d=new Date(k.getTime()),S(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),R(this._o.field,"change",{firedBy:this})),!y&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())}},clear:function(){this.setDate(null)},gotoDate:function(k){var y=!0;if(v(k)){if(this.calendars){var p=new Date(this.calendars[0].year,this.calendars[0].month,1),b=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),_=k.getTime();b.setMonth(b.getMonth()+1),b.setDate(b.getDate()-1),y=_<p.getTime()||b.getTime()<_}y&&(this.calendars=[{month:k.getMonth(),year:k.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(k,y){var p=this.getDate()||new Date,b=parseInt(y)*24*60*60*1e3,_;k==="add"?_=new Date(p.valueOf()+b):k==="subtract"&&(_=new Date(p.valueOf()-b)),this.setDate(_)},adjustCalendars:function(){this.calendars[0]=V(this.calendars[0]);for(var k=1;k<this._o.numberOfMonths;k++)this.calendars[k]=V({month:this.calendars[0].month+k,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(k){isNaN(k)||(this.calendars[0].month=parseInt(k,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(k){isNaN(k)||(this.calendars[0].year=parseInt(k,10),this.adjustCalendars())},setMinDate:function(k){k instanceof Date?(S(k),this._o.minDate=k,this._o.minYear=k.getFullYear(),this._o.minMonth=k.getMonth()):(this._o.minDate=U.minDate,this._o.minYear=U.minYear,this._o.minMonth=U.minMonth,this._o.startRange=U.startRange),this.draw()},setMaxDate:function(k){k instanceof Date?(S(k),this._o.maxDate=k,this._o.maxYear=k.getFullYear(),this._o.maxMonth=k.getMonth()):(this._o.maxDate=U.maxDate,this._o.maxYear=U.maxYear,this._o.maxMonth=U.maxMonth,this._o.endRange=U.endRange),this.draw()},setStartRange:function(k){this._o.startRange=k},setEndRange:function(k){this._o.endRange=k},draw:function(k){if(!(!this._v&&!k)){var y=this._o,p=y.minYear,b=y.maxYear,_=y.minMonth,T=y.maxMonth,I="",F;this._y<=p&&(this._y=p,!isNaN(_)&&this._m<_&&(this._m=_)),this._y>=b&&(this._y=b,!isNaN(T)&&this._m>T&&(this._m=T));for(var W=0;W<y.numberOfMonths;W++)F="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),I+='<div class="pika-lendar">'+Se(this,W,this.calendars[W].year,this.calendars[W].month,this.calendars[0].year,F)+this.render(this.calendars[W].year,this.calendars[W].month,F)+"</div>";this.el.innerHTML=I,y.bound&&y.field.type!=="hidden"&&a(function(){y.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),y.bound&&y.field.setAttribute("aria-label",y.ariaLabel)}},adjustPosition:function(){var k,y,p,b,_,T,I,F,W,G,J,ee;if(!this._o.container){if(this.el.style.position="absolute",k=this._o.trigger,y=k,p=this.el.offsetWidth,b=this.el.offsetHeight,_=window.innerWidth||i.documentElement.clientWidth,T=window.innerHeight||i.documentElement.clientHeight,I=window.pageYOffset||i.body.scrollTop||i.documentElement.scrollTop,J=!0,ee=!0,typeof k.getBoundingClientRect=="function")G=k.getBoundingClientRect(),F=G.left+window.pageXOffset,W=G.bottom+window.pageYOffset;else for(F=y.offsetLeft,W=y.offsetTop+y.offsetHeight;y=y.offsetParent;)F+=y.offsetLeft,W+=y.offsetTop;(this._o.reposition&&F+p>_||this._o.position.indexOf("right")>-1&&F-p+k.offsetWidth>0)&&(F=F-p+k.offsetWidth,J=!1),(this._o.reposition&&W+b>T+I||this._o.position.indexOf("top")>-1&&W-b-k.offsetHeight>0)&&(W=W-b-k.offsetHeight,ee=!1),this.el.style.left=F+"px",this.el.style.top=W+"px",c(this.el,J?"left-aligned":"right-aligned"),c(this.el,ee?"bottom-aligned":"top-aligned"),h(this.el,J?"right-aligned":"left-aligned"),h(this.el,ee?"top-aligned":"bottom-aligned")}},render:function(k,y,p){var b=this._o,_=new Date,T=w(k,y),I=new Date(k,y,1).getDay(),F=[],W=[];S(_),b.firstDay>0&&(I-=b.firstDay,I<0&&(I+=7));for(var G=y===0?11:y-1,J=y===11?0:y+1,ee=y===0?k-1:k,se=y===11?k+1:k,Re=w(ee,G),ce=T+I,de=ce;de>7;)de-=7;ce+=7-de;for(var K=!1,Me=0,Ge=0;Me<ce;Me++){var Pe=new Date(k,y,1+(Me-I)),Ae=v(this._d)?C(Pe,this._d):!1,ke=C(Pe,_),O=b.events.indexOf(Pe.toDateString())!==-1,E=Me<I||Me>=T+I,A=1+(Me-I),H=y,M=k,j=b.startRange&&C(b.startRange,Pe),x=b.endRange&&C(b.endRange,Pe),D=b.startRange&&b.endRange&&b.startRange<Pe&&Pe<b.endRange,B=b.minDate&&Pe<b.minDate||b.maxDate&&Pe>b.maxDate||b.disableWeekends&&g(Pe)||b.disableDayFn&&b.disableDayFn(Pe);E&&(Me<I?(A=Re+A,H=G,M=ee):(A=A-T,H=J,M=se));var L={day:A,month:H,year:M,hasEvent:O,isSelected:Ae,isToday:ke,isDisabled:B,isEmpty:E,isStartRange:j,isEndRange:x,isInRange:D,showDaysInNextAndPreviousMonths:b.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:b.enableSelectionDaysInNextAndPreviousMonths};b.pickWholeWeek&&Ae&&(K=!0),W.push(Y(L)),++Ge===7&&(b.showWeekNumber&&W.unshift(Z(Me-I,y,k,b.firstWeekOfYearMinDays)),F.push(ie(W,b.isRTL,b.pickWholeWeek,K)),W=[],Ge=0,K=!1)}return me(b,F,p)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),h(this.el,"is-hidden"),this._o.bound&&(l(i,"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){var k=this._v;k!==!1&&(this._o.bound&&s(i,"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),c(this.el,"is-hidden"),this._v=!1,k!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){var k=this._o;this.hide(),s(this.el,"mousedown",this._onMouseDown,!0),s(this.el,"touchend",this._onMouseDown,!0),s(this.el,"change",this._onChange),k.keyboardInput&&s(i,"keydown",this._onKeyChange),k.field&&(s(k.field,"change",this._onInputChange),k.bound&&(s(k.trigger,"click",this._onInputClick),s(k.trigger,"focus",this._onInputFocus),s(k.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},Ce})})(x2);var Y_e=x2.exports;const ex=DL(Y_e);function Ks(e){"@babel/helpers - typeof";return Ks=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ks(e)}function G_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,q_e(n.key),n)}}function K_e(e,t,r){return t&&tx(e.prototype,t),r&&tx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function q_e(e){var t=X_e(e,"string");return Ks(t)==="symbol"?t:String(t)}function X_e(e,t){if(Ks(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ks(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function no(){return typeof Reflect<"u"&&Reflect.get?no=Reflect.get.bind():no=function(t,r,n){var o=Z_e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},no.apply(this,arguments)}function Z_e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=un(e),e!==null););return e}function Q_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tO(e,t)}function tO(e,t){return tO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},tO(e,t)}function J_e(e){var t=rOe();return function(){var n=un(e),o;if(t){var i=un(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return eOe(this,o)}}function eOe(e,t){if(t&&(Ks(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tOe(e)}function tOe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rOe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function un(e){return un=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},un(e)}var D2="date",rx="dateEditor",N2=function(e){Q_e(r,e);var t=J_e(r);function r(n){var o;return G_e(this,r),o=t.call(this,n),o.defaultDateFormat="DD/MM/YYYY",o.isCellEdited=!1,o.parentDestroyed=!1,o.$datePicker=null,o}return K_e(r,[{key:"init",value:function(){var o=this;if(typeof te!="function")throw new Error("You need to include moment.js to your project.");if(typeof ex!="function")throw new Error("You need to include Pikaday to your project.");no(un(r.prototype),"init",this).call(this),this.instance.addHook("afterDestroy",function(){o.parentDestroyed=!0,o.destroyElements()})}},{key:"createElements",value:function(){no(un(r.prototype),"createElements",this).call(this),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),re(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker);var o=new Tt(this);o.addEventListener(this.datePicker,"mousedown",function(i){return i.stopPropagation()})}},{key:"destroyElements",value:function(){var o=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),o&&o.removeChild(this.datePicker)}},{key:"prepare",value:function(o,i,a,l,s,u){no(un(r.prototype),"prepare",this).call(this,o,i,a,l,s,u)}},{key:"open",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,i=this.hot.getShortcutManager(),a=i.getContext("editor");no(un(r.prototype),"open",this).call(this),this.showDatepicker(o),a.addShortcut({keys:[["Enter"]],callback:function(s){s.stopPropagation()},group:rx})}},{key:"close",value:function(){var o,i=this;this._opened=!1,(o=this.$datePicker)!==null&&o!==void 0&&o.destroy&&this.$datePicker.destroy(),this.instance._registerTimeout(function(){i.instance._refreshBorders()});var a=this.hot.getShortcutManager(),l=a.getContext("editor");l.removeShortcutsByGroup(rx),no(un(r.prototype),"close",this).call(this)}},{key:"finishEditing",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(o){var a=this.originalValue;a!==void 0&&this.setValue(a)}no(un(r.prototype),"finishEditing",this).call(this,o,i)}},{key:"showDatepicker",value:function(o){var i=this.TD.getBoundingClientRect(),a=this.cellProperties.dateFormat||this.defaultDateFormat,l=this.instance.view.isMouseDown(),s=o?pE(o.keyCode):!1,u;this.datePicker.style.display="block",this.$datePicker=new ex(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top="".concat(this.hot.rootWindow.pageYOffset+i.top+Rt(this.TD),"px");var f=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?f=i.right-dt(this.datePicker):f=i.left,this.datePickerStyle.left="".concat(f,"px"),this.originalValue?(u=this.originalValue,te(u,a,!0).isValid()&&this.$datePicker.setMoment(te(u,a),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!s&&!l&&this.setValue("")):this.cellProperties.defaultDate?(u=this.cellProperties.defaultDate,te(u,a,!0).isValid()&&this.$datePicker.setMoment(te(u,a),!0),!s&&!l&&this.setValue("")):this.$datePicker.gotoToday()}},{key:"hideDatepicker",value:function(){this.datePickerStyle.display="none",this.$datePicker.hide()}},{key:"getDatePickerConfig",value:function(){var o=this,i=this.TEXTAREA,a={};this.cellProperties&&this.cellProperties.datePickerConfig&&av(a,this.cellProperties.datePickerConfig);var l=a.onSelect,s=a.onClose;return a.field=i,a.trigger=i,a.container=this.datePicker,a.bound=!1,a.format=a.format||this.defaultDateFormat,a.reposition=a.reposition||!1,a.isRTL=!1,a.onSelect=function(u){var f=u;isNaN(f.getTime())||(f=te(f).format(o.cellProperties.dateFormat||o.defaultDateFormat)),o.setValue(f),o.hideDatepicker(),l&&l()},a.onClose=function(){o.parentDestroyed||o.finishEditing(!1),s&&s()},a}}],[{key:"EDITOR_TYPE",get:function(){return D2}}]),r}(nl);function qs(e){"@babel/helpers - typeof";return qs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qs(e)}function nOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,iOe(n.key),n)}}function oOe(e,t,r){return t&&nx(e.prototype,t),r&&nx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function iOe(e){var t=aOe(e,"string");return qs(t)==="symbol"?t:String(t)}function aOe(e,t){if(qs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fg(){return typeof Reflect<"u"&&Reflect.get?fg=Reflect.get.bind():fg=function(t,r,n){var o=lOe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},fg.apply(this,arguments)}function lOe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Xs(e),e!==null););return e}function sOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rO(e,t)}function rO(e,t){return rO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},rO(e,t)}function uOe(e){var t=hOe();return function(){var n=Xs(e),o;if(t){var i=Xs(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return fOe(this,o)}}function fOe(e,t){if(t&&(qs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cOe(e)}function cOe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hOe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Xs(e){return Xs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Xs(e)}var dOe="dropdown",yP=function(e){sOe(r,e);var t=uOe(r);function r(){return nOe(this,r),t.apply(this,arguments)}return oOe(r,[{key:"prepare",value:function(o,i,a,l,s,u){fg(Xs(r.prototype),"prepare",this).call(this,o,i,a,l,s,u),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}],[{key:"EDITOR_TYPE",get:function(){return dOe}}]),r}(vP);pe.getSingleton().add("beforeValidate",function(e,t,r){var n=this.getCellMeta(t,this.propToCol(r));n.editor===yP&&n.strict===void 0&&(n.filter=!1,n.strict=!0)});function Zs(e){"@babel/helpers - typeof";return Zs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zs(e)}function vOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ox(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gOe(n.key),n)}}function yOe(e,t,r){return t&&ox(e.prototype,t),r&&ox(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gOe(e){var t=pOe(e,"string");return Zs(t)==="symbol"?t:String(t)}function pOe(e,t){if(Zs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function mOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nO(e,t)}function nO(e,t){return nO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},nO(e,t)}function bOe(e){var t=COe();return function(){var n=Tp(e),o;if(t){var i=Tp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return wOe(this,o)}}function wOe(e,t){if(t&&(Zs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return SOe(e)}function SOe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function COe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Tp(e){return Tp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Tp(e)}var _Oe="numeric",H2=function(e){mOe(r,e);var t=bOe(r);function r(){return vOe(this,r),t.apply(this,arguments)}return yOe(r,null,[{key:"EDITOR_TYPE",get:function(){return _Oe}}]),r}(nl);function Qs(e){"@babel/helpers - typeof";return Qs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qs(e)}function OOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ix(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,EOe(n.key),n)}}function ROe(e,t,r){return t&&ix(e.prototype,t),r&&ix(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function EOe(e){var t=TOe(e,"string");return Qs(t)==="symbol"?t:String(t)}function TOe(e,t){if(Qs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cg(){return typeof Reflect<"u"&&Reflect.get?cg=Reflect.get.bind():cg=function(t,r,n){var o=POe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},cg.apply(this,arguments)}function POe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Js(e),e!==null););return e}function kOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oO(e,t)}function oO(e,t){return oO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},oO(e,t)}function $Oe(e){var t=MOe();return function(){var n=Js(e),o;if(t){var i=Js(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return AOe(this,o)}}function AOe(e,t){if(t&&(Qs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return IOe(e)}function IOe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MOe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Js(e){return Js=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Js(e)}var xOe="password",L2=function(e){kOe(r,e);var t=$Oe(r);function r(){return OOe(this,r),t.apply(this,arguments)}return ROe(r,[{key:"createElements",value:function(){cg(Js(r.prototype),"createElements",this).call(this),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,yn(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}],[{key:"EDITOR_TYPE",get:function(){return xOe}}]),r}(nl);function Ba(e){"@babel/helpers - typeof";return Ba=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ba(e)}function DOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ax(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,HOe(n.key),n)}}function NOe(e,t,r){return t&&ax(e.prototype,t),r&&ax(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function HOe(e){var t=LOe(e,"string");return Ba(t)==="symbol"?t:String(t)}function LOe(e,t){if(Ba(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ba(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hg(){return typeof Reflect<"u"&&Reflect.get?hg=Reflect.get.bind():hg=function(t,r,n){var o=jOe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},hg.apply(this,arguments)}function jOe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=eu(e),e!==null););return e}function FOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&iO(e,t)}function iO(e,t){return iO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},iO(e,t)}function BOe(e){var t=UOe();return function(){var n=eu(e),o;if(t){var i=eu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return VOe(this,o)}}function VOe(e,t){if(t&&(Ba(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return WOe(e)}function WOe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function UOe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function eu(e){return eu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},eu(e)}var Nw="ht_editor_visible",lx="selectEditor",zOe="select",YOe=function(e){FOe(r,e);var t=BOe(r);function r(){return DOe(this,r),t.apply(this,arguments)}return NOe(r,[{key:"init",value:function(){this.select=this.hot.rootDocument.createElement("SELECT"),re(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}},{key:"getValue",value:function(){return this.select.value}},{key:"setValue",value:function(o){this.select.value=o}},{key:"open",value:function(){this._opened=!0,this.refreshDimensions(),this.select.style.display="";var o=this.hot.getShortcutManager();o.setActiveContextName("editor"),this.registerShortcuts()}},{key:"close",value:function(){this._opened=!1,this.select.style.display="none",xe(this.select,Nw)&&Le(this.select,Nw),this.unregisterShortcuts(),this.clearHooks()}},{key:"focus",value:function(){this.select.focus()}},{key:"registerHooks",value:function(){var o=this;this.addHook("afterScrollHorizontally",function(){return o.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return o.refreshDimensions()}),this.addHook("afterColumnResize",function(){return o.refreshDimensions()}),this.addHook("afterRowResize",function(){return o.refreshDimensions()})}},{key:"prepare",value:function(o,i,a,l,s,u){var f=this;hg(eu(r.prototype),"prepare",this).call(this,o,i,a,l,s,u);var c=this.cellProperties.selectOptions,h;typeof c=="function"?h=this.prepareOptions(c(this.row,this.col,this.prop)):h=this.prepareOptions(c),yn(this.select),We(h,function(d,v){var g=f.hot.rootDocument.createElement("OPTION");g.value=v,tl(g,d),f.select.appendChild(g)})}},{key:"prepareOptions",value:function(o){var i={};if(Array.isArray(o))for(var a=0,l=o.length;a<l;a++)i[o[a]]=o[a];else Ba(o)==="object"&&(i=o);return i}},{key:"refreshValue",value:function(){var o=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=o,this.setValue(o),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){if(this.state===Qt.EDITING){if(this.TD=this.getEditedCell(),!this.TD){this.close();return}var o=this.getEditedCellRect(),i=o.top,a=o.start,l=o.width,s=o.height,u=this.select.style;u.height="".concat(s,"px"),u.width="".concat(l,"px"),u.top="".concat(i,"px"),u[this.hot.isRtl()?"right":"left"]="".concat(a,"px"),u.margin="0px",re(this.select,Nw)}}},{key:"registerShortcuts",value:function(){var o=this,i=this.hot.getShortcutManager(),a=i.getContext("editor"),l={group:lx};this.isInFullEditMode()!==!1&&a.addShortcuts([{keys:[["ArrowUp"]],callback:function(){var u=o.select.selectedIndex-1;u>=0&&(o.select[u].selected=!0)}},{keys:[["ArrowDown"]],callback:function(){var u=o.select.selectedIndex+1;u<=o.select.length-1&&(o.select[u].selected=!0)}}],l)}},{key:"unregisterShortcuts",value:function(){var o=this.hot.getShortcutManager(),i=o.getContext("editor");i.removeShortcutsByGroup(lx)}}],[{key:"EDITOR_TYPE",get:function(){return zOe}}]),r}(Ef);function tu(e){"@babel/helpers - typeof";return tu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tu(e)}function GOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qOe(n.key),n)}}function KOe(e,t,r){return t&&sx(e.prototype,t),r&&sx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qOe(e){var t=XOe(e,"string");return tu(t)==="symbol"?t:String(t)}function XOe(e,t){if(tu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(tu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dg(){return typeof Reflect<"u"&&Reflect.get?dg=Reflect.get.bind():dg=function(t,r,n){var o=ZOe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},dg.apply(this,arguments)}function ZOe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ru(e),e!==null););return e}function QOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aO(e,t)}function aO(e,t){return aO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},aO(e,t)}function JOe(e){var t=rRe();return function(){var n=ru(e),o;if(t){var i=ru(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return eRe(this,o)}}function eRe(e,t){if(t&&(tu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tRe(e)}function tRe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rRe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ru(e){return ru=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ru(e)}var nRe="time",j2=function(e){QOe(r,e);var t=JOe(r);function r(){return GOe(this,r),t.apply(this,arguments)}return KOe(r,[{key:"prepare",value:function(o,i,a,l,s,u){dg(ru(r.prototype),"prepare",this).call(this,o,i,a,l,s,u),this.TEXTAREA.dir="ltr"}}],[{key:"EDITOR_TYPE",get:function(){return nRe}}]),r}(nl);function oRe(){Or(Ef),Or(vP),Or(M2),Or(N2),Or(yP),Or(dP),Or(H2),Or(L2),Or(YOe),Or(nl),Or(j2)}var iRe="html";function gP(e,t,r,n,o,i,a){_v.apply(this,[e,t,r,n,o,i,a]),tl(t,i??"",!1)}gP.RENDERER_TYPE=iRe;var aRe="autocomplete";function Tf(e,t,r,n,o,i,a){var l=e.rootDocument,s=a.allowHtml?gP:Ii,u=l.createElement("DIV");if(u.className="htAutocompleteArrow",u.appendChild(l.createTextNode(String.fromCharCode(9660))),s.apply(this,[e,t,r,n,o,i,a]),t.firstChild||t.appendChild(l.createTextNode(String.fromCharCode(160))),t.insertBefore(u,t.firstChild),re(t,"htAutocomplete"),!e.acArrowListener){var f=new Tt(e);e.acArrowListener=function(c){xe(c.target,"htAutocompleteArrow")&&e.view._wt.getSetting("onCellDblClick",null,e._createCellCoords(r,n),t)},f.addEventListener(e.rootElement,"mousedown",e.acArrowListener),e.addHookOnce("afterDestroy",function(){f.destroy()})}}Tf.RENDERER_TYPE=aRe;var ux=new WeakMap,fx=new WeakMap,lRe="htBadValue",nu="data-row",ou="data-col",sRe="checkboxRenderer",F2="checkbox";pe.getSingleton().add("modifyAutoColumnSizeSeed",function(e,t,r){var n=t.label,o=t.type,i=t.row,a=t.column,l=t.prop;if(o===F2){if(n){var s=n.value,u=n.property,f=r;if(s)f=typeof s=="function"?s(i,a,l,r):s;else if(u){var c=this.getDataAtRowProp(i,u);f=c!==null?c:r}e=f}return e}});function pP(e,t,r,n,o,i,a){var l=e.rootDocument;_v.apply(this,[e,t,r,n,o,i,a]),uRe(e);var s=fRe(l),u=a.label,f=!1;if(typeof a.checkedTemplate>"u"&&(a.checkedTemplate=!0),typeof a.uncheckedTemplate>"u"&&(a.uncheckedTemplate=!1),yn(t),i===a.checkedTemplate||It(i).toLocaleLowerCase(a.locale)===It(a.checkedTemplate).toLocaleLowerCase(a.locale)?s.checked=!0:i===a.uncheckedTemplate||It(i).toLocaleLowerCase(a.locale)===It(a.uncheckedTemplate).toLocaleLowerCase(a.locale)?s.checked=!1:Kt(i)?re(s,"noValue"):(s.style.display="none",re(s,lRe),f=!0),s.setAttribute(nu,r),s.setAttribute(ou,n),!f&&u){var c="";if(u.value)c=typeof u.value=="function"?u.value.call(this,r,n,o,i):u.value;else if(u.property){var h=e.getDataAtRowProp(r,u.property);c=h!==null?h:""}var d=cRe(l,c,u.separated!==!0);u.position==="before"?u.separated?(t.appendChild(d),t.appendChild(s)):(d.appendChild(s),s=d):(!u.position||u.position==="after")&&(u.separated?(t.appendChild(s),t.appendChild(d)):(d.insertBefore(s,d.firstChild),s=d))}(!u||u&&!u.separated)&&t.appendChild(s),f&&t.appendChild(l.createTextNode("#bad-value#")),ux.has(e)||(ux.set(e,!0),v());function v(){var w=e.getShortcutManager(),S=w.getContext("grid"),C={group:sRe};S.addShortcuts([{keys:[["space"]],callback:function(){return g(),!m()}},{keys:[["enter"]],callback:function(){return g(),!m()},runOnlyIf:function(){return e.getSettings().enterBeginsEditing}},{keys:[["delete"],["backspace"]],callback:function(){return g(!0),!m()},relativeToGroup:wc,position:"before"}],C)}function g(){var w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,S=e.getSelectedRange();if(S)for(var C=0;C<S.length;C++){for(var P=S[C].getTopStartCorner(),R=P.row,V=P.col,U=S[C].getBottomEndCorner(),X=U.row,Y=U.col,q=[],Z=R;Z<=X;Z+=1)for(var ie=V;ie<=Y;ie+=1){var Q=e.getCellMeta(Z,ie);if(Q.type!=="checkbox")return;if(Q.readOnly!==!0){typeof Q.checkedTemplate>"u"&&(Q.checkedTemplate=!0),typeof Q.uncheckedTemplate>"u"&&(Q.uncheckedTemplate=!1);var le=e.getDataAtCell(Z,ie);w===!1?[Q.checkedTemplate,Q.checkedTemplate.toString()].includes(le)?q.push([Z,ie,Q.uncheckedTemplate]):[Q.uncheckedTemplate,Q.uncheckedTemplate.toString(),null,void 0].includes(le)&&q.push([Z,ie,Q.checkedTemplate]):q.push([Z,ie,Q.uncheckedTemplate])}}q.length>0&&e.setDataAtCell(q)}}function m(){var w=e.getSelectedRange();if(w){for(var S=0;S<w.length;S++)for(var C=w[S].getTopStartCorner(),P=w[S].getBottomEndCorner(),R=C.row;R<=P.row;R++)for(var V=C.col;V<=P.col;V++){var U=e.getCellMeta(R,V);if(U.type!=="checkbox")return!1;var X=e.getCell(R,V);if(X==null)return!0;var Y=X.querySelectorAll("input[type=checkbox]");if(Y.length>0&&!U.readOnly)return!0}return!1}}}pP.RENDERER_TYPE=F2;function uRe(e){var t=fx.get(e);if(!t){var r=e.rootElement;t=new Tt(e),t.addEventListener(r,"click",function(n){return dRe(n,e)}),t.addEventListener(r,"mouseup",function(n){return hRe(n,e)}),t.addEventListener(r,"change",function(n){return vRe(n,e)}),fx.set(e,t)}return t}function fRe(e){var t=e.createElement("input");return t.className="htCheckboxRendererInput",t.type="checkbox",t.setAttribute("autocomplete","off"),t.setAttribute("tabindex","-1"),t.cloneNode(!1)}function cRe(e,t,r){var n=e.createElement("label");return n.className="htCheckboxRendererLabel ".concat(r?"fullWidth":""),n.appendChild(e.createTextNode(t)),n.cloneNode(!0)}function hRe(e,t){var r=e.target;mP(r)&&(!r.hasAttribute(nu)||!r.hasAttribute(ou)||setTimeout(t.listen,10))}function dRe(e,t){var r=e.target;if(mP(r)&&!(!r.hasAttribute(nu)||!r.hasAttribute(ou))){var n=parseInt(r.getAttribute(nu),10),o=parseInt(r.getAttribute(ou),10),i=t.getCellMeta(n,o);i.readOnly&&e.preventDefault()}}function vRe(e,t){var r=e.target;if(mP(r)&&!(!r.hasAttribute(nu)||!r.hasAttribute(ou))){var n=parseInt(r.getAttribute(nu),10),o=parseInt(r.getAttribute(ou),10),i=t.getCellMeta(n,o);if(!i.readOnly){var a=null;e.target.checked?a=i.uncheckedTemplate===void 0?!0:i.checkedTemplate:a=i.uncheckedTemplate===void 0?!1:i.uncheckedTemplate,t.setDataAtCell(n,o,a)}}}function mP(e){return e.tagName==="INPUT"&&e.getAttribute("type")==="checkbox"}var B2={exports:{}};(function(e,t){(function(r){e.exports=r()})(function(){return function r(n,o,i){function a(u,f){if(!o[u]){if(!n[u]){var c=typeof Av=="function"&&Av;if(!f&&c)return c(u,!0);if(l)return l(u,!0);var h=new Error("Cannot find module '"+u+"'");throw h.code="MODULE_NOT_FOUND",h}var d=o[u]={exports:{}};n[u][0].call(d.exports,function(v){return a(n[u][1][v]||v)},d,d.exports,r,n,o,i)}return o[u].exports}for(var l=typeof Av=="function"&&Av,s=0;s<i.length;s++)a(i[s]);return a}({1:[function(r,n,o){(function(i){var a,l=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,s=Math.ceil,u=Math.floor,f="[BigNumber Error] ",c=f+"Number primitive has more than 15 significant digits: ",h=1e14,d=14,v=9007199254740991,g=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],m=1e7,w=1e9;function S(Y){var q=0|Y;return 0<Y||Y===q?q:q-1}function C(Y){for(var q,Z,ie=1,Q=Y.length,le=Y[0]+"";ie<Q;){for(q=Y[ie++]+"",Z=d-q.length;Z--;q="0"+q);le+=q}for(Q=le.length;le.charCodeAt(--Q)===48;);return le.slice(0,Q+1||1)}function P(Y,q){var Z,ie,Q=Y.c,le=q.c,Se=Y.s,me=q.s,Ce=Y.e,k=q.e;if(!Se||!me)return null;if(Z=Q&&!Q[0],ie=le&&!le[0],Z||ie)return Z?ie?0:-me:Se;if(Se!=me)return Se;if(Z=Se<0,ie=Ce==k,!Q||!le)return ie?0:!Q^Z?1:-1;if(!ie)return k<Ce^Z?1:-1;for(me=(Ce=Q.length)<(k=le.length)?Ce:k,Se=0;Se<me;Se++)if(Q[Se]!=le[Se])return Q[Se]>le[Se]^Z?1:-1;return Ce==k?0:k<Ce^Z?1:-1}function R(Y,q,Z,ie){if(Y<q||Z<Y||Y!==(Y<0?s(Y):u(Y)))throw Error(f+(ie||"Argument")+(typeof Y=="number"?Y<q||Z<Y?" out of range: ":" not an integer: ":" not a primitive number: ")+String(Y))}function V(Y){var q=Y.c.length-1;return S(Y.e/d)==q&&Y.c[q]%2!=0}function U(Y,q){return(1<Y.length?Y.charAt(0)+"."+Y.slice(1):Y)+(q<0?"e":"e+")+q}function X(Y,q,Z){var ie,Q;if(q<0){for(Q=Z+".";++q;Q+=Z);Y=Q+Y}else if(++q>(ie=Y.length)){for(Q=Z,q-=ie;--q;Q+=Z);Y+=Q}else q<ie&&(Y=Y.slice(0,q)+"."+Y.slice(q));return Y}(a=function Y(q){var Z,ie,Q,le,Se,me,Ce,k,y,p,b=K.prototype={constructor:K,toString:null,valueOf:null},_=new K(1),T=20,I=4,F=-7,W=21,G=-1e7,J=1e7,ee=!1,se=1,Re=0,ce={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},de="0123456789abcdefghijklmnopqrstuvwxyz";function K(O,E){var A,H,M,j,x,D,B,L,z=this;if(!(z instanceof K))return new K(O,E);if(E==null){if(O instanceof K)return z.s=O.s,z.e=O.e,void(z.c=(O=O.c)?O.slice():O);if((D=typeof O=="number")&&0*O==0){if(z.s=1/O<0?(O=-O,-1):1,O===~~O){for(j=0,x=O;10<=x;x/=10,j++);return z.e=j,void(z.c=[O])}L=String(O)}else{if(L=String(O),!l.test(L))return Q(z,L,D);z.s=L.charCodeAt(0)==45?(L=L.slice(1),-1):1}-1<(j=L.indexOf("."))&&(L=L.replace(".","")),0<(x=L.search(/e/i))?(j<0&&(j=x),j+=+L.slice(x+1),L=L.substring(0,x)):j<0&&(j=L.length)}else{if(R(E,2,de.length,"Base"),L=String(O),E==10)return Ae(z=new K(O instanceof K?O:L),T+z.e+1,I);if(D=typeof O=="number"){if(0*O!=0)return Q(z,L,D,E);if(z.s=1/O<0?(L=L.slice(1),-1):1,K.DEBUG&&15<L.replace(/^0\.0*|\./,"").length)throw Error(c+O);D=!1}else z.s=L.charCodeAt(0)===45?(L=L.slice(1),-1):1;for(A=de.slice(0,E),j=x=0,B=L.length;x<B;x++)if(A.indexOf(H=L.charAt(x))<0){if(H=="."){if(j<x){j=B;continue}}else if(!M&&(L==L.toUpperCase()&&(L=L.toLowerCase())||L==L.toLowerCase()&&(L=L.toUpperCase()))){M=!0,x=-1,j=0;continue}return Q(z,String(O),D,E)}-1<(j=(L=ie(L,E,10,z.s)).indexOf("."))?L=L.replace(".",""):j=L.length}for(x=0;L.charCodeAt(x)===48;x++);for(B=L.length;L.charCodeAt(--B)===48;);if(L=L.slice(x,++B)){if(B-=x,D&&K.DEBUG&&15<B&&(v<O||O!==u(O)))throw Error(c+z.s*O);if(J<(j=j-x-1))z.c=z.e=null;else if(j<G)z.c=[z.e=0];else{if(z.e=j,z.c=[],x=(j+1)%d,j<0&&(x+=d),x<B){for(x&&z.c.push(+L.slice(0,x)),B-=d;x<B;)z.c.push(+L.slice(x,x+=d));L=L.slice(x),x=d-L.length}else x-=B;for(;x--;L+="0");z.c.push(+L)}}else z.c=[z.e=0]}function Me(O,E,A,H){var M,j,x,D,B;if(A==null?A=I:R(A,0,8),!O.c)return O.toString();if(M=O.c[0],x=O.e,E==null)B=C(O.c),B=H==1||H==2&&(x<=F||W<=x)?U(B,x):X(B,x,"0");else if(j=(O=Ae(new K(O),E,A)).e,D=(B=C(O.c)).length,H==1||H==2&&(E<=j||j<=F)){for(;D<E;B+="0",D++);B=U(B,j)}else if(E-=x,B=X(B,j,"0"),D<j+1){if(0<--E)for(B+=".";E--;B+="0");}else if(0<(E+=j-D))for(j+1==D&&(B+=".");E--;B+="0");return O.s<0&&M?"-"+B:B}function Ge(O,E){for(var A,H=1,M=new K(O[0]);H<O.length;H++){if(!(A=new K(O[H])).s){M=A;break}E.call(M,A)&&(M=A)}return M}function Pe(O,E,A){for(var H=1,M=E.length;!E[--M];E.pop());for(M=E[0];10<=M;M/=10,H++);return(A=H+A*d-1)>J?O.c=O.e=null:O.c=A<G?[O.e=0]:(O.e=A,E),O}function Ae(O,E,A,H){var M,j,x,D,B,L,z,ae=O.c,ge=g;if(ae){e:{for(M=1,D=ae[0];10<=D;D/=10,M++);if((j=E-M)<0)j+=d,x=E,z=(B=ae[L=0])/ge[M-x-1]%10|0;else if((L=s((j+1)/d))>=ae.length){if(!H)break e;for(;ae.length<=L;ae.push(0));B=z=0,x=(j%=d)-d+(M=1)}else{for(B=D=ae[L],M=1;10<=D;D/=10,M++);z=(x=(j%=d)-d+M)<0?0:B/ge[M-x-1]%10|0}if(H=H||E<0||ae[L+1]!=null||(x<0?B:B%ge[M-x-1]),H=A<4?(z||H)&&(A==0||A==(O.s<0?3:2)):5<z||z==5&&(A==4||H||A==6&&(0<j?0<x?B/ge[M-x]:0:ae[L-1])%10&1||A==(O.s<0?8:7)),E<1||!ae[0])return ae.length=0,H?(E-=O.e+1,ae[0]=ge[(d-E%d)%d],O.e=-E||0):ae[0]=O.e=0,O;if(j==0?(ae.length=L,D=1,L--):(ae.length=L+1,D=ge[d-j],ae[L]=0<x?u(B/ge[M-x]%ge[x])*D:0),H)for(;;){if(L==0){for(j=1,x=ae[0];10<=x;x/=10,j++);for(x=ae[0]+=D,D=1;10<=x;x/=10,D++);j!=D&&(O.e++,ae[0]==h&&(ae[0]=1));break}if(ae[L]+=D,ae[L]!=h)break;ae[L--]=0,D=1}for(j=ae.length;ae[--j]===0;ae.pop());}O.e>J?O.c=O.e=null:O.e<G&&(O.c=[O.e=0])}return O}function ke(O){var E,A=O.e;return A===null?O.toString():(E=C(O.c),E=A<=F||W<=A?U(E,A):X(E,A,"0"),O.s<0?"-"+E:E)}return K.clone=Y,K.ROUND_UP=0,K.ROUND_DOWN=1,K.ROUND_CEIL=2,K.ROUND_FLOOR=3,K.ROUND_HALF_UP=4,K.ROUND_HALF_DOWN=5,K.ROUND_HALF_EVEN=6,K.ROUND_HALF_CEIL=7,K.ROUND_HALF_FLOOR=8,K.EUCLID=9,K.config=K.set=function(O){var E,A;if(O!=null){if(typeof O!="object")throw Error(f+"Object expected: "+O);if(O.hasOwnProperty(E="DECIMAL_PLACES")&&(R(A=O[E],0,w,E),T=A),O.hasOwnProperty(E="ROUNDING_MODE")&&(R(A=O[E],0,8,E),I=A),O.hasOwnProperty(E="EXPONENTIAL_AT")&&((A=O[E])&&A.pop?(R(A[0],-w,0,E),R(A[1],0,w,E),F=A[0],W=A[1]):(R(A,-w,w,E),F=-(W=A<0?-A:A))),O.hasOwnProperty(E="RANGE"))if((A=O[E])&&A.pop)R(A[0],-w,-1,E),R(A[1],1,w,E),G=A[0],J=A[1];else{if(R(A,-w,w,E),!A)throw Error(f+E+" cannot be zero: "+A);G=-(J=A<0?-A:A)}if(O.hasOwnProperty(E="CRYPTO")){if((A=O[E])!==!!A)throw Error(f+E+" not true or false: "+A);if(A){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw ee=!A,Error(f+"crypto unavailable");ee=A}else ee=A}if(O.hasOwnProperty(E="MODULO_MODE")&&(R(A=O[E],0,9,E),se=A),O.hasOwnProperty(E="POW_PRECISION")&&(R(A=O[E],0,w,E),Re=A),O.hasOwnProperty(E="FORMAT")){if(typeof(A=O[E])!="object")throw Error(f+E+" not an object: "+A);ce=A}if(O.hasOwnProperty(E="ALPHABET")){if(typeof(A=O[E])!="string"||/^.$|[+-.\s]|(.).*\1/.test(A))throw Error(f+E+" invalid: "+A);de=A}}return{DECIMAL_PLACES:T,ROUNDING_MODE:I,EXPONENTIAL_AT:[F,W],RANGE:[G,J],CRYPTO:ee,MODULO_MODE:se,POW_PRECISION:Re,FORMAT:ce,ALPHABET:de}},K.isBigNumber=function(O){return O instanceof K||O&&O._isBigNumber===!0||!1},K.maximum=K.max=function(){return Ge(arguments,b.lt)},K.minimum=K.min=function(){return Ge(arguments,b.gt)},K.random=(le=9007199254740992,Se=Math.random()*le&2097151?function(){return u(Math.random()*le)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(O){var E,A,H,M,j,x=0,D=[],B=new K(_);if(O==null?O=T:R(O,0,w),M=s(O/d),ee)if(crypto.getRandomValues){for(E=crypto.getRandomValues(new Uint32Array(M*=2));x<M;)9e15<=(j=131072*E[x]+(E[x+1]>>>11))?(A=crypto.getRandomValues(new Uint32Array(2)),E[x]=A[0],E[x+1]=A[1]):(D.push(j%1e14),x+=2);x=M/2}else{if(!crypto.randomBytes)throw ee=!1,Error(f+"crypto unavailable");for(E=crypto.randomBytes(M*=7);x<M;)9e15<=(j=281474976710656*(31&E[x])+1099511627776*E[x+1]+4294967296*E[x+2]+16777216*E[x+3]+(E[x+4]<<16)+(E[x+5]<<8)+E[x+6])?crypto.randomBytes(7).copy(E,x):(D.push(j%1e14),x+=7);x=M/7}if(!ee)for(;x<M;)(j=Se())<9e15&&(D[x++]=j%1e14);for(M=D[--x],O%=d,M&&O&&(j=g[d-O],D[x]=u(M/j)*j);D[x]===0;D.pop(),x--);if(x<0)D=[H=0];else{for(H=-1;D[0]===0;D.splice(0,1),H-=d);for(x=1,j=D[0];10<=j;j/=10,x++);x<d&&(H-=d-x)}return B.e=H,B.c=D,B}),K.sum=function(){for(var O=1,E=arguments,A=new K(E[0]);O<E.length;)A=A.plus(E[O++]);return A},ie=function(){var O="0123456789";function E(A,H,M,j){for(var x,D,B=[0],L=0,z=A.length;L<z;){for(D=B.length;D--;B[D]*=H);for(B[0]+=j.indexOf(A.charAt(L++)),x=0;x<B.length;x++)B[x]>M-1&&(B[x+1]==null&&(B[x+1]=0),B[x+1]+=B[x]/M|0,B[x]%=M)}return B.reverse()}return function(A,H,M,j,x){var D,B,L,z,ae,ge,Oe,De,qe=A.indexOf("."),ct=T,Ne=I;for(0<=qe&&(z=Re,Re=0,A=A.replace(".",""),ge=(De=new K(H)).pow(A.length-qe),Re=z,De.c=E(X(C(ge.c),ge.e,"0"),10,M,O),De.e=De.c.length),L=z=(Oe=E(A,H,M,x?(D=de,O):(D=O,de))).length;Oe[--z]==0;Oe.pop());if(!Oe[0])return D.charAt(0);if(qe<0?--L:(ge.c=Oe,ge.e=L,ge.s=j,Oe=(ge=Z(ge,De,ct,Ne,M)).c,ae=ge.r,L=ge.e),qe=Oe[B=L+ct+1],z=M/2,ae=ae||B<0||Oe[B+1]!=null,ae=Ne<4?(qe!=null||ae)&&(Ne==0||Ne==(ge.s<0?3:2)):z<qe||qe==z&&(Ne==4||ae||Ne==6&&1&Oe[B-1]||Ne==(ge.s<0?8:7)),B<1||!Oe[0])A=ae?X(D.charAt(1),-ct,D.charAt(0)):D.charAt(0);else{if(Oe.length=B,ae)for(--M;++Oe[--B]>M;)Oe[B]=0,B||(++L,Oe=[1].concat(Oe));for(z=Oe.length;!Oe[--z];);for(qe=0,A="";qe<=z;A+=D.charAt(Oe[qe++]));A=X(A,L,D.charAt(0))}return A}}(),Z=function(){function O(H,M,j){var x,D,B,L,z=0,ae=H.length,ge=M%m,Oe=M/m|0;for(H=H.slice();ae--;)z=((D=ge*(B=H[ae]%m)+(x=Oe*B+(L=H[ae]/m|0)*ge)%m*m+z)/j|0)+(x/m|0)+Oe*L,H[ae]=D%j;return z&&(H=[z].concat(H)),H}function E(H,M,j,x){var D,B;if(j!=x)B=x<j?1:-1;else for(D=B=0;D<j;D++)if(H[D]!=M[D]){B=H[D]>M[D]?1:-1;break}return B}function A(H,M,j,x){for(var D=0;j--;)H[j]-=D,D=H[j]<M[j]?1:0,H[j]=D*x+H[j]-M[j];for(;!H[0]&&1<H.length;H.splice(0,1));}return function(H,M,j,x,D){var B,L,z,ae,ge,Oe,De,qe,ct,Ne,He,rt,it,Je,Xe,Qe,jt,yt=H.s==M.s?1:-1,st=H.c,nt=M.c;if(!(st&&st[0]&&nt&&nt[0]))return new K(H.s&&M.s&&(st?!nt||st[0]!=nt[0]:nt)?st&&st[0]==0||!nt?0*yt:yt/0:NaN);for(ct=(qe=new K(yt)).c=[],yt=j+(L=H.e-M.e)+1,D||(D=h,L=S(H.e/d)-S(M.e/d),yt=yt/d|0),z=0;nt[z]==(st[z]||0);z++);if(nt[z]>(st[z]||0)&&L--,yt<0)ct.push(1),ae=!0;else{for(Je=st.length,Qe=nt.length,yt+=2,1<(ge=u(D/(nt[z=0]+1)))&&(nt=O(nt,ge,D),st=O(st,ge,D),Qe=nt.length,Je=st.length),it=Qe,He=(Ne=st.slice(0,Qe)).length;He<Qe;Ne[He++]=0);jt=nt.slice(),jt=[0].concat(jt),Xe=nt[0],nt[1]>=D/2&&Xe++;do{if(ge=0,(B=E(nt,Ne,Qe,He))<0){if(rt=Ne[0],Qe!=He&&(rt=rt*D+(Ne[1]||0)),1<(ge=u(rt/Xe)))for(D<=ge&&(ge=D-1),De=(Oe=O(nt,ge,D)).length,He=Ne.length;E(Oe,Ne,De,He)==1;)ge--,A(Oe,Qe<De?jt:nt,De,D),De=Oe.length,B=1;else ge==0&&(B=ge=1),De=(Oe=nt.slice()).length;if(De<He&&(Oe=[0].concat(Oe)),A(Ne,Oe,He,D),He=Ne.length,B==-1)for(;E(nt,Ne,Qe,He)<1;)ge++,A(Ne,Qe<He?jt:nt,He,D),He=Ne.length}else B===0&&(ge++,Ne=[0]);ct[z++]=ge,Ne[0]?Ne[He++]=st[it]||0:(Ne=[st[it]],He=1)}while((it++<Je||Ne[0]!=null)&&yt--);ae=Ne[0]!=null,ct[0]||ct.splice(0,1)}if(D==h){for(z=1,yt=ct[0];10<=yt;yt/=10,z++);Ae(qe,j+(qe.e=z+L*d-1)+1,x,ae)}else qe.e=L,qe.r=+ae;return qe}}(),me=/^(-?)0([xbo])(?=\w[\w.]*$)/i,Ce=/^([^.]+)\.$/,k=/^\.([^.]+)$/,y=/^-?(Infinity|NaN)$/,p=/^\s*\+(?=[\w.])|^\s+|\s+$/g,Q=function(O,E,A,H){var M,j=A?E:E.replace(p,"");if(y.test(j))O.s=isNaN(j)?null:j<0?-1:1,O.c=O.e=null;else{if(!A&&(j=j.replace(me,function(x,D,B){return M=(B=B.toLowerCase())=="x"?16:B=="b"?2:8,H&&H!=M?x:D}),H&&(M=H,j=j.replace(Ce,"$1").replace(k,"0.$1")),E!=j))return new K(j,M);if(K.DEBUG)throw Error(f+"Not a"+(H?" base "+H:"")+" number: "+E);O.c=O.e=O.s=null}},b.absoluteValue=b.abs=function(){var O=new K(this);return O.s<0&&(O.s=1),O},b.comparedTo=function(O,E){return P(this,new K(O,E))},b.decimalPlaces=b.dp=function(O,E){var A,H,M;if(O!=null)return R(O,0,w),E==null?E=I:R(E,0,8),Ae(new K(this),O+this.e+1,E);if(!(A=this.c))return null;if(H=((M=A.length-1)-S(this.e/d))*d,M=A[M])for(;M%10==0;M/=10,H--);return H<0&&(H=0),H},b.dividedBy=b.div=function(O,E){return Z(this,new K(O,E),T,I)},b.dividedToIntegerBy=b.idiv=function(O,E){return Z(this,new K(O,E),0,1)},b.exponentiatedBy=b.pow=function(O,E){var A,H,M,j,x,D,B,L,z=this;if((O=new K(O)).c&&!O.isInteger())throw Error(f+"Exponent not an integer: "+ke(O));if(E!=null&&(E=new K(E)),x=14<O.e,!z.c||!z.c[0]||z.c[0]==1&&!z.e&&z.c.length==1||!O.c||!O.c[0])return L=new K(Math.pow(+ke(z),x?2-V(O):+ke(O))),E?L.mod(E):L;if(D=O.s<0,E){if(E.c?!E.c[0]:!E.s)return new K(NaN);(H=!D&&z.isInteger()&&E.isInteger())&&(z=z.mod(E))}else{if(9<O.e&&(0<z.e||z.e<-1||(z.e==0?1<z.c[0]||x&&24e7<=z.c[1]:z.c[0]<8e13||x&&z.c[0]<=9999975e7)))return j=z.s<0&&V(O)?-0:0,-1<z.e&&(j=1/j),new K(D?1/j:j);Re&&(j=s(Re/d+2))}for(B=x?(A=new K(.5),D&&(O.s=1),V(O)):(M=Math.abs(+ke(O)))%2,L=new K(_);;){if(B){if(!(L=L.times(z)).c)break;j?L.c.length>j&&(L.c.length=j):H&&(L=L.mod(E))}if(M){if((M=u(M/2))===0)break;B=M%2}else if(Ae(O=O.times(A),O.e+1,1),14<O.e)B=V(O);else{if((M=+ke(O))==0)break;B=M%2}z=z.times(z),j?z.c&&z.c.length>j&&(z.c.length=j):H&&(z=z.mod(E))}return H?L:(D&&(L=_.div(L)),E?L.mod(E):j?Ae(L,Re,I,void 0):L)},b.integerValue=function(O){var E=new K(this);return O==null?O=I:R(O,0,8),Ae(E,E.e+1,O)},b.isEqualTo=b.eq=function(O,E){return P(this,new K(O,E))===0},b.isFinite=function(){return!!this.c},b.isGreaterThan=b.gt=function(O,E){return 0<P(this,new K(O,E))},b.isGreaterThanOrEqualTo=b.gte=function(O,E){return(E=P(this,new K(O,E)))===1||E===0},b.isInteger=function(){return!!this.c&&S(this.e/d)>this.c.length-2},b.isLessThan=b.lt=function(O,E){return P(this,new K(O,E))<0},b.isLessThanOrEqualTo=b.lte=function(O,E){return(E=P(this,new K(O,E)))===-1||E===0},b.isNaN=function(){return!this.s},b.isNegative=function(){return this.s<0},b.isPositive=function(){return 0<this.s},b.isZero=function(){return!!this.c&&this.c[0]==0},b.minus=function(O,E){var A,H,M,j,x=this,D=x.s;if(E=(O=new K(O,E)).s,!D||!E)return new K(NaN);if(D!=E)return O.s=-E,x.plus(O);var B=x.e/d,L=O.e/d,z=x.c,ae=O.c;if(!B||!L){if(!z||!ae)return z?(O.s=-E,O):new K(ae?x:NaN);if(!z[0]||!ae[0])return ae[0]?(O.s=-E,O):new K(z[0]?x:I==3?-0:0)}if(B=S(B),L=S(L),z=z.slice(),D=B-L){for((M=(j=D<0)?(D=-D,z):(L=B,ae)).reverse(),E=D;E--;M.push(0));M.reverse()}else for(H=(j=(D=z.length)<(E=ae.length))?D:E,D=E=0;E<H;E++)if(z[E]!=ae[E]){j=z[E]<ae[E];break}if(j&&(M=z,z=ae,ae=M,O.s=-O.s),0<(E=(H=ae.length)-(A=z.length)))for(;E--;z[A++]=0);for(E=h-1;D<H;){if(z[--H]<ae[H]){for(A=H;A&&!z[--A];z[A]=E);--z[A],z[H]+=h}z[H]-=ae[H]}for(;z[0]==0;z.splice(0,1),--L);return z[0]?Pe(O,z,L):(O.s=I==3?-1:1,O.c=[O.e=0],O)},b.modulo=b.mod=function(O,E){var A,H,M=this;return O=new K(O,E),!M.c||!O.s||O.c&&!O.c[0]?new K(NaN):!O.c||M.c&&!M.c[0]?new K(M):(se==9?(H=O.s,O.s=1,A=Z(M,O,0,3),O.s=H,A.s*=H):A=Z(M,O,0,se),(O=M.minus(A.times(O))).c[0]||se!=1||(O.s=M.s),O)},b.multipliedBy=b.times=function(O,E){var A,H,M,j,x,D,B,L,z,ae,ge,Oe,De,qe,ct,Ne=this,He=Ne.c,rt=(O=new K(O,E)).c;if(!(He&&rt&&He[0]&&rt[0]))return!Ne.s||!O.s||He&&!He[0]&&!rt||rt&&!rt[0]&&!He?O.c=O.e=O.s=null:(O.s*=Ne.s,He&&rt?(O.c=[0],O.e=0):O.c=O.e=null),O;for(H=S(Ne.e/d)+S(O.e/d),O.s*=Ne.s,(B=He.length)<(ae=rt.length)&&(De=He,He=rt,rt=De,M=B,B=ae,ae=M),M=B+ae,De=[];M--;De.push(0));for(qe=h,ct=m,M=ae;0<=--M;){for(A=0,ge=rt[M]%ct,Oe=rt[M]/ct|0,j=M+(x=B);M<j;)A=((L=ge*(L=He[--x]%ct)+(D=Oe*L+(z=He[x]/ct|0)*ge)%ct*ct+De[j]+A)/qe|0)+(D/ct|0)+Oe*z,De[j--]=L%qe;De[j]=A}return A?++H:De.splice(0,1),Pe(O,De,H)},b.negated=function(){var O=new K(this);return O.s=-O.s||null,O},b.plus=function(O,E){var A,H=this,M=H.s;if(E=(O=new K(O,E)).s,!M||!E)return new K(NaN);if(M!=E)return O.s=-E,H.minus(O);var j=H.e/d,x=O.e/d,D=H.c,B=O.c;if(!j||!x){if(!D||!B)return new K(M/0);if(!D[0]||!B[0])return B[0]?O:new K(D[0]?H:0*M)}if(j=S(j),x=S(x),D=D.slice(),M=j-x){for((A=0<M?(x=j,B):(M=-M,D)).reverse();M--;A.push(0));A.reverse()}for((M=D.length)-(E=B.length)<0&&(A=B,B=D,D=A,E=M),M=0;E;)M=(D[--E]=D[E]+B[E]+M)/h|0,D[E]=h===D[E]?0:D[E]%h;return M&&(D=[M].concat(D),++x),Pe(O,D,x)},b.precision=b.sd=function(O,E){var A,H,M;if(O!=null&&O!==!!O)return R(O,1,w),E==null?E=I:R(E,0,8),Ae(new K(this),O,E);if(!(A=this.c))return null;if(H=(M=A.length-1)*d+1,M=A[M]){for(;M%10==0;M/=10,H--);for(M=A[0];10<=M;M/=10,H++);}return O&&this.e+1>H&&(H=this.e+1),H},b.shiftedBy=function(O){return R(O,-v,v),this.times("1e"+O)},b.squareRoot=b.sqrt=function(){var O,E,A,H,M,j=this,x=j.c,D=j.s,B=j.e,L=T+4,z=new K("0.5");if(D!==1||!x||!x[0])return new K(!D||D<0&&(!x||x[0])?NaN:x?j:1/0);if((A=(D=Math.sqrt(+ke(j)))==0||D==1/0?(((E=C(x)).length+B)%2==0&&(E+="0"),D=Math.sqrt(+E),B=S((B+1)/2)-(B<0||B%2),new K(E=D==1/0?"1e"+B:(E=D.toExponential()).slice(0,E.indexOf("e")+1)+B)):new K(D+"")).c[0]){for((D=(B=A.e)+L)<3&&(D=0);;)if(M=A,A=z.times(M.plus(Z(j,M,L,1))),C(M.c).slice(0,D)===(E=C(A.c)).slice(0,D)){if(A.e<B&&--D,(E=E.slice(D-3,D+1))!="9999"&&(H||E!="4999")){+E&&(+E.slice(1)||E.charAt(0)!="5")||(Ae(A,A.e+T+2,1),O=!A.times(A).eq(j));break}if(!H&&(Ae(M,M.e+T+2,0),M.times(M).eq(j))){A=M;break}L+=4,D+=4,H=1}}return Ae(A,A.e+T+1,I,O)},b.toExponential=function(O,E){return O!=null&&(R(O,0,w),O++),Me(this,O,E,1)},b.toFixed=function(O,E){return O!=null&&(R(O,0,w),O=O+this.e+1),Me(this,O,E)},b.toFormat=function(O,E,A){var H;if(A==null)O!=null&&E&&typeof E=="object"?(A=E,E=null):O&&typeof O=="object"?(A=O,O=E=null):A=ce;else if(typeof A!="object")throw Error(f+"Argument not an object: "+A);if(H=this.toFixed(O,E),this.c){var M,j=H.split("."),x=+A.groupSize,D=+A.secondaryGroupSize,B=A.groupSeparator||"",L=j[0],z=j[1],ae=this.s<0,ge=ae?L.slice(1):L,Oe=ge.length;if(D&&(M=x,x=D,Oe-=D=M),0<x&&0<Oe){for(M=Oe%x||x,L=ge.substr(0,M);M<Oe;M+=x)L+=B+ge.substr(M,x);0<D&&(L+=B+ge.slice(M)),ae&&(L="-"+L)}H=z?L+(A.decimalSeparator||"")+((D=+A.fractionGroupSize)?z.replace(new RegExp("\\d{"+D+"}\\B","g"),"$&"+(A.fractionGroupSeparator||"")):z):L}return(A.prefix||"")+H+(A.suffix||"")},b.toFraction=function(O){var E,A,H,M,j,x,D,B,L,z,ae,ge,Oe=this,De=Oe.c;if(O!=null&&(!(D=new K(O)).isInteger()&&(D.c||D.s!==1)||D.lt(_)))throw Error(f+"Argument "+(D.isInteger()?"out of range: ":"not an integer: ")+ke(D));if(!De)return new K(Oe);for(E=new K(_),L=A=new K(_),H=B=new K(_),ge=C(De),j=E.e=ge.length-Oe.e-1,E.c[0]=g[(x=j%d)<0?d+x:x],O=!O||0<D.comparedTo(E)?0<j?E:L:D,x=J,J=1/0,D=new K(ge),B.c[0]=0;z=Z(D,E,0,1),(M=A.plus(z.times(H))).comparedTo(O)!=1;)A=H,H=M,L=B.plus(z.times(M=L)),B=M,E=D.minus(z.times(M=E)),D=M;return M=Z(O.minus(A),H,0,1),B=B.plus(M.times(L)),A=A.plus(M.times(H)),B.s=L.s=Oe.s,ae=Z(L,H,j*=2,I).minus(Oe).abs().comparedTo(Z(B,A,j,I).minus(Oe).abs())<1?[L,H]:[B,A],J=x,ae},b.toNumber=function(){return+ke(this)},b.toPrecision=function(O,E){return O!=null&&R(O,1,w),Me(this,O,E,2)},b.toString=function(O){var E,A=this,H=A.s,M=A.e;return M===null?H?(E="Infinity",H<0&&(E="-"+E)):E="NaN":(E=O==null?M<=F||W<=M?U(C(A.c),M):X(C(A.c),M,"0"):O===10?X(C((A=Ae(new K(A),T+M+1,I)).c),A.e,"0"):(R(O,2,de.length,"Base"),ie(X(C(A.c),M,"0"),10,O,H,!0)),H<0&&A.c[0]&&(E="-"+E)),E},b.valueOf=b.toJSON=function(){return ke(this)},b._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(b[Symbol.toStringTag]="BigNumber",b[Symbol.for("nodejs.util.inspect.custom")]=b.valueOf),q!=null&&K.set(q),K}()).default=a.BigNumber=a,n!==void 0&&n.exports?n.exports=a:(i||(i=typeof self<"u"&&self?self:window),i.BigNumber=a)})(this)},{}],2:[function(r,n,o){n.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(i){var a=i%10;return~~(i%100/10)==1?"th":a===1?"st":a===2?"nd":a===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(r,n,o){function i(S,C){return function(P){if(Array.isArray(P))return P}(S)||function(P,R){var V=[],U=!0,X=!1,Y=void 0;try{for(var q,Z=P[Symbol.iterator]();!(U=(q=Z.next()).done)&&(V.push(q.value),!R||V.length!==R);U=!0);}catch(ie){X=!0,Y=ie}finally{try{U||Z.return==null||Z.return()}finally{if(X)throw Y}}return V}(S,C)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var a=r("./globalState"),l=r("./validating"),s=r("./parsing"),u=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],f={general:{scale:1024,suffixes:u,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:u,marker:"d"}},c={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function h(S){var C=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},P=2<arguments.length?arguments[2]:void 0;if(typeof C=="string"&&(C=s.parseFormat(C)),!l.validateFormat(C))return"ERROR: invalid format";var R=C.prefix||"",V=C.postfix||"",U=function(X,Y,q){switch(Y.output){case"currency":return Y=w(Y,a.currentCurrencyDefaultFormat()),function(de,K,Me){var Ge=Me.currentCurrency(),Pe=Object.assign({},c,K),Ae=void 0,ke="",O=!!Pe.totalLength||!!Pe.forceAverage||Pe.average,E=K.currencyPosition||Ge.position,A=K.currencySymbol||Ge.symbol;Pe.spaceSeparated&&(ke=" "),E==="infix"&&(Ae=ke+A+ke);var H=m({instance:de,providedFormat:K,state:Me,decimalSeparator:Ae});return E==="prefix"&&(H=de._value<0&&Pe.negative==="sign"?"-".concat(ke).concat(A).concat(H.slice(1)):A+ke+H),E&&E!=="postfix"||(H=H+(ke=O?"":ke)+A),H}(X,Y,a);case"percent":return Y=w(Y,a.currentPercentageDefaultFormat()),function(de,K,Me,Ge){var Pe=K.prefixSymbol,Ae=m({instance:Ge(100*de._value),providedFormat:K,state:Me}),ke=Object.assign({},c,K);return Pe?"%".concat(ke.spaceSeparated?" ":"").concat(Ae):"".concat(Ae).concat(ke.spaceSeparated?" ":"","%")}(X,Y,a,q);case"byte":return Y=w(Y,a.currentByteDefaultFormat()),_=X,I=a,F=q,W=(T=Y).base||"binary",G=f[W],J=d(_._value,G.suffixes,G.scale),ee=J.value,se=J.suffix,Re=m({instance:F(ee),providedFormat:T,state:I,defaults:I.currentByteDefaultFormat()}),ce=I.currentAbbreviations(),"".concat(Re).concat(ce.spaced?" ":"").concat(se);case"time":return Y=w(Y,a.currentTimeDefaultFormat()),k=X,y=Math.floor(k._value/60/60),p=Math.floor((k._value-60*y*60)/60),b=Math.round(k._value-60*y*60-60*p),"".concat(y,":").concat(p<10?"0":"").concat(p,":").concat(b<10?"0":"").concat(b);case"ordinal":return Y=w(Y,a.currentOrdinalDefaultFormat()),Z=X,ie=Y,le=(Q=a).currentOrdinal(),Se=Object.assign({},c,ie),me=m({instance:Z,providedFormat:ie,state:Q}),Ce=le(Z._value),"".concat(me).concat(Se.spaceSeparated?" ":"").concat(Ce);case"number":default:return m({instance:X,providedFormat:Y,numbro:q})}var Z,ie,Q,le,Se,me,Ce,k,y,p,b,_,T,I,F,W,G,J,ee,se,Re,ce}(S,C,P);return U=(U=R+U)+V}function d(S,C,P){var R=C[0],V=Math.abs(S);if(P<=V){for(var U=1;U<C.length;++U){var X=Math.pow(P,U),Y=Math.pow(P,U+1);if(X<=V&&V<Y){R=C[U],S/=X;break}}R===C[0]&&(S/=Math.pow(P,C.length-1),R=C[C.length-1])}return{value:S,suffix:R}}function v(S){for(var C="",P=0;P<S;P++)C+="0";return C}function g(S,C){return S.toString().indexOf("e")!==-1?function(P,R){var V=P.toString(),U=i(V.split("e"),2),X=U[0],Y=U[1],q=i(X.split("."),2),Z=q[0],ie=q[1],Q=ie===void 0?"":ie;if(0<+Y)V=Z+Q+v(Y-Q.length);else{var le=".";le=+Z<0?"-0".concat(le):"0".concat(le);var Se=(v(-Y-1)+Math.abs(Z)+Q).substr(0,R);Se.length<R&&(Se+=v(R-Se.length)),V=le+Se}return 0<+Y&&0<R&&(V+=".".concat(v(R))),V}(S,C):(Math.round(+"".concat(S,"e+").concat(C))/Math.pow(10,C)).toFixed(C)}function m(S){var C=S.instance,P=S.providedFormat,R=S.state,V=R===void 0?a:R,U=S.decimalSeparator,X=S.defaults,Y=X===void 0?V.currentDefaults():X,q=C._value;if(q===0&&V.hasZeroFormat())return V.getZeroFormat();if(!isFinite(q))return q.toString();var Z,ie,Q,le,Se,me,Ce,k,y=Object.assign({},c,Y,P),p=y.totalLength,b=p?0:y.characteristic,_=y.optionalCharacteristic,T=y.forceAverage,I=!!p||!!T||y.average,F=p?-1:I&&P.mantissa===void 0?0:y.mantissa,W=!p&&(P.optionalMantissa===void 0?F===-1:y.optionalMantissa),G=y.trimMantissa,J=y.thousandSeparated,ee=y.spaceSeparated,se=y.negative,Re=y.forceSign,ce=y.exponential,de="";if(I){var K=function(O){var E=O.value,A=O.forceAverage,H=O.abbreviations,M=O.spaceSeparated,j=M!==void 0&&M,x=O.totalLength,D=x===void 0?0:x,B="",L=Math.abs(E),z=-1;if(L>=Math.pow(10,12)&&!A||A==="trillion"?(B=H.trillion,E/=Math.pow(10,12)):L<Math.pow(10,12)&&L>=Math.pow(10,9)&&!A||A==="billion"?(B=H.billion,E/=Math.pow(10,9)):L<Math.pow(10,9)&&L>=Math.pow(10,6)&&!A||A==="million"?(B=H.million,E/=Math.pow(10,6)):(L<Math.pow(10,6)&&L>=Math.pow(10,3)&&!A||A==="thousand")&&(B=H.thousand,E/=Math.pow(10,3)),B&&(B=(j?" ":"")+B),D){var ae=E.toString().split(".")[0];z=Math.max(D-ae.length,0)}return{value:E,abbreviation:B,mantissaPrecision:z}}({value:q,forceAverage:T,abbreviations:V.currentAbbreviations(),spaceSeparated:ee,totalLength:p});q=K.value,de+=K.abbreviation,p&&(F=K.mantissaPrecision)}if(ce){var Me=(ie=(Z={value:q,characteristicPrecision:b}).value,Q=Z.characteristicPrecision,le=Q===void 0?0:Q,Se=i(ie.toExponential().split("e"),2),me=Se[0],Ce=Se[1],k=+me,le&&1<le&&(k*=Math.pow(10,le-1),Ce=0<=(Ce=+Ce-(le-1))?"+".concat(Ce):Ce),{value:k,abbreviation:"e".concat(Ce)});q=Me.value,de=Me.abbreviation+de}var Ge,Pe,Ae,ke=function(O,E,A,H,M){if(H===-1)return O;var j=g(E,H),x=i(j.toString().split("."),2),D=x[0],B=x[1],L=B===void 0?"":B;if(L.match(/^0+$/)&&(A||M))return D;var z=L.match(/0+$/);return M&&z?"".concat(D,".").concat(L.toString().slice(0,z.index)):j.toString()}(q.toString(),q,W,F,G);return ke=function(O,E,A,H,M){var j=H.currentDelimiters(),x=j.thousands;M=M||j.decimal;var D=j.thousandsSize||3,B=O.toString(),L=B.split(".")[0],z=B.split(".")[1];return A&&(E<0&&(L=L.slice(1)),function(ae,ge){for(var Oe=[],De=0,qe=ae;0<qe;qe--)De===ge&&(Oe.unshift(qe),De=0),De++;return Oe}(L.length,D).forEach(function(ae,ge){L=L.slice(0,ae+ge)+x+L.slice(ae+ge)}),E<0&&(L="-".concat(L))),B=z?L+M+z:L}(ke=function(O,E,A,H){var M=O,j=i(M.toString().split("."),2),x=j[0],D=j[1];if(x.match(/^-?0$/)&&A)return D?"".concat(x.replace("0",""),".").concat(D):x.replace("0","");if(x.length<H)for(var B=H-x.length,L=0;L<B;L++)M="0".concat(M);return M.toString()}(ke,0,_,b),q,J,V,U),(I||ce)&&(ke=ke+de),(Re||q<0)&&(Ge=ke,Ae=se,ke=(Pe=q)===0?Ge:+Ge==0?Ge.replace("-",""):0<Pe?"+".concat(Ge):Ae==="sign"?Ge:"(".concat(Ge.replace("-",""),")")),ke}function w(S,C){if(!S)return C;var P=Object.keys(S);return P.length===1&&P[0]==="output"?C:S}n.exports=function(S){return{format:function(){for(var C=arguments.length,P=new Array(C),R=0;R<C;R++)P[R]=arguments[R];return h.apply(void 0,P.concat([S]))},getByteUnit:function(){for(var C=arguments.length,P=new Array(C),R=0;R<C;R++)P[R]=arguments[R];return(function(V){var U=f.general;return d(V._value,U.suffixes,U.scale).suffix}).apply(void 0,P.concat([S]))},getBinaryByteUnit:function(){for(var C=arguments.length,P=new Array(C),R=0;R<C;R++)P[R]=arguments[R];return(function(V){var U=f.binary;return d(V._value,U.suffixes,U.scale).suffix}).apply(void 0,P.concat([S]))},getDecimalByteUnit:function(){for(var C=arguments.length,P=new Array(C),R=0;R<C;R++)P[R]=arguments[R];return(function(V){var U=f.decimal;return d(V._value,U.suffixes,U.scale).suffix}).apply(void 0,P.concat([S]))},formatOrDefault:w}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(r,n,o){var i=r("./en-US"),a=r("./validating"),l=r("./parsing"),s={},u=void 0,f={},c=null,h={};function d(g){u=g}function v(){return f[u]}s.languages=function(){return Object.assign({},f)},s.currentLanguage=function(){return u},s.currentCurrency=function(){return v().currency},s.currentAbbreviations=function(){return v().abbreviations},s.currentDelimiters=function(){return v().delimiters},s.currentOrdinal=function(){return v().ordinal},s.currentDefaults=function(){return Object.assign({},v().defaults,h)},s.currentOrdinalDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().ordinalFormat)},s.currentByteDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().byteFormat)},s.currentPercentageDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().percentageFormat)},s.currentCurrencyDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().currencyFormat)},s.currentTimeDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().timeFormat)},s.setDefaults=function(g){g=l.parseFormat(g),a.validateFormat(g)&&(h=g)},s.getZeroFormat=function(){return c},s.setZeroFormat=function(g){return c=typeof g=="string"?g:null},s.hasZeroFormat=function(){return c!==null},s.languageData=function(g){if(g){if(f[g])return f[g];throw new Error('Unknown tag "'.concat(g,'"'))}return v()},s.registerLanguage=function(g){var m=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!a.validateLanguage(g))throw new Error("Invalid language data");f[g.languageTag]=g,m&&d(g.languageTag)},s.setLanguage=function(g){var m=1<arguments.length&&arguments[1]!==void 0?arguments[1]:i.languageTag;if(!f[g]){var w=g.split("-")[0],S=Object.keys(f).find(function(C){return C.split("-")[0]===w});return f[S]?void d(S):void d(m)}d(g)},s.registerLanguage(i),u=i.languageTag,n.exports=s},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(r,n,o){n.exports=function(i){return{loadLanguagesInNode:function(a){return l=i,void a.forEach(function(s){var u=void 0;try{u=r("../languages/".concat(s))}catch{console.error('Unable to load "'.concat(s,'". No matching language file found.'))}u&&l.registerLanguage(u)});var l}}}},{}],6:[function(r,n,o){var i=r("bignumber.js");function a(l,s,u){var f=new i(l._value),c=s;return u.isNumbro(s)&&(c=s._value),c=new i(c),l._value=f.minus(c).toNumber(),l}n.exports=function(l){return{add:function(s,u){return c=u,h=l,d=new i((f=s)._value),v=c,h.isNumbro(c)&&(v=c._value),v=new i(v),f._value=d.plus(v).toNumber(),f;var f,c,h,d,v},subtract:function(s,u){return a(s,u,l)},multiply:function(s,u){return c=u,h=l,d=new i((f=s)._value),v=c,h.isNumbro(c)&&(v=c._value),v=new i(v),f._value=d.times(v).toNumber(),f;var f,c,h,d,v},divide:function(s,u){return c=u,h=l,d=new i((f=s)._value),v=c,h.isNumbro(c)&&(v=c._value),v=new i(v),f._value=d.dividedBy(v).toNumber(),f;var f,c,h,d,v},set:function(s,u){return f=s,h=c=u,l.isNumbro(c)&&(h=c._value),f._value=h,f;var f,c,h},difference:function(s,u){return f=u,a(h=(c=l)(s._value),f,c),Math.abs(h._value);var f,c,h}}}},{"bignumber.js":1}],7:[function(r,n,o){function i(m,w){for(var S=0;S<w.length;S++){var C=w[S];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(m,C.key,C)}}var a=r("./globalState"),l=r("./validating"),s=r("./loading")(g),u=r("./unformatting"),f=r("./formatting")(g),c=r("./manipulating")(g),h=r("./parsing"),d=function(){function m(C){(function(P,R){if(!(P instanceof R))throw new TypeError("Cannot call a class as a function")})(this,m),this._value=C}var w,S;return w=m,(S=[{key:"clone",value:function(){return g(this._value)}},{key:"format",value:function(){var C=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return f.format(this,C)}},{key:"formatCurrency",value:function(C){return typeof C=="string"&&(C=h.parseFormat(C)),(C=f.formatOrDefault(C,a.currentCurrencyDefaultFormat())).output="currency",f.format(this,C)}},{key:"formatTime",value:function(){var C=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return C.output="time",f.format(this,C)}},{key:"binaryByteUnits",value:function(){return f.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return f.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return f.getByteUnit(this)}},{key:"difference",value:function(C){return c.difference(this,C)}},{key:"add",value:function(C){return c.add(this,C)}},{key:"subtract",value:function(C){return c.subtract(this,C)}},{key:"multiply",value:function(C){return c.multiply(this,C)}},{key:"divide",value:function(C){return c.divide(this,C)}},{key:"set",value:function(C){return c.set(this,v(C))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&i(w.prototype,S),m}();function v(m){var w=m;return g.isNumbro(m)?w=m._value:typeof m=="string"?w=g.unformat(m):isNaN(m)&&(w=NaN),w}function g(m){return new d(v(m))}g.version="2.1.2",g.isNumbro=function(m){return m instanceof d},g.language=a.currentLanguage,g.registerLanguage=a.registerLanguage,g.setLanguage=a.setLanguage,g.languages=a.languages,g.languageData=a.languageData,g.zeroFormat=a.setZeroFormat,g.defaultFormat=a.currentDefaults,g.setDefaults=a.setDefaults,g.defaultCurrencyFormat=a.currentCurrencyDefaultFormat,g.validate=l.validate,g.loadLanguagesInNode=s.loadLanguagesInNode,g.unformat=u.unformat,n.exports=g},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(r,n,o){n.exports={parseFormat:function(i){var a,l,s,u,f,c,h,d,v,g,m,w,S,C,P,R,V,U,X,Y,q=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof i!="string"?i:(l=q,i=(s=(a=i).match(/^{([^}]*)}/))?(l.prefix=s[1],a.slice(s[0].length)):a,f=q,function(Z,ie){if(Z.indexOf("$")===-1){if(Z.indexOf("%")===-1)return Z.indexOf("bd")!==-1?(ie.output="byte",ie.base="general"):Z.indexOf("b")!==-1?(ie.output="byte",ie.base="binary"):Z.indexOf("d")!==-1?(ie.output="byte",ie.base="decimal"):Z.indexOf(":")===-1?Z.indexOf("o")!==-1&&(ie.output="ordinal"):ie.output="time";ie.output="percent"}else ie.output="currency"}(i=(c=(u=i).match(/{([^}]*)}$/))?(f.postfix=c[1],u.slice(0,-c[0].length)):u,q),h=q,(d=i.match(/[1-9]+[0-9]*/))&&(h.totalLength=+d[0]),v=q,(g=i.split(".")[0].match(/0+/))&&(v.characteristic=g[0].length),function(Z,ie){if(Z.indexOf(".")!==-1){var Q=Z.split(".")[0];ie.optionalCharacteristic=Q.indexOf("0")===-1}}(i,q),m=q,i.indexOf("a")!==-1&&(m.average=!0),S=q,(w=i).indexOf("K")!==-1?S.forceAverage="thousand":w.indexOf("M")!==-1?S.forceAverage="million":w.indexOf("B")!==-1?S.forceAverage="billion":w.indexOf("T")!==-1&&(S.forceAverage="trillion"),function(Z,ie){var Q=Z.split(".")[1];if(Q){var le=Q.match(/0+/);le&&(ie.mantissa=le[0].length)}}(i,q),P=q,(C=i).match(/\[\.]/)?P.optionalMantissa=!0:C.match(/\./)&&(P.optionalMantissa=!1),R=q,i.indexOf(",")!==-1&&(R.thousandSeparated=!0),V=q,i.indexOf(" ")!==-1&&(V.spaceSeparated=!0),X=q,(U=i).match(/^\+?\([^)]*\)$/)&&(X.negative="parenthesis"),U.match(/^\+?-/)&&(X.negative="sign"),Y=q,i.match(/^\+/)&&(Y.forceSign=!0),q)}}},{}],9:[function(r,n,o){var i=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function a(s){return s.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function l(s,u){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",c=3<arguments.length?arguments[3]:void 0,h=4<arguments.length?arguments[4]:void 0,d=5<arguments.length?arguments[5]:void 0,v=6<arguments.length?arguments[6]:void 0;if(s!=="")return s===h?0:function g(m,w){var S=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",C=3<arguments.length?arguments[3]:void 0,P=4<arguments.length?arguments[4]:void 0,R=5<arguments.length?arguments[5]:void 0,V=6<arguments.length?arguments[6]:void 0;if(!isNaN(+m))return+m;var U="",X=m.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(X!==m)return-1*g(X,w,S,C,P,R,V);for(var Y=0;Y<i.length;Y++){var q=i[Y];if((U=m.replace(q.key,""))!==m)return g(U,w,S,C,P,R,V)*q.factor}if((U=m.replace("%",""))!==m)return g(U,w,S,C,P,R,V)/100;var Z=parseFloat(m);if(!isNaN(Z)){var ie=C(Z);if(ie&&ie!=="."&&(U=m.replace(new RegExp("".concat(a(ie),"$")),""))!==m)return g(U,w,S,C,P,R,V);var Q={};Object.keys(R).forEach(function(p){Q[R[p]]=p});for(var le=Object.keys(Q).sort().reverse(),Se=le.length,me=0;me<Se;me++){var Ce=le[me],k=Q[Ce];if((U=m.replace(Ce,""))!==m){var y=void 0;switch(k){case"thousand":y=Math.pow(10,3);break;case"million":y=Math.pow(10,6);break;case"billion":y=Math.pow(10,9);break;case"trillion":y=Math.pow(10,12)}return g(U,w,S,C,P,R,V)*y}}}}(function(g,m){var w=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",S=g.replace(w,"");return S=(S=S.replace(new RegExp("([0-9])".concat(a(m.thousands),"([0-9])"),"g"),"$1$2")).replace(m.decimal,".")}(s,u,f),u,f,c,h,d,v)}n.exports={unformat:function(s,u){var f,c,h,d=r("./globalState"),v=d.currentDelimiters(),g=d.currentCurrency().symbol,m=d.currentOrdinal(),w=d.getZeroFormat(),S=d.currentAbbreviations(),C=void 0;if(typeof s=="string")C=function(P,R){if(!P.indexOf(":")||R.thousands===":")return!1;var V=P.split(":");if(V.length!==3)return!1;var U=+V[0],X=+V[1],Y=+V[2];return!isNaN(U)&&!isNaN(X)&&!isNaN(Y)}(s,v)?(f=s.split(":"),c=+f[0],h=+f[1],+f[2]+60*h+3600*c):l(s,v,g,m,w,S,u);else{if(typeof s!="number")return;C=s}if(C!==void 0)return C}}},{"./globalState":4}],10:[function(r,n,o){function i(v){return function(g){if(Array.isArray(g)){for(var m=0,w=new Array(g.length);m<g.length;m++)w[m]=g[m];return w}}(v)||function(g){if(Symbol.iterator in Object(g)||Object.prototype.toString.call(g)==="[object Arguments]")return Array.from(g)}(v)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function a(v){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g})(v)}var l=r("./unformatting"),s=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,u={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(v,g){return g.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(v){return v.output==="byte"}},characteristic:{type:"number",restriction:function(v){return 0<=v},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(v){return 0<=v},message:"value must be positive"},{restriction:function(v,g){return!g.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(v){return 0<=v},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(v,g){return g.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},f={languageTag:{type:"string",mandatory:!0,restriction:function(v){return v.match(s)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function c(v){return!!l.unformat(v)}function h(v,g,m){var w=3<arguments.length&&arguments[3]!==void 0&&arguments[3],S=Object.keys(v).map(function(C){if(!g[C])return console.error("".concat(m," Invalid key: ").concat(C)),!1;var P=v[C],R=g[C];if(typeof R=="string"&&(R={type:R}),R.type==="format"){if(!h(P,u,"[Validate ".concat(C,"]"),!0))return!1}else if(a(P)!==R.type)return console.error("".concat(m," ").concat(C,' type mismatched: "').concat(R.type,'" expected, "').concat(a(P),'" provided')),!1;if(R.restrictions&&R.restrictions.length)for(var V=R.restrictions.length,U=0;U<V;U++){var X=R.restrictions[U],Y=X.restriction,q=X.message;if(!Y(P,v))return console.error("".concat(m," ").concat(C," invalid value: ").concat(q)),!1}return R.restriction&&!R.restriction(P,v)?(console.error("".concat(m," ").concat(C," invalid value: ").concat(R.message)),!1):R.validValues&&R.validValues.indexOf(P)===-1?(console.error("".concat(m," ").concat(C," invalid value: must be among ").concat(JSON.stringify(R.validValues),', "').concat(P,'" provided')),!1):!(R.children&&!h(P,R.children,"[Validate ".concat(C,"]")))});return w||S.push.apply(S,i(Object.keys(g).map(function(C){var P=g[C];if(typeof P=="string"&&(P={type:P}),P.mandatory){var R=P.mandatory;if(typeof R=="function"&&(R=R(v)),R&&v[C]===void 0)return console.error("".concat(m,' Missing mandatory key "').concat(C,'"')),!1}return!0}))),S.reduce(function(C,P){return C&&P},!0)}function d(v){return h(v,u,"[Validate format]")}n.exports={validate:function(v,g){var m=c(v),w=d(g);return m&&w},validateFormat:d,validateInput:c,validateLanguage:function(v){return h(v,f,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})(B2);var yRe=B2.exports;const Bi=DL(yRe);var gRe="numeric";function bP(e,t,r,n,o,i,a){var l=i;if(gr(l)){var s=a.numericFormat,u=s&&s.culture||"-",f=s&&s.pattern,c=a.className||"",h=c.length?c.split(" "):[];if(typeof u<"u"&&!Bi.languages()[u]){var d=u.replace("-",""),v=Bi.allLanguages?Bi.allLanguages[u]:Bi[d];v&&Bi.registerLanguage(v)}Bi.setLanguage(u),l=Bi(l).format(f||"0"),h.indexOf("htLeft")<0&&h.indexOf("htCenter")<0&&h.indexOf("htRight")<0&&h.indexOf("htJustify")<0&&h.push("htRight"),h.indexOf("htNumeric")<0&&h.push("htNumeric"),a.className=h.join(" "),t.dir="ltr"}Ii(e,t,r,n,o,l,a)}bP.RENDERER_TYPE=gRe;var pRe="password";function wP(e,t,r,n,o,i,a){Ii.apply(this,[e,t,r,n,o,i,a]);var l=a.hashLength||t.innerHTML.length,s=a.hashSymbol||"*",u="";_e(l-1,function(){u+=s}),tl(t,u)}wP.RENDERER_TYPE=pRe;var mRe="time";function SP(e,t,r,n,o,i,a){Ii.apply(this,[e,t,r,n,o,i,a]),t.dir="ltr"}SP.RENDERER_TYPE=mRe;function bRe(){An(Tf),An(_v),An(pP),An(gP),An(bP),An(wP),An(Ii),An(SP)}var wRe="autocomplete";function zm(e,t){var r=e;if(r==null&&(r=""),this.allowEmpty&&r===""){t(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(r,cx(r,t)):cx(r,t)(this.source):t(!0)}zm.VALIDATOR_TYPE=wRe;function cx(e,t){var r=e;return function(n){for(var o=!1,i=0,a=n.length;i<a;i++)if(r===n[i]){o=!0;break}t(o)}}var SRe=Object.is||function(t,r){return t===r?t!==0||1/t===1/r:t!==t&&r!==r},CRe=zt,_Re=fm,ORe=Ht,RRe=pn,ERe=Tr,hx=SRe,dx=Yt,TRe=Ga,PRe=cm;_Re("search",function(e,t,r){return[function(o){var i=ERe(this),a=RRe(o)?void 0:TRe(o,e);return a?CRe(a,o,i):new RegExp(o)[e](dx(i))},function(n){var o=ORe(this),i=dx(n),a=r(t,o,i);if(a.done)return a.value;var l=o.lastIndex;hx(l,0)||(o.lastIndex=0);var s=PRe(o,i);return hx(o.lastIndex,l)||(o.lastIndex=l),s===null?-1:s.index}]});function V2(e){var t=new Date(e);return isNaN(new Date("".concat(e,"T00:00")).getDate())?t:new Date(t.getTime()+t.getTimezoneOffset()*6e4)}const kRe=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:V2},Symbol.toStringTag,{value:"Module"}));var $Re="date";function CP(e,t){var r=NV(D2,this.instance),n=e,o=!0;n==null&&(n="");var i=te(n,this.dateFormat||r.defaultDateFormat,!0).isValid(),a=te(new Date(n)).isValid()||i;if(this.allowEmpty&&n===""&&(a=!0,i=!0),a||(o=!1),!a&&i&&(o=!0),a&&!i)if(this.correctFormat===!0){var l=ARe(n,this.dateFormat),s=this.instance.toVisualRow(this.row),u=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(s,u,l,"dateValidator"),o=!0}else o=!1;t(o)}CP.VALIDATOR_TYPE=$Re;function ARe(e,t){var r=te(V2(e)),n=te(e,t),o=e.search(/[A-z]/g)>-1,i;return r.isValid()&&r.format("x")===n.format("x")||!n.isValid()||o?i=r:i=n,i.format(t)}var IRe="numeric";function _P(e,t){var r=e;r==null&&(r=""),this.allowEmpty&&r===""?t(!0):t(r===""?!1:gr(e))}_P.VALIDATOR_TYPE=IRe;var MRe=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],xRe="time";function OP(e,t){var r=this.timeFormat||"h:mm:ss a",n=!0,o=e;o===null&&(o=""),o=/^\d{3,}$/.test(o)?parseInt(o,10):o;var i=/^\d{1,2}$/.test(o);i&&(o+=":00");var a=te(o,MRe,!0).isValid()?te(o):te(o,r),l=a.isValid(),s=te(o,r,!0).isValid()&&!i;if(this.allowEmpty&&o===""&&(l=!0,s=!0),l||(n=!1),!l&&s&&(n=!0),l&&!s)if(this.correctFormat===!0){var u=a.format(r),f=this.instance.toVisualRow(this.row),c=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(f,c,u,"timeValidator"),n=!0}else n=!1;t(n)}OP.VALIDATOR_TYPE=xRe;function DRe(){Vl(zm),Vl(CP),Vl(_P),Vl(OP)}var NRe="autocomplete",HRe={CELL_TYPE:NRe,editor:vP,renderer:Tf,validator:zm},LRe="checkbox",jRe={CELL_TYPE:LRe,editor:M2,renderer:pP},FRe="date",BRe={CELL_TYPE:FRe,editor:N2,renderer:Tf,validator:CP},VRe="dropdown",WRe={CELL_TYPE:VRe,editor:yP,renderer:Tf,validator:zm},URe="handsontable",zRe={CELL_TYPE:URe,editor:dP,renderer:Tf},YRe="numeric",GRe={CELL_TYPE:YRe,editor:H2,renderer:bP,validator:_P,dataType:"number"},KRe="password",qRe={CELL_TYPE:KRe,editor:L2,renderer:wP,copyable:!1},XRe="time",ZRe={CELL_TYPE:XRe,editor:j2,renderer:SP,validator:OP};function QRe(){on(HRe),on(jRe),on(BRe),on(WRe),on(zRe),on(GRe),on(qRe),on(A2),on(ZRe)}var JRe=am,e0e=RV;JRe("WeakSet",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},e0e);function zh(e){"@babel/helpers - typeof";return zh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zh(e)}function t0e(e,t){return i0e(e)||o0e(e,t)||n0e(e,t)||r0e()}function r0e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function n0e(e,t){if(e){if(typeof e=="string")return vx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vx(e,t)}}function vx(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function o0e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function i0e(e){if(Array.isArray(e))return e}function a0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,s0e(n.key),n)}}function l0e(e,t,r){return t&&yx(e.prototype,t),r&&yx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function s0e(e){var t=u0e(e,"string");return zh(t)==="symbol"?t:String(t)}function u0e(e,t){if(zh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function f0e(e,t){c0e(e,t),t.add(e)}function c0e(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function h0e(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}var gx=new Map([["plugin",Vse],["cell-type",S2],["editor",DV],["renderer",qV],["validator",XV]]),d0e="base",Vi=new WeakMap,Hw=[],On=null,px=new WeakSet,ot=function(){function e(t){var r=this;a0e(this,e),f0e(this,px),Fn(this,"hot",t,{writable:!1}),Vi.set(this,{hooks:{}}),On=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",function(){return r.onAfterPluginsInitialized()}),this.hot.addHook("afterUpdateSettings",function(n){return r.onUpdateSettings(n)}),this.hot.addHook("beforeInit",function(){return r.init()})}return l0e(e,[{key:"init",value:function(){var r=this;this.pluginName=this.hot.getPluginName(this);var n=this.constructor.PLUGIN_DEPS,o=Array.isArray(n)?n:[];if(o.length>0){var i=[];if(o.forEach(function(u){var f=u.split(":"),c=t0e(f,2),h=c[0],d=c[1];if(!gx.has(h))throw new Error('Unknown plugin dependency type "'.concat(h,'" was found.'));gx.get(h)(d)||i.push(" - ".concat(d," (").concat(h,")"))}),i.length>0){var a=["The ".concat(this.pluginName,` plugin requires the following modules:
`),"".concat(i.join(`
`),`
`)].join("");Hw.push(a)}}On||(On=wE()),On.indexOf("UndoRedo")>=0&&On.splice(On.indexOf("UndoRedo"),1),On.indexOf(this.pluginName)>=0&&On.splice(On.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",function(){r.isEnabled&&r.isEnabled()&&r.enablePlugin()});var l=On.length===0;if(l){if(Hw.length>0){var s=["".concat(Hw.join(`
`),`
`),"You have to import and register them manually."].join("");throw new Error(s)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}},{key:"enablePlugin",value:function(){this.enabled=!0}},{key:"disablePlugin",value:function(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}},{key:"addHook",value:function(r,n){Vi.get(this).hooks[r]=Vi.get(this).hooks[r]||[];var o=Vi.get(this).hooks[r];this.hot.addHook(r,n),o.push(n),Vi.get(this).hooks[r]=o}},{key:"removeHooks",value:function(r){var n=this;$(Vi.get(this).hooks[r]||[],function(o){n.hot.removeHook(r,o)})}},{key:"clearHooks",value:function(){var r=this,n=Vi.get(this).hooks;We(n,function(o,i){return r.removeHooks(i)}),n.length=0}},{key:"callOnPluginsReady",value:function(r){this.isPluginsReady?r():this.pluginsInitializedCallbacks.push(r)}},{key:"onAfterPluginsInitialized",value:function(){$(this.pluginsInitializedCallbacks,function(r){return r()}),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}},{key:"onUpdateSettings",value:function(r){var n=h0e(this,px,v0e).call(this,r);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(r))}},{key:"updatePlugin",value:function(){}},{key:"destroy",value:function(){var r=this;this.eventManager&&this.eventManager.destroy(),this.clearHooks(),We(this,function(n,o){o!=="hot"&&(r[o]=null)}),delete this.t,delete this.hot}}],[{key:"PLUGIN_KEY",get:function(){return d0e}},{key:"SETTING_KEYS",get:function(){return[this.PLUGIN_KEY]}}]),e}();function v0e(e){if(!e)return!1;var t=this.constructor.SETTING_KEYS;if(typeof t=="boolean")return t;for(var r=0;r<t.length;r++)if(e[t[r]]!==void 0)return!0;return!1}function Yh(e){"@babel/helpers - typeof";return Yh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yh(e)}function y0e(e,t){return b0e(e)||m0e(e,t)||p0e(e,t)||g0e()}function g0e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function p0e(e,t){if(e){if(typeof e=="string")return mx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mx(e,t)}}function mx(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function m0e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function b0e(e){if(Array.isArray(e))return e}function w0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,C0e(n.key),n)}}function S0e(e,t,r){return t&&bx(e.prototype,t),r&&bx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function C0e(e){var t=_0e(e,"string");return Yh(t)==="symbol"?t:String(t)}function _0e(e,t){if(Yh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Yh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var O0e=function(){function e(t){w0e(this,e),this.hot=t,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}return S0e(e,[{key:"addRow",value:function(r,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var o={row:r};this.rows.push(o),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(r)),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}},{key:"addColumnHeadersRow",value:function(r){var n=this.hot.getColHeader(0);if(n!=null){var o={row:-1};this.rows.push(o),this.container=this.createContainer(this.hot.rootElement.className),this.samples=r,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}}},{key:"addColumn",value:function(r,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var o={col:r};this.columns.push(o),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(r)!==null&&this.hot.view.appendColHeader(r,this.table.th),this.table.tBody.appendChild(this.createCol(r)),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}},{key:"getHeights",value:function(r){this.injected||this.injectTable(),$(this.rows,function(n){r(n.row,Rt(n.table)-1)})}},{key:"getWidths",value:function(r){this.injected||this.injectTable(),$(this.columns,function(n){var o=n.table.getBoundingClientRect(),i=o.width;r(n.col,Math.ceil(i))})}},{key:"setSettings",value:function(r){this.settings=r}},{key:"setSetting",value:function(r,n){this.settings||(this.settings={}),this.settings[r]=n}},{key:"getSettings",value:function(){return this.settings}},{key:"getSetting",value:function(r){return this.settings?this.settings[r]:null}},{key:"createColGroupsCol",value:function(){var r=this,n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1)),this.samples.forEach(function(o){$(o.strings,function(i){n.appendChild(r.createColElement(i.col))})}),n}},{key:"createRow",value:function(r){var n=this,o=this.hot.rootDocument,i=o.createDocumentFragment(),a=o.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(r,a),i.appendChild(a)),this.samples.forEach(function(l){$(l.strings,function(s){var u=s.col,f=n.hot.getCellMeta(r,u);f.col=u,f.row=r;var c=n.hot.getCellRenderer(f),h=o.createElement("td");h.setAttribute("ghost-table",1),c(n.hot,h,r,u,n.hot.colToProp(u),s.value,f),i.appendChild(h)})}),i}},{key:"appendColumnHeadersRow",value:function(){var r=this,n=this.hot.rootDocument,o=n.createDocumentFragment(),i=[];if(this.hot.hasRowHeaders()){var a=n.createElement("th");i.push([-1,a]),o.appendChild(a)}this.samples.forEach(function(l){$(l.strings,function(s){var u=s.col,f=n.createElement("th");i.push([u,f]),o.appendChild(f)})}),this.table.tHead.appendChild(o),$(i,function(l){var s=y0e(l,2),u=s[0],f=s[1];r.hot.view.appendColHeader(u,f)})}},{key:"createCol",value:function(r){var n=this,o=this.hot.rootDocument,i=o.createDocumentFragment();return this.samples.forEach(function(a){$(a.strings,function(l){var s=l.row,u=n.hot.getCellMeta(s,r);u.col=r,u.row=s;var f=n.hot.getCellRenderer(u),c=o.createElement("td"),h=o.createElement("tr");c.setAttribute("ghost-table",1),f(n.hot,c,s,r,n.hot.colToProp(r),l.value,u),h.appendChild(c),i.appendChild(h)})}),i}},{key:"clean",value:function(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}},{key:"injectTable",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((r||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}},{key:"removeTable",value:function(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}},{key:"createColElement",value:function(r){var n=this.hot.rootDocument.createElement("col");return n.style.width="".concat(this.hot.view._wt.wtTable.getStretchedColumnWidth(r),"px"),n}},{key:"createTable",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=this.hot.rootDocument,o=n.createDocumentFragment(),i=n.createElement("table"),a=n.createElement("thead"),l=n.createElement("tbody"),s=n.createElement("colgroup"),u=n.createElement("tr"),f=n.createElement("th");return this.isVertical()&&i.appendChild(s),this.isHorizontal()&&(u.appendChild(f),a.appendChild(u),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(a),this.isVertical()&&l.appendChild(u),i.appendChild(l),re(i,r),o.appendChild(i),{fragment:o,table:i,tHead:a,tBody:l,colGroup:s,tr:u,th:f}}},{key:"createContainer",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=this.hot.rootDocument,o=n.createDocumentFragment(),i=n.createElement("div"),a="htGhostTable htAutoSize ".concat(r.trim());return re(i,a),o.appendChild(i),{fragment:o,container:i}}},{key:"isVertical",value:function(){return!!(this.rows.length&&!this.columns.length)}},{key:"isHorizontal",value:function(){return!!(this.columns.length&&!this.rows.length)}}]),e}();const RP=O0e;function Gh(e){"@babel/helpers - typeof";return Gh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gh(e)}function R0e(e,t,r){return t=W2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function E0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,W2(n.key),n)}}function T0e(e,t,r){return t&&wx(e.prototype,t),r&&wx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function W2(e){var t=P0e(e,"string");return Gh(t)==="symbol"?t:String(t)}function P0e(e,t){if(Gh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var k0e=function(){function e(t){E0e(this,e),this.samples=null,this.dataFactory=t,this.customSampleCount=null,this.allowDuplicates=!1}return T0e(e,[{key:"getSampleCount",value:function(){return this.customSampleCount?this.customSampleCount:e.SAMPLE_COUNT}},{key:"setSampleCount",value:function(r){this.customSampleCount=r}},{key:"setAllowDuplicates",value:function(r){this.allowDuplicates=r}},{key:"generateRowSamples",value:function(r,n){return this.generateSamples("row",n,r)}},{key:"generateColumnSamples",value:function(r,n){return this.generateSamples("col",n,r)}},{key:"generateSamples",value:function(r,n,o){var i=this,a=new Map,l=typeof o=="number"?{from:o,to:o}:o,s=l.from,u=l.to;return _e(s,u,function(f){var c=i.generateSample(r,n,f);a.set(f,c)}),a}},{key:"generateSample",value:function(r,n,o){var i=this;if(r!=="row"&&r!=="col")throw new Error("Unsupported sample type");var a=new Map,l=r==="row"?"col":"row",s=[];return _e(n.from,n.to,function(u){var f=r==="row"?i.dataFactory(o,u):i.dataFactory(u,o),c=f.value,h=f.bundleSeed,d=typeof h=="string"&&h.length>0,v;d?v=h:Ve(c)?v="".concat(Object.keys(c).length):Array.isArray(c)?v="".concat(c.length):v="".concat(It(c).length),a.has(v)||a.set(v,{needed:i.getSampleCount(),strings:[]});var g=a.get(v);if(g.needed){var m=s.indexOf(c)>-1;(!m||i.allowDuplicates||d)&&(g.strings.push(R0e({value:c},l,u)),s.push(c),g.needed-=1)}}),a}}],[{key:"SAMPLE_COUNT",get:function(){return 3}}]),e}();const U2=k0e;function iu(e){"@babel/helpers - typeof";return iu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},iu(e)}function Sx(e,t){return M0e(e)||I0e(e,t)||A0e(e,t)||$0e()}function $0e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function A0e(e,t){if(e){if(typeof e=="string")return Cx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Cx(e,t)}}function Cx(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function I0e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function M0e(e){if(Array.isArray(e))return e}function x0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _x(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,N0e(n.key),n)}}function D0e(e,t,r){return t&&_x(e.prototype,t),r&&_x(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function N0e(e){var t=H0e(e,"string");return iu(t)==="symbol"?t:String(t)}function H0e(e,t){if(iu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(iu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ra(){return typeof Reflect<"u"&&Reflect.get?ra=Reflect.get.bind():ra=function(t,r,n){var o=L0e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ra.apply(this,arguments)}function L0e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=so(e),e!==null););return e}function j0e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lO(e,t)}function lO(e,t){return lO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},lO(e,t)}function F0e(e){var t=V0e();return function(){var n=so(e),o;if(t){var i=so(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return B0e(this,o)}}function B0e(e,t){if(t&&(iu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return z2(e)}function z2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function V0e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function so(e){return so=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},so(e)}pe.getSingleton().register("modifyAutoColumnSizeSeed");var zf="autoColumnSize",W0e=10,Lw=new WeakMap,U0e="autoColumnSize",z0e=function(e){j0e(r,e);var t=F0e(r);function r(n){var o;return x0e(this,r),o=t.call(this,n),Lw.set(z2(o),{cachedColumnHeaders:[]}),o.ghostTable=new RP(o.hot),o.samplesGenerator=new U2(function(i,a){var l=o.hot.getCellMeta(i,a),s="";l.spanned||(s=o.hot.getDataAtCell(i,a));var u="";return o.hot.hasHook("modifyAutoColumnSizeSeed")&&(u=o.hot.runHooks("modifyAutoColumnSizeSeed",u,l,s)),{value:s,bundleSeed:u}}),o.firstCalculation=!0,o.inProgress=!1,o.measuredColumns=0,o.columnWidthsMap=new Ai,o.hot.columnIndexMapper.registerMap(U0e,o.columnWidthsMap),o.addHook("beforeColumnResize",function(i,a,l){return o.onBeforeColumnResize(i,a,l)}),o}return D0e(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[zf]!==!1&&!this.hot.getSettings().colWidths}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[zf];i&&i.useHeaders!==null&&i.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",i.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("beforeChangeRender",function(a){return o.onBeforeChange(a)}),this.addHook("afterFormulasValuesUpdate",function(a){return o.onAfterFormulasValuesUpdate(a)}),this.addHook("beforeViewRender",function(a){return o.onBeforeViewRender(a)}),this.addHook("modifyColWidth",function(a,l){return o.getColumnWidth(l,a)}),this.addHook("afterInit",function(){return o.onAfterInit()}),ra(so(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var o=this.findColumnsWhereHeaderWasChanged();o.length&&(this.clearCache(o),this.calculateVisibleColumnsWidth()),ra(so(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var o=this;ra(so(r.prototype),"disablePlugin",this).call(this),this.addHook("beforeColumnResize",function(i,a,l){return o.onBeforeColumnResize(i,a,l)})}},{key:"calculateVisibleColumnsWidth",value:function(){var o=this.hot.countRows();if(o){var i=this.hot.renderCall,a=this.getFirstVisibleColumn(),l=this.getLastVisibleColumn();a===-1||l===-1||this.calculateColumnsWidth({from:a,to:l},void 0,i)}}},{key:"calculateColumnsWidth",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=typeof i=="number"?{from:i,to:i}:i,u=typeof a=="number"?{from:a,to:a}:a;_e(s.from,s.to,function(f){var c=o.hot.toPhysicalColumn(f);if(c===null&&(c=f),l||o.columnWidthsMap.getValueAtIndex(c)===null&&!o.hot._getColWidthFromSettings(c)){var h=o.samplesGenerator.generateColumnSamples(f,u);$(h,function(d){var v=Sx(d,2),g=v[0],m=v[1];return o.ghostTable.addColumn(g,m)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(function(){o.ghostTable.getWidths(function(f,c){var h=o.hot.toPhysicalColumn(f);o.columnWidthsMap.setValueAtIndex(h,c)})},!0),this.measuredColumns=s.to+1,this.ghostTable.clean())}},{key:"calculateAllColumnsWidth",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},a=0,l=this.hot.countCols()-1,s=null;this.inProgress=!0;var u=function c(){if(!o.hot){Mc(s),o.inProgress=!1;return}o.calculateColumnsWidth({from:a,to:Math.min(a+r.CALCULATION_STEP,l)},i),a=a+r.CALCULATION_STEP+1,a<l?s=dm(c):(Mc(s),o.inProgress=!1,o.hot.view.adjustElementsSize())},f=this.getSyncCalculationLimit();this.firstCalculation&&f>=0&&(this.calculateColumnsWidth({from:0,to:f},i),this.firstCalculation=!1,a=f+1),a<l?u():this.inProgress=!1}},{key:"setSamplingOptions",value:function(){var o=this.hot.getSettings()[zf],i=o&&At(o,"samplingRatio")?o.samplingRatio:void 0,a=o&&At(o,"allowSampleDuplicates")?o.allowSampleDuplicates:void 0;i&&!isNaN(i)&&this.samplesGenerator.setSampleCount(parseInt(i,10)),a&&this.samplesGenerator.setAllowDuplicates(a)}},{key:"recalculateAllColumnsWidth",value:function(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}},{key:"getSyncCalculationLimit",value:function(){var o=this.hot.getSettings()[zf],i=r.SYNC_CALCULATION_LIMIT,a=this.hot.countCols()-1;return Ve(o)&&(i=o.syncLimit,uE(i)?i=mE(a,i):i>>=0),Math.min(i,a)}},{key:"getColumnWidth",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=i;return l===void 0&&(l=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(o)),a&&typeof l=="number"&&(l=Math.max(l,CE.DEFAULT_WIDTH))),l}},{key:"getFirstVisibleColumn",value:function(){var o=this.hot.view._wt;if(o.wtViewport.columnsVisibleCalculator){var i=o.wtTable.getFirstVisibleColumn();if(i!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)}if(o.wtViewport.columnsRenderCalculator){var a=o.wtTable.getFirstRenderedColumn();if(a!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(a)}return-1}},{key:"getLastVisibleColumn",value:function(){var o=this.hot.view._wt;if(o.wtViewport.columnsVisibleCalculator){var i=o.wtTable.getLastVisibleColumn();if(i!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)}if(o.wtViewport.columnsRenderCalculator){var a=o.wtTable.getLastRenderedColumn();if(a!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(a)}return-1}},{key:"findColumnsWhereHeaderWasChanged",value:function(){var o=this.hot.getColHeader(),i=Lw.get(this),a=i.cachedColumnHeaders,l=Lt(o,function(s,u,f){var c=a.length;return(c-1<f||a[f]!==u)&&s.push(f),c-1<f?a.push(u):a[f]=u,s},[]);return l}},{key:"clearCache",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];i.length?this.hot.batchExecution(function(){$(i,function(a){o.columnWidthsMap.setValueAtIndex(a,null)})},!0):this.columnWidthsMap.clear()}},{key:"isNeedRecalculate",value:function(){return!!jr(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),function(o){return o===null}).length}},{key:"onBeforeViewRender",value:function(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}},{key:"onAfterLoadData",value:function(){var o=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout(function(){o.hot&&o.recalculateAllColumnsWidth()},0)}},{key:"onBeforeChange",value:function(o){var i=this,a=Be(o,function(l){var s=Sx(l,2),u=s[1];return i.hot.toPhysicalColumn(i.hot.propToCol(u))});this.clearCache(Array.from(new Set(a)))}},{key:"onBeforeColumnResize",value:function(o,i,a){var l=o;return a&&(this.calculateColumnsWidth(i,void 0,!0),l=this.getColumnWidth(i,void 0,!1)),l}},{key:"onAfterInit",value:function(){Lw.get(this).cachedColumnHeaders=this.hot.getColHeader()}},{key:"onAfterFormulasValuesUpdate",value:function(o){var i=jr(o,function(l){var s;return ve((s=l.address)===null||s===void 0?void 0:s.col)}),a=Be(i,function(l){return l.address.col});this.clearCache(Array.from(new Set(a)))}},{key:"destroy",value:function(){this.ghostTable.clean(),ra(so(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return zf}},{key:"PLUGIN_PRIORITY",get:function(){return W0e}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 50}}]),r}(ot),na={horizontal:"horizontal",vertical:"vertical"};function Y0e(e,t,r,n){var o=r.length,i=r?r[0].length:0,a=[],l=t.row-e.row,s=t.col-e.col;if(["down","up"].indexOf(n)!==-1){for(var u=[],f=0;f<s;f++){var c=parseInt(r[0][f],10),h=parseInt(r[o-1][f],10),d=(n==="down"?h-c:c-h)/(o-1)||0;u.push(d)}a.push(u)}if(["right","left"].indexOf(n)!==-1)for(var v=0;v<l;v++){var g=parseInt(r[v][0],10),m=parseInt(r[v][i-1],10),w=(n==="right"?m-g:g-m)/(i-1)||0;a.push([w])}return a}function G0e(e,t,r){var n,o,i;return t[0]===e[0]&&t[1]<e[1]?(i="left",n=r(t[0],t[1]),o=r(t[2],e[1]-1)):t[2]===e[2]&&t[0]===e[0]&&t[3]>e[3]?(i="right",n=r(t[0],e[3]+1),o=r(t[2],t[3])):t[0]<e[0]&&t[1]===e[1]?(i="up",n=r(t[0],t[1]),o=r(e[0]-1,t[3])):t[2]>e[2]&&t[1]===e[1]&&(i="down",n=r(e[2]+1,t[1]),o=r(t[2],t[3])),n&&n.normalize(),o&&o.normalize(),{directionOfDrag:i,startOfDragCoords:n,endOfDragCoords:o}}function K0e(e){var t={};return e===!0?(t.directions=Object.keys(na),t.autoInsertRow=!0):Ve(e)?(ve(e.autoInsertRow)?e.direction===na.horizontal?t.autoInsertRow=!1:t.autoInsertRow=e.autoInsertRow:t.autoInsertRow=!1,ve(e.direction)?t.directions=[e.direction]:t.directions=Object.keys(na)):typeof e=="string"?(t.directions=[e],t.autoInsertRow=!0):(t.directions=[],t.autoInsertRow=!1),t}function au(e){"@babel/helpers - typeof";return au=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},au(e)}function q0e(e){return Q0e(e)||Z0e(e)||Y2(e)||X0e()}function X0e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Z0e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Q0e(e){if(Array.isArray(e))return sO(e)}function J0e(e,t){return rEe(e)||tEe(e,t)||Y2(e,t)||eEe()}function eEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Y2(e,t){if(e){if(typeof e=="string")return sO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return sO(e,t)}}function sO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function tEe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function rEe(e){if(Array.isArray(e))return e}function nEe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ox(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,iEe(n.key),n)}}function oEe(e,t,r){return t&&Ox(e.prototype,t),r&&Ox(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function iEe(e){var t=aEe(e,"string");return au(t)==="symbol"?t:String(t)}function aEe(e,t){if(au(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(au(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function oa(){return typeof Reflect<"u"&&Reflect.get?oa=Reflect.get.bind():oa=function(t,r,n){var o=lEe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},oa.apply(this,arguments)}function lEe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=uo(e),e!==null););return e}function sEe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&uO(e,t)}function uO(e,t){return uO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},uO(e,t)}function uEe(e){var t=cEe();return function(){var n=uo(e),o;if(t){var i=uo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return fEe(this,o)}}function fEe(e,t){if(t&&(au(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return G2(e)}function G2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cEe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function uo(e){return uo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},uo(e)}pe.getSingleton().register("modifyAutofillRange");pe.getSingleton().register("beforeAutofill");pe.getSingleton().register("afterAutofill");var Rx="autofill",hEe=20,dEe=["fillHandle"],vEe="insert_row_below",yEe=200,gEe=function(e){sEe(r,e);var t=uEe(r);function r(n){var o;return nEe(this,r),o=t.call(this,n),o.eventManager=new Tt(G2(o)),o.addingStarted=!1,o.mouseDownOnCellCorner=!1,o.mouseDragOutside=!1,o.handleDraggedCells=0,o.directions=[],o.autoInsertRow=!1,o}return oEe(r,[{key:"isEnabled",value:function(){return this.hot.getSettings().fillHandle}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",function(i){return o.onAfterCellCornerMouseDown(i)}),this.addHook("afterOnCellCornerDblClick",function(i){return o.onCellCornerDblClick(i)}),this.addHook("beforeOnCellMouseOver",function(i,a){return o.onBeforeCellMouseOver(a)}),oa(uo(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),oa(uo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.clearMappedSettings(),oa(uo(r.prototype),"disablePlugin",this).call(this)}},{key:"getSelectionData",value:function(){var o=this,i=this.hot.getSelectedRangeLast(),a=i.getTopStartCorner(),l=a.row,s=a.col,u=i.getBottomEndCorner(),f=u.row,c=u.col,h=this.hot.runHooks("modifyCopyableRange",[{startRow:l,startCol:s,endRow:f,endCol:c}]),d=[],v=[],g=[];return $(h,function(m){for(var w=m.startRow;w<=m.endRow;w+=1)d.indexOf(w)===-1&&d.push(w);for(var S=m.startCol;S<=m.endCol;S+=1)v.indexOf(S)===-1&&v.push(S)}),$(d,function(m){var w=[];$(v,function(S){w.push(o.hot.getCopyableData(m,S))}),g.push(w)}),g}},{key:"fillIn",value:function(){var o=this;if(this.hot.selection.highlight.getFill().isEmpty())return!1;var i=this.hot.selection.highlight.getFill().getVisualCorners(),a=J0e(i,4),l=a[0],s=a[1],u=a[2],f=a[3],c=this.hot.getSelectedRangeLast(),h=c.getTopStartCorner(),d=c.getBottomEndCorner();this.resetSelectionOfDraggedArea();var v=[h.row,h.col,d.row,d.col],g=this.hot.runHooks("modifyAutofillRange",[Math.min(h.row,l),Math.min(h.col,s),Math.max(d.row,u),Math.max(d.col,f)],v),m=G0e(v,g,function(k,y){return o.hot._createCellCoords(k,y)}),w=m.directionOfDrag,S=m.startOfDragCoords,C=m.endOfDragCoords;if(S&&S.row>-1&&S.col>-1){var P=this.getSelectionData(),R=c.clone(),V=this.hot._createCellRange(S,S,C),U=this.hot.runHooks("beforeAutofill",P,R,V,w);if(U===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;var X=Y0e(S,C,P,w),Y=U,q=U;if(["up","left"].indexOf(w)>-1&&!(q.length===1&&q[0].length===0))if(Y=[],w==="up")for(var Z=C.row-S.row+1,ie=Z%q.length,Q=0;Q<Z;Q++)Y.push(q[(Q+(q.length-ie))%q.length]);else for(var le=C.col-S.col+1,Se=le%q[0].length,me=0;me<q.length;me++){Y.push([]);for(var Ce=0;Ce<le;Ce++)Y[me].push(q[me][(Ce+(q[me].length-Se))%q[me].length])}this.hot.populateFromArray(S.row,S.col,Y,C.row,C.col,"".concat(this.pluginName,".fill"),null,w,X),this.setSelection(g),this.hot.runHooks("afterAutofill",Y,R,V,w),this.hot.render()}else this.hot._refreshBorders();return!0}},{key:"reduceSelectionAreaIfNeeded",value:function(o){return o.row<0&&(o.row=0),o.col<0&&(o.col=0),o}},{key:"getCoordsOfDragAndDropBorders",value:function(o){var i=this.hot.getSelectedRangeLast(),a=i.getBottomEndCorner(),l=o;if(this.directions.includes(na.vertical)&&this.directions.includes(na.horizontal)){var s=i.getTopStartCorner();(a.col<=o.col||s.col>=o.col)&&(l=this.hot._createCellCoords(a.row,o.col)),(a.row<o.row||s.row>o.row)&&(l=this.hot._createCellCoords(o.row,a.col))}else if(this.directions.includes(na.vertical))l=this.hot._createCellCoords(o.row,a.col);else if(this.directions.includes(na.horizontal))l=this.hot._createCellCoords(a.row,o.col);else return;return this.reduceSelectionAreaIfNeeded(l)}},{key:"showBorder",value:function(o){var i=this.getCoordsOfDragAndDropBorders(o);i&&this.redrawBorders(i)}},{key:"addRow",value:function(){var o=this;this.hot._registerTimeout(function(){o.hot.alter(vEe,void 0,1,"".concat(o.pluginName,".fill")),o.addingStarted=!1},yEe)}},{key:"addNewRowIfNeeded",value:function(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){var o=this.hot.getSelectedLast(),i=this.hot.selection.highlight.getFill().getVisualCorners(),a=this.hot.countRows();o[2]<a-1&&i[2]===a-1&&(this.addingStarted=!0,this.addRow())}}},{key:"getIndexOfLastAdjacentFilledInRow",value:function(o){for(var i=this.hot.getData(),a=this.hot.countRows(),l,s=o[2]+1;s<a;s++){for(var u=o[1];u<=o[3];u++){var f=i[s][u];if(f)return-1}var c=i[s][o[1]-1],h=i[s][o[3]+1];(c||h)&&(l=s)}return l}},{key:"addSelectionFromStartAreaToSpecificRowIndex",value:function(o,i){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(o[0],o[1])).add(this.hot._createCellCoords(i,o[3])).commit()}},{key:"setSelection",value:function(o){var i;(i=this.hot).selectCell.apply(i,q0e(Be(o,function(a){return Math.max(a,0)})).concat([!1,!1]))}},{key:"selectAdjacent",value:function(){var o=this.hot.getSelectedLast(),i=this.getIndexOfLastAdjacentFilledInRow(o);return i===-1||i===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(o,i),!0)}},{key:"resetSelectionOfDraggedArea",value:function(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}},{key:"redrawBorders",value:function(o){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(o).commit(),this.hot.view.render()}},{key:"getIfMouseWasDraggedOutside",value:function(o){var i=this.hot.rootDocument.documentElement,a=Vt(this.hot.table).top-(this.hot.rootWindow.pageYOffset||i.scrollTop)+Rt(this.hot.table),l=Vt(this.hot.table).left-(this.hot.rootWindow.pageXOffset||i.scrollLeft)+dt(this.hot.table);return o.clientY>a&&o.clientX<=l}},{key:"registerEvents",value:function(){var o=this,i=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()}),this.eventManager.addEventListener(i,"mousemove",function(a){return o.onMouseMove(a)})}},{key:"onCellCornerDblClick",value:function(){var o=this.selectAdjacent();o&&this.fillIn()}},{key:"onAfterCellCornerMouseDown",value:function(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}},{key:"onBeforeCellMouseOver",value:function(o){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(o),this.addNewRowIfNeeded())}},{key:"onMouseUp",value:function(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}},{key:"onMouseMove",value:function(o){var i=this.getIfMouseWasDraggedOutside(o);this.addingStarted===!1&&this.handleDraggedCells>0&&i?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}},{key:"clearMappedSettings",value:function(){this.directions.length=0,this.autoInsertRow=!1}},{key:"mapSettings",value:function(){var o=K0e(this.hot.getSettings().fillHandle);this.directions=o.directions,this.autoInsertRow=o.autoInsertRow}},{key:"destroy",value:function(){oa(uo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Rx}},{key:"PLUGIN_PRIORITY",get:function(){return hEe}},{key:"SETTING_KEYS",get:function(){return[Rx].concat(dEe)}}]),r}(ot);function lu(e){"@babel/helpers - typeof";return lu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lu(e)}function pEe(e,t){return SEe(e)||wEe(e,t)||bEe(e,t)||mEe()}function mEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bEe(e,t){if(e){if(typeof e=="string")return Ex(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ex(e,t)}}function Ex(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function wEe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function SEe(e){if(Array.isArray(e))return e}function CEe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Tx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,OEe(n.key),n)}}function _Ee(e,t,r){return t&&Tx(e.prototype,t),r&&Tx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function OEe(e){var t=REe(e,"string");return lu(t)==="symbol"?t:String(t)}function REe(e,t){if(lu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ql(){return typeof Reflect<"u"&&Reflect.get?ql=Reflect.get.bind():ql=function(t,r,n){var o=EEe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ql.apply(this,arguments)}function EEe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=vi(e),e!==null););return e}function TEe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fO(e,t)}function fO(e,t){return fO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},fO(e,t)}function PEe(e){var t=AEe();return function(){var n=vi(e),o;if(t){var i=vi(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return kEe(this,o)}}function kEe(e,t){if(t&&(lu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $Ee(e)}function $Ee(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function AEe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vi(e){return vi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vi(e)}var fy="autoRowSize",IEe=40,MEe="autoRowSize",xEe=function(e){TEe(r,e);var t=PEe(r);function r(n){var o;return CEe(this,r),o=t.call(this,n),o.rowHeightsMap=void 0,o.headerHeight=null,o.ghostTable=new RP(o.hot),o.samplesGenerator=new U2(function(i,a){var l;return i>=0?l=o.hot.getDataAtCell(i,a):i===-1&&(l=o.hot.getColHeader(a)),{value:l}}),o.firstCalculation=!0,o.inProgress=!1,o.measuredRows=0,o.rowHeightsMap=new Ai,o.hot.rowIndexMapper.registerMap(MEe,o.rowHeightsMap),o.addHook("beforeRowResize",function(i,a,l){return o.onBeforeRowResize(i,a,l)}),o}return _Ee(r,[{key:"isEnabled",value:function(){var o=this.hot.getSettings()[fy];return o===!0||Ve(o)}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("beforeChangeRender",function(i){return o.onBeforeChange(i)}),this.addHook("beforeColumnResize",function(){return o.recalculateAllRowsHeight()}),this.addHook("beforeViewRender",function(i){return o.onBeforeViewRender(i)}),this.addHook("modifyRowHeight",function(i,a){return o.getRowHeight(a,i)}),this.addHook("modifyColumnHeaderHeight",function(){return o.getColumnHeaderHeight()}),ql(vi(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var o=this;this.headerHeight=null,ql(vi(r.prototype),"disablePlugin",this).call(this),this.addHook("beforeRowResize",function(i,a,l){return o.onBeforeRowResize(i,a,l)})}},{key:"calculateRowsHeight",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=typeof i=="number"?{from:i,to:i}:i,u=typeof a=="number"?{from:a,to:a}:a;if(this.hot.getColHeader(0)!==null){var f=this.samplesGenerator.generateRowSamples(-1,u);this.ghostTable.addColumnHeadersRow(f.get(-1))}_e(s.from,s.to,function(c){if(l||o.rowHeightsMap.getValueAtIndex(c)===null){var h=o.samplesGenerator.generateRowSamples(c,u);$(h,function(d){var v=pEe(d,2),g=v[0],m=v[1];return o.ghostTable.addRow(g,m)})}}),this.ghostTable.rows.length&&(this.hot.batchExecution(function(){o.ghostTable.getHeights(function(c,h){c<0?o.headerHeight=h:o.rowHeightsMap.setValueAtIndex(o.hot.toPhysicalRow(c),h)})},!0),this.measuredRows=s.to+1,this.ghostTable.clean())}},{key:"calculateAllRowsHeight",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},a=0,l=this.hot.countRows()-1,s=null;this.inProgress=!0;var u=function c(){if(!o.hot){Mc(s),o.inProgress=!1;return}o.calculateRowsHeight({from:a,to:Math.min(a+r.CALCULATION_STEP,l)},i),a=a+r.CALCULATION_STEP+1,a<l?s=dm(c):(Mc(s),o.inProgress=!1,o.hot.view.adjustElementsSize(!0),o.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&o.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},f=this.getSyncCalculationLimit();this.firstCalculation&&f>=0&&(this.calculateRowsHeight({from:0,to:f},i),this.firstCalculation=!1,a=f+1),a<l?u():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}},{key:"setSamplingOptions",value:function(){var o=this.hot.getSettings()[fy],i=o&&At(o,"samplingRatio")?o.samplingRatio:void 0,a=o&&At(o,"allowSampleDuplicates")?o.allowSampleDuplicates:void 0;i&&!isNaN(i)&&this.samplesGenerator.setSampleCount(parseInt(i,10)),a&&this.samplesGenerator.setAllowDuplicates(a)}},{key:"recalculateAllRowsHeight",value:function(){us(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}},{key:"getSyncCalculationLimit",value:function(){var o=this.hot.getSettings()[fy],i=r.SYNC_CALCULATION_LIMIT,a=this.hot.countRows()-1;return Ve(o)&&(i=o.syncLimit,uE(i)?i=mE(a,i):i>>=0),Math.min(i,a)}},{key:"getRowHeight",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,a=o<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(o)),l=i;return a!==null&&a>(i||0)&&(l=a),l}},{key:"getColumnHeaderHeight",value:function(){return this.headerHeight}},{key:"getFirstVisibleRow",value:function(){var o=this.hot.view._wt;return o.wtViewport.rowsVisibleCalculator?o.wtTable.getFirstVisibleRow():o.wtViewport.rowsRenderCalculator?o.wtTable.getFirstRenderedRow():-1}},{key:"getLastVisibleRow",value:function(){var o=this.hot.view._wt;return o.wtViewport.rowsVisibleCalculator?o.wtTable.getLastVisibleRow():o.wtViewport.rowsRenderCalculator?o.wtTable.getLastRenderedRow():-1}},{key:"clearCache",value:function(){this.headerHeight=null,this.rowHeightsMap.init()}},{key:"clearCacheByRange",value:function(o){var i=this,a=typeof o=="number"?{from:o,to:o}:o,l=a.from,s=a.to;this.hot.batchExecution(function(){_e(Math.min(l,s),Math.max(l,s),function(u){i.rowHeightsMap.setValueAtIndex(u,null)})},!0)}},{key:"isNeedRecalculate",value:function(){return!!jr(this.rowHeightsMap.getValues().slice(0,this.measuredRows),function(o){return o===null}).length}},{key:"onBeforeViewRender",value:function(){var o=this.hot.renderCall,i=this.hot.getSettings().fixedRowsBottom,a=this.getFirstVisibleRow(),l=this.getLastVisibleRow();if(!(a===-1||l===-1)){if(this.calculateRowsHeight({from:a,to:l},void 0,o),i){var s=this.hot.countRows()-1;this.calculateRowsHeight({from:s-i,to:s})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}},{key:"onBeforeRowMove",value:function(o,i){this.clearCacheByRange({from:o,to:i}),this.calculateAllRowsHeight()}},{key:"onBeforeRowResize",value:function(o,i,a){var l=o;return a&&(this.calculateRowsHeight(i,void 0,!0),l=this.getRowHeight(i)),l}},{key:"onAfterLoadData",value:function(){var o=this;this.hot.view?this.recalculateAllRowsHeight():setTimeout(function(){o.hot&&o.recalculateAllRowsHeight()},0)}},{key:"onBeforeChange",value:function(o){var i=null;o.length===1?i=o[0][0]:o.length>1&&(i={from:o[0][0],to:o[o.length-1][0]}),i!==null&&this.clearCacheByRange(i)}},{key:"destroy",value:function(){this.ghostTable.clean(),ql(vi(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return fy}},{key:"PLUGIN_PRIORITY",get:function(){return IEe}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 500}}]),r}(ot);function su(e){"@babel/helpers - typeof";return su=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},su(e)}function DEe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Px(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,HEe(n.key),n)}}function NEe(e,t,r){return t&&Px(e.prototype,t),r&&Px(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function HEe(e){var t=LEe(e,"string");return su(t)==="symbol"?t:String(t)}function LEe(e,t){if(su(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(su(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Rc(){return typeof Reflect<"u"&&Reflect.get?Rc=Reflect.get.bind():Rc=function(t,r,n){var o=jEe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Rc.apply(this,arguments)}function jEe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Va(e),e!==null););return e}function FEe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&cO(e,t)}function cO(e,t){return cO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},cO(e,t)}function BEe(e){var t=UEe();return function(){var n=Va(e),o;if(t){var i=Va(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return VEe(this,o)}}function VEe(e,t){if(t&&(su(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return WEe(e)}function WEe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function UEe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Va(e){return Va=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Va(e)}var K2=QW("physicallyIndexed"),zEe=K2.getListWithInsertedItems,YEe=K2.getListWithRemovedItems,GEe=function(e){FEe(r,e);var t=BEe(r);function r(){return DEe(this,r),t.call(this,function(n){return n})}return NEe(r,[{key:"insert",value:function(o,i){var a=FE(this.indexedValues,i);this.indexedValues=zEe(a,o,i,this.initValueOrFn),Rc(Va(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){var i=YEe(this.indexedValues,o);this.indexedValues=jE(i,o),Rc(Va(r.prototype),"remove",this).call(this,o)}}]),r}(rl);const KEe=GEe;function uu(e){"@babel/helpers - typeof";return uu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uu(e)}function qEe(e){return JEe(e)||QEe(e)||ZEe(e)||XEe()}function XEe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ZEe(e,t){if(e){if(typeof e=="string")return hO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hO(e,t)}}function QEe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function JEe(e){if(Array.isArray(e))return hO(e)}function hO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function eTe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rTe(n.key),n)}}function tTe(e,t,r){return t&&kx(e.prototype,t),r&&kx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rTe(e){var t=nTe(e,"string");return uu(t)==="symbol"?t:String(t)}function nTe(e,t){if(uu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(uu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ec(){return typeof Reflect<"u"&&Reflect.get?Ec=Reflect.get.bind():Ec=function(t,r,n){var o=oTe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ec.apply(this,arguments)}function oTe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Wa(e),e!==null););return e}function iTe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dO(e,t)}function dO(e,t){return dO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},dO(e,t)}function aTe(e){var t=uTe();return function(){var n=Wa(e),o;if(t){var i=Wa(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return lTe(this,o)}}function lTe(e,t){if(t&&(uu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sTe(e)}function sTe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uTe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Wa(e){return Wa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Wa(e)}var q2=QW("physicallyIndexed"),fTe=q2.getListWithInsertedItems,cTe=q2.getListWithRemovedItems,hTe=function(e){iTe(r,e);var t=aTe(r);function r(){return eTe(this,r),t.call(this,function(n){return n})}return tTe(r,[{key:"insert",value:function(o,i){var a=this;this.indexedValues=fTe(this.indexedValues,o,i,function(l,s){return a.getNextValue(s)}),Ec(Wa(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){this.indexedValues=cTe(this.indexedValues,o),Ec(Wa(r.prototype),"remove",this).call(this,o)}},{key:"getNextValue",value:function(o){return Math.max.apply(Math,qEe(this.getValues()))+1+o}}]),r}(rl);const dTe=hTe;function fu(e){"@babel/helpers - typeof";return fu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fu(e)}function vTe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $x(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gTe(n.key),n)}}function yTe(e,t,r){return t&&$x(e.prototype,t),r&&$x(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gTe(e){var t=pTe(e,"string");return fu(t)==="symbol"?t:String(t)}function pTe(e,t){if(fu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Xl(){return typeof Reflect<"u"&&Reflect.get?Xl=Reflect.get.bind():Xl=function(t,r,n){var o=mTe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Xl.apply(this,arguments)}function mTe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=yi(e),e!==null););return e}function bTe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vO(e,t)}function vO(e,t){return vO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},vO(e,t)}function wTe(e){var t=_Te();return function(){var n=yi(e),o;if(t){var i=yi(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return STe(this,o)}}function STe(e,t){if(t&&(fu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return CTe(e)}function CTe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _Te(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yi(e){return yi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yi(e)}var jw="bindRowsWithHeaders",OTe=210,RTe="loose",ETe=new Map([["loose",KEe],["strict",dTe]]),TTe=function(e){bTe(r,e);var t=wTe(r);function r(n){var o;return vTe(this,r),o=t.call(this,n),o.headerIndexes=null,o}return yTe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[jw]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[jw];typeof i!="string"&&(i=RTe);var a=ETe.get(i);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new a),this.addHook("modifyRowHeader",function(l){return o.onModifyRowHeader(l)}),Xl(yi(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),Xl(yi(r.prototype),"disablePlugin",this).call(this)}},{key:"onModifyRowHeader",value:function(o){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(o))}},{key:"destroy",value:function(){Xl(yi(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return jw}},{key:"PLUGIN_PRIORITY",get:function(){return OTe}}]),r}(ot);function cu(e){"@babel/helpers - typeof";return cu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cu(e)}function Ax(e){return ATe(e)||$Te(e)||kTe(e)||PTe()}function PTe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kTe(e,t){if(e){if(typeof e=="string")return yO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yO(e,t)}}function $Te(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ATe(e){if(Array.isArray(e))return yO(e)}function yO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ITe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ix(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,X2(n.key),n)}}function MTe(e,t,r){return t&&Ix(e.prototype,t),r&&Ix(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ia(){return typeof Reflect<"u"&&Reflect.get?ia=Reflect.get.bind():ia=function(t,r,n){var o=xTe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ia.apply(this,arguments)}function xTe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=fo(e),e!==null););return e}function DTe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gO(e,t)}function gO(e,t){return gO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},gO(e,t)}function NTe(e){var t=LTe();return function(){var n=fo(e),o;if(t){var i=fo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return HTe(this,o)}}function HTe(e,t){if(t&&(cu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ll(e)}function Ll(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function LTe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fo(e){return fo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},fo(e)}function jTe(e,t,r){FTe(e,t),t.set(e,r)}function FTe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fw(e,t,r){return t=X2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function X2(e){var t=BTe(e,"string");return cu(t)==="symbol"?t:String(t)}function BTe(e,t){if(cu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Mx(e,t){var r=Z2(e,t,"get");return VTe(e,r)}function VTe(e,t){return t.get?t.get.call(e):t.value}function Bw(e,t,r){var n=Z2(e,t,"set");return WTe(e,n,r),r}function Z2(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function WTe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Vw="collapsibleColumns",UTe=290,zTe=["nestedHeaders"],pl="collapsibleIndicator",xx=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]),ml=new WeakMap,YTe=function(e){DTe(r,e);var t=NTe(r);function r(){var n;ITe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),Fw(Ll(n),"nestedHeadersPlugin",null),Fw(Ll(n),"eventManager",new Tt(Ll(n))),Fw(Ll(n),"headerStateManager",null),jTe(Ll(n),ml,{writable:!0,value:null}),n}return MTe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Vw]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings(),a=i.nestedHeaders;a||ht("You need to configure the Nested Headers plugin in order to use collapsible headers."),Bw(this,ml,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",function(){return o.onInit()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("afterGetColHeader",function(){return o.onAfterGetColHeader.apply(o,arguments)}),this.addHook("beforeOnCellMouseDown",function(l,s,u){return o.onBeforeOnCellMouseDown(l,s,u)}),ia(fo(r.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){var o=this.hot.getSettings(),i=o.collapsibleColumns;typeof i=="boolean"?this.headerStateManager.mapState(function(a){return{collapsible:a.origColspan>1}}):Array.isArray(i)&&(this.headerStateManager.mapState(function(){return{collapsible:!1}}),this.headerStateManager.mergeStateWith(i))}ia(fo(r.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Bw(this,ml,null),this.nestedHeadersPlugin=null,this.clearButtons(),ia(fo(r.prototype),"disablePlugin",this).call(this)}},{key:"clearButtons",value:function(){if(this.hot.view){var o=this.hot.view._wt.getSetting("columnHeaders").length,i=this.hot.view._wt.wtTable.THEAD,a=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,l=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,s=function(f){f&&f.parentNode.removeChild(f)};_e(0,o-1,function(u){var f=i.childNodes[u],c=a.childNodes[u],h=l?l.childNodes[u]:null;_e(0,f.childNodes.length-1,function(d){var v=f.childNodes[d].querySelector(".".concat(pl));s(v),c&&c.childNodes[d]&&(v=c.childNodes[d].querySelector(".".concat(pl)),s(v)),l&&h&&h.childNodes[d]&&(v=h.childNodes[d].querySelector(".".concat(pl)),s(v))})})}}},{key:"expandSection",value:function(o){this.toggleCollapsibleSection([o],"expand")}},{key:"collapseSection",value:function(o){this.toggleCollapsibleSection([o],"collapse")}},{key:"toggleAllCollapsibleSections",value:function(o){var i=this,a=this.headerStateManager.mapNodes(function(l){var s=l.collapsible,u=l.origColspan,f=l.headerLevel,c=l.columnIndex,h=l.isCollapsed;if(s===!0&&u>1&&(h&&o==="expand"||!h&&o==="collapse"))return{row:i.headerStateManager.levelToRowCoords(f),col:c}});this.toggleCollapsibleSection(a,o)}},{key:"collapseAll",value:function(){this.toggleAllCollapsibleSections("collapse")}},{key:"expandAll",value:function(){this.toggleAllCollapsibleSections("expand")}},{key:"toggleCollapsibleSection",value:function(o,i){var a=this;if(!xx.has(i))throw new Error("Unsupported action is passed (".concat(i,")."));if(Array.isArray(o)){var l=jr(o,function(m){var w=m.row;return w<0}),s=l.length>0;$(l,function(m){var w,S=m.row,C=m.col,P=(w=a.headerStateManager.getHeaderSettings(S,C))!==null&&w!==void 0?w:{},R=P.collapsible,V=P.isCollapsed;if(!R||V&&i==="collapse"||!V&&i==="expand")return s=!1,!1});var u=[],f=[];s&&$(l,function(m){var w=m.row,S=m.col,C=a.headerStateManager.triggerNodeModification(i,w,S),P=C.colspanCompensation,R=C.affectedColumns,V=C.rollbackModification;P>0&&(f.push.apply(f,Ax(R)),u.push(V))});var c=this.getCollapsedColumns(),h=[];i==="collapse"?h=H0([].concat(Ax(c),f)):i==="expand"&&(h=jr(c,function(m){return!f.includes(m)}));var d=xx.get(i),v=this.hot.runHooks(d.beforeHook,c,h,s);if(v===!1){$(u,function(m){m()});return}this.hot.batchExecution(function(){$(f,function(m){Mx(a,ml).setValueAtIndex(a.hot.toPhysicalColumn(m),d.hideColumn)})},!0);var g=this.getCollapsedColumns().length!==c.length;this.hot.runHooks(d.afterHook,c,h,s,g),this.hot.render(),this.hot.view.adjustElementsSize(!0)}}},{key:"getCollapsedColumns",value:function(){return Mx(this,ml).getHiddenIndexes()}},{key:"onAfterGetColHeader",value:function(o,i,a){var l,s=(l=this.headerStateManager.getHeaderSettings(a,o))!==null&&l!==void 0?l:{},u=s.collapsible,f=s.origColspan,c=s.isCollapsed,h=u&&f>1&&o>=this.hot.getSettings().fixedColumnsStart,d=i.querySelector(".".concat(pl));if(h)d||(d=this.hot.rootDocument.createElement("div"),re(d,pl),i.querySelector("div:first-child").appendChild(d)),Le(d,["collapsed","expanded"]),c?(re(d,"collapsed"),Oi(d,"+")):(re(d,"expanded"),Oi(d,"-"));else{var v;(v=d)===null||v===void 0||v.remove()}}},{key:"onBeforeOnCellMouseDown",value:function(o,i){xe(o.target,pl)&&(xe(o.target,"expanded")?(this.eventManager.fireEvent(o.target,"mouseup"),this.toggleCollapsibleSection([i],"collapse")):xe(o.target,"collapsed")&&(this.eventManager.fireEvent(o.target,"mouseup"),this.toggleCollapsibleSection([i],"expand")),gn(o))}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(o,i){i||this.updatePlugin()}},{key:"destroy",value:function(){Bw(this,ml,null),ia(fo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Vw}},{key:"PLUGIN_PRIORITY",get:function(){return UTe}},{key:"PLUGIN_DEPS",get:function(){return["plugin:NestedHeaders"]}},{key:"SETTING_KEYS",get:function(){return[Vw].concat(zTe)}}]),r}(ot);function Kh(e){"@babel/helpers - typeof";return Kh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kh(e)}function Dx(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function GTe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Dx(Object(r),!0).forEach(function(n){KTe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Dx(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function KTe(e,t,r){return t=Q2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Nx(e,t){return QTe(e)||ZTe(e,t)||XTe(e,t)||qTe()}function qTe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function XTe(e,t){if(e){if(typeof e=="string")return Hx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Hx(e,t)}}function Hx(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ZTe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function QTe(e){if(Array.isArray(e))return e}function JTe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Lx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Q2(n.key),n)}}function ePe(e,t,r){return t&&Lx(e.prototype,t),r&&Lx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Q2(e){var t=tPe(e,"string");return Kh(t)==="symbol"?t:String(t)}function tPe(e,t){if(Kh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Kh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rPe=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],nPe=!1,oPe=!0,iPe=!0,aPe=function(){function e(t,r){JTe(this,e),this.hot=t,this.sortingStates=new Nm,this.sortEmptyCells=nPe,this.indicator=oPe,this.headerAction=iPe,this.compareFunctionFactory=void 0,this.mapName=r,this.hot.columnIndexMapper.registerMap(r,this.sortingStates)}return ePe(e,[{key:"updateAllColumnsProperties",value:function(r){var n=this;Ve(r)&&We(r,function(o,i){rPe.includes(i)&&(n[i]=o)})}},{key:"getAllColumnsProperties",value:function(){var r={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(r.compareFunctionFactory=this.compareFunctionFactory),r}},{key:"getSortOrderOfColumn",value:function(r){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(r)))===null||n===void 0?void 0:n.sortOrder}},{key:"getIndexOfColumnInSortQueue",value:function(r){return r=this.hot.toPhysicalColumn(r),this.sortingStates.getEntries().findIndex(function(n){var o=Nx(n,1),i=o[0];return i===r})}},{key:"getNumberOfSortedColumns",value:function(){return this.sortingStates.getLength()}},{key:"isListOfSortedColumnsEmpty",value:function(){return this.getNumberOfSortedColumns()===0}},{key:"isColumnSorted",value:function(r){return Ve(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(r)))}},{key:"getSortStates",value:function(){var r=this;if(this.sortingStates===null)return[];var n=this.sortingStates.getEntries();return n.map(function(o){var i=Nx(o,2),a=i[0],l=i[1];return GTe({column:r.hot.toVisualColumn(a)},l)})}},{key:"getColumnSortState",value:function(r){var n=this.getSortOrderOfColumn(r);if(ve(n))return{column:r,sortOrder:n}}},{key:"setSortStates",value:function(r){this.sortingStates.clear();for(var n=0;n<r.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(r[n].column),{sortOrder:r[n].sortOrder})}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}]),e}(),Pp="asc",kp="desc",lPe="colHeader";function sPe(e){if(Ve(e)===!1)return!1;var t=e.column,r=e.sortOrder;return Number.isInteger(t)&&[Pp,kp].includes(r)}function uPe(e){if(e.some(function(r){return sPe(r)===!1}))return!1;var t=e.map(function(r){var n=r.column;return n});return new Set(t).size===t.length}function jx(e){if(e!==kp)return e===Pp?kp:Pp}function Fx(e){var t=e.querySelector(".".concat(lPe));return t}function Bx(e,t){if(e<0||!t.parentNode)return!1;var r=t.parentNode.parentNode.childNodes,n=Array.from(r).indexOf(t.parentNode)-r.length;return n===-1}function pO(e,t,r){return e===-1&&t>=0&&Ei(r)===!1}var fPe="ascending",cPe="descending",J2="indicatorDisabled",eU="columnSorting",tU="sortAction",rU=new Map([[Pp,fPe],[kp,cPe]]);function hPe(e,t,r,n){var o=[eU];if(n&&o.push(tU),r===!1)return o.push(J2),o;var i=e.getSortOrderOfColumn(t);return ve(i)&&o.push(rU.get(i)),o}function dPe(){return Array.from(rU.values()).concat(tU,J2,eU)}function nU(e,t,r){var n=t.locale;return function(o,i){var a=r.sortEmptyCells;return typeof o=="string"&&(o=o.toLocaleLowerCase(n)),typeof i=="string"&&(i=i.toLocaleLowerCase(n)),o===i?Nn:Kt(o)?Kt(i)?Nn:a&&e==="asc"?kt:$t:Kt(i)?a&&e==="asc"?$t:kt:isNaN(o)&&!isNaN(i)?e==="asc"?$t:kt:!isNaN(o)&&isNaN(i)||(isNaN(o)||isNaN(i)||(o=parseFloat(o),i=parseFloat(i)),o<i)?e==="asc"?kt:$t:o>i?e==="asc"?$t:kt:Nn}}var oU="default";function vPe(e,t,r){return function(n,o){var i=parseFloat(n),a=parseFloat(o),l=r.sortEmptyCells;if(i===a||isNaN(i)&&isNaN(a))return Nn;if(l){if(Kt(n))return e==="asc"?kt:$t;if(Kt(o))return e==="asc"?$t:kt}return isNaN(i)?$t:isNaN(a)?kt:i<a?e==="asc"?kt:$t:i>a?e==="asc"?$t:kt:Nn}}var yPe="numeric";function gPe(e,t,r){var n=t.checkedTemplate,o=t.uncheckedTemplate,i=r.sortEmptyCells;return function(a,l){var s=Kt(a),u=Kt(l),f=s?o:a,c=u?o:l,h=f===o||f===n,d=c===o||c===n;if(i===!1){if(s&&u===!1)return $t;if(s===!1&&u)return kt}return h===!1&&d?e==="asc"?kt:$t:h&&d===!1?e==="asc"?$t:kt:h===!1&&d===!1?nU(e,t,r)(a,l):f===o&&c===n?e==="asc"?kt:$t:f===n&&c===o?e==="asc"?$t:kt:Nn}}var pPe="checkbox";function mPe(e,t,r){return function(n,o){var i=r.sortEmptyCells;if(n===o)return Nn;if(Kt(n))return Kt(o)?Nn:i&&e==="asc"?kt:$t;if(Kt(o))return i&&e==="asc"?$t:kt;var a=t.dateFormat,l=te(n,a),s=te(o,a);return l.isValid()?s.isValid()?s.isAfter(l)?e==="asc"?kt:$t:s.isBefore(l)?e==="asc"?$t:kt:Nn:kt:$t}}var bPe="date",EP=Jr("sorting.compareFunctionFactory"),Ym=EP.register,Vx=EP.getItem,wPe=EP.hasItem,iU=Jr("sorting.mainSortComparator"),aU=iU.register,SPe=iU.getItem;function lU(e){return wPe(e)?Vx(e):Vx(oU)}Ym(yPe,vPe);Ym(pPe,gPe);Ym(bPe,mPe);Ym(oU,nU);var Nn=0,kt=-1,$t=1;function CPe(e,t){for(var r=SPe(t),n=arguments.length,o=new Array(n>2?n-2:0),i=2;i<n;i++)o[i-2]=arguments[i];e.sort(r.apply(void 0,o))}function Wx(e){return EPe(e)||RPe(e)||OPe(e)||_Pe()}function _Pe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OPe(e,t){if(e){if(typeof e=="string")return Ux(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ux(e,t)}}function Ux(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function RPe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function EPe(e){if(Array.isArray(e))return e}function TPe(e,t){return function(r,n){var o=Wx(r),i=o.slice(1),a=Wx(n),l=a.slice(1);return function(u){var f=e[u],c=t[u],h=i[u],d=l[u],v=c.columnSorting,g=v.compareFunctionFactory?v.compareFunctionFactory:lU(c.type),m=g(f,c,v)(h,d);return m}(0)}}function hu(e){"@babel/helpers - typeof";return hu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hu(e)}var PPe=["column"],kPe=["column"];function bl(e){return MPe(e)||IPe(e)||APe(e)||$Pe()}function $Pe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function APe(e,t){if(e){if(typeof e=="string")return mO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mO(e,t)}}function IPe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function MPe(e){if(Array.isArray(e))return mO(e)}function mO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function zx(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Yx(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zx(Object(r),!0).forEach(function(n){xPe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zx(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function xPe(e,t,r){return t=sU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Gx(e,t){if(e==null)return{};var r=DPe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function DPe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function NPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Kx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sU(n.key),n)}}function HPe(e,t,r){return t&&Kx(e.prototype,t),r&&Kx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sU(e){var t=LPe(e,"string");return hu(t)==="symbol"?t:String(t)}function LPe(e,t){if(hu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function aa(){return typeof Reflect<"u"&&Reflect.get?aa=Reflect.get.bind():aa=function(t,r,n){var o=jPe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},aa.apply(this,arguments)}function jPe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=co(e),e!==null););return e}function FPe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bO(e,t)}function bO(e,t){return bO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},bO(e,t)}function BPe(e){var t=UPe();return function(){var n=co(e),o;if(t){var i=co(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return VPe(this,o)}}function VPe(e,t){if(t&&(hu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return WPe(e)}function WPe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function UPe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function co(e){return co=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},co(e)}var wO="columnSorting",zPe=50,qx="append",YPe="replace";aU(wO,TPe);pe.getSingleton().register("beforeColumnSort");pe.getSingleton().register("afterColumnSort");var uU=function(e){FPe(r,e);var t=BPe(r);function r(n){var o;return NPe(this,r),o=t.call(this,n),o.columnStatesManager=null,o.columnMetaCache=null,o.pluginKey=wO,o.indexesSequenceCache=null,o}return HPe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[this.pluginKey]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.columnStatesManager=new aPe(this.hot,"".concat(this.pluginKey,".sortingStates")),this.columnMetaCache=new Ai(function(i){var a=o.hot.toVisualColumn(i);return a===null&&(a=i),o.getMergedPluginSettings(a)}),this.hot.columnIndexMapper.registerMap("".concat(this.pluginKey,".columnMeta"),this.columnMetaCache),this.addHook("afterGetColHeader",function(i,a){return o.onAfterGetColHeader(i,a)}),this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("afterOnCellMouseDown",function(i,a){return o.onAfterOnCellMouseDown(i,a)}),this.addHook("afterInit",function(){return o.loadOrSortBySettings()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.hot.view&&this.loadOrSortBySettings(),aa(co(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var o=this,i=function(l,s){var u=Fx(s);Bx(l,s)===!1||u===null||o.updateHeaderClasses(u)};this.hot.addHook("afterGetColHeader",i),this.hot.addHookOnce("afterViewRender",function(){o.hot.removeHook("afterGetColHeader",i)}),this.hot.batchExecution(function(){o.indexesSequenceCache!==null&&(o.hot.rowIndexMapper.setIndexesSequence(o.indexesSequenceCache.getValues()),o.hot.rowIndexMapper.unregisterMap(o.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap("".concat(this.pluginKey,".columnMeta")),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,aa(co(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(o){var i=this.getSortConfig(),a=this.getNormalizedSortConfigs(o),l=this.areValidSortConfigs(a),s=this.hot.runHooks("beforeColumnSort",i,a,l);s!==!1&&(i.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new JW),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),l&&(this.columnStatesManager.setSortStates(a),this.sortByPresetSortStates(a),this.saveAllSortSettings(a)),this.hot.runHooks("afterColumnSort",i,l?a:i,l),l&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}},{key:"clearSort",value:function(){this.sort([])}},{key:"isSorted",value:function(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}},{key:"getSortConfig",value:function(o){return ve(o)?this.columnStatesManager.getColumnSortState(o):this.columnStatesManager.getSortStates()}},{key:"setSortConfig",value:function(o){var i=this.getNormalizedSortConfigs(o);this.areValidSortConfigs(i)&&this.columnStatesManager.setSortStates(i)}},{key:"getNormalizedSortConfigs",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(o)?o.slice(0,1):[o]}},{key:"areValidSortConfigs",value:function(o){var i=this.hot.countCols();return uPe(o)&&o.every(function(a){var l=a.column;return l<=i&&l>=0})}},{key:"saveAllSortSettings",value:function(o){var i=this,a=this.columnStatesManager.getAllColumnsProperties(),l=function(u){var f=u.column,c=Gx(u,PPe);return Yx({column:i.hot.toPhysicalColumn(f)},c)};a.initialConfig=Be(o,l),this.hot.runHooks("persistentStateSave","columnSorting",a)}},{key:"getAllSavedSortSettings",value:function(){var o=this,i={};this.hot.runHooks("persistentStateLoad","columnSorting",i);var a=i.value,l=function(u){var f=u.column,c=Gx(u,kPe);return Yx({column:o.hot.toVisualColumn(f)},c)};return ve(a)&&Array.isArray(a.initialConfig)&&(a.initialConfig=Be(a.initialConfig,l)),a}},{key:"getColumnNextConfig",value:function(o){var i=this.columnStatesManager.getSortOrderOfColumn(o);if(ve(i)){var a=jx(i);return ve(a)?{column:o,sortOrder:a}:void 0}var l=this.hot.countCols();if(Number.isInteger(o)&&o>=0&&o<l)return{column:o,sortOrder:jx()}}},{key:"getNextSortConfig",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:qx,a=this.columnStatesManager.getIndexOfColumnInSortQueue(o),l=a!==-1,s=this.getSortConfig(),u=this.getColumnNextConfig(o);if(l){if(gt(u))return[].concat(bl(s.slice(0,a)),bl(s.slice(a+1)));if(i===qx)return[].concat(bl(s.slice(0,a)),bl(s.slice(a+1)),[u]);if(i===YPe)return[].concat(bl(s.slice(0,a)),[u],bl(s.slice(a+1)))}return ve(u)?s.concat(u):s}},{key:"getPluginColumnConfig",value:function(o){if(Ve(o)){var i=o[this.pluginKey];if(Ve(i))return i}return{}}},{key:"getMergedPluginSettings",value:function(o){var i=this.hot.getSettings()[this.pluginKey],a=this.columnStatesManager.getAllColumnsProperties(),l=this.hot.getCellMeta(0,o),s=Object.getPrototypeOf(l);return Array.isArray(s.columns)?Object.assign(a,i,this.getPluginColumnConfig(s.columns[o])):bt(s.columns)?Object.assign(a,i,this.getPluginColumnConfig(s.columns(o))):Object.assign(a,i)}},{key:"getFirstCellSettings",value:function(o){var i=this.hot.getCellMeta(0,o),a=Object.create(i);return a[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(o)),a}},{key:"getNumberOfRowsToSort",value:function(o){var i=this.hot.getSettings();return i.maxRows<=o?i.maxRows:o-i.minSpareRows}},{key:"sortByPresetSortStates",value:function(o){var i=this;if(o.length===0){this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());return}for(var a=[],l=this.hot.countRows(),s=function(m){return Be(o,function(w){return i.hot.getDataAtCell(m,w.column)})},u=0;u<this.getNumberOfRowsToSort(l);u+=1)a.push([this.hot.toPhysicalRow(u)].concat(s(u)));var f=Be(a,function(g){return g[0]});CPe(a,this.pluginKey,Be(o,function(g){return g.sortOrder}),Be(o,function(g){return i.getFirstCellSettings(g.column)}));for(var c=a.length;c<l;c+=1)a.push([c].concat(s(c)));var h=Be(a,function(g){return g[0]}),d=new Map(Be(f,function(g,m){return[g,h[m]]})),v=Be(this.hot.rowIndexMapper.getIndexesSequence(),function(g){return d.has(g)?d.get(g):g});this.hot.rowIndexMapper.setIndexesSequence(v)}},{key:"loadOrSortBySettings",value:function(){var o=this.getAllSavedSortSettings();if(Ve(o))this.sortBySettings(o);else{var i=this.hot.getSettings()[this.pluginKey];this.sortBySettings(i)}}},{key:"sortBySettings",value:function(o){if(Ve(o)){this.columnStatesManager.updateAllColumnsProperties(o);var i=o.initialConfig;(Array.isArray(i)||Ve(i))&&this.sort(i)}else this.hot.render()}},{key:"onAfterGetColHeader",value:function(o,i){var a=Fx(i);if(!(Bx(o,i)===!1||a===null)){var l=this.getFirstCellSettings(o)[this.pluginKey],s=l.indicator,u=l.headerAction;this.updateHeaderClasses(a,this.columnStatesManager,o,s,u)}}},{key:"updateHeaderClasses",value:function(o){if(Le(o,dPe()),this.enabled!==!1){for(var i=arguments.length,a=new Array(i>1?i-1:0),l=1;l<i;l++)a[l-1]=arguments[l];re(o,hPe.apply(void 0,a))}}},{key:"onUpdateSettings",value:function(o){aa(co(r.prototype),"onUpdateSettings",this).call(this),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),ve(o[this.pluginKey])&&this.sortBySettings(o[this.pluginKey])}},{key:"onAfterLoadData",value:function(o){o===!0&&this.hot.view&&this.loadOrSortBySettings()}},{key:"wasClickableHeaderClicked",value:function(o,i){var a=this.getFirstCellSettings(i)[this.pluginKey],l=a.headerAction;return l&&o.target.nodeName==="SPAN"}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,l){pO(i.row,i.col,o)!==!1&&this.wasClickableHeaderClicked(o,i.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(l.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(o,i){pO(i.row,i.col,o)!==!1&&this.wasClickableHeaderClicked(o,i.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(i.col)),this.sort(this.getColumnNextConfig(i.col)))}},{key:"destroy",value:function(){var o;(o=this.columnStatesManager)===null||o===void 0||o.destroy(),aa(co(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return wO}},{key:"PLUGIN_PRIORITY",get:function(){return zPe}}]),r}(ot),GPe=$e,TP=Ue,KPe=$i,qPe=gF,XPe=B0,Xx=je,ZPe=RangeError,fU=String,cU=Math.floor,SO=TP(XPe),Zx=TP("".slice),Yf=TP(1 .toFixed),Wl=function(e,t,r){return t===0?r:t%2===1?Wl(e,t-1,r*e):Wl(e*e,t/2,r)},QPe=function(e){for(var t=0,r=e;r>=4096;)t+=12,r/=4096;for(;r>=2;)t+=1,r/=2;return t},wl=function(e,t,r){for(var n=-1,o=r;++n<6;)o+=t*e[n],e[n]=o%1e7,o=cU(o/1e7)},Ww=function(e,t){for(var r=6,n=0;--r>=0;)n+=e[r],e[r]=cU(n/t),n=n%t*1e7},Qx=function(e){for(var t=6,r="";--t>=0;)if(r!==""||t===0||e[t]!==0){var n=fU(e[t]);r=r===""?n:r+SO("0",7-n.length)+n}return r},JPe=Xx(function(){return Yf(8e-5,3)!=="0.000"||Yf(.9,0)!=="1"||Yf(1.255,2)!=="1.25"||Yf(0xde0b6b3a7640080,0)!=="1000000000000000128"})||!Xx(function(){Yf({})});GPe({target:"Number",proto:!0,forced:JPe},{toFixed:function(t){var r=qPe(this),n=KPe(t),o=[0,0,0,0,0,0],i="",a="0",l,s,u,f;if(n<0||n>20)throw new ZPe("Incorrect fraction digits");if(r!==r)return"NaN";if(r<=-1e21||r>=1e21)return fU(r);if(r<0&&(i="-",r=-r),r>1e-21)if(l=QPe(r*Wl(2,69,1))-69,s=l<0?r*Wl(2,-l,1):r/Wl(2,l,1),s*=4503599627370496,l=52-l,l>0){for(wl(o,0,s),u=n;u>=7;)wl(o,1e7,0),u-=7;for(wl(o,Wl(10,u,1),0),u=l-1;u>=23;)Ww(o,1<<23),u-=23;Ww(o,1<<u),wl(o,1,1),Ww(o,2),a=Qx(o)}else wl(o,0,s),wl(o,1<<-l,0),a=Qx(o)+SO("0",n);return n>0?(f=a.length,a=i+(f<=n?"0."+SO("0",n-f)+a:Zx(a,0,f-n)+"."+Zx(a,f-n))):a=i+a,a}});function qh(e){"@babel/helpers - typeof";return qh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qh(e)}function eke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Jx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rke(n.key),n)}}function tke(e,t,r){return t&&Jx(e.prototype,t),r&&Jx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rke(e){var t=nke(e,"string");return qh(t)==="symbol"?t:String(t)}function nke(e,t){if(qh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var oke=function(){function e(t,r){eke(this,e),this.plugin=t,this.hot=this.plugin.hot,this.endpoints=[],this.settings=r,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[]}return tke(e,[{key:"getEndpoint",value:function(r){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[r]:this.endpoints[r]}},{key:"getAllEndpoints",value:function(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}},{key:"fillMissingEndpointData",value:function(r){return this.parseSettings(r.call(this))}},{key:"parseSettings",value:function(r){var n=this,o=[],i=r;if(!i&&typeof this.settings=="function"){this.settingsType="function";return}return i||(i=this.settings),$(i,function(a){var l={};n.assignSetting(a,l,"ranges",[[0,n.hot.countRows()-1]]),n.assignSetting(a,l,"reversedRowCoords",!1),n.assignSetting(a,l,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),n.assignSetting(a,l,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),n.assignSetting(a,l,"sourceColumn",a.destinationColumn),n.assignSetting(a,l,"type","sum"),n.assignSetting(a,l,"forceNumeric",!1),n.assignSetting(a,l,"suppressDataTypeErrors",!0),n.assignSetting(a,l,"suppressDataTypeErrors",!0),n.assignSetting(a,l,"customFunction",null),n.assignSetting(a,l,"readOnly",!0),n.assignSetting(a,l,"roundFloat",!1),o.push(l)}),o}},{key:"assignSetting",value:function(r,n,o,i){if(o==="ranges"&&r[o]===void 0){n[o]=i;return}else if(o==="ranges"&&r[o].length===0)return;if(r[o]===void 0){if(i instanceof Error)throw i;n[o]=i}else o==="destinationRow"&&n.reversedRowCoords?n[o]=this.hot.countRows()-r[o]-1:n[o]=r[o]}},{key:"resetSetupBeforeStructureAlteration",value:function(r,n,o){if(this.settingsType==="function"){var i=r.indexOf("row")>-1?"row":"col",a=this.getAllEndpoints();$(a,function(l){i==="row"&&l.destinationRow>=n&&(r==="insert_row"?l.alterRowOffset=o:r==="remove_row"&&(l.alterRowOffset=-1*o)),i==="col"&&l.destinationColumn>=n&&(r==="insert_col"?l.alterColumnOffset=o:r==="remove_col"&&(l.alterColumnOffset=-1*o))}),this.resetAllEndpoints(a,!1)}}},{key:"resetSetupAfterStructureAlteration",value:function(r,n,o,i,a){var l=this,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){var u=function g(){return l.hot.removeHook("beforeViewRender",g),l.refreshAllEndpoints()};this.hot.addHookOnce("beforeViewRender",u);return}var f=r.indexOf("row")>-1?"row":"col",c=r.indexOf("remove")>-1?-1:1,h=this.getAllEndpoints(),d=r.indexOf("move_row")===0,v=n;$(h,function(g){f==="row"&&g.destinationRow>=v&&(g.alterRowOffset=c*o),f==="col"&&g.destinationColumn>=v&&(g.alterColumnOffset=c*o)}),this.resetAllEndpoints(h,!d),d?$(h,function(g){l.extendEndpointRanges(g,v,i[0],i.length),l.recreatePhysicalRanges(g),l.clearOffsetInformation(g)}):$(h,function(g){l.shiftEndpointCoordinates(g,v)}),s&&this.refreshAllEndpoints()}},{key:"clearOffsetInformation",value:function(r){r.alterRowOffset=void 0,r.alterColumnOffset=void 0}},{key:"extendEndpointRanges",value:function(r,n,o,i){$(r.ranges,function(a){a[1]&&(n>=a[0]&&n<=a[1]?o>a[1]?a[1]+=i:o<a[0]&&(a[0]-=i):o>=a[0]&&o<=a[1]&&(a[1]-=i,n<=a[0]&&(a[0]+=1,a[1]+=1)))})}},{key:"recreatePhysicalRanges",value:function(r){var n=this,o=r.ranges,i=[],a=[];$(o,function(l){var s=[];if(l[1])for(var u=l[0];u<=l[1];u++)s.push(n.hot.toPhysicalRow(u));else s.push(n.hot.toPhysicalRow(l[0]));a.push(s)}),$(a,function(l){var s=[];$(l,function(u,f){f===0?s.push(u):l[f]!==l[f-1]+1&&(s.push(l[f-1]),i.push(s),s=[],s.push(u)),f===l.length-1&&(s.push(u),i.push(s))})}),r.ranges=i}},{key:"shiftEndpointCoordinates",value:function(r,n){r.alterRowOffset&&r.alterRowOffset!==0?(r.destinationRow+=r.alterRowOffset||0,$(r.ranges,function(o){$(o,function(i,a){i>=n&&(o[a]+=r.alterRowOffset||0)})})):r.alterColumnOffset&&r.alterColumnOffset!==0&&(r.destinationColumn+=r.alterColumnOffset||0,r.sourceColumn+=r.alterColumnOffset||0)}},{key:"resetAllEndpoints",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=n.some(function(a){var l=a.alterRowOffset||0,s=a.alterColumnOffset||0;return a.destinationRow+l>=r.hot.countRows()||a.destinationColumn+s>=r.hot.countCols()});i||(this.cellsToSetCache=[],$(n,function(a){r.resetEndpointValue(a,o)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}},{key:"refreshAllEndpoints",value:function(){var r=this;this.cellsToSetCache=[],$(this.getAllEndpoints(),function(n){r.currentEndpoint=n,r.plugin.calculate(n),r.setEndpointValue(n,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshChangedEndpoints",value:function(r){var n=this,o=[];this.cellsToSetCache=[],$(r,function(i,a,l){"".concat(i[2]||"")!=="".concat(i[3])&&$(n.getAllEndpoints(),function(s,u){n.hot.propToCol(l[a][1])===s.sourceColumn&&o.indexOf(u)===-1&&o.push(u)})}),$(o,function(i){n.refreshEndpoint(n.getEndpoint(i))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshEndpoint",value:function(r){this.currentEndpoint=r,this.plugin.calculate(r),this.setEndpointValue(r),this.currentEndpoint=null}},{key:"resetEndpointValue",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,o=r.alterRowOffset||0,i=r.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(r.destinationRow+(n?o:0)),this.hot.toVisualColumn(r.destinationColumn+(n?i:0)),""])}},{key:"setEndpointValue",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.hot.toVisualRow(r.destinationRow);if(r.destinationRow>=this.hot.countRows()||r.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}var a=this.hot.toVisualRow(r.destinationRow);if(a!==null){var l=this.hot.getCellMeta(a,r.destinationColumn);(n==="init"||l.readOnly!==r.readOnly)&&(l.readOnly=r.readOnly,l.className="columnSummaryResult")}r.roundFloat&&!isNaN(r.result)&&(r.result=r.result.toFixed(r.roundFloat)),o?this.hot.setDataAtCell(i,r.destinationColumn,r.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,r.destinationColumn,r.result]),r.alterRowOffset=void 0,r.alterColumnOffset=void 0}},{key:"throwOutOfBoundsWarning",value:function(){ht("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}]),e}();const ike=oke;function Uw(e){return e==null||isNaN(e)}function du(e){"@babel/helpers - typeof";return du=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},du(e)}var eD;function ake(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function lke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uke(n.key),n)}}function ske(e,t,r){return t&&tD(e.prototype,t),r&&tD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uke(e){var t=fke(e,"string");return du(t)==="symbol"?t:String(t)}function fke(e,t){if(du(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(du(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vg(){return typeof Reflect<"u"&&Reflect.get?vg=Reflect.get.bind():vg=function(t,r,n){var o=cke(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},vg.apply(this,arguments)}function cke(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=vu(e),e!==null););return e}function hke(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&CO(e,t)}function CO(e,t){return CO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},CO(e,t)}function dke(e){var t=gke();return function(){var n=vu(e),o;if(t){var i=vu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return vke(this,o)}}function vke(e,t){if(t&&(du(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yke(e)}function yke(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gke(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vu(e){return vu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vu(e)}var zw="columnSummary",pke=220,mke=function(e){hke(r,e);var t=dke(r);function r(n){var o;return lke(this,r),o=t.call(this,n),o.endpoints=null,o}return ske(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[zw]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.settings=this.hot.getSettings()[zw],this.endpoints=new ike(this,this.settings),this.addHook("afterInit",function(){return o.onAfterInit.apply(o,arguments)}),this.addHook("afterChange",function(){return o.onAfterChange.apply(o,arguments)}),this.addHook("beforeCreateRow",function(i,a,l){return o.endpoints.resetSetupBeforeStructureAlteration("insert_row",i,a,null,l)}),this.addHook("beforeCreateCol",function(i,a,l){return o.endpoints.resetSetupBeforeStructureAlteration("insert_col",i,a,null,l)}),this.addHook("beforeRemoveRow",function(){for(var i,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return(i=o.endpoints).resetSetupBeforeStructureAlteration.apply(i,["remove_row"].concat(l))}),this.addHook("beforeRemoveCol",function(){for(var i,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return(i=o.endpoints).resetSetupBeforeStructureAlteration.apply(i,["remove_col"].concat(l))}),this.addHook("afterCreateRow",function(i,a,l){return o.endpoints.resetSetupAfterStructureAlteration("insert_row",i,a,null,l)}),this.addHook("afterCreateCol",function(i,a,l){return o.endpoints.resetSetupAfterStructureAlteration("insert_col",i,a,null,l)}),this.addHook("afterRemoveRow",function(){for(var i,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return(i=o.endpoints).resetSetupAfterStructureAlteration.apply(i,["remove_row"].concat(l))}),this.addHook("afterRemoveCol",function(){for(var i,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return(i=o.endpoints).resetSetupAfterStructureAlteration.apply(i,["remove_col"].concat(l))}),this.addHook("afterRowMove",function(){return o.onAfterRowMove.apply(o,arguments)}),vg(vu(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}},{key:"calculate",value:function(o){switch(o.type.toLowerCase()){case"sum":o.result=this.calculateSum(o);break;case"min":o.result=this.calculateMinMax(o,o.type);break;case"max":o.result=this.calculateMinMax(o,o.type);break;case"count":o.result=this.countEntries(o);break;case"average":o.result=this.calculateAverage(o);break;case"custom":o.result=o.customFunction.call(this,o);break}}},{key:"calculateSum",value:function(o){var i=this,a=0;return We(o.ranges,function(l){a+=i.getPartialSum(l,o.sourceColumn)}),a}},{key:"getPartialSum",value:function(o,i){var a=0,l=o[1]||o[0],s=null,u=0;do{if(s=this.getCellValue(l,i),s=Uw(s)?null:s,s!==null){var f=("".concat(s).split(".")[1]||[]).length||1;f>u&&(u=f)}a+=s||0,l-=1}while(l>=o[0]);return Math.round(a*Math.pow(10,u))/Math.pow(10,u)}},{key:"calculateMinMax",value:function(o,i){var a=this,l=null;return We(o.ranges,function(s){var u=a.getPartialMinMax(s,o.sourceColumn,i);if(l===null&&u!==null&&(l=u),u!==null)switch(i){case"min":l=Math.min(l,u);break;case"max":l=Math.max(l,u);break}}),l===null?"Not enough data":l}},{key:"getPartialMinMax",value:function(o,i,a){var l=null,s=o[1]||o[0],u;do{if(u=this.getCellValue(s,i),u=Uw(u)?null:u,l===null)l=u;else if(u!==null)switch(a){case"min":l=Math.min(l,u);break;case"max":l=Math.max(l,u);break}s-=1}while(s>=o[0]);return l}},{key:"countEmpty",value:function(o,i){var a,l=0,s=o[1]||o[0];do a=this.getCellValue(s,i),a=Uw(a)?null:a,a===null&&(l+=1),s-=1;while(s>=o[0]);return l}},{key:"countEntries",value:function(o){var i=this,a=0,l=o.ranges;return We(l,function(s){var u=s[1]===void 0?1:s[1]-s[0]+1,f=i.countEmpty(s,o.sourceColumn);a+=u,a-=f}),a}},{key:"calculateAverage",value:function(o){var i=this.calculateSum(o),a=this.countEntries(o);return i/a}},{key:"getCellValue",value:function(o,i){var a=this.hot.toVisualRow(o),l=this.hot.toVisualColumn(i),s=this.hot.getSourceDataAtCell(o,i),u="";if(a!==null&&l!==null&&(u=this.hot.getCellMeta(a,l).className||""),u.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof s=="string"&&(s=s.replace(/,/,".")),s=parseFloat(s)),isNaN(s)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(ft(eD||(eD=ake(["ColumnSummary plugin: cell at (",", ",`) is not in a 
          numeric format. Cannot do the calculation.`],["ColumnSummary plugin: cell at (",", ",`) is not in a\\x20
          numeric format. Cannot do the calculation.`])),o,i));return s}},{key:"onAfterInit",value:function(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}},{key:"onAfterChange",value:function(o,i){o&&i!=="ColumnSummary.reset"&&i!=="ColumnSummary.set"&&i!=="loadData"&&this.endpoints.refreshChangedEndpoints(o)}},{key:"onAfterRowMove",value:function(o,i){this.endpoints.resetSetupBeforeStructureAlteration("move_row",o[0],o.length,o,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",i,o.length,o,this.pluginName)}}],[{key:"PLUGIN_KEY",get:function(){return zw}},{key:"PLUGIN_PRIORITY",get:function(){return pke}}]),r}(ot);function Xh(e){"@babel/helpers - typeof";return Xh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xh(e)}function bke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ske(n.key),n)}}function wke(e,t,r){return t&&rD(e.prototype,t),r&&rD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ske(e){var t=Cke(e,"string");return Xh(t)==="symbol"?t:String(t)}function Cke(e,t){if(Xh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _ke=function(){function e(t,r){bke(this,e),this.rootDocument=t,this.isRtl=r,this.container=null,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}return wke(e,[{key:"setPosition",value:function(r,n){this.editorStyle.left="".concat(r,"px"),this.editorStyle.top="".concat(n,"px")}},{key:"setSize",value:function(r,n){if(r&&n){var o=this.getInputElement();o.style.width="".concat(r,"px"),o.style.height="".concat(n,"px")}}},{key:"getSize",value:function(){return{width:dt(this.getInputElement()),height:Rt(this.getInputElement())}}},{key:"resetSize",value:function(){var r=this.getInputElement();r.style.width="",r.style.height=""}},{key:"setReadOnlyState",value:function(r){var n=this.getInputElement();n.readOnly=r}},{key:"show",value:function(){this.editorStyle.display="block",this.hidden=!1}},{key:"hide",value:function(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}},{key:"isVisible",value:function(){return this.editorStyle.display==="block"}},{key:"setValue",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=r||"";this.getInputElement().value=n}},{key:"getValue",value:function(){return this.getInputElement().value}},{key:"isFocused",value:function(){return this.rootDocument.activeElement===this.getInputElement()}},{key:"focus",value:function(){this.getInputElement().focus()}},{key:"createEditor",value:function(){var r=this.rootDocument.createElement("div"),n=this.rootDocument.createElement("textarea");return r.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),re(this.container,e.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),re(r,e.CLASS_EDITOR),re(n,e.CLASS_INPUT),r.appendChild(n),this.container.appendChild(r),r}},{key:"getInputElement",value:function(){return this.editor.querySelector(".".concat(e.CLASS_INPUT))}},{key:"destroy",value:function(){var r=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,r&&r.removeChild(this.container)}}],[{key:"CLASS_EDITOR_CONTAINER",get:function(){return"htCommentsContainer"}},{key:"CLASS_EDITOR",get:function(){return"htComments"}},{key:"CLASS_INPUT",get:function(){return"htCommentTextArea"}},{key:"CLASS_CELL",get:function(){return"htCommentCell"}}]),e}();const Oke=_ke;var Ye="---------";function Rke(){return{name:Ye}}function Eke(e){return Be(e,function(t){return{start:t.getTopStartCorner(),end:t.getBottomEndCorner()}})}function cy(e){return xe(e,"htSeparator")}function Tke(e){return xe(e,"htSubmenu")}function hy(e){return xe(e,"htDisabled")}function dy(e){return xe(e,"htSelectionDisabled")}function ol(e){var t=e.getSelected();return!t||t[0]<0?null:t}function Pke(e,t){if(e.indexOf(t)!==-1)return e;var r=e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return"".concat(r," ").concat(t)}function kke(e,t){if(e.indexOf(t)!==-1)return e;var r=e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return"".concat(r," ").concat(t)}function Wi(e,t){var r={};return $(e,function(n){n.forAll(function(o,i){o>=0&&i>=0&&(r[o]||(r[o]=[]),r[o][i]=t(o,i))})}),r}function ri(e,t,r,n,o){$(e,function(i){i.forAll(function(a,l){a>=0&&l>=0&&$ke(a,l,t,r,n,o)})})}function $ke(e,t,r,n,o,i){var a=o(e,t),l=n;a.className&&(r==="vertical"?l=Pke(a.className,n):l=kke(a.className,n)),i(e,t,"className",l)}function Mn(e,t){var r=!1;return Array.isArray(e)&&$(e,function(n){return n.forAll(function(o,i){if(o>=0&&i>=0&&t(o,i))return r=!0,!1}),r}),r}function to(e){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(e)}function Ake(e,t){return!e.hidden||!(typeof e.hidden=="function"&&e.hidden.call(t))}function hU(e,t){for(var r=e.slice(0),n=0;n<r.length&&r[n].name===t;)r.shift();return r}function Ike(e,t){var r=e.slice(0);return r.reverse(),r=hU(r,t),r.reverse(),r}function Mke(e){var t=[];return $(e,function(r,n){n>0?t[t.length-1].name!==r.name&&t.push(r):t.push(r)}),t}function xke(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ye,r=e.slice(0);return r=hU(r,t),r=Ike(r,t),r=Mke(r),r}function Zh(e){"@babel/helpers - typeof";return Zh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zh(e)}function Dke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Hke(n.key),n)}}function Nke(e,t,r){return t&&nD(e.prototype,t),r&&nD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hke(e){var t=Lke(e,"string");return Zh(t)==="symbol"?t:String(t)}function Lke(e,t){if(Zh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var jke=250,Fke=250,dU=function(){function e(t){Dke(this,e),this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(t)}return Nke(e,[{key:"hide",value:function(){var r=this;this.wasLastActionShow=!1,this.hidingTimer=setTimeout(function(){r.wasLastActionShow===!1&&r.runLocalHooks("hide")},Fke)}},{key:"show",value:function(r){this.wasLastActionShow=!0,this.showDebounced(r)}},{key:"cancelHiding",value:function(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}},{key:"updateDelay",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:jke;this.showDebounced=vE(function(o){r.wasLastActionShow&&r.runLocalHooks("show",o.from.row,o.from.col)},n)}},{key:"destroy",value:function(){this.clearLocalHooks()}}]),e}();pt(dU,kr);const Bke=dU;function yu(e){"@babel/helpers - typeof";return yu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yu(e)}function Yw(e,t,r){return t=vU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Vke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vU(n.key),n)}}function Wke(e,t,r){return t&&oD(e.prototype,t),r&&oD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vU(e){var t=Uke(e,"string");return yu(t)==="symbol"?t:String(t)}function Uke(e,t){if(yu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function la(){return typeof Reflect<"u"&&Reflect.get?la=Reflect.get.bind():la=function(t,r,n){var o=zke(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},la.apply(this,arguments)}function zke(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ho(e),e!==null););return e}function Yke(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_O(e,t)}function _O(e,t){return _O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_O(e,t)}function Gke(e){var t=qke();return function(){var n=ho(e),o;if(t){var i=ho(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Kke(this,o)}}function Kke(e,t){if(t&&(yu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yU(e)}function yU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qke(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ho(e){return ho=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ho(e)}var Gw="comments",Xke=60,vy=new WeakMap,Rn="comment",Sl="value",iD="style",yy="readOnly",Zke=function(e){Yke(r,e);var t=Gke(r);function r(n){var o;return Vke(this,r),o=t.call(this,n),o.editor=null,o.displaySwitch=null,o.eventManager=null,o.range={},o.preventEditorAutoSwitch=!1,vy.set(yU(o),{tempEditorDimensions:{},cellBelowCursor:null}),o}return Wke(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Gw]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.editor||(this.editor=new Oke(this.hot.rootDocument,this.hot.isRtl())),this.eventManager||(this.eventManager=new Tt(this)),this.displaySwitch||(this.displaySwitch=new Bke(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",function(i){return o.addToContextMenu(i)}),this.addHook("afterRenderer",function(i,a,l,s,u,f){return o.onAfterRenderer(i,f)}),this.addHook("afterScrollHorizontally",function(){return o.hide()}),this.addHook("afterScrollVertically",function(){return o.hide()}),this.addHook("afterBeginEditing",function(){return o.hide()}),this.displaySwitch.addLocalHook("hide",function(){return o.hide()}),this.displaySwitch.addLocalHook("show",function(i,a){return o.showAtCell(i,a)}),this.registerListeners(),la(ho(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),la(ho(r.prototype),"updatePlugin",this).call(this),this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}},{key:"disablePlugin",value:function(){la(ho(r.prototype),"disablePlugin",this).call(this)}},{key:"registerListeners",value:function(){var o=this,i=this.hot.rootDocument;this.eventManager.addEventListener(i,"mouseover",function(a){return o.onMouseOver(a)}),this.eventManager.addEventListener(i,"mousedown",function(a){return o.onMouseDown(a)}),this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()}),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",function(){return o.onEditorBlur()}),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",function(a){return o.onEditorMouseDown(a)}),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",function(a){return o.onEditorMouseUp(a)})}},{key:"setRange",value:function(o){this.range=o}},{key:"clearRange",value:function(){this.range={}}},{key:"targetIsCellWithComment",value:function(o){var i=ci(o.target,"TD","TBODY");return!!(i&&xe(i,"htCommentCell")&&ci(i,[this.hot.rootElement]))}},{key:"targetIsCommentTextArea",value:function(o){return this.editor.getInputElement()===o.target}},{key:"setComment",value:function(o){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var i=this.editor.getValue(),a="";o!=null?a=o:i!=null&&(a=i);var l=this.range.from.row,s=this.range.from.col;this.updateCommentMeta(l,s,Yw({},Sl,a)),this.hot.render()}},{key:"setCommentAtCell",value:function(o,i,a){this.setRange({from:this.hot._createCellCoords(o,i)}),this.setComment(a)}},{key:"removeComment",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Rn),o&&this.hot.render(),this.hide()}},{key:"removeCommentAtCell",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(o,i)}),this.removeComment(a)}},{key:"getComment",value:function(){var o=this.range.from.row,i=this.range.from.col;return this.getCommentMeta(o,i,Sl)}},{key:"getCommentAtCell",value:function(o,i){return this.getCommentMeta(o,i,Sl)}},{key:"show",value:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var o=this.range.from,i=o.row,a=o.col;if(i<0||i>this.hot.countSourceRows()-1||a<0||a>this.hot.countSourceCols()-1)return!1;var l=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.editor.setValue(l[Rn]?l[Rn][Sl]:""),this.editor.show(),this.refreshEditor(!0),!0}},{key:"showAtCell",value:function(o,i){return this.setRange({from:this.hot._createCellCoords(o,i)}),this.show()}},{key:"hide",value:function(){this.editor.hide()}},{key:"refreshEditor",value:function(){var o,i,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(!a&&(!this.range.from||!this.editor.isVisible()))){var l=this.hot,s=l.rowIndexMapper,u=l.columnIndexMapper,f=this.range.from,c=f.row,h=f.col,d=s.getRenderableFromVisualIndex(c),v=u.getRenderableFromVisualIndex(h),g=d===null;this.editor.setPosition(0,0),d===null&&(d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(c,-1))),v===null&&(v=u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(h,-1)));var m=d===null,w=v===null;d=(o=d)!==null&&o!==void 0?o:0,v=(i=v)!==null&&i!==void 0?i:0;var S=this.hot,C=S.rootWindow,P=S.view._wt,R=P.wtTable,V=P.getCell({row:d,col:v},!0),U=this.getCommentMeta(c,h,iD);U?this.editor.setSize(U.width,U.height):this.editor.resetSize();var X=w?0:R.getStretchedColumnWidth(v),Y=g&&!m?Rt(V):0,q=V.getBoundingClientRect(),Z=q.left,ie=q.top,Q=q.width,le=q.height,Se=this.editor.getSize(),me=Se.width,Ce=Se.height,k=this.hot.rootWindow,y=k.innerWidth,p=k.innerHeight,b=this.hot.rootDocument.documentElement,_=Z+C.scrollX+X,T=ie+C.scrollY+Y;this.hot.isRtl()&&(_-=me+X),this.hot.isLtr()&&Z+Q+me>y?_=Z+C.scrollX-me-1:this.hot.isRtl()&&_<-(b.scrollWidth-b.clientWidth)&&(_=Z+C.scrollX+X+1),ie+Ce>p&&(T-=Ce-le+1),this.editor.setPosition(_,T),this.editor.setReadOnlyState(this.getCommentMeta(c,h,yy))}}},{key:"checkSelectionCommentsConsistency",value:function(){var o=this.hot.getSelectedRangeLast();if(!o)return!1;var i=!1,a=o.getTopStartCorner();return this.getCommentMeta(a.row,a.col,Sl)&&(i=!0),i}},{key:"updateCommentMeta",value:function(o,i,a){var l=this.hot.getCellMeta(o,i)[Rn],s;l?(s=lr(l),av(s,a)):s=a,this.hot.setCellMeta(o,i,Rn,s)}},{key:"getCommentMeta",value:function(o,i,a){var l=this.hot.getCellMeta(o,i);if(l[Rn])return l[Rn][a]}},{key:"onMouseDown",value:function(o){if(!(!this.hot.view||!this.hot.view._wt)&&!this.preventEditorAutoSwitch&&!this.targetIsCommentTextArea(o)){var i=ci(o.target,"TD","TBODY"),a=null;i&&(a=this.hot.getCoords(i)),(!i||this.range.from&&a&&(this.range.from.row!==a.row||this.range.from.col!==a.col))&&this.hide()}}},{key:"onMouseOver",value:function(o){var i=vy.get(this),a=this.hot.rootDocument;if(!(this.preventEditorAutoSwitch||this.editor.isFocused()||xe(o.target,"wtBorder")||i.cellBelowCursor===o.target||!this.editor))if(i.cellBelowCursor=a.elementFromPoint(o.clientX,o.clientY),this.targetIsCellWithComment(o)){var l=this.hot._createCellRange(this.hot.getCoords(o.target));this.displaySwitch.show(l)}else hi(o.target,a)&&!this.targetIsCommentTextArea(o)&&this.displaySwitch.hide()}},{key:"onMouseUp",value:function(){this.preventEditorAutoSwitch=!1}},{key:"onAfterRenderer",value:function(o,i){i[Rn]&&i[Rn][Sl]&&re(o,i.commentedCellClassName)}},{key:"onEditorBlur",value:function(){this.setComment()}},{key:"onEditorMouseDown",value:function(o){var i=vy.get(this);i.tempEditorDimensions={width:dt(o.target),height:Rt(o.target)}}},{key:"onEditorMouseUp",value:function(o){var i=vy.get(this),a=dt(o.target),l=Rt(o.target);(a!==i.tempEditorDimensions.width+1||l!==i.tempEditorDimensions.height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,Yw({},iD,{width:a,height:l}))}},{key:"onContextMenuAddComment",value:function(){var o=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,this.displaySwitch.cancelHiding(),this.setRange({from:o.highlight}),this.show(),this.hot.deselectCell(),this.editor.focus()}},{key:"onContextMenuRemoveComment",value:function(){var o=this,i=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,i.forAll(function(a,l){a>=0&&l>=0&&o.removeCommentAtCell(a,l,!1)}),this.hot.render()}},{key:"onContextMenuMakeReadOnly",value:function(){var o=this,i=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,i.forAll(function(a,l){if(a>=0&&l>=0){var s=!!o.getCommentMeta(a,l,yy);o.updateCommentMeta(a,l,Yw({},yy,!s))}})}},{key:"addToContextMenu",value:function(o){var i=this,a=function(){return i.hot.rowIndexMapper.getRenderableIndexesLength()>0&&i.hot.columnIndexMapper.getRenderableIndexesLength()>0};o.items.push({name:"---------"},{key:"commentsAddEdit",name:function(){return i.checkSelectionCommentsConsistency()?i.hot.getTranslatedPhrase(uT):i.hot.getTranslatedPhrase(sT)},callback:function(){return i.onContextMenuAddComment()},disabled:function(){return a()?!(i.hot.getSelectedLast()&&!i.hot.selection.isSelectedByCorner()):!0}},{key:"commentsRemove",name:function(){return this.getTranslatedPhrase(fT)},callback:function(){return i.onContextMenuRemoveComment()},disabled:function(){return a()?!(i.hot.getSelectedLast()&&!i.hot.selection.isSelectedByCorner()):!0}},{key:"commentsReadOnly",name:function(){var s=this,u=this.getTranslatedPhrase(cT),f=Mn(this.getSelectedRangeLast(),function(c,h){var d=s.getCellMeta(c,h)[Rn];if(d&&(d=d[yy]),d)return!0});return f&&(u=to(u)),u},callback:function(){return i.onContextMenuMakeReadOnly()},disabled:function(){return a()?!(i.hot.getSelectedLast()&&!i.hot.selection.isSelectedByCorner())||!i.checkSelectionCommentsConsistency():!0}})}},{key:"getDisplayDelaySetting",value:function(){var o=this.hot.getSettings()[Gw];if(Ve(o))return o.displayDelay}},{key:"destroy",value:function(){this.editor&&this.editor.destroy(),this.displaySwitch&&this.displaySwitch.destroy(),la(ho(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Gw}},{key:"PLUGIN_PRIORITY",get:function(){return Xke}}]),r}(ot);function Qh(e){"@babel/helpers - typeof";return Qh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qh(e)}function Qke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,e$e(n.key),n)}}function Jke(e,t,r){return t&&aD(e.prototype,t),r&&aD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function e$e(e){var t=t$e(e,"string");return Qh(t)==="symbol"?t:String(t)}function t$e(e,t){if(Qh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var r$e=function(){function e(t){Qke(this,e),this.hot=t,this.commands={},this.commonCallback=null}return Jke(e,[{key:"registerCommand",value:function(r,n){this.commands[r]=n}},{key:"setCommonCallback",value:function(r){this.commonCallback=r}},{key:"execute",value:function(r){for(var n=this,o=arguments.length,i=new Array(o>1?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];var l=r.split(":"),s=l[0],u=l.length===2?l[1]:null,f=this.commands[s];if(!f)throw new Error("Menu command '".concat(s,"' not exists."));if(u&&f.submenu&&(f=n$e(u,f.submenu.items)),f.disabled!==!0&&!(typeof f.disabled=="function"&&f.disabled.call(this.hot)===!0)&&!At(f,"submenu")){var c=[];typeof f.callback=="function"&&c.push(f.callback),typeof this.commonCallback=="function"&&c.push(this.commonCallback),i.unshift(l.join(":")),$(c,function(h){return h.apply(n.hot,i)})}}}]),e}();function n$e(e,t){var r;return $(t,function(n){var o=n.key?n.key.split(":"):null;if(Array.isArray(o)&&o[1]===e)return r=n,!1}),r}const gU=r$e;var Yr="alignment";function o$e(){return{key:Yr,name:function(){return this.getTranslatedPhrase(hT)},disabled:function(){return this.countRows()===0||this.countCols()===0?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:"".concat(Yr,":left"),name:function(){var t=this,r=this.getTranslatedPhrase(dT),n=Mn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htLeft")!==-1)return!0});return n&&(r=to(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Wi(r,function(a,l){return t.getCellMeta(a,l).className}),o="horizontal",i="htLeft";this.runHooks("beforeCellAlignment",n,r,o,i),ri(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(Yr,":center"),name:function(){var t=this,r=this.getTranslatedPhrase(vT),n=Mn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htCenter")!==-1)return!0});return n&&(r=to(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Wi(r,function(a,l){return t.getCellMeta(a,l).className}),o="horizontal",i="htCenter";this.runHooks("beforeCellAlignment",n,r,o,i),ri(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(Yr,":right"),name:function(){var t=this,r=this.getTranslatedPhrase(yT),n=Mn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htRight")!==-1)return!0});return n&&(r=to(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Wi(r,function(a,l){return t.getCellMeta(a,l).className}),o="horizontal",i="htRight";this.runHooks("beforeCellAlignment",n,r,o,i),ri(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(Yr,":justify"),name:function(){var t=this,r=this.getTranslatedPhrase(gT),n=Mn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htJustify")!==-1)return!0});return n&&(r=to(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Wi(r,function(a,l){return t.getCellMeta(a,l).className}),o="horizontal",i="htJustify";this.runHooks("beforeCellAlignment",n,r,o,i),ri(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{name:Ye},{key:"".concat(Yr,":top"),name:function(){var t=this,r=this.getTranslatedPhrase(pT),n=Mn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htTop")!==-1)return!0});return n&&(r=to(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Wi(r,function(a,l){return t.getCellMeta(a,l).className}),o="vertical",i="htTop";this.runHooks("beforeCellAlignment",n,r,o,i),ri(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(Yr,":middle"),name:function(){var t=this,r=this.getTranslatedPhrase(mT),n=Mn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htMiddle")!==-1)return!0});return n&&(r=to(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Wi(r,function(a,l){return t.getCellMeta(a,l).className}),o="vertical",i="htMiddle";this.runHooks("beforeCellAlignment",n,r,o,i),ri(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(Yr,":bottom"),name:function(){var t=this,r=this.getTranslatedPhrase(bT),n=Mn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htBottom")!==-1)return!0});return n&&(r=to(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Wi(r,function(a,l){return t.getCellMeta(a,l).className}),o="vertical",i="htBottom";this.runHooks("beforeCellAlignment",n,r,o,i),ri(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1}]}}}var Gm="clear_column";function i$e(){return{key:Gm,name:function(){return this.getTranslatedPhrase(QE)},callback:function(t,r){var n=r[0].start.col,o=r[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(r[0].start.row,r[0].end.row),o,"ContextMenu.clearColumn")},disabled:function(){var t=ol(this);return t?!this.selection.isSelectedByColumnHeader():!0}}}var Ov="col_left";function a$e(){return{key:Ov,name:function(){return this.getTranslatedPhrase(zE)},callback:function(){var t=this.getSelectedRangeLast().getTopLeftCorner(),r=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(r,t.col,1,"ContextMenu.columnLeft")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=ol(this);if(!t)return!0;if(this.selection.isSelectedByCorner()){var r=this.countCols();return r===0}return this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden:function(){return!this.getSettings().allowInsertColumn}}}var Rv="col_right";function l$e(){return{key:Rv,name:function(){return this.getTranslatedPhrase(YE)},callback:function(){var t=this.getSelectedRangeLast().getTopRightCorner(),r=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(r,t.col,1,"ContextMenu.columnRight")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=ol(this);return t?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols:!0},hidden:function(){return!this.getSettings().allowInsertColumn}}}var Ev="make_read_only";function s$e(){return{key:Ev,name:function(){var t=this,r=this.getTranslatedPhrase(ZE),n=Mn(this.getSelectedRange(),function(o,i){return t.getCellMeta(o,i).readOnly});return n&&(r=to(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Mn(r,function(o,i){return t.getCellMeta(o,i).readOnly});$(r,function(o){o.forAll(function(i,a){i>=0&&a>=0&&t.setCellMeta(i,a,"readOnly",!n)})}),this.render()},disabled:function(){return!!(this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}var Km="redo";function u$e(){return{key:Km,name:function(){return this.getTranslatedPhrase(XE)},callback:function(){this.redo()},hidden:function(){var t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}function f$e(e,t){return v$e(e)||d$e(e,t)||h$e(e,t)||c$e()}function c$e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function h$e(e,t){if(e){if(typeof e=="string")return lD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return lD(e,t)}}function lD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function d$e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function v$e(e){if(Array.isArray(e))return e}var Tv="remove_col";function y$e(){return{key:Tv,name:function(){var t=this.getSelected(),r=0;if(t)if(t.length>1)r=1;else{var n=f$e(t[0],4),o=n[1],i=n[3];o-i!==0&&(r=1)}return this.getTranslatedPhrase(KE,r)},callback:function(){this.alter("remove_col",xwe(this.getSelected()),null,"ContextMenu.removeColumn")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=ol(this);if(!t)return!0;var r=this.countCols();return this.selection.isSelectedByCorner()?r===0:this.selection.isSelectedByRowHeader()||r===0},hidden:function(){return!this.getSettings().allowRemoveColumn}}}function g$e(e,t){return w$e(e)||b$e(e,t)||m$e(e,t)||p$e()}function p$e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function m$e(e,t){if(e){if(typeof e=="string")return sD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return sD(e,t)}}function sD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function b$e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function w$e(e){if(Array.isArray(e))return e}var qm="remove_row";function S$e(){return{key:qm,name:function(){var t=this.getSelected(),r=0;if(t)if(t.length>1)r=1;else{var n=g$e(t[0],3),o=n[0],i=n[2];o-i!==0&&(r=1)}return this.getTranslatedPhrase(GE,r)},callback:function(){this.alter("remove_row",Dwe(this.getSelected()),1,"ContextMenu.removeRow")},disabled:function(){var t=ol(this);if(!t)return!0;var r=this.countRows();return this.selection.isSelectedByCorner()?r===0:this.selection.isSelectedByColumnHeader()||r===0},hidden:function(){return!this.getSettings().allowRemoveRow}}}var Xm="row_above";function C$e(){return{key:Xm,name:function(){return this.getTranslatedPhrase(WE)},callback:function(){var t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled:function(){var t=ol(this);if(!t)return!0;if(this.selection.isSelectedByCorner()){var r=this.countRows();return r===0}return this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden:function(){return!this.getSettings().allowInsertRow}}}var Zm="row_below";function _$e(){return{key:Zm,name:function(){return this.getTranslatedPhrase(UE)},callback:function(){var t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled:function(){var t=ol(this);return t?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows:!0},hidden:function(){return!this.getSettings().allowInsertRow}}}var Jh="no_items";function O$e(){return{key:Jh,name:function(){return this.getTranslatedPhrase(VE)},disabled:!0,isCommand:!1}}var Qm="undo";function R$e(){return{key:Qm,name:function(){return this.getTranslatedPhrase(qE)},callback:function(){this.undo()},hidden:function(){var t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}function ed(e){"@babel/helpers - typeof";return ed=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ed(e)}var cr;function $r(e,t,r){return t=E$e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function E$e(e){var t=T$e(e,"string");return ed(t)==="symbol"?t:String(t)}function T$e(e,t){if(ed(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ed(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var P$e=[Xm,Zm,Ov,Rv,Gm,qm,Tv,Qm,Km,Ev,Yr,Ye,Jh],k$e=(cr={},$r(cr,Ye,Rke),$r(cr,Jh,O$e),$r(cr,Xm,C$e),$r(cr,Zm,_$e),$r(cr,Ov,a$e),$r(cr,Rv,l$e),$r(cr,Gm,i$e),$r(cr,qm,S$e),$r(cr,Tv,y$e),$r(cr,Qm,R$e),$r(cr,Km,u$e),$r(cr,Ev,s$e),$r(cr,Yr,o$e),cr);function pU(){var e={};return We(k$e,function(t,r){e[r]=t()}),e}function td(e){"@babel/helpers - typeof";return td=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},td(e)}function $$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,I$e(n.key),n)}}function A$e(e,t,r){return t&&uD(e.prototype,t),r&&uD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function I$e(e){var t=M$e(e,"string");return td(t)==="symbol"?t:String(t)}function M$e(e,t){if(td(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(td(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var x$e=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;$$e(this,e),this.hot=t,this.predefinedItems=pU(),this.defaultOrderPattern=r}return A$e(e,[{key:"setPredefinedItems",value:function(r){var n=this,o={};this.defaultOrderPattern.length=0,We(r,function(i,a){var l="";i.name===Ye?(o[Ye]=i,l=Ye):isNaN(parseInt(a,10))?(i.key=i.key===void 0?a:i.key,o[a]=i,l=i.key):(o[i.key]=i,l=i.key),n.defaultOrderPattern.push(l)}),this.predefinedItems=o}},{key:"getItems",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return D$e(r,this.defaultOrderPattern,this.predefinedItems)}}]),e}();function D$e(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=[],o=e;return o&&o.items?o=o.items:Array.isArray(o)||(o=t),Ve(o)?We(o,function(i,a){var l=r[typeof i=="string"?i:a];l||(l=i),Ve(i)?Wt(l,i):typeof l=="string"&&(l={name:l}),l.key===void 0&&(l.key=a),n.push(l)}):$(o,function(i,a){var l=r[i];!l&&P$e.indexOf(i)>=0||(l||(l={name:i,key:"".concat(a)}),Ve(i)&&Wt(l,i),l.key===void 0&&(l.key=a),n.push(l))}),n}const mU=x$e;function rd(e){"@babel/helpers - typeof";return rd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rd(e)}function N$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,L$e(n.key),n)}}function H$e(e,t,r){return t&&fD(e.prototype,t),r&&fD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function L$e(e){var t=j$e(e,"string");return rd(t)==="symbol"?t:String(t)}function j$e(e,t){if(rd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var F$e=function(){function e(t,r){N$e(this,e);var n=fs(r),o=Ma(r),i,a,l,s,u,f;this.rootWindow=r,this.type=this.getSourceType(t),this.type==="literal"?(i=parseInt(t.top,10),l=parseInt(t.left,10),u=t.height||0,f=t.width||0,a=i,s=l,i+=n,l+=o):this.type==="event"&&(i=parseInt(t.pageY,10),l=parseInt(t.pageX,10),u=t.target.clientHeight,f=t.target.clientWidth,a=i-n,s=l-o),this.top=i,this.topRelative=a,this.left=l,this.leftRelative=s,this.scrollTop=n,this.scrollLeft=o,this.cellHeight=u,this.cellWidth=f}return H$e(e,[{key:"getSourceType",value:function(r){var n="literal";return r instanceof Event&&(n="event"),n}},{key:"fitsAbove",value:function(r){return this.topRelative>=r.offsetHeight}},{key:"fitsBelow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+r.offsetHeight<=n}},{key:"fitsOnRight",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+r.offsetWidth<=n}},{key:"fitsOnLeft",value:function(r){return this.leftRelative>=r.offsetWidth}}]),e}();const B$e=F$e;function nd(e){"@babel/helpers - typeof";return nd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nd(e)}function cD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function hD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cD(Object(r),!0).forEach(function(n){V$e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function V$e(e,t,r){return t=bU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function W$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bU(n.key),n)}}function U$e(e,t,r){return t&&dD(e.prototype,t),r&&dD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bU(e){var t=z$e(e,"string");return nd(t)==="symbol"?t:String(t)}function z$e(e,t){if(nd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var vD=215,wU="menu",Y$e=wU,SU=function(){function e(t,r){W$e(this,e),this.hot=t,this.options=r||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:vD,container:this.hot.rootDocument.documentElement},this.eventManager=new Tt(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}return U$e(e,[{key:"registerEvents",value:function(){for(var r=this,n=this.hot.rootWindow;n;)this.eventManager.addEventListener(n.document,"mousedown",function(o){return r.onDocumentMouseDown(o)}),this.eventManager.addEventListener(n.document,"contextmenu",function(o){return r.onDocumentContextMenu(o)}),n=Hc(n)}},{key:"setMenuItems",value:function(r){this.menuItems=r}},{key:"getSelectedItem",value:function(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}},{key:"hasSelectedItem",value:function(){return Array.isArray(this.hotMenu.getSelectedLast())}},{key:"setOffset",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.offset[r]=n}},{key:"isSubMenu",value:function(){return this.parentMenu!==null}},{key:"open",value:function(){var r=this;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";var n=vE(function(d){return r.openSubMenu(d)},300),o=this.options.minWidth||vD,i=!1,a=jr(this.menuItems,function(d){return d.key===Jh&&(i=!0),Ake(d,r.hot)});if(a.length<1&&!i)a.push(pU()[Jh]);else if(a.length===0)return;a=xke(a,Ye);var l=!1,s={data:a,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:function(v){return ve(v)&&v<o?o:v},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,maxCols:1,columns:[{data:"name",renderer:function(v,g,m,w,S,C){return r.menuItemRenderer(v,g,m,w,S,C)}}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",afterOnCellMouseOver:function(v,g){r.isAllSubMenusClosed()?n(g.row):r.openSubMenu(g.row)},rowHeights:function(v){return a[v].name===Ye?1:23},afterOnCellContextMenu:function(v){v.preventDefault(),wC()&&l&&r.hasSelectedItem()&&r.close(!0)},beforeOnCellMouseUp:function(v){r.hasSelectedItem()&&(l=!r.isCommandPassive(r.getSelectedItem()),r.executeCommand(v))},afterOnCellMouseUp:function(v){(!wC()||!Ei(v))&&l&&r.hasSelectedItem()&&(fn()||F0()?setTimeout(function(){return r.close(!0)},325):r.close(!0))},afterUnlisten:function(){!r.hasSelectedItem()&&r.isOpened()&&r.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new hP(this.container,s),this.hotMenu.addHook("afterInit",function(){return r.onAfterInit()}),this.hotMenu.addHook("afterSelection",function(){return r.onAfterSelection.apply(r,arguments)}),this.hotMenu.init(),this.hotMenu.listen();var u=this.hotMenu.getShortcutManager(),f=u.addContext(Y$e),c={group:wU},h=hD(hD({},c),{},{runOnlyIf:function(v){return Fc(v.target)===!1||r.container.contains(v.target)===!1}});u.setActiveContextName("menu"),f.addShortcuts([{keys:[["Escape"]],callback:function(){r.keyEvent=!0,r.close(),r.keyEvent=!1}},{keys:[["ArrowDown"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.selectNextCell(v[0],v[1]):r.selectFirstCell(),r.keyEvent=!1}},{keys:[["ArrowUp"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.selectPrevCell(v[0],v[1]):r.selectLastCell(),r.keyEvent=!1}},{keys:[["ArrowRight"]],callback:function(){var v=r.hotMenu.getSelectedLast();if(r.keyEvent=!0,v){var g=r.openSubMenu(v[0]);g&&g.selectFirstCell()}r.keyEvent=!1}},{keys:[["ArrowLeft"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v&&r.isSubMenu()&&(r.close(),r.parentMenu&&r.parentMenu.hotMenu.listen()),r.keyEvent=!1}},{keys:[["Enter"]],callback:function(v){var g=r.hotMenu.getSelectedLast();r.keyEvent=!0,r.hotMenu.getSourceDataAtRow(g[0]).submenu||(r.executeCommand(v),r.close(!0)),r.keyEvent=!1}},{keys:[["PageUp"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.hotMenu.selection.transformStart(-r.hotMenu.countVisibleRows(),0):r.selectFirstCell(),r.keyEvent=!1}},{keys:[["PageDown"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.hotMenu.selection.transformStart(r.hotMenu.countVisibleRows(),0):r.selectLastCell(),r.keyEvent=!1}}],h),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}},{key:"close",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.isOpened()&&(r&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}},{key:"openSubMenu",value:function(r){if(!this.hotMenu)return!1;var n=this.hotMenu.getCell(r,0);if(this.closeAllSubMenus(),!n||!Tke(n))return!1;var o=this.hotMenu.getSourceDataAtRow(r),i=new e(this.hot,{parent:this,name:o.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(o.submenu.items),i.open(),i.setPosition(n.getBoundingClientRect()),this.hotSubMenus[o.key]=i,i}},{key:"closeSubMenu",value:function(r){var n=this.hotMenu.getSourceDataAtRow(r),o=this.hotSubMenus[n.key];o&&(o.destroy(),delete this.hotSubMenus[n.key])}},{key:"closeAllSubMenus",value:function(){var r=this;$(this.hotMenu.getData(),function(n,o){return r.closeSubMenu(o)})}},{key:"isAllSubMenusClosed",value:function(){return Object.keys(this.hotSubMenus).length===0}},{key:"destroy",value:function(){var r=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),r&&r.removeChild(this.container)}},{key:"isOpened",value:function(){return this.hotMenu!==null}},{key:"executeCommand",value:function(r){if(!(!this.isOpened()||!this.hasSelectedItem())){var n=this.getSelectedItem();if(this.runLocalHooks("select",n,r),!this.isCommandPassive(n)){var o=this.hot.getSelectedRange(),i=o?Eke(o):[];this.runLocalHooks("executeCommand",n.key,i,r),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,i,r)}}}},{key:"isCommandPassive",value:function(r){var n=r.isCommand,o=r.name,i=r.disabled,a=r.submenu,l=i===!0||typeof i=="function"&&i.call(this.hot)===!0;return n===!1||o===Ye||l===!0||a}},{key:"setPosition",value:function(r){var n=new B$e(r,this.container.ownerDocument.defaultView);this.options.keepInViewport?(n.fitsBelow(this.container)?this.setPositionBelowCursor(n):n.fitsAbove(this.container)?this.setPositionAboveCursor(n):this.setPositionBelowCursor(n),this.hot.isLtr()?this.setHorizontalPositionForLtr(n):this.setHorizontalPositionForRtl(n)):(this.setPositionBelowCursor(n),this.setPositionOnRightOfCursor(n))}},{key:"setHorizontalPositionForRtl",value:function(r){r.fitsOnLeft(this.container)?this.setPositionOnLeftOfCursor(r):this.setPositionOnRightOfCursor(r)}},{key:"setHorizontalPositionForLtr",value:function(r){r.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(r):this.setPositionOnLeftOfCursor(r)}},{key:"setPositionAboveCursor",value:function(r){var n=this.offset.above+r.top-this.container.offsetHeight;this.isSubMenu()&&(n=r.top+r.cellHeight-this.container.offsetHeight+3),this.container.style.top="".concat(n,"px")}},{key:"setPositionBelowCursor",value:function(r){var n=this.offset.below+r.top+1;this.isSubMenu()&&(n=r.top-1),this.container.style.top="".concat(n,"px")}},{key:"setPositionOnRightOfCursor",value:function(r){var n=r.left;if(this.isSubMenu()){var o=this.parentMenu.container.getBoundingClientRect(),i=o.right;n+=r.cellWidth+i-(r.left+r.cellWidth)}else n+=this.offset.right;this.container.style.left="".concat(n,"px")}},{key:"setPositionOnLeftOfCursor",value:function(r){var n=this.offset.left+r.left-this.container.offsetWidth;if(this.isSubMenu()){var o=this.parentMenu.container.getBoundingClientRect(),i=o.left;n-=r.left-i}this.container.style.left="".concat(n,"px")}},{key:"selectFirstCell",value:function(){var r=this.hotMenu.getCell(0,0);cy(r)||hy(r)||dy(r)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}},{key:"selectLastCell",value:function(){var r=this.hotMenu.countRows()-1,n=this.hotMenu.getCell(r,0);cy(n)||hy(n)||dy(n)?this.selectPrevCell(r,0):(this.hotMenu.selectCell(r,0,void 0,void 0,!1),this.hotMenu.scrollViewportTo(r,0,!0,!1))}},{key:"selectNextCell",value:function(r,n){var o=r+1,i=o<this.hotMenu.countRows()?this.hotMenu.getCell(o,n):null;i&&(cy(i)||hy(i)||dy(i)?this.selectNextCell(o,n):this.hotMenu.selectCell(o,n))}},{key:"selectPrevCell",value:function(r,n){var o=r-1,i=o>=0?this.hotMenu.getCell(o,n):null;i&&(cy(i)||hy(i)||dy(i)?this.selectPrevCell(o,n):this.hotMenu.selectCell(o,n))}},{key:"menuItemRenderer",value:function(r,n,o,i,a,l){var s=this,u=r.getSourceDataAtRow(o),f=this.hot.rootDocument.createElement("div"),c=function(w){return At(w,"submenu")},h=function(w){return new RegExp(Ye,"i").test(w.name)},d=function(w){return w.disabled===!0||typeof w.disabled=="function"&&w.disabled.call(s.hot)===!0},v=function(w){return w.disableSelection},g=l;typeof g=="function"&&(g=g.call(this.hot)),yn(n),re(f,"htItemWrapper"),n.appendChild(f),h(u)?re(n,"htSeparator"):typeof u.renderer=="function"?(re(n,"htCustomMenuRenderer"),n.appendChild(u.renderer(r,f,o,i,a,g))):tl(f,g),d(u)?(re(n,"htDisabled"),this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()})):v(u)?(re(n,"htSelectionDisabled"),this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()})):c(u)?(re(n,"htSubmenu"),v(u)?this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()}):this.eventManager.addEventListener(n,"mouseenter",function(){return r.selectCell(o,i,void 0,void 0,!1,!1)})):(Le(n,["htSubmenu","htDisabled"]),v(u)?this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()}):this.eventManager.addEventListener(n,"mouseenter",function(){return r.selectCell(o,i,void 0,void 0,!1,!1)}))}},{key:"createContainer",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=this.options.container.ownerDocument,o=r,i;return o&&(bt(o)&&(o=o.call(this.hot),o===null||gt(o)?o="":o=o.toString()),o=o.replace(/[^A-z0-9]/g,"_"),o="".concat(this.options.className,"Sub_").concat(o),i=n.querySelector(".".concat(this.options.className,".").concat(o))),i||(i=n.createElement("div"),re(i,"htMenu ".concat(this.options.className)),o&&re(i,o),this.options.container.appendChild(i)),i}},{key:"blockMainTableCallbacks",value:function(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}},{key:"releaseMainTableCallbacks",value:function(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}},{key:"onAfterInit",value:function(){var r=this.hotMenu.view._wt.wtTable,n=this.hotMenu.getSettings().data,o=r.hider.style,i=r.holder.style,a=parseInt(o.width,10),l=Lt(n,function(s,u){return s+(u.name===Ye?1:26)},0);i.width="".concat(a+3,"px"),i.height="".concat(l+3,"px"),o.height=i.height}},{key:"onAfterSelection",value:function(r,n,o,i,a){this.keyEvent===!1&&(a.value=!0)}},{key:"onDocumentMouseDown",value:function(r){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!hi(r.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!hi(r.target,".htMenu")&&this.close(!0))}},{key:"onDocumentContextMenu",value:function(r){this.isOpened()&&xe(r.target,"htCore")&&hi(r.target,this.hotMenu.rootElement)&&r.preventDefault()}}]),e}();pt(SU,kr);const PP=SU;function gu(e){"@babel/helpers - typeof";return gu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gu(e)}function G$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,q$e(n.key),n)}}function K$e(e,t,r){return t&&yD(e.prototype,t),r&&yD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function q$e(e){var t=X$e(e,"string");return gu(t)==="symbol"?t:String(t)}function X$e(e,t){if(gu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sa(){return typeof Reflect<"u"&&Reflect.get?sa=Reflect.get.bind():sa=function(t,r,n){var o=Z$e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},sa.apply(this,arguments)}function Z$e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=vo(e),e!==null););return e}function Q$e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&OO(e,t)}function OO(e,t){return OO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},OO(e,t)}function J$e(e){var t=t1e();return function(){var n=vo(e),o;if(t){var i=vo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return e1e(this,o)}}function e1e(e,t){if(t&&(gu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return CU(e)}function CU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function t1e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vo(e){return vo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vo(e)}var gy="contextMenu",r1e=70;pe.getSingleton().register("afterContextMenuDefaultOptions");pe.getSingleton().register("beforeContextMenuShow");pe.getSingleton().register("afterContextMenuShow");pe.getSingleton().register("afterContextMenuHide");pe.getSingleton().register("afterContextMenuExecute");var _U=function(e){Q$e(r,e);var t=J$e(r);function r(n){var o;return G$e(this,r),o=t.call(this,n),o.eventManager=new Tt(CU(o)),o.commandExecutor=new gU(o.hot),o.itemsFactory=null,o.menu=null,o}return K$e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[gy]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[gy];typeof i.callback=="function"&&this.commandExecutor.setCommonCallback(i.callback),this.menu=new PP(this.hot,{className:"htContextMenu",keepInViewport:!0,container:i.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",function(){return o.onMenuBeforeOpen()}),this.menu.addLocalHook("afterOpen",function(){return o.onMenuAfterOpen()}),this.menu.addLocalHook("afterClose",function(){return o.onMenuAfterClose()}),this.menu.addLocalHook("executeCommand",function(){for(var a,l=arguments.length,s=new Array(l),u=0;u<l;u++)s[u]=arguments[u];return(a=o.executeCommand).call.apply(a,[o].concat(s))}),this.addHook("afterOnCellContextMenu",function(a){return o.onAfterOnCellContextMenu(a)}),sa(vo(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),sa(vo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),sa(vo(r.prototype),"disablePlugin",this).call(this)}},{key:"open",value:function(o){if(this.menu&&(this.prepareMenuItems(),this.menu.open(),!!this.menu.isOpened())){var i=0,a=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var l=this.hot.rootWindow.frameElement,s=l.getBoundingClientRect(),u=s.top,f=s.left;i=u-fs(o.view),a=f-Ma(o.view)}else i=-1*fs(this.menu.hotMenu.rootWindow),a=-1*Ma(this.menu.hotMenu.rootWindow);this.menu.setPosition({top:parseInt(o.pageY,10)+i,left:parseInt(o.pageX,10)+a})}}},{key:"close",value:function(){this.menu&&(this.menu.close(),this.itemsFactory=null)}},{key:"executeCommand",value:function(o){var i;this.itemsFactory===null&&this.prepareMenuItems();for(var a=arguments.length,l=new Array(a>1?a-1:0),s=1;s<a;s++)l[s-1]=arguments[s];(i=this.commandExecutor).execute.apply(i,[o].concat(l))}},{key:"prepareMenuItems",value:function(){var o=this;this.itemsFactory=new mU(this.hot,r.DEFAULT_ITEMS);var i=this.hot.getSettings()[gy],a={items:this.itemsFactory.getItems(i)};this.hot.runHooks("afterContextMenuDefaultOptions",a),this.itemsFactory.setPredefinedItems(a.items);var l=this.itemsFactory.getItems(i);this.hot.runHooks("beforeContextMenuSetItems",l),this.menu.setMenuItems(l),$(l,function(s){return o.commandExecutor.registerCommand(s.key,s)})}},{key:"onAfterOnCellContextMenu",value:function(o){var i=this.hot.getSettings(),a=i.rowHeaders,l=i.colHeaders;function s(f){return f.nodeName==="TD"||f.parentNode.nodeName==="TD"}var u=o.target;this.close(),!xe(u,"handsontableInput")&&(o.preventDefault(),o.stopPropagation(),!(!(a||l)&&!s(u)&&!(xe(u,"current")&&xe(u,"wtBorder")))&&this.open(o))}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeContextMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterContextMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),sa(vo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return gy}},{key:"PLUGIN_PRIORITY",get:function(){return r1e}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[Xm,Zm,Ye,Ov,Rv,Ye,qm,Tv,Ye,Qm,Km,Ye,Ev,Ye,Yr]}}]),r}(ot);_U.SEPARATOR={name:Ye};function n1e(e){return{key:"copy",name:function(){return this.getTranslatedPhrase(JE)},callback:function(){e.copyCellsOnly()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function o1e(e){return{key:"copy_column_headers_only",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(rT,n)},callback:function(){e.copyColumnHeadersOnly()},disabled:function(){if(!this.hasColHeaders())return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function i1e(e){return{key:"copy_with_column_group_headers",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(tT,n)},callback:function(){e.copyWithAllColumnHeaders()},disabled:function(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function a1e(e){return{key:"copy_with_column_headers",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(eT,n)},callback:function(){e.copyWithColumnHeaders()},disabled:function(){if(!this.hasColHeaders())return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function l1e(e){return{key:"cut",name:function(){return this.getTranslatedPhrase(nT)},callback:function(){e.cut()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function od(e){"@babel/helpers - typeof";return od=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},od(e)}function s1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,f1e(n.key),n)}}function u1e(e,t,r){return t&&gD(e.prototype,t),r&&gD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function f1e(e){var t=c1e(e,"string");return od(t)==="symbol"?t:String(t)}function c1e(e,t){if(od(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(od(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var h1e=function(){function e(){s1e(this,e),this.data={}}return u1e(e,[{key:"setData",value:function(r,n){this.data[r]=n}},{key:"getData",value:function(r){return this.data[r]||void 0}}]),e}();function id(e){"@babel/helpers - typeof";return id=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},id(e)}function pD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,v1e(n.key),n)}}function d1e(e,t,r){return t&&pD(e.prototype,t),r&&pD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function v1e(e){var t=y1e(e,"string");return id(t)==="symbol"?t:String(t)}function y1e(e,t){if(id(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(id(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function g1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var p1e=d1e(function e(){g1e(this,e),this.clipboardData=new h1e});function ad(e){"@babel/helpers - typeof";return ad=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ad(e)}function m1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,w1e(n.key),n)}}function b1e(e,t,r){return t&&mD(e.prototype,t),r&&mD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function w1e(e){var t=S1e(e,"string");return ad(t)==="symbol"?t:String(t)}function S1e(e,t){if(ad(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ad(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kP=function(){function e(t){m1e(this,e),this.rootDocument=t.defaultView?t:t.ownerDocument,this.mainElement=null,this.eventManager=new Tt(this),this.listenersCount=new WeakSet,this.container=t}return b1e(e,[{key:"useSecondaryElement",value:function(){var r=O1e(this.container);this.listenersCount.has(r)||(this.listenersCount.add(r),bD(this.eventManager,r,this)),this.mainElement=r}},{key:"setFocusableElement",value:function(r){this.listenersCount.has(r)||(this.listenersCount.add(r),bD(this.eventManager,r,this)),this.mainElement=r}},{key:"getFocusableElement",value:function(){return this.mainElement}},{key:"focus",value:function(){this.mainElement.value=" ",fn()||mV(this.mainElement)}}]),e}();pt(kP,kr);var $p=new WeakMap;function C1e(e){var t=new kP(e),r=$p.get(e);return r=isNaN(r)?0:r,$p.set(e,r+1),t}function _1e(e){e.eventManager.clear()}var Kw=function(t,r){return function(n){return r.runLocalHooks(t,n)}};function bD(e,t,r){e.addEventListener(t,"copy",Kw("copy",r)),e.addEventListener(t,"cut",Kw("cut",r)),e.addEventListener(t,"paste",Kw("paste",r))}var Ap=new WeakMap;function O1e(e){var t=Ap.get(e);if(t)return t.parentElement||e.appendChild(t),t;var r=e.defaultView?e:e.ownerDocument,n=r.createElement("textarea");return Ap.set(e,n),n.setAttribute("data-hot-input",""),n.className="HandsontableCopyPaste",n.tabIndex=-1,n.autocomplete="off",n.wrap="hard",n.value=" ",e.appendChild(n),n}function wD(e){if(e instanceof kP){var t=$p.get(e.container);if(t=isNaN(t)?0:t,t>0&&(t-=1),_1e(e),t<=0){t=0;var r=Ap.get(e.container);r&&r.parentNode&&(r.parentNode.removeChild(r),Ap.delete(e.container)),e.mainElement=null}$p.set(e.container,t)}}function ld(e){"@babel/helpers - typeof";return ld=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ld(e)}function R1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,T1e(n.key),n)}}function E1e(e,t,r){return t&&SD(e.prototype,t),r&&SD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function T1e(e){var t=P1e(e,"string");return ld(t)==="symbol"?t:String(t)}function P1e(e,t){if(ld(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ld(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function CD(e,t){OU(e,t),t.add(e)}function Cl(e,t,r){OU(e,t),t.set(e,r)}function OU(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function py(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}function vr(e,t){var r=RU(e,t,"get");return k1e(e,r)}function k1e(e,t){return t.get?t.get.call(e):t.value}function _l(e,t,r){var n=RU(e,t,"set");return $1e(e,n,r),r}function RU(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function $1e(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Ko=new WeakMap,qw=new WeakMap,Gf=new WeakMap,RO=new WeakMap,EO=new WeakMap,Kf=new WeakMap,my=new WeakSet,_D=new WeakSet,A1e=function(){function e(t){var r=t.countRows,n=t.countColumns,o=t.rowsLimit,i=t.columnsLimit,a=t.countColumnHeaders;R1e(this,e),CD(this,_D),CD(this,my),Cl(this,Ko,{writable:!0,value:void 0}),Cl(this,qw,{writable:!0,value:void 0}),Cl(this,Gf,{writable:!0,value:void 0}),Cl(this,RO,{writable:!0,value:void 0}),Cl(this,EO,{writable:!0,value:void 0}),Cl(this,Kf,{writable:!0,value:void 0}),_l(this,qw,r),_l(this,Gf,n),_l(this,RO,o),_l(this,EO,i),_l(this,Kf,a)}return E1e(e,[{key:"setSelectedRange",value:function(r){_l(this,Ko,r)}},{key:"getCellsRange",value:function(){if(vr(this,qw).call(this)===0||vr(this,Gf).call(this)===0)return null;var r=vr(this,Ko).getTopStartCorner(),n=r.row,o=r.col,i=vr(this,Ko).getBottomEndCorner(),a=i.row,l=i.col,s=py(this,_D,I1e).call(this,n,a),u=py(this,my,Xw).call(this,o,l),f=a!==s||l!==u;return{isRangeTrimmed:f,startRow:n,startCol:o,endRow:s,endCol:u}}},{key:"getMostBottomColumnHeadersRange",value:function(){if(vr(this,Gf).call(this)===0||vr(this,Kf).call(this)===0)return null;var r=vr(this,Ko).getTopStartCorner(),n=r.col,o=vr(this,Ko).getBottomEndCorner(),i=o.col,a=py(this,my,Xw).call(this,n,i),l=i!==a;return{isRangeTrimmed:l,startRow:-1,startCol:n,endRow:-1,endCol:a}}},{key:"getAllColumnHeadersRange",value:function(){if(vr(this,Gf).call(this)===0||vr(this,Kf).call(this)===0)return null;var r=vr(this,Ko).getTopStartCorner(),n=r.col,o=vr(this,Ko).getBottomEndCorner(),i=o.col,a=py(this,my,Xw).call(this,n,i),l=i!==a;return{isRangeTrimmed:l,startRow:-vr(this,Kf).call(this),startCol:n,endRow:-1,endCol:a}}}]),e}();function Xw(e,t){return Math.min(t,Math.max(e+vr(this,EO).call(this)-1,e))}function I1e(e,t){return Math.min(t,Math.max(e+vr(this,RO).call(this)-1,e))}function EU(e){var t=[],r=[];return $(e,function(n){var o=Math.min(n.startRow,n.endRow),i=Math.max(n.startRow,n.endRow);_e(o,i,function(s){t.indexOf(s)===-1&&t.push(s)});var a=Math.min(n.startCol,n.endCol),l=Math.max(n.startCol,n.endCol);_e(a,l,function(s){r.indexOf(s)===-1&&r.push(s)})}),{rows:t,columns:r}}function M1e(e,t){return H1e(e)||N1e(e,t)||D1e(e,t)||x1e()}function x1e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function D1e(e,t){if(e){if(typeof e=="string")return OD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return OD(e,t)}}function OD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function N1e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function H1e(e){if(Array.isArray(e))return e}function Ua(e){"@babel/helpers - typeof";return Ua=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ua(e)}function L1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,PU(n.key),n)}}function j1e(e,t,r){return t&&RD(e.prototype,t),r&&RD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ua(){return typeof Reflect<"u"&&Reflect.get?ua=Reflect.get.bind():ua=function(t,r,n){var o=F1e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ua.apply(this,arguments)}function F1e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=yo(e),e!==null););return e}function B1e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&TO(e,t)}function TO(e,t){return TO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},TO(e,t)}function V1e(e){var t=U1e();return function(){var n=yo(e),o;if(t){var i=yo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return W1e(this,o)}}function W1e(e,t){if(t&&(Ua(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dr(e)}function dr(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function U1e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yo(e){return yo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yo(e)}function z1e(e,t){TU(e,t),t.add(e)}function Ui(e,t,r){TU(e,t),t.set(e,r)}function TU(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ol(e,t,r){return t=PU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function PU(e){var t=Y1e(e,"string");return Ua(t)==="symbol"?t:String(t)}function Y1e(e,t){if(Ua(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ua(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function G1e(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}function Ar(e,t){var r=kU(e,t,"get");return K1e(e,r)}function K1e(e,t){return t.get?t.get.call(e):t.value}function Gn(e,t,r){var n=kU(e,t,"set");return q1e(e,n,r),r}function kU(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function q1e(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}pe.getSingleton().register("afterCopyLimit");pe.getSingleton().register("modifyCopyableRange");pe.getSingleton().register("beforeCut");pe.getSingleton().register("afterCut");pe.getSingleton().register("beforePaste");pe.getSingleton().register("afterPaste");pe.getSingleton().register("beforeCopy");pe.getSingleton().register("afterCopy");var by="copyPaste",X1e=80,Z1e=["fragmentSelection"],ED=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join(""),Zw=new WeakMap,Qw=new WeakMap,Jw=new WeakMap,Rl=new WeakMap,wy=new WeakMap,Sy=new WeakMap,El=new WeakMap,TD=new WeakSet,Q1e=function(e){B1e(r,e);var t=V1e(r);function r(){var n;L1e(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),z1e(dr(n),TD),Ol(dr(n),"columnsLimit",1/0),Ol(dr(n),"rowsLimit",1/0),Ol(dr(n),"pasteMode","overwrite"),Ol(dr(n),"uiContainer",n.hot.rootDocument.body),Ui(dr(n),Zw,{writable:!0,value:!1}),Ui(dr(n),Qw,{writable:!0,value:!1}),Ui(dr(n),Jw,{writable:!0,value:!1}),Ui(dr(n),Rl,{writable:!0,value:"cells-only"}),Ui(dr(n),wy,{writable:!0,value:!1}),Ui(dr(n),Sy,{writable:!0,value:!1}),Ui(dr(n),El,{writable:!0,value:new A1e({countRows:function(){return n.hot.countRows()},countColumns:function(){return n.hot.countCols()},rowsLimit:function(){return n.rowsLimit},columnsLimit:function(){return n.columnsLimit},countColumnHeaders:function(){return n.hot.view.getColumnHeadersCount()}})}),Ol(dr(n),"copyableRanges",[]),Ol(dr(n),"focusableElement",void 0),n}return j1e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[by]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings(),a=i[by];if(Ua(a)==="object"){var l,s;this.pasteMode=(l=a.pasteMode)!==null&&l!==void 0?l:this.pasteMode,this.rowsLimit=isNaN(a.rowsLimit)?this.rowsLimit:a.rowsLimit,this.columnsLimit=isNaN(a.columnsLimit)?this.columnsLimit:a.columnsLimit,Gn(this,Zw,!!a.copyColumnHeaders),Gn(this,Qw,!!a.copyColumnGroupHeaders),Gn(this,Jw,!!a.copyColumnHeadersOnly),this.uiContainer=(s=a.uiContainer)!==null&&s!==void 0?s:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",function(u){return o.onAfterContextMenuDefaultOptions(u)}),this.addHook("afterOnCellMouseUp",function(){return o.onAfterOnCellMouseUp()}),this.addHook("afterSelectionEnd",function(){return o.onAfterSelectionEnd()}),this.addHook("beforeKeyDown",function(){return o.onBeforeKeyDown()}),this.focusableElement=C1e(this.uiContainer),this.focusableElement.addLocalHook("copy",function(u){return o.onCopy(u)}).addLocalHook("cut",function(u){return o.onCut(u)}).addLocalHook("paste",function(u){return o.onPaste(u)}),ua(yo(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),ua(yo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.focusableElement&&wD(this.focusableElement),ua(yo(r.prototype),"disablePlugin",this).call(this)}},{key:"copy",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Gn(this,Rl,o),Gn(this,wy,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}},{key:"copyCellsOnly",value:function(){this.copy("cells-only")}},{key:"copyColumnHeadersOnly",value:function(){this.copy("column-headers-only")}},{key:"copyWithAllColumnHeaders",value:function(){this.copy("with-column-group-headers")}},{key:"copyWithColumnHeaders",value:function(){this.copy("with-column-headers")}},{key:"cut",value:function(){Gn(this,Sy,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}},{key:"getRangedCopyableData",value:function(o){return _c(this.getRangedData(o))}},{key:"getRangedData",value:function(o){var i=this,a=[],l=EU(o),s=l.rows,u=l.columns;return $(s,function(f){var c=[];$(u,function(h){f<0?c.push(i.hot.getColHeader(h,f)):c.push(i.hot.getCopyableData(f,h))}),a.push(c)}),a}},{key:"paste",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:o;if(!(!o&&!i)){var a=new p1e;o&&a.clipboardData.setData("text/plain",o),i&&a.clipboardData.setData("text/html",i),this.getOrCreateFocusableElement(),this.onPaste(a)}}},{key:"setCopyableText",value:function(){var o=this.hot.getSelectedRangeLast();if(o){Ar(this,El).setSelectedRange(o);var i=new Map([["headers",null],["cells",null]]);Ar(this,Rl)==="column-headers-only"?i.set("headers",Ar(this,El).getMostBottomColumnHeadersRange()):(Ar(this,Rl)==="with-column-headers"?i.set("headers",Ar(this,El).getMostBottomColumnHeadersRange()):Ar(this,Rl)==="with-column-group-headers"&&i.set("headers",Ar(this,El).getAllColumnHeadersRange()),i.set("cells",Ar(this,El).getCellsRange())),this.copyableRanges=Array.from(i.values()).filter(function(c){return c!==null}).map(function(c){var h=c.startRow,d=c.startCol,v=c.endRow,g=c.endCol;return{startRow:h,startCol:d,endRow:v,endCol:g}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);var a=i.get("cells");if(a!==null&&a.isRangeTrimmed){var l=a.startRow,s=a.startCol,u=a.endRow,f=a.endCol;this.hot.runHooks("afterCopyLimit",u-l+1,f-s+1,this.rowsLimit,this.columnsLimit)}}}},{key:"getOrCreateFocusableElement",value:function(){var o,i=(o=this.hot.getActiveEditor())===null||o===void 0?void 0:o.TEXTAREA;i?this.focusableElement.setFocusableElement(i):this.focusableElement.useSecondaryElement()}},{key:"isEditorOpened",value:function(){var o;return(o=this.hot.getActiveEditor())===null||o===void 0?void 0:o.isOpened()}},{key:"populateValues",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(o.length){for(var a=o.length,l=o[0].length,s=[],u=i.getTopStartCorner(),f=u.row,c=u.col,h=i.getBottomEndCorner(),d=h.row,v=h.col,g=f,m=c,w=f,S=c;s.length<a||g<=d;){var C=this.hot.getCellMeta(g,c),P=C.skipRowOnPaste,R=C.visualRow;if(g=R+1,P!==!0){w=R,m=c;for(var V=[],U=s.length%a;V.length<l||m<=v;){var X=this.hot.getCellMeta(f,m),Y=X.skipColumnOnPaste,q=X.visualCol;if(m=q+1,Y!==!0){S=q;var Z=V.length%l;V.push(o[U][Z])}}s.push(V)}}return this.hot.populateFromArray(f,c,s,void 0,void 0,"CopyPaste.paste",this.pasteMode),[f,c,w,S]}}},{key:"onCopy",value:function(o){if(!(!this.hot.isListening()&&!Ar(this,wy)||this.isEditorOpened())){this.setCopyableText(),Gn(this,wy,!1);var i=this.getRangedData(this.copyableRanges),a=G1e(this,TD,J1e).call(this,this.copyableRanges),l=!!this.hot.runHooks("beforeCopy",i,this.copyableRanges,a);if(l){var s=_c(i);if(o&&o.clipboardData){var u=YC(i,this.hot.rootDocument);o.clipboardData.setData("text/plain",s),o.clipboardData.setData("text/html",[ED,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",s);this.hot.runHooks("afterCopy",i,this.copyableRanges,a)}Gn(this,Rl,"cells-only"),o.preventDefault()}}},{key:"onCut",value:function(o){if(!(!this.hot.isListening()&&!Ar(this,Sy)||this.isEditorOpened())){this.setCopyableText(),Gn(this,Sy,!1);var i=this.getRangedData(this.copyableRanges),a=!!this.hot.runHooks("beforeCut",i,this.copyableRanges);if(a){var l=_c(i);if(o&&o.clipboardData){var s=YC(i,this.hot.rootDocument);o.clipboardData.setData("text/plain",l),o.clipboardData.setData("text/html",[ED,s].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",i,this.copyableRanges)}o.preventDefault()}}},{key:"onPaste",value:function(o){if(!(!this.hot.isListening()||this.isEditorOpened())){o&&o.preventDefault&&o.preventDefault();var i;if(o&&typeof o.clipboardData<"u"){var a=Pm(o.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});if(a&&/(<table)|(<TABLE)/g.test(a)){var l=BV(a,this.hot.rootDocument);i=l.data}else i=o.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(i=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof i=="string"&&(i=nSe(i)),!(i&&i.length===0)&&this.hot.runHooks("beforePaste",i,this.copyableRanges)!==!1){var s=this.populateValues(i),u=M1e(s,4),f=u[0],c=u[1],h=u[2],d=u[3];this.hot.selectCell(f,c,Math.min(this.hot.countRows()-1,h),Math.min(this.hot.countCols()-1,d)),this.hot.runHooks("afterPaste",i,this.copyableRanges)}}}},{key:"onAfterContextMenuDefaultOptions",value:function(o){o.items.push({name:"---------"},n1e(this)),Ar(this,Zw)&&o.items.push(a1e(this)),Ar(this,Qw)&&o.items.push(i1e(this)),Ar(this,Jw)&&o.items.push(o1e(this)),o.items.push(l1e(this))}},{key:"onAfterOnCellMouseUp",value:function(){!this.hot.isListening()||this.isEditorOpened()||this.hot.getSettings().fragmentSelection||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}},{key:"onAfterSelectionEnd",value:function(){this.isEditorOpened()||(this.getOrCreateFocusableElement(),!(this.hot.getSettings().fragmentSelection&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&yV())&&(this.setCopyableText(),this.focusableElement.focus()))}},{key:"onBeforeKeyDown",value:function(){if(!(!this.hot.isListening()||this.isEditorOpened())){var o=this.hot.rootDocument.activeElement,i=this.hot.getActiveEditor();!i||o!==this.focusableElement.getFocusableElement()&&o!==i.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}}},{key:"destroy",value:function(){this.focusableElement&&(wD(this.focusableElement),this.focusableElement=null),ua(yo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return by}},{key:"SETTING_KEYS",get:function(){return[by].concat(Z1e)}},{key:"PLUGIN_PRIORITY",get:function(){return X1e}}]),r}(ot);function J1e(e){for(var t=EU(e),r=t.rows,n=0,o=0;o<r.length&&!(r[o]>=0);o++)n+=1;return{columnHeadersCount:n}}function $U(e,t){return"border_row".concat(e,"col").concat(t)}function fc(){return{width:1,color:"#000"}}function go(){return{hide:!0}}function eAe(){return{width:1,color:"#000",cornerVisible:!1}}function eS(e){if(ve(e.start)||ve(e.left)){var t;e.start=(t=e.start)!==null&&t!==void 0?t:e.left}if(ve(e.end)||ve(e.right)){var r;e.end=(r=e.end)!==null&&r!==void 0?r:e.right}return delete e.left,delete e.right,e}function qf(e){return ve(e.start)&&(e.left=e.start),ve(e.end)&&(e.right=e.end),e}function tS(e,t){return{id:$U(e,t),border:eAe(),row:e,col:t,top:go(),bottom:go(),start:go(),end:go()}}function tAe(e,t){return At(t,"border")&&t.border&&(e.border=t.border),At(t,"top")&&ve(t.top)&&(t.top?(Ve(t.top)||(t.top=fc()),e.top=t.top):(t.top=go(),e.top=t.top)),At(t,"bottom")&&ve(t.bottom)&&(t.bottom?(Ve(t.bottom)||(t.bottom=fc()),e.bottom=t.bottom):(t.bottom=go(),e.bottom=t.bottom)),At(t,"start")&&ve(t.start)&&(t.start?(Ve(t.start)||(t.start=fc()),e.start=t.start):(t.start=go(),e.start=t.start)),At(t,"end")&&ve(t.end)&&(t.end?(Ve(t.end)||(t.end=fc()),e.end=t.end):(t.end=go(),e.end=t.end)),e}function Ho(e,t){var r=!1;return $(e.getSelectedRange(),function(n){n.forAll(function(o,i){if(!(o<0||i<0)){var a=e.getCellMeta(o,i).borders;if(a)if(t){if(!At(a[t],"hide")||a[t].hide===!1)return r=!0,!1}else return r=!0,!1}})}),r}function Jm(e){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(e)}function rAe(e){return e.some(function(t){return ve(t.left)||ve(t.right)})}function nAe(e){return e.some(function(t){return ve(t.start)||ve(t.end)})}var oAe=new Map([["left","start"],["right","end"]]);function iAe(e){var t;return(t=oAe.get(e))!==null&&t!==void 0?t:e}function aAe(e){return{key:"borders:bottom",name:function(){var r=this.getTranslatedPhrase(_T),n=Ho(this,"bottom");return n&&(r=Jm(r)),r},callback:function(r,n){var o=Ho(this,"bottom");e.prepareBorder(n,"bottom",o)}}}function lAe(e){var t=e.hot.isRtl()?"end":"start";return{key:"borders:left",name:function(){var n=this.getTranslatedPhrase(OT),o=Ho(this,t);return o&&(n=Jm(n)),n},callback:function(n,o){var i=Ho(this,t);e.prepareBorder(o,t,i)}}}function sAe(e){return{key:"borders:no_borders",name:function(){return this.getTranslatedPhrase(RT)},callback:function(r,n){e.prepareBorder(n,"noBorders")},disabled:function(){return!Ho(this)}}}function uAe(e){var t=e.hot.isRtl()?"start":"end";return{key:"borders:right",name:function(){var n=this.getTranslatedPhrase(CT),o=Ho(this,t);return o&&(n=Jm(n)),n},callback:function(n,o){var i=Ho(this,t);e.prepareBorder(o,t,i)}}}function fAe(e){return{key:"borders:top",name:function(){var r=this.getTranslatedPhrase(ST),n=Ho(this,"top");return n&&(r=Jm(r)),r},callback:function(r,n){var o=Ho(this,"top");e.prepareBorder(n,"top",o)}}}function pu(e){"@babel/helpers - typeof";return pu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pu(e)}function PD(e,t){return vAe(e)||dAe(e,t)||hAe(e,t)||cAe()}function cAe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hAe(e,t){if(e){if(typeof e=="string")return kD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return kD(e,t)}}function kD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function dAe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function vAe(e){if(Array.isArray(e))return e}function yAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $D(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,IU(n.key),n)}}function gAe(e,t,r){return t&&$D(e.prototype,t),r&&$D(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fa(){return typeof Reflect<"u"&&Reflect.get?fa=Reflect.get.bind():fa=function(t,r,n){var o=pAe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},fa.apply(this,arguments)}function pAe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=po(e),e!==null););return e}function mAe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&PO(e,t)}function PO(e,t){return PO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},PO(e,t)}function bAe(e){var t=SAe();return function(){var n=po(e),o;if(t){var i=po(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return wAe(this,o)}}function wAe(e,t){if(t&&(pu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return AU(e)}function AU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function SAe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function po(e){return po=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},po(e)}function CAe(e,t,r){return t=IU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function IU(e){var t=_Ae(e,"string");return pu(t)==="symbol"?t:String(t)}function _Ae(e,t){if(pu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Cy="customBorders",OAe=90,RAe=function(e){mAe(r,e);var t=bAe(r);function r(){var n;yAe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),CAe(AU(n),"savedBorders",[]),n}return gAe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Cy]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(i){return o.onAfterContextMenuDefaultOptions(i)}),this.addHook("init",function(){return o.onAfterInit()}),fa(po(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hideBorders(),fa(po(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),fa(po(r.prototype),"updatePlugin",this).call(this)}},{key:"setBorders",value:function(o,i){var a=this,l=["top","bottom","start","end"],s=null;i&&(this.checkSettingsCohesion([i]),l=Object.keys(i),s=eS(i));var u=Bs(o),f=Dh(u);$(o,function(c){for(var h=f(c),d=PD(h,4),v=d[0],g=d[1],m=d[2],w=d[3],S=function(R){for(var V=function(Y){$(l,function(q){a.prepareBorderFromCustomAdded(R,Y,s,iAe(q))})},U=g;U<=w;U+=1)V(U)},C=v;C<=m;C+=1)S(C)}),this.hot.view.render()}},{key:"getBorders",value:function(o){var i=this;if(!Array.isArray(o))return this.savedBorders;var a=Bs(o),l=Dh(a),s=[];return $(o,function(u){for(var f=l(u),c=PD(f,4),h=c[0],d=c[1],v=c[2],g=c[3],m=function(C){for(var P=function(U){$(i.savedBorders,function(X){X.row===C&&X.col===U&&s.push(qf(X))})},R=d;R<=g;R+=1)P(R)},w=h;w<=v;w+=1)m(w)}),s}},{key:"clearBorders",value:function(o){var i=this;o?this.setBorders(o):($(this.savedBorders,function(a){i.clearBordersFromSelectionSettings(a.id),i.clearNullCellRange(),i.hot.removeCellMeta(a.row,a.col,"borders")}),this.savedBorders.length=0)}},{key:"insertBorderIntoSettings",value:function(o,i){var a=this.checkSavedBorders(o);a||this.savedBorders.push(o);var l=this.hot._createCellRange(this.hot._createCellCoords(o.row,o.col)),s=this.checkCustomSelections(o,l,i);s||this.hot.selection.highlight.addCustomSelection({border:o,visualCellRange:l})}},{key:"prepareBorderFromCustomAdded",value:function(o,i,a,l){var s=this.hot.countRows(),u=this.hot.countCols();if(!(o>=s||i>=u)){var f=tS(o,i);a&&(f=tAe(f,a),$(this.hot.selection.highlight.customSelections,function(c){if(f.id===c.settings.id)return Object.assign(c.settings,a),f.id=c.settings.id,f.top=c.settings.top,f.bottom=c.settings.bottom,f.start=c.settings.start,f.end=c.settings.end,!1})),this.hot.setCellMeta(o,i,"borders",qf(f)),this.insertBorderIntoSettings(f,l)}}},{key:"prepareBorderFromCustomAddedRange",value:function(o,i){var a=this,l=Math.min(o.to.row,this.hot.countRows()-1),s=Math.min(o.to.col,this.hot.countCols()-1);_e(o.from.row,l,function(u){_e(o.from.col,s,function(f){var c=tS(u,f),h=0;u===o.from.row&&At(i,"top")&&(h+=1,c.top=i.top),u===o.to.row&&At(i,"bottom")&&(h+=1,c.bottom=i.bottom),f===o.from.col&&At(i,"start")&&(h+=1,c.start=i.start),f===o.to.col&&At(i,"end")&&(h+=1,c.end=i.end),h>0&&(a.hot.setCellMeta(u,f,"borders",qf(c)),a.insertBorderIntoSettings(c))})})}},{key:"removeAllBorders",value:function(o,i){var a=$U(o,i);this.spliceBorder(a),this.clearBordersFromSelectionSettings(a),this.clearNullCellRange(),this.hot.removeCellMeta(o,i,"borders")}},{key:"setBorder",value:function(o,i,a,l){var s=this.hot.getCellMeta(o,i).borders;if(!s||s.border===void 0?s=tS(o,i):s=eS(s),l){s[a]=go();var u=this.countHide(s);if(u===4)this.removeAllBorders(o,i);else{var f=this.checkCustomSelectionsFromContextMenu(s,a,l);f||this.insertBorderIntoSettings(s),this.hot.setCellMeta(o,i,"borders",qf(s))}}else{s[a]=fc();var c=this.checkCustomSelectionsFromContextMenu(s,a,l);c||this.insertBorderIntoSettings(s),this.hot.setCellMeta(o,i,"borders",qf(s))}}},{key:"prepareBorder",value:function(o,i,a){var l=this;$(o,function(s){var u=s.start,f=s.end;if(u.row===f.row&&u.col===f.col)i==="noBorders"?l.removeAllBorders(u.row,u.col):l.setBorder(u.row,u.col,i,a);else switch(i){case"noBorders":_e(u.col,f.col,function(c){_e(u.row,f.row,function(h){l.removeAllBorders(h,c)})});break;case"top":_e(u.col,f.col,function(c){l.setBorder(u.row,c,i,a)});break;case"bottom":_e(u.col,f.col,function(c){l.setBorder(f.row,c,i,a)});break;case"start":_e(u.row,f.row,function(c){l.setBorder(c,u.col,i,a)});break;case"end":_e(u.row,f.row,function(c){l.setBorder(c,f.col,i,a)});break}})}},{key:"createCustomBorders",value:function(o){var i=this;$(o,function(a){var l=eS(a);a.range?i.prepareBorderFromCustomAddedRange(a.range,l):i.prepareBorderFromCustomAdded(a.row,a.col,l)})}},{key:"countHide",value:function(o){var i=o.top,a=o.bottom,l=o.start,s=o.end,u=[i,a,l,s];return Lt(u,function(f,c){var h=f;return c&&c.hide&&(h+=1),h},0)}},{key:"clearBordersFromSelectionSettings",value:function(o){var i=Be(this.hot.selection.highlight.customSelections,function(a){return a.settings.id}).indexOf(o);i>-1&&this.hot.selection.highlight.customSelections[i].clear()}},{key:"clearNullCellRange",value:function(){var o=this;$(this.hot.selection.highlight.customSelections,function(i,a){if(i.cellRange===null)return o.hot.selection.highlight.customSelections[a].destroy(),o.hot.selection.highlight.customSelections.splice(a,1),!1})}},{key:"hideBorders",value:function(){var o=this;$(this.savedBorders,function(i){o.clearBordersFromSelectionSettings(i.id),o.clearNullCellRange()})}},{key:"spliceBorder",value:function(o){var i=Be(this.savedBorders,function(a){return a.id}).indexOf(o);i>-1&&this.savedBorders.splice(i,1)}},{key:"checkSavedBorders",value:function(o){var i=this,a=!1,l=this.countHide(o);return l===4?(this.spliceBorder(o.id),a=!0):$(this.savedBorders,function(s,u){if(o.id===s.id)return i.savedBorders[u]=o,a=!0,!1}),a}},{key:"checkCustomSelectionsFromContextMenu",value:function(o,i,a){var l=!1;return $(this.hot.selection.highlight.customSelections,function(s){if(o.id===s.settings.id)return We(s.instanceBorders,function(u){u.toggleHiddenClass(i,a)}),l=!0,!1}),l}},{key:"checkCustomSelections",value:function(o,i,a){var l=this.countHide(o),s=!1;return l===4?(this.removeAllBorders(o.row,o.col),s=!0):$(this.hot.selection.highlight.customSelections,function(u){if(o.id===u.settings.id)return u.visualCellRange=i,u.commit(),a&&We(u.instanceBorders,function(f){f.changeBorderStyle(a,o)}),s=!0,!1}),s}},{key:"changeBorderSettings",value:function(){var o=this.hot.getSettings()[Cy];if(Array.isArray(o)){var i=lr(o);this.checkSettingsCohesion(i),i.length||(this.savedBorders=i),this.createCustomBorders(i)}else o!==void 0&&this.createCustomBorders(this.savedBorders)}},{key:"checkSettingsCohesion",value:function(o){var i=rAe(o),a=nAe(o);if(i&&a)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&i)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}},{key:"onAfterContextMenuDefaultOptions",value:function(o){this.hot.getSettings()[Cy]&&o.items.push({name:"---------"},{key:"borders",name:function(){return this.getTranslatedPhrase(wT)},disabled:function(){return this.selection.isSelectedByCorner()},submenu:{items:[fAe(this),uAe(this),aAe(this),lAe(this),sAe(this)]}})}},{key:"onAfterInit",value:function(){this.changeBorderSettings()}},{key:"destroy",value:function(){fa(po(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Cy}},{key:"PLUGIN_PRIORITY",get:function(){return OAe}}]),r}(ot);function mu(e){"@babel/helpers - typeof";return mu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mu(e)}function EAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,PAe(n.key),n)}}function TAe(e,t,r){return t&&AD(e.prototype,t),r&&AD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function PAe(e){var t=kAe(e,"string");return mu(t)==="symbol"?t:String(t)}function kAe(e,t){if(mu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(mu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ca(){return typeof Reflect<"u"&&Reflect.get?ca=Reflect.get.bind():ca=function(t,r,n){var o=$Ae(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ca.apply(this,arguments)}function $Ae(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=mo(e),e!==null););return e}function AAe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kO(e,t)}function kO(e,t){return kO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},kO(e,t)}function IAe(e){var t=xAe();return function(){var n=mo(e),o;if(t){var i=mo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return MAe(this,o)}}function MAe(e,t){if(t&&(mu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return MU(e)}function MU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xAe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mo(e){return mo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},mo(e)}var ID="dragToScroll",DAe=100,NAe=function(e){AAe(r,e);var t=IAe(r);function r(n){var o;return EAe(this,r),o=t.call(this,n),o.eventManager=new Tt(MU(o)),o.boundaries=null,o.callback=null,o.listening=!1,o}return TAe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[ID]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterOnCellMouseDown",function(i){return o.setupListening(i)}),this.addHook("afterOnCellCornerMouseDown",function(i){return o.setupListening(i)}),this.registerEvents(),ca(mo(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ca(mo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.unregisterEvents(),ca(mo(r.prototype),"disablePlugin",this).call(this)}},{key:"setBoundaries",value:function(o){this.boundaries=o}},{key:"setCallback",value:function(o){this.callback=o}},{key:"check",value:function(o,i){var a=0,l=0;i<this.boundaries.top?l=i-this.boundaries.top:i>this.boundaries.bottom&&(l=i-this.boundaries.bottom),o<this.boundaries.left?a=o-this.boundaries.left:o>this.boundaries.right&&(a=o-this.boundaries.right),this.callback(a,l)}},{key:"listen",value:function(){this.listening=!0}},{key:"unlisten",value:function(){this.listening=!1}},{key:"isListening",value:function(){return this.listening}},{key:"registerEvents",value:function(){for(var o=this,i=this.hot.rootWindow,a=i;a;)this.eventManager.addEventListener(a.document,"contextmenu",function(){return o.unlisten()}),this.eventManager.addEventListener(a.document,"mouseup",function(){return o.unlisten()}),this.eventManager.addEventListener(a.document,"mousemove",function(l){return o.onMouseMove(l)}),a=Hc(a)}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"setupListening",value:function(o){if(!Ei(o)){var i=this.hot.view._wt.wtTable.holder;i!==this.hot.rootWindow&&(this.setBoundaries(i.getBoundingClientRect()),this.setCallback(function(a,l){a<0?i.scrollLeft-=50:a>0&&(i.scrollLeft+=50),l<0?i.scrollTop-=20:l>0&&(i.scrollTop+=20)}),this.listen())}}},{key:"onMouseMove",value:function(o){this.isListening()&&this.check(o.clientX,o.clientY)}},{key:"destroy",value:function(){ca(mo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return ID}},{key:"PLUGIN_PRIORITY",get:function(){return DAe}}]),r}(ot);function bu(e){"@babel/helpers - typeof";return bu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bu(e)}function HAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jAe(n.key),n)}}function LAe(e,t,r){return t&&MD(e.prototype,t),r&&MD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jAe(e){var t=FAe(e,"string");return bu(t)==="symbol"?t:String(t)}function FAe(e,t){if(bu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ha(){return typeof Reflect<"u"&&Reflect.get?ha=Reflect.get.bind():ha=function(t,r,n){var o=BAe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ha.apply(this,arguments)}function BAe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=bo(e),e!==null););return e}function VAe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$O(e,t)}function $O(e,t){return $O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},$O(e,t)}function WAe(e){var t=zAe();return function(){var n=bo(e),o;if(t){var i=bo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return UAe(this,o)}}function UAe(e,t){if(t&&(bu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xU(e)}function xU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zAe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bo(e){return bo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bo(e)}pe.getSingleton().register("afterDropdownMenuDefaultOptions");pe.getSingleton().register("beforeDropdownMenuShow");pe.getSingleton().register("afterDropdownMenuShow");pe.getSingleton().register("afterDropdownMenuHide");pe.getSingleton().register("afterDropdownMenuExecute");var rS="dropdownMenu",YAe=230,nS="changeType",DU=function(e){VAe(r,e);var t=WAe(r);function r(n){var o;return HAe(this,r),o=t.call(this,n),o.eventManager=new Tt(xU(o)),o.commandExecutor=new gU(o.hot),o.itemsFactory=null,o.menu=null,o.hot.addHook("afterGetColHeader",function(i,a){return o.onAfterGetColHeader(i,a)}),o}return LAe(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[rS]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){this.itemsFactory=new mU(this.hot,r.DEFAULT_ITEMS);var i=this.hot.getSettings()[rS],a={items:this.itemsFactory.getItems(i)};this.registerEvents(),typeof i.callback=="function"&&this.commandExecutor.setCommonCallback(i.callback),ha(bo(r.prototype),"enablePlugin",this).call(this),this.callOnPluginsReady(function(){o.hot.runHooks("afterDropdownMenuDefaultOptions",a),o.itemsFactory.setPredefinedItems(a.items);var l=o.itemsFactory.getItems(i);o.menu&&o.menu.destroy(),o.menu=new PP(o.hot,{className:"htDropdownMenu",keepInViewport:!0,container:i.uiContainer||o.hot.rootDocument.body}),o.hot.runHooks("beforeDropdownMenuSetItems",l),o.menu.setMenuItems(l),o.menu.addLocalHook("beforeOpen",function(){return o.onMenuBeforeOpen()}),o.menu.addLocalHook("afterOpen",function(){return o.onMenuAfterOpen()}),o.menu.addLocalHook("afterClose",function(){return o.onMenuAfterClose()}),o.menu.addLocalHook("executeCommand",function(){for(var s,u=arguments.length,f=new Array(u),c=0;c<u;c++)f[c]=arguments[c];return(s=o.executeCommand).call.apply(s,[o].concat(f))}),$(l,function(s){return o.commandExecutor.registerCommand(s.key,s)})})}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ha(bo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&this.menu.destroy(),ha(bo(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var o=this;this.eventManager.addEventListener(this.hot.rootElement,"click",function(i){return o.onTableClick(i)})}},{key:"open",value:function(o){this.menu&&(this.menu.open(),o.width&&this.menu.setOffset("left",o.width),this.menu.setPosition(o))}},{key:"close",value:function(){this.menu&&this.menu.close()}},{key:"executeCommand",value:function(o){for(var i,a=arguments.length,l=new Array(a>1?a-1:0),s=1;s<a;s++)l[s-1]=arguments[s];(i=this.commandExecutor).execute.apply(i,[o].concat(l))}},{key:"setListening",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(o?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}},{key:"onTableClick",value:function(o){if(o.stopPropagation(),xe(o.target,nS)&&!this.menu.isOpened()){var i=0,a=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var l=this.hot.rootWindow.frameElement,s=l.getBoundingClientRect(),u=s.top,f=s.left;i=u,a=f}var c=o.target.getBoundingClientRect();this.open({left:c.left+a,top:c.top+o.target.offsetHeight+3+i,width:c.width,height:c.height})}}},{key:"onAfterGetColHeader",value:function(o,i){var a=i.parentNode;if(a){var l=a.parentNode.childNodes,s=Array.prototype.indexOf.call(l,a);if(!(o<0||s!==l.length-1)){var u=i.querySelector(".".concat(nS));if(!(this.enabled&&u)){if(!this.enabled){u&&u.parentNode.removeChild(u);return}var f=this.hot.rootDocument.createElement("button");f.className=nS,f.type="button",f.onclick=function(){return!1},i.firstChild.insertBefore(f,i.firstChild.firstChild)}}}}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeDropdownMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterDropdownMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),ha(bo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return rS}},{key:"PLUGIN_PRIORITY",get:function(){return YAe}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[Ov,Rv,Ye,Tv,Ye,Gm,Ye,Ev,Ye,Yr]}}]),r}(ot);DU.SEPARATOR={name:Ye};function sd(e){"@babel/helpers - typeof";return sd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sd(e)}function GAe(e,t){return ZAe(e)||XAe(e,t)||qAe(e,t)||KAe()}function KAe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qAe(e,t){if(e){if(typeof e=="string")return xD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xD(e,t)}}function xD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function XAe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function ZAe(e){if(Array.isArray(e))return e}function QAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eIe(n.key),n)}}function JAe(e,t,r){return t&&DD(e.prototype,t),r&&DD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function eIe(e){var t=tIe(e,"string");return sd(t)==="symbol"?t:String(t)}function tIe(e,t){if(sd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rIe=function(){function e(t){QAe(this,e),this.hot=t,this.options={}}return JAe(e,[{key:"setOptions",value:function(r){this.options=r}},{key:"getData",value:function(){var r=this,n=this._getDataRange(),o=n.startRow,i=n.startCol,a=n.endRow,l=n.endCol,s=this.options,u=[];return _e(o,a,function(f){var c=[];!s.exportHiddenRows&&r._isHiddenRow(f)||(_e(i,l,function(h){!s.exportHiddenColumns&&r._isHiddenColumn(h)||c.push(r.hot.getDataAtCell(f,h))}),u.push(c))}),u}},{key:"getRowHeaders",value:function(){var r=this,n=[];if(this.options.rowHeaders){var o=this._getDataRange(),i=o.startRow,a=o.endRow,l=this.hot.getRowHeader();_e(i,a,function(s){!r.options.exportHiddenRows&&r._isHiddenRow(s)||n.push(l[s])})}return n}},{key:"getColumnHeaders",value:function(){var r=this,n=[];if(this.options.columnHeaders){var o=this._getDataRange(),i=o.startCol,a=o.endCol,l=this.hot.getColHeader();_e(i,a,function(s){!r.options.exportHiddenColumns&&r._isHiddenColumn(s)||n.push(l[s])})}return n}},{key:"_getDataRange",value:function(){var r=this.hot.countCols()-1,n=this.hot.countRows()-1,o=GAe(this.options.range,4),i=o[0],a=i===void 0?0:i,l=o[1],s=l===void 0?0:l,u=o[2],f=u===void 0?n:u,c=o[3],h=c===void 0?r:c;return a=Math.max(a,0),s=Math.max(s,0),f=Math.min(f,n),h=Math.min(h,r),{startRow:a,startCol:s,endRow:f,endCol:h}}},{key:"_isHiddenRow",value:function(r){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(r))}},{key:"_isHiddenColumn",value:function(r){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(r))}}]),e}();const nIe=rIe;function ud(e){"@babel/helpers - typeof";return ud=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ud(e)}function oIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ND(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,aIe(n.key),n)}}function iIe(e,t,r){return t&&ND(e.prototype,t),r&&ND(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function aIe(e){var t=lIe(e,"string");return ud(t)==="symbol"?t:String(t)}function lIe(e,t){if(ud(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ud(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var sIe=function(){function e(t,r){oIe(this,e),this.dataProvider=t,this.options=this._mergeOptions(r),this.dataProvider.setOptions(this.options)}return iIe(e,[{key:"_mergeOptions",value:function(r){var n=pr(this.constructor.DEFAULT_OPTIONS),o=new Date;return n=Wt(pr(e.DEFAULT_OPTIONS),n),n=Wt(n,r),n.filename=fE(n.filename,{YYYY:o.getFullYear(),MM:"".concat(o.getMonth()+1).padStart(2,"0"),DD:"".concat(o.getDate()).padStart(2,"0")}),n}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}}]),e}();const uIe=sIe;function wu(e){"@babel/helpers - typeof";return wu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wu(e)}function fIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hIe(n.key),n)}}function cIe(e,t,r){return t&&HD(e.prototype,t),r&&HD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hIe(e){var t=dIe(e,"string");return wu(t)==="symbol"?t:String(t)}function dIe(e,t){if(wu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&AO(e,t)}function AO(e,t){return AO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},AO(e,t)}function yIe(e){var t=mIe();return function(){var n=Ip(e),o;if(t){var i=Ip(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return gIe(this,o)}}function gIe(e,t){if(t&&(wu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pIe(e)}function pIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mIe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ip(e){return Ip=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ip(e)}var bIe=String.fromCharCode(13),wIe=String.fromCharCode(34),SIe=String.fromCharCode(10),CIe=function(e){vIe(r,e);var t=yIe(r);function r(){return fIe(this,r),t.apply(this,arguments)}return cIe(r,[{key:"export",value:function(){var o=this,i=this.options,a=this.dataProvider.getData(),l=this.dataProvider.getColumnHeaders(),s=l.length>0,u=this.dataProvider.getRowHeaders(),f=u.length>0,c=i.bom?String.fromCharCode(65279):"";return s&&(l=Be(l,function(h){return o._escapeCell(h,!0)}),f&&(c+=i.columnDelimiter),c+=l.join(i.columnDelimiter),c+=i.rowDelimiter),$(a,function(h,d){d>0&&(c+=i.rowDelimiter),f&&(c+=o._escapeCell(u[d])+i.columnDelimiter),c+=h.map(function(v){return o._escapeCell(v)}).join(i.columnDelimiter)}),c}},{key:"_escapeCell",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=It(o);return a!==""&&(i||a.indexOf(bIe)>=0||a.indexOf(wIe)>=0||a.indexOf(SIe)>=0||a.indexOf(this.options.columnDelimiter)>=0)&&(a=a.replace(new RegExp('"',"g"),'""'),a='"'.concat(a,'"')),a}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}}]),r}(uIe);const _Ie=CIe;function fd(e){"@babel/helpers - typeof";return fd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fd(e)}function OIe(e,t,r){return t=RIe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function RIe(e){var t=EIe(e,"string");return fd(t)==="symbol"?t:String(t)}function EIe(e,t){if(fd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TIe="csv",IO=OIe({},TIe,_Ie);function PIe(e,t,r){return typeof IO[e]=="function"?new IO[e](t,r):null}function Su(e){"@babel/helpers - typeof";return Su=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Su(e)}function kIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,AIe(n.key),n)}}function $Ie(e,t,r){return t&&LD(e.prototype,t),r&&LD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function AIe(e){var t=IIe(e,"string");return Su(t)==="symbol"?t:String(t)}function IIe(e,t){if(Su(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Su(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function MIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&MO(e,t)}function MO(e,t){return MO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},MO(e,t)}function xIe(e){var t=HIe();return function(){var n=Mp(e),o;if(t){var i=Mp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return DIe(this,o)}}function DIe(e,t){if(t&&(Su(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return NIe(e)}function NIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function HIe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Mp(e){return Mp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Mp(e)}var LIe="exportFile",jIe=240,FIe=function(e){MIe(r,e);var t=xIe(r);function r(){return kIe(this,r),t.apply(this,arguments)}return $Ie(r,[{key:"isEnabled",value:function(){return!0}},{key:"exportAsString",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(o,i).export()}},{key:"exportAsBlob",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(o,i))}},{key:"downloadFile",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=this.hot,l=a.rootDocument,s=a.rootWindow,u=this._createTypeFormatter(o,i),f=this._createBlob(u),c=s.URL||s.webkitURL,h=l.createElement("a"),d="".concat(u.options.filename,".").concat(u.options.fileExtension);if(h.download!==void 0){var v=c.createObjectURL(f);h.style.display="none",h.setAttribute("href",v),h.setAttribute("download",d),l.body.appendChild(h),h.dispatchEvent(new MouseEvent("click")),l.body.removeChild(h),setTimeout(function(){c.revokeObjectURL(v)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(f,d)}},{key:"_createTypeFormatter",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!IO[o])throw new Error('Export format type "'.concat(o,'" is not supported.'));return PIe(o,new nIe(this.hot),i)}},{key:"_createBlob",value:function(o){var i=null;return typeof Blob<"u"&&(i=new Blob([o.export()],{type:"".concat(o.options.mimeType,";charset=").concat(o.options.encoding)})),i}}],[{key:"PLUGIN_KEY",get:function(){return LIe}},{key:"PLUGIN_PRIORITY",get:function(){return jIe}}]),r}(ot);function cd(e){"@babel/helpers - typeof";return cd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cd(e)}function BIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,WIe(n.key),n)}}function VIe(e,t,r){return t&&jD(e.prototype,t),r&&jD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function WIe(e){var t=UIe(e,"string");return cd(t)==="symbol"?t:String(t)}function UIe(e,t){if(cd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var NU=function(){function e(t,r){var n=r.id,o=r.stateless,i=o===void 0?!0:o;BIe(this,e),this.hot=t,this.id=n,this.elements=[],this.hidden=!1,this.stateId="Filters.component.".concat(this.id),this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Nm)}return VIe(e,[{key:"reset",value:function(){$(this.elements,function(r){return r.reset()})}},{key:"hide",value:function(){this.hidden=!0}},{key:"show",value:function(){this.hidden=!1}},{key:"isHidden",value:function(){return this.hot===null||this.hidden}},{key:"restoreState",value:function(r){this.state&&this.setState(this.state.getValueAtIndex(r))}},{key:"setState",value:function(){throw new Error("The state setting logic is not implemented")}},{key:"saveState",value:function(r){this.state&&this.state.setValueAtIndex(r,this.getState())}},{key:"getState",value:function(){throw new Error("The state gathering logic is not implemented")}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),$(this.elements,function(r){return r.destroy()}),this.state=null,this.elements=null,this.hot=null}}]),e}();pt(NU,kr);const eb=NU;var hd={};function Ti(e,t){if(!hd[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));var r=hd[e],n=r.condition,o=r.descriptor,i=t;return o.inputValuesDecorator&&(i=o.inputValuesDecorator(i)),function(a){return n.apply(a.meta.instance,[].concat([a],[i]))}}function da(e){if(!hd[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));return hd[e].descriptor}function Gt(e,t,r){r.key=e,hd[e]={condition:t,descriptor:r}}var Jt="none";function zIe(){return!0}Gt(Jt,zIe,{name:Hm,inputsCount:0,showOperators:!1});var Tc="empty";function YIe(e){return Kt(e.value)}Gt(Tc,YIe,{name:IT,inputsCount:0,showOperators:!0});var yg="not_empty";function GIe(e,t){return!Ti(Tc,t)(e)}Gt(yg,GIe,{name:MT,inputsCount:0,showOperators:!0});function KIe(e,t){return QIe(e)||ZIe(e,t)||XIe(e,t)||qIe()}function qIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function XIe(e,t){if(e){if(typeof e=="string")return FD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return FD(e,t)}}function FD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ZIe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function QIe(e){if(Array.isArray(e))return e}var Pc="eq";function JIe(e,t){var r=KIe(t,1),n=r[0];return It(e.value).toLocaleLowerCase(e.meta.locale)===It(n)}Gt(Pc,JIe,{name:xT,inputsCount:1,showOperators:!0});var gg="neq";function eMe(e,t){return!Ti(Pc,t)(e)}Gt(gg,eMe,{name:DT,inputsCount:1,showOperators:!0});function tMe(e,t){return iMe(e)||oMe(e,t)||nMe(e,t)||rMe()}function rMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nMe(e,t){if(e){if(typeof e=="string")return BD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return BD(e,t)}}function BD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function oMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function iMe(e){if(Array.isArray(e))return e}var HU="gt";function aMe(e,t){var r=tMe(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value>o}Gt(HU,aMe,{name:FT,inputsCount:1,showOperators:!0});function lMe(e,t){return cMe(e)||fMe(e,t)||uMe(e,t)||sMe()}function sMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uMe(e,t){if(e){if(typeof e=="string")return VD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return VD(e,t)}}function VD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function fMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function cMe(e){if(Array.isArray(e))return e}var LU="gte";function hMe(e,t){var r=lMe(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value>=o}Gt(LU,hMe,{name:BT,inputsCount:1,showOperators:!0});function dMe(e,t){return pMe(e)||gMe(e,t)||yMe(e,t)||vMe()}function vMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yMe(e,t){if(e){if(typeof e=="string")return WD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return WD(e,t)}}function WD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function gMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function pMe(e){if(Array.isArray(e))return e}var jU="lt";function mMe(e,t){var r=dMe(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value<o}Gt(jU,mMe,{name:VT,inputsCount:1,showOperators:!0});function bMe(e,t){return _Me(e)||CMe(e,t)||SMe(e,t)||wMe()}function wMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function SMe(e,t){if(e){if(typeof e=="string")return UD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return UD(e,t)}}function UD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function CMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function _Me(e){if(Array.isArray(e))return e}var FU="lte";function OMe(e,t){var r=bMe(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value<=o}Gt(FU,OMe,{name:WT,inputsCount:1,showOperators:!0});function RMe(e,t){return kMe(e)||PMe(e,t)||TMe(e,t)||EMe()}function EMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function TMe(e,t){if(e){if(typeof e=="string")return zD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return zD(e,t)}}function zD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function PMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function kMe(e){if(Array.isArray(e))return e}var $P="date_after";function $Me(e,t){var r=RMe(t,1),n=r[0],o=te(e.value,e.meta.dateFormat),i=te(n,e.meta.dateFormat);return!o.isValid()||!i.isValid()?!1:o.diff(i)>=0}Gt($P,$Me,{name:YT,inputsCount:1,showOperators:!0});function AMe(e,t){return DMe(e)||xMe(e,t)||MMe(e,t)||IMe()}function IMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function MMe(e,t){if(e){if(typeof e=="string")return YD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return YD(e,t)}}function YD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function xMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function DMe(e){if(Array.isArray(e))return e}var AP="date_before";function NMe(e,t){var r=AMe(t,1),n=r[0],o=te(e.value,e.meta.dateFormat),i=te(n,e.meta.dateFormat);return!o.isValid()||!i.isValid()?!1:o.diff(i)<=0}Gt(AP,NMe,{name:GT,inputsCount:1,showOperators:!0});function HMe(e,t){return BMe(e)||FMe(e,t)||jMe(e,t)||LMe()}function LMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jMe(e,t){if(e){if(typeof e=="string")return GD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return GD(e,t)}}function GD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function FMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function BMe(e){if(Array.isArray(e))return e}var xp="between";function VMe(e,t){var r=HMe(t,2),n=r[0],o=r[1],i=n,a=o;if(e.meta.type==="numeric"){var l=parseFloat(i,10),s=parseFloat(a,10);i=Math.min(l,s),a=Math.max(l,s)}else if(e.meta.type==="date"){var u=Ti(AP,[a]),f=Ti($P,[i]);return u(e)&&f(e)}return e.value>=i&&e.value<=a}Gt(xp,VMe,{name:UT,inputsCount:2,showOperators:!0});var BU="not_between";function WMe(e,t){return!Ti(xp,t)(e)}Gt(BU,WMe,{name:zT,inputsCount:2,showOperators:!0});function UMe(e,t){return KMe(e)||GMe(e,t)||YMe(e,t)||zMe()}function zMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function YMe(e,t){if(e){if(typeof e=="string")return KD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return KD(e,t)}}function KD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function GMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function KMe(e){if(Array.isArray(e))return e}var VU="begins_with";function qMe(e,t){var r=UMe(t,1),n=r[0];return It(e.value).toLocaleLowerCase(e.meta.locale).startsWith(It(n))}Gt(VU,qMe,{name:NT,inputsCount:1,showOperators:!0});var XMe=$e,ZMe=Jp,QMe=Ln.f,JMe=Xa,qD=Yt,exe=A0,txe=Tr,rxe=I0,nxe=ZMe("".slice),oxe=Math.min,WU=rxe("endsWith"),ixe=!WU&&!!function(){var e=QMe(String.prototype,"endsWith");return e&&!e.writable}();XMe({target:"String",proto:!0,forced:!ixe&&!WU},{endsWith:function(t){var r=qD(txe(this));exe(t);var n=arguments.length>1?arguments[1]:void 0,o=r.length,i=n===void 0?o:oxe(JMe(n),o),a=qD(t);return nxe(r,i-a.length,i)===a}});function axe(e,t){return fxe(e)||uxe(e,t)||sxe(e,t)||lxe()}function lxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sxe(e,t){if(e){if(typeof e=="string")return XD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return XD(e,t)}}function XD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function uxe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function fxe(e){if(Array.isArray(e))return e}var UU="ends_with";function cxe(e,t){var r=axe(t,1),n=r[0];return It(e.value).toLocaleLowerCase(e.meta.locale).endsWith(It(n))}Gt(UU,cxe,{name:HT,inputsCount:1,showOperators:!0});function hxe(e,t){return gxe(e)||yxe(e,t)||vxe(e,t)||dxe()}function dxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vxe(e,t){if(e){if(typeof e=="string")return ZD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ZD(e,t)}}function ZD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function yxe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function gxe(e){if(Array.isArray(e))return e}var IP="contains";function pxe(e,t){var r=hxe(t,1),n=r[0];return It(e.value).toLocaleLowerCase(e.meta.locale).indexOf(It(n))>=0}Gt(IP,pxe,{name:LT,inputsCount:1,showOperators:!0});var zU="not_contains";function mxe(e,t){return!Ti(IP,t)(e)}Gt(zU,mxe,{name:jT,inputsCount:1,showOperators:!0});var YU="date_tomorrow";function bxe(e){var t=te(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(te().subtract(-1,"days").startOf("day"),"d"):!1}Gt(YU,bxe,{name:qT,inputsCount:0});var GU="date_today";function wxe(e){var t=te(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(te().startOf("day"),"d"):!1}Gt(GU,wxe,{name:KT,inputsCount:0});var KU="date_yesterday";function Sxe(e){var t=te(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(te().subtract(1,"days").startOf("day"),"d"):!1}Gt(KU,Sxe,{name:XT,inputsCount:0});QF();function Cxe(e,t){var r=e;return r===""&&(r="(".concat(t,")")),r}var xO=new Set([1]).has(1),_xe=xO&&typeof Array.from=="function";function Pv(e){var t=e;return xO&&(t=new Set(t)),function(r){var n;return xO?n=t.has(r):n=!!~t.indexOf(r),n}}function qU(e){return e??""}function DO(e){var t=e;return _xe?t=Array.from(new Set(t)):t=H0(t),t=t.sort(function(r,n){return typeof r=="number"&&typeof n=="number"?r-n:r===n?0:r>n?1:-1}),t}function QD(e,t,r,n){var o=[],i=e===t,a;return i||(a=Pv(t)),$(e,function(l){var s=!1;(i||a(l))&&(s=!0);var u={checked:s,value:l,visualValue:Cxe(l,r)};n&&n(u),o.push(u)}),o}function XU(e,t){return Txe(e)||Exe(e,t)||Rxe(e,t)||Oxe()}function Oxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Rxe(e,t){if(e){if(typeof e=="string")return JD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return JD(e,t)}}function JD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Exe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Txe(e){if(Array.isArray(e))return e}var va="by_value";function Pxe(e,t){var r=XU(t,1),n=r[0];return n(e.value)}Gt(va,Pxe,{name:"By value",inputsCount:0,inputValuesDecorator:function(t){var r=XU(t,1),n=r[0];return[Pv(n)]},showOperators:!1});var dd={};function kxe(e){if(!dd[e])throw Error('Operation with id "'.concat(e,'" does not exist.'));var t=dd[e].func;return function(r,n){return t(r,n)}}function $xe(e){return dd[e].name}function MP(e,t,r){dd[e]={name:t,func:r}}var gi="conjunction",Axe=JT;function Ixe(e,t){return e.every(function(r){return r.func(t)})}MP(gi,Axe,Ixe);var Dp="disjunction",Mxe=Lm;function xxe(e,t){return e.some(function(r){return r.func(t)})}MP(Dp,Mxe,xxe);var xP="disjunctionWithExtraCondition",Dxe=Lm;function Nxe(e,t){if(e.length<3)throw Error("Operation doesn't work on less then three conditions.");return e.slice(0,e.length-1).some(function(r){return r.func(t)})&&e[e.length-1].func(t)}MP(xP,Dxe,Nxe);function vd(e){"@babel/helpers - typeof";return vd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vd(e)}var Xf;function oS(e,t,r){return t=Hxe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Hxe(e){var t=Lxe(e,"string");return vd(t)==="symbol"?t:String(t)}function Lxe(e,t){if(vd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var jxe="numeric",ZU="text",Fxe="date",eN=(Xf={},oS(Xf,jxe,[Jt,Ye,Tc,yg,Ye,Pc,gg,Ye,HU,LU,jU,FU,xp,BU]),oS(Xf,ZU,[Jt,Ye,Tc,yg,Ye,Pc,gg,Ye,VU,UU,Ye,IP,zU]),oS(Xf,Fxe,[Jt,Ye,Tc,yg,Ye,Pc,gg,Ye,AP,$P,xp,Ye,YU,GU,KU]),Xf);function Bxe(e){var t=[],r=e;return eN[r]||(r=ZU),$(eN[r],function(n){var o;n===Ye?o={name:Ye}:o=pr(da(n)),t.push(o)}),t}function yd(e){"@babel/helpers - typeof";return yd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yd(e)}function Vxe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Uxe(n.key),n)}}function Wxe(e,t,r){return t&&tN(e.prototype,t),r&&tN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Uxe(e){var t=zxe(e,"string");return yd(t)==="symbol"?t:String(t)}function zxe(e,t){if(yd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var iS="built",aS="building",rN=["click","input","keydown","keypress","keyup","focus","blur","change"],QU=function(){function e(t,r){Vxe(this,e),this.hot=t,this.eventManager=new Tt(this),this.options=Wt(e.DEFAULTS,r),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName),this.buildState=null}return Wxe(e,[{key:"setValue",value:function(r){this.options.value=r,this.update()}},{key:"getValue",value:function(){return this.options.value}},{key:"element",get:function(){return this.buildState===aS?this._element:this.buildState===iS?(this.update(),this._element):(this.buildState=aS,this.build(),this.buildState=iS,this._element)}},{key:"isBuilt",value:function(){return this.buildState===iS}},{key:"translateIfPossible",value:function(r){return typeof r=="string"&&r.startsWith(wr)?this.hot.getTranslatedPhrase(r):r}},{key:"build",value:function(){var r=this,n=function(a,l){r.eventManager.addEventListener(a,l,function(s){return r.runLocalHooks(l,s,r)})};if(this.buildState||(this.buildState=aS),this.options.className&&re(this._element,this.options.className),this.options.children.length)$(this.options.children,function(i){return r._element.appendChild(i.element)});else if(this.options.wrapIt){var o=this.hot.rootDocument.createElement(this.options.tagName);We(this.options,function(i,a){o[a]!==void 0&&a!=="className"&&a!=="tagName"&&a!=="children"&&(o[a]=r.translateIfPossible(i))}),this._element.appendChild(o),$(rN,function(i){return n(o,i)})}else $(rN,function(i){return n(r._element,i)})}},{key:"update",value:function(){}},{key:"reset",value:function(){this.options.value="",this.update()}},{key:"show",value:function(){this.element.style.display=""}},{key:"hide",value:function(){this.element.style.display="none"}},{key:"focus",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}],[{key:"DEFAULTS",get:function(){return pr({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}}]),e}();pt(QU,kr);const pi=QU;function Cu(e){"@babel/helpers - typeof";return Cu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cu(e)}function Yxe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Kxe(n.key),n)}}function Gxe(e,t,r){return t&&nN(e.prototype,t),r&&nN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Kxe(e){var t=qxe(e,"string");return Cu(t)==="symbol"?t:String(t)}function qxe(e,t){if(Cu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pg(){return typeof Reflect<"u"&&Reflect.get?pg=Reflect.get.bind():pg=function(t,r,n){var o=Xxe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},pg.apply(this,arguments)}function Xxe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_u(e),e!==null););return e}function Zxe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&NO(e,t)}function NO(e,t){return NO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},NO(e,t)}function Qxe(e){var t=eDe();return function(){var n=_u(e),o;if(t){var i=_u(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Jxe(this,o)}}function Jxe(e,t){if(t&&(Cu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return JU(e)}function JU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eDe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _u(e){return _u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_u(e)}var _y=new WeakMap,tDe=function(e){Zxe(r,e);var t=Qxe(r);function r(n,o){var i;return Yxe(this,r),i=t.call(this,n,Wt(r.DEFAULTS,o)),_y.set(JU(i),{}),i.registerHooks(),i}return Gxe(r,[{key:"registerHooks",value:function(){var o=this;this.addLocalHook("click",function(){return o.onClick()}),this.addLocalHook("keyup",function(i){return o.onKeyup(i)})}},{key:"build",value:function(){pg(_u(r.prototype),"build",this).call(this);var o=_y.get(this),i=this.hot.rootDocument.createElement("div");o.input=this._element.firstChild,re(this._element,"htUIInput"),re(i,"htUIInputIcon"),this._element.appendChild(i),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var o=_y.get(this).input;o.type=this.options.type,o.placeholder=this.translateIfPossible(this.options.placeholder),o.value=this.translateIfPossible(this.options.value)}}},{key:"focus",value:function(){this.isBuilt()&&_y.get(this).input.focus()}},{key:"onClick",value:function(){}},{key:"onKeyup",value:function(o){this.options.value=o.target.value}}],[{key:"DEFAULTS",get:function(){return pr({placeholder:"",type:"text",tagName:"input"})}}]),r}(pi);const Zl=tDe;function Ou(e){"@babel/helpers - typeof";return Ou=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ou(e)}function rDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oDe(n.key),n)}}function nDe(e,t,r){return t&&oN(e.prototype,t),r&&oN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function oDe(e){var t=iDe(e,"string");return Ou(t)==="symbol"?t:String(t)}function iDe(e,t){if(Ou(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ou(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ql(){return typeof Reflect<"u"&&Reflect.get?Ql=Reflect.get.bind():Ql=function(t,r,n){var o=aDe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ql.apply(this,arguments)}function aDe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=mi(e),e!==null););return e}function lDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&HO(e,t)}function HO(e,t){return HO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},HO(e,t)}function sDe(e){var t=fDe();return function(){var n=mi(e),o;if(t){var i=mi(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return uDe(this,o)}}function uDe(e,t){if(t&&(Ou(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ez(e)}function ez(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fDe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mi(e){return mi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},mi(e)}var Oy=new WeakMap,cDe=function(e){lDe(r,e);var t=sDe(r);function r(n,o){var i;return rDe(this,r),i=t.call(this,n,Wt(r.DEFAULTS,o)),Oy.set(ez(i),{}),i.menu=null,i.items=[],i.registerHooks(),i}return nDe(r,[{key:"registerHooks",value:function(){var o=this;this.addLocalHook("click",function(){return o.onClick()})}},{key:"setItems",value:function(o){this.items=this.translateNames(o),this.menu&&this.menu.setMenuItems(this.items)}},{key:"translateNames",value:function(o){var i=this;return $(o,function(a){a.name=i.translateIfPossible(a.name)}),o}},{key:"build",value:function(){var o=this;Ql(mi(r.prototype),"build",this).call(this),this.menu=new PP(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer}),this.menu.setMenuItems(this.items);var i=new pi(this.hot,{className:"htUISelectCaption"}),a=new pi(this.hot,{className:"htUISelectDropdown"}),l=Oy.get(this);l.caption=i,l.captionElement=i.element,l.dropdown=a,$([i,a],function(s){return o._element.appendChild(s.element)}),this.menu.addLocalHook("select",function(s){return o.onMenuSelect(s)}),this.menu.addLocalHook("afterClose",function(){return o.onMenuClosed()}),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var o;this.options.value?o=this.options.value.name:o=this.menu.hot.getTranslatedPhrase(Hm),Oy.get(this).captionElement.textContent=o,Ql(mi(r.prototype),"update",this).call(this)}}},{key:"openOptions",value:function(){var o=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:this.hot.isLtr()?o.left-5:o.left-31,top:o.top-1,width:o.width,height:o.height}))}},{key:"closeOptions",value:function(){this.menu&&this.menu.close()}},{key:"onMenuSelect",value:function(o){o.name!==Ye&&(this.options.value=o,this.update(),this.runLocalHooks("select",this.options.value))}},{key:"onMenuClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onClick",value:function(){this.openOptions()}},{key:"destroy",value:function(){this.menu&&(this.menu.destroy(),this.menu=null);var o=Oy.get(this),i=o.caption,a=o.dropdown;i&&i.destroy(),a&&a.destroy(),Ql(mi(r.prototype),"destroy",this).call(this)}}],[{key:"DEFAULTS",get:function(){return pr({className:"htUISelect",wrapIt:!1})}}]),r}(pi);const iN=cDe;function Ru(e){"@babel/helpers - typeof";return Ru=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ru(e)}function hDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vDe(n.key),n)}}function dDe(e,t,r){return t&&aN(e.prototype,t),r&&aN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vDe(e){var t=yDe(e,"string");return Ru(t)==="symbol"?t:String(t)}function yDe(e,t){if(Ru(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ru(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function mg(){return typeof Reflect<"u"&&Reflect.get?mg=Reflect.get.bind():mg=function(t,r,n){var o=gDe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},mg.apply(this,arguments)}function gDe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Eu(e),e!==null););return e}function pDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&LO(e,t)}function LO(e,t){return LO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},LO(e,t)}function mDe(e){var t=SDe();return function(){var n=Eu(e),o;if(t){var i=Eu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return bDe(this,o)}}function bDe(e,t){if(t&&(Ru(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return wDe(e)}function wDe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function SDe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Eu(e){return Eu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Eu(e)}var CDe=function(e){pDe(r,e);var t=mDe(r);function r(n,o){var i;return hDe(this,r),i=t.call(this,n,{id:o.id,stateless:!1}),i.name=o.name,i.addSeparator=o.addSeparator,i.elements.push(new iN(i.hot,{menuContainer:o.menuContainer})),i.elements.push(new Zl(i.hot,{placeholder:iP})),i.elements.push(new Zl(i.hot,{placeholder:aP})),i.registerHooks(),i}return dDe(r,[{key:"registerHooks",value:function(){var o=this;this.getSelectElement().addLocalHook("select",function(i){return o.onConditionSelect(i)}),this.getSelectElement().addLocalHook("afterClose",function(){return o.onSelectUIClosed()}),$(this.getInputElements(),function(i){i.addLocalHook("keydown",function(a){return o.onInputKeyDown(a)})})}},{key:"setState",value:function(o){var i=this;if(this.reset(),!!o){var a=pr(o.command);a.name.startsWith(xt)&&(a.name=this.hot.getTranslatedPhrase(a.name)),this.getSelectElement().setValue(a),$(o.args,function(l,s){if(s>a.inputsCount-1)return!1;var u=i.getInputElement(s);u.setValue(l),u[a.inputsCount>s?"show":"hide"](),s||setTimeout(function(){return u.focus()},10)})}}},{key:"getState",value:function(){var o=this.getSelectElement().getValue()||da(Jt),i=[];return $(this.getInputElements(),function(a,l){o.inputsCount>l&&i.push(a.getValue())}),{command:o,args:i}}},{key:"updateState",value:function(o,i){var a=da(o?o.name:Jt);this.state.setValueAtIndex(i,{command:a,args:o?o.args:[]}),o||$(this.getInputElements(),function(l){return l.setValue(null)})}},{key:"getSelectElement",value:function(){return this.elements.filter(function(o){return o instanceof iN})[0]}},{key:"getInputElement",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[o]}},{key:"getInputElements",value:function(){return this.elements.filter(function(o){return o instanceof Zl})}},{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,l,s,u,f,c){re(l.parentNode,"htFiltersMenuCondition"),o.addSeparator&&re(l.parentNode,"border");var h=o.hot.rootDocument.createElement("div");return re(h,"htFiltersMenuLabel"),h.textContent=c,l.appendChild(h),l.parentNode.hasAttribute("ghost-table")||$(o.elements,function(d){return l.appendChild(d.element)}),l}}}},{key:"reset",value:function(){var o=this.hot.getPlugin("filters").getSelectedColumn(),i=[da(Jt)];if(o!==null){var a=o.visualIndex;i=Bxe(this.hot.getDataType(0,a,this.hot.countRows(),a))}$(this.getInputElements(),function(l){return l.hide()}),this.getSelectElement().setItems(i),mg(Eu(r.prototype),"reset",this).call(this),this.getSelectElement().setValue(i[0])}},{key:"onConditionSelect",value:function(o){$(this.getInputElements(),function(i,a){i[o.inputsCount>a?"show":"hide"](),a===0&&setTimeout(function(){return i.focus()},10)}),this.runLocalHooks("change",o)}},{key:"onSelectUIClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onInputKeyDown",value:function(o){hs(o.keyCode,"ENTER")?(this.runLocalHooks("accept"),gn(o)):hs(o.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),gn(o))}}]),r}(eb);const lS=CDe;function Tu(e){"@babel/helpers - typeof";return Tu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tu(e)}function _De(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,RDe(n.key),n)}}function ODe(e,t,r){return t&&lN(e.prototype,t),r&&lN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function RDe(e){var t=EDe(e,"string");return Tu(t)==="symbol"?t:String(t)}function EDe(e,t){if(Tu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Tu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bg(){return typeof Reflect<"u"&&Reflect.get?bg=Reflect.get.bind():bg=function(t,r,n){var o=TDe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},bg.apply(this,arguments)}function TDe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Pu(e),e!==null););return e}function PDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jO(e,t)}function jO(e,t){return jO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},jO(e,t)}function kDe(e){var t=ADe();return function(){var n=Pu(e),o;if(t){var i=Pu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return $De(this,o)}}function $De(e,t){if(t&&(Tu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tz(e)}function tz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ADe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Pu(e){return Pu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Pu(e)}var Ry=new WeakMap,IDe=function(e){PDe(r,e);var t=kDe(r);function r(n,o){var i;return _De(this,r),i=t.call(this,n,Wt(r.DEFAULTS,o)),Ry.set(tz(i),{}),i}return ODe(r,[{key:"build",value:function(){bg(Pu(r.prototype),"build",this).call(this);var o=Ry.get(this);o.input=this._element.firstChild;var i=this.hot.rootDocument.createElement("label");i.textContent=this.translateIfPossible(this.options.label.textContent),i.htmlFor=this.translateIfPossible(this.options.label.htmlFor),o.label=i,this._element.appendChild(i),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var o=Ry.get(this);o.input.checked=this.options.checked,o.label.textContent=this.translateIfPossible(this.options.label.textContent)}}},{key:"isChecked",value:function(){return this.options.checked}},{key:"setChecked",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.options.checked=o,this.update()}},{key:"focus",value:function(){this.isBuilt()&&Ry.get(this).input.focus()}}],[{key:"DEFAULTS",get:function(){return pr({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}}]),r}(pi);const sN=IDe;function ku(e){"@babel/helpers - typeof";return ku=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ku(e)}var uN;function MDe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function xDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,NDe(n.key),n)}}function DDe(e,t,r){return t&&fN(e.prototype,t),r&&fN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function NDe(e){var t=HDe(e,"string");return ku(t)==="symbol"?t:String(t)}function HDe(e,t){if(ku(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ku(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function LDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&FO(e,t)}function FO(e,t){return FO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},FO(e,t)}function jDe(e){var t=VDe();return function(){var n=Np(e),o;if(t){var i=Np(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return FDe(this,o)}}function FDe(e,t){if(t&&(ku(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return BDe(e)}function BDe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function VDe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Np(e){return Np=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Np(e)}var cN=0,WDe=function(e){LDe(r,e);var t=jDe(r);function r(n,o){var i;return xDe(this,r),i=t.call(this,n,{id:o.id,stateless:!1}),i.name=o.name,i.buildOperatorsElement(),i}return DDe(r,[{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,l){return re(l.parentNode,"htFiltersMenuOperators"),l.parentNode.hasAttribute("ghost-table")||$(o.elements,function(s){return l.appendChild(s.element)}),l}}}},{key:"buildOperatorsElement",value:function(){var o=this,i=[gi,Dp];$(i,function(a){var l=new sN(o.hot,{name:"operator",label:{htmlFor:a,textContent:$xe(a)},value:a,checked:a===i[cN],id:a});l.addLocalHook("change",function(s){return o.onRadioInputChange(s)}),o.elements.push(l)})}},{key:"setChecked",value:function(o){if(this.elements.length<o)throw Error(ft(uN||(uN=MDe(["Radio button with index "," doesn't exist."])),o));$(this.elements,function(i,a){i.setChecked(a===o)})}},{key:"getActiveOperationId",value:function(){var o=this.elements.find(function(i){return i instanceof sN&&i.isChecked()});return o?o.getValue():gi}},{key:"getState",value:function(){return this.getActiveOperationId()}},{key:"setState",value:function(o){this.reset(),o&&this.getActiveOperationId()!==o&&$(this.elements,function(i){i.setChecked(i.getValue()===o)})}},{key:"updateState",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:gi,i=arguments.length>1?arguments[1]:void 0,a=o;a===xP&&(a=Dp),this.state.setValueAtIndex(i,a)}},{key:"reset",value:function(){this.setChecked(cN)}},{key:"onRadioInputChange",value:function(o){this.setState(o.target.value)}}]),r}(eb);const UDe=WDe;var zDe=Ue,YDe=Tr,hN=Yt,GDe=/"/g,KDe=zDe("".replace),qDe=function(e,t,r,n){var o=hN(YDe(e)),i="<"+t;return r!==""&&(i+=" "+r+'="'+KDe(hN(n),GDe,"&quot;")+'"'),i+">"+o+"</"+t+">"},XDe=je,ZDe=function(e){return XDe(function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3})},QDe=$e,JDe=qDe,eNe=ZDe;QDe({target:"String",proto:!0,forced:eNe("link")},{link:function(t){return JDe(this,"a","href",t)}});function $u(e){"@babel/helpers - typeof";return $u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$u(e)}function tNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nNe(n.key),n)}}function rNe(e,t,r){return t&&dN(e.prototype,t),r&&dN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nNe(e){var t=oNe(e,"string");return $u(t)==="symbol"?t:String(t)}function oNe(e,t){if($u(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($u(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wg(){return typeof Reflect<"u"&&Reflect.get?wg=Reflect.get.bind():wg=function(t,r,n){var o=iNe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},wg.apply(this,arguments)}function iNe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Au(e),e!==null););return e}function aNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&BO(e,t)}function BO(e,t){return BO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},BO(e,t)}function lNe(e){var t=uNe();return function(){var n=Au(e),o;if(t){var i=Au(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return sNe(this,o)}}function sNe(e,t){if(t&&($u(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rz(e)}function rz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uNe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Au(e){return Au=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Au(e)}var sS=new WeakMap,fNe=function(e){aNe(r,e);var t=lNe(r);function r(n,o){var i;return tNe(this,r),i=t.call(this,n,Wt(r.DEFAULTS,o)),sS.set(rz(i),{}),i}return rNe(r,[{key:"build",value:function(){wg(Au(r.prototype),"build",this).call(this);var o=sS.get(this);o.link=this._element.firstChild}},{key:"update",value:function(){this.isBuilt()&&(sS.get(this).link.textContent=this.translateIfPossible(this.options.textContent))}}],[{key:"DEFAULTS",get:function(){return pr({href:"#",tagName:"a"})}}]),r}(pi);const vN=fNe;function Iu(e){"@babel/helpers - typeof";return Iu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Iu(e)}function yN(e){return vNe(e)||dNe(e)||hNe(e)||cNe()}function cNe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hNe(e,t){if(e){if(typeof e=="string")return VO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return VO(e,t)}}function dNe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function vNe(e){if(Array.isArray(e))return VO(e)}function VO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function yNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pNe(n.key),n)}}function gNe(e,t,r){return t&&gN(e.prototype,t),r&&gN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pNe(e){var t=mNe(e,"string");return Iu(t)==="symbol"?t:String(t)}function mNe(e,t){if(Iu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Iu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Jl(){return typeof Reflect<"u"&&Reflect.get?Jl=Reflect.get.bind():Jl=function(t,r,n){var o=bNe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Jl.apply(this,arguments)}function bNe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=bi(e),e!==null););return e}function wNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&WO(e,t)}function WO(e,t){return WO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},WO(e,t)}function SNe(e){var t=_Ne();return function(){var n=bi(e),o;if(t){var i=bi(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return CNe(this,o)}}function CNe(e,t){if(t&&(Iu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nz(e)}function nz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _Ne(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bi(e){return bi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bi(e)}var ONe=new WeakMap,RNe="multipleSelect.itemBox",ENe=function(e){wNe(r,e);var t=SNe(r);function r(n,o){var i;return yNe(this,r),i=t.call(this,n,Wt(r.DEFAULTS,o)),ONe.set(nz(i),{}),i.searchInput=new Zl(i.hot,{placeholder:oP,className:"htUIMultipleSelectSearch"}),i.selectAllUI=new vN(i.hot,{textContent:eP,className:"htUISelectAll"}),i.clearAllUI=new vN(i.hot,{textContent:tP,className:"htUIClearAll"}),i.items=[],i.itemsBox=null,i.registerHooks(),i}return gNe(r,[{key:"registerHooks",value:function(){var o=this;this.searchInput.addLocalHook("keydown",function(i){return o.onInputKeyDown(i)}),this.searchInput.addLocalHook("input",function(i){return o.onInput(i)}),this.selectAllUI.addLocalHook("click",function(i){return o.onSelectAllClick(i)}),this.clearAllUI.addLocalHook("click",function(i){return o.onClearAllClick(i)})}},{key:"setItems",value:function(o){this.items=o,this.itemsBox&&this.itemsBox.loadData(this.items)}},{key:"setLocale",value:function(o){this.locale=o}},{key:"getLocale",value:function(){return this.locale}},{key:"getItems",value:function(){return yN(this.items)}},{key:"getValue",value:function(){return PNe(this.items)}},{key:"isSelectedAllValues",value:function(){return this.items.length===this.getValue().length}},{key:"build",value:function(){var o=this;Jl(bi(r.prototype),"build",this).call(this);var i=this.hot.rootDocument,a=i.createElement("div"),l=new pi(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element),this._element.appendChild(l.element),this._element.appendChild(a);var s=function(f){if(o._element){o.itemsBox&&o.itemsBox.destroy(),re(f,"htUIMultipleSelectHot"),o.itemsBox=new o.hot.constructor(f,{data:o.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:function(v,g,m,w,S,C){v.title=C.instance.getDataAtRowProp(g,C.label.property)},maxCols:1,autoWrapCol:!0,height:110,colWidths:function(){return o.itemsBox.container.scrollWidth-Xt(i)},copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:o.hot.isRtl()?"rtl":"ltr"}),o.itemsBox.init();var c=o.itemsBox.getShortcutManager(),h=c.getContext("grid");h.addShortcut({keys:[["Escape"]],callback:function(v){o.runLocalHooks("keydown",v,o)},group:RNe})}};s(a),setTimeout(function(){return s(a)},100)}},{key:"reset",value:function(){this.searchInput.reset(),this.selectAllUI.reset(),this.clearAllUI.reset()}},{key:"update",value:function(){this.isBuilt()&&(this.itemsBox.loadData(TNe(this.items,this.options.value)),Jl(bi(r.prototype),"update",this).call(this))}},{key:"destroy",value:function(){this.itemsBox&&this.itemsBox.destroy(),this.searchInput.destroy(),this.clearAllUI.destroy(),this.selectAllUI.destroy(),this.searchInput=null,this.clearAllUI=null,this.selectAllUI=null,this.itemsBox=null,this.items=null,Jl(bi(r.prototype),"destroy",this).call(this)}},{key:"onInput",value:function(o){var i=this,a=o.target.value.toLocaleLowerCase(this.getLocale()),l;a===""?l=yN(this.items):l=jr(this.items,function(s){return"".concat(s.value).toLocaleLowerCase(i.getLocale()).indexOf(a)>=0}),this.itemsBox.loadData(l)}},{key:"onInputKeyDown",value:function(o){this.runLocalHooks("keydown",o,this);var i=yE(hs,o.keyCode);i("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&(gn(o),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))}},{key:"onSelectAllClick",value:function(o){var i=[];o.preventDefault(),$(this.itemsBox.getSourceData(),function(a,l){a.checked=!0,i.push(O_(a,l)[0])}),this.itemsBox.setSourceDataAtCell(i)}},{key:"onClearAllClick",value:function(o){var i=[];o.preventDefault(),$(this.itemsBox.getSourceData(),function(a,l){a.checked=!1,i.push(O_(a,l)[0])}),this.itemsBox.setSourceDataAtCell(i)}}],[{key:"DEFAULTS",get:function(){return pr({className:"htUIMultipleSelect",value:[]})}}]),r}(pi);const pN=ENe;function TNe(e,t){var r=Pv(t);return Be(e,function(n){return n.checked=r(n.value),n})}function PNe(e){var t=[];return $(e,function(r){r.checked&&t.push(r.value)}),t}function Mu(e){"@babel/helpers - typeof";return Mu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mu(e)}function kNe(e,t){return MNe(e)||INe(e,t)||ANe(e,t)||$Ne()}function $Ne(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ANe(e,t){if(e){if(typeof e=="string")return mN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mN(e,t)}}function mN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function INe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function MNe(e){if(Array.isArray(e))return e}function xNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,NNe(n.key),n)}}function DNe(e,t,r){return t&&bN(e.prototype,t),r&&bN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function NNe(e){var t=HNe(e,"string");return Mu(t)==="symbol"?t:String(t)}function HNe(e,t){if(Mu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Mu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Sg(){return typeof Reflect<"u"&&Reflect.get?Sg=Reflect.get.bind():Sg=function(t,r,n){var o=LNe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Sg.apply(this,arguments)}function LNe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=xu(e),e!==null););return e}function jNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&UO(e,t)}function UO(e,t){return UO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},UO(e,t)}function FNe(e){var t=WNe();return function(){var n=xu(e),o;if(t){var i=xu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return BNe(this,o)}}function BNe(e,t){if(t&&(Mu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return VNe(e)}function VNe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function WNe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xu(e){return xu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xu(e)}var UNe=function(e){jNe(r,e);var t=FNe(r);function r(n,o){var i;return xNe(this,r),i=t.call(this,n,{id:o.id,stateless:!1}),i.name=o.name,i.elements.push(new pN(i.hot)),i.registerHooks(),i}return DNe(r,[{key:"registerHooks",value:function(){var o=this;this.getMultipleSelectElement().addLocalHook("keydown",function(i){return o.onInputKeyDown(i)})}},{key:"setState",value:function(o){if(this.reset(),o&&o.command.key===va){var i=this.getMultipleSelectElement();i.setItems(o.itemsSnapshot),i.setValue(o.args[0]),i.setLocale(o.locale)}}},{key:"getState",value:function(){var o=this.getMultipleSelectElement(),i=o.getItems();return{command:{key:o.isSelectedAllValues()||!i.length?Jt:va},args:[o.getValue()],itemsSnapshot:i}}},{key:"updateState",value:function(o){var i=this,a=function(s,u,f,c,h){var d=jr(u,function(V){return V.name===va}),v=kNe(d,1),g=v[0],m={},w=i.hot.getTranslatedPhrase(_p);if(g){var S=DO(Be(c(s,h),function(V){return V.value}));f&&(g.args[0]=f);var C=[],P=QD(S,g.args[0],w,function(V){V.checked&&C.push(V.value)}),R=o.editedConditionStack.column;m.locale=i.hot.getCellMeta(0,R).locale,m.args=[C],m.command=da(va),m.itemsSnapshot=P}else m.args=[],m.command=da(Jt);i.state.setValueAtIndex(s,m)};a(o.editedConditionStack.column,o.editedConditionStack.conditions,o.conditionArgsChange,o.filteredRowsFactory),o.dependentConditionStacks.length&&a(o.dependentConditionStacks[0].column,o.dependentConditionStacks[0].conditions,o.conditionArgsChange,o.filteredRowsFactory,o.editedConditionStack)}},{key:"getMultipleSelectElement",value:function(){return this.elements.filter(function(o){return o instanceof pN})[0]}},{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,l,s,u,f,c){re(l.parentNode,"htFiltersMenuValue");var h=o.hot.rootDocument.createElement("div");return re(h,"htFiltersMenuLabel"),h.textContent=c,l.appendChild(h),l.parentNode.hasAttribute("ghost-table")||$(o.elements,function(d){return l.appendChild(d.element)}),l}}}},{key:"reset",value:function(){var o=this.hot.getTranslatedPhrase(_p),i=DO(this._getColumnVisibleValues()),a=QD(i,i,o);this.getMultipleSelectElement().setItems(a),Sg(xu(r.prototype),"reset",this).call(this),this.getMultipleSelectElement().setValue(i);var l=this.hot.getPlugin("filters").getSelectedColumn();l!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,l.visualIndex).locale)}},{key:"onInputKeyDown",value:function(o){hs(o.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),gn(o))}},{key:"_getColumnVisibleValues",value:function(){var o=this.hot.getPlugin("filters").getSelectedColumn();return o===null?[]:Be(this.hot.getDataAtCol(o.visualIndex),function(i){return qU(i)})}}]),r}(eb);const zNe=UNe;function Du(e){"@babel/helpers - typeof";return Du=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Du(e)}function YNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,KNe(n.key),n)}}function GNe(e,t,r){return t&&wN(e.prototype,t),r&&wN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function KNe(e){var t=qNe(e,"string");return Du(t)==="symbol"?t:String(t)}function qNe(e,t){if(Du(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Du(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function XNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zO(e,t)}function zO(e,t){return zO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},zO(e,t)}function ZNe(e){var t=eHe();return function(){var n=Hp(e),o;if(t){var i=Hp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return QNe(this,o)}}function QNe(e,t){if(t&&(Du(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return JNe(e)}function JNe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eHe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Hp(e){return Hp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Hp(e)}var tHe=function(e){XNe(r,e);var t=ZNe(r);function r(n,o){var i;return YNe(this,r),i=t.call(this,n,{id:o.id,stateless:!0}),i.name=o.name,i.elements.push(new Zl(i.hot,{type:"button",value:rP,className:"htUIButton htUIButtonOK",identifier:r.BUTTON_OK})),i.elements.push(new Zl(i.hot,{type:"button",value:nP,className:"htUIButton htUIButtonCancel",identifier:r.BUTTON_CANCEL})),i.registerHooks(),i}return GNe(r,[{key:"registerHooks",value:function(){var o=this;$(this.elements,function(i){i.addLocalHook("click",function(a,l){return o.onButtonClick(a,l)})})}},{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,l){return re(l.parentNode,"htFiltersMenuActionBar"),l.parentNode.hasAttribute("ghost-table")||$(o.elements,function(s){return l.appendChild(s.element)}),l}}}},{key:"accept",value:function(){this.runLocalHooks("accept")}},{key:"cancel",value:function(){this.runLocalHooks("cancel")}},{key:"onButtonClick",value:function(o,i){i.options.identifier===r.BUTTON_OK?this.accept():this.cancel()}}],[{key:"BUTTON_OK",get:function(){return"ok"}},{key:"BUTTON_CANCEL",get:function(){return"cancel"}}]),r}(eb);const rHe=tHe;function gd(e){"@babel/helpers - typeof";return gd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gd(e)}var SN,CN;function _N(e,t){return aHe(e)||iHe(e,t)||oHe(e,t)||nHe()}function nHe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oHe(e,t){if(e){if(typeof e=="string")return ON(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ON(e,t)}}function ON(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function iHe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function aHe(e){if(Array.isArray(e))return e}function RN(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function lHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uHe(n.key),n)}}function sHe(e,t,r){return t&&EN(e.prototype,t),r&&EN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uHe(e){var t=fHe(e,"string");return gd(t)==="symbol"?t:String(t)}function fHe(e,t){if(gd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TN="ConditionCollection.filteringStates",oz=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;lHe(this,e),this.hot=t,this.isMapRegistrable=r,this.filteringStates=new Nm,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(TN,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}return sHe(e,[{key:"isEmpty",value:function(){return this.getFilteredColumns().length===0}},{key:"isMatch",value:function(r,n){var o,i=this.filteringStates.getValueAtIndex(n),a=(o=i==null?void 0:i.conditions)!==null&&o!==void 0?o:[],l=i==null?void 0:i.operation;return this.isMatchInConditions(a,r,l)}},{key:"isMatchInConditions",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:gi;return r.length?kxe(o)(r,n):!0}},{key:"addCondition",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:gi,i=arguments.length>3?arguments[3]:void 0,a=this.hot.getCellMeta(0,r).locale,l=Be(n.args,function(c){return typeof c=="string"?c.toLocaleLowerCase(a):c}),s=n.name||n.command.key;this.runLocalHooks("beforeAdd",r);var u=this.getOperation(r);if(u){if(u!==o)throw Error(ft(SN||(SN=RN(["The column of index "," has been already applied with a `","` \n        filter operation. Use `removeConditions` to clear the current conditions and then add new ones. \n        Mind that you cannot mix different types of operations (for instance, if you use `conjunction`, \n        use it consequently for a particular column)."],["The column of index "," has been already applied with a \\`","\\`\\x20\n        filter operation. Use \\`removeConditions\\` to clear the current conditions and then add new ones.\\x20\n        Mind that you cannot mix different types of operations (for instance, if you use \\`conjunction\\`,\\x20\n        use it consequently for a particular column)."])),r,u))}else if(gt(dd[o]))throw new Error(ft(CN||(CN=RN(["Unexpected operation named `","`. Possible ones are \n        `disjunction` and `conjunction`."],["Unexpected operation named \\`","\\`. Possible ones are\\x20\n        \\`disjunction\\` and \\`conjunction\\`."])),o));var f=this.getConditions(r);f.length===0?this.filteringStates.setValueAtIndex(r,{operation:o,conditions:[{name:s,args:l,func:Ti(s,l)}]},i):f.push({name:s,args:l,func:Ti(s,l)}),this.runLocalHooks("afterAdd",r)}},{key:"getConditions",value:function(r){var n,o;return(n=(o=this.filteringStates.getValueAtIndex(r))===null||o===void 0?void 0:o.conditions)!==null&&n!==void 0?n:[]}},{key:"getOperation",value:function(r){var n;return(n=this.filteringStates.getValueAtIndex(r))===null||n===void 0?void 0:n.operation}},{key:"getFilteredColumns",value:function(){return this.filteringStates.getEntries().map(function(r){var n=_N(r,1),o=n[0];return o})}},{key:"getColumnStackPosition",value:function(r){return this.getFilteredColumns().indexOf(r)}},{key:"exportAllConditions",value:function(){return Lt(this.filteringStates.getEntries(),function(r,n){var o=_N(n,2),i=o[0],a=o[1],l=a.operation,s=a.conditions;return r.push({column:i,operation:l,conditions:Be(s,function(u){var f=u.name,c=u.args;return{name:f,args:c}})}),r},[])}},{key:"importAllConditions",value:function(r){var n=this;this.clean(),$(r,function(o){$(o.conditions,function(i){return n.addCondition(o.column,i)})})}},{key:"removeConditions",value:function(r){this.runLocalHooks("beforeRemove",r),this.filteringStates.clearValue(r),this.runLocalHooks("afterRemove",r)}},{key:"clean",value:function(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}},{key:"hasConditions",value:function(r,n){var o=this.getConditions(r);return n?o.some(function(i){return i.name===n}):o.length>0}},{key:"destroy",value:function(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(TN),this.filteringStates=null,this.clearLocalHooks()}}]),e}();pt(oz,kr);const iz=oz;function pd(e){"@babel/helpers - typeof";return pd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pd(e)}function cHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dHe(n.key),n)}}function hHe(e,t,r){return t&&PN(e.prototype,t),r&&PN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dHe(e){var t=vHe(e,"string");return pd(t)==="symbol"?t:String(t)}function vHe(e,t){if(pd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yHe=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return[]};cHe(this,e),this.conditionCollection=t,this.columnDataFactory=r}return hHe(e,[{key:"filter",value:function(){var r=this,n=[];return $(this.conditionCollection.getFilteredColumns(),function(o,i){var a=r.columnDataFactory(o);i&&(a=r._getIntersectData(a,n)),n=r.filterByColumn(o,a)}),n}},{key:"filterByColumn",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=[];return $(o,function(a){a!==void 0&&n.conditionCollection.isMatch(a,r)&&i.push(a)}),i}},{key:"_getIntersectData",value:function(r,n){var o=[];return $(n,function(i){var a=i.meta.visualRow;r[a]!==void 0&&(o[a]=r[a])}),o}}]),e}();const az=yHe;function md(e){"@babel/helpers - typeof";return md=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},md(e)}function gHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mHe(n.key),n)}}function pHe(e,t,r){return t&&kN(e.prototype,t),r&&kN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mHe(e){var t=bHe(e,"string");return md(t)==="symbol"?t:String(t)}function bHe(e,t){if(md(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(md(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lz=function(){function e(t,r){var n=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){return[]};gHe(this,e),this.hot=t,this.conditionCollection=r,this.columnDataFactory=o,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.conditionCollection.addLocalHook("beforeRemove",function(i){return n._onConditionBeforeModify(i)}),this.conditionCollection.addLocalHook("afterRemove",function(i){return n.updateStatesAtColumn(i)}),this.conditionCollection.addLocalHook("afterAdd",function(i){return n.updateStatesAtColumn(i)}),this.conditionCollection.addLocalHook("beforeClean",function(){return n._onConditionBeforeClean()}),this.conditionCollection.addLocalHook("afterClean",function(){return n._onConditionAfterClean()})}return pHe(e,[{key:"groupChanges",value:function(){this.grouping=!0}},{key:"flush",value:function(){var r=this;this.grouping=!1,$(this.changes,function(n){r.updateStatesAtColumn(n)}),this.changes.length=0}},{key:"_onConditionBeforeModify",value:function(r){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(r)}},{key:"updateStatesAtColumn",value:function(r,n){var o=this;if(this.grouping){this.changes.indexOf(r)===-1&&this.changes.push(r);return}var i=this.conditionCollection.exportAllConditions(),a=this.conditionCollection.getColumnStackPosition(r);a===-1&&(a=this.latestEditedColumnPosition);var l=i.slice(0,a),s=i.slice(a);s.length&&s[0].column===r&&s.shift();var u=SV(function(c,h){var d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],v=new iz(o.hot,!1),g=[].concat(c,d);v.importAllConditions(g);var m=o.columnDataFactory(h),w;v.isEmpty()?w=m:w=new az(v,function(C){return o.columnDataFactory(C)}).filter(),w=Be(w,function(C){return C.meta.visualRow});var S=Pv(w);return v.destroy(),jr(m,function(C){return S(C.meta.visualRow)})})(l),f=[].concat(this.conditionCollection.getConditions(r));this.runLocalHooks("update",{editedConditionStack:{column:r,conditions:f},dependentConditionStacks:s,filteredRowsFactory:u,conditionArgsChange:n})}},{key:"_onConditionBeforeClean",value:function(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}},{key:"_onConditionAfterClean",value:function(){var r=this;$(this.latestOrderStack,function(n){r.updateStatesAtColumn(n)})}},{key:"destroy",value:function(){var r=this;this.clearLocalHooks(),We(this,function(n,o){r[o]=null})}}]),e}();pt(lz,kr);const wHe=lz;function Nu(e){"@babel/helpers - typeof";return Nu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nu(e)}var $N;function SHe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function CHe(e,t){return EHe(e)||RHe(e,t)||OHe(e,t)||_He()}function _He(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OHe(e,t){if(e){if(typeof e=="string")return AN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return AN(e,t)}}function AN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function RHe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function EHe(e){if(Array.isArray(e))return e}function THe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function IN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kHe(n.key),n)}}function PHe(e,t,r){return t&&IN(e.prototype,t),r&&IN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kHe(e){var t=$He(e,"string");return Nu(t)==="symbol"?t:String(t)}function $He(e,t){if(Nu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Nu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function es(){return typeof Reflect<"u"&&Reflect.get?es=Reflect.get.bind():es=function(t,r,n){var o=AHe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},es.apply(this,arguments)}function AHe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=wi(e),e!==null););return e}function IHe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&YO(e,t)}function YO(e,t){return YO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},YO(e,t)}function MHe(e){var t=DHe();return function(){var n=wi(e),o;if(t){var i=wi(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return xHe(this,o)}}function xHe(e,t){if(t&&(Nu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sz(e)}function sz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function DHe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wi(e){return wi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wi(e)}var MN="filters",NHe=250,HHe=function(e){IHe(r,e);var t=MHe(r);function r(n){var o;return THe(this,r),o=t.call(this,n),o.eventManager=new Tt(sz(o)),o.dropdownMenuPlugin=null,o.conditionCollection=null,o.conditionUpdateObserver=null,o.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]),o.filtersRowsMap=null,o.hot.addHook("afterGetColHeader",function(i,a){return o.onAfterGetColHeader(i,a)}),o}return PHe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[MN]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new wv),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");var i=this.hot.getSettings().dropdownMenu,a=i&&i.uiContainer||this.hot.rootDocument.body,l=function(d){return d.addLocalHook("accept",function(){return o.onActionBarSubmit("accept")}),d.addLocalHook("cancel",function(){return o.onActionBarSubmit("cancel")}),d.addLocalHook("change",function(v){return o.onComponentChange(d,v)}),d},s=function(){return"".concat(o.hot.getTranslatedPhrase(ZT),":")},u=function(){return"".concat(o.hot.getTranslatedPhrase(QT),":")};if(!this.components.get("filter_by_condition")){var f=new lS(this.hot,{id:"filter_by_condition",name:s,addSeparator:!1,menuContainer:a});f.addLocalHook("afterClose",function(){return o.onSelectUIClosed()}),this.components.set("filter_by_condition",l(f))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new UDe(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){var c=new lS(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:a});c.addLocalHook("afterClose",function(){return o.onSelectUIClosed()}),this.components.set("filter_by_condition2",l(c))}this.components.get("filter_by_value")||this.components.set("filter_by_value",l(new zNe(this.hot,{id:"filter_by_value",name:u}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",l(new rHe(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new iz(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new wHe(this.hot,this.conditionCollection,function(h){return o.getDataMapAtColumn(h)}),this.conditionUpdateObserver.addLocalHook("update",function(h){return o.updateComponents(h)})),this.components.forEach(function(h){return h.show()}),this.addHook("beforeDropdownMenuSetItems",function(h){return o.onBeforeDropdownMenuSetItems(h)}),this.addHook("afterDropdownMenuDefaultOptions",function(h){return o.onAfterDropdownMenuDefaultOptions(h)}),this.addHook("afterDropdownMenuShow",function(){return o.onAfterDropdownMenuShow()}),this.addHook("afterDropdownMenuHide",function(){return o.onAfterDropdownMenuHide()}),this.addHook("afterChange",function(h){return o.onAfterChange(h)}),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),es(wi(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var o=this;if(this.enabled){var i;(i=this.dropdownMenuPlugin)!==null&&i!==void 0&&i.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach(function(a,l){a.destroy(),o.components.set(l,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}es(wi(r.prototype),"disablePlugin",this).call(this)}},{key:"addCondition",value:function(o,i,a){var l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:gi,s=this.hot.toPhysicalColumn(o);this.conditionCollection.addCondition(s,{command:{key:i},args:a},l)}},{key:"removeConditions",value:function(o){var i=this.hot.toPhysicalColumn(o);this.conditionCollection.removeConditions(i)}},{key:"clearConditions",value:function(o){if(o===void 0)this.conditionCollection.clean();else{var i=this.hot.toPhysicalColumn(o);this.conditionCollection.removeConditions(i)}}},{key:"filter",value:function(){var o=this,i=this._createDataFilter(),a=!this.conditionCollection.isEmpty(),l=[],s=this.conditionCollection.exportAllConditions(),u=this.hot.runHooks("beforeFilter",s);if(u!==!1)if(a){var f=[];this.hot.batchExecution(function(){o.filtersRowsMap.clear(),l=Be(i.filter(),function(h){return h.meta.visualRow});var c=Pv(l);_e(o.hot.countSourceRows()-1,function(h){c(h)||f.push(h)}),$(f,function(h){o.filtersRowsMap.setValueAtIndex(h,!0)})},!0),l.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",s),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.clearColumnSelection()}},{key:"getSelectedColumn",value:function(){var o,i=(o=this.hot.getSelectedRangeLast())===null||o===void 0?void 0:o.highlight;return i?{visualIndex:i.col,physicalIndex:this.hot.toPhysicalColumn(i.col)}:null}},{key:"clearColumnSelection",value:function(){var o=this.getSelectedColumn();o!==null&&this.hot.selectCell(0,o.visualIndex)}},{key:"getDataMapAtColumn",value:function(o){var i=this,a=this.hot.toVisualColumn(o),l=[];return $(this.hot.getSourceDataAtCol(a),function(s,u){var f,c=i.hot.getCellMeta(u,a),h=c.row,d=c.col,v=c.visualCol,g=c.visualRow,m=c.type,w=c.instance,S=c.dateFormat,C=c.locale,P=(f=i.hot.getDataAtCell(i.hot.toVisualRow(u),a))!==null&&f!==void 0?f:s;l.push({meta:{row:h,col:d,visualCol:v,visualRow:g,type:m,instance:w,dateFormat:S,locale:C},value:qU(P)})}),l}},{key:"onAfterChange",value:function(o){var i=this;o&&$(o,function(a){var l=CHe(a,2),s=l[1],u=i.hot.propToCol(s);i.conditionCollection.hasConditions(u)&&i.updateValueComponentCondition(u)})}},{key:"updateValueComponentCondition",value:function(o){var i=this.hot.getDataAtCol(o),a=DO(i);this.conditionUpdateObserver.updateStatesAtColumn(o,a)}},{key:"restoreComponents",value:function(o){var i,a=(i=this.getSelectedColumn())===null||i===void 0?void 0:i.physicalIndex;o.forEach(function(l){l.isHidden()||l.restoreState(a)}),this.updateDependentComponentsVisibility()}},{key:"onAfterDropdownMenuShow",value:function(){this.restoreComponents(Array.from(this.components.values()))}},{key:"onAfterDropdownMenuHide",value:function(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}},{key:"onBeforeDropdownMenuSetItems",value:function(){var o=this;this.dropdownMenuPlugin&&this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",function(){o.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:!0})})}},{key:"onAfterDropdownMenuDefaultOptions",value:function(o){o.items.push({name:Ye}),this.components.forEach(function(i){o.items.push(i.getMenuItemDescriptor())})}},{key:"getOperationBasedOnArguments",value:function(o,i,a,l){var s=o;return s===Dp&&i.command.key!==Jt&&a.command.key!==Jt&&l.command.key!==Jt?s=xP:l.command.key!==Jt&&(i.command.key===Jt||a.command.key===Jt)&&(s=gi),s}},{key:"onActionBarSubmit",value:function(o){var i;if(o==="accept"){var a=this.getSelectedColumn();if(a===null){var l;(l=this.dropdownMenuPlugin)===null||l===void 0||l.close();return}var s=a.physicalIndex,u=this.components.get("filter_by_condition").getState(),f=this.components.get("filter_by_condition2").getState(),c=this.components.get("filter_by_value").getState(),h=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),u,f,c);this.conditionUpdateObserver.groupChanges();var d=this.conditionCollection.getColumnStackPosition(s);d===-1&&(d=void 0),this.conditionCollection.removeConditions(s),u.command.key!==Jt&&(this.conditionCollection.addCondition(s,u,h,d),f.command.key!==Jt&&this.conditionCollection.addCondition(s,f,h,d)),c.command.key!==Jt&&this.conditionCollection.addCondition(s,c,h,d),this.conditionUpdateObserver.flush(),this.components.forEach(function(v){return v.saveState(s)}),this.filtersRowsMap.clear(),this.filter()}(i=this.dropdownMenuPlugin)===null||i===void 0||i.close()}},{key:"onComponentChange",value:function(o,i){this.updateDependentComponentsVisibility(),o.constructor===lS&&!i.inputsCount&&this.setListeningDropdownMenu()}},{key:"onSelectUIClosed",value:function(){this.setListeningDropdownMenu()}},{key:"setListeningDropdownMenu",value:function(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}},{key:"updateDependentComponentsVisibility",value:function(){var o=this.components.get("filter_by_condition"),i=o.getState(),a=i.command,l=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];a.showOperators?this.showComponents.apply(this,l):this.hideComponents.apply(this,l)}},{key:"onAfterGetColHeader",value:function(o,i){var a=this.hot.toPhysicalColumn(o);this.enabled&&this.conditionCollection.hasConditions(a)?re(i,"htFiltersActive"):Le(i,"htFiltersActive")}},{key:"_createDataFilter",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new az(i,function(a){return o.getDataMapAtColumn(a)})}},{key:"updateComponents",value:function(o){var i;if((i=this.dropdownMenuPlugin)!==null&&i!==void 0&&i.enabled){var a=o.editedConditionStack,l=a.conditions,s=a.column,u=l.filter(function(h){return h.name===va}),f=l.filter(function(h){return h.name!==va});if(u.length>=2||f.length>=3)ht(ft($N||($N=SHe([`The filter conditions have been applied properly, but couldn’t be displayed visually. 
        The overall amount of conditions exceed the capability of the dropdown menu. 
        For more details see the documentation.`],[`The filter conditions have been applied properly, but couldn’t be displayed visually.\\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\\x20
        For more details see the documentation.`]))));else{var c=this.conditionCollection.getOperation(s);this.components.get("filter_by_condition").updateState(f[0],s),this.components.get("filter_by_condition2").updateState(f[1],s),this.components.get("filter_operators").updateState(c,s),this.components.get("filter_by_value").updateState(o)}}}},{key:"getIndexesOfComponents",value:function(){var o=[];if(!this.dropdownMenuPlugin)return o;for(var i=this.dropdownMenuPlugin.menu,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return $(l,function(u){$(i.menuItems,function(f,c){f.key===u.getMenuItemDescriptor().key&&o.push(c)})}),o}},{key:"changeComponentsVisibility",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(this.dropdownMenuPlugin){for(var i=this.dropdownMenuPlugin.menu,a=i.hotMenu,l=a.getPlugin("hiddenRows"),s=arguments.length,u=new Array(s>1?s-1:0),f=1;f<s;f++)u[f-1]=arguments[f];var c=this.getIndexesOfComponents.apply(this,u);o?l.showRows(c):l.hideRows(c),a.render()}}},{key:"hideComponents",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.changeComponentsVisibility.apply(this,[!1].concat(i))}},{key:"showComponents",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.changeComponentsVisibility.apply(this,[!0].concat(i))}},{key:"destroy",value:function(){var o=this;this.enabled&&(this.components.forEach(function(i,a){i!==null&&(i.destroy(),o.components.set(a,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),es(wi(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return MN}},{key:"PLUGIN_PRIORITY",get:function(){return NHe}},{key:"PLUGIN_DEPS",get:function(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}}]),r}(ot);function bd(e){"@babel/helpers - typeof";return bd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bd(e)}function xN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function kc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xN(Object(r),!0).forEach(function(n){LHe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function LHe(e,t,r){return t=jHe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jHe(e){var t=FHe(e,"string");return bd(t)==="symbol"?t:String(t)}function FHe(e,t){if(bd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var uz="internal-use-in-handsontable",GO={licenseKey:uz,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function fz(e){var t,r;return{maxColumns:e.maxColumns,maxRows:e.maxRows,language:(t=e[nr])===null||t===void 0||(r=t.language)===null||r===void 0?void 0:r.langCode}}function cz(e){return Object.keys(e).reduce(function(t,r){return r!=="hyperformula"&&(t[r]=e[r]),t},{})}function BHe(e){var t,r=e[nr],n=cz(r!=null&&(t=r.engine)!==null&&t!==void 0&&t.hyperformula?r.engine:{}),o=fz(e);return kc(kc(kc({},GO),n),o)}function VHe(e){var t,r=e[nr],n=cz(r!=null&&(t=r.engine)!==null&&t!==void 0&&t.hyperformula?r.engine:{}),o=fz(e);return kc(kc({},n),o)}function WHe(e,t){return Object.keys(t).some(function(r){return t[r]!==void 0&&t[r]!==e[r]})}var DN;function UHe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function KO(e){"@babel/helpers - typeof";return KO=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},KO(e)}function tb(){var e="engine_relationship",t=Jr(nr);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function DP(){var e="shared_engine_usage",t=Jr(nr);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function zHe(e){var t=e.getSettings(),r=t[nr],n=r==null?void 0:r.engine;if(r===!0||gt(n))return null;if(typeof n.hyperformula=="function"||typeof n=="function"){var o;return YHe((o=n.hyperformula)!==null&&o!==void 0?o:n,t,e)}else if(KO(n)==="object"&&gt(n.hyperformula)){var i=tb(),a=DP().get(n);return i.has(n)||i.set(n,[]),i.get(n).push(e),a&&a.push(e.guid),n.getConfig().licenseKey||n.updateConfig({licenseKey:uz}),(n.getConfig().leapYear1900!==GO.leapYear1900||vm(n.getConfig().nullDate,GO.nullDate)===!1)&&ht(ft(DN||(DN=UHe(["If you use HyperFormula with Handsontable, keep the default `leapYear1900` and `nullDate` \n      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates."],["If you use HyperFormula with Handsontable, keep the default \\`leapYear1900\\` and \\`nullDate\\` \n      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates."])))),n}return null}function YHe(e,t,r){var n=t[nr],o=BHe(t),i=tb(),a=DP();GHe(e,n.functions),KHe(e,n.language);var l=e.buildEmpty(o);return i.set(l,[r]),a.set(l,[r.guid]),qHe(l,n.namedExpressions),l.on("sheetAdded",function(){l.rebuildAndRecalculate()}),l.on("sheetRemoved",function(){l.rebuildAndRecalculate()}),l}function NN(e){var t,r=tb(),n=r.size===0?[]:Array.from((t=r.get(e))!==null&&t!==void 0?t:[]);return new Map(n.map(function(o){return[o.getPlugin("formulas").sheetId,o]}))}function HN(e,t){if(e){var r=tb(),n=r.get(e),o=DP(),i=o.get(e);n&&n.includes(t)&&(n.splice(n.indexOf(t),1),n.length===0&&r.delete(e)),i&&i.includes(t.guid)&&(i.splice(i.indexOf(t.guid),1),i.length===0&&(o.delete(e),e.destroy()))}}function GHe(e,t){t&&t.forEach(function(r){var n=r.name,o=r.plugin,i=r.translations;try{e.registerFunction(n,o,i)}catch(a){ht(a.message)}})}function KHe(e,t){if(t){var r=t.langCode;try{e.registerLanguage(r,t)}catch(n){ht(n.message)}}}function qHe(e,t){t&&(e.suspendEvaluation(),t.forEach(function(r){var n=r.name,o=r.expression,i=r.scope,a=r.options;try{e.addNamedExpression(n,o,i,a)}catch(l){ht(l.message)}}),e.resumeEvaluation())}function XHe(e,t){return(gt(t)||!e.doesSheetExist(t))&&(t=e.addSheet(t)),t}var hz="DD/MM/YYYY";function dz(e){return typeof e=="string"&&e.charAt(0)==="'"&&e.charAt(1)==="="}function ZHe(e){return dz(e)?e.substr(1):e}function QHe(e){return typeof e=="string"&&e.startsWith("=")}function uS(e,t){return typeof e=="string"&&t==="date"}function LN(e,t){return te(e,t,!0).isValid()}function jN(e,t){return te(e,t,!0).format(hz)}function JHe(e,t){return te(e,hz,!0).format(t)}function FN(e,t){var r=-1,n=new Date(Date.UTC(0,0,e+r));return te(n).format(t)}function wd(e){"@babel/helpers - typeof";return wd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wd(e)}function eLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rLe(n.key),n)}}function tLe(e,t,r){return t&&BN(e.prototype,t),r&&BN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rLe(e){var t=nLe(e,"string");return wd(t)==="symbol"?t:String(t)}function nLe(e,t){if(wd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zi(e,t,r){oLe(e,t),t.set(e,r)}function oLe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function St(e,t){var r=vz(e,t,"get");return iLe(e,r)}function iLe(e,t){return t.get?t.get.call(e):t.value}function qo(e,t,r){var n=vz(e,t,"set");return aLe(e,n,r),r}function vz(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function aLe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Zf=new WeakMap,Xo=new WeakMap,Ir=new WeakMap,Ey=new WeakMap,fS=new WeakMap,cS=new WeakMap,Ty=new WeakMap,lLe=function(){function e(t,r,n){eLe(this,e),zi(this,Zf,{writable:!0,value:void 0}),zi(this,Xo,{writable:!0,value:void 0}),zi(this,Ir,{writable:!0,value:void 0}),zi(this,Ey,{writable:!0,value:[]}),zi(this,fS,{writable:!0,value:[]}),zi(this,cS,{writable:!0,value:void 0}),zi(this,Ty,{writable:!0,value:[]}),qo(this,Zf,t),qo(this,Xo,r),qo(this,Ir,n)}return tLe(e,[{key:"setRemovedHfIndexes",value:function(r){var n=this;return qo(this,Ty,r.map(function(o){var i=St(n,Xo).getVisualFromPhysicalIndex(o);return n.getHfIndexFromVisualIndex(i)})),St(this,Ty)}},{key:"getRemovedHfIndexes",value:function(){return St(this,Ty)}},{key:"getHfIndexFromVisualIndex",value:function(r){var n=St(this,Xo).getIndexesSequence(),o=St(this,Xo).getNotTrimmedIndexes();return n.indexOf(o[r])}},{key:"syncMoves",value:function(r){var n=this,o=1,i="move".concat(ar(St(this,Zf)),"s");St(this,Ir).getEngine().batch(function(){r.forEach(function(a){var l=a.from!==a.to,s=a.from+1!==a.to;l&&s&&St(n,Ir).getEngine()[i](St(n,Ir).getSheetId(),a.from,o,a.to)})})}},{key:"storeMovesInformation",value:function(r,n,o){var i=this;o!==!1&&(qo(this,fS,r.map(function(a){return i.getHfIndexFromVisualIndex(a)})),qo(this,cS,this.getHfIndexFromVisualIndex(n)))}},{key:"getMoveLine",value:function(r,n){var o=St(this,Xo).getNumberOfIndexes(),i=Array.from(Array(o).keys()).filter(function(l){return r.includes(l)===!1});if(n===0){var a;return(a=i[n])!==null&&a!==void 0?a:0}return i[n-1]+1}},{key:"getInitiallyCalculatedMoves",value:function(r,n){var o=this.getMoveLine(r,n),i=[];return r.forEach(function(a){var l={from:a,to:o};i.forEach(function(s){var u=s.from>s.to,f=s.to<=l.from,c=s.from>l.from;c&&f&&u&&(l.from+=1)}),l.from>=o&&(o+=1),i.push(l)}),i}},{key:"adjustedCalculatedMoves",value:function(r){return r.forEach(function(n,o){var i=r.slice(o+1);i.forEach(function(a){var l=a.from<a.to;a.from>n.from&&l&&(a.from-=1)})}),r}},{key:"calculateAndSyncMoves",value:function(r,n){var o=this;if(!St(this,Ir).isPerformingUndoRedo()&&!(r===!1||n===!1)){var i=this.adjustedCalculatedMoves(this.getInitiallyCalculatedMoves(St(this,fS),St(this,cS)));St(this,Ir).getSheetId()===null?St(this,Ir).getPostponeAction(function(){return o.syncMoves(i)}):this.syncMoves(i)}}},{key:"getIndexesChangeSyncMethod",value:function(){var r=this,n="set".concat(ar(St(this,Zf)),"Order");return function(o){if(!St(r,Ir).isPerformingUndoRedo()){var i=St(r,Xo).getIndexesSequence();if(o==="update"){var a=St(r,Ey).map(function(c){return i.indexOf(c)}),l=St(r,Ir).getEngine().getSheetDimensions(St(r,Ir).getSheetId()),s;St(r,Zf)==="row"?s=l.height:s=l.width;for(var u=a.length,f=u;f<s;f+=1)a.push(f);St(r,Ir).getEngine()[n](St(r,Ir).getSheetId(),a)}qo(r,Ey,i)}}}},{key:"init",value:function(){qo(this,Ey,St(this,Xo).getIndexesSequence())}}]),e}();const VN=lLe;function Sd(e){"@babel/helpers - typeof";return Sd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sd(e)}function sLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fLe(n.key),n)}}function uLe(e,t,r){return t&&WN(e.prototype,t),r&&WN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fLe(e){var t=cLe(e,"string");return Sd(t)==="symbol"?t:String(t)}function cLe(e,t){if(Sd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Yi(e,t,r){hLe(e,t),t.set(e,r)}function hLe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kn(e,t){var r=yz(e,t,"get");return dLe(e,r)}function dLe(e,t){return t.get?t.get.call(e):t.value}function Gi(e,t,r){var n=yz(e,t,"set");return vLe(e,n,r),r}function yz(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function vLe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Py=new WeakMap,ky=new WeakMap,hS=new WeakMap,dS=new WeakMap,vS=new WeakMap,yS=new WeakMap,gS=new WeakMap,yLe=function(){function e(t,r,n){sLe(this,e),Yi(this,Py,{writable:!0,value:void 0}),Yi(this,ky,{writable:!0,value:void 0}),Yi(this,hS,{writable:!0,value:void 0}),Yi(this,dS,{writable:!0,value:!1}),Yi(this,vS,{writable:!0,value:!1}),Yi(this,yS,{writable:!0,value:null}),Yi(this,gS,{writable:!0,value:null}),Gi(this,Py,new VN("row",t,this)),Gi(this,ky,new VN("column",r,this)),Gi(this,hS,n)}return uLe(e,[{key:"getForAxis",value:function(r){return r==="row"?Kn(this,Py):Kn(this,ky)}},{key:"setPerformUndo",value:function(r){Gi(this,dS,r)}},{key:"setPerformRedo",value:function(r){Gi(this,vS,r)}},{key:"isPerformingUndoRedo",value:function(){return Kn(this,dS)||Kn(this,vS)}},{key:"getSheetId",value:function(){return Kn(this,gS)}},{key:"getEngine",value:function(){return Kn(this,yS)}},{key:"getPostponeAction",value:function(){return Kn(this,hS)}},{key:"setupSyncEndpoint",value:function(r,n){Gi(this,yS,r),Gi(this,gS,n),Kn(this,Py).init(),Kn(this,ky).init()}}]),e}();const gLe=yLe;function pLe(e){return wLe(e)||bLe(e)||gz(e)||mLe()}function mLe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bLe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function wLe(e){if(Array.isArray(e))return qO(e)}function Pi(e){"@babel/helpers - typeof";return Pi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pi(e)}function Tl(e,t){return _Le(e)||CLe(e,t)||gz(e,t)||SLe()}function SLe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gz(e,t){if(e){if(typeof e=="string")return qO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qO(e,t)}}function qO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function CLe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function _Le(e){if(Array.isArray(e))return e}function OLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pz(n.key),n)}}function RLe(e,t,r){return t&&UN(e.prototype,t),r&&UN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ya(){return typeof Reflect<"u"&&Reflect.get?ya=Reflect.get.bind():ya=function(t,r,n){var o=ELe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ya.apply(this,arguments)}function ELe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=wo(e),e!==null););return e}function TLe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&XO(e,t)}function XO(e,t){return XO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},XO(e,t)}function PLe(e){var t=$Le();return function(){var n=wo(e),o;if(t){var i=wo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return kLe(this,o)}}function kLe(e,t){if(t&&(Pi(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $n(e)}function $n(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $Le(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wo(e){return wo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wo(e)}function Pl(e,t,r){return t=pz(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pz(e){var t=ALe(e,"string");return Pi(t)==="symbol"?t:String(t)}function ALe(e,t){if(Pi(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Pi(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pS(e,t,r){ILe(e,t),t.set(e,r)}function ILe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zo(e,t,r){var n=mz(e,t,"set");return MLe(e,n,r),r}function MLe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function kl(e,t){var r=mz(e,t,"get");return xLe(e,r)}function mz(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function xLe(e,t){return t.get?t.get.call(e):t.value}var nr="formulas",DLe=["maxRows","maxColumns","language"],NLe=260;pe.getSingleton().register("afterNamedExpressionAdded");pe.getSingleton().register("afterNamedExpressionRemoved");pe.getSingleton().register("afterSheetAdded");pe.getSingleton().register("afterSheetRemoved");pe.getSingleton().register("afterSheetRenamed");pe.getSingleton().register("afterFormulasValuesUpdate");var $l=function(t){return t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto"},qn=new WeakMap,mS=new WeakMap,Qf=new WeakMap,HLe=function(e){TLe(r,e);var t=PLe(r);function r(){var n;OLe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),pS($n(n),qn,{writable:!0,value:!1}),pS($n(n),mS,{writable:!0,value:!1}),pS($n(n),Qf,{writable:!0,value:[["valuesUpdated",function(){var l;return(l=n).onEngineValuesUpdated.apply(l,arguments)}],["namedExpressionAdded",function(){var l;return(l=n).onEngineNamedExpressionsAdded.apply(l,arguments)}],["namedExpressionRemoved",function(){var l;return(l=n).onEngineNamedExpressionsRemoved.apply(l,arguments)}],["sheetAdded",function(){var l;return(l=n).onEngineSheetAdded.apply(l,arguments)}],["sheetRenamed",function(){var l;return(l=n).onEngineSheetRenamed.apply(l,arguments)}],["sheetRemoved",function(){var l;return(l=n).onEngineSheetRemoved.apply(l,arguments)}]]}),Pl($n(n),"staticRegister",Jr("formulas")),Pl($n(n),"engine",null),Pl($n(n),"sheetName",null),Pl($n(n),"indexSyncer",null),Pl($n(n),"rowAxisSyncer",null),Pl($n(n),"columnAxisSyncer",null),n}return RLe(r,[{key:"sheetId",get:function(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}},{key:"isEnabled",value:function(){return!!this.hot.getSettings()[nr]}},{key:"enablePlugin",value:function(){var o,i=this;if(!this.enabled){if(this.engine=(o=zHe(this.hot))!==null&&o!==void 0?o:this.engine,!this.engine){ht("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){var a=this.addSheet(this.sheetName,this.hot.getSourceDataArray());a!==!1&&(this.sheetName=a)}this.addHook("beforeLoadData",function(){return i.onBeforeLoadData.apply(i,arguments)}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("beforeUpdateData",function(){return i.onBeforeLoadData.apply(i,arguments)}),this.addHook("afterUpdateData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("modifyData",function(){return i.onModifyData.apply(i,arguments)}),this.addHook("modifySourceData",function(){return i.onModifySourceData.apply(i,arguments)}),this.addHook("beforeValidate",function(){return i.onBeforeValidate.apply(i,arguments)}),this.addHook("afterSetSourceDataAtCell",function(){return i.onAfterSetSourceDataAtCell.apply(i,arguments)}),this.addHook("afterSetDataAtCell",function(){return i.onAfterSetDataAtCell.apply(i,arguments)}),this.addHook("afterSetDataAtRowProp",function(){return i.onAfterSetDataAtCell.apply(i,arguments)}),this.addHook("beforeCreateRow",function(){return i.onBeforeCreateRow.apply(i,arguments)}),this.addHook("beforeCreateCol",function(){return i.onBeforeCreateCol.apply(i,arguments)}),this.addHook("afterCreateRow",function(){return i.onAfterCreateRow.apply(i,arguments)}),this.addHook("afterCreateCol",function(){return i.onAfterCreateCol.apply(i,arguments)}),this.addHook("beforeRemoveRow",function(){return i.onBeforeRemoveRow.apply(i,arguments)}),this.addHook("beforeRemoveCol",function(){return i.onBeforeRemoveCol.apply(i,arguments)}),this.addHook("afterRemoveRow",function(){return i.onAfterRemoveRow.apply(i,arguments)}),this.addHook("afterRemoveCol",function(){return i.onAfterRemoveCol.apply(i,arguments)}),this.indexSyncer=new gLe(this.hot.rowIndexMapper,this.hot.columnIndexMapper,function(l){i.hot.addHookOnce("init",function(){l()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",function(l,s,u,f){i.rowAxisSyncer.storeMovesInformation(l,s,f)}),this.hot.addHook("beforeColumnMove",function(l,s,u,f){i.columnAxisSyncer.storeMovesInformation(l,s,f)}),this.hot.addHook("afterRowMove",function(l,s,u,f,c){i.rowAxisSyncer.calculateAndSyncMoves(f,c)}),this.hot.addHook("afterColumnMove",function(l,s,u,f,c){i.columnAxisSyncer.calculateAndSyncMoves(f,c)}),this.hot.addHook("beforeColumnFreeze",function(l,s){i.columnAxisSyncer.storeMovesInformation([l],i.hot.getSettings().fixedColumnsStart,s)}),this.hot.addHook("afterColumnFreeze",function(l,s){i.columnAxisSyncer.calculateAndSyncMoves(s,s)}),this.hot.addHook("beforeColumnUnfreeze",function(l,s){i.columnAxisSyncer.storeMovesInformation([l],i.hot.getSettings().fixedColumnsStart-1,s)}),this.hot.addHook("afterColumnUnfreeze",function(l,s){i.columnAxisSyncer.calculateAndSyncMoves(s,s)}),this.addHook("afterCellMetaReset",function(){return i.onAfterCellMetaReset.apply(i,arguments)}),this.addHook("beforeUndo",function(){i.indexSyncer.setPerformUndo(!0),i.engine.undo()}),this.addHook("beforeRedo",function(){i.indexSyncer.setPerformRedo(!0),i.engine.redo()}),this.addHook("afterUndo",function(){i.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",function(){i.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){return i.onAfterDetachChild.apply(i,arguments)}),this.addHook("beforeAutofill",function(){return i.onBeforeAutofill.apply(i,arguments)}),kl(this,Qf).forEach(function(l){var s=Tl(l,2),u=s[0],f=s[1];return i.engine.on(u,f)}),ya(wo(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var o=this;kl(this,Qf).forEach(function(i){var a=Tl(i,2),l=a[0],s=a[1];return o.engine.off(l,s)}),HN(this.engine,this.hot),this.engine=null,ya(wo(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(o){var i=VHe(this.hot.getSettings());WHe(this.engine.getConfig(),i)&&this.engine.updateConfig(i);var a=this.hot.getSettings()[nr];if(ve(a)&&ve(a.sheetName)&&a.sheetName!==this.sheetName&&this.switchSheet(a.sheetName),!o.data&&this.sheetName===null){var l=this.hot.getSettings()[nr].sheetName;l&&this.engine.doesSheetExist(l)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(l??void 0,this.hot.getSourceDataArray())}ya(wo(r.prototype),"updatePlugin",this).call(this,o)}},{key:"destroy",value:function(){var o=this;kl(this,Qf).forEach(function(i){var a,l=Tl(i,2),s=l[0],u=l[1];return(a=o.engine)===null||a===void 0?void 0:a.off(s,u)}),Zo(this,Qf,null),HN(this.engine,this.hot),this.engine=null,ya(wo(r.prototype),"destroy",this).call(this)}},{key:"addSheet",value:function(o,i){if(ve(i)&&!UW(i))return ht("The provided data should be an array of arrays."),!1;if(o!=null&&this.engine.doesSheetExist(o))return ht("Sheet with the provided name already exists."),!1;try{var a=this.engine.addSheet(o??void 0);return i&&this.engine.setSheetContent(this.engine.getSheetId(a),i),a}catch(l){return ht(l.message),!1}}},{key:"switchSheet",value:function(o){if(!this.engine.doesSheetExist(o)){gE("The sheet named `".concat(o,"` does not exist, switch aborted."));return}this.sheetName=o;var i=this.engine.getSheetSerialized(this.sheetId);i.length>0&&this.hot.loadData(i,"".concat(ar(nr),".switchSheet"))}},{key:"getCellType",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId,l=this.hot.toPhysicalRow(o),s=this.hot.toPhysicalColumn(i);return l!==null&&s!==null?this.engine.getCellType({sheet:a,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i)}):"EMPTY"}},{key:"isFormulaCellType",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:a,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i)})}},{key:"renderDependentSheets",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,l=new Set;o.forEach(function(s){var u,f=s==null||(u=s.address)===null||u===void 0?void 0:u.sheet;f!==void 0&&(l.has(f)||l.add(f))}),NN(this.engine).forEach(function(s,u){if((a||u!==i.sheetId)&&l.has(u)){var f;s.render(),(f=s.view)===null||f===void 0||f.adjustElementsSize()}})}},{key:"validateDependentCells",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],l=function(f){var c,h=(c=f==null?void 0:f.address)!==null&&c!==void 0?c:{},d=h.row,v=h.col,g=h.sheet;return ve(g)?"".concat(g,":").concat(d,"x").concat(v):""},s=new Set(a.map(function(u){return l(u)}));o.forEach(function(u){var f,c,h=(f=u.address)!==null&&f!==void 0?f:{},d=h.row,v=h.col;if(!(ve(d)===!1||ve(v)===!1||d>=i.hot.countRows()||v>=i.hot.countCols())){var g=u==null||(c=u.address)===null||c===void 0?void 0:c.sheet,m=l(u);if(g!==void 0&&!s.has(m)){var w=NN(i.engine).get(g);if(!w)return;w.validateCell(w.getDataAtCell(d,v),w.getCellMeta(d,v),function(){})}}})}},{key:"syncChangeWithEngine",value:function(o,i,a){var l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(l)){ht("Not possible to set cell data at ".concat(JSON.stringify(l)));return}var s=this.hot.getCellMeta(o,i);return uS(a,s.type)&&(LN(a,s.dateFormat)?a=jN(a,s.dateFormat):QHe(a)===!1&&(a="'".concat(a))),this.engine.setCellContents(l,a)}},{key:"onBeforeValidate",value:function(o,i,a){var l=this.hot.propToCol(a);if(this.isFormulaCellType(i,l)){var s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},u=this.hot.getCellMeta(i,l),f=this.engine.getCellValue(s);return u.type==="date"&&gr(f)&&(f=FN(f,u.dateFormat)),Pi(f)==="object"&&f!==null?f.value:f}return o}},{key:"onBeforeAutofill",value:function(o,i,a){var l=i.getTopStartCorner(),s=l.row,u=l.col,f=i.getBottomEndCorner(),c=f.row,h=f.col,d=a.getTopStartCorner(),v=d.row,g=d.col,m=a.getBottomEndCorner(),w=m.row,S=m.col,C={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(c),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(h),sheet:this.sheetId}},P={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(v),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(g),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(w),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(S),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(P)===!1)return!1;for(var R=this.engine.getFillRangeData(C,P),V=C.start,U=V.row,X=V.col,Y=C.end,q=Y.row,Z=Y.col,ie=q-U+1,Q=Z-X+1,le=0;le<R.length;le+=1)for(var Se=0;Se<R[le].length;Se+=1){var me=R[le][Se],Ce=le%ie,k=Se%Q,y=this.hot.getCellMeta(Ce,k);uS(me,y.type)&&(me.startsWith("'")?R[le][Se]=me.slice(1):this.isFormulaCellType(Ce,k,this.sheetId)===!1&&(R[le][Se]=JHe(me,y.dateFormat)))}return R}},{key:"onBeforeLoadData",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";a.includes(ar(nr))||Zo(this,mS,gt(this.hot.getSettings().data))}},{key:"onAfterCellMetaReset",value:function(){var o=this,i=this.hot.getSourceDataArray(),a=!1;i.forEach(function(l,s){l.forEach(function(u,f){var c=o.hot.getCellMeta(s,f),h=c.dateFormat;uS(u,c.type)&&(a=!0,LN(u,h)?i[s][f]=jN(u,h):o.isFormulaCellType(s,f)===!1&&(i[s][f]="'".concat(u)))})}),a===!0&&(Zo(this,qn,!0),this.engine.setSheetContent(this.sheetId,i),Zo(this,qn,!1))}},{key:"onAfterLoadData",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(!a.includes(ar(nr)))if(this.sheetName=XHe(this.engine,this.hot.getSettings()[nr].sheetName),kl(this,mS))this.switchSheet(this.sheetName);else{var l=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,l)){Zo(this,qn,!0);var s=this.engine.setSheetContent(this.sheetId,l);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(s),Zo(this,qn,!1)}}}},{key:"onModifyData",value:function(o,i,a,l){if(!(l!=="get"||kl(this,qn)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))){var s=this.hot.toVisualRow(o);if(!(s===null||i===null)){var u=this.isFormulaCellType(s,i);if(!u){var f=this.getCellType(s,i);if(f!=="ARRAY"){dz(a.value)&&(a.value=ZHe(a.value));return}}var c={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},h=this.engine.getCellValue(c),d=this.hot.getCellMeta(s,i);d.type==="date"&&gr(h)&&(h=FN(h,d.dateFormat));var v=Pi(h)==="object"&&h!==null?h.value:h;a.value=v}}}},{key:"onModifySourceData",value:function(o,i,a,l){if(!(l!=="get"||kl(this,qn)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))){var s=this.hot.toVisualRow(o),u=this.hot.propToCol(i);if(!(s===null||u===null)){var f=this.isFormulaCellType(s,u);if(!f){var c=this.getCellType(s,u);if(c!=="ARRAY")return}var h=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(!(h.width===0&&h.height===0)){var d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};a.value=this.engine.getCellSerialized(d)}}}}},{key:"onAfterSetDataAtCell",value:function(o,i){var a=this;if(!$l(i)){var l=[],s=[],u=this.engine.batch(function(){o.forEach(function(f){var c=Tl(f,4),h=c[0],d=c[1],v=c[3],g=a.hot.propToCol(d),m=a.hot.toPhysicalRow(h),w=a.hot.toPhysicalColumn(g),S={row:a.rowAxisSyncer.getHfIndexFromVisualIndex(h),col:a.columnAxisSyncer.getHfIndexFromVisualIndex(g),sheet:a.sheetId};m!==null&&w!==null?a.syncChangeWithEngine(h,g,v):l.push([h,g,v]),s.push({address:S})})});l.length&&this.hot.addHookOnce("afterChange",function(){var f=a.engine.batch(function(){l.forEach(function(c){var h=Tl(c,3),d=h[0],v=h[1],g=h[2];a.syncChangeWithEngine(d,v,g)})});a.renderDependentSheets(f,!0)}),this.renderDependentSheets(u),this.validateDependentCells(u,s)}}},{key:"onAfterSetSourceDataAtCell",value:function(o,i){var a=this;if(!$l(i)){var l=[],s=[];o.forEach(function(u){var f=Tl(u,4),c=f[0],h=f[1],d=f[3],v=a.hot.propToCol(h);if(gr(v)){var g={row:a.rowAxisSyncer.getHfIndexFromVisualIndex(c),col:a.columnAxisSyncer.getHfIndexFromVisualIndex(v),sheet:a.sheetId};if(!a.engine.isItPossibleToSetCellContents(g)){ht("Not possible to set source cell data at ".concat(JSON.stringify(g)));return}s.push({address:g}),l.push.apply(l,pLe(a.engine.setCellContents(g,d)))}}),this.renderDependentSheets(l),this.validateDependentCells(l,s)}}},{key:"onBeforeCreateRow",value:function(o,i){var a=this.rowAxisSyncer.getHfIndexFromVisualIndex(o);if(o>=this.hot.countRows()&&(a=o),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[a,i]))return!1}},{key:"onBeforeCreateCol",value:function(o,i){var a=this.columnAxisSyncer.getHfIndexFromVisualIndex(o);if(o>=this.hot.countCols()&&(a=o),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[a,i]))return!1}},{key:"onBeforeRemoveRow",value:function(o,i,a){var l=this,s=this.rowAxisSyncer.setRemovedHfIndexes(a),u=s.every(function(f){return l.engine.isItPossibleToRemoveRows(l.sheetId,[f,1])});return u===!1?!1:void 0}},{key:"onBeforeRemoveCol",value:function(o,i,a){var l=this,s=this.columnAxisSyncer.setRemovedHfIndexes(a),u=s.every(function(f){return l.engine.isItPossibleToRemoveColumns(l.sheetId,[f,1])});return u===!1?!1:void 0}},{key:"onAfterCreateRow",value:function(o,i,a){if(!$l(a)){var l=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(o),i]);this.renderDependentSheets(l)}}},{key:"onAfterCreateCol",value:function(o,i,a){if(!$l(a)){var l=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(o),i]);this.renderDependentSheets(l)}}},{key:"onAfterRemoveRow",value:function(o,i,a,l){var s=this;if(!$l(l)){var u=this.rowAxisSyncer.getRemovedHfIndexes().sort().reverse(),f=this.engine.batch(function(){u.forEach(function(c){s.engine.removeRows(s.sheetId,[c,1])})});this.renderDependentSheets(f)}}},{key:"onAfterRemoveCol",value:function(o,i,a,l){var s=this;if(!$l(l)){var u=this.columnAxisSyncer.getRemovedHfIndexes().sort().reverse(),f=this.engine.batch(function(){u.forEach(function(c){s.engine.removeColumns(s.sheetId,[c,1])})});this.renderDependentSheets(f)}}},{key:"onAfterDetachChild",value:function(o,i,a){var l,s=this;Zo(this,qn,!0);var u=this.hot.getSourceDataArray(a,0,a+(((l=i.__children)===null||l===void 0?void 0:l.length)||0),this.hot.countSourceCols());Zo(this,qn,!1),u.forEach(function(f,c){f.forEach(function(h,d){s.engine.setCellContents({col:d,row:a+c,sheet:s.sheetId},[[h]])})})}},{key:"onEngineValuesUpdated",value:function(o){this.hot.runHooks("afterFormulasValuesUpdate",o)}},{key:"onEngineNamedExpressionsAdded",value:function(o,i){this.hot.runHooks("afterNamedExpressionAdded",o,i)}},{key:"onEngineNamedExpressionsRemoved",value:function(o,i){this.hot.runHooks("afterNamedExpressionRemoved",o,i)}},{key:"onEngineSheetAdded",value:function(o){this.hot.runHooks("afterSheetAdded",o)}},{key:"onEngineSheetRenamed",value:function(o,i){this.hot.runHooks("afterSheetRenamed",o,i)}},{key:"onEngineSheetRemoved",value:function(o,i){this.hot.runHooks("afterSheetRemoved",o,i)}}],[{key:"PLUGIN_KEY",get:function(){return nr}},{key:"PLUGIN_PRIORITY",get:function(){return NLe}},{key:"SETTING_KEYS",get:function(){return[nr].concat(DLe)}}]),r}(ot);function LLe(e,t){return VLe(e)||BLe(e,t)||FLe(e,t)||jLe()}function jLe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function FLe(e,t){if(e){if(typeof e=="string")return zN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return zN(e,t)}}function zN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function BLe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function VLe(e){if(Array.isArray(e))return e}function WLe(e){return{key:"hidden_columns_hide",name:function(){var r=this.getSelectedLast(),n=0;if(Array.isArray(r)){var o=LLe(r,4),i=o[1],a=o[3];i-a!==0&&(n=1)}return this.getTranslatedPhrase(PT,n)},callback:function(){for(var r=this.getSelectedRangeLast(),n=r.from,o=r.to,i=Math.max(Math.min(n.col,o.col),0),a=Math.max(n.col,o.col),l=[],s=i;s<=a;s+=1)l.push(s);e.hideColumns(l);var u=l[l.length-1],f=this.columnIndexMapper.getNearestNotHiddenIndex(u,1,!0);Number.isInteger(f)&&f>=0?this.selectColumns(f):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function $y(e){return GLe(e)||YLe(e)||zLe(e)||ULe()}function ULe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zLe(e,t){if(e){if(typeof e=="string")return ZO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ZO(e,t)}}function YLe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function GLe(e){if(Array.isArray(e))return ZO(e)}function ZO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function KLe(e){var t=[];return{key:"hidden_columns_show",name:function(){var n=t.length>1?1:0;return this.getTranslatedPhrase(kT,n)},callback:function(){var n,o;if(t.length!==0){var i=t[0],a=t[t.length-1];i=(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,a=(o=this.columnIndexMapper.getNearestNotHiddenIndex(a+1,1))!==null&&o!==void 0?o:this.countCols()-1,e.showColumns(t),this.render(),this.view.adjustElementsSize(!0);var l=a-i+1===this.countCols();l||this.selectColumns(i,a)}},disabled:!1,hidden:function(){var n=this,o=Be(e.getHiddenColumns(),function(S){return n.toPhysicalColumn(S)});if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||o.length<1)return!0;t.length=0;var i=this.getSelectedRangeLast(),a=i.getTopStartCorner().col,l=i.getBottomEndCorner().col,s=this.columnIndexMapper,u=s.getRenderableFromVisualIndex(a),f=s.getRenderableFromVisualIndex(l),c=s.getNotTrimmedIndexes(),h=[];if(a!==l){var d=l-a+1,v=f-u+1;if(d>v){var g=c.slice(a,l+1);h.push.apply(h,$y(g.filter(function(S){return o.includes(S)})))}}else if(u===0&&u<a)h.push.apply(h,$y(c.slice(0,a)));else if(u===null)h.push.apply(h,$y(c.slice(0,this.countCols())));else{var m=this.countCols()-1,w=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(m,-1));f===w&&m>l&&h.push.apply(h,$y(c.slice(l+1)))}return $(h,function(S){t.push(n.toVisualColumn(S))}),t.length===0}}}function Hu(e){"@babel/helpers - typeof";return Hu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hu(e)}function qLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ZLe(n.key),n)}}function XLe(e,t,r){return t&&YN(e.prototype,t),r&&YN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ZLe(e){var t=QLe(e,"string");return Hu(t)==="symbol"?t:String(t)}function QLe(e,t){if(Hu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ga(){return typeof Reflect<"u"&&Reflect.get?ga=Reflect.get.bind():ga=function(t,r,n){var o=JLe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ga.apply(this,arguments)}function JLe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=So(e),e!==null););return e}function eje(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&QO(e,t)}function QO(e,t){return QO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},QO(e,t)}function tje(e){var t=nje();return function(){var n=So(e),o;if(t){var i=So(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return rje(this,o)}}function rje(e,t){if(t&&(Hu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return JO(e)}function JO(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nje(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function So(e){return So=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},So(e)}function GN(e,t,r){oje(e,t),t.set(e,r)}function oje(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mr(e,t){var r=bz(e,t,"get");return ije(e,r)}function ije(e,t){return t.get?t.get.call(e):t.value}function Jf(e,t,r){var n=bz(e,t,"set");return aje(e,n,r),r}function bz(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function aje(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}pe.getSingleton().register("beforeHideColumns");pe.getSingleton().register("afterHideColumns");pe.getSingleton().register("beforeUnhideColumns");pe.getSingleton().register("afterUnhideColumns");var bS="hiddenColumns",lje=310,En=new WeakMap,Tn=new WeakMap,sje=function(e){eje(r,e);var t=tje(r);function r(){var n;qLe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),GN(JO(n),En,{writable:!0,value:{}}),GN(JO(n),Tn,{writable:!0,value:null}),n}return XLe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[bS]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[bS];Ve(i)&&(Jf(this,En,i),gt(i.copyPasteEnabled)&&(i.copyPasteEnabled=!0)),Jf(this,Tn,new Dm),Mr(this,Tn).addLocalHook("init",function(){return o.onMapInit()}),this.hot.columnIndexMapper.registerMap(this.pluginName,Mr(this,Tn)),this.addHook("afterContextMenuDefaultOptions",function(){return o.onAfterContextMenuDefaultOptions.apply(o,arguments)}),this.addHook("afterGetCellMeta",function(a,l,s){return o.onAfterGetCellMeta(a,l,s)}),this.addHook("modifyColWidth",function(a,l){return o.onModifyColWidth(a,l)}),this.addHook("afterGetColHeader",function(){return o.onAfterGetColHeader.apply(o,arguments)}),this.addHook("modifyCopyableRange",function(a){return o.onModifyCopyableRange(a)}),ga(So(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ga(So(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Jf(this,En,{}),ga(So(r.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showColumns",value:function(o){var i=this,a=this.getHiddenColumns(),l=this.isValidConfig(o),s=a,u=Mr(this,Tn).getValues().slice(),f=o.length>0;if(l&&f){var c=o.map(function(d){return i.hot.toPhysicalColumn(d)});$(c,function(d){u[d]=!1}),s=Lt(u,function(d,v,g){return v&&d.push(i.hot.toVisualColumn(g)),d},[])}var h=this.hot.runHooks("beforeUnhideColumns",a,s,l&&f);h!==!1&&(l&&f&&Mr(this,Tn).setValues(u),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",a,s,l&&f,l&&s.length<a.length))}},{key:"showColumn",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.showColumns(i)}},{key:"hideColumns",value:function(o){var i=this,a=this.getHiddenColumns(),l=this.isValidConfig(o),s=a;l&&(s=Array.from(new Set(a.concat(o))));var u=this.hot.runHooks("beforeHideColumns",a,s,l);u!==!1&&(l&&this.hot.batchExecution(function(){$(o,function(f){Mr(i,Tn).setValueAtIndex(i.hot.toPhysicalColumn(f),!0)})},!0),this.hot.runHooks("afterHideColumns",a,s,l,l&&s.length>a.length))}},{key:"hideColumn",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.hideColumns(i)}},{key:"getHiddenColumns",value:function(){var o=this;return Be(Mr(this,Tn).getHiddenIndexes(),function(i){return o.hot.toVisualColumn(i)})}},{key:"isHidden",value:function(o){return Mr(this,Tn).getValueAtIndex(this.hot.toPhysicalColumn(o))||!1}},{key:"isValidConfig",value:function(o){var i=this.hot.countCols();return Array.isArray(o)&&o.length>0?o.every(function(a){return Number.isInteger(a)&&a>=0&&a<i}):!1}},{key:"resetCellsMeta",value:function(){$(this.hot.getCellsMeta(),function(o){o&&(o.skipColumnOnPaste=!1)})}},{key:"onModifyColWidth",value:function(o,i){if(this.isHidden(i))return 0;if(Mr(this,En).indicators&&(this.isHidden(i+1)||this.isHidden(i-1))&&typeof o=="number"&&this.hot.hasColHeaders())return o+15}},{key:"onAfterGetCellMeta",value:function(o,i,a){if(Mr(this,En).copyPasteEnabled===!1&&this.isHidden(i)&&(a.skipColumnOnPaste=!0),this.isHidden(i-1))a.className=a.className||"",a.className.indexOf("afterHiddenColumn")===-1&&(a.className+=" afterHiddenColumn");else if(a.className){var l=a.className.split(" ");if(l.length>0){var s=l.indexOf("afterHiddenColumn");s>-1&&l.splice(s,1),a.className=l.join(" ")}}}},{key:"onModifyCopyableRange",value:function(o){var i=this;if(Mr(this,En).copyPasteEnabled)return o;var a=[],l=function(u,f,c,h){a.push({startRow:u,endRow:f,startCol:c,endCol:h})};return $(o,function(s){var u=!0,f=0;_e(s.startCol,s.endCol,function(c){i.isHidden(c)?(u||l(s.startRow,s.endRow,f,c-1),u=!0):(u&&(f=c),c===s.endCol&&l(s.startRow,s.endRow,f,c),u=!1)})}),a}},{key:"onAfterGetColHeader",value:function(o,i){if(!(!Mr(this,En).indicators||o<0)){var a=[];o>=1&&this.isHidden(o-1)&&a.push("afterHiddenColumn"),o<this.hot.countCols()-1&&this.isHidden(o+1)&&a.push("beforeHiddenColumn"),re(i,a)}}},{key:"onAfterContextMenuDefaultOptions",value:function(o){o.items.push({name:Ye},WLe(this),KLe(this))}},{key:"onMapInit",value:function(){Array.isArray(Mr(this,En).columns)&&this.hideColumns(Mr(this,En).columns)}},{key:"destroy",value:function(){Jf(this,En,null),Jf(this,Tn,null),ga(So(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return bS}},{key:"PLUGIN_PRIORITY",get:function(){return lje}}]),r}(ot);function uje(e,t){return dje(e)||hje(e,t)||cje(e,t)||fje()}function fje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cje(e,t){if(e){if(typeof e=="string")return KN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return KN(e,t)}}function KN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function hje(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function dje(e){if(Array.isArray(e))return e}function vje(e){return{key:"hidden_rows_hide",name:function(){var r=this.getSelectedLast(),n=0;if(Array.isArray(r)){var o=uje(r,3),i=o[0],a=o[2];i-a!==0&&(n=1)}return this.getTranslatedPhrase($T,n)},callback:function(){for(var r=this.getSelectedRangeLast(),n=r.from,o=r.to,i=Math.max(Math.min(n.row,o.row),0),a=Math.max(n.row,o.row),l=[],s=i;s<=a;s+=1)l.push(s);e.hideRows(l);var u=l[l.length-1],f=this.rowIndexMapper.getNearestNotHiddenIndex(u,1,!0);Number.isInteger(f)&&f>=0?this.selectRows(f):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function Ay(e){return mje(e)||pje(e)||gje(e)||yje()}function yje(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gje(e,t){if(e){if(typeof e=="string")return eR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return eR(e,t)}}function pje(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function mje(e){if(Array.isArray(e))return eR(e)}function eR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function bje(e){var t=[];return{key:"hidden_rows_show",name:function(){var n=t.length>1?1:0;return this.getTranslatedPhrase(AT,n)},callback:function(){var n,o;if(t.length!==0){var i=t[0],a=t[t.length-1];i=(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,a=(o=this.rowIndexMapper.getNearestNotHiddenIndex(a+1,1))!==null&&o!==void 0?o:this.countRows()-1,e.showRows(t),this.render(),this.view.adjustElementsSize(!0);var l=a-i+1===this.countRows();l||this.selectRows(i,a)}},disabled:!1,hidden:function(){var n=this,o=Be(e.getHiddenRows(),function(S){return n.toPhysicalRow(S)});if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||o.length<1)return!0;t.length=0;var i=this.getSelectedRangeLast(),a=i.getTopStartCorner().row,l=i.getBottomEndCorner().row,s=this.rowIndexMapper,u=s.getRenderableFromVisualIndex(a),f=s.getRenderableFromVisualIndex(l),c=s.getNotTrimmedIndexes(),h=[];if(a!==l){var d=l-a+1,v=f-u+1;if(d>v){var g=c.slice(a,l+1);h.push.apply(h,Ay(g.filter(function(S){return o.includes(S)})))}}else if(u===0&&u<a)h.push.apply(h,Ay(c.slice(0,a)));else if(u===null)h.push.apply(h,Ay(c.slice(0,this.countRows())));else{var m=this.countRows()-1,w=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(m,-1));f===w&&m>l&&h.push.apply(h,Ay(c.slice(l+1)))}return $(h,function(S){t.push(n.toVisualRow(S))}),t.length===0}}}function Lu(e){"@babel/helpers - typeof";return Lu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lu(e)}function wje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Cje(n.key),n)}}function Sje(e,t,r){return t&&qN(e.prototype,t),r&&qN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Cje(e){var t=_je(e,"string");return Lu(t)==="symbol"?t:String(t)}function _je(e,t){if(Lu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Lu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pa(){return typeof Reflect<"u"&&Reflect.get?pa=Reflect.get.bind():pa=function(t,r,n){var o=Oje(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},pa.apply(this,arguments)}function Oje(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Co(e),e!==null););return e}function Rje(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tR(e,t)}function tR(e,t){return tR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},tR(e,t)}function Eje(e){var t=Pje();return function(){var n=Co(e),o;if(t){var i=Co(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Tje(this,o)}}function Tje(e,t){if(t&&(Lu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rR(e)}function rR(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Pje(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Co(e){return Co=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Co(e)}function XN(e,t,r){kje(e,t),t.set(e,r)}function kje(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zr(e,t){var r=wz(e,t,"get");return $je(e,r)}function $je(e,t){return t.get?t.get.call(e):t.value}function ec(e,t,r){var n=wz(e,t,"set");return Aje(e,n,r),r}function wz(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Aje(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}pe.getSingleton().register("beforeHideRows");pe.getSingleton().register("afterHideRows");pe.getSingleton().register("beforeUnhideRows");pe.getSingleton().register("afterUnhideRows");var wS="hiddenRows",Ije=320,Xn=new WeakMap,Pn=new WeakMap,Mje=function(e){Rje(r,e);var t=Eje(r);function r(){var n;wje(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),XN(rR(n),Xn,{writable:!0,value:{}}),XN(rR(n),Pn,{writable:!0,value:null}),n}return Sje(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[wS]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[wS];Ve(i)&&(ec(this,Xn,i),gt(i.copyPasteEnabled)&&(i.copyPasteEnabled=!0)),ec(this,Pn,new Dm),zr(this,Pn).addLocalHook("init",function(){return o.onMapInit()}),this.hot.rowIndexMapper.registerMap(this.pluginName,zr(this,Pn)),this.addHook("afterContextMenuDefaultOptions",function(){return o.onAfterContextMenuDefaultOptions.apply(o,arguments)}),this.addHook("afterGetCellMeta",function(a,l,s){return o.onAfterGetCellMeta(a,l,s)}),this.addHook("modifyRowHeight",function(a,l){return o.onModifyRowHeight(a,l)}),this.addHook("afterGetRowHeader",function(){return o.onAfterGetRowHeader.apply(o,arguments)}),this.addHook("modifyCopyableRange",function(a){return o.onModifyCopyableRange(a)}),pa(Co(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),pa(Co(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),ec(this,Xn,{}),pa(Co(r.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showRows",value:function(o){var i=this,a=this.getHiddenRows(),l=this.isValidConfig(o),s=a,u=zr(this,Pn).getValues().slice(),f=o.length>0;if(l&&f){var c=o.map(function(d){return i.hot.toPhysicalRow(d)});$(c,function(d){u[d]=!1}),s=Lt(u,function(d,v,g){return v&&d.push(i.hot.toVisualRow(g)),d},[])}var h=this.hot.runHooks("beforeUnhideRows",a,s,l&&f);h!==!1&&(l&&f&&zr(this,Pn).setValues(u),this.hot.runHooks("afterUnhideRows",a,s,l&&f,l&&s.length<a.length))}},{key:"showRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.showRows(i)}},{key:"hideRows",value:function(o){var i=this,a=this.getHiddenRows(),l=this.isValidConfig(o),s=a;l&&(s=Array.from(new Set(a.concat(o))));var u=this.hot.runHooks("beforeHideRows",a,s,l);u!==!1&&(l&&this.hot.batchExecution(function(){$(o,function(f){zr(i,Pn).setValueAtIndex(i.hot.toPhysicalRow(f),!0)})},!0),this.hot.runHooks("afterHideRows",a,s,l,l&&s.length>a.length))}},{key:"hideRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.hideRows(i)}},{key:"getHiddenRows",value:function(){var o=this;return Be(zr(this,Pn).getHiddenIndexes(),function(i){return o.hot.toVisualRow(i)})}},{key:"isHidden",value:function(o){return zr(this,Pn).getValueAtIndex(this.hot.toPhysicalRow(o))||!1}},{key:"isValidConfig",value:function(o){var i=this.hot.countRows();return Array.isArray(o)&&o.length>0?o.every(function(a){return Number.isInteger(a)&&a>=0&&a<i}):!1}},{key:"resetCellsMeta",value:function(){$(this.hot.getCellsMeta(),function(o){o&&(o.skipRowOnPaste=!1)})}},{key:"onModifyRowHeight",value:function(o,i){return this.isHidden(i)?0:o}},{key:"onAfterGetCellMeta",value:function(o,i,a){if(zr(this,Xn).copyPasteEnabled===!1&&this.isHidden(o)&&(a.skipRowOnPaste=!0),this.isHidden(o-1))a.className=a.className||"",a.className.indexOf("afterHiddenRow")===-1&&(a.className+=" afterHiddenRow");else if(a.className){var l=a.className.split(" ");if(l.length>0){var s=l.indexOf("afterHiddenRow");s>-1&&l.splice(s,1),a.className=l.join(" ")}}}},{key:"onModifyCopyableRange",value:function(o){var i=this;if(zr(this,Xn).copyPasteEnabled)return o;var a=[],l=function(u,f,c,h){a.push({startRow:u,endRow:f,startCol:c,endCol:h})};return $(o,function(s){var u=!0,f=0;_e(s.startRow,s.endRow,function(c){i.isHidden(c)?(u||l(f,c-1,s.startCol,s.endCol),u=!0):(u&&(f=c),c===s.endRow&&l(f,c,s.startCol,s.endCol),u=!1)})}),a}},{key:"onAfterGetRowHeader",value:function(o,i){if(!(!zr(this,Xn).indicators||o<0)){var a=[];o>=1&&this.isHidden(o-1)&&a.push("afterHiddenRow"),o<this.hot.countRows()-1&&this.isHidden(o+1)&&a.push("beforeHiddenRow"),re(i,a)}}},{key:"onAfterContextMenuDefaultOptions",value:function(o){o.items.push({name:Ye},vje(this),bje(this))}},{key:"onMapInit",value:function(){Array.isArray(zr(this,Xn).rows)&&this.hideRows(zr(this,Xn).rows)}},{key:"destroy",value:function(){ec(this,Xn,null),ec(this,Pn,null),pa(Co(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return wS}},{key:"PLUGIN_PRIORITY",get:function(){return Ije}}]),r}(ot);function xje(e,t){return Lje(e)||Hje(e,t)||Nje(e,t)||Dje()}function Dje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Nje(e,t){if(e){if(typeof e=="string")return ZN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ZN(e,t)}}function ZN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Hje(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Lje(e){if(Array.isArray(e))return e}function jje(e){return{key:"freeze_column",name:function(){return this.getTranslatedPhrase(oT)},callback:function(r,n){var o=xje(n,1),i=o[0].start.col;e.freezeColumn(i),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var r=this.getSelectedRange(),n=!1;return(r===void 0||r.length>1||r[0].from.col!==r[0].to.col||r[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function Fje(e,t){return Uje(e)||Wje(e,t)||Vje(e,t)||Bje()}function Bje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Vje(e,t){if(e){if(typeof e=="string")return QN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return QN(e,t)}}function QN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Wje(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Uje(e){if(Array.isArray(e))return e}function zje(e){return{key:"unfreeze_column",name:function(){return this.getTranslatedPhrase(iT)},callback:function(r,n){var o=Fje(n,1),i=o[0].start.col;e.unfreezeColumn(i),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var r=this.getSelectedRange(),n=!1;return(r===void 0||r.length>1||r[0].from.col!==r[0].to.col||r[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function ju(e){"@babel/helpers - typeof";return ju=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ju(e)}function Yje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Kje(n.key),n)}}function Gje(e,t,r){return t&&JN(e.prototype,t),r&&JN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Kje(e){var t=qje(e,"string");return ju(t)==="symbol"?t:String(t)}function qje(e,t){if(ju(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ju(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ts(){return typeof Reflect<"u"&&Reflect.get?ts=Reflect.get.bind():ts=function(t,r,n){var o=Xje(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ts.apply(this,arguments)}function Xje(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Si(e),e!==null););return e}function Zje(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nR(e,t)}function nR(e,t){return nR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},nR(e,t)}function Qje(e){var t=eFe();return function(){var n=Si(e),o;if(t){var i=Si(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Jje(this,o)}}function Jje(e,t){if(t&&(ju(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Sz(e)}function Sz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eFe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Si(e){return Si=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Si(e)}pe.getSingleton().register("beforeColumnFreeze");pe.getSingleton().register("afterColumnFreeze");pe.getSingleton().register("beforeColumnUnfreeze");pe.getSingleton().register("afterColumnUnfreeze");var eH="manualColumnFreeze",tFe=110,tc=new WeakMap,rFe=function(e){Zje(r,e);var t=Qje(r);function r(n){var o;return Yje(this,r),o=t.call(this,n),tc.set(Sz(o),{afterFirstUse:!1}),o}return Gje(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[eH]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(i){return o.addContextMenuEntry(i)}),this.addHook("beforeColumnMove",function(i,a){return o.onBeforeColumnMove(i,a)}),ts(Si(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var o=tc.get(this);o.afterFirstUse=!1,ts(Si(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ts(Si(r.prototype),"updatePlugin",this).call(this)}},{key:"freezeColumn",value:function(o){var i=tc.get(this),a=this.hot.getSettings(),l=a.fixedColumnsStart<this.hot.countCols()&&o>a.fixedColumnsStart-1;i.afterFirstUse||(i.afterFirstUse=!0);var s=this.hot.runHooks("beforeColumnFreeze",o,l);s!==!1&&(l&&(this.hot.columnIndexMapper.moveIndexes(o,a.fixedColumnsStart),a._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",o,l))}},{key:"unfreezeColumn",value:function(o){var i=tc.get(this),a=this.hot.getSettings(),l=a.fixedColumnsStart>0&&o<=a.fixedColumnsStart-1;i.afterFirstUse||(i.afterFirstUse=!0);var s=this.hot.runHooks("beforeColumnUnfreeze",o,l);s!==!1&&(l&&(a._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(o,a.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",o,l))}},{key:"addContextMenuEntry",value:function(o){o.items.push({name:"---------"},jje(this),zje(this))}},{key:"onBeforeColumnMove",value:function(o,i){var a=tc.get(this);if(a.afterFirstUse){var l=this.hot.getSettings().fixedColumnsStart;if(i<l||o.some(function(s){return s<l}))return!1}}}],[{key:"PLUGIN_KEY",get:function(){return eH}},{key:"PLUGIN_PRIORITY",get:function(){return tFe}}]),r}(ot);function Cd(e){"@babel/helpers - typeof";return Cd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cd(e)}function nFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,iFe(n.key),n)}}function oFe(e,t,r){return t&&tH(e.prototype,t),r&&tH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function iFe(e){var t=aFe(e,"string");return Cd(t)==="symbol"?t:String(t)}function aFe(e,t){if(Cd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var SS=0,rH=1,nH=2,Al="px",lFe=function(){function e(t){nFe(this,e),this.hot=t,this._element=null,this.state=SS,this.inlineProperty=t.isRtl()?"right":"left"}return oFe(e,[{key:"appendTo",value:function(r){r.appendChild(this._element),this.state=nH}},{key:"build",value:function(){this.state===SS&&(this._element=this.hot.rootDocument.createElement("div"),this.state=rH)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=SS}},{key:"isAppended",value:function(){return this.state===nH}},{key:"isBuilt",value:function(){return this.state>=rH}},{key:"setPosition",value:function(r,n){gr(r)&&(this._element.style.top=r+Al),gr(n)&&(this._element.style[this.inlineProperty]=n+Al)}},{key:"getPosition",value:function(){var r=this._element.style;return{top:r.top?parseInt(r.top,10):0,start:r[this.inlineProperty]?parseInt(r[this.inlineProperty],10):0}}},{key:"setSize",value:function(r,n){gr(r)&&(this._element.style.width=r+Al),gr(n)&&(this._element.style.height=n+Al)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(r,n){gr(r)&&(this._element.style.marginTop=r+Al),gr(n)&&(this._element.style["margin".concat(ar(this.inlineProperty))]=n+Al)}},{key:"getOffset",value:function(){var r=this._element.style,n="margin".concat(ar(this.inlineProperty));return{top:r.marginTop?parseInt(r.marginTop,10):0,start:r[n]?parseInt(r[n],10):0}}}]),e}();const Cz=lFe;function Fu(e){"@babel/helpers - typeof";return Fu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fu(e)}function sFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fFe(n.key),n)}}function uFe(e,t,r){return t&&oH(e.prototype,t),r&&oH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fFe(e){var t=cFe(e,"string");return Fu(t)==="symbol"?t:String(t)}function cFe(e,t){if(Fu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Cg(){return typeof Reflect<"u"&&Reflect.get?Cg=Reflect.get.bind():Cg=function(t,r,n){var o=hFe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Cg.apply(this,arguments)}function hFe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Bu(e),e!==null););return e}function dFe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oR(e,t)}function oR(e,t){return oR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},oR(e,t)}function vFe(e){var t=pFe();return function(){var n=Bu(e),o;if(t){var i=Bu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return yFe(this,o)}}function yFe(e,t){if(t&&(Fu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gFe(e)}function gFe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pFe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Bu(e){return Bu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Bu(e)}var mFe="ht__manualColumnMove--backlight",bFe=function(e){dFe(r,e);var t=vFe(r);function r(){return sFe(this,r),t.apply(this,arguments)}return uFe(r,[{key:"build",value:function(){Cg(Bu(r.prototype),"build",this).call(this),re(this._element,mFe)}}]),r}(Cz);const wFe=bFe;function Vu(e){"@babel/helpers - typeof";return Vu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vu(e)}function SFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_Fe(n.key),n)}}function CFe(e,t,r){return t&&iH(e.prototype,t),r&&iH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _Fe(e){var t=OFe(e,"string");return Vu(t)==="symbol"?t:String(t)}function OFe(e,t){if(Vu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _g(){return typeof Reflect<"u"&&Reflect.get?_g=Reflect.get.bind():_g=function(t,r,n){var o=RFe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_g.apply(this,arguments)}function RFe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Wu(e),e!==null););return e}function EFe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&iR(e,t)}function iR(e,t){return iR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},iR(e,t)}function TFe(e){var t=$Fe();return function(){var n=Wu(e),o;if(t){var i=Wu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return PFe(this,o)}}function PFe(e,t){if(t&&(Vu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kFe(e)}function kFe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $Fe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Wu(e){return Wu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Wu(e)}var AFe="ht__manualColumnMove--guideline",IFe=function(e){EFe(r,e);var t=TFe(r);function r(){return SFe(this,r),t.apply(this,arguments)}return CFe(r,[{key:"build",value:function(){_g(Wu(r.prototype),"build",this).call(this),re(this._element,AFe)}}]),r}(Cz);const MFe=IFe;function Uu(e){"@babel/helpers - typeof";return Uu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uu(e)}function xFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,NFe(n.key),n)}}function DFe(e,t,r){return t&&aH(e.prototype,t),r&&aH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function NFe(e){var t=HFe(e,"string");return Uu(t)==="symbol"?t:String(t)}function HFe(e,t){if(Uu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Uu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ma(){return typeof Reflect<"u"&&Reflect.get?ma=Reflect.get.bind():ma=function(t,r,n){var o=LFe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ma.apply(this,arguments)}function LFe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_o(e),e!==null););return e}function jFe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aR(e,t)}function aR(e,t){return aR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},aR(e,t)}function FFe(e){var t=VFe();return function(){var n=_o(e),o;if(t){var i=_o(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return BFe(this,o)}}function BFe(e,t){if(t&&(Uu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lR(e)}function lR(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function VFe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _o(e){return _o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_o(e)}pe.getSingleton().register("beforeColumnMove");pe.getSingleton().register("afterColumnMove");var CS="manualColumnMove",WFe=120,Qo=new WeakMap,lH="ht__manualColumnMove",Iy="show-ui",_S="on-moving--columns",OS="after-selection--columns",UFe=function(e){jFe(r,e);var t=FFe(r);function r(n){var o;return xFe(this,r),o=t.call(this,n),Qo.set(lR(o),{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0},cachedDropIndex:void 0}),o.eventManager=new Tt(lR(o)),o.backlight=new wFe(n),o.guideline=new MFe(n),o}return DFe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[CS]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return o.onBeforeOnCellMouseOver.apply(o,arguments)}),this.addHook("afterScrollVertically",function(){return o.onAfterScrollVertically()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.buildPluginUI(),this.registerEvents(),re(this.hot.rootElement,lH),ma(_o(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),ma(_o(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Le(this.hot.rootElement,lH),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),ma(_o(r.prototype),"disablePlugin",this).call(this)}},{key:"moveColumn",value:function(o,i){return this.moveColumns([o],i)}},{key:"moveColumns",value:function(o,i){var a=Qo.get(this),l=a.cachedDropIndex,s=this.isMovePossible(o,i),u=this.hot.runHooks("beforeColumnMove",o,i,l,s);if(a.cachedDropIndex=void 0,u!==!1){s&&this.hot.columnIndexMapper.moveIndexes(o,i);var f=s&&this.isColumnOrderChanged(o,i);return this.hot.runHooks("afterColumnMove",o,i,l,s,f),f}}},{key:"dragColumn",value:function(o,i){return this.dragColumns([o],i)}},{key:"dragColumns",value:function(o,i){var a=this.countFinalIndex(o,i),l=Qo.get(this);return l.cachedDropIndex=i,this.moveColumns(o,a)}},{key:"isMovePossible",value:function(o,i){var a=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),l=o.length+i>a,s=i<0,u=o.some(function(c){return c<0}),f=o.some(function(c){return c>=a});return!(l||s||u||f)}},{key:"isColumnOrderChanged",value:function(o,i){return o.some(function(a,l){return a-l!==i})}},{key:"countFinalIndex",value:function(o,i){var a=Lt(o,function(l,s){return s<i&&(l+=1),l},0);return i-a}},{key:"getColumnsWidth",value:function(o,i){for(var a=this.hot.columnIndexMapper,l=0,s=o;s<=i;s+=1){var u=a.getRenderableFromVisualIndex(s);s<0?l+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:u!==null&&(l+=this.hot.view._wt.wtTable.getStretchedColumnWidth(u)||0)}return l}},{key:"moveBySettingsOrLoad",value:function(){var o=this.hot.getSettings()[CS];if(Array.isArray(o))this.moveColumns(o,0);else if(o!==void 0){var i=this.persistentStateLoad();i.length&&this.moveColumns(i,0)}}},{key:"isFixedColumnsStart",value:function(o){return o<this.hot.getSettings().fixedColumnsStart}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var o={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",o),o.value?o.value:[]}},{key:"prepareColumnsToMoving",value:function(o,i){var a=[];return _e(o,i,function(l){a.push(l)}),a}},{key:"refreshPositions",value:function(){var o=Qo.get(this),i=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(o.hoveredColumn)&&i>0&&this.hot.scrollViewportTo(void 0,this.hot.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1));var a=this.hot.view._wt.wtTable,l=this.hot.view._wt.wtOverlays.scrollableElement,s=typeof l.scrollX=="number"?l.scrollX:l.scrollLeft,u=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,o.hoveredColumn-1),f=a.hider.offsetWidth,c=a.TBODY.offsetLeft,h=this.backlight.getOffset().start,d=this.backlight.getSize().width,v=0,g=0;if(this.hot.isRtl()){var m=this.hot.rootWindow,w=dt(this.hot.rootElement),S=m.innerWidth-o.rootElementOffset-w;g=m.innerWidth-o.target.eventPageX-S-(l.scrollX===void 0?s:0)}else g=o.target.eventPageX-(o.rootElementOffset-(l.scrollX===void 0?s:0));if(o.hasRowHeaders&&(v=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(o.hoveredColumn)&&(u+=s),u+=v,o.hoveredColumn<0)o.fixedColumnsStart>0?o.target.col=0:o.target.col=i>0?i-1:i;else if(o.target.TD.offsetWidth/2+u<=g){var C=o.hoveredColumn>=o.countCols?o.countCols-1:o.hoveredColumn;o.target.col=C+1,u+=o.target.TD.offsetWidth}else o.target.col=o.hoveredColumn;var P=g,R=u;g+d+h>=f?P=f-d-h:g+h<c+v&&(P=c+v+Math.abs(h)),u>=f-1?R=f-1:R===0?R=1:l.scrollX!==void 0&&o.hoveredColumn<o.fixedColumnsStart&&(R-=o.rootElementOffset<=l.scrollX?o.rootElementOffset:0),this.backlight.setPosition(null,P),this.guideline.setPosition(null,R)}},{key:"registerEvents",value:function(){var o=this,i=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(i,"mousemove",function(a){return o.onMouseMove(a)}),this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,l){var s=this.hot.view._wt.wtTable,u=this.hot.selection.isSelectedByColumnHeader(),f=this.hot.getSelectedRangeLast(),c=Qo.get(this),h=xe(o.target,"sortAction");if(!f||!u||c.pressed||o.button!==0||h){c.pressed=!1,c.columnsToMove.length=0,Le(this.hot.rootElement,[_S,Iy]);return}var d=this.guideline.isBuilt()&&!this.guideline.isAppended(),v=this.backlight.isBuilt()&&!this.backlight.isAppended();d&&v&&(this.guideline.appendTo(s.hider),this.backlight.appendTo(s.hider));var g=f.from,m=f.to,w=Math.min(g.col,m.col),S=Math.max(g.col,m.col);if(i.row<0&&i.col>=w&&i.col<=S){l.column=!0,c.pressed=!0,c.target.eventPageX=o.pageX,c.target.eventOffsetX=o.offsetX,c.hoveredColumn=i.col,c.target.TD=a,c.target.col=i.col,c.columnsToMove=this.prepareColumnsToMoving(w,S),c.hasRowHeaders=!!this.hot.getSettings().rowHeaders,c.countCols=this.hot.countCols(),c.fixedColumnsStart=this.hot.getSettings().fixedColumnsStart,c.rootElementOffset=Vt(this.hot.rootElement).left;var C=c.hasRowHeaders?-1:0,P=s.holder.scrollTop+s.getColumnHeaderHeight(0)+1,R=i.col<c.fixedColumnsStart,V=Math.abs(this.hot.view._wt.wtOverlays.inlineStartOverlay.getScrollPosition()),U=Math.abs(o.offsetX-(this.hot.isRtl()?o.target.offsetWidth:0)),X=this.getColumnsWidth(w,i.col-1)+U,Y=this.getColumnsWidth(C,w-1)+(R?V:0)+X;this.backlight.setPosition(P,Y),this.backlight.setSize(this.getColumnsWidth(w,S),s.hider.offsetHeight-P),this.backlight.setOffset(null,-X),re(this.hot.rootElement,_S)}else Le(this.hot.rootElement,OS),c.pressed=!1,c.columnsToMove.length=0}},{key:"onMouseMove",value:function(o){var i=Qo.get(this);if(i.pressed){if(o.target===this.backlight.element){var a=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout(function(){this.backlight.setPosition(a)})}i.target.eventPageX=o.pageX,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(o,i,a,l){var s=this.hot.getSelectedRangeLast(),u=Qo.get(this);!s||!u.pressed||(u.columnsToMove.indexOf(i.col)>-1?Le(this.hot.rootElement,Iy):re(this.hot.rootElement,Iy),l.row=!0,l.column=!0,l.cell=!0,u.hoveredColumn=i.col,u.target.TD=a)}},{key:"onMouseUp",value:function(){var o=Qo.get(this),i=o.target.col,a=o.columnsToMove.length;if(o.hoveredColumn=void 0,o.pressed=!1,o.backlightWidth=0,Le(this.hot.rootElement,[_S,Iy,OS]),this.hot.selection.isSelectedByColumnHeader()&&re(this.hot.rootElement,OS),!(a<1||i===void 0)){var l=o.columnsToMove[0],s=this.hot.toPhysicalColumn(l),u=this.dragColumns(o.columnsToMove,i);if(o.columnsToMove.length=0,u===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var f=this.hot.toVisualColumn(s),c=f+a-1;this.hot.selectColumns(f,c)}}}},{key:"onAfterScrollVertically",value:function(){var o=this.hot.view._wt.wtTable,i=o.getColumnHeaderHeight(0)+1,a=o.holder.scrollTop,l=i+a;this.backlight.setPosition(l),this.backlight.setSize(null,o.hider.offsetHeight-l)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),ma(_o(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return CS}},{key:"PLUGIN_PRIORITY",get:function(){return WFe}}]),r}(ot);function zu(e){"@babel/helpers - typeof";return zu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zu(e)}function zFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,GFe(n.key),n)}}function YFe(e,t,r){return t&&sH(e.prototype,t),r&&sH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function GFe(e){var t=KFe(e,"string");return zu(t)==="symbol"?t:String(t)}function KFe(e,t){if(zu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ba(){return typeof Reflect<"u"&&Reflect.get?ba=Reflect.get.bind():ba=function(t,r,n){var o=qFe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ba.apply(this,arguments)}function qFe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Oo(e),e!==null););return e}function XFe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sR(e,t)}function sR(e,t){return sR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},sR(e,t)}function ZFe(e){var t=JFe();return function(){var n=Oo(e),o;if(t){var i=Oo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return QFe(this,o)}}function QFe(e,t){if(t&&(zu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return uR(e)}function uR(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function JFe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Oo(e){return Oo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Oo(e)}var My="manualColumnResize",eBe=130,uH="manualColumnWidths",RS=new WeakMap,tBe=function(e){XFe(r,e);var t=ZFe(r);function r(n){var o;zFe(this,r),o=t.call(this,n);var i=o.hot.rootDocument;return o.currentTH=null,o.currentCol=null,o.selectedCols=[],o.currentWidth=null,o.newSize=null,o.startY=null,o.startWidth=null,o.startOffset=null,o.handle=i.createElement("DIV"),o.guide=i.createElement("DIV"),o.eventManager=new Tt(uR(o)),o.pressed=null,o.dblclick=0,o.autoresizeTimeout=null,o.columnWidthsMap=void 0,RS.set(uR(o),{config:void 0}),re(o.handle,"manualColumnResizer"),re(o.guide,"manualColumnResizerGuide"),o}return YFe(r,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[My]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.columnWidthsMap=new Ai,this.columnWidthsMap.addLocalHook("init",function(){return o.onMapInit()}),this.hot.columnIndexMapper.registerMap(this.pluginName,this.columnWidthsMap),this.addHook("modifyColWidth",function(i,a){return o.onModifyColWidth(i,a)}),this.addHook("beforeStretchingColumnWidth",function(i,a){return o.onBeforeStretchingColumnWidth(i,a)}),this.addHook("beforeColumnResize",function(i,a,l){return o.onBeforeColumnResize(i,a,l)}),this.bindEvents(),ba(Oo(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ba(Oo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var o=RS.get(this);o.config=this.columnWidthsMap.getValues(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),ba(Oo(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualColumnWidths",value:function(){this.hot.runHooks("persistentStateSave",uH,this.columnWidthsMap.getValues())}},{key:"loadManualColumnWidths",value:function(){var o={};return this.hot.runHooks("persistentStateLoad",uH,o),o.value}},{key:"setManualSize",value:function(o,i){var a=Math.max(i,20),l=this.hot.toPhysicalColumn(o);return this.columnWidthsMap.setValueAtIndex(l,a),a}},{key:"clearManualSize",value:function(o){var i=this.hot.toPhysicalColumn(o);this.columnWidthsMap.setValueAtIndex(i,null)}},{key:"onMapInit",value:function(){var o=this,i=RS.get(this),a=this.hot.getSettings()[My],l=this.loadManualColumnWidths();typeof l<"u"?this.hot.batchExecution(function(){l.forEach(function(s,u){o.columnWidthsMap.setValueAtIndex(u,s)})},!0):Array.isArray(a)?(this.hot.batchExecution(function(){a.forEach(function(s,u){o.columnWidthsMap.setValueAtIndex(u,s)})},!0),i.config=a):a===!0&&Array.isArray(i.config)&&this.hot.batchExecution(function(){i.config.forEach(function(s,u){o.columnWidthsMap.setValueAtIndex(u,s)})},!0)}},{key:"setupHandlePosition",value:function(o){var i=this;if(o.parentNode){this.currentTH=o;var a=this.hot.view._wt,l=a.wtTable.getCoords(this.currentTH),s=l.col;if(!(s<0)){var u=Rt(this.currentTH),f=this.currentTH.getBoundingClientRect(),c=s<a.getSetting("fixedColumnsStart"),h;c&&(h=a.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col)),h||(h=a.wtOverlays.topOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col)),this.currentCol=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s),this.selectedCols=[];var d=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&d){var v=this.hot.getSelectedRange();$(v,function(g){var m=g.getTopStartCorner().col,w=g.getBottomEndCorner().col;_e(m,w,function(S){i.selectedCols.includes(S)||i.selectedCols.push(S)})})}this.selectedCols.includes(this.currentCol)||(this.selectedCols=[this.currentCol]),this.startOffset=h.start-6,this.startWidth=parseInt(f.width,10),this.handle.style.top="".concat(h.top,"px"),this.handle.style[this.inlineDir]="".concat(this.startOffset+this.startWidth,"px"),this.handle.style.height="".concat(u,"px"),this.hot.rootElement.appendChild(this.handle)}}}},{key:"refreshHandlePosition",value:function(){this.handle.style[this.inlineDir]="".concat(this.startOffset+this.currentWidth,"px")}},{key:"setupGuidePosition",value:function(){var o=parseInt(Rt(this.handle),10),i=parseInt(this.handle.style.top,10)+o,a=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);re(this.handle,"active"),re(this.guide,"active"),this.guide.style.top="".concat(i,"px"),this.refreshGuidePosition(),this.guide.style.height="".concat(a-o,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style[this.inlineDir]=this.handle.style[this.inlineDir]}},{key:"hideHandleAndGuide",value:function(){Le(this.handle,"active"),Le(this.guide,"active")}},{key:"checkIfColumnHeader",value:function(o){return!!ci(o,["THEAD"],this.hot.rootElement)}},{key:"getClosestTHParent",value:function(o){return o.tagName!=="TABLE"?o.tagName==="TH"?o:this.getClosestTHParent(o.parentNode):null}},{key:"onMouseOver",value:function(o){if(!dE(o.target)&&this.checkIfColumnHeader(o.target)){var i=this.getClosestTHParent(o.target);if(!i)return;var a=i.getAttribute("colspan");i&&(a===null||a==="1")&&(this.pressed||this.setupHandlePosition(i))}}},{key:"afterMouseDownTimeout",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,f){var c=o.hot.runHooks("beforeColumnResize",o.newSize,u,!0);c!==void 0&&(o.newSize=c),o.hot.getSettings().stretchH==="all"?o.clearManualSize(u):o.setManualSize(u,o.newSize),o.saveManualColumnWidths(),o.hot.runHooks("afterColumnResize",o.newSize,u,!0),f&&i()};if(this.dblclick>=2){var l=this.selectedCols.length;l>1?($(this.selectedCols,function(s){a(s)}),i()):$(this.selectedCols,function(s){a(s,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(o){var i=this;xe(o.target,"manualColumnResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return i.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=o.pageX,this.newSize=this.startWidth)}},{key:"onMouseMove",value:function(o){var i=this;if(this.pressed){var a=(o.pageX-this.startX)*this.hot.getDirectionFactor();this.currentWidth=this.startWidth+a,$(this.selectedCols,function(l){i.newSize=i.setManualSize(l,i.currentWidth)}),this.refreshHandlePosition(),this.refreshGuidePosition()}}},{key:"onMouseUp",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,f){o.hot.runHooks("beforeColumnResize",o.newSize,u,!1),f&&i(),o.saveManualColumnWidths(),o.hot.runHooks("afterColumnResize",o.newSize,u,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth){var l=this.selectedCols.length;l>1?($(this.selectedCols,function(s){a(s)}),i()):$(this.selectedCols,function(s){a(s,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var o=this,i=this.hot,a=i.rootWindow,l=i.rootElement;this.eventManager.addEventListener(l,"mouseover",function(s){return o.onMouseOver(s)}),this.eventManager.addEventListener(l,"mousedown",function(s){return o.onMouseDown(s)}),this.eventManager.addEventListener(a,"mousemove",function(s){return o.onMouseMove(s)}),this.eventManager.addEventListener(a,"mouseup",function(){return o.onMouseUp()})}},{key:"onModifyColWidth",value:function(o,i){var a=o;if(this.enabled){var l=this.hot.toPhysicalColumn(i),s=this.columnWidthsMap.getValueAtIndex(l);this.hot.getSettings()[My]&&s&&(a=s)}return a}},{key:"onBeforeStretchingColumnWidth",value:function(o,i){var a=this.columnWidthsMap.getValueAtIndex(i);return a===null&&(a=o),a}},{key:"onBeforeColumnResize",value:function(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}},{key:"destroy",value:function(){ba(Oo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return My}},{key:"PLUGIN_PRIORITY",get:function(){return eBe}}]),r}(ot);function _d(e){"@babel/helpers - typeof";return _d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_d(e)}function rBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oBe(n.key),n)}}function nBe(e,t,r){return t&&fH(e.prototype,t),r&&fH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function oBe(e){var t=iBe(e,"string");return _d(t)==="symbol"?t:String(t)}function iBe(e,t){if(_d(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_d(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ES=0,cH=1,hH=2,Il="px",aBe=function(){function e(t){rBe(this,e),this.hot=t,this._element=null,this.state=ES}return nBe(e,[{key:"appendTo",value:function(r){r.appendChild(this._element),this.state=hH}},{key:"build",value:function(){this.state===ES&&(this._element=this.hot.rootDocument.createElement("div"),this.state=cH)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=ES}},{key:"isAppended",value:function(){return this.state===hH}},{key:"isBuilt",value:function(){return this.state>=cH}},{key:"setPosition",value:function(r,n){r!==void 0&&(this._element.style.top=r+Il),n!==void 0&&(this._element.style.left=n+Il)}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(r,n){r&&(this._element.style.width=r+Il),n&&(this._element.style.height=n+Il)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(r,n){r&&(this._element.style.marginTop=r+Il),n&&(this._element.style.marginLeft=n+Il)}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}]),e}();const _z=aBe;function Yu(e){"@babel/helpers - typeof";return Yu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yu(e)}function lBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uBe(n.key),n)}}function sBe(e,t,r){return t&&dH(e.prototype,t),r&&dH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uBe(e){var t=fBe(e,"string");return Yu(t)==="symbol"?t:String(t)}function fBe(e,t){if(Yu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Yu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Og(){return typeof Reflect<"u"&&Reflect.get?Og=Reflect.get.bind():Og=function(t,r,n){var o=cBe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Og.apply(this,arguments)}function cBe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Gu(e),e!==null););return e}function hBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fR(e,t)}function fR(e,t){return fR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},fR(e,t)}function dBe(e){var t=gBe();return function(){var n=Gu(e),o;if(t){var i=Gu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return vBe(this,o)}}function vBe(e,t){if(t&&(Yu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yBe(e)}function yBe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gBe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Gu(e){return Gu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Gu(e)}var pBe="ht__manualRowMove--backlight",mBe=function(e){hBe(r,e);var t=dBe(r);function r(){return lBe(this,r),t.apply(this,arguments)}return sBe(r,[{key:"build",value:function(){Og(Gu(r.prototype),"build",this).call(this),re(this._element,pBe)}}]),r}(_z);const bBe=mBe;function Ku(e){"@babel/helpers - typeof";return Ku=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ku(e)}function wBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,CBe(n.key),n)}}function SBe(e,t,r){return t&&vH(e.prototype,t),r&&vH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function CBe(e){var t=_Be(e,"string");return Ku(t)==="symbol"?t:String(t)}function _Be(e,t){if(Ku(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ku(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Rg(){return typeof Reflect<"u"&&Reflect.get?Rg=Reflect.get.bind():Rg=function(t,r,n){var o=OBe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Rg.apply(this,arguments)}function OBe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=qu(e),e!==null););return e}function RBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&cR(e,t)}function cR(e,t){return cR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},cR(e,t)}function EBe(e){var t=kBe();return function(){var n=qu(e),o;if(t){var i=qu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return TBe(this,o)}}function TBe(e,t){if(t&&(Ku(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return PBe(e)}function PBe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kBe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function qu(e){return qu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},qu(e)}var $Be="ht__manualRowMove--guideline",ABe=function(e){RBe(r,e);var t=EBe(r);function r(){return wBe(this,r),t.apply(this,arguments)}return SBe(r,[{key:"build",value:function(){Rg(qu(r.prototype),"build",this).call(this),re(this._element,$Be)}}]),r}(_z);const IBe=ABe;function Xu(e){"@babel/helpers - typeof";return Xu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xu(e)}function MBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,DBe(n.key),n)}}function xBe(e,t,r){return t&&yH(e.prototype,t),r&&yH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function DBe(e){var t=NBe(e,"string");return Xu(t)==="symbol"?t:String(t)}function NBe(e,t){if(Xu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wa(){return typeof Reflect<"u"&&Reflect.get?wa=Reflect.get.bind():wa=function(t,r,n){var o=HBe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},wa.apply(this,arguments)}function HBe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ro(e),e!==null););return e}function LBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hR(e,t)}function hR(e,t){return hR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},hR(e,t)}function jBe(e){var t=BBe();return function(){var n=Ro(e),o;if(t){var i=Ro(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return FBe(this,o)}}function FBe(e,t){if(t&&(Xu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dR(e)}function dR(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BBe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ro(e){return Ro=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ro(e)}pe.getSingleton().register("beforeRowMove");pe.getSingleton().register("afterRowMove");var TS="manualRowMove",VBe=140,Jo=new WeakMap,gH="ht__manualRowMove",xy="show-ui",PS="on-moving--rows",kS="after-selection--rows",WBe=function(e){LBe(r,e);var t=jBe(r);function r(n){var o;return MBe(this,r),o=t.call(this,n),Jo.set(dR(o),{rowsToMove:[],pressed:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0},cachedDropIndex:void 0}),o.eventManager=new Tt(dR(o)),o.backlight=new bBe(n),o.guideline=new IBe(n),o}return xBe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[TS]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return o.onBeforeOnCellMouseOver.apply(o,arguments)}),this.addHook("afterScrollHorizontally",function(){return o.onAfterScrollHorizontally()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.buildPluginUI(),this.registerEvents(),re(this.hot.rootElement,gH),wa(Ro(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),wa(Ro(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Le(this.hot.rootElement,gH),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),wa(Ro(r.prototype),"disablePlugin",this).call(this)}},{key:"moveRow",value:function(o,i){return this.moveRows([o],i)}},{key:"moveRows",value:function(o,i){var a=Jo.get(this),l=a.cachedDropIndex,s=this.isMovePossible(o,i),u=this.hot.runHooks("beforeRowMove",o,i,l,s);if(a.cachedDropIndex=void 0,u!==!1){s&&this.hot.rowIndexMapper.moveIndexes(o,i);var f=s&&this.isRowOrderChanged(o,i);return this.hot.runHooks("afterRowMove",o,i,l,s,f),f}}},{key:"dragRow",value:function(o,i){return this.dragRows([o],i)}},{key:"dragRows",value:function(o,i){var a=this.countFinalIndex(o,i),l=Jo.get(this);return l.cachedDropIndex=i,this.moveRows(o,a)}},{key:"isMovePossible",value:function(o,i){var a=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),l=o.length+i>a,s=i<0,u=o.some(function(c){return c<0}),f=o.some(function(c){return c>=a});return!(l||s||u||f)}},{key:"isRowOrderChanged",value:function(o,i){return o.some(function(a,l){return a-l!==i})}},{key:"countFinalIndex",value:function(o,i){var a=Lt(o,function(l,s){return s<i&&(l+=1),l},0);return i-a}},{key:"getRowsHeight",value:function(o,i){for(var a=this.hot.rowIndexMapper,l=0,s=o;s<=i;s++){var u=a.getRenderableFromVisualIndex(s);u!==null&&(l+=this.hot.view._wt.wtTable.getRowHeight(u)||23)}return l}},{key:"moveBySettingsOrLoad",value:function(){var o=this.hot.getSettings()[TS];if(Array.isArray(o))this.moveRows(o,0);else if(o!==void 0){var i=this.persistentStateLoad();i.length&&this.moveRows(i,0)}}},{key:"isFixedRowTop",value:function(o){return o<this.hot.getSettings().fixedRowsTop}},{key:"isFixedRowBottom",value:function(o){return o>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var o={};return this.hot.runHooks("persistentStateLoad","manualRowMove",o),o.value?o.value:[]}},{key:"prepareRowsToMoving",value:function(){var o=this.hot.getSelectedRangeLast(),i=[];if(!o)return i;var a=o.from,l=o.to,s=Math.min(a.row,l.row),u=Math.max(a.row,l.row);return _e(s,u,function(f){i.push(f)}),i}},{key:"refreshPositions",value:function(){var o=Jo.get(this),i=o.target.coords,a=this.hot.view.getFirstFullyVisibleRow(),l=this.hot.view.getLastFullyVisibleRow(),s=this.hot.countRows();this.isFixedRowTop(i.row)&&a>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(a-1,-1)),this.isFixedRowBottom(i.row)&&l<s&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(l+1,1),void 0,!0);var u=this.hot.view._wt.wtTable,f=o.target.TD,c=this.hot.rootElement,h=Vt(c),d=xa(c),v=u.holder.scrollTop,g;this.hot.rootWindow===d?g=d.scrollY:g=d.scrollTop;var m=h.top-g,w=o.target.eventPageY-m+v,S=u.hider.offsetHeight,C=u.TBODY.offsetTop,P=this.backlight.getOffset().top,R=this.backlight.getSize().height,V=f.offsetHeight/2,U=f.offsetHeight,X=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,i.row-1),Y=w>=X+V;this.isFixedRowTop(i.row)&&(X+=u.holder.scrollTop),i.row<0?o.target.row=a>0?a-1:a:Y?(o.target.row=i.row+1,X+=i.row===0?U-1:U):o.target.row=i.row;var q=w,Z=X;w+R+P>=S?q=S-R-P:w+P<C&&(q=C+Math.abs(P)),X>=S-1&&(Z=S-1),this.backlight.setPosition(q),this.guideline.setPosition(Z)}},{key:"registerEvents",value:function(){var o=this,i=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(i,"mousemove",function(a){return o.onMouseMove(a)}),this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,l){var s=this.hot.view._wt,u=s.wtTable,f=s.wtViewport,c=this.hot.selection.isSelectedByRowHeader(),h=this.hot.getSelectedRangeLast(),d=Jo.get(this);if(!h||!c||d.pressed||o.button!==0){d.pressed=!1,d.rowsToMove.length=0,Le(this.hot.rootElement,[PS,xy]);return}var v=this.guideline.isBuilt()&&!this.guideline.isAppended(),g=this.backlight.isBuilt()&&!this.backlight.isAppended();v&&g&&(this.guideline.appendTo(u.hider),this.backlight.appendTo(u.hider));var m=h.from,w=h.to,S=Math.min(m.row,w.row),C=Math.max(m.row,w.row);if(i.col<0&&i.row>=S&&i.row<=C){l.row=!0,d.pressed=!0,d.target.eventPageY=o.pageY,d.target.coords=i,d.target.TD=a,d.rowsToMove=this.prepareRowsToMoving();var P=u.holder.scrollLeft+f.getRowHeaderWidth();this.backlight.setPosition(null,P),this.backlight.setSize(u.hider.offsetWidth-P,this.getRowsHeight(S,C)),this.backlight.setOffset((this.getRowsHeight(S,i.row-1)+o.offsetY)*-1,null),re(this.hot.rootElement,PS),this.refreshPositions()}else Le(this.hot.rootElement,kS),d.pressed=!1,d.rowsToMove.length=0}},{key:"onMouseMove",value:function(o){var i=Jo.get(this);if(i.pressed){if(o.target===this.backlight.element){var a=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout(function(){this.backlight.setPosition(null,a)})}i.target.eventPageY=o.pageY,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(o,i,a,l){var s=this.hot.getSelectedRangeLast(),u=Jo.get(this);!s||!u.pressed||(u.rowsToMove.indexOf(i.row)>-1?Le(this.hot.rootElement,xy):re(this.hot.rootElement,xy),l.row=!0,l.column=!0,l.cell=!0,u.target.coords=i,u.target.TD=a)}},{key:"onMouseUp",value:function(){var o=Jo.get(this),i=o.target.row,a=o.rowsToMove.length;if(o.pressed=!1,o.backlightHeight=0,Le(this.hot.rootElement,[PS,xy,kS]),this.hot.selection.isSelectedByRowHeader()&&re(this.hot.rootElement,kS),!(a<1||i===void 0)){var l=o.rowsToMove[0],s=this.hot.toPhysicalRow(l),u=this.dragRows(o.rowsToMove,i);if(o.rowsToMove.length=0,u===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var f=this.hot.toVisualRow(s),c=f+a-1;this.hot.selectRows(f,c)}}}},{key:"onAfterScrollHorizontally",value:function(){var o=this.hot.view._wt.wtTable,i=this.hot.view._wt.wtViewport.getRowHeaderWidth(),a=o.holder.scrollLeft,l=i+a;this.backlight.setPosition(null,l),this.backlight.setSize(o.hider.offsetWidth-l)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),wa(Ro(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return TS}},{key:"PLUGIN_PRIORITY",get:function(){return VBe}}]),r}(ot);function Zu(e){"@babel/helpers - typeof";return Zu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zu(e)}function UBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,YBe(n.key),n)}}function zBe(e,t,r){return t&&pH(e.prototype,t),r&&pH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function YBe(e){var t=GBe(e,"string");return Zu(t)==="symbol"?t:String(t)}function GBe(e,t){if(Zu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Sa(){return typeof Reflect<"u"&&Reflect.get?Sa=Reflect.get.bind():Sa=function(t,r,n){var o=KBe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Sa.apply(this,arguments)}function KBe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Eo(e),e!==null););return e}function qBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vR(e,t)}function vR(e,t){return vR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},vR(e,t)}function XBe(e){var t=QBe();return function(){var n=Eo(e),o;if(t){var i=Eo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return ZBe(this,o)}}function ZBe(e,t){if(t&&(Zu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yR(e)}function yR(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function QBe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Eo(e){return Eo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Eo(e)}var Dy="manualRowResize",JBe=30,mH="manualRowHeights",$S=new WeakMap,eVe=function(e){qBe(r,e);var t=XBe(r);function r(n){var o;UBe(this,r),o=t.call(this,n);var i=o.hot.rootDocument;return o.currentTH=null,o.currentRow=null,o.selectedRows=[],o.currentHeight=null,o.newSize=null,o.startY=null,o.startHeight=null,o.startOffset=null,o.handle=i.createElement("DIV"),o.guide=i.createElement("DIV"),o.eventManager=new Tt(yR(o)),o.pressed=null,o.dblclick=0,o.autoresizeTimeout=null,o.rowHeightsMap=void 0,$S.set(yR(o),{config:void 0}),re(o.handle,"manualRowResizer"),re(o.guide,"manualRowResizerGuide"),o}return zBe(r,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[Dy]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.rowHeightsMap=new Ai,this.rowHeightsMap.addLocalHook("init",function(){return o.onMapInit()}),this.hot.rowIndexMapper.registerMap(this.pluginName,this.rowHeightsMap),this.addHook("modifyRowHeight",function(i,a){return o.onModifyRowHeight(i,a)}),this.bindEvents(),Sa(Eo(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Sa(Eo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var o=$S.get(this);o.config=this.rowHeightsMap.getValues(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),Sa(Eo(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualRowHeights",value:function(){this.hot.runHooks("persistentStateSave",mH,this.rowHeightsMap.getValues())}},{key:"loadManualRowHeights",value:function(){var o={};return this.hot.runHooks("persistentStateLoad",mH,o),o.value}},{key:"setManualSize",value:function(o,i){var a=this.hot.toPhysicalRow(o),l=Math.max(i,ZV.DEFAULT_HEIGHT);return this.rowHeightsMap.setValueAtIndex(a,l),l}},{key:"setupHandlePosition",value:function(o){var i=this;this.currentTH=o;var a=this.hot.view,l=a._wt,s=l.wtTable.getCoords(this.currentTH),u=s.row;if(!(u<0)){var f=dt(this.currentTH),c=this.currentTH.getBoundingClientRect(),h=u<l.getSetting("fixedRowsTop"),d=u>=a.countNotHiddenRowIndexes(0,1)-l.getSetting("fixedRowsBottom"),v;h?v=l.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col):d&&(v=l.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),v||(v=l.wtOverlays.inlineStartOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),this.currentRow=this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.selectedRows=[];var g=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&g){var m=this.hot.getSelectedRange();$(m,function(w){var S=w.getTopStartCorner().row,C=w.getBottomStartCorner().row;_e(S,C,function(P){i.selectedRows.includes(P)||i.selectedRows.push(P)})})}this.selectedRows.includes(this.currentRow)||(this.selectedRows=[this.currentRow]),this.startOffset=v.top-6,this.startHeight=parseInt(c.height,10),this.handle.style.top="".concat(this.startOffset+this.startHeight,"px"),this.handle.style[this.inlineDir]="".concat(v.start,"px"),this.handle.style.width="".concat(f,"px"),this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.top="".concat(this.startOffset+this.currentHeight,"px")}},{key:"setupGuidePosition",value:function(){var o=parseInt(dt(this.handle),10),i=parseInt(this.handle.style[this.inlineDir],10)+o,a=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);re(this.handle,"active"),re(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style[this.inlineDir]="".concat(i,"px"),this.guide.style.width="".concat(a-o,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.top=this.handle.style.top}},{key:"hideHandleAndGuide",value:function(){Le(this.handle,"active"),Le(this.guide,"active")}},{key:"checkIfRowHeader",value:function(o){var i,a,l=ci(o,["TH"],this.hot.rootElement);return l&&((i=o.parentNode)===null||i===void 0||(a=i.parentNode)===null||a===void 0?void 0:a.tagName)==="TBODY"}},{key:"getClosestTHParent",value:function(o){return o.tagName!=="TABLE"?o.tagName==="TH"?o:this.getClosestTHParent(o.parentNode):null}},{key:"getActualRowHeight",value:function(o){var i=this.hot.view._wt.wtTable.getRowHeight(o);return i!==void 0&&this.newSize<i?i:this.newSize}},{key:"onMouseOver",value:function(o){if(!dE(o.target)&&this.checkIfRowHeader(o.target)){var i=this.getClosestTHParent(o.target);i&&(this.pressed||this.setupHandlePosition(i))}}},{key:"afterMouseDownTimeout",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,f){var c=o.hot.runHooks("beforeRowResize",o.getActualRowHeight(u),u,!0);c!==void 0&&(o.newSize=c),o.setManualSize(u,o.newSize),o.hot.runHooks("afterRowResize",o.getActualRowHeight(u),u,!0),f&&i()};if(this.dblclick>=2){var l=this.selectedRows.length;l>1?($(this.selectedRows,function(s){a(s)}),i()):$(this.selectedRows,function(s){a(s,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(o){var i=this;xe(o.target,"manualRowResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return i.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=o.pageY,this.newSize=this.startHeight)}},{key:"onMouseMove",value:function(o){var i=this;this.pressed&&(this.currentHeight=this.startHeight+(o.pageY-this.startY),$(this.selectedRows,function(a){i.newSize=i.setManualSize(a,i.currentHeight)}),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,f){o.hot.runHooks("beforeRowResize",o.getActualRowHeight(u),u,!1),f&&i(),o.saveManualRowHeights(),o.hot.runHooks("afterRowResize",o.getActualRowHeight(u),u,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight){var l=this.selectedRows.length;l>1?($(this.selectedRows,function(s){a(s)}),i()):$(this.selectedRows,function(s){a(s,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var o=this,i=this.hot,a=i.rootElement,l=i.rootWindow;this.eventManager.addEventListener(a,"mouseover",function(s){return o.onMouseOver(s)}),this.eventManager.addEventListener(a,"mousedown",function(s){return o.onMouseDown(s)}),this.eventManager.addEventListener(l,"mousemove",function(s){return o.onMouseMove(s)}),this.eventManager.addEventListener(l,"mouseup",function(){return o.onMouseUp()})}},{key:"onModifyRowHeight",value:function(o,i){var a=o;if(this.enabled){var l=this.hot.toPhysicalRow(i),s=this.rowHeightsMap.getValueAtIndex(l);this.hot.getSettings()[Dy]&&s&&(a=s)}return a}},{key:"onMapInit",value:function(){var o=this,i=$S.get(this),a=this.hot.getSettings()[Dy],l=this.loadManualRowHeights();this.hot.batchExecution(function(){typeof l<"u"?l.forEach(function(s,u){o.rowHeightsMap.setValueAtIndex(u,s)}):Array.isArray(a)?(a.forEach(function(s,u){o.rowHeightsMap.setValueAtIndex(u,s)}),i.config=a):a===!0&&Array.isArray(i.config)&&i.config.forEach(function(s,u){o.rowHeightsMap.setValueAtIndex(u,s)})},!0)}},{key:"destroy",value:function(){Sa(Eo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Dy}},{key:"PLUGIN_PRIORITY",get:function(){return JBe}}]),r}(ot);function Od(e){"@babel/helpers - typeof";return Od=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Od(e)}var bH,wH,SH,CH;function Ny(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function tVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _H(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nVe(n.key),n)}}function rVe(e,t,r){return t&&_H(e.prototype,t),r&&_H(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nVe(e){var t=oVe(e,"string");return Od(t)==="symbol"?t:String(t)}function oVe(e,t){if(Od(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Od(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var iVe=function(){function e(t,r,n,o,i,a){tVe(this,e),this.row=t,this.col=r,this.rowspan=n,this.colspan=o,this.removed=!1,this.cellCoordsFactory=i,this.cellRangeFactory=a}return rVe(e,[{key:"normalize",value:function(r){var n=r.countRows(),o=r.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>o-1&&(this.col=o-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>o-1&&(this.colspan=o-this.col)}},{key:"includes",value:function(r,n){return this.row<=r&&this.col<=n&&this.row+this.rowspan-1>=r&&this.col+this.colspan-1>=n}},{key:"includesHorizontally",value:function(r){return this.col<=r&&this.col+this.colspan-1>=r}},{key:"includesVertically",value:function(r){return this.row<=r&&this.row+this.rowspan-1>=r}},{key:"shift",value:function(r,n){var o=r[0]||r[1],i=n+Math.abs(r[0]||r[1])-1,a=r[0]?"colspan":"rowspan",l=r[0]?"col":"row",s=Math.min(n,i),u=Math.max(n,i),f=this[l],c=this[l]+this[a]-1;if(f>=n&&(this[l]+=o),o>0)n<=c&&n>f&&(this[a]+=o);else if(o<0){if(s<=f&&u>=c)return this.removed=!0,!1;if(f>=s&&f<=u){var h=u-f+1,d=Math.abs(o)-h;this[l]-=d+o,this[a]-=h}else if(f<=s&&c>=u)this[a]+=o;else if(f<=s&&c>=s&&c<u){var v=c-s+1;this[a]-=v}}return!0}},{key:"isFarther",value:function(r,n){return r?n==="down"?r.row+r.rowspan-1<this.row+this.rowspan-1:n==="up"?r.row>this.row:n==="right"?r.col+r.colspan-1<this.col+this.colspan-1:n==="left"?r.col>this.col:null:!0}},{key:"getLastRow",value:function(){return this.row+this.rowspan-1}},{key:"getLastColumn",value:function(){return this.col+this.colspan-1}},{key:"getRange",value:function(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}],[{key:"NEGATIVE_VALUES_WARNING",value:function(r){return ft(bH||(bH=Ny(["The merged cell declared with {row: ",", col: ",`, 
      rowspan: `,", colspan: ",`} contains negative values, which is 
      not supported. It will not be added to the collection.`],["The merged cell declared with {row: ",", col: ",`,\\x20
      rowspan: `,", colspan: ",`} contains negative values, which is\\x20
      not supported. It will not be added to the collection.`])),r.row,r.col,r.rowspan,r.colspan)}},{key:"IS_OUT_OF_BOUNDS_WARNING",value:function(r){return ft(wH||(wH=Ny(["The merged cell declared at [",", ",`] is positioned 
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`],["The merged cell declared at [",", ",`] is positioned\\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`])),r.row,r.col)}},{key:"IS_SINGLE_CELL",value:function(r){return ft(SH||(SH=Ny(["The merged cell declared at [",", ",`] has both "rowspan" 
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has both "rowspan"\\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`])),r.row,r.col)}},{key:"ZERO_SPAN_WARNING",value:function(r){return ft(CH||(CH=Ny(["The merged cell declared at [",", ",`] has "rowspan" 
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has "rowspan"\\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`])),r.row,r.col)}},{key:"containsNegativeValues",value:function(r){return r.row<0||r.col<0||r.rowspan<0||r.colspan<0}},{key:"isSingleCell",value:function(r){return r.colspan===1&&r.rowspan===1}},{key:"containsZeroSpan",value:function(r){return r.colspan===0||r.rowspan===0}},{key:"isOutOfBounds",value:function(r,n,o){return r.row<0||r.col<0||r.row>=n||r.row+r.rowspan-1>=n||r.col>=o||r.col+r.colspan-1>=o}}]),e}();const In=iVe;function gR(e,t,r,n){t?t.row===r&&t.col===n?(e.setAttribute("rowspan",t.rowspan.toString()),e.setAttribute("colspan",t.colspan.toString())):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="none"):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="")}function Rd(e){"@babel/helpers - typeof";return Rd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rd(e)}var OH;function aVe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function RH(e){return fVe(e)||uVe(e)||sVe(e)||lVe()}function lVe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sVe(e,t){if(e){if(typeof e=="string")return pR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pR(e,t)}}function uVe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function fVe(e){if(Array.isArray(e))return pR(e)}function pR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function cVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dVe(n.key),n)}}function hVe(e,t,r){return t&&EH(e.prototype,t),r&&EH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dVe(e){var t=vVe(e,"string");return Rd(t)==="symbol"?t:String(t)}function vVe(e,t){if(Rd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yVe=function(){function e(t){cVe(this,e),this.plugin=t,this.mergedCells=[],this.hot=t.hot}return hVe(e,[{key:"get",value:function(r,n){var o=this.mergedCells,i=!1;return $(o,function(a){return a.row<=r&&a.row+a.rowspan-1>=r&&a.col<=n&&a.col+a.colspan-1>=n?(i=a,!1):!0}),i}},{key:"getByRange",value:function(r){var n=this.mergedCells,o=!1;return $(n,function(i){return i.row<=r.from.row&&i.row+i.rowspan-1>=r.to.row&&i.col<=r.from.col&&i.col+i.colspan-1>=r.to.col?(o=i,o):!0}),o}},{key:"getWithinRange",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=this.mergedCells,a=[],l=r;if(!l.includesRange){var s=this.hot._createCellCoords(l.from.row,l.from.col),u=this.hot._createCellCoords(l.to.row,l.to.col);l=this.hot._createCellRange(s,s,u)}return $(i,function(f){var c=n.hot._createCellCoords(f.row,f.col),h=n.hot._createCellCoords(f.row+f.rowspan-1,f.col+f.colspan-1),d=n.hot._createCellRange(c,c,h);o?l.overlaps(d)&&a.push(f):l.includesRange(d)&&a.push(f)}),a.length?a:!1}},{key:"add",value:function(r){var n=this.mergedCells,o=r.row,i=r.col,a=r.rowspan,l=r.colspan,s=new In(o,i,a,l,this.hot._createCellCoords,this.hot._createCellRange),u=this.get(o,i),f=this.isOverlapping(s);return!u&&!f?(this.hot&&s.normalize(this.hot),n.push(s),s):(ht(e.IS_OVERLAPPING_WARNING(s)),!1)}},{key:"remove",value:function(r,n){var o=this.mergedCells,i=this.get(r,n),a=i?this.mergedCells.indexOf(i):-1;return i&&a!==-1?(o.splice(a,1),i):!1}},{key:"clear",value:function(){var r=this,n=this.mergedCells,o=[],i=[];$(n,function(a){var l=r.hot.getCell(a.row,a.col);l&&o.push([l,r.get(a.row,a.col),a.row,a.col])}),this.mergedCells.length=0,$(o,function(a,l){_e(0,a.rowspan-1,function(s){_e(0,a.colspan-1,function(u){if(u!==0||s!==0){var f=r.hot.getCell(a.row+s,a.col+u);f&&i.push([f,null,null,null])}})}),o[l][1]=null}),$(o,function(a){gR.apply(void 0,RH(a))}),$(i,function(a){gR.apply(void 0,RH(a))})}},{key:"isOverlapping",value:function(r){var n=this,o=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(r.row,r.col),this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1)),i=!1;return $(this.mergedCells,function(a){var l=n.hot._createCellRange(n.hot._createCellCoords(0,0),n.hot._createCellCoords(a.row,a.col),n.hot._createCellCoords(a.row+a.rowspan-1,a.col+a.colspan-1));return l.overlaps(o)?(i=!0,!1):!0}),i}},{key:"isFirstRenderableMergedCell",value:function(r,n){var o=this.get(r,n);return o&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(o.row,1)===r&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(o.col,1)===n}},{key:"getFirstRenderableCoords",value:function(r,n){var o=this.get(r,n);if(!o||this.isFirstRenderableMergedCell(r,n))return this.hot._createCellCoords(r,n);var i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(o.row,1),a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o.col,1);return this.hot._createCellCoords(i,a)}},{key:"shiftCollections",value:function(r,n,o){var i=this,a=[0,0];switch(r){case"right":a[0]+=o;break;case"left":a[0]-=o;break;case"down":a[1]+=o;break;case"up":a[1]-=o;break}$(this.mergedCells,function(l){l.shift(a,n)}),zg(this.mergedCells.length-1,0,function(l){var s=i.mergedCells[l];s&&s.removed&&i.mergedCells.splice(i.mergedCells.indexOf(s),1)})}}],[{key:"IS_OVERLAPPING_WARNING",value:function(r){return ft(OH||(OH=aVe(["The merged cell declared at [",", ",`], overlaps 
      with the other declared merged cell. The overlapping merged cell was not added to the table, please 
      fix your setup.`],["The merged cell declared at [",", ",`], overlaps\\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\\x20
      fix your setup.`])),r.row,r.col)}}]),e}();const gVe=yVe;function Ed(e){"@babel/helpers - typeof";return Ed=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ed(e)}function Ki(e,t){return wVe(e)||bVe(e,t)||mVe(e,t)||pVe()}function pVe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mVe(e,t){if(e){if(typeof e=="string")return TH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return TH(e,t)}}function TH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function bVe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function wVe(e){if(Array.isArray(e))return e}function SVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_Ve(n.key),n)}}function CVe(e,t,r){return t&&PH(e.prototype,t),r&&PH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _Ve(e){var t=OVe(e,"string");return Ed(t)==="symbol"?t:String(t)}function OVe(e,t){if(Ed(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ed(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var RVe=function(){function e(t){SVe(this,e),this.plugin=t,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}return CVe(e,[{key:"correctSelectionAreaSize",value:function(r){if(r[0]===r[2]&&r[1]===r[3]){var n=this.mergedCellsCollection.get(r[0],r[1]);n&&(r[2]=r[0]+n.rowspan-1,r[3]=r[1]+n.colspan-1)}}},{key:"getDirection",value:function(r,n){var o=null;return n[0]===r[0]&&n[1]===r[1]&&n[3]===r[3]?o="down":n[2]===r[2]&&n[1]===r[1]&&n[3]===r[3]?o="up":n[1]===r[1]&&n[2]===r[2]?o="right":o="left",o}},{key:"snapDragArea",value:function(r,n,o,i){var a=n.slice(0),l=this.getAutofillSize(r,n,o),s=Ki(r,4),u=s[0],f=s[1],c=s[2],h=s[3],d=["up","down"].indexOf(o)>-1,v=d?c-u+1:h-f+1,g=Math.floor(l/v)*v,m=l-g,w=this.getFarthestCollection(r,n,o,i);if(w){if(o==="down"){var S=w.row+w.rowspan-u-m,C=a[2]+S;C>=this.plugin.hot.countRows()?a[2]-=m:a[2]+=m?S:0}else if(o==="right"){var P=w.col+w.colspan-f-m,R=a[3]+P;R>=this.plugin.hot.countCols()?a[3]-=m:a[3]+=m?P:0}else if(o==="up"){var V=c-m-w.row+1,U=a[0]+V;U<0?a[0]+=m:a[0]-=m?V:0}else if(o==="left"){var X=h-m-w.col+1,Y=a[1]+X;Y<0?a[1]+=m:a[1]-=m?X:0}}return this.updateCurrentFillCache({baseArea:r,dragDirection:o,foundMergedCells:i,fillSize:l,dragArea:a,cycleLength:v}),a}},{key:"updateCurrentFillCache",value:function(r){this.currentFillData||(this.currentFillData={}),Wt(this.currentFillData,r)}},{key:"getAutofillSize",value:function(r,n,o){var i=Ki(r,4),a=i[0],l=i[1],s=i[2],u=i[3],f=Ki(n,4),c=f[0],h=f[1],d=f[2],v=f[3];switch(o){case"up":return a-c;case"down":return d-s;case"left":return l-h;case"right":return v-u;default:return null}}},{key:"getDragArea",value:function(r,n,o){var i=Ki(r,4),a=i[0],l=i[1],s=i[2],u=i[3],f=Ki(n,4),c=f[0],h=f[1],d=f[2],v=f[3];switch(o){case"up":return[c,h,a-1,u];case"down":return[s+1,l,d,u];case"left":return[c,h,s,l-1];case"right":return[a,u+1,d,v];default:return null}}},{key:"getFarthestCollection",value:function(r,n,o,i){var a=Ki(r,4),l=a[0],s=a[1],u=a[2],f=a[3],c=["up","down"].indexOf(o)>-1,h=c?u:f,d=c?l:s,v=this.getAutofillSize(r,n,o),g=c?u-l+1:f-s+1,m=Math.floor(v/g)*g,w=v-m,S=null,C=null,P=null;switch(o){case"up":S="includesVertically",P=h-w+1;break;case"left":S="includesHorizontally",P=h-w+1;break;case"down":S="includesVertically",P=d+w-1;break;case"right":S="includesHorizontally",P=d+w-1;break}return $(i,function(R){R[S](P)&&R.isFarther(C,o)&&(C=R)}),C}},{key:"recreateAfterDataPopulation",value:function(r){if(this.currentFillData){var n=this.getRangeFromChanges(r),o=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,a=function(h,d){switch(i){case"up":return h.row-d>=n.from.row;case"down":return h.row+h.rowspan-1+d<=n.to.row;case"left":return h.col-d>=n.from.column;case"right":return h.col+h.colspan-1+d<=n.to.column;default:return null}},l=0,s=null,u=1;do for(var f=0;f<o.length;f+=1){if(s=o[f],l=u*this.currentFillData.cycleLength,a(s,l))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:s.row-l,rowspan:s.rowspan,col:s.col,colspan:s.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:s.row+l,rowspan:s.rowspan,col:s.col,colspan:s.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col-l,colspan:s.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col+l,colspan:s.colspan});break}f===o.length-1&&(u+=1)}while(a(s,l));this.currentFillData=null,this.plugin.hot.render(),o.length>0&&this.plugin.ifChromeForceRepaint()}}},{key:"getRangeFromChanges",value:function(r){var n=this,o={min:null,max:null},i={min:null,max:null};return $(r,function(a){var l=a[0],s=n.plugin.hot.propToCol(a[1]);(o.min===null||l<o.min)&&(o.min=l),(o.max===null||l>o.max)&&(o.max=l),(i.min===null||s<i.min)&&(i.min=s),(i.max===null||s>i.max)&&(i.max=s)}),{from:{row:o.min,column:i.min},to:{row:o.max,column:i.max}}}},{key:"dragAreaOverlapsCollections",value:function(r,n,o){var i=this.getDragArea(r,n,o),a=Ki(i,4),l=a[0],s=a[1],u=a[2],f=a[3],c=this.plugin.hot._createCellCoords(l,s),h=this.plugin.hot._createCellCoords(u,f),d=this.plugin.hot._createCellRange(c,c,h);return!!this.mergedCellsCollection.getWithinRange(d,!0)}}]),e}();const EVe=RVe;function Td(e){"@babel/helpers - typeof";return Td=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Td(e)}function TVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kVe(n.key),n)}}function PVe(e,t,r){return t&&kH(e.prototype,t),r&&kH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kVe(e){var t=$Ve(e,"string");return Td(t)==="symbol"?t:String(t)}function $Ve(e,t){if(Td(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Td(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var AVe=function(){function e(t){TVe(this,e),this.plugin=t,this.hot=t.hot,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}return PVe(e,[{key:"snapDelta",value:function(r,n,o){var i=n.to,a=i.row+r.row,l=i.col+r.col;r.row?this.jumpOverMergedCell(r,o,a):r.col&&this.jumpOverMergedCell(r,o,l)}},{key:"jumpOverMergedCell",value:function(r,n,o){var i=r.row||r.col,a=null,l=null,s=null;r.row?(a=n.includesVertically(o),l=n.row,s=n.getLastRow()):r.col&&(a=n.includesHorizontally(o),l=n.col,s=n.getLastColumn()),i!==0&&(i>0?a&&o!==l&&(i+=s-o+1):a&&o!==s&&(i-=o-l+1),r.row?r.row=i:r.col&&(r.col=i))}},{key:"getUpdatedSelectionRange",value:function(r,n){return this.hot._createCellRange(r.highlight,r.from,this.hot._createCellCoords(r.to.row+n.row,r.to.col+n.col))}},{key:"getSelectedMergedCellClassName",value:function(r,n,o,i){var a=Math.min(o[0],o[2]),l=Math.min(o[1],o[3]),s=Math.max(o[0],o[2]),u=Math.max(o[1],o[3]);if(i!==void 0){var f=this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(r,n);if(f){var c=this.plugin.mergedCellsCollection.get(r,n);if(c){var h=c.getLastRow(),d=c.getLastColumn(),v=a<=c.row&&l<=c.col&&s>=h&&u>=d;if(v)return"".concat(this.fullySelectedMergedCellClassName,"-").concat(i);if(this.plugin.selectionCalculations.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return"".concat(this.fullySelectedMergedCellClassName,"-multiple")}}}}},{key:"isMergeCellFullySelected",value:function(r,n){var o=[];if(!n||!r)return!1;for(var i=0;i<r.rowspan;i+=1)for(var a=0;a<r.colspan;a+=1)o.push(this.hot._createCellCoords(r.row+i,r.col+a));for(var l=0;l<o.length;l+=1){for(var s=[],u=0;u<n.length;u+=1)s[u]=n[u].includes(o[l]);if(!s.includes(!0))return!1}return!0}},{key:"getSelectedMergedCellClassNameToRemove",value:function(){for(var r=[],n=0;n<=7;n+=1)r.push("".concat(this.fullySelectedMergedCellClassName,"-").concat(n));return r.push("".concat(this.fullySelectedMergedCellClassName,"-multiple")),r}}]),e}();const IVe=AVe;function MVe(e){return{key:"mergeCells",name:function(){var r=this.getSelectedLast();if(r){var n=e.mergedCellsCollection.get(r[0],r[1]);if(n.row===r[0]&&n.col===r[1]&&n.row+n.rowspan-1===r[2]&&n.col+n.colspan-1===r[3])return this.getTranslatedPhrase(lT)}return this.getTranslatedPhrase(aT)},callback:function(){e.toggleMergeOnSelection()},disabled:function(){var r=this.getSelectedLast();if(!r)return!0;var n=In.isSingleCell({row:r[0],col:r[1],rowspan:r[2]-r[0]+1,colspan:r[3]-r[1]+1});return n||this.selection.isSelectedByCorner()},hidden:!1}}function Qu(e){"@babel/helpers - typeof";return Qu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qu(e)}function xVe(e,t){return HVe(e)||NVe(e,t)||Oz(e,t)||DVe()}function DVe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NVe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function HVe(e){if(Array.isArray(e))return e}function LVe(e){return BVe(e)||FVe(e)||Oz(e)||jVe()}function jVe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Oz(e,t){if(e){if(typeof e=="string")return mR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mR(e,t)}}function FVe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function BVe(e){if(Array.isArray(e))return mR(e)}function mR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function VVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $H(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,UVe(n.key),n)}}function WVe(e,t,r){return t&&$H(e.prototype,t),r&&$H(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function UVe(e){var t=zVe(e,"string");return Qu(t)==="symbol"?t:String(t)}function zVe(e,t){if(Qu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rs(){return typeof Reflect<"u"&&Reflect.get?rs=Reflect.get.bind():rs=function(t,r,n){var o=YVe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},rs.apply(this,arguments)}function YVe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ci(e),e!==null););return e}function GVe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bR(e,t)}function bR(e,t){return bR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},bR(e,t)}function KVe(e){var t=XVe();return function(){var n=Ci(e),o;if(t){var i=Ci(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return qVe(this,o)}}function qVe(e,t){if(t&&(Qu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Rz(e)}function Rz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function XVe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ci(e){return Ci=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ci(e)}pe.getSingleton().register("beforeMergeCells");pe.getSingleton().register("afterMergeCells");pe.getSingleton().register("beforeUnmergeCells");pe.getSingleton().register("afterUnmergeCells");var cc="mergeCells",ZVe=150,AH=new WeakMap,IH=cc,QVe=function(e){GVe(r,e);var t=KVe(r);function r(n){var o;return VVe(this,r),o=t.call(this,n),AH.set(Rz(o),{lastDesiredCoords:null}),o.mergedCellsCollection=null,o.autofillCalculations=null,o.selectionCalculations=null,o}return WVe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[cc]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.mergedCellsCollection=new gVe(this),this.autofillCalculations=new EVe(this),this.selectionCalculations=new IVe(this),this.addHook("afterInit",function(){return o.onAfterInit.apply(o,arguments)}),this.addHook("modifyTransformStart",function(){return o.onModifyTransformStart.apply(o,arguments)}),this.addHook("afterModifyTransformStart",function(){return o.onAfterModifyTransformStart.apply(o,arguments)}),this.addHook("modifyTransformEnd",function(){return o.onModifyTransformEnd.apply(o,arguments)}),this.addHook("modifyGetCellCoords",function(){return o.onModifyGetCellCoords.apply(o,arguments)}),this.addHook("beforeSetRangeStart",function(){return o.onBeforeSetRangeStart.apply(o,arguments)}),this.addHook("beforeSetRangeStartOnly",function(){return o.onBeforeSetRangeStart.apply(o,arguments)}),this.addHook("beforeSetRangeEnd",function(){return o.onBeforeSetRangeEnd.apply(o,arguments)}),this.addHook("afterIsMultipleSelection",function(){return o.onAfterIsMultipleSelection.apply(o,arguments)}),this.addHook("afterRenderer",function(){return o.onAfterRenderer.apply(o,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return o.addMergeActionsToContextMenu.apply(o,arguments)}),this.addHook("afterGetCellMeta",function(){return o.onAfterGetCellMeta.apply(o,arguments)}),this.addHook("afterViewportRowCalculatorOverride",function(){return o.onAfterViewportRowCalculatorOverride.apply(o,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return o.onAfterViewportColumnCalculatorOverride.apply(o,arguments)}),this.addHook("modifyAutofillRange",function(){return o.onModifyAutofillRange.apply(o,arguments)}),this.addHook("afterCreateCol",function(){return o.onAfterCreateCol.apply(o,arguments)}),this.addHook("afterRemoveCol",function(){return o.onAfterRemoveCol.apply(o,arguments)}),this.addHook("afterCreateRow",function(){return o.onAfterCreateRow.apply(o,arguments)}),this.addHook("afterRemoveRow",function(){return o.onAfterRemoveRow.apply(o,arguments)}),this.addHook("afterChange",function(){return o.onAfterChange.apply(o,arguments)}),this.addHook("beforeDrawBorders",function(){return o.onBeforeDrawAreaBorders.apply(o,arguments)}),this.addHook("afterDrawSelection",function(){return o.onAfterDrawSelection.apply(o,arguments)}),this.addHook("beforeRemoveCellClassNames",function(){return o.onBeforeRemoveCellClassNames.apply(o,arguments)}),this.addHook("beforeUndoStackChange",function(i,a){if(a==="MergeCells")return!1}),this.registerShortcuts(),rs(Ci(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),rs(Ci(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){var o=this.hot.getSettings()[cc];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(o),rs(Ci(r.prototype),"updatePlugin",this).call(this)}},{key:"ifChromeForceRepaint",value:function(){var o=this;if(L0()){var i=[],a=[];this.mergedCellsCollection.mergedCells.forEach(function(l){for(var s=l.row,u=l.rowspan,f=s+1;f<s+u;f++)a.push(f)}),a=LVe(new Set(a)),a.forEach(function(l){var s=o.hot.rowIndexMapper.getRenderableFromVisualIndex(l);o.hot.view._wt.wtOverlays.getOverlays(!0).map(function(u){return(u==null?void 0:u.name)==="master"?u:u.clone.wtTable}).forEach(function(u){var f=u.getRow(s);f&&(f.style.background=cs(f,"backgroundColor").replace(")",", 0.99)"),i.push(f))})}),this.hot._registerTimeout(function(){i.forEach(function(l){l.style.background=cs(l,"backgroundColor").replace(", 0.99)",")")})},1)}}},{key:"validateSetting",value:function(o){var i=!0;return o?(In.containsNegativeValues(o)?(ht(In.NEGATIVE_VALUES_WARNING(o)),i=!1):In.isOutOfBounds(o,this.hot.countRows(),this.hot.countCols())?(ht(In.IS_OUT_OF_BOUNDS_WARNING(o)),i=!1):In.isSingleCell(o)?(ht(In.IS_SINGLE_CELL(o)),i=!1):In.containsZeroSpan(o)&&(ht(In.ZERO_SPAN_WARNING(o)),i=!1),i):!1}},{key:"generateFromSettings",value:function(o){var i=this;if(Array.isArray(o)){var a=[];if($(o,function(l){if(i.validateSetting(l)){var s=i.hot._createCellCoords(l.row,l.col),u=i.hot._createCellCoords(l.row+l.rowspan-1,l.col+l.colspan-1),f=i.hot._createCellRange(s,s,u);i.mergeRange(f,!0,!0),_e(l.row,l.row+l.rowspan-1,function(c){_e(l.col,l.col+l.colspan-1,function(h){c===l.row&&h===l.col||a.push([c,h,null])})})}}),a.length===0)return;this.hot.setDataAtCell(a)}}},{key:"clearCollections",value:function(){this.mergedCellsCollection.clear()}},{key:"canMergeRange",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return i?!0:this.validateSetting(o)}},{key:"toggleMergeOnSelection",value:function(){var o=this.hot.getSelectedRangeLast();if(o){o.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var i=o.from,a=o.to;this.toggleMerge(o),this.hot.selectCell(i.row,i.col,a.row,a.col,!1)}}},{key:"mergeSelection",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(o){o.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var i=o.from,a=o.to;this.unmergeRange(o,!0),this.mergeRange(o),this.hot.selectCell(i.row,i.col,a.row,a.col,!1)}}},{key:"unmergeSelection",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(o){var i=o.from,a=o.to;this.unmergeRange(o,!0),this.hot.selectCell(i.row,i.col,a.row,a.col,!1)}}},{key:"mergeRange",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=o.getTopStartCorner(),u=o.getBottomEndCorner(),f={row:s.row,col:s.col,rowspan:u.row-s.row+1,colspan:u.col-s.col+1},c=[],h=null;if(!this.canMergeRange(f,a))return!1;this.hot.runHooks("beforeMergeCells",o,a),_e(0,f.rowspan-1,function(v){_e(0,f.colspan-1,function(g){var m=null;c[v]||(c[v]=[]),v===0&&g===0?m=i.hot.getSourceDataAtCell(i.hot.toPhysicalRow(f.row),i.hot.toPhysicalColumn(f.col)):i.hot.setCellMeta(f.row+v,f.col+g,"hidden",!0),c[v][g]=m})}),this.hot.setCellMeta(f.row,f.col,"spanned",!0);var d=this.mergedCellsCollection.add(f);return d?(l?h=[f.row,f.col,c]:this.hot.populateFromArray(f.row,f.col,c,void 0,void 0,this.pluginName),a||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",o,f,a),h):!0}},{key:"unmergeRange",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,l=this.mergedCellsCollection.getWithinRange(o);l&&(this.hot.runHooks("beforeUnmergeCells",o,a),$(l,function(s){i.mergedCellsCollection.remove(s.row,s.col),_e(0,s.rowspan-1,function(u){_e(0,s.colspan-1,function(f){i.hot.removeCellMeta(s.row+u,s.col+f,"hidden")})}),i.hot.removeCellMeta(s.row,s.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",o,a),this.hot.render())}},{key:"toggleMerge",value:function(o){var i=this.mergedCellsCollection.get(o.from.row,o.from.col),a=i.row===o.from.row&&i.col===o.from.col&&i.row+i.rowspan-1===o.to.row&&i.col+i.colspan-1===o.to.col;a?this.unmergeRange(o):this.mergeSelection(o)}},{key:"merge",value:function(o,i,a,l){var s=this.hot._createCellCoords(o,i),u=this.hot._createCellCoords(a,l);this.mergeRange(this.hot._createCellRange(s,s,u))}},{key:"unmerge",value:function(o,i,a,l){var s=this.hot._createCellCoords(o,i),u=this.hot._createCellCoords(a,l);this.unmergeRange(this.hot._createCellRange(s,s,u))}},{key:"onAfterInit",value:function(){this.generateFromSettings(this.hot.getSettings()[cc]),this.hot.render()}},{key:"registerShortcuts",value:function(){var o=this,i=this.hot.getShortcutManager(),a=i.getContext("grid");a.addShortcut({keys:[["Control","m"]],callback:function(){o.toggleMerge(o.hot.getSelectedRangeLast()),o.hot.render()},runOnlyIf:function(s){return!s.altKey},group:IH})}},{key:"unregisterShortcuts",value:function(){var o=this.hot.getShortcutManager(),i=o.getContext("grid");i.removeShortcutsByGroup(IH)}},{key:"onAfterIsMultipleSelection",value:function(o){if(o){for(var i=this.mergedCellsCollection.mergedCells,a=this.hot.getSelectedRangeLast(),l=0;l<i.length;l+=1)if(a.from.row===i[l].row&&a.from.col===i[l].col&&a.to.row===i[l].row+i[l].rowspan-1&&a.to.col===i[l].col+i[l].colspan-1)return!1}return o}},{key:"onModifyTransformStart",value:function(o){var i=AH.get(this),a=this.hot.getSelectedRangeLast(),l={row:o.row,col:o.col},s=null,u=this.hot._createCellCoords(a.highlight.row,a.highlight.col),f=this.mergedCellsCollection.get(u.row,u.col);if(i.lastDesiredCoords||(i.lastDesiredCoords=this.hot._createCellCoords(null,null)),f){var c=this.hot._createCellCoords(f.row,f.col),h=this.hot._createCellCoords(f.row+f.rowspan-1,f.col+f.colspan-1),d=this.hot._createCellRange(c,c,h);d.includes(i.lastDesiredCoords)||(i.lastDesiredCoords=this.hot._createCellCoords(null,null)),l.row=i.lastDesiredCoords.row?i.lastDesiredCoords.row-u.row:l.row,l.col=i.lastDesiredCoords.col?i.lastDesiredCoords.col-u.col:l.col,o.row>0?l.row=f.row+f.rowspan-1-u.row+o.row:o.row<0&&(l.row=u.row-f.row+o.row),o.col>0?l.col=f.col+f.colspan-1-u.col+o.col:o.col<0&&(l.col=u.col-f.col+o.col)}s=this.hot._createCellCoords(a.highlight.row+l.row,a.highlight.col+l.col);var v=this.mergedCellsCollection.get(s.row,s.col);if(v){var g=this.mergedCellsCollection.getFirstRenderableCoords(v.row,v.col);i.lastDesiredCoords=s,l={row:g.row-u.row,col:g.col-u.col}}l.row!==0&&(o.row=l.row),l.col!==0&&(o.col=l.col)}},{key:"onModifyTransformEnd",value:function(o){var i=this,a=this.hot.getSelectedRangeLast(),l=pr(o),s=this.selectionCalculations.getUpdatedSelectionRange(a,o),u=pr(l),f=this.mergedCellsCollection.getWithinRange(s,!0);do u=pr(l),this.selectionCalculations.getUpdatedSelectionRange(a,l),$(f,function(c){i.selectionCalculations.snapDelta(l,a,c)});while(l.row!==u.row||l.col!==u.col);o.row=l.row,o.col=l.col}},{key:"onModifyGetCellCoords",value:function(o,i){if(!(o<0||i<0)){var a=this.mergedCellsCollection.get(o,i);if(a){var l=a.row,s=a.col,u=a.colspan,f=a.rowspan;return[l,s,l+f-1,s+u-1]}}}},{key:"addMergeActionsToContextMenu",value:function(o){o.items.push({name:"---------"},MVe(this))}},{key:"onAfterRenderer",value:function(o,i,a){var l=this.mergedCellsCollection.get(i,a),s=Ve(l)?pr(l):void 0;if(Ve(s)){var u=this.hot,f=u.rowIndexMapper,c=u.columnIndexMapper,h=s.row,d=s.col,v=s.colspan,g=s.rowspan,m=this.translateMergedCellToRenderable(h,g,d,v),w=xVe(m,2),S=w[0],C=w[1],P=f.getRenderableFromVisualIndex(i),R=c.getRenderableFromVisualIndex(a),V=S-P+1,U=C-R+1;s.row=f.getNearestNotHiddenIndex(s.row,1),s.col=c.getNearestNotHiddenIndex(s.col,1),s.rowspan=Math.min(s.rowspan,V),s.colspan=Math.min(s.colspan,U)}gR(o,s,i,a)}},{key:"onBeforeSetRangeStart",value:function(o){if(this.mergedCellsCollection.isFirstRenderableMergedCell(o.row,o.col)){var i=this.mergedCellsCollection.get(o.row,o.col),a=[i.row,i.col];o.row=a[0],o.col=a[1]}}},{key:"onBeforeSetRangeEnd",value:function(o){var i=this.hot.getSelectedRangeLast();i.highlight=this.hot._createCellCoords(i.highlight.row,i.highlight.col),i.to=o;var a=!1;if(!(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()))do{a=!1;for(var l=0;l<this.mergedCellsCollection.mergedCells.length;l+=1){var s=this.mergedCellsCollection.mergedCells[l],u=s.getRange();i.expandByRange(u)&&(o.row=i.to.row,o.col=i.to.col,a=!0)}}while(a)}},{key:"onAfterGetCellMeta",value:function(o,i,a){var l=this.mergedCellsCollection.get(o,i);l&&(l.row!==o||l.col!==i?a.copyable=!1:(a.rowspan=l.rowspan,a.colspan=l.colspan))}},{key:"onAfterViewportRowCalculatorOverride",value:function(o){var i=this.hot.countCols();this.modifyViewportRowStart(o,i),this.modifyViewportRowEnd(o,i)}},{key:"modifyViewportRowStart",value:function(o,i){for(var a=this.hot.rowIndexMapper,l=a.getVisualFromRenderableIndex(o.startRow),s=0;s<i;s+=1){var u=this.mergedCellsCollection.get(l,s);if(Ve(u)){var f=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(u.row,1));if(f<o.startRow){o.startRow=f,this.modifyViewportRowStart(o,i);return}}}}},{key:"modifyViewportRowEnd",value:function(o,i){for(var a=this.hot.rowIndexMapper,l=a.getVisualFromRenderableIndex(o.endRow),s=0;s<i;s+=1){var u=this.mergedCellsCollection.get(l,s);if(Ve(u)){var f=u.row+u.rowspan-1,c=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(f,-1));if(c>o.endRow){o.endRow=c,this.modifyViewportRowEnd(o,i);return}}}}},{key:"onAfterViewportColumnCalculatorOverride",value:function(o){var i=this.hot.countRows();this.modifyViewportColumnStart(o,i),this.modifyViewportColumnEnd(o,i)}},{key:"modifyViewportColumnStart",value:function(o,i){for(var a=this.hot.columnIndexMapper,l=a.getVisualFromRenderableIndex(o.startColumn),s=0;s<i;s+=1){var u=this.mergedCellsCollection.get(s,l);if(Ve(u)){var f=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(u.col,1));if(f<o.startColumn){o.startColumn=f,this.modifyViewportColumnStart(o,i);return}}}}},{key:"modifyViewportColumnEnd",value:function(o,i){for(var a=this.hot.columnIndexMapper,l=a.getVisualFromRenderableIndex(o.endColumn),s=0;s<i;s+=1){var u=this.mergedCellsCollection.get(s,l);if(Ve(u)){var f=u.col+u.colspan-1,c=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(f,-1));if(c>o.endColumn){o.endColumn=c,this.modifyViewportColumnEnd(o,i);return}}}}},{key:"translateMergedCellToRenderable",value:function(o,i,a,l){var s=this.hot,u=s.rowIndexMapper,f=s.columnIndexMapper,c,h;i===0?c=u.getNearestNotHiddenIndex(o,1):c=u.getNearestNotHiddenIndex(o+i-1,-1),l===0?h=f.getNearestNotHiddenIndex(a,1):h=f.getNearestNotHiddenIndex(a+l-1,-1);var d=o>=0?u.getRenderableFromVisualIndex(c):o,v=a>=0?f.getRenderableFromVisualIndex(h):a;return[d,v]}},{key:"onModifyAutofillRange",value:function(o,i){this.autofillCalculations.correctSelectionAreaSize(i);var a=this.autofillCalculations.getDirection(i,o),l=o;if(this.autofillCalculations.dragAreaOverlapsCollections(i,l,a))return l=i,l;var s=this.mergedCellsCollection.getWithinRange({from:{row:i[0],col:i[1]},to:{row:i[2],col:i[3]}});return s&&(l=this.autofillCalculations.snapDragArea(i,l,a,s)),l}},{key:"onAfterCreateCol",value:function(o,i){this.mergedCellsCollection.shiftCollections("right",o,i)}},{key:"onAfterRemoveCol",value:function(o,i){this.mergedCellsCollection.shiftCollections("left",o,i)}},{key:"onAfterCreateRow",value:function(o,i,a){a!=="auto"&&this.mergedCellsCollection.shiftCollections("down",o,i)}},{key:"onAfterRemoveRow",value:function(o,i){this.mergedCellsCollection.shiftCollections("up",o,i)}},{key:"onAfterChange",value:function(o,i){i==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(o)}},{key:"onBeforeDrawAreaBorders",value:function(o,i){if(i&&i==="area"){var a=this.hot.getSelectedRangeLast(),l=this.mergedCellsCollection.getWithinRange(a);$(l,function(s){a.getBottomEndCorner().row===s.getLastRow()&&a.getBottomEndCorner().col===s.getLastColumn()&&(o[2]=s.row,o[3]=s.col)})}}},{key:"onAfterModifyTransformStart",value:function(o,i,a){if(this.enabled){var l=this.mergedCellsCollection.get(o.row,o.col);if(l){var s=i>0,u=i<0,f=a<0,c=a>0,h=l.row+l.rowspan-1===this.hot.countRows()-1,d=l.row===0,v=l.col+l.colspan-1===this.hot.countCols()-1,g=l.col===0;(s&&h||u&&d||c&&v||f&&g)&&(o.row=l.row,o.col=l.col)}}}},{key:"onAfterDrawSelection",value:function(o,i,a,l){if(a)return this.selectionCalculations.getSelectedMergedCellClassName(o,i,a,l)}},{key:"onBeforeRemoveCellClassNames",value:function(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}],[{key:"PLUGIN_KEY",get:function(){return cc}},{key:"PLUGIN_PRIORITY",get:function(){return ZVe}}]),r}(ot);function MH(e){return rWe(e)||tWe(e)||eWe(e)||JVe()}function JVe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eWe(e,t){if(e){if(typeof e=="string")return xH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xH(e,t)}}function xH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function tWe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function rWe(e){if(Array.isArray(e))return e}function nWe(e,t){return function(r,n){var o=MH(r),i=o.slice(1),a=MH(n),l=a.slice(1);return function s(u){var f=e[u],c=t[u],h=i[u],d=l[u],v=c.multiColumnSorting,g=v.compareFunctionFactory?v.compareFunctionFactory:lU(c.type),m=g(f,c,v)(h,d);if(m===Nn){var w=u+1;if(typeof t[w]<"u")return s(w)}return m}(0)}}var DH;function oWe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function NH(){ht(ft(DH||(DH=oWe(["Plugins `columnSorting` and `multiColumnSorting` should not be enabled simultaneously. \n    Only `multiColumnSorting` will work."],["Plugins \\`columnSorting\\` and \\`multiColumnSorting\\` should not be enabled simultaneously. \n    Only \\`multiColumnSorting\\` will work."]))))}var Ez="sort";function iWe(e,t,r){var n=[];return r===!1||e.isColumnSorted(t)&&e.getNumberOfSortedColumns()>1&&n.push("".concat(Ez,"-").concat(e.getIndexOfColumnInSortQueue(t)+1)),n}function aWe(e){var t=e.className.split(" "),r=new RegExp("^".concat(Ez,"-[0-9]{1,2}$"));return t.filter(function(n){return r.test(n)})}function Ju(e){"@babel/helpers - typeof";return Ju=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ju(e)}function lWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uWe(n.key),n)}}function sWe(e,t,r){return t&&HH(e.prototype,t),r&&HH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uWe(e){var t=fWe(e,"string");return Ju(t)==="symbol"?t:String(t)}function fWe(e,t){if(Ju(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ju(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Dr(){return typeof Reflect<"u"&&Reflect.get?Dr=Reflect.get.bind():Dr=function(t,r,n){var o=cWe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Dr.apply(this,arguments)}function cWe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=yr(e),e!==null););return e}function hWe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wR(e,t)}function wR(e,t){return wR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},wR(e,t)}function dWe(e){var t=gWe();return function(){var n=yr(e),o;if(t){var i=yr(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return vWe(this,o)}}function vWe(e,t){if(t&&(Ju(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yWe(e)}function yWe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gWe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yr(e){return yr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yr(e)}var SR="multiColumnSorting",pWe=170,mWe="append",LH="columnSorting";aU(SR,nWe);var bWe=function(e){hWe(r,e);var t=dWe(r);function r(n){var o;return lWe(this,r),o=t.call(this,n),o.pluginKey=SR,o}return sWe(r,[{key:"isEnabled",value:function(){return Dr(yr(r.prototype),"isEnabled",this).call(this)}},{key:"enablePlugin",value:function(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[LH]&&NH(),Dr(yr(r.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Dr(yr(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(o){Dr(yr(r.prototype),"sort",this).call(this,o)}},{key:"clearSort",value:function(){Dr(yr(r.prototype),"clearSort",this).call(this)}},{key:"isSorted",value:function(){return Dr(yr(r.prototype),"isSorted",this).call(this)}},{key:"getSortConfig",value:function(o){return Dr(yr(r.prototype),"getSortConfig",this).call(this,o)}},{key:"setSortConfig",value:function(o){Dr(yr(r.prototype),"setSortConfig",this).call(this,o)}},{key:"getNormalizedSortConfigs",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(o)?o:[o]}},{key:"updateHeaderClasses",value:function(o){for(var i,a=arguments.length,l=new Array(a>1?a-1:0),s=1;s<a;s++)l[s-1]=arguments[s];(i=Dr(yr(r.prototype),"updateHeaderClasses",this)).call.apply(i,[this,o].concat(l)),Le(o,aWe(o)),this.enabled!==!1&&re(o,iWe.apply(void 0,l))}},{key:"onUpdateSettings",value:function(o){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[LH]&&NH(),Dr(yr(r.prototype),"onUpdateSettings",this).call(this,o)}},{key:"onAfterOnCellMouseDown",value:function(o,i){pO(i.row,i.col,o)!==!1&&this.wasClickableHeaderClicked(o,i.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(i.col),this.sort(this.getNextSortConfig(i.col,mWe))):this.sort(this.getColumnNextConfig(i.col)))}}],[{key:"PLUGIN_KEY",get:function(){return SR}},{key:"PLUGIN_PRIORITY",get:function(){return pWe}}]),r}(uU);function ef(e){"@babel/helpers - typeof";return ef=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ef(e)}function wWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,CWe(n.key),n)}}function SWe(e,t,r){return t&&jH(e.prototype,t),r&&jH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function CWe(e){var t=_We(e,"string");return ef(t)==="symbol"?t:String(t)}function _We(e,t){if(ef(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ef(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Eg(){return typeof Reflect<"u"&&Reflect.get?Eg=Reflect.get.bind():Eg=function(t,r,n){var o=OWe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Eg.apply(this,arguments)}function OWe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=tf(e),e!==null););return e}function RWe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&CR(e,t)}function CR(e,t){return CR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},CR(e,t)}function EWe(e){var t=kWe();return function(){var n=tf(e),o;if(t){var i=tf(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return TWe(this,o)}}function TWe(e,t){if(t&&(ef(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return PWe(e)}function PWe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kWe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function tf(e){return tf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},tf(e)}var $We="multipleSelectionHandles",AWe=160,IWe=function(e){RWe(r,e);var t=EWe(r);function r(n){var o;return wWe(this,r),o=t.call(this,n),o.dragged=[],o.eventManager=null,o.lastSetCell=null,o}return SWe(r,[{key:"isEnabled",value:function(){return fn()}},{key:"enablePlugin",value:function(){this.enabled||(this.eventManager||(this.eventManager=new Tt(this)),this.registerListeners(),Eg(tf(r.prototype),"enablePlugin",this).call(this))}},{key:"registerListeners",value:function(){var o=this,i=this,a=this.hot.rootElement;function l(s){if(i.dragged.length===1)return i.dragged.splice(0,i.dragged.length),!0;var u=i.dragged.indexOf(s);if(u===-1)return!1;u===0?i.dragged=i.dragged.slice(0,1):u===1&&(i.dragged=i.dragged.slice(-1))}this.eventManager.addEventListener(a,"touchstart",function(s){var u;if(xe(s.target,"topSelectionHandle-HitArea"))return u=i.hot.getSelectedRangeLast(),i.dragged.push("top"),i.touchStartRange={width:u.getWidth(),height:u.getHeight(),direction:u.getDirection()},s.preventDefault(),!1;if(xe(s.target,"bottomSelectionHandle-HitArea"))return u=i.hot.getSelectedRangeLast(),i.dragged.push("bottom"),i.touchStartRange={width:u.getWidth(),height:u.getHeight(),direction:u.getDirection()},s.preventDefault(),!1}),this.eventManager.addEventListener(a,"touchend",function(s){if(xe(s.target,"topSelectionHandle-HitArea"))return l.call(i,"top"),i.touchStartRange=void 0,s.preventDefault(),!1;if(xe(s.target,"bottomSelectionHandle-HitArea"))return l.call(i,"bottom"),i.touchStartRange=void 0,s.preventDefault(),!1}),this.eventManager.addEventListener(a,"touchmove",function(s){var u=o.hot.rootDocument,f,c,h,d,v,g;if(i.dragged.length!==0){var m=u.elementFromPoint(s.touches[0].clientX,s.touches[0].clientY);!m||m===i.lastSetCell||((m.nodeName==="TD"||m.nodeName==="TH")&&(f=i.hot.getCoords(m),f.col===-1&&(f.col=0),c=i.hot.getSelectedRangeLast(),h=c.getWidth(),d=c.getHeight(),v=c.getDirection(),h===1&&d===1&&i.hot.selection.setRangeEnd(f),g=i.getCurrentRangeCoords(c,f,i.touchStartRange.direction,v,i.dragged[0]),g.start!==null&&i.hot.selection.setRangeStart(g.start),i.hot.selection.setRangeEnd(g.end),i.lastSetCell=m),s.preventDefault())}})}},{key:"getCurrentRangeCoords",value:function(o,i,a,l,s){var u=o.getTopStartCorner(),f=o.getBottomEndCorner(),c=o.getBottomStartCorner(),h=o.getTopEndCorner(),d={start:null,end:null};switch(a){case"NE-SW":switch(l){case"NE-SW":case"NW-SE":s==="top"?d={start:this.hot._createCellCoords(i.row,o.highlight.col),end:this.hot._createCellCoords(c.row,i.col)}:d={start:this.hot._createCellCoords(o.highlight.row,i.col),end:this.hot._createCellCoords(i.row,u.col)};break;case"SE-NW":s==="bottom"&&(d={start:this.hot._createCellCoords(f.row,i.col),end:this.hot._createCellCoords(i.row,u.col)});break}break;case"NW-SE":switch(l){case"NE-SW":s==="top"?d={start:i,end:c}:d.end=i;break;case"NW-SE":s==="top"?d={start:i,end:f}:d.end=i;break;case"SE-NW":s==="top"?d={start:i,end:u}:d.end=i;break;case"SW-NE":s==="top"?d={start:i,end:h}:d.end=i;break}break;case"SW-NE":switch(l){case"NW-SE":s==="bottom"?d={start:this.hot._createCellCoords(i.row,u.col),end:this.hot._createCellCoords(c.row,i.col)}:d={start:this.hot._createCellCoords(u.row,i.col),end:this.hot._createCellCoords(i.row,f.col)};break;case"SW-NE":s==="top"?d={start:this.hot._createCellCoords(o.highlight.row,i.col),end:this.hot._createCellCoords(i.row,f.col)}:d={start:this.hot._createCellCoords(i.row,u.col),end:this.hot._createCellCoords(u.row,i.col)};break;case"SE-NW":s==="bottom"?d={start:this.hot._createCellCoords(i.row,h.col),end:this.hot._createCellCoords(u.row,i.col)}:s==="top"&&(d={start:c,end:i});break}break;case"SE-NW":switch(l){case"NW-SE":case"NE-SW":case"SW-NE":s==="top"&&(d.end=i);break;case"SE-NW":s==="top"?d.end=i:d={start:i,end:u};break}break}return d}},{key:"isDragged",value:function(){return this.dragged.length>0}}],[{key:"PLUGIN_KEY",get:function(){return $We}},{key:"PLUGIN_PRIORITY",get:function(){return AWe}}]),r}(ot);function _R(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.label,r=t===void 0?"":t,n=e.colspan,o=n===void 0?1:n,i=e.origColspan,a=i===void 0?1:i,l=e.collapsible,s=l===void 0?!1:l,u=e.crossHiddenColumns,f=u===void 0?[]:u,c=e.isCollapsed,h=c===void 0?!1:c,d=e.isHidden,v=d===void 0?!1:d,g=e.isRoot,m=g===void 0?!1:g,w=e.isPlaceholder,S=w===void 0?!1:w;return{label:r,colspan:o,origColspan:a,collapsible:s,isCollapsed:h,crossHiddenColumns:f,isHidden:v,isRoot:m,isPlaceholder:S}}function Tz(){return{label:"",isPlaceholder:!0}}function FH(e){return NWe(e)||DWe(e)||xWe(e)||MWe()}function MWe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xWe(e,t){if(e){if(typeof e=="string")return OR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return OR(e,t)}}function DWe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function NWe(e){if(Array.isArray(e))return OR(e)}function OR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function HWe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,r=[];if(t===0)return r;$(e,function(o){var i=[],a=0;r.push(i),$(o,function(l){var s=_R();if(Ve(l)){var u=l.label,f=l.colspan;s.label=It(u),typeof f=="number"&&f>1&&(s.colspan=f,s.origColspan=f)}else s.label=It(l);a+=s.origColspan;var c=!1;if(a>=t&&(s.colspan=s.origColspan-(a-t),s.origColspan=s.colspan,c=!0),i.push(s),s.colspan>1)for(var h=0;h<s.colspan-1;h++)i.push(Tz());return!c})});var n=Math.max.apply(Math,FH(Be(r,function(o){return o.length})));return $(r,function(o){if(o.length<n){var i=Be(new Array(n-o.length),function(){return _R()});o.splice.apply(o,[o.length,0].concat(FH(i)))}}),r}function Pd(e){"@babel/helpers - typeof";return Pd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pd(e)}var LWe=["row","col"];function BH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function jWe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?BH(Object(r),!0).forEach(function(n){FWe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):BH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function FWe(e,t,r){return t=Pz(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function BWe(e,t){if(e==null)return{};var r=VWe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function VWe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function WWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Pz(n.key),n)}}function UWe(e,t,r){return t&&VH(e.prototype,t),r&&VH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Pz(e){var t=zWe(e,"string");return Pd(t)==="symbol"?t:String(t)}function zWe(e,t){if(Pd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Pd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function AS(e,t,r){YWe(e,t),t.set(e,r)}function YWe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rn(e,t){var r=kz(e,t,"get");return GWe(e,r)}function GWe(e,t){return t.get?t.get.call(e):t.value}function rc(e,t,r){var n=kz(e,t,"set");return KWe(e,n,r),r}function kz(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function KWe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var WH=["label","collapsible"],Zn=new WeakMap,qi=new WeakMap,IS=new WeakMap,qWe=function(){function e(){WWe(this,e),AS(this,Zn,{writable:!0,value:[]}),AS(this,qi,{writable:!0,value:0}),AS(this,IS,{writable:!0,value:1/0})}return UWe(e,[{key:"setColumnsLimit",value:function(r){rc(this,IS,r)}},{key:"setData",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];rc(this,Zn,HWe(r,rn(this,IS))),rc(this,qi,rn(this,Zn).length)}},{key:"getData",value:function(){return rn(this,Zn)}},{key:"mergeWith",value:function(r){var n=this;$(r,function(o){var i=o.row,a=o.col,l=BWe(o,LWe),s=n.getHeaderSettings(i,a);s!==null&&Wt(s,l,WH)})}},{key:"map",value:function(r){$(rn(this,Zn),function(n){$(n,function(o){var i=r(jWe({},o));Ve(i)&&Wt(o,i,WH)})})}},{key:"getHeaderSettings",value:function(r,n){var o;if(r>=rn(this,qi)||r<0)return null;var i=rn(this,Zn)[r];return n>=i.length?null:(o=i[n])!==null&&o!==void 0?o:null}},{key:"getHeadersSettings",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,i=[];if(r>=rn(this,qi)||r<0)return i;for(var a=rn(this,Zn)[r],l=0,s=n;s<a.length;s++){var u=a[s];if(u.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(l+=u.colspan,i.push(u),u.colspan>1&&(s+=u.colspan-1),l===o)break;if(l>o)throw new Error("The last column settings cannot overlap the other header layers")}return i}},{key:"getLayersCount",value:function(){return rn(this,qi)}},{key:"getColumnsCount",value:function(){return rn(this,qi)>0?rn(this,Zn)[0].length:0}},{key:"clear",value:function(){rc(this,Zn,[]),rc(this,qi,0)}}]),e}();function kd(e){"@babel/helpers - typeof";return kd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kd(e)}function UH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function zH(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?UH(Object(r),!0).forEach(function(n){Tg(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):UH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function XWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$z(n.key),n)}}function ZWe(e,t,r){return t&&YH(e.prototype,t),r&&YH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Tg(e,t,r){return t=$z(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $z(e){var t=QWe(e,"string");return kd(t)==="symbol"?t:String(t)}function QWe(e,t){if(kd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(kd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function JWe(e){return n2e(e)||r2e(e)||t2e(e)||e2e()}function e2e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function t2e(e,t){if(e){if(typeof e=="string")return RR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return RR(e,t)}}function r2e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function n2e(e){if(Array.isArray(e))return RR(e)}function RR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var o2e="DF-pre-order";function Az(e,t){for(var r=e.call(t,this),n=0;n<this.childs.length;n++){if(r===!1)return!1;r=Az.call(this.childs[n],e,t)}return r}var i2e="DF-post-order";function Iz(e,t){for(var r=0;r<this.childs.length;r++){var n=Iz.call(this.childs[r],e,t);if(n===!1)return!1}return e.call(t,this)}var Mz="BF";function a2e(e,t){var r=[this];function n(){if(r.length!==0){var o=r.shift();r.push.apply(r,JWe(o.childs)),e.call(t,o)!==!1&&n()}}n()}var l2e=Mz,GH=new Map([[o2e,Az],[i2e,Iz],[Mz,a2e]]),KH=function(){function e(t){XWe(this,e),Tg(this,"data",{}),Tg(this,"parent",null),Tg(this,"childs",[]),this.data=t}return ZWe(e,[{key:"addChild",value:function(r){r.parent=this,this.childs.push(r)}},{key:"cloneTree",value:function(){for(var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this,n=new e(zH({},r.data)),o=0;o<r.childs.length;o++)n.addChild(this.cloneTree(r.childs[o]));return n}},{key:"replaceTreeWith",value:function(r){this.data=zH({},r.data),this.childs=[];for(var n=0;n<r.childs.length;n++)this.addChild(r.childs[n])}},{key:"walkDown",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:l2e;if(!GH.has(n))throw new Error('Traversal strategy "'.concat(n,'" does not exist'));GH.get(n).call(this,r,this)}},{key:"walkUp",value:function(r){var n=this,o=function i(a){var l=r.call(n,a);l!==!1&&a.parent!==null&&i(a.parent)};o(this)}}]),e}();function $d(e){"@babel/helpers - typeof";return $d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$d(e)}function qH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function XH(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?qH(Object(r),!0).forEach(function(n){s2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function s2e(e,t,r){return t=xz(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function u2e(e,t){return d2e(e)||h2e(e,t)||c2e(e,t)||f2e()}function f2e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function c2e(e,t){if(e){if(typeof e=="string")return ZH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ZH(e,t)}}function ZH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function h2e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function d2e(e){if(Array.isArray(e))return e}function v2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xz(n.key),n)}}function y2e(e,t,r){return t&&QH(e.prototype,t),r&&QH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xz(e){var t=g2e(e,"string");return $d(t)==="symbol"?t:String(t)}function g2e(e,t){if($d(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($d(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function MS(e,t,r){p2e(e,t),t.set(e,r)}function p2e(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hr(e,t){var r=Dz(e,t,"get");return m2e(e,r)}function m2e(e,t){return t.get?t.get.call(e):t.value}function b2e(e,t,r){var n=Dz(e,t,"set");return w2e(e,n,r),r}function Dz(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function w2e(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Ml=new WeakMap,Xi=new WeakMap,xl=new WeakMap,S2e=function(){function e(t){v2e(this,e),MS(this,Ml,{writable:!0,value:new Map}),MS(this,Xi,{writable:!0,value:new Map}),MS(this,xl,{writable:!0,value:null}),b2e(this,xl,t)}return y2e(e,[{key:"getRoots",value:function(){return Array.from(hr(this,Ml).values())}},{key:"getRootByColumn",value:function(r){var n;return hr(this,Xi).has(r)&&(n=hr(this,Ml).get(hr(this,Xi).get(r))),n}},{key:"getNode",value:function(r,n){var o=this.getRootByColumn(n);if(o){var i=n-hr(this,Xi).get(n),a=0,l;return o.walkDown(function(s){var u=s.data,f=u.origColspan,c=u.headerLevel;if(r===c){if(i>=a&&i<=a+f-1)return l=s,l.data.isRoot=n===l.data.columnIndex,!1;a+=f}}),l}}},{key:"rebuildTreeIndex",value:function(){var r=this,n=0;hr(this,Xi).clear(),$(hr(this,Ml),function(o){for(var i=u2e(o,2),a=i[1].data.colspan,l=n;l<n+a;l++)hr(r,Xi).set(l,n);n+=a})}},{key:"buildTree",value:function(){this.clear();for(var r=hr(this,xl).getColumnsCount(),n=0;n<r;){var o=hr(this,xl).getHeaderSettings(0,n),i=new KH;hr(this,Ml).set(n,i),this.buildLeaves(i,n,0,o.origColspan),n+=o.origColspan}this.rebuildTreeIndex()}},{key:"buildLeaves",value:function(r,n,o){var i=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,l=hr(this,xl).getHeadersSettings(o,n,a);o+=1,$(l,function(s){var u=XH(XH({},s),{},{headerLevel:o-1,columnIndex:n}),f;o===1?(r.data=u,f=r):(f=new KH(u),r.addChild(f)),o<hr(i,xl).getLayersCount()&&i.buildLeaves(f,n,o,s.origColspan),n+=s.origColspan})}},{key:"clear",value:function(){hr(this,Ml).clear(),hr(this,Xi).clear()}}]),e}();function Nz(e,t){e.walkDown(function(r){var n=r.data,o=r.childs;if(!n.isHidden&&(t(n.columnIndex),o.length===0))for(var i=1;i<n.colspan;i++)t(n.columnIndex+i)})}function Lp(e,t){var r=e.childs;if(r.length!==0)return r[0].data[t]}function jp(e){return Lp(e,"origColspan")===e.data.origColspan}function NP(e){var t=e.data,r=e.childs;if(!t.isCollapsed||t.isHidden||t.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var n=jp(e);if(n)return NP(r[0]);t.isCollapsed=!1;var o=r.slice(1),i=new Set,a=0;if(o.length>0)$(o,function(c){c.replaceTreeWith(c.data.clonedTree),c.data.clonedTree=null;var h=c.data;a+=h.colspan,Nz(c,function(d){i.add(d)})});else{var l=t.colspan,s=t.origColspan,u=t.columnIndex;a=s-l;for(var f=1;f<s;f++)i.add(u+f)}return e.walkUp(function(c){var h=c.data;h.colspan+=a,h.colspan>=h.origColspan?(h.colspan=h.origColspan,h.isCollapsed=!1):jp(c)&&(h.isCollapsed=Lp(c,"isCollapsed"))}),{rollbackModification:function(){return HP(e)},affectedColumns:Array.from(i),colspanCompensation:a}}function HP(e){var t,r=e.data,n=e.childs;if(r.isCollapsed||r.isHidden||r.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var o=jp(e);if(o)return HP(n[0]);r.isCollapsed=!0;var i=n.slice(1),a=new Set;if(i.length>0)$(i,function(h){Nz(h,function(d){a.add(d)}),h.data.clonedTree=h.cloneTree(),h.walkDown(function(d){var v=d.data;v.isHidden=!0})});else for(var l=r.origColspan,s=r.columnIndex,u=1;u<l;u++){var f=s+u;a.add(f)}var c=r.colspan-((t=Lp(e,"colspan"))!==null&&t!==void 0?t:1);return e.walkUp(function(h){var d=h.data;d.colspan-=c,d.colspan<=1?(d.colspan=1,d.isCollapsed=!0):jp(h)&&(d.isCollapsed=Lp(h,"isCollapsed"))}),{rollbackModification:function(){return NP(e)},affectedColumns:Array.from(a),colspanCompensation:c}}var JH;function C2e(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function _2e(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(ft(JH||(JH=C2e([`The passed node is not the last node on the tree. Only for 
the last node, the hide column modification can be applied.`],[`The passed node is not the last node on the tree. Only for\\x20
the last node, the hide column modification can be applied.`]))));var r=e.data.crossHiddenColumns;if(!r.includes(t)){var n=!1;e.walkUp(function(o){var i=o.data.collapsible;if(i)return n=!0,!1}),!n&&e.walkUp(function(o){var i=o.data;i.crossHiddenColumns.push(t),i.colspan>1?i.colspan-=1:i.isHidden=!0})}}var eL;function O2e(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function R2e(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(ft(eL||(eL=O2e([`The passed node is not the last node on the tree. Only for 
the last node, the show column modification can be applied.`],[`The passed node is not the last node on the tree. Only for\\x20
the last node, the show column modification can be applied.`]))));var r=e.data.crossHiddenColumns;if(r.includes(t)){var n=!1;e.walkUp(function(o){var i=o.data.collapsible;if(i)return n=!0,!1}),!n&&e.walkUp(function(o){var i=o.data;i.crossHiddenColumns.splice(i.crossHiddenColumns.indexOf(t),1),!i.isHidden&&i.colspan<i.origColspan&&(i.colspan+=1),i.isHidden=!1})}}var tL=new Map([["collapse",HP],["expand",NP],["hide-column",_2e],["show-column",R2e]]);function E2e(e,t,r){if(!tL.has(e))throw new Error('The node modifier action ("'.concat(e,'") does not exist.'));return tL.get(e)(t,r)}var T2e=["crossHiddenColumns"];function P2e(e,t){if(e==null)return{};var r=k2e(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function k2e(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function Hy(e){var t=[];return $(e,function(r){r.walkDown(function(n){for(var o=n.data,i=o.origColspan,a=o.columnIndex,l=o.headerLevel,s=o.crossHiddenColumns,u=A2e(t,l),f=!1,c=a;c<a+i;c++){var h=s.includes(c);if(h||f)u.push(Tz());else{var d=$2e(o);d.isRoot=!0,u.push(d),f=!0}}})}),t}function $2e(e){var t=_R(e);t.crossHiddenColumns;var r=P2e(t,T2e);return r}function A2e(e,t){var r;return Array.isArray(e[t])?r=e[t]:(r=[],e[t]=r),r}function Ad(e){"@babel/helpers - typeof";return Ad=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ad(e)}var I2e=["row"];function rL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function nL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rL(Object(r),!0).forEach(function(n){M2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function M2e(e,t,r){return t=Hz(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function x2e(e,t){if(e==null)return{};var r=D2e(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function D2e(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function N2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Hz(n.key),n)}}function H2e(e,t,r){return t&&oL(e.prototype,t),r&&oL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hz(e){var t=L2e(e,"string");return Ad(t)==="symbol"?t:String(t)}function L2e(e,t){if(Ad(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ad(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xS(e,t,r){j2e(e,t),t.set(e,r)}function j2e(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nc(e,t,r){var n=Lz(e,t,"set");return F2e(e,n,r),r}function F2e(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function Dt(e,t){var r=Lz(e,t,"get");return B2e(e,r)}function Lz(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function B2e(e,t){return t.get?t.get.call(e):t.value}var kn=new WeakMap,xr=new WeakMap,Zi=new WeakMap,V2e=function(){function e(){N2e(this,e),xS(this,kn,{writable:!0,value:new qWe}),xS(this,xr,{writable:!0,value:new S2e(Dt(this,kn))}),xS(this,Zi,{writable:!0,value:[[]]})}return H2e(e,[{key:"setState",value:function(r){Dt(this,kn).setData(r);var n=!1;try{Dt(this,xr).buildTree()}catch{Dt(this,xr).clear(),Dt(this,kn).clear(),n=!0}return nc(this,Zi,Hy(Dt(this,xr).getRoots())),n}},{key:"setColumnsLimit",value:function(r){Dt(this,kn).setColumnsLimit(r)}},{key:"mergeStateWith",value:function(r){var n=this,o=Be(r,function(i){var a=i.row,l=x2e(i,I2e);return nL({row:a<0?n.rowCoordsToLevel(a):a},l)});Dt(this,kn).mergeWith(o),Dt(this,xr).buildTree(),nc(this,Zi,Hy(Dt(this,xr).getRoots()))}},{key:"mapState",value:function(r){Dt(this,kn).map(r),Dt(this,xr).buildTree(),nc(this,Zi,Hy(Dt(this,xr).getRoots()))}},{key:"mapNodes",value:function(r){return Lt(Dt(this,xr).getRoots(),function(n,o){return o.walkDown(function(i){var a=r(i.data);a!==void 0&&n.push(a)}),n},[])}},{key:"triggerNodeModification",value:function(r,n,o){n<0&&(n=this.rowCoordsToLevel(n));var i=Dt(this,xr).getNode(n,o),a;return i&&(a=E2e(r,i,o),nc(this,Zi,Hy(Dt(this,xr).getRoots()))),a}},{key:"triggerColumnModification",value:function(r,n){return this.triggerNodeModification(r,-1,n)}},{key:"rowCoordsToLevel",value:function(r){if(r>=0)return null;var n=r+Math.max(this.getLayersCount(),1);return n<0?null:n}},{key:"levelToRowCoords",value:function(r){if(r<0)return null;var n=r-Math.max(this.getLayersCount(),1);return n>=0?null:n}},{key:"getHeaderSettings",value:function(r,n){var o,i;return r<0&&(r=this.rowCoordsToLevel(r)),r===null||r>=this.getLayersCount()?null:(o=(i=Dt(this,Zi)[r])===null||i===void 0?void 0:i[n])!==null&&o!==void 0?o:null}},{key:"getHeaderTreeNodeData",value:function(r,n){if(r<0&&(r=this.rowCoordsToLevel(r)),r===null||r>=this.getLayersCount())return null;var o=Dt(this,xr).getNode(r,n);return o?nL({},o.data):null}},{key:"findLeftMostColumnIndex",value:function(r,n){var o,i=(o=this.getHeaderSettings(r,n))!==null&&o!==void 0?o:{isRoot:!0},a=i.isRoot;if(a)return n;for(var l=n-1;l>=0;){var s,u=(s=this.getHeaderSettings(r,l))!==null&&s!==void 0?s:{isRoot:!0},f=u.isRoot;if(f)break;l-=1}return l}},{key:"getLayersCount",value:function(){return Dt(this,kn).getLayersCount()}},{key:"getColumnsCount",value:function(){return Dt(this,kn).getColumnsCount()}},{key:"clear",value:function(){nc(this,Zi,[]),Dt(this,kn).clear(),Dt(this,xr).clear()}}]),e}();function Id(e){"@babel/helpers - typeof";return Id=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Id(e)}function W2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jz(n.key),n)}}function U2e(e,t,r){return t&&iL(e.prototype,t),r&&iL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function oc(e,t,r){return t=jz(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jz(e){var t=z2e(e,"string");return Id(t)==="symbol"?t:String(t)}function z2e(e,t){if(Id(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Id(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Y2e=function(){function e(t,r){W2e(this,e),oc(this,"hot",void 0),oc(this,"nestedHeaderSettingsGetter",void 0),oc(this,"layersCount",0),oc(this,"container",void 0),oc(this,"widthsMap",void 0),this.hot=t,this.nestedHeaderSettingsGetter=r,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}return U2e(e,[{key:"setLayersCount",value:function(r){return this.layersCount=r,this}},{key:"getWidth",value:function(r){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(r))}},{key:"buildWidthsMap",value:function(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);var r=this.container.querySelectorAll("tr:last-of-type th"),n=r.length;this.widthsMap.clear();for(var o=0;o<n;o++){var i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o),a=this.hot.toPhysicalColumn(i);this.widthsMap.setValueAtIndex(a,r[o].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}},{key:"_buildGhostTable",value:function(r){for(var n=this.hot,o=n.rootDocument,i=n.columnIndexMapper,a=o.createDocumentFragment(),l=o.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,u=i.getRenderableIndexesLength(),f=0;f<this.layersCount;f++){for(var c=o.createElement("tr"),h=0;h<u;h++){var d=i.getVisualFromRenderableIndex(h);d===null&&(d=h);var v=o.createElement("th"),g=this.nestedHeaderSettingsGetter(f,d);if(g&&(!g.isPlaceholder||g.isHidden)){var m=g.label;s&&(m+='<button class="changeType"></button>'),tl(v,m),v.colSpan=g.colspan,c.appendChild(v)}}l.appendChild(c)}a.appendChild(l),r.appendChild(a)}},{key:"clear",value:function(){this.widthsMap.clear(),this.container=null}}]),e}();const G2e=Y2e;function rf(e){"@babel/helpers - typeof";return rf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rf(e)}var aL,lL;function sL(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function K2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Fz(n.key),n)}}function q2e(e,t,r){return t&&uL(e.prototype,t),r&&uL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ca(){return typeof Reflect<"u"&&Reflect.get?Ca=Reflect.get.bind():Ca=function(t,r,n){var o=X2e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ca.apply(this,arguments)}function X2e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=To(e),e!==null););return e}function Z2e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ER(e,t)}function ER(e,t){return ER=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},ER(e,t)}function Q2e(e){var t=eUe();return function(){var n=To(e),o;if(t){var i=To(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return J2e(this,o)}}function J2e(e,t){if(t&&(rf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hc(e)}function hc(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eUe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function To(e){return To=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},To(e)}function fL(e,t,r){return t=Fz(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Fz(e){var t=tUe(e,"string");return rf(t)==="symbol"?t:String(t)}function tUe(e,t){if(rf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cL(e,t,r){rUe(e,t),t.set(e,r)}function rUe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ly(e,t,r){var n=Bz(e,t,"set");return nUe(e,n,r),r}function nUe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function Pt(e,t){var r=Bz(e,t,"get");return oUe(e,r)}function Bz(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function oUe(e,t){return t.get?t.get.call(e):t.value}var hL="nestedHeaders",iUe=280,Ft=new WeakMap,ei=new WeakMap,aUe=function(e){Z2e(r,e);var t=Q2e(r);function r(){var n;K2e(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),cL(hc(n),Ft,{writable:!0,value:new V2e}),cL(hc(n),ei,{writable:!0,value:null}),fL(hc(n),"ghostTable",new G2e(n.hot,function(l,s){return n.getHeaderSettings(l,s)})),fL(hc(n),"detectedOverlappedHeaders",!1),n}return q2e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[hL]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings(),a=i.nestedHeaders;(!Array.isArray(a)||!Array.isArray(a[0]))&&ht(ft(aL||(aL=sL([`Your Nested Headers plugin configuration is invalid. The settings has to be 
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`],[`Your Nested Headers plugin configuration is invalid. The settings has to be\\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`])))),this.addHook("init",function(){return o.onInit()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("afterOnCellMouseDown",function(){return o.onAfterOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return o.onBeforeOnCellMouseOver.apply(o,arguments)}),this.addHook("afterGetColumnHeaderRenderers",function(l){return o.onAfterGetColumnHeaderRenderers(l)}),this.addHook("modifyColWidth",function(){return o.onModifyColWidth.apply(o,arguments)}),this.addHook("modifyColumnHeaderValue",function(){return o.onModifyColumnHeaderValue.apply(o,arguments)}),this.addHook("beforeHighlightingColumnHeader",function(){return o.onBeforeHighlightingColumnHeader.apply(o,arguments)}),this.addHook("beforeCopy",function(){return o.onBeforeCopy.apply(o,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return o.onAfterViewportColumnCalculatorOverride.apply(o,arguments)}),Ca(To(r.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){var o=this;if(this.hot.view){var i=this.hot.getSettings(),a=i.nestedHeaders;Pt(this,Ft).setColumnsLimit(this.hot.countCols()),Array.isArray(a)&&(this.detectedOverlappedHeaders=Pt(this,Ft).setState(a)),this.detectedOverlappedHeaders&&ht(ft(lL||(lL=sL([`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration 
                        is currently not supported.`],[`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\\x20
                        is currently not supported.`])))),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach(function(l,s){var u=l===!0?"hide-column":"show-column";Pt(o,Ft).triggerColumnModification(u,s)}),!Pt(this,ei)&&this.enabled&&Ly(this,ei,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(function(l){l.forEach(function(s){var u=s.op,f=s.index,c=s.newValue;if(u==="replace"){var h=c===!0?"hide-column":"show-column";Pt(o,Ft).triggerColumnModification(h,f)}}),o.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),Ca(To(r.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.clearColspans(),Pt(this,Ft).clear(),Pt(this,ei).unsubscribe(),Ly(this,ei,null),this.ghostTable.clear(),Ca(To(r.prototype),"disablePlugin",this).call(this)}},{key:"getStateManager",value:function(){return Pt(this,Ft)}},{key:"getLayersCount",value:function(){return Pt(this,Ft).getLayersCount()}},{key:"getHeaderSettings",value:function(o,i){return Pt(this,Ft).getHeaderSettings(o,i)}},{key:"clearColspans",value:function(){if(this.hot.view)for(var o=this.hot.view._wt,i=o.getSetting("columnHeaders").length,a=o.wtTable.THEAD,l=o.wtOverlays.topOverlay.clone.wtTable.THEAD,s=o.wtOverlays.topInlineStartCornerOverlay?o.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,u=0;u<i;u++){var f=a.childNodes[u];if(!f)break;for(var c=l.childNodes[u],h=s?s.childNodes[u]:null,d=0,v=f.childNodes.length;d<v;d++)f.childNodes[d].removeAttribute("colspan"),Le(f.childNodes[d],"hiddenHeader"),c&&c.childNodes[d]&&(c.childNodes[d].removeAttribute("colspan"),Le(c.childNodes[d],"hiddenHeader")),s&&h&&h.childNodes[d]&&(h.childNodes[d].removeAttribute("colspan"),Le(h.childNodes[d],"hiddenHeader"))}}},{key:"headerRendererFactory",value:function(o){var i=this,a=this.hot.view._wt.getSetting("fixedColumnsStart");return function(l,s){var u,f=i.hot,c=f.columnIndexMapper,h=f.view,d=c.getVisualFromRenderableIndex(l);d===null&&(d=l),s.removeAttribute("colspan"),Le(s,"hiddenHeader");var v=(u=Pt(i,Ft).getHeaderSettings(o,d))!==null&&u!==void 0?u:{label:""},g=v.colspan,m=v.isHidden,w=v.isPlaceholder;if(w||m)re(s,"hiddenHeader");else if(g>1){var S,C,P=h._wt.wtOverlays,R=(S=P.topInlineStartCornerOverlay)===null||S===void 0?void 0:S.clone.wtTable.THEAD.contains(s),V=(C=P.inlineStartOverlay)===null||C===void 0?void 0:C.clone.wtTable.THEAD.contains(s),U=R||V?Math.min(g,a-l):g;U>1&&s.setAttribute("colspan",U)}i.hot.view.appendColHeader(d,s,function(){return i.getColumnHeaderValue.apply(i,arguments)},o)}}},{key:"getColumnHeaderValue",value:function(o,i){var a,l=(a=Pt(this,Ft).getHeaderSettings(i,o))!==null&&a!==void 0?a:{},s=l.isHidden,u=l.isPlaceholder;return u||s?"":this.hot.getColHeader(o,i)}},{key:"onBeforeHighlightingColumnHeader",value:function(o,i,a){var l=Pt(this,Ft).getHeaderTreeNodeData(i,o);if(!l)return o;var s=a.classNames,u=a.columnCursor,f=a.selectionType,c=a.selectionWidth,h=Pt(this,Ft).getHeaderSettings(i,o),d=h.isRoot,v=h.colspan;if(f===Sv){if(!d)return l.columnIndex}else f===Fm&&(v>c-u||!d)&&(s.length=0);return o}},{key:"onBeforeCopy",value:function(o,i,a){var l=a.columnHeadersCount;if(l!==0)for(var s=0;s<i.length;s++){var u=i[s],f=u.startRow,c=u.startCol,h=u.endRow,d=u.endCol,v=h-f+1,g=c-d+1;if(f>=0||g===1)break;for(var m=c;m<=d;m++)for(var w=f;w<=h;w++){var S,C=v+w,P=m-c;if(P!==0){var R=(S=Pt(this,Ft).getHeaderTreeNodeData(w,m))===null||S===void 0?void 0:S.isRoot;R===!1&&(o[C][P]="")}}}}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,l){var s=this._getHeaderTreeNodeDataByCoords(i);s&&(l.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(o,i){var a=this._getHeaderTreeNodeDataByCoords(i);if(a){var l=this.hot.selection,s=l.isSelected()?l.getSelectedRange().current():null,u=[],f=a.columnIndex,c=a.origColspan,h=!l.inInSelection(i);o.shiftKey&&s?i.col<s.from.col?u.push(s.getTopEndCorner().col,f,i.row):i.col>s.from.col?u.push(s.getTopStartCorner().col,f+c-1,i.row):u.push(f,f+c-1,i.row):(Am(o)||Ei(o)&&h)&&u.push(f,f+c-1,i.row),l.selectColumns.apply(l,u)}}},{key:"onBeforeOnCellMouseOver",value:function(o,i,a,l){var s;if(this.hot.view.isMouseDown()){var u=this._getHeaderTreeNodeDataByCoords(i);if(u){var f=u.columnIndex,c=u.origColspan,h=this.hot.getSelectedRangeLast(),d=h.getTopStartCorner(),v=h.getBottomEndCorner(),g=h.from;l.column=!0,l.cell=!0;var m=[];i.col<g.col?m.push(v.col,f):i.col>g.col?m.push(d.col,f+c-1):m.push(f,f+c-1),(s=this.hot).selectColumns.apply(s,m)}}}},{key:"onAfterGetColumnHeaderRenderers",value:function(o){o.length=0;for(var i=0;i<Pt(this,Ft).getLayersCount();i++)o.push(this.headerRendererFactory(i))}},{key:"onAfterViewportColumnCalculatorOverride",value:function(o){for(var i=Pt(this,Ft).getLayersCount(),a=o.startColumn,l=!!i,s=0;s<i;s++){var u=Pt(this,Ft).findLeftMostColumnIndex(s,o.startColumn),f=this.hot.columnIndexMapper.getRenderableFromVisualIndex(u);if(u>=0&&(l=!1),gr(f)&&f<o.startColumn){a=f;break}}o.startColumn=l?Pt(this,Ft).getHeaderTreeNodeData(0,a).columnIndex:a}},{key:"onModifyColWidth",value:function(o,i){var a=this.ghostTable.getWidth(i);return o>a?o:a}},{key:"onModifyColumnHeaderValue",value:function(o,i,a){var l,s=(l=Pt(this,Ft).getHeaderTreeNodeData(a,i))!==null&&l!==void 0?l:{label:""},u=s.label;return u}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(o,i){i||this.updatePlugin()}},{key:"destroy",value:function(){Ly(this,Ft,null),Pt(this,ei)!==null&&(Pt(this,ei).unsubscribe(),Ly(this,ei,null)),Ca(To(r.prototype),"destroy",this).call(this)}},{key:"_getHeaderTreeNodeDataByCoords",value:function(o){if(!(o.row>=0||o.col<0))return Pt(this,Ft).getHeaderTreeNodeData(o.row,o.col)}}],[{key:"PLUGIN_KEY",get:function(){return hL}},{key:"PLUGIN_PRIORITY",get:function(){return iUe}}]),r}(ot);function dL(e){return fUe(e)||uUe(e)||sUe(e)||lUe()}function lUe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sUe(e,t){if(e){if(typeof e=="string")return TR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return TR(e,t)}}function uUe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function fUe(e){if(Array.isArray(e))return TR(e)}function TR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function nf(e){"@babel/helpers - typeof";return nf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nf(e)}function cUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dUe(n.key),n)}}function hUe(e,t,r){return t&&vL(e.prototype,t),r&&vL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dUe(e){var t=vUe(e,"string");return nf(t)==="symbol"?t:String(t)}function vUe(e,t){if(nf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yUe=function(){function e(t,r){cUe(this,e),this.hot=r,this.data=null,this.plugin=t,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}}return hUe(e,[{key:"setData",value:function(r){this.data=r}},{key:"getData",value:function(){return this.data}},{key:"getRawSourceData",value:function(){var r=null;return this.plugin.disableCoreAPIModifiers(),r=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),r}},{key:"updateWithData",value:function(r){this.setData(r),this.rewriteCache()}},{key:"rewriteCache",value:function(){var r=this;this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},_e(0,this.data.length-1,function(n){r.cacheNode(r.data[n],0,null)})}},{key:"cacheNode",value:function(r,n,o){var i=this;this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(r),this.cache.rows.push(r),this.cache.nodeInfo.set(r,{parent:o,row:this.cache.rows.length-1,level:n}),this.hasChildren(r)&&$(r.__children,function(a){i.cacheNode(a,n+1,r)})}},{key:"getDataObject",value:function(r){return r==null?null:this.cache.rows[r]}},{key:"readTreeNodes",value:function(r,n,o,i){var a=this,l=!1,s=n;if(isNaN(s)&&s.end)return s;var u=r;return u||(u={__children:this.data},l=!0,s-=1),o!=null&&s===o?{result:u,end:!0}:i!=null&&u===i?{result:s,end:!0}:(s+=1,u.__children&&$(u.__children,function(f){if(a.parentReference.set(f,l?null:u),s=a.readTreeNodes(f,s,o,i),isNaN(s)&&s.end)return!1}),s)}},{key:"mockParent",value:function(){var r=this.mockNode();return r.__children=this.data,r}},{key:"mockNode",value:function(){var r={};return We(this.data[0],function(n,o){r[o]=null}),r}},{key:"getRowIndex",value:function(r){return r==null?null:this.cache.nodeInfo.get(r).row}},{key:"getRowIndexWithinParent",value:function(r){var n=null;isNaN(r)?n=r:n=this.getDataObject(r);var o=this.getRowParent(r);return o==null?this.data.indexOf(n):o.__children.indexOf(n)}},{key:"countAllRows",value:function(){var r={__children:this.data};return this.countChildren(r)}},{key:"countChildren",value:function(r){var n=this,o=0,i=r;return isNaN(i)||(i=this.getDataObject(i)),!i||!i.__children?0:($(i.__children,function(a){o+=1,a.__children&&(o+=n.countChildren(a))}),o)}},{key:"getRowParent",value:function(r){var n;return isNaN(r)?n=r:n=this.getDataObject(r),this.getRowObjectParent(n)}},{key:"getRowObjectParent",value:function(r){return!r||nf(r)!=="object"?null:this.cache.nodeInfo.get(r).parent}},{key:"getRowLevel",value:function(r){var n=null;return isNaN(r)?n=r:n=this.getDataObject(r),n?this.getRowObjectLevel(n):null}},{key:"getRowObjectLevel",value:function(r){return r==null?null:this.cache.nodeInfo.get(r).level}},{key:"hasChildren",value:function(r){var n=r;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}},{key:"isChild",value:function(r){return this.getRowParent(r)!==null}},{key:"getChild",value:function(r,n){var o;return((o=r.__children)===null||o===void 0?void 0:o[n])||null}},{key:"isRowHighestLevel",value:function(r){return!this.isChild(r)}},{key:"isParent",value:function(r){var n,o=r;return isNaN(o)||(o=this.getDataObject(o)),o&&!!o.__children&&((n=o.__children)===null||n===void 0?void 0:n.length)!==0}},{key:"addChild",value:function(r,n){var o=n;this.hot.runHooks("beforeAddChild",r,o);var i=null;r&&(i=this.getRowIndex(r)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(r)+1,1);var a=r;r||(a=this.mockParent()),a.__children||(a.__children=[]),o||(o=this.mockNode()),a.__children.push(o),this.rewriteCache();var l=this.getRowIndex(o);this.hot.rowIndexMapper.insertIndexes(l,1),this.hot.runHooks("afterCreateRow",l,1),this.hot.runHooks("afterAddChild",r,o)}},{key:"addChildAtIndex",value:function(r,n,o){var i=o,a;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",r,i,n),r){var l=this.getRowIndex(r),s=l+n+1;this.hot.runHooks("beforeCreateRow",s,1),r.__children.splice(n,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(r),"__children",r.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(s,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",s,1),a=s}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),a=this.getRowIndex(this.data[n]);i=this.getDataObject(a),this.hot.runHooks("afterAddChild",r,i,n)}},{key:"addSibling",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below",o=this.translateTrimmedRow(r),i=this.getRowParent(o),a=this.getRowIndexWithinParent(o);switch(n){case"below":this.addChildAtIndex(i,a+1,null);break;case"above":this.addChildAtIndex(i,a,null);break}}},{key:"detachFromParent",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=null,a=[];Array.isArray(r)?(_e(r[0],r[2],function(w){var S=n.translateTrimmedRow(w);a.push(n.getDataObject(S))}),_e(0,a.length-2,function(w){n.detachFromParent(a[w],!1)}),i=a[a.length-1]):i=r;var l=this.getRowIndex(i),s=this.countChildren(i),u=this.getRowIndexWithinParent(i),f=this.getRowParent(i),c=this.getRowParent(f),h=this.getRowIndex(c),d=null;if(this.hot.runHooks("beforeDetachChild",f,i),u!=null){var v=Array.from(new Array(l+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",l,s+1,v,this.plugin.pluginName),f.__children.splice(u,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",l,s+1,v,this.plugin.pluginName),c){d=h+this.countChildren(c);var g=this.getChild(c,this.countChildren(c)-1),m=this.getRowIndex(g);this.hot.runHooks("beforeCreateRow",m+1,s+1,this.plugin.pluginName),c.__children.push(i)}else d=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",d-2,s+1,this.plugin.pluginName),this.data.push(i)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",d-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",f,i,this.getRowIndex(i)),o&&this.hot.render()}},{key:"filterData",value:function(r,n,o){var i=this,a=[];$(o,function(l){a.push(i.getDataObject(l))}),$(a,function(l){var s=i.getRowIndexWithinParent(l),u=i.getRowParent(l);u===null?i.data.splice(s,1):u.__children.splice(s,1)}),this.rewriteCache()}},{key:"spliceData",value:function(r,n,o){var i=this.getDataObject(r-1),a=null,l=r;if(i&&i.__children&&i.__children.length===0?(a=i,l=0):r<this.countAllRows()&&(a=this.getRowParent(r),l=this.getRowIndexWithinParent(r)),a)if(o){var s;(s=a.__children).splice.apply(s,[l,n].concat(dL(o)))}else a.__children.splice(l,n);else if(o){var u;(u=this.data).splice.apply(u,[l,n].concat(dL(o)))}else this.data.splice(l,n);this.rewriteCache()}},{key:"syncRowWithRawSource",value:function(r){var n=r,o=null;do o=this.getRowParent(o),o!==null&&(n=o);while(o!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}},{key:"moveRow",value:function(r,n,o,i){var a=n===this.hot.countRows(),l=this.getRowParent(r),s=this.getRowIndexWithinParent(r),u=l.__children.slice(s,s+1),f=r>n,c=a?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);var h=a||o||i?c.__children.length:this.getRowIndexWithinParent(n),d=l===c;c.__children.splice(h,0,u[0]),l.__children.splice(s+(f&&d?1:0),1),this.syncRowWithRawSource(l),d||this.syncRowWithRawSource(c)}},{key:"translateTrimmedRow",value:function(r){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(r):r}},{key:"untranslateTrimmedRow",value:function(r){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(r):r}}]),e}();const gUe=yUe;function Md(e){"@babel/helpers - typeof";return Md=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Md(e)}function yL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mUe(n.key),n)}}function pUe(e,t,r){return t&&yL(e.prototype,t),r&&yL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mUe(e){var t=bUe(e,"string");return Md(t)==="symbol"?t:String(t)}function bUe(e,t){if(Md(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Md(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var SUe=pUe(function e(t,r){wUe(this,e),this.hot=r,this.plugin=t});const LP=SUe;function of(e){"@babel/helpers - typeof";return of=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},of(e)}function CUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,OUe(n.key),n)}}function _Ue(e,t,r){return t&&gL(e.prototype,t),r&&gL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function OUe(e){var t=RUe(e,"string");return of(t)==="symbol"?t:String(t)}function RUe(e,t){if(of(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(of(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function EUe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&PR(e,t)}function PR(e,t){return PR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},PR(e,t)}function TUe(e){var t=$Ue();return function(){var n=Fp(e),o;if(t){var i=Fp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return PUe(this,o)}}function PUe(e,t){if(t&&(of(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kUe(e)}function kUe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $Ue(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Fp(e){return Fp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Fp(e)}var AUe=function(e){EUe(r,e);var t=TUe(r);function r(n,o){var i;return CUe(this,r),i=t.call(this,n,o),i.dataManager=i.plugin.dataManager,i.collapsingUI=i.plugin.collapsingUI,i.rowHeaderWidthCache=null,i}return _Ue(r,[{key:"appendLevelIndicators",value:function(o,i){var a=this.hot.toPhysicalRow(o),l=this.dataManager.getRowLevel(a),s=this.dataManager.getDataObject(a),u=i.getElementsByTagName("DIV")[0],f=u.querySelector("span.rowHeader"),c=u.querySelectorAll('[class^="ht_nesting"]');if($(c,function(g){g&&u.removeChild(g)}),re(i,r.CSS_CLASSES.indicatorContainer),l){var h=this.hot.rootDocument,d=f.cloneNode(!0);u.innerHTML="",_e(0,l-1,function(){var g=h.createElement("SPAN");re(g,r.CSS_CLASSES.emptyIndicator),u.appendChild(g)}),u.appendChild(d)}if(this.dataManager.hasChildren(s)){var v=this.hot.rootDocument.createElement("DIV");re(i,r.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(a)?re(v,"".concat(r.CSS_CLASSES.button," ").concat(r.CSS_CLASSES.expandButton)):re(v,"".concat(r.CSS_CLASSES.button," ").concat(r.CSS_CLASSES.collapseButton)),u.appendChild(v)}}},{key:"updateRowHeaderWidth",value:function(o){var i=o;i||(i=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*i+25),this.hot.render()}}],[{key:"CSS_CLASSES",get:function(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}}]),r}(LP);const Vz=AUe;function af(e){"@babel/helpers - typeof";return af=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},af(e)}function pL(e){return DUe(e)||xUe(e)||MUe(e)||IUe()}function IUe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function MUe(e,t){if(e){if(typeof e=="string")return kR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return kR(e,t)}}function xUe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function DUe(e){if(Array.isArray(e))return kR(e)}function kR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function NUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,LUe(n.key),n)}}function HUe(e,t,r){return t&&mL(e.prototype,t),r&&mL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function LUe(e){var t=jUe(e,"string");return af(t)==="symbol"?t:String(t)}function jUe(e,t){if(af(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(af(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function FUe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$R(e,t)}function $R(e,t){return $R=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},$R(e,t)}function BUe(e){var t=UUe();return function(){var n=Bp(e),o;if(t){var i=Bp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return VUe(this,o)}}function VUe(e,t){if(t&&(af(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return WUe(e)}function WUe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function UUe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Bp(e){return Bp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Bp(e)}var zUe=function(e){FUe(r,e);var t=BUe(r);function r(n,o){var i;return NUe(this,r),i=t.call(this,n,o),i.dataManager=i.plugin.dataManager,i.collapsedRows=[],i.collapsedRowsStash={stash:function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;i.lastCollapsedRows=i.collapsedRows.slice(0),i.expandMultipleChildren(i.lastCollapsedRows,l)},shiftStash:function(l,s){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;s==null&&(s=1/0),$(i.lastCollapsedRows,function(f,c){f>=l&&f<s&&(i.lastCollapsedRows[c]=f+u)})},applyStash:function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;i.collapseMultipleChildren(i.lastCollapsedRows,l),i.lastCollapsedRows=void 0},trimStash:function(l,s){_e(l,l+s-1,function(u){var f=i.lastCollapsedRows.indexOf(u);f>-1&&i.lastCollapsedRows.splice(f,1)})}},i}return HUe(r,[{key:"collapseChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[],u=null,f=null,c=null;return isNaN(o)?(u=o,f=this.dataManager.getRowIndex(u)):(u=this.dataManager.getDataObject(o),f=o),this.dataManager.hasChildren(u)&&$(u.__children,function(h){s.push(i.dataManager.getRowIndex(h))}),c=this.collapseRows(s,!0,!1),l&&this.trimRows(c),a&&this.renderAndAdjust(),this.collapsedRows.indexOf(f)===-1&&this.collapsedRows.push(f),c}},{key:"collapseMultipleChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[];$(o,function(u){s.push.apply(s,pL(i.collapseChildren(u,!1,!1)))}),l&&this.trimRows(s),a&&this.renderAndAdjust()}},{key:"collapseRow",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([o],i)}},{key:"collapseRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=[];return $(o,function(u){s.push(u),a&&i.collapseChildRows(u,s)}),l&&this.trimRows(s),s}},{key:"collapseChildRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(o)){var s=this.dataManager.getDataObject(o);$(s.__children,function(u){var f=i.dataManager.getRowIndex(u);a.push(f),i.collapseChildRows(f,a)})}l&&this.trimRows(a)}},{key:"expandRow",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([o],i)}},{key:"expandRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=[];return $(o,function(u){s.push(u),a&&i.expandChildRows(u,s)}),l&&this.untrimRows(s),s}},{key:"expandChildRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(o)){var s=this.dataManager.getDataObject(o);$(s.__children,function(u){if(!i.isAnyParentCollapsed(u)){var f=i.dataManager.getRowIndex(u);a.push(f),i.expandChildRows(f,a)}})}l&&this.untrimRows(a)}},{key:"expandChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[],u=null,f=null,c=null;return isNaN(o)?(u=o,f=this.dataManager.getRowIndex(o)):(u=this.dataManager.getDataObject(o),f=o),this.collapsedRows.splice(this.collapsedRows.indexOf(f),1),this.dataManager.hasChildren(u)&&$(u.__children,function(h){var d=i.dataManager.getRowIndex(h);s.push(d)}),c=this.expandRows(s,!0,!1),l&&this.untrimRows(c),a&&this.renderAndAdjust(),c}},{key:"expandMultipleChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[];$(o,function(u){s.push.apply(s,pL(i.expandChildren(u,!1,!1)))}),l&&this.untrimRows(s),a&&this.renderAndAdjust()}},{key:"collapseAll",value:function(){var o=this,i=this.dataManager.getData(),a=[];$(i,function(l){o.dataManager.hasChildren(l)&&a.push(l)}),this.collapseMultipleChildren(a),this.renderAndAdjust()}},{key:"expandAll",value:function(){var o=this,i=this.dataManager.getData(),a=[];$(i,function(l){o.dataManager.hasChildren(l)&&a.push(l)}),this.expandMultipleChildren(a),this.renderAndAdjust()}},{key:"trimRows",value:function(o){var i=this;this.hot.batchExecution(function(){$(o,function(a){i.plugin.collapsedRowsMap.setValueAtIndex(a,!0)})},!0)}},{key:"untrimRows",value:function(o){var i=this;this.hot.batchExecution(function(){$(o,function(a){i.plugin.collapsedRowsMap.setValueAtIndex(a,!1)})},!0)}},{key:"areChildrenCollapsed",value:function(o){var i=this,a=isNaN(o)?o:this.dataManager.getDataObject(o),l=!0;return a===null&&(a={__children:this.dataManager.data}),this.dataManager.hasChildren(a)&&$(a.__children,function(s){var u=i.dataManager.getRowIndex(s);if(!i.plugin.collapsedRowsMap.getValueAtIndex(u))return l=!1,!1}),l}},{key:"isAnyParentCollapsed",value:function(o){for(var i=o;i!==null;){i=this.dataManager.getRowParent(i);var a=this.dataManager.getRowIndex(i);if(this.collapsedRows.indexOf(a)>-1)return!0}return!1}},{key:"toggleState",value:function(o,i){if(!(i.col>=0)){var a=this.translateTrimmedRow(i.row);xe(o.target,Vz.CSS_CLASSES.button)&&(this.areChildrenCollapsed(a)?this.expandChildren(a):this.collapseChildren(a),gn(o))}}},{key:"translateTrimmedRow",value:function(o){return this.hot.toPhysicalRow(o)}},{key:"untranslateTrimmedRow",value:function(o){return this.hot.toVisualRow(o)}},{key:"renderAndAdjust",value:function(){this.hot.render(),this.hot.view.adjustElementsSize()}}]),r}(LP);const YUe=zUe;function lf(e){"@babel/helpers - typeof";return lf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lf(e)}function GUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qUe(n.key),n)}}function KUe(e,t,r){return t&&bL(e.prototype,t),r&&bL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qUe(e){var t=XUe(e,"string");return lf(t)==="symbol"?t:String(t)}function XUe(e,t){if(lf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ZUe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&AR(e,t)}function AR(e,t){return AR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},AR(e,t)}function QUe(e){var t=eze();return function(){var n=Vp(e),o;if(t){var i=Vp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return JUe(this,o)}}function JUe(e,t){if(t&&(lf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Wz(e)}function Wz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eze(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Vp(e){return Vp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Vp(e)}var wL=new WeakMap,tze=function(e){ZUe(r,e);var t=QUe(r);function r(n,o){var i;return GUe(this,r),i=t.call(this,n,o),wL.set(Wz(i),{row_above:function(l,s){var u=s[s.length-1];i.dataManager.addSibling(u.start.row,"above")},row_below:function(l,s){var u=s[s.length-1];i.dataManager.addSibling(u.start.row,"below")}}),i.dataManager=i.plugin.dataManager,i}return KUe(r,[{key:"appendOptions",value:function(o){var i=this,a=[{key:"add_child",name:function(){return this.getTranslatedPhrase(ET)},callback:function(){var s=i.dataManager.translateTrimmedRow(i.hot.getSelectedLast()[0]),u=i.dataManager.getDataObject(s);i.dataManager.addChild(u)},disabled:function(){var s=i.hot.getSelectedLast();return!s||s[0]<0||i.hot.selection.isSelectedByColumnHeader()||i.hot.countRows()>=i.hot.getSettings().maxRows}},{key:"detach_from_parent",name:function(){return this.getTranslatedPhrase(TT)},callback:function(){i.dataManager.detachFromParent(i.hot.getSelectedLast())},disabled:function(){var s=i.hot.getSelectedLast(),u=i.dataManager.translateTrimmedRow(s[0]),f=i.dataManager.getRowParent(u);return!f||!s||s[0]<0||i.hot.selection.isSelectedByColumnHeader()||i.hot.countRows()>=i.hot.getSettings().maxRows}},{name:"---------"}];return _e(0,o.items.length-1,function(l){if(l===0)return $(a,function(s,u){o.items.splice(l+u,0,s)}),!1}),this.modifyRowInsertingOptions(o)}},{key:"modifyRowInsertingOptions",value:function(o){var i=wL.get(this);return _e(0,o.items.length-1,function(a){var l=i[o.items[a].key];l!=null&&(o.items[a].callback=l)}),o}}]),r}(LP);const rze=tze;function xd(e){"@babel/helpers - typeof";return xd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xd(e)}var SL;function CL(e){return aze(e)||ize(e)||oze(e)||nze()}function nze(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oze(e,t){if(e){if(typeof e=="string")return IR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return IR(e,t)}}function ize(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function aze(e){if(Array.isArray(e))return IR(e)}function IR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function lze(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function sze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _L(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fze(n.key),n)}}function uze(e,t,r){return t&&_L(e.prototype,t),r&&_L(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fze(e){var t=cze(e,"string");return xd(t)==="symbol"?t:String(t)}function cze(e,t){if(xd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hze=function(){function e(t){sze(this,e),this.plugin=t,this.hot=t.hot,this.dataManager=t.dataManager,this.collapsingUI=t.collapsingUI}return uze(e,[{key:"onBeforeRowMove",value:function(r,n,o,i){var a=this,l=this.displayAPICompatibilityWarning({rows:r,finalIndex:n,dropIndex:o,movePossible:i});if(l)return!1;this.movedToCollapsed=!1;var s=o===this.hot.countRows(),u=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(o),f=!0,c=r.map(function(m){if(!f)return!1;var w=a.dataManager.translateTrimmedRow(m);return f=a.shouldAllowMoving(w,u),w}),h=c.indexOf(u)===-1;if(!f||!h)return!1;var d=this.getBaseParent(c),v=this.getTargetParent(s,u),g=d===v;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(v),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(c,u,g),this.moveRows(c,u,v),this.dataManager.rewriteCache(),this.moveCellsMeta(c,u),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",r,n,o,i,i&&this.isRowOrderChanged(r,n)),this.hot.render(),this.selectCells(r,o),!1}},{key:"displayAPICompatibilityWarning",value:function(r){var n=r.rows,o=r.finalIndex,i=r.dropIndex,a=r.movePossible,l=!1;return gt(i)&&(ht(ft(SL||(SL=lze([`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows 
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`],[`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`])))),this.hot.runHooks("afterRowMove",n,o,i,a,!1),l=!0),l}},{key:"shouldAllowMoving",value:function(r,n){return!(this.dataManager.isParent(r)||this.dataManager.isRowHighestLevel(r)||r===n||n===0)}},{key:"getBaseParent",value:function(r){return this.dataManager.getRowParent(r[0])}},{key:"getTargetParent",value:function(r,n){var o=this.dataManager.getRowParent(r?n-1:n);return o==null&&(o=this.dataManager.getRowParent(n-1)),o}},{key:"shiftCollapsibleParentsLocations",value:function(r,n,o){o||(Math.max.apply(Math,CL(r))<=n?this.collapsingUI.collapsedRowsStash.shiftStash(r[0],n,-1*r.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,r[0],r.length))}},{key:"moveRows",value:function(r,n,o){var i=this,a=n===this.dataManager.getRowIndex(o)+this.dataManager.countChildren(o)+1;this.hot.batchRender(function(){r.forEach(function(l){i.dataManager.moveRow(l,n,i.movedToCollapsed,a)})})}},{key:"moveCellsMeta",value:function(r,n){var o=this,i,a=[],l=Math.max.apply(Math,CL(r))<n;r.forEach(function(s){a.push(o.hot.getCellMetaAtRow(s))}),this.hot.spliceCellsMeta(r[0],r.length),(i=this.hot).spliceCellsMeta.apply(i,[n-(l?a.length:0),0].concat(a))}},{key:"selectCells",value:function(r,n){var o=r.length,i=0,a=0,l=null,s=null;if(this.movedToCollapsed){var u=null;r[o-1]<n?u=this.dataManager.translateTrimmedRow(n-o):u=this.dataManager.translateTrimmedRow(n);var f=this.dataManager.getRowParent(u===null?this.hot.countSourceRows()-1:u-1),c=this.dataManager.getRowIndex(f);i=this.dataManager.untranslateTrimmedRow(c),a=i}else r[o-1]<n?(a=n-1,i=a-o+1):(i=n,a=i+o-1);l=this.hot.selection,s=this.hot.countCols()-1,l.setRangeStart(this.hot._createCellCoords(i,0)),l.setRangeEnd(this.hot._createCellCoords(a,s),!0)}},{key:"isRowOrderChanged",value:function(r,n){return r.some(function(o,i){return o-i!==n})}}]),e}();function sf(e){"@babel/helpers - typeof";return sf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sf(e)}function dze(e){return pze(e)||gze(e)||yze(e)||vze()}function vze(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yze(e,t){if(e){if(typeof e=="string")return MR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return MR(e,t)}}function gze(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function pze(e){if(Array.isArray(e))return MR(e)}function MR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function mze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wze(n.key),n)}}function bze(e,t,r){return t&&OL(e.prototype,t),r&&OL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wze(e){var t=Sze(e,"string");return sf(t)==="symbol"?t:String(t)}function Sze(e,t){if(sf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _a(){return typeof Reflect<"u"&&Reflect.get?_a=Reflect.get.bind():_a=function(t,r,n){var o=Cze(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_a.apply(this,arguments)}function Cze(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Po(e),e!==null););return e}function _ze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xR(e,t)}function xR(e,t){return xR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},xR(e,t)}function Oze(e){var t=Eze();return function(){var n=Po(e),o;if(t){var i=Po(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Rze(this,o)}}function Rze(e,t){if(t&&(sf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Uz(e)}function Uz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Eze(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Po(e){return Po=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Po(e)}var DS="nestedRows",Tze=300,Qn=new WeakMap,Pze="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.",kze=function(e){_ze(r,e);var t=Oze(r);function r(n){var o;return mze(this,r),o=t.call(this,n),o.dataManager=null,o.headersUI=null,o.collapsedRowsMap=null,Qn.set(Uz(o),{movedToCollapsed:!1,skipRender:null,skipCoreAPIModifiers:!1}),o}return bze(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[DS]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new wv),this.dataManager=new gUe(this,this.hot),this.collapsingUI=new YUe(this,this.hot),this.headersUI=new Vz(this,this.hot),this.contextMenuUI=new rze(this,this.hot),this.rowMoveController=new hze(this),this.addHook("afterInit",function(){return o.onAfterInit.apply(o,arguments)}),this.addHook("beforeViewRender",function(){return o.onBeforeViewRender.apply(o,arguments)}),this.addHook("modifyRowData",function(){return o.onModifyRowData.apply(o,arguments)}),this.addHook("modifySourceLength",function(){return o.onModifySourceLength.apply(o,arguments)}),this.addHook("beforeDataSplice",function(){return o.onBeforeDataSplice.apply(o,arguments)}),this.addHook("filterData",function(){return o.onFilterData.apply(o,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return o.onAfterContextMenuDefaultOptions.apply(o,arguments)}),this.addHook("afterGetRowHeader",function(){return o.onAfterGetRowHeader.apply(o,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeRemoveRow",function(){return o.onBeforeRemoveRow.apply(o,arguments)}),this.addHook("afterRemoveRow",function(){return o.onAfterRemoveRow.apply(o,arguments)}),this.addHook("beforeAddChild",function(){return o.onBeforeAddChild.apply(o,arguments)}),this.addHook("afterAddChild",function(){return o.onAfterAddChild.apply(o,arguments)}),this.addHook("beforeDetachChild",function(){return o.onBeforeDetachChild.apply(o,arguments)}),this.addHook("afterDetachChild",function(){return o.onAfterDetachChild.apply(o,arguments)}),this.addHook("modifyRowHeaderWidth",function(){return o.onModifyRowHeaderWidth.apply(o,arguments)}),this.addHook("afterCreateRow",function(){return o.onAfterCreateRow.apply(o,arguments)}),this.addHook("beforeRowMove",function(){return o.onBeforeRowMove.apply(o,arguments)}),this.addHook("beforeLoadData",function(i){return o.onBeforeLoadData(i)}),this.addHook("beforeUpdateData",function(i){return o.onBeforeLoadData(i)}),_a(Po(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),_a(Po(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin();var o=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(o),_a(Po(r.prototype),"updatePlugin",this).call(this)}},{key:"onBeforeRowMove",value:function(o,i,a,l){return this.rowMoveController.onBeforeRowMove(o,i,a,l)}},{key:"disableCoreAPIModifiers",value:function(){var o=Qn.get(this);o.skipCoreAPIModifiers=!0}},{key:"enableCoreAPIModifiers",value:function(){var o=Qn.get(this);o.skipCoreAPIModifiers=!1}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a){this.collapsingUI.toggleState(o,i,a)}},{key:"onModifyRowData",value:function(o){var i=Qn.get(this);if(!i.skipCoreAPIModifiers)return this.dataManager.getDataObject(o)}},{key:"onModifySourceLength",value:function(){var o=Qn.get(this);if(!o.skipCoreAPIModifiers)return this.dataManager.countAllRows()}},{key:"onBeforeDataSplice",value:function(o,i,a){var l=Qn.get(this);return l.skipCoreAPIModifiers||this.dataManager.isRowHighestLevel(o)?!0:(this.dataManager.spliceData(o,i,a),!1)}},{key:"onFilterData",value:function(o,i,a){var l=Qn.get(this);return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(a[0],i),this.collapsingUI.collapsedRowsStash.shiftStash(a[0],null,-1*i),this.dataManager.filterData(o,i,a),l.skipRender=!0,this.dataManager.getData().slice()}},{key:"onAfterContextMenuDefaultOptions",value:function(o){return this.contextMenuUI.appendOptions(o)}},{key:"onAfterGetRowHeader",value:function(o,i){this.headersUI.appendLevelIndicators(o,i)}},{key:"onModifyRowHeaderWidth",value:function(o){return this.headersUI.rowHeaderWidthCache||o}},{key:"onAfterRemoveRow",value:function(o,i,a,l){var s=this;if(l!==this.pluginName){var u=Qn.get(this);setTimeout(function(){u.skipRender=null,s.headersUI.updateRowHeaderWidth(),s.collapsingUI.collapsedRowsStash.applyStash()},0)}}},{key:"onBeforeRemoveRow",value:function(o,i,a){var l=this,s=Array.from(a.reduce(function(u,f){if(l.dataManager.isParent(f)){var c=l.dataManager.getDataObject(f).__children;return u.add(f),Array.isArray(c)&&c.forEach(function(h){return u.add(l.dataManager.getRowIndex(h))}),u}return u.add(f)},new Set));a.length=0,a.push.apply(a,s)}},{key:"onBeforeAddChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterAddChild",value:function(o,i){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(i)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onBeforeDetachChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterDetachChild",value:function(o,i,a){this.collapsingUI.collapsedRowsStash.shiftStash(a,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onAfterCreateRow",value:function(){this.dataManager.rewriteCache()}},{key:"onAfterInit",value:function(){var o=Math.max.apply(Math,dze(this.dataManager.cache.levels));o>0&&this.headersUI.updateRowHeaderWidth(o)}},{key:"onBeforeViewRender",value:function(o,i){var a=Qn.get(this);a.skipRender&&(i.skipRender=!0)}},{key:"destroy",value:function(){_a(Po(r.prototype),"destroy",this).call(this)}},{key:"onBeforeLoadData",value:function(o){if(!zW(o)){gE(Pze),this.hot.getSettings()[DS]=!1,this.disablePlugin();return}this.dataManager.setData(o),this.dataManager.rewriteCache()}}],[{key:"PLUGIN_KEY",get:function(){return DS}},{key:"PLUGIN_PRIORITY",get:function(){return Tze}}]),r}(ot);function Dd(e){"@babel/helpers - typeof";return Dd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dd(e)}function $ze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ize(n.key),n)}}function Aze(e,t,r){return t&&RL(e.prototype,t),r&&RL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ize(e){var t=Mze(e,"string");return Dd(t)==="symbol"?t:String(t)}function Mze(e,t){if(Dd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Dd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xze=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;$ze(this,e),this.rootWindow=r,this.prefix=t,this.savedKeys=[],this.loadSavedKeys()}return Aze(e,[{key:"saveValue",value:function(r,n){this.rootWindow.localStorage.setItem("".concat(this.prefix,"_").concat(r),JSON.stringify(n)),this.savedKeys.indexOf(r)===-1&&(this.savedKeys.push(r),this.saveSavedKeys())}},{key:"loadValue",value:function(r,n){var o=typeof r>"u"?n:r,i=this.rootWindow.localStorage.getItem("".concat(this.prefix,"_").concat(o));return i===null?void 0:JSON.parse(i)}},{key:"reset",value:function(r){this.rootWindow.localStorage.removeItem("".concat(this.prefix,"_").concat(r))}},{key:"resetAll",value:function(){var r=this;$(this.savedKeys,function(n,o){r.rootWindow.localStorage.removeItem("".concat(r.prefix,"_").concat(r.savedKeys[o]))}),this.clearSavedKeys()}},{key:"loadSavedKeys",value:function(){var r=this.rootWindow.localStorage.getItem("".concat(this.prefix,"__persistentStateKeys")),n=typeof r=="string"?JSON.parse(r):void 0;this.savedKeys=n||[]}},{key:"saveSavedKeys",value:function(){this.rootWindow.localStorage.setItem("".concat(this.prefix,"__persistentStateKeys"),JSON.stringify(this.savedKeys))}},{key:"clearSavedKeys",value:function(){this.savedKeys.length=0,this.saveSavedKeys()}}]),e}();const Dze=xze;function uf(e){"@babel/helpers - typeof";return uf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uf(e)}function Nze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Lze(n.key),n)}}function Hze(e,t,r){return t&&EL(e.prototype,t),r&&EL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Lze(e){var t=jze(e,"string");return uf(t)==="symbol"?t:String(t)}function jze(e,t){if(uf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(uf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Oa(){return typeof Reflect<"u"&&Reflect.get?Oa=Reflect.get.bind():Oa=function(t,r,n){var o=Fze(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Oa.apply(this,arguments)}function Fze(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ko(e),e!==null););return e}function Bze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&DR(e,t)}function DR(e,t){return DR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},DR(e,t)}function Vze(e){var t=zze();return function(){var n=ko(e),o;if(t){var i=ko(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Wze(this,o)}}function Wze(e,t){if(t&&(uf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Uze(e)}function Uze(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zze(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ko(e){return ko=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ko(e)}pe.getSingleton().register("persistentStateSave");pe.getSingleton().register("persistentStateLoad");pe.getSingleton().register("persistentStateReset");var TL="persistentState",Yze=0,Gze=function(e){Bze(r,e);var t=Vze(r);function r(n){var o;return Nze(this,r),o=t.call(this,n),o.storage=void 0,o}return Hze(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[TL]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.storage||(this.storage=new Dze(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",function(i,a){return o.saveValue(i,a)}),this.addHook("persistentStateLoad",function(i,a){return o.loadValue(i,a)}),this.addHook("persistentStateReset",function(){return o.resetValue()}),Oa(ko(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.storage=void 0,Oa(ko(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Oa(ko(r.prototype),"updatePlugin",this).call(this)}},{key:"loadValue",value:function(o,i){i.value=this.storage.loadValue(o)}},{key:"saveValue",value:function(o,i){this.storage.saveValue(o,i)}},{key:"resetValue",value:function(o){typeof o>"u"?this.storage.resetAll():this.storage.reset(o)}},{key:"destroy",value:function(){Oa(ko(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return TL}},{key:"PLUGIN_PRIORITY",get:function(){return Yze}}]),r}(ot);function ff(e){"@babel/helpers - typeof";return ff=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ff(e)}function Kze(e){return Qze(e)||Zze(e)||Xze(e)||qze()}function qze(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Xze(e,t){if(e){if(typeof e=="string")return NR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return NR(e,t)}}function Zze(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Qze(e){if(Array.isArray(e))return NR(e)}function NR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Jze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tYe(n.key),n)}}function eYe(e,t,r){return t&&PL(e.prototype,t),r&&PL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tYe(e){var t=rYe(e,"string");return ff(t)==="symbol"?t:String(t)}function rYe(e,t){if(ff(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ff(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ra(){return typeof Reflect<"u"&&Reflect.get?Ra=Reflect.get.bind():Ra=function(t,r,n){var o=nYe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ra.apply(this,arguments)}function nYe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=$o(e),e!==null););return e}function oYe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&HR(e,t)}function HR(e,t){return HR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},HR(e,t)}function iYe(e){var t=sYe();return function(){var n=$o(e),o;if(t){var i=$o(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return aYe(this,o)}}function aYe(e,t){if(t&&(ff(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lYe(e)}function lYe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sYe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function $o(e){return $o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$o(e)}var NS="search",uYe=190,fYe="htSearchResult",cYe=function(t,r,n,o,i){t.getCellMeta(r,n).isSearchResult=i},hYe=function(t,r,n){return gt(t)||t===null||!t.toLocaleLowerCase||t.length===0||gt(r)||r===null?!1:r.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1},dYe=function(e){oYe(r,e);var t=iYe(r);function r(n){var o;return Jze(this,r),o=t.call(this,n),o.callback=cYe,o.queryMethod=hYe,o.searchResultClass=fYe,o}return eYe(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[NS]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[NS];this.updatePluginSettings(i),this.addHook("beforeRenderer",function(){return o.onBeforeRenderer.apply(o,arguments)}),Ra($o(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var o=this,i=function(){return o.onBeforeRenderer.apply(o,arguments)};this.hot.addHook("beforeRenderer",i),this.hot.addHookOnce("afterViewRender",function(){o.hot.removeHook("beforeRenderer",i)}),Ra($o(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Ra($o(r.prototype),"updatePlugin",this).call(this)}},{key:"query",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod(),s=this.hot.countRows(),u=this.hot.countCols(),f=[],c=this.hot;return _e(0,s-1,function(h){_e(0,u-1,function(d){var v=i.hot.getDataAtCell(h,d),g=i.hot.getCellMeta(h,d),m=g.search.callback||a,w=g.search.queryMethod||l,S=w(o,v,g);if(S){var C={row:h,col:d,data:v};f.push(C)}m&&m(c,h,d,v,S)})}),f}},{key:"getCallback",value:function(){return this.callback}},{key:"setCallback",value:function(o){this.callback=o}},{key:"getQueryMethod",value:function(){return this.queryMethod}},{key:"setQueryMethod",value:function(o){this.queryMethod=o}},{key:"getSearchResultClass",value:function(){return this.searchResultClass}},{key:"setSearchResultClass",value:function(o){this.searchResultClass=o}},{key:"updatePluginSettings",value:function(o){Ve(o)&&(o.searchResultClass&&this.setSearchResultClass(o.searchResultClass),o.queryMethod&&this.setQueryMethod(o.queryMethod),o.callback&&this.setCallback(o.callback))}},{key:"onBeforeRenderer",value:function(o,i,a,l,s,u){var f=u.className||[],c=[];if(typeof f=="string")c=f.split(" ");else{var h;(h=c).push.apply(h,Kze(f))}this.isEnabled()&&u.isSearchResult?c.includes(this.searchResultClass)||c.push("".concat(this.searchResultClass)):c.includes(this.searchResultClass)&&c.splice(c.indexOf(this.searchResultClass),1),u.className=c.join(" ")}},{key:"destroy",value:function(){Ra($o(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return NS}},{key:"PLUGIN_PRIORITY",get:function(){return uYe}}]),r}(ot);function cf(e){"@babel/helpers - typeof";return cf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cf(e)}function vYe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gYe(n.key),n)}}function yYe(e,t,r){return t&&kL(e.prototype,t),r&&kL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gYe(e){var t=pYe(e,"string");return cf(t)==="symbol"?t:String(t)}function pYe(e,t){if(cf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ns(){return typeof Reflect<"u"&&Reflect.get?ns=Reflect.get.bind():ns=function(t,r,n){var o=mYe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ns.apply(this,arguments)}function mYe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_i(e),e!==null););return e}function bYe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&LR(e,t)}function LR(e,t){return LR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},LR(e,t)}function wYe(e){var t=_Ye();return function(){var n=_i(e),o;if(t){var i=_i(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return SYe(this,o)}}function SYe(e,t){if(t&&(cf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return CYe(e)}function CYe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _Ye(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _i(e){return _i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_i(e)}var OYe="touchScroll",RYe=200,EYe=function(e){bYe(r,e);var t=wYe(r);function r(n){var o;return vYe(this,r),o=t.call(this,n),o.scrollbars=[],o.clones=[],o.lockedCollection=!1,o.freezeOverlays=!1,o}return yYe(r,[{key:"isEnabled",value:function(){return D0()}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterViewRender",function(){return o.onAfterViewRender()}),this.registerEvents(),ns(_i(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.lockedCollection=!1,ns(_i(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){ns(_i(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var o=this;this.addHook("beforeTouchScroll",function(){return o.onBeforeTouchScroll()}),this.addHook("afterMomentumScroll",function(){return o.onAfterMomentumScroll()})}},{key:"onAfterViewRender",value:function(){if(!this.lockedCollection){var o=this.hot.view._wt.wtOverlays,i=o.topOverlay,a=o.bottomOverlay,l=o.inlineStartOverlay,s=o.topInlineStartCornerOverlay,u=o.bottomInlineStartCornerOverlay;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(i),a.clone&&this.scrollbars.push(a),this.scrollbars.push(l),s&&this.scrollbars.push(s),u&&u.clone&&this.scrollbars.push(u),this.clones=[],i.needFullRender&&this.clones.push(i.clone.wtTable.holder.parentNode),a.needFullRender&&this.clones.push(a.clone.wtTable.holder.parentNode),l.needFullRender&&this.clones.push(l.clone.wtTable.holder.parentNode),s&&this.clones.push(s.clone.wtTable.holder.parentNode),u&&u.clone&&this.clones.push(u.clone.wtTable.holder.parentNode)}}},{key:"onBeforeTouchScroll",value:function(){this.freezeOverlays=!0,$(this.clones,function(o){re(o,"hide-tween")})}},{key:"onAfterMomentumScroll",value:function(){var o=this;this.freezeOverlays=!1,$(this.clones,function(i){Le(i,"hide-tween"),re(i,"show-tween")}),this.hot._registerTimeout(function(){$(o.clones,function(i){Le(i,"show-tween")})},400),$(this.scrollbars,function(i){i.refresh(),i.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}}],[{key:"PLUGIN_KEY",get:function(){return OYe}},{key:"PLUGIN_PRIORITY",get:function(){return RYe}},{key:"SETTING_KEYS",get:function(){return!0}}]),r}(ot);function hf(e){"@babel/helpers - typeof";return hf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hf(e)}function TYe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $L(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kYe(n.key),n)}}function PYe(e,t,r){return t&&$L(e.prototype,t),r&&$L(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kYe(e){var t=$Ye(e,"string");return hf(t)==="symbol"?t:String(t)}function $Ye(e,t){if(hf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ea(){return typeof Reflect<"u"&&Reflect.get?Ea=Reflect.get.bind():Ea=function(t,r,n){var o=AYe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ea.apply(this,arguments)}function AYe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ao(e),e!==null););return e}function IYe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jR(e,t)}function jR(e,t){return jR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},jR(e,t)}function MYe(e){var t=NYe();return function(){var n=Ao(e),o;if(t){var i=Ao(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return xYe(this,o)}}function xYe(e,t){if(t&&(hf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return DYe(e)}function DYe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function NYe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ao(e){return Ao=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ao(e)}var jy="trimRows",HYe=330,LYe=function(e){IYe(r,e);var t=MYe(r);function r(n){var o;return TYe(this,r),o=t.call(this,n),o.trimmedRowsMap=null,o}return PYe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[jy]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new wv),this.trimmedRowsMap.addLocalHook("init",function(){return o.onMapInit()}),Ea(Ao(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){var o=this,i=this.hot.getSettings()[jy];Array.isArray(i)&&this.hot.batchExecution(function(){o.trimmedRowsMap.clear(),$(i,function(a){o.trimmedRowsMap.setValueAtIndex(a,!0)})},!0),Ea(Ao(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("trimRows"),Ea(Ao(r.prototype),"disablePlugin",this).call(this)}},{key:"getTrimmedRows",value:function(){return this.trimmedRowsMap.getTrimmedIndexes()}},{key:"trimRows",value:function(o){var i=this,a=this.getTrimmedRows(),l=this.isValidConfig(o),s=a;l&&(s=Array.from(new Set(a.concat(o))));var u=this.hot.runHooks("beforeTrimRow",a,s,l);u!==!1&&(l&&this.hot.batchExecution(function(){$(o,function(f){i.trimmedRowsMap.setValueAtIndex(f,!0)})},!0),this.hot.runHooks("afterTrimRow",a,s,l,l&&s.length>a.length))}},{key:"trimRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.trimRows(i)}},{key:"untrimRows",value:function(o){var i=this.getTrimmedRows(),a=this.isValidConfig(o),l=i,s=this.trimmedRowsMap.getValues().slice(),u=o.length>0;a&&u&&($(o,function(c){s[c]=!1}),l=Lt(s,function(c,h,d){return h&&c.push(d),c},[]));var f=this.hot.runHooks("beforeUntrimRow",i,l,a&&u);f!==!1&&(a&&u&&this.trimmedRowsMap.setValues(s),this.hot.runHooks("afterUntrimRow",i,l,a&&u,a&&l.length<i.length))}},{key:"untrimRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.untrimRows(i)}},{key:"isTrimmed",value:function(o){return this.trimmedRowsMap.getValueAtIndex(o)||!1}},{key:"untrimAll",value:function(){this.untrimRows(this.getTrimmedRows())}},{key:"isValidConfig",value:function(o){var i=this.hot.countSourceRows();return o.every(function(a){return Number.isInteger(a)&&a>=0&&a<i})}},{key:"onMapInit",value:function(){var o=this,i=this.hot.getSettings()[jy];Array.isArray(i)&&this.hot.batchExecution(function(){$(i,function(a){o.trimmedRowsMap.setValueAtIndex(a,!0)})},!0)}},{key:"destroy",value:function(){Ea(Ao(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return jy}},{key:"PLUGIN_PRIORITY",get:function(){return HYe}}]),r}(ot);function df(e){"@babel/helpers - typeof";return df=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},df(e)}function zz(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jYe(n.key),n)}}function Yz(e,t,r){return t&&AL(e.prototype,t),r&&AL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jYe(e){var t=FYe(e,"string");return df(t)==="symbol"?t:String(t)}function FYe(e,t){if(df(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(df(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gz(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&FR(e,t)}function FR(e,t){return FR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},FR(e,t)}function Kz(e){var t=WYe();return function(){var n=Wp(e),o;if(t){var i=Wp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return BYe(this,o)}}function BYe(e,t){if(t&&(df(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return VYe(e)}function VYe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function WYe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Wp(e){return Wp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Wp(e)}function UYe(e){return GYe(e)||YYe(e)||Xz(e)||zYe()}function zYe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function YYe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function GYe(e){if(Array.isArray(e))return BR(e)}function qz(e,t){return XYe(e)||qYe(e,t)||Xz(e,t)||KYe()}function KYe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Xz(e,t){if(e){if(typeof e=="string")return BR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return BR(e,t)}}function BR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function qYe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function XYe(e){if(Array.isArray(e))return e}var Zz="undoRedo",ZYe="undoRedo";function ye(e){var t=this;this.instance=e,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,e.addHook("afterChange",function(r,n){var o=this,i=r&&r.length;if(i){var a=r.find(function(s){var u=qz(s,4),f=u[2],c=u[3];return f!==c});if(a){var l=function(){var u=r.reduce(function(c,h){return c.push(UYe(h)),c},[]);$(u,function(c){c[1]=e.propToCol(c[1])});var f=i>1?o.getSelected():[[u[0][0],u[0][1]]];return new ye.ChangeAction(u,f)};t.done(l,n)}}}),e.addHook("afterCreateRow",function(r,n,o){t.done(function(){return new ye.CreateRowAction(r,n)},o)}),e.addHook("beforeRemoveRow",function(r,n,o,i){var a=function(){var s=e.toPhysicalRow(r),u=lr(t.instance.getSourceData(s,0,s+n-1,t.instance.countSourceCols()-1));return new ye.RemoveRowAction(s,u,e.getSettings().fixedRowsBottom,e.getSettings().fixedRowsTop,e.rowIndexMapper.getIndexesSequence())};t.done(a,i)}),e.addHook("afterCreateCol",function(r,n,o){t.done(function(){return new ye.CreateColumnAction(r,n)},o)}),e.addHook("beforeRemoveCol",function(r,n,o,i){var a=function(){var s=t.instance.getSourceDataArray(),u=(t.instance.countCols()+r)%t.instance.countCols(),f=[],c=[],h=[];_e(s.length-1,function(g){var m=[],w=s[g];_e(u,u+(n-1),function(S){m.push(w[e.toPhysicalColumn(S)])}),f.push(m)}),_e(n-1,function(g){h.push(e.toPhysicalColumn(u+g))}),Array.isArray(e.getSettings().colHeaders)&&_e(n-1,function(g){c.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+g)]||null)});var d=e.columnIndexMapper.getIndexesSequence(),v=e.rowIndexMapper.getIndexesSequence();return new ye.RemoveColumnAction(u,h,f,c,d,v,e.getSettings().fixedColumnsStart)};t.done(a,i)}),e.addHook("beforeCellAlignment",function(r,n,o,i){t.done(function(){return new ye.CellAlignmentAction(r,n,o,i)})}),e.addHook("beforeFilter",function(r){t.done(function(){return new ye.FiltersAction(r)})}),e.addHook("beforeRowMove",function(r,n){r!==!1&&t.done(function(){return new ye.RowMoveAction(r,n)})}),e.addHook("beforeMergeCells",function(r,n){n||t.done(function(){return new ye.MergeCellsAction(e,r)})}),e.addHook("afterUnmergeCells",function(r,n){n||t.done(function(){return new ye.UnmergeCellsAction(e,r)})}),e.addHook("afterInit",function(){t.init()})}ye.prototype.done=function(e,t){if(!this.ignoreNewActions){var r=t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";if(!r){var n=this.doneActions.slice(),o=this.instance.runHooks("beforeUndoStackChange",n,t);if(o!==!1){var i=e(),a=this.undoneActions.slice();this.doneActions.push(i),this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}}}};ye.prototype.undo=function(){if(this.isUndoAvailable()){var e=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",e);var t=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",e,this.doneActions.slice());var r=lr(t),n=this.instance.runHooks("beforeUndo",r);if(n===!1)return;this.ignoreNewActions=!0;var o=this,i=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",i),t.undo(this.instance,function(){o.ignoreNewActions=!1,o.undoneActions.push(t)}),this.instance.runHooks("afterRedoStackChange",i,this.undoneActions.slice()),this.instance.runHooks("afterUndo",r)}};ye.prototype.redo=function(){if(this.isRedoAvailable()){var e=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",e);var t=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",e,this.undoneActions.slice());var r=lr(t),n=this.instance.runHooks("beforeRedo",r);if(n===!1)return;this.ignoreNewActions=!0;var o=this,i=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",i),t.redo(this.instance,function(){o.ignoreNewActions=!1,o.doneActions.push(t)}),this.instance.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.instance.runHooks("afterRedo",r)}};ye.prototype.isUndoAvailable=function(){return this.doneActions.length>0};ye.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};ye.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};ye.prototype.isEnabled=function(){return this.enabled};ye.prototype.enable=function(){if(!this.isEnabled()){var e=this.instance;this.enabled=!0,eGe(e),this.registerShortcuts(),e.addHook("afterChange",Qz)}};ye.prototype.disable=function(){if(this.isEnabled()){var e=this.instance;this.enabled=!1,tGe(e),this.unregisterShortcuts(),e.removeHook("afterChange",Qz)}};ye.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};ye.Action=function(){};ye.Action.prototype.undo=function(){};ye.Action.prototype.redo=function(){};ye.ChangeAction=function(e,t){this.changes=e,this.selected=t,this.actionType="change"};Fo(ye.ChangeAction,ye.Action);ye.ChangeAction.prototype.undo=function(e,t){for(var r=lr(this.changes),n=e.countEmptyRows(!0),o=e.countEmptyCols(!0),i=0,a=r.length;i<a;i++)r[i].splice(3,1);e.addHookOnce("afterChange",t),e.setDataAtCell(r,null,null,"UndoRedo.undo");for(var l=0,s=r.length;l<s;l++){var u=qz(r[l],2),f=u[0],c=u[1];e.getSettings().minSpareRows&&f+1+e.getSettings().minSpareRows===e.countRows()&&n===e.getSettings().minSpareRows&&(e.alter("remove_row",parseInt(f+1,10),e.getSettings().minSpareRows),e.undoRedo.doneActions.pop()),e.getSettings().minSpareCols&&c+1+e.getSettings().minSpareCols===e.countCols()&&o===e.getSettings().minSpareCols&&(e.alter("remove_col",parseInt(c+1,10),e.getSettings().minSpareCols),e.undoRedo.doneActions.pop())}e.selectCells(this.selected,!1,!1)};ye.ChangeAction.prototype.redo=function(e,t){for(var r=lr(this.changes),n=0,o=r.length;n<o;n++)r[n].splice(2,1);e.addHookOnce("afterChange",t),e.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)};ye.CreateRowAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_row"};Fo(ye.CreateRowAction,ye.Action);ye.CreateRowAction.prototype.undo=function(e,t){var r=e.countRows(),n=e.getSettings().minSpareRows;this.index>=r&&this.index-n<r&&(this.index-=n),e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};ye.CreateRowAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};ye.RemoveRowAction=function(e,t,r,n,o){this.index=e,this.data=t,this.actionType="remove_row",this.fixedRowsBottom=r,this.fixedRowsTop=n,this.rowIndexesSequence=o};Fo(ye.RemoveRowAction,ye.Action);ye.RemoveRowAction.prototype.undo=function(e,t){var r=this,n=e.getSettings(),o=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach(function(i,a){Object.keys(i).forEach(function(l){var s=parseInt(l,10);o.push([r.index+a,isNaN(s)?l:s,i[l]])})}),e.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),e.addHookOnce("afterViewRender",t),e.setSourceDataAtCell(o,null,null,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};ye.RemoveRowAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};ye.CreateColumnAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_col"};Fo(ye.CreateColumnAction,ye.Action);ye.CreateColumnAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};ye.CreateColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};ye.RemoveColumnAction=function(e,t,r,n,o,i,a){this.index=e,this.indexes=t,this.data=r,this.amount=this.data[0].length,this.headers=n,this.columnPositions=o.slice(0),this.rowPositions=i.slice(0),this.actionType="remove_col",this.fixedColumnsStart=a};Fo(ye.RemoveColumnAction,ye.Action);ye.RemoveColumnAction.prototype.undo=function(e,t){var r=this,n=e.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;for(var o=this.indexes.slice(0).sort(),i=function(h,d,v){return v[r.indexes.indexOf(o[d])]},a=this.data.length,l=[],s=0;s<a;s++)l.push(Be(this.data[s],i));var u=Be(this.headers,i),f=[];e.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),$(e.getSourceDataArray(),function(c,h){$(o,function(d,v){c[d]=l[h][v],f.push([h,d,c[d]])})}),e.setSourceDataAtCell(f,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&$(u,function(c,h){e.getSettings().colHeaders[o[h]]=c}),e.batchExecution(function(){e.rowIndexMapper.setIndexesSequence(r.rowPositions),e.columnIndexMapper.setIndexesSequence(r.columnPositions)},!0),e.addHookOnce("afterViewRender",t),e.render()};ye.RemoveColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};ye.CellAlignmentAction=function(e,t,r,n){this.stateBefore=e,this.range=t,this.type=r,this.alignment=n};ye.CellAlignmentAction.prototype.undo=function(e,t){var r=this;$(this.range,function(n){n.forAll(function(o,i){o>=0&&i>=0&&e.setCellMeta(o,i,"className",r.stateBefore[o][i]||" htLeft")})}),e.addHookOnce("afterViewRender",t),e.render()};ye.CellAlignmentAction.prototype.redo=function(e,t){ri(this.range,this.type,this.alignment,function(r,n){return e.getCellMeta(r,n)},function(r,n,o,i){return e.setCellMeta(r,n,o,i)}),e.addHookOnce("afterViewRender",t),e.render()};ye.FiltersAction=function(e){this.conditionsStack=e,this.actionType="filter"};Fo(ye.FiltersAction,ye.Action);ye.FiltersAction.prototype.undo=function(e,t){var r=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),r.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),r.filter()};ye.FiltersAction.prototype.redo=function(e,t){var r=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),r.conditionCollection.importAllConditions(this.conditionsStack),r.filter()};var QYe=function(e){Gz(r,e);var t=Kz(r);function r(n,o){var i;zz(this,r),i=t.call(this),i.cellRange=o;var a=i.cellRange.getTopStartCorner(),l=i.cellRange.getBottomEndCorner();return i.rangeData=n.getData(a.row,a.col,l.row,l.col),i}return Yz(r,[{key:"undo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.unmergeRange(this.cellRange,!0);var l=this.cellRange.getTopStartCorner();o.populateFromArray(l.row,l.col,this.rangeData,void 0,void 0,"MergeCells")}},{key:"redo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.mergeRange(this.cellRange)}}]),r}(ye.Action);ye.MergeCellsAction=QYe;var JYe=function(e){Gz(r,e);var t=Kz(r);function r(n,o){var i;return zz(this,r),i=t.call(this),i.cellRange=o,i}return Yz(r,[{key:"undo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.mergeRange(this.cellRange,!0)}},{key:"redo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.unmergeRange(this.cellRange,!0),o.render()}}]),r}(ye.Action);ye.UnmergeCellsAction=JYe;ye.RowMoveAction=function(e,t){this.rows=e.slice(),this.finalIndex=t,this.actionType="row_move"};Fo(ye.RowMoveAction,ye.Action);ye.RowMoveAction.prototype.undo=function(e,t){var r=this,n=e.getPlugin("manualRowMove"),o=[].concat(this.rows),i=o.filter(function(f){return f>r.finalIndex}),a=o.filter(function(f){return f<=r.finalIndex}),l=i.sort(function(f,c){return c-f}).concat(a.sort(function(f,c){return f-c}));e.addHookOnce("afterViewRender",t);for(var s=0;s<l.length;s+=1){var u=e.toVisualRow(l[s]);n.moveRow(u,l[s])}e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};ye.RowMoveAction.prototype.redo=function(e,t){var r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",t),r.moveRows(this.rows.slice(),this.finalIndex),e.render(),e.deselectCell(),e.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)};ye.prototype.init=function(){var e=this.instance.getSettings().undo,t=typeof e>"u"||e;this.instance.undoRedo||(this.instance.undoRedo=this),t?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};ye.prototype.registerShortcuts=function(){var e=this,t=this.instance.getShortcutManager(),r=t.getContext("grid"),n=function(a){return!a.altKey},o={runOnlyIf:n,group:Zz};r.addShortcuts([{keys:[["Control/Meta","z"]],callback:function(){e.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:function(){e.redo()}}],o)};ye.prototype.unregisterShortcuts=function(){var e=this.instance.getShortcutManager(),t=e.getContext("grid");t.removeShortcutsByGroup(Zz)};function Qz(e,t){var r=this;if(t==="loadData")return r.undoRedo.clear()}function eGe(e){e.undo=function(){return e.undoRedo.undo()},e.redo=function(){return e.undoRedo.redo()},e.isUndoAvailable=function(){return e.undoRedo.isUndoAvailable()},e.isRedoAvailable=function(){return e.undoRedo.isRedoAvailable()},e.clearUndo=function(){return e.undoRedo.clear()}}function tGe(e){delete e.undo,delete e.redo,delete e.isUndoAvailable,delete e.isRedoAvailable,delete e.clearUndo}var kv=pe.getSingleton();kv.add("afterUpdateSettings",function(){var e;(e=this.getPlugin("undoRedo"))===null||e===void 0||e.init()});kv.register("beforeUndo");kv.register("afterUndo");kv.register("beforeRedo");kv.register("afterRedo");ye.PLUGIN_KEY=ZYe;ye.SETTING_KEYS=!0;function rGe(){et(z0e),et(gEe),et(xEe),et(TTe),et(YTe),et(uU),et(mke),et(Zke),et(_U),et(Q1e),et(RAe),et(NAe),et(DU),et(FIe),et(HHe),et(HLe),et(sje),et(Mje),et(rFe),et(UFe),et(tBe),et(WBe),et(eVe),et(QVe),et(bWe),et(IWe),et(aUe),et(kze),et(Gze),et(dYe),et(EYe),et(LYe),et(ye)}function nGe(){oRe(),bRe(),DRe(),QRe(),rGe()}function oGe(e){var t=typeof window>"u"?!1:window.jQuery;t&&(t.fn.handsontable=function(r){var n=this.first(),o=n.data("handsontable");if(typeof r!="string"){var i=r||{};return o?o.updateSettings(i):(o=new e.Core(n[0],i),n.data("handsontable",o),o.init()),n}var a;if(o)if(typeof o[r]<"u"){for(var l,s=arguments.length,u=new Array(s>1?s-1:0),f=1;f<s;f++)u[f-1]=arguments[f];a=(l=o[r]).call.apply(l,[o].concat(u)),r==="destroy"&&n.removeData()}else throw new Error("Handsontable do not provide action: ".concat(r));return a})}var HS,LS,jS,FS,BS;nGe();oGe(Ie);Ie.__GhostTable=RP;Ie._getListenersCounter=Kae;Ie._getRegisteredMapsCounter=Vpe;Ie.EventManager=Tt;var iGe=[Mee,Fee,lge,kRe,XJ,tae,Lie,rse,Nee,Fie,Rae,Xle],aGe=[Zie,Eae];Ie.helper={};Ie.dom={};$(iGe,function(e){$(Object.getOwnPropertyNames(e),function(t){t.charAt(0)!=="_"&&(Ie.helper[t]=e[t])})});$(aGe,function(e){$(Object.getOwnPropertyNames(e),function(t){t.charAt(0)!=="_"&&(Ie.dom[t]=e[t])})});Ie.cellTypes=(HS=Ie.cellTypes)!==null&&HS!==void 0?HS:{};$(gSe(),function(e){Ie.cellTypes[e]=cP(e)});Ie.cellTypes.registerCellType=on;Ie.cellTypes.getCellType=cP;Ie.editors=(LS=Ie.editors)!==null&&LS!==void 0?LS:{};$(Fae(),function(e){Ie.editors["".concat(ar(e),"Editor")]=Ug(e)});Ie.editors.registerEditor=Or;Ie.editors.getEditor=Ug;Ie.renderers=(jS=Ie.renderers)!==null&&jS!==void 0?jS:{};$(Gse(),function(e){var t=Yg(e);e==="base"&&(Ie.renderers.cellDecorator=t),Ie.renderers["".concat(ar(e),"Renderer")]=t});Ie.renderers.registerRenderer=An;Ie.renderers.getRenderer=Yg;Ie.validators=(FS=Ie.validators)!==null&&FS!==void 0?FS:{};$(Xse(),function(e){Ie.validators["".concat(ar(e),"Validator")]=SE(e)});Ie.validators.registerValidator=Vl;Ie.validators.getValidator=SE;Ie.plugins=(BS=Ie.plugins)!==null&&BS!==void 0?BS:{};$(wE(),function(e){Ie.plugins[e]=yv(e)});Ie.plugins["".concat(ar(ot.PLUGIN_KEY),"Plugin")]=ot;Ie.plugins.registerPlugin=et;Ie.plugins.getPlugin=yv;var os=Symbol("unassigned"),lGe="The Handsontable instance bound to this component was destroyed and cannot be used properly.";function Up(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Jz(e){var t=Ie.hooks.getRegistered(),r={};Object.assign(r,Ie.DefaultSettings);for(var n in r)r[n]={default:os};for(var o=0;o<t.length;o++)r[t[o]]={default:os};return r.settings={default:os},e==="HotTable"&&(r.id={type:String,default:"hot-".concat(Math.random().toString(36).substring(5))}),r}function eY(e){var t={},r=e.settings;if(r!==os)for(var n in r)Up(r,n)&&r[n]!==os&&(t[n]=r[n]);for(var o in e)Up(e,o)&&o!=="settings"&&e[o]!==os&&(t[o]=e[o]);return t}function IL(e,t){var r=eY(e),n=e.settings?e.settings:r,o=e.settings?r:null,i={};for(var a in n)Up(n,a)&&n[a]!==void 0&&(!(t&&a!=="data")||!ML(t[a],n[a]))&&(i[a]=n[a]);for(var l in o)Up(o,l)&&l!=="id"&&l!=="settings"&&o[l]!==void 0&&(!(t&&l!=="data")||!ML(t[l],o[l]))&&(i[l]=o[l]);return i}function ML(e,t){return JSON.stringify(e)===JSON.stringify(t)}var sGe="12.4.0",tY=NL({name:"HotTable",props:Jz("HotTable"),provide:function(){return{columnsCache:this.columnsCache}},watch:{$props:{handler:function(t){var r=IL(t,this.hotInstance?this.hotInstance.getSettings():void 0);!this.hotInstance||r===void 0||(r.data&&(this.hotInstance.isColumnModificationAllowed()||!this.hotInstance.isColumnModificationAllowed()&&this.hotInstance.countSourceCols()===this.miscCache.currentSourceColumns)&&(this.matchHotMappersSize(),delete r.data),Object.keys(r).length?this.hotInstance.updateSettings(r):this.hotInstance.render(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols())},deep:!0,immediate:!0}},data:function(){return{__hotInstance:null,miscCache:{currentSourceColumns:null},columnSettings:null,columnsCache:new Map,get hotInstance(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(lGe),null)},set hotInstance(t){this.__hotInstance=t}}},methods:{hotInit:function(){var t=IL(this.$props);t.columns=this.columnSettings?this.columnSettings:t.columns,this.hotInstance=aY(new Ie.Core(this.$el,t)),this.hotInstance.init(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols()},matchHotMappersSize:function(){var t=this;if(this.hotInstance){var r=this.hotInstance.getSourceData(),n=[],o=[],i=this.hotInstance.rowIndexMapper.getNumberOfIndexes(),a=this.hotInstance.isColumnModificationAllowed(),l=0;if(r&&r.length!==i&&r.length<i)for(var s=r.length;s<i;s++)n.push(s);if(a){var u;if(l=this.hotInstance.columnIndexMapper.getNumberOfIndexes(),r&&r[0]&&((u=r[0])===null||u===void 0?void 0:u.length)!==l&&r[0].length<l)for(var f=r[0].length;f<l;f++)o.push(f)}this.hotInstance.batch(function(){n.length>0?t.hotInstance.rowIndexMapper.removeIndexes(n):t.hotInstance.rowIndexMapper.insertIndexes(i-1,r.length-i),a&&r.length!==0&&(o.length>0?t.hotInstance.columnIndexMapper.removeIndexes(o):t.hotInstance.columnIndexMapper.insertIndexes(l-1,r[0].length-l))})}},getColumnSettings:function(){var t=Array.from(this.columnsCache.values());return t.length?t:void 0}},mounted:function(){this.columnSettings=this.getColumnSettings(),this.hotInit()},beforeUnmount:function(){this.hotInstance&&this.hotInstance.destroy()},version:sGe}),uGe=["id"];function fGe(e,t,r,n,o,i){return lY(),sY("div",{id:e.id},[uY(e.$slots,"default")],8,uGe)}tY.render=fGe;tY.__file="src/HotTable.vue";function xL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function cGe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xL(Object(r),!0).forEach(function(n){hGe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function hGe(e,t,r){return t=vGe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dGe(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vGe(e){var t=dGe(e,"string");return typeof t=="symbol"?t:String(t)}var yGe=NL({name:"HotColumn",props:Jz("HotColumn"),inject:["columnsCache"],methods:{createColumnSettings:function(){var t=eY(this.$props),r=cGe({},t);t.renderer&&(r.renderer=t.renderer),t.editor&&(r.editor=t.editor),this.columnsCache.set(this,r)}},mounted:function(){this.createColumnSettings()},unmounted:function(){this.columnsCache.delete(this)},render:function(){return null}});yGe.__file="src/HotColumn.vue";export{Ie as H,tY as a,nGe as r};
